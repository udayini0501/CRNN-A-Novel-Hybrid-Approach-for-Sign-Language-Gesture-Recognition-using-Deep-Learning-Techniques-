'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1001:function(w,B,a){a.r(B);w=a(0);var b=a(16),c=a(1385),h=a(178),f=a(119),e=a(756),k=a(774),l=a(355);class r{constructor(m,n,A,y){this.Xq=!1;this._id=m;this.qA=n;this.N5=A;this.Rf=y}get enabled(){return this.Xq}set enabled(m){const {DynamicRibbon:n}=a(1001);var A=this.Rf.OwnerAddinStoreType?this.Rf.OwnerAddinStoreType:this.Rf.PrimaryMarketplace.MarketplaceType;const y=this.Rf.PrimaryMarketplace.MarketplaceRef,
z=this.Rf.AssetMarketplace?this.Rf.AssetMarketplace.SolutionId:null,F=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.qA,A,null,null,null,y);A={["addinSolutionId"]:F,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Rf.OwnerAddinSolutionId,A,z,null,null,y),["ownerAddinStoreType"]:A,["ribbonControlType"]:"Button",["toggle"]:m};h.a.sendTelemetryEvent(Object.assign(new l.a,{name:n.fJc+"ControlUpdate",dataFields:f.a.Kl(A)}));this.Xq=m;this.N5.zN(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,
["SolutionId"]:this.qA,["PrivacyCompliantSolutionId"]:F,["SourceControlId"]:this.id,["MethodData"]:this.Xq})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(m){switch(m){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m,
n){switch(m){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(n,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertySetAsync(m,n){this.invokePropertySet(m,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m,n){switch(m){case 5:return this.VSj(n);case 1:return this.QGa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,n){m=this.invokeMethod(m,
n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}VSj(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");this.setEnabled(m);return null}QGa(){this._OnAccess();return null}}Object(w.a)(r,"RibbonButton",null,[]);class v{constructor(m,n,A,y){this._id=m;this.qA=n;this.N5=A;this.Rf=y}get id(){return this._id}setVisibility(m){const {DynamicRibbon:n}=a(1001),A=this.Rf.OwnerAddinStoreType?this.Rf.OwnerAddinStoreType:this.Rf.PrimaryMarketplace.MarketplaceType;
var y=this.Rf.PrimaryMarketplace.MarketplaceRef;const z=this.Rf.AssetMarketplace?this.Rf.AssetMarketplace.SolutionId:null,F=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.qA,A,z,null,null,y);y={["addinSolutionId"]:F,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Rf.OwnerAddinSolutionId,A,z,null,null,y),["ownerAddinStoreType"]:A,["ribbonControlType"]:"Tab",["toggle"]:m};h.a.sendTelemetryEvent(Object.assign(new l.a,{name:n.fJc+"ControlUpdate",dataFields:f.a.Kl(y)}));this.N5.zN(-1014260128,
{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.qA,["PrivacyCompliantSolutionId"]:F,["StoreType"]:A,["SourceControlId"]:this.id,["MethodData"]:m})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(m){switch(m){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);
}invokePropertySetAsync(m,n){this.invokePropertySet(m,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m,n){switch(m){case 3:return this.cXj(n);case 1:return this.QGa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,n){m=this.invokeMethod(m,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}cXj(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"boolean");this.setVisibility(m);
return null}QGa(){this._OnAccess();return null}}Object(w.a)(v,"RibbonTab",null,[]);var u=a(1027),x=a(187);a.d(B,"DynamicRibbon",function(){return t});class t{constructor(m,n,A,y,z){this.qA=m;this.BJ=A;this.N5=y;this.Rf=z;this.bnb=this.BJ.Qh;this.WB=this.bnb.getOsfControl(n);this.cNg=this.WB.getManifest()}get buttons(){return null}executeRequestCreate(m){try{var n=this.Rf.OwnerAddinStoreType?this.Rf.OwnerAddinStoreType:this.Rf.PrimaryMarketplace.MarketplaceType;const y=this.Rf.PrimaryMarketplace.MarketplaceRef,
z=this.Rf.AssetMarketplace?this.Rf.AssetMarketplace.SolutionId:null;var A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.qA,n,z,null,null,y);const F={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Rf.OwnerAddinSolutionId,n,z,null,null,y),["ownerAddinStoreType"]:this.Rf.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};h.a.sendTelemetryEvent(Object.assign(new l.a,{name:t.fJc+"ExecuteRequestCreate",dataFields:f.a.Kl(F)}));const D=x.a.kl(m);m={};
n={};n[e.a.oNa]=this.WB;n[e.a.pNa]=D;n[e.a.Tgd]=this.Rf;m[e.a.Bzb]=3;m[e.a.V7]=this.qA;m[e.a.Gec]=A;m[e.a.U7]=n;this.N5.zN(-1014260128,m);let I=t.gic("ExecuteRequestCreate",!0,"");b.ULS.sendTraceTag(538572826,0,50,I)}catch(y){A=t.gic("ExecuteRequestCreate",!1,y.toString()),b.ULS.sendTraceTag(538572825,0,50,A)}return null}executeRequestUpdate(m){try{var n=this.Rf.OwnerAddinStoreType?this.Rf.OwnerAddinStoreType:this.Rf.PrimaryMarketplace.MarketplaceType;const y=this.Rf.PrimaryMarketplace.MarketplaceRef,
z=this.Rf.AssetMarketplace?this.Rf.AssetMarketplace.SolutionId:null;var A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.qA,n,z,null,null,y);const F={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Rf.OwnerAddinSolutionId,n,z,null,null,y),["ownerAddinStoreType"]:this.Rf.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};h.a.sendTelemetryEvent(Object.assign(new l.a,{name:t.fJc+"ExecuteRequestUpdate",dataFields:f.a.Kl(F)}));const D=x.a.kl(m);m={};
n={};n[e.a.oNa]=this.WB;n[e.a.pNa]=D;n[e.a.Tgd]=this.Rf;m[e.a.Bzb]=3;m[e.a.V7]=this.qA;m[e.a.Gec]=A;m[e.a.U7]=n;this.N5.zN(-1014260128,m);let I=t.gic("ExecuteRequestUpdate",!0,"");b.ULS.sendTraceTag(538572824,0,50,I)}catch(y){A=t.gic("ExecuteRequestUpdate",!1,y.toString()),b.ULS.sendTraceTag(538572823,0,50,A)}return null}getButton(m){let n=null;if(!this.Krf())return this.oQe();if(m&&0<m.length){if(!this.mLe(m))return this.GQe(m);n=new r(m,this.qA,this.N5,this.Rf)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}getTab(m){let n=
null;if(!this.Krf())return this.oQe();if(this.WB.getOwnerAddinControlRecreated())return this.Lrh();if(m&&0<m.length){if(!this.mLe(m))return this.GQe(m);n=new v(m,this.qA,this.N5,this.Rf)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(n)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(m){switch(m){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertyGetAsync(m){m=this.invokePropertyGet(m);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}invokePropertySet(m){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokePropertySetAsync(m,n){this.invokePropertySet(m,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(m){switch(m){case 1:return this.QGa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(m);}invokeMethodAsync(m,n){switch(m){case 7:return this.mSh(n);case 6:return this.nSh(n);case 3:return this.y3h(n);
case 5:return this.Oii(n)}m=this.invokeMethod(m,n);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(m)}mSh(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.executeRequestCreate(m)}nSh(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.executeRequestUpdate(m)}y3h(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,0,"string");return this.getButton(m)}Oii(m){m=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(m,
0,"string");return this.getTab(m)}QGa(){this._OnAccess();return null}GQe(m){return u.a(k.a.jnh,x.a.ha(1771)+m)}oQe(){return u.a(k.a.nKj,x.a.ha(1767))}Lrh(){return u.a(k.a.hostRestartNeeded,x.a.ha(1772))}Krf(){var m=this.WB.getSharedRuntimeId();m=!!m&&0<m.length;b.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",m));return m}mLe(m){const n=this.cNg.getRibbonExtensionControlMap();return m in n||this.ygh(m)}ygh(m){var n=this.JVh();if(n){n=n.SXe;
for(const A of n.tabs){if(A.id===m)return!0;for(const y of A.groups)for(const z of y.controls){if(z.id===m)return!0;if("Menu"===z.type){n=z;for(const F of n.items)if(F.id===m)return!0}}}}return!1}JVh(){return c.a.getInstance().Uma(this.Rf.PrimaryMarketplace.MarketplaceType,this.Rf.PrimaryMarketplace.SolutionId,1)}static gic(m,n,A){const y={};y.methodName="DynamicRibbon."+m;y.result=n?"Succeeded":"Failed";y.message=A;return x.a.ff(y)}}t.fJc="Office.Online.Extensibility.Ribbon.";Object(w.a)(t,"DynamicRibbon",
null,[])},1023:function(w,B,a){a.d(B,"a",function(){return b});const b=(c,h)=>{let f=!1;c&&(c=h.osfControl,(h=c.getManifest())&&h.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&(f=!0));return f}},1024:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);class b{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.gla=this.CYa=this.vpd=this.Zrd=this.rDb=this.L5d=null}}Object(w.a)(b,"AppsForOfficeOauthResult",null,[])},1027:function(w,B,a){a.d(B,"a",function(){return b});
const b=(c,h)=>OfficeExtension.WacRuntime.Utility.createPromise((f,e)=>{e(OfficeExtension.WacRuntime.Utility.createRichApiException(c,h))})},1175:function(w,B,a){a.r(B);w=a(0);var b=a(2),c=a(16),h=a(5),f=a(180),e=a(198),k=a(143),l=a(202),r=a(58),v=a(62),u=a(40),x=a(239),t=a(127),m=a(541);class n{constructor($a){$a=$a.split("|");this.qA=$a[1];this.i0c=$a[2];this.E4d=$a[3]}get solutionId(){return this.qA}get solutionVersion(){return this.i0c}get needToRestoreManifest(){return this.E4d===OSF.StoreTypeEnum.Registry.toString()}}
Object(w.a)(n,"AddinStoreInfo",null,[]);class A{}Object(w.a)(A,"CustomFunctionRegistrationInfos",null,[]);var y=a(208),z=a(78);const F=($a,oa,Fa)=>D($a,oa,y.a.none,z.a.current,Fa),D=($a,oa,Fa,X,va)=>{Fa=$a.continueWith(()=>{oa($a)},3,Fa,X);Fa.continueWith(()=>{c.ULS.sendTraceTag(537163463,0,10,va)},4);return Fa},I=($a,oa,Fa)=>H($a,oa,y.a.none,z.a.current,Fa),H=($a,oa,Fa,X,va)=>{Fa=$a.hv(()=>oa($a),3,Fa,X);Fa.continueWith(()=>{c.ULS.sendTraceTag(537163462,0,10,va)},4);return u.TaskExtensions.MKc(Fa)},
N=($a,oa,Fa)=>U($a,oa,y.a.none,z.a.current,Fa),U=($a,oa,Fa,X,va)=>{Fa=$a.hv(()=>oa($a),3,Fa,X);Fa.continueWith(()=>{c.ULS.sendTraceTag(537163461,0,10,va)},4);return Fa},L=($a,oa,Fa)=>J($a,oa,y.a.none,z.a.current,Fa),J=($a,oa,Fa,X,va)=>{Fa=$a.hv(()=>oa($a),3,Fa,X);Fa.continueWith(()=>{c.ULS.sendTraceTag(537163460,0,10,va)},4);return u.TaskExtensions.MKc(Fa)},P=($a,oa,Fa)=>K($a,oa,y.a.none,z.a.current,Fa),K=($a,oa,Fa,X,va)=>{Fa=$a.continueWith(()=>{oa($a)},3,Fa,X);Fa.continueWith(()=>{c.ULS.sendTraceTag(537163459,
0,10,va)},4);return Fa},ca=($a,oa)=>{N(a(1175).CustomFunctionsInstaller.Tcf("CustomFunctionsRuntimeLogging"),Fa=>{if(Fa.result&&window.console)switch(Fa=T($a.severity)+" "+$a.message+oa,$a.severity){case 2:window.console.log&&window.console.log(Fa);break;case 0:window.console.info&&window.console.info(Fa);break;case 1:window.console.error&&window.console.error(Fa)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},T=$a=>{switch($a){case 0:return"Medium";
case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var Q=a(1023);class fa{}Object(w.a)(fa,"InstallationInfo",null,[]);class ha{}Object(w.a)(ha,"UninstallationInfo",null,[]);var Ea=a(32),ra=a(91),Z=a(38),wa=a(34),la=a(1),ta=a(22),Ca=a(249),Ga=a(867),Oa=a(63);class eb{constructor($a,oa){this.H_c=$a;this._message=oa}get severity(){return this.H_c}get message(){return this._message}}Object(w.a)(eb,"CustomFunctionLog",null,[]);a.d(B,"CustomFunctionsInstaller",function(){return nb});class nb{constructor($a,
oa,Fa){this.tfa=!1;this.rI={};this.$=$a;this.wm=oa;this.Gwd().Cra();this.indexedDB=Fa;this.indexedDB.li()&&(this.tfa=!0,this.indexedDB.initialize(nb.hFb,nb.iFb))}get HY(){return this.wm.HY}Yof($a,oa,Fa,X){if(X.invariantNamespace)for(let va=0;va<X.invariantNamespace.length;++va){const xa=X.invariantNamespace.charAt(va);if("."!==xa&&"_"!==xa&&"a">xa&&"z"<xa&&"A">xa&&"Z"<xa&&"0">xa&&"9"<xa)throw c.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${xa}', Position=${va}.`),
Error.create("InvariantNamespace validation failed");}return I(this.Fch(Fa,X.manifest),()=>I(this.QRd($a),va=>{let xa=va.result;return(null===xa||void 0===xa?0:xa.isDynamicMetadata)?this.RSd($a,oa,xa,!1,!1,!1):I(this.Xsk($a,oa,X),Pa=>{xa=new fa;xa.addinId=Fa;xa.locale=X.locale;xa.addinInvariantNamespace=X.invariantNamespace;xa.addinNamespace=X.namespace;xa.addinTitle=X.title;xa.isXllCompatible=X.isXllCompatible;xa.metadataContent=JSON.stringify(JSON.parse(Pa.result));return this.RSd($a,oa,xa,!1,nb.kTh(X.osfControl.getStoreType()),
Q.a(this.$,X))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}$of($a,oa,Fa,X){if(!nb.kCd(Fa))throw c.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return I(this.QRd($a),va=>{va=va.result;
if(!va&&(va=Z.a.Jf(this.HY,$a),!va))throw c.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId($a,oa,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");va.metadataContent=JSON.stringify(JSON.parse(Fa));va.isDynamicMetadata=!0;return this.RSd($a,oa,va,!0,!0,X)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}itg($a,
oa){this.wm.Gma();const Fa=Object(b.a)(new ha,{solutionId:$a}),X=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId($a,oa,null)}.`;return I(this.wTd($a),()=>I(this.DTd($a),()=>this.f8d(this.wm,$a,oa,Fa),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),X)}Xsk($a,oa,Fa){const X=new f.a;OSF.OUtil.xhrGet(Fa.metadataUrl,va=>{va?X.setResult(va):X.setException(Error.create("Invalid manifest"))},
va=>{c.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId($a,oa,null)}. ErrorCode: ${va}.`);X.Uw()});return X.task}Gwd(){return I(this.DAc(),$a=>{const oa=$a.result;if(!oa.length)return Oa.Task.Ua(!0);c.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");$a=new e.a;const Fa=[];for(let X=
0;X<oa.length;X++){const va=Object(k.a)(String,oa[X]);$a.add(N(this.QRd(va),xa=>{if(xa=xa.result){const Pa=Z.a.Jf(this.rI,xa.addinId);Pa&&Pa===xa.metadataContent||(this.rI[xa.addinId]=xa.metadataContent,this.HY[va]=xa,Fa.push(xa))}return!0},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return L(Oa.Task.WhenAllEnumerable($a),()=>{if(Fa.length){let X=new A;X.registrationInfos=Fa;return this.C8b(this.wm,oa,X)}c.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");
return Oa.Task.Ua(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}apf(){var $a=new f.a;new e.a;const oa=[],Fa=[];Object.keys(this.HY).forEach(X=>{X=Object(k.a)(String,X);const va=Z.a.Jf(this.HY,X);oa.push(va);Fa.push(X)});if(!Fa.length)return $a.setResult(!0),$a.task;$a=Object(b.a)(new A,{registrationInfos:oa});return this.C8b(this.wm,Fa,$a)}DAc(){return N(this.Qpd(m.a.i3a),$a=>{$a=$a.result;
return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize($a||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize($a||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}xzg($a){return this.v_d(m.a.i3a,Sys.Serialization.JavaScriptSerializer.serialize($a))}QRd($a){return I(this.Qpd(m.a.w9a($a)),oa=>{oa=oa.result||"";return 0<oa.length?Oa.Task.Ua(Sys.Serialization.JavaScriptSerializer.deserialize(oa,!0)):Oa.Task.Ua(null)},
"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}Psk($a,oa){return I(this.CZe($a),()=>I(this.v_d(m.a.w9a($a),Sys.Serialization.JavaScriptSerializer.serialize(oa)),()=>nb.w_d(m.a.Mtd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}wTd($a){return I(this.A4f($a),()=>I(this.U4f(m.a.w9a($a)),
()=>I(this.DAc(),oa=>oa.result.length?Oa.Task.Ua(!0):nb.w_d(m.a.Mtd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}Z1f($a){return this.Qpd(m.a.v9a($a))}tzg($a,oa){return I(this.CZe($a),()=>this.v_d(m.a.v9a($a),
oa),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}DTd($a){return I(this.A4f($a),()=>this.U4f(m.a.v9a($a)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}CZe($a){return I(this.DAc(),oa=>{oa=oa.result;const Fa=$a.toLowerCase();if(oa.includes(Fa))return Oa.Task.Ua(!0);oa.push(Fa);return this.xzg(oa)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}A4f($a){return I(this.DAc(),
oa=>{oa=oa.result;const Fa=$a.toLowerCase();return oa.includes(Fa)?(oa.splice(Array.indexOf(oa,Fa),1),this.xzg(oa)):Oa.Task.Ua(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}Fch($a,oa){if(la.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return $a=new OSF.AddinIdInfo($a),$a.needToRestoreManifest()?this.tzg($a.getSolutionId(),oa):Oa.Task.Ua(!0);$a=new n($a);return $a.needToRestoreManifest?this.tzg($a.solutionId,
oa):Oa.Task.Ua(!0)}PJj($a){if(la.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const Fa=new OSF.AddinIdInfo($a);return Fa.needToRestoreManifest()?N(this.Z1f(Fa.getSolutionId()),X=>{(X=X.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Fa.getSolutionId(),Fa.getSolutionVersion(),X,this.$.xa.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Oa.Task.Ua(!0)}const oa=new n($a);return oa.needToRestoreManifest?
N(this.Z1f(oa.solutionId),Fa=>{(Fa=Fa.result)&&OSF.OsfManifestManager.cacheManifestFromXml(oa.solutionId,oa.solutionVersion,Fa,this.$.xa.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Oa.Task.Ua(!0)}U4f($a){return this.tfa?this.indexedDB.zfd($a):nb.DBj($a)}v_d($a,oa){return this.tfa?this.indexedDB.lib(new Ga.a($a,oa)):nb.w_d($a,oa)}Qpd($a){return this.tfa?this.indexedDB.q9a($a):nb.Tcf($a)}RSd($a,oa,Fa,X,va,xa){const Pa=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId($a,
oa,null)}.`;return u.TaskExtensions.MKc(N(this.SSd(this.wm,$a,oa,Fa,!1,X,xa),()=>va?this.Psk($a,Fa):Oa.Task.Ua(!0),Pa))}SSd($a,oa,Fa,X,va,xa,Pa){if(!xa&&(xa=Z.a.Jf(this.rI,X.addinId))&&xa===X.metadataContent)return Oa.Task.Ua(!0);this.rI[X.addinId]=X.metadataContent;this.HY[oa]=X;Pa||$a.OPb(oa);$a.Gma();return I(this.Nyj(oa,Fa,X),()=>this.wQd(X.addinId,va),"Failed to register functions for customfunction addin")}Nyj($a,oa,Fa){const X=new f.a,va=this.oLa(Fa);return this.h8(xa=>{ca(nb.tyb,$a);(xa=xa.Result)&&
204===xa.ResponseStatusCode?X.setResult(!0):(delete this.rI[Fa.addinId],delete this.HY[$a],F(this.wTd($a),()=>{F(this.DTd($a),()=>{this.Bjg()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${$a}. Received status code ${xa?xa.ResponseStatusCode.toString():"Unknown"}.`),X.setResult(!1))},xa=>{xa=t.a.kh(xa.data);c.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId($a,
oa,null)}. Errors: ${wa.a.Me(xa)}.`);ca(nb.syb,$a);delete this.rI[Fa.addinId];delete this.HY[$a];X.setResult(!1)},va,X,!0)}C8b($a,oa,Fa){const X=new f.a,va=Ea.a.Jd.Og.m;oa.forEach(Pa=>{Pa=Object(k.a)(String,Pa);$a.UKe(Pa)});$a.Gma();const xa=this.o8c(Fa);return this.h8(Pa=>{ca(nb.tyb,Sys.Serialization.JavaScriptSerializer.serialize(oa));Pa=Pa.Result;let Ka=!0;var Bb=[];if(la.EwaSettings.isChangeGateEnabled("OfficeVSO:8191697_customFunctionsNullResponseBody")){if(Pa.ResponseBody){var xb=Sys.Serialization.JavaScriptSerializer.deserialize(Pa.ResponseBody.toString());
Array.isArray(xb.value)&&(Bb=xb.value)}}else Bb=Sys.Serialization.JavaScriptSerializer.deserialize(Pa.ResponseBody.toString()),Bb=Array.isArray(Bb.value)?Bb.value:null;xb=new e.a;for(let Ua=0;Ua<Bb.length;Ua++)if(!Bb[Ua]){Ka=!1;const Jb=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${Pa.ResponseStatusCode}.`;xb.add(I(this.wTd(oa[Ua]),()=>{delete this.rI[Fa.registrationInfos[Ua].addinId];delete this.HY[oa[Ua]];return this.DTd(oa[Ua])},
Jb))}P(Oa.Task.WhenAllEnumerable(xb),()=>{F(this.wQd("",!1),()=>{c.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${Ea.a.Jd.Og.m-va} Millisecond.`);Ka?X.setResult(Ka):P(this.Bjg(),()=>{X.setResult(Ka)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},
Pa=>{Pa=t.a.kh(Pa.data);c.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${wa.a.Me(Pa)}.`);ca(nb.syb,Sys.Serialization.JavaScriptSerializer.serialize(oa));for(Pa=0;Pa<Fa.registrationInfos.length;Pa++)delete this.rI[Fa.registrationInfos[Pa].addinId],delete this.HY[oa[Pa]];X.setResult(!1)},xa,X,!0)}f8d($a,oa,Fa,X){return I(this.Dik($a,oa,Fa,X),()=>this.wQd(X.solutionId,!1),"Failed to unregister functions for customfunction addin")}Dik($a,
oa,Fa,X){const va=new f.a;$a.OPb(oa);($a=Z.a.Jf(this.HY,oa))&&delete this.rI[$a.addinId];delete this.HY[oa];X=this.B8c(X);return this.h8(()=>{ca(nb.xed,oa);va.setResult(!0)},xa=>{xa=t.a.kh(xa.data);c.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(oa,Fa,null)}. Errors: ${wa.a.Me(xa)}.`);ca(nb.wed,oa);va.setResult(!1)},X,va,!1)}h8($a,oa,Fa,X,va){const xa=this.$.userOperationManager,
Pa=this.$.qa;let Ka=null,Bb=null,xb=null;const Ua=()=>{if(xa.oMa()||0<Pa.ua.i8||0<Pa.Cn.i8)return!1;Ka&&xa.ur(Ka);Bb&&Pa.Kv(Bb);xb&&Pa.IB(xb);const Jb=Fa.request;xa.YH(new l.a(507,0,(fc,ya,ob)=>{ca(va?nb.ved:nb.yed,Jb.RequestBody);return r.g(Pa.ua,"ExecuteRichApiRequest",Fa,Ca.b(fc,$a),Ca.a(ya,oa),ob,null,0)},Jb.RequestFlags&1&&256!==(Jb.RequestFlags&256)?64:80));return!0};Ua()||(Ka=()=>{Ua()},Bb=()=>{Ua()},xb=()=>{Ua()},xa.xt(Ka),Pa.gu(Bb),Pa.wA(xb));return X.task}oLa($a){const oa={HttpMethod:"POST",
PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};oa.RequestBody=JSON.stringify($a);oa.RequestFlags=1;oa.RequestFlags|=256;$a=this.$.qa.ua.Pa(1);$a.request=oa;return $a}o8c($a){const oa={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};oa.RequestBody=JSON.stringify($a);oa.RequestFlags=1;oa.RequestFlags|=256;$a=this.$.qa.ua.Pa(1);$a.request=oa;return $a}B8c($a){const oa={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};oa.RequestBody=
JSON.stringify($a);oa.RequestFlags=1;oa.RequestFlags|=256;$a=this.$.qa.ua.Pa(1);$a.request=oa;return $a}wQd($a,oa){const Fa=v.GetServiceTaskFactory.create(this.$.ia,153,this.$.ma,1);return H(Fa,()=>{Fa.result.fWd();return $a&&oa?this.PJj($a):Oa.Task.Ua(!0)},this.$.ma,x.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}Bjg(){const $a=new ra.a(1949669462,0,this.$.Ie,0,null);return this.$.Ga.Sd($a)}static Tcf($a){try{return Oa.Task.Ua(localStorage.getItem($a))}catch(oa){return c.ULS.sendTraceTag(537163537,
0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${oa.message||"Unknown"}`),Oa.Task.Ua(null)}}static w_d($a,oa){try{return localStorage.setItem($a,oa),Oa.Task.Ua(!0)}catch(Fa){return c.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${Fa.message||"Unknown"}`),Oa.Task.Ua(!1)}}static DBj($a){try{return localStorage.removeItem($a),Oa.Task.Ua(!0)}catch(oa){return c.ULS.sendTraceTag(537163535,
0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${oa.message||"Unknown"}`),Oa.Task.Ua(!1)}}static kTh($a){return ta.a.equals($a,"registry",!0)||ta.a.equals($a,"uploadfiledevcatalog",!0)||h.AFrameworkApplication.userNameUnknown||h.AFrameworkApplication.limitedEdit}static kCd($a){if(!$a)return!1;try{JSON.parse($a)}catch(oa){return!1}return!0}}nb.hFb="CustomFunctionCache";nb.iFb="CustomFunction";nb.ved=new eb(2,"CustomFunctions [Registration] [Begin] SolutionId=");
nb.tyb=new eb(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");nb.syb=new eb(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");nb.yed=new eb(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");nb.xed=new eb(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");nb.wed=new eb(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(w.a)(nb,"CustomFunctionsInstaller",null,[739])},1178:function(w,B,a){a.r(B);w=a(0);var b=a(2),c=a(16),h=a(991),
f=a(180),e=a(143),k=a(202),l=a(58),r=a(62),v=a(40),u=a(127),x=a(541),t=a(1023);class m{constructor(T){T=T.split("|");this.qA=T[1];this.i0c=T[2];this.E4d=T[3]}get solutionId(){return this.qA}get solutionVersion(){return this.i0c}get needToRestoreManifest(){return this.E4d===OSF.StoreTypeEnum.Registry.toString()}}Object(w.a)(m,"AddinStoreInfo",null,[]);class n{}Object(w.a)(n,"CustomFunctionRegistrationInfos",null,[]);const A=(T,Q)=>{if(a(1178).CustomFunctionsLegacyInstaller.NCb("CustomFunctionsRuntimeLogging")&&
window.console)switch(Q=y(T.severity)+" "+T.message+Q,T.severity){case 2:window.console.log&&window.console.log(Q);break;case 0:window.console.info&&window.console.info(Q);break;case 1:window.console.error&&window.console.error(Q)}},y=T=>{switch(T){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class z{}Object(w.a)(z,"InstallationInfo",null,[]);class F{}Object(w.a)(F,"UninstallationInfo",null,[]);var D=a(186),I=a(38),H=a(34),N=a(1),U=a(12),L=a(249),J=a(916),
P=a(63);class K{constructor(T,Q){this.H_c=T;this._message=Q}get severity(){return this.H_c}get message(){return this._message}}Object(w.a)(K,"CustomFunctionLog",null,[]);a.d(B,"CustomFunctionsLegacyInstaller",function(){return ca});class ca{constructor(T){this.rI={};this.$=T;this.Gwd().Cra()}Yof(T,Q,fa,ha){const Ea=new f.a;if(ha.invariantNamespace)for(Q=0;Q<ha.invariantNamespace.length;++Q){const Z=ha.invariantNamespace.charAt(Q);if("."!==Z&&"_"!==Z&&"a">Z&&"z"<Z&&"A">Z&&"Z"<Z&&"0">Z&&"9"<Z)return c.ULS.sendTraceTag(537163530,
0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${Z}', Position=${Q}.`),Ea.setResult(!1),Ea.task}ca.cacheManifest(fa,ha.manifest);let ra=ca.RRd(T);(null===ra||void 0===ra?0:ra.isDynamicMetadata)?this.QSd(T,ra,Ea,!1,!1):OSF.OUtil.xhrGet(ha.metadataUrl,Z=>{ra=Object(b.a)(new z,{addinId:fa,locale:ha.locale,addinInvariantNamespace:ha.invariantNamespace,addinNamespace:ha.namespace,addinTitle:ha.title,isXllCompatible:ha.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(Z))});
this.QSd(T,ra,Ea,!1,t.a(this.$,ha))},Z=>{c.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${T}. ErrorCode: ${Z}.`);Ea.setResult(!1)});return Ea.task}$of(T,Q,fa,ha){Q=new f.a;if(!ca.kCd(fa))return c.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Q.setResult(!1),Q.task;const Ea=ca.RRd(T);if(!Ea)return c.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),
Q.setResult(!1),Q.task;Ea.metadataContent=JSON.stringify(JSON.parse(fa));Ea.isDynamicMetadata=!0;this.QSd(T,Ea,Q,!0,ha);return Q.task}itg(T){const Q=new f.a,fa=r.GetServiceTaskFactory.create(this.$.ia,106,this.$.ma,1);v.TaskExtensions.Aa(fa,()=>{const ha=fa.result;ha.Gma();const Ea=Object(b.a)(new F,{solutionId:T});ca.xTd(T);ca.ETd(T);v.TaskExtensions.Aa(this.f8d(ha,T,Ea),ra=>{D.b(ra)?Q.setResult(ra.result):(ra.vi?c.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${T}.`):
ra.Yj&&c.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${T}.`),Q.setResult(!1))},this.$.ma,0)},this.$.ma,3);return Q.task}Gwd(){const T=new f.a,Q=ca.WRd();0<Q.length&&c.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const fa=[];Q.forEach(Ea=>{Ea=Object(e.a)(String,Ea);if(Ea=ca.RRd(Ea)){const ra=I.a.Jf(this.rI,Ea.addinId);
ra&&ra===Ea.metadataContent||(this.rI[Ea.addinId]=Ea.metadataContent,fa.push(Ea))}});if(!fa.length)return T.setResult(!0),c.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),T.task;const ha=r.GetServiceTaskFactory.create(this.$.ia,106,this.$.ma,1);v.TaskExtensions.Aa(ha,()=>{const Ea=ha.result,ra=Object(b.a)(new n,{registrationInfos:fa});v.TaskExtensions.Aa(this.C8b(Ea,Q,ra),Z=>{D.b(Z)?T.setResult(Z.result):
(Z.vi?c.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):Z.Yj&&c.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),T.setResult(!1))},this.$.ma,0)},this.$.ma,3);return T.task}OJj(T){T=new m(T);if(T.needToRestoreManifest){const Q=ca.Svj(T.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(T.solutionId,T.solutionVersion,Q,this.$.xa.UICultureTag)}}QSd(T,
Q,fa,ha,Ea){const ra=r.GetServiceTaskFactory.create(this.$.ia,106,this.$.ma,1);v.TaskExtensions.Aa(ra,()=>{v.TaskExtensions.Aa(this.SSd(ra.result,T,Q,!1,ha,Ea),Z=>{D.b(Z)?((Z=Z.result)&&ca.Qsk(T,Q),fa.setResult(Z)):(Z.vi?c.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${T}.`):Z.Yj&&c.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${T}.`),
fa.setResult(!1))},this.$.ma,0)},this.$.ma,3)}SSd(T,Q,fa,ha,Ea,ra){if(!Ea&&(Ea=I.a.Jf(this.rI,fa.addinId))&&Ea===fa.metadataContent)return P.Task.Ua(!0);this.rI[fa.addinId]=fa.metadataContent;const Z=new f.a;ra||T.OPb(Q);T.Gma();T=this.oLa(fa);return this.h8(wa=>{A(ca.tyb,Q);const la=wa.Result;204===la.ResponseStatusCode?v.TaskExtensions.Aa(this.vQd(Z,fa.addinId,ha),ta=>{ta.vi?Q?c.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Q}.`):
c.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${fa.addinId}.`):ta.Yj&&(Q?c.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${Q}.`):c.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${fa.addinId}.`));
Z.setResult(!1)},this.$.ma,4):(wa=()=>{delete this.rI[fa.addinId];ca.xTd(Q);ca.ETd(Q);c.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${Q}. Received status code ${la.ResponseStatusCode}.`);Z.setResult(!1)},wa=Object(b.a)(new J.a,{rQa:OSF.InfoType.Error,title:fa.addinTitle,description:String.format(U.a.instance.Qd(153),U.a.instance.ha(1892)),buttonText:U.a.instance.ha(4),vla:wa,umc:!1,rma:wa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),
h.a.d2d(wa))},wa=>{wa=u.a.kh(wa.data);c.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Q}. Errors: ${H.a.Me(wa)}.`);A(ca.syb,Q);delete this.rI[fa.addinId];Z.setResult(!1)},T,Z,!0)}C8b(T,Q,fa){const ha=new f.a;Q.forEach(ra=>{ra=Object(e.a)(String,ra);T.UKe(ra)});T.Gma();const Ea=this.o8c(fa);return this.h8(ra=>{A(ca.tyb,Sys.Serialization.JavaScriptSerializer.serialize(Q));ra=ra.Result;let Z=!0;var wa=
[];N.EwaSettings.isChangeGateEnabled("OfficeVSO:7667457_responseBody"),wa=Sys.Serialization.JavaScriptSerializer.deserialize(ra.ResponseBody.toString()),wa=Array.isArray(wa.value)?wa.value:null;for(let la=0;la<wa.length;la++)wa[la]||(Z=!1,delete this.rI[fa.registrationInfos[la].addinId],ca.xTd(Q[la]),ca.ETd(Q[la]),c.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${Q[la]}. Received status code ${ra.ResponseStatusCode}.`));v.TaskExtensions.Aa(this.vQd(ha,
"",!1),la=>{la.vi?c.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):la.Yj&&c.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");ha.setResult(!1)},this.$.ma,4);ha.setResult(Z)},ra=>{ra=u.a.kh(ra.data);c.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(Q)}. Errors: ${H.a.Me(ra)}.`);
A(ca.syb,Sys.Serialization.JavaScriptSerializer.serialize(Q));for(const Z of fa.registrationInfos)delete this.rI[Z.addinId];ha.setResult(!1)},Ea,ha,!0)}f8d(T,Q,fa){const ha=new f.a;T.OPb(Q);T=this.B8c(fa);return this.h8(()=>{A(ca.xed,Q);v.TaskExtensions.Aa(this.vQd(ha,fa.solutionId,!1),Ea=>{Ea.vi?Q&&c.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Q}.`):Ea.Yj&&Q&&c.ULS.sendTraceTag(537163472,0,
10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${Q}.`);ha.setResult(!1)},this.$.ma,4)},Ea=>{Ea=u.a.kh(Ea.data);c.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Q}. Errors: ${H.a.Me(Ea)}.`);A(ca.wed,Q);ha.setResult(!1)},T,ha,!1)}h8(T,Q,fa,ha,Ea){const ra=this.$.userOperationManager,Z=this.$.qa;let wa=null,la=null,ta=null;
const Ca=()=>{if(ra.oMa()||0<Z.ua.i8||0<Z.Cn.i8)return!1;wa&&ra.ur(wa);la&&Z.Kv(la);ta&&Z.IB(ta);const Ga=fa.request;ra.YH(new k.a(507,0,(Oa,eb,nb)=>{A(Ea?ca.ved:ca.yed,Ga.RequestBody);return l.g(Z.ua,"ExecuteRichApiRequest",fa,L.b(Oa,T),L.a(eb,Q),nb,null,0)},(Ga.RequestFlags&1?0:16)|64));return!0};Ca()||(wa=()=>{Ca()},la=()=>{Ca()},ta=()=>{Ca()},ra.xt(wa),Z.gu(la),Z.wA(ta));return ha.task}oLa(T){const Q={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Q.RequestBody=
JSON.stringify(T);Q.RequestFlags=1;T=this.$.qa.ua.Pa(1);T.request=Q;return T}o8c(T){const Q={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Q.RequestBody=JSON.stringify(T);Q.RequestFlags=1;T=this.$.qa.ua.Pa(1);T.request=Q;return T}B8c(T){const Q={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Q.RequestBody=JSON.stringify(T);Q.RequestFlags=1;T=this.$.qa.ua.Pa(1);T.request=Q;return T}vQd(T,Q,fa){const ha=r.GetServiceTaskFactory.create(this.$.ia,
153,this.$.ma,1);v.TaskExtensions.Aa(ha,()=>{ha.result.fWd();Q&&fa&&this.OJj(Q);T.setResult(!0)},this.$.ma,3);return ha}apf(){return P.Task.Ua(!0)}static WRd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(ca.NCb(x.a.i3a)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(ca.NCb(x.a.i3a)||"[]"):null)||[]}static yzg(T){ca.x_d(x.a.i3a,Sys.Serialization.JavaScriptSerializer.serialize(T))}static RRd(T){T=ca.NCb(x.a.w9a(T))||"";return 0<T.length?Sys.Serialization.JavaScriptSerializer.deserialize(T,
!0):null}static Qsk(T,Q){ca.BZe(T);ca.x_d(x.a.w9a(T),Sys.Serialization.JavaScriptSerializer.serialize(Q))}static xTd(T){ca.z4f(T);ca.V4f(x.a.w9a(T))}static Svj(T){return ca.NCb(x.a.v9a(T))}static Rsk(T,Q){ca.BZe(T);ca.x_d(x.a.v9a(T),Q)}static ETd(T){ca.z4f(T);ca.V4f(x.a.v9a(T))}static BZe(T){const Q=ca.WRd();T=T.toLowerCase();Q.includes(T)||(Q.push(T),ca.yzg(Q))}static z4f(T){const Q=ca.WRd();T=T.toLowerCase();Q.includes(T)&&(Q.splice(Array.indexOf(Q,T),1),ca.yzg(Q))}static cacheManifest(T,Q){T=new m(T);
T.needToRestoreManifest&&ca.Rsk(T.solutionId,Q)}static NCb(T){try{return localStorage.getItem(T)}catch(Q){return c.ULS.sendTraceTag(537163469,0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${Q.message||"Unknown"}`),null}}static x_d(T,Q){try{localStorage.setItem(T,Q)}catch(fa){c.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${fa.message||"Unknown"}`)}}static V4f(T){try{localStorage.removeItem(T)}catch(Q){c.ULS.sendTraceTag(537163467,
0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${Q.message||"Unknown"}`)}}static kCd(T){if(!T)return!1;try{JSON.parse(T)}catch(Q){return!1}return!0}}ca.ved=new K(2,"CustomFunctions [Registration] [Begin] SolutionId=");ca.tyb=new K(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");ca.syb=new K(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");ca.yed=new K(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");
ca.xed=new K(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");ca.wed=new K(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(w.a)(ca,"CustomFunctionsLegacyInstaller",null,[739])},1192:function(w,B,a){w=a(0);var b=a(208),c=a(16);class h{}Object(w.a)(h,"AddinCommandsHost",null,[]);var f=a(1228),e=a(1317),k=a(913),l=a(58);const r=(D,I,H,N,U,L)=>{const J=D.Pa(9);J.sharedInfo=I;return l.g(D,"InsertAgaveTaskpane",J,H,N,U,L,0)};var v=a(383),u=a(202),x=a(40),t=a(1),
m=a(249),n=a(153);class A extends n.a{constructor(D){super();this.Rg=this.BHa="AddInCommandsDialog";this.ke=5;this.dialogWidth=695;this.dialogHeight=438;this.umh="100%";this.rmh="408px";this.smh="15px";this.tmh="0";this.PNg=D}get containerDiv(){return this.tk}Rz(){super.Rz();this.tk.style.width=this.umh;this.tk.style.height=this.rmh;this.tk.style.marginTop=this.smh;this.tk.style.padding=this.tmh}OG(){super.OG();this.Md.style.width=String.format("{0}px",this.dialogWidth);this.Md.style.height=String.format("{0}px",
this.dialogHeight)}dispose(){super.dispose();this.PNg()}}Object(w.a)(A,"AddInCommandsDialog",n.a,[]);var y=a(63),z=a(78);n=a(108);a.d(B,"a",function(){return F});class F extends h{constructor(D,I,H,N,U){N=void 0===N?null:N;U=void 0===U?null:U;super();this.$=D;this.jg=I;this.ownerAddinInfo=H;this.Yf=U;this.Xhb=N||y.Task.Ua(!0)}mmh(){const D=this.Xhb;this.Xhb=y.Task.Ua(!0);return D}disposeHost(D){this.jg.wVa(D)}setOwnerAddinEToken(D){this.ownerAddinInfo.eToken=D}showTaskpane(D,I,H){c.ULS.sendTraceTag(537170642,
220,50,"ShowTaskpane action called.");let N=null,U=!1,L=(new f.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new k.a,!0)).zTe(D.solutionId.substr(this.ownerAddinInfo.solutionId.length));N=I.getSharedRuntimeForTaskpane("Workbook",L);U=!!N&&1===N.LifeTime;this.jg.XKe(U?this.ownerAddinInfo.solutionId:D.solutionId,U?N:null,null)||(this.vCf(U,!0),this.Xhb=this.Fwd(D,N,(J,P)=>{J?(U&&(J.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,J.SharedRuntime=N),J.WebExtensionOsfControlType=
3,this.jg.DMa(J),H(J.InstanceId,P),this.vCf(U,!1),t.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&c.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(c.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),H(null,P))}))}getSettings(D,I){let H=this.jg.pea(D.solutionId);H?I(this.jg.iY(H).OsfPropertyBag):this.Xhb=this.Fwd(D,null,N=>{N?I(N.OsfPropertyBag):c.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(D,
I,H){c.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const N=this.$.qa.ua,U=J=>{const P=J.Result,K=P?P.AgaveData:null;K?(this.jg.mSe(K,()=>{const ca=new A(()=>{this.disposeHost(K.InstanceId)});ca.initializeAndShow("",null,null);return ca.containerDiv}),H(K.InstanceId,0)):(c.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),H(null,J.Errors?J.Errors[0].ErrorCause:5001))},L=F.xxa(D,this.ownerAddinInfo);this.Xhb=v.a(this.$.userOperationManager,(J,P,K)=>r(N,L,m.b(J,
U),P,K,null),J=>new u.a(500,0,J,64),this.Yf)}createUILessSandbox(D,I,H){c.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const N=I.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),U=!!N&&1===N.LifeTime;(I=this.jg.NVh(U?this.ownerAddinInfo.solutionId:D.solutionId,U?N:null))?H(I,0):this.Xhb=this.Fwd(D,N,(L,J)=>{L?(U?(L.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,L.SharedRuntime=N,L.TaskpaneVisible=!1,L.WebExtensionOsfControlType=3,this.jg.DMa(L)):(L.WebExtensionOsfControlType=
4,this.jg.mSe(L,()=>{F.Zkb.fa(L.InstanceId,new e.a);return F.Zkb.ka(L.InstanceId).Vda})),H(L.InstanceId,J)):(c.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),H(null,J))})}Fwd(D,I,H){let N=null;const U=this.$.qa.ua,L=T=>{const Q=T.Result;(N=Q?Q.AgaveData:null)||H(null,T.Errors?T.Errors[0].ErrorCause:5001)},J=F.xxa(D,this.ownerAddinInfo);I&&(c.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),J.SharedRuntimeId=I.Resid);let P=500;var K=(T,Q,fa)=>r(U,J,m.b(T,L),
Q,fa,null);let ca=0;void 0===J.IsToBePersisted||null===J.IsToBePersisted||J.IsToBePersisted||(P=538,K=(T,Q,fa)=>{c.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));T=m.b(T,L);const ha=U.Pa(9,null);ha.sharedInfo=J;return l.g(U,"ShowAgaveTaskpane",ha,T,Q,fa,
null,0)},ca=16);ca|=64;K=v.a(this.$.userOperationManager,K,T=>new u.a(P,0,T,ca),this.Yf);return x.TaskExtensions.ts(K,()=>N?this.DEd(U,N.InstanceId,(T,Q)=>{if(T){I||(N.PrimaryMarketplace.MarketplaceType=D.storeType);D.assetId?D.assetId.toLowerCase().startsWith("wa")?N.AssetMarketplace={SolutionId:D.assetId,SolutionVersion:D.version,MarketplaceType:OSF.StoreType.OMEX,MarketplaceRef:D.assetStoreId}:(N.AssetMarketplace=null,c.ULS.sendTraceTag(512325019,344,10,"WACExcelAddinCommandsHost: AssetId is not a valid value")):
N.AssetMarketplace=null;N.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;N.OwnerAddinStoreType=this.ownerAddinInfo.storeType;N.OsfPropertyBag=[];for(Q=0;Q<T.Settings.length;Q++){const fa=[];fa[0]=T.Settings[Q].Name;fa[1]=T.Settings[Q].Value;N.OsfPropertyBag[Q]=fa}H(N,0)}else H(null,Q.Errors?Q.Errors[0].ErrorCause:5001)}):y.Task.Ua(!1),b.a.none,3,z.a.current)}DEd(D,I,H){const N=U=>{H(U.Result,U)};return v.a(this.$.userOperationManager,(U,L,J)=>{U=m.b(U,N);const P=D.Pa(1);P.controlId=I;return l.g(D,
"DdaLoadSettings",P,U,L,J,null,0)},U=>new u.a(501,0,U,80),this.Yf)}vCf(D,I){var H;D&&(null===(H=window.performance)||void 0===H?0:H.memory)&&c.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${I}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(D){F.Zkb.Hd(D)&&F.Zkb.ka(D).initializeAndShowWithTitle()}static hideUILessDialog(D){F.Zkb.Hd(D)&&
F.Zkb.ka(D).hide()}static xxa(D,I){var H,N;const U={};U.SolutionId=D.solutionId;U.Version=D.version;U.StoreType=I.storeType;U.StoreId=D.storeId;U.AssetId=null!==(H=D.assetId)&&void 0!==H?H:D.solutionId;U.AssetStoreId=null!==(N=D.assetStoreId)&&void 0!==N?N:"omex";U.TargetType=1;U.Width=350;U.OwnerAddinSolutionId=I.solutionId;U.OwnerAddinStoreType=I.storeType;U.SharedRuntimeId=null;U.Preload=!1;return U}}F.Zkb=new n.a;Object(w.a)(F,"WACExcelAddinCommandsHost",h,[])},1228:function(w,B,a){a.d(B,"a",
function(){return c});w=a(0);a(16);var b=a(5);class c{constructor(h,f,e,k){this.bqb=h;b.AFrameworkApplication.da.na("AddInCommandsMissingTabIsEnabled")&&e.xbi();this.qA=f;this.BQg=k}get iLb(){return this.bqb}get solutionId(){return this.qA}get E1d(){return this.BQg}NOa(h){h=this.iLb+this.solutionId+h;return this.E1d?(h in c.a7b||(c.a7b[h]="AddinControl"+c.N1g++),c.a7b[h]):h}zTe(h){if(this.E1d){const e=c.a7b;for(const k in e){var f=k;if(h===e[k])return f.substr(this.iLb.length+this.solutionId.length)}}return h}Lgf(h){h=
this.iLb+this.solutionId+h;return this.E1d?(h in c.b5c||(c.b5c[h]="AddinTab"+c.Y1g++),c.b5c[h]):h}}c.a7b={};c.b5c={};c.Y1g=0;c.N1g=0;Object(w.a)(c,"DefaultRibbonNamingProvider",null,[766])},1282:function(w,B,a){w=a(0);var b=a(198),c=a(16),h=a(108);class f{constructor(){this.startTime=0;this.callback=null}}Object(w.a)(f,"SSOCallbackInfo",null,[]);class e{constructor(){this.accessToken=null}}Object(w.a)(e,"AccessTokenInformation",null,[819]);var k=a(1024);class l{constructor(){this.token=null;this.expiresOn=
0;this.gla=this.authChallenge=null}}Object(w.a)(l,"CachedTokenInfo",null,[]);class r{constructor(){this.PYb=new b.a;this.Sca=this.Rca=!1;this.Qsa=this.authChallenge=null;this.startTime=this.retryCount=0;this.CBe=null}get callbacks(){return this.PYb}}Object(w.a)(r,"SSORequestInfo",null,[]);class v extends r{constructor(){super();this.errorCode=0}}Object(w.a)(v,"SSOFailedRequestInfo",r,[]);var u=a(5),x=a(119),t=a(178),m=a(355);class n{static O9(N,U,L,J){var P=N.startTime;let K=0;0<P&&(K=n.pz()-P);P=
{["callInstanceId"]:P.toString(),["callDuration"]:K.toString(),["errorCode"]:U.toString()};if(J)for(const ca in J)P[ca]=J[ca];c.ULS.sendTraceTag(51401116,344,50,"{0}",P);t.a.sendTelemetryEvent(Object.assign(new m.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:x.a.Kl(P)}));N.callback(U,L)}static pz(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(N){}return Date.now()}}Object(w.a)(n,"AppsForOfficeSingleSignOnManagerStatic",null,[]);
class A{constructor(N,U,L,J){this.EW=new b.a;this.GJ=new b.a;this.Pta=null;this.Rqb=new b.a;this.Gme=Promise.resolve(null);this.Vte=!1;this.Y2b=U;this.Cba=N;this.Aue=L;this.$Eg=J}q0j(N){if(this.Pta&&this.Pta.authChallenge===N.authChallenge){if(Date.now()/1E3+A.CYi>this.Pta.expiresOn)return this.Pta=null,!1;N=new k.a;N.token=this.Pta.token;N.expiresOn=this.Pta.expiresOn;N.gla=this.Pta.gla;N.CYa=!0;N.rDb=0;this.RDb(N);return!0}return!1}MZj(N){for(let U=0;U<this.GJ.count;U++)if(this.GJ.ka(U).authChallenge===
N.authChallenge&&this.GJ.ka(U).Qsa===N.Qsa){let L;(L=this.GJ.ka(U)).retryCount=L.retryCount+1;N.retryCount=this.GJ.ka(U).retryCount;if(this.GJ.ka(U).retryCount<A.aZi||!this.GJ.ka(U).Rca&&N.Rca||!this.GJ.ka(U).Sca&&N.Sca){if(!this.GJ.ka(U).Rca&&N.Rca||!this.GJ.ka(U).Sca&&N.Sca)N.retryCount=0;this.GJ.removeAt(U);break}N=new k.a;N.errorCode=this.GJ.ka(U).errorCode;this.RDb(N);return!0}return!1}eYg(N,U){for(let L=0;L<this.GJ.count;L++)if(this.GJ.ka(L).Qsa===N.Qsa&&this.GJ.ka(L).authChallenge===N.authChallenge)return;
this.GJ.add(Object.assign(new v,{Rca:N.Rca,Sca:N.Sca,authChallenge:N.authChallenge,Qsa:N.Qsa,errorCode:U,retryCount:N.retryCount}))}get resource(){return this.Y2b}Vmd(N,U,L,J,P,K){""===L&&(L=null);if(this.Vte)n.O9(K,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var ca=null;for(const T of this.EW)if(T.Rca===N&&T.Sca===U&&T.authChallenge===L&&T.Qsa===P){ca=T;break}ca||(ca=Object.assign(new r,{Rca:N,Sca:U,authChallenge:L,CBe:J,Qsa:P,retryCount:0,startTime:n.pz()}),this.EW.add(ca));
ca.retryCount=0;ca.callbacks.add(K);this.Gme=this.Gme.then(()=>{if(0<this.EW.count){var T=this.EW.ka(0);if(this.q0j(T)||this.MZj(T))return null;for(var Q=0;Q<this.Rqb.count;)this.Rqb.ka(Q)+A.Dbk<n.pz()?this.Rqb.removeAt(Q):Q++;if(this.Rqb.count>=A.XYi||this.EW.count>=A.xYi)return T=new k.a,T.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.RDb(T),null;let fa=null;u.AFrameworkApplication.sa&&(Q=u.AFrameworkApplication.sa.XE)&&(fa=Q.xf("ComponentAttach",this.Cba+A.rRg));return T.Qsa.XTg(this.resource,
T.Rca,T.Sca,T.authChallenge,this.$Eg,T.CBe).then(ha=>{fa&&fa.stop();this.RDb(ha)},()=>{fa&&fa.stop();const ha=new k.a;ha.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.RDb(ha)})}return null})}}RDb(N){try{if(this.EW.count){var U=this.EW.ka(0);this.EW.removeAt(0);var L=null;N.errorCode||(L=new e,L.accessToken=N.token);N.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&N.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&N.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&
N.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.eYg(U,N.errorCode);var J={};null!=N.rDb&&(J.getTokenSilentTime=N.rDb.toString());null!=N.Zrd&&(J.getTokenPopupTime=N.Zrd.toString());null!=N.vpd&&(J.getIDTokenTime=N.vpd.toString());null!=N.CYa&&(J.tokenCached=N.CYa.toString());N.L5d&&(J.detailedError=N.L5d);N.gla&&(J.authLibrary=N.gla);U.retryCount&&(J.retryCount=U.retryCount);for(var P of U.callbacks)n.O9(P,N.errorCode,L,J);null!=N.CYa&&N.CYa||this.Rqb.add(U.startTime);if(!N.errorCode)for(null!=
N.expiresOn&&(this.Pta=Object.assign(new l,{token:N.token,expiresOn:N.expiresOn,authChallenge:U.authChallenge,gla:N.gla})),this.GJ.clear(),P=0;P<this.EW.count;)if(this.EW.ka(P).authChallenge===U.authChallenge){for(const K of this.EW.ka(P).callbacks)n.O9(K,N.errorCode,L,J);this.EW.removeAt(P)}else P++}}catch(K){c.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",K.message)}}shutdown(){this.Vte=!0;this.EW.clear()}}A.Dbk=6E4;A.XYi=6;A.xYi=6;A.aZi=3;A.CYi=300;A.rRg=
"GetAccessToken";Object(w.a)(A,"SSOCallbackManager",null,[]);var y=a(756),z=a(527),F=a(65),D=a(30),I=a(33);a.d(B,"a",function(){return H});class H{constructor(N,U,L){L=void 0===L?null:L;this.cOc=new h.a;const J=new b.a;U&&J.add(U.UWi);L&&J.addRange(L);this.jm=N;this.ySg=J}Wmd(N,U,L,J,P,K,ca,T,Q,fa){fa=Object.assign(new f,{startTime:n.pz(),callback:fa});try{const ra=!!L&&""!==L;var ha=fa.startTime;const Z=this.getOsfControl(N);let wa=Z.getStoreType()||"",la=Z.getOwnerAddinStoreType()||"",ta=Z.getSolutionId()||
"";const Ca=Z.getVersion()||"";wa=wa.toLowerCase();la=la.toLowerCase();ta=ta.toLowerCase();var Ea=F.a.upd(U)||"";const Ga=F.a.upd(Z.getIframeUrl())||"",Oa=Ea.toLowerCase()===Ga.toLowerCase();Ea=wa;"inmemory"===wa&&(Ea=la);const eb=Telemetry.PrivacyRules.GetPrivacyCompliantId(ta,Ea,Z.getAssetId(),null,null,Z.getStoreId()),nb={["callInstanceId"]:ha.toString(),["controlSolutionId"]:eb,["controlVersion"]:Ca,["storeType"]:wa,["ownerStoreType"]:la,["allowConsentPrompt"]:J.toString(),["forMSGraphAccess"]:P.toString(),
["allowSignInPrompt"]:K.toString(),["hasAddinAuthChallenge"]:ra.toString(),["securityOriginEqualsSourceLocation"]:Oa.toString(),["singleSignOnEnabled"]:ca.toString(),["accountTypeFilter"]:T||""};c.ULS.sendTraceTag(51401115,344,50,"{0}",nb);t.a.sendTelemetryEvent(Object.assign(new m.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:x.a.Kl(nb)}));ha=!0;const $a=u.AFrameworkApplication.da.Ra("HostAuthType");switch(T){case "aad":ha="aad"===$a;break;case "msa":ha="msa"===$a;break;
default:ha=!T||"noFilter"===T}if(ha){T=null;if(ca)for(const oa of this.ySg)if(oa.fFi(ta)){T=oa;break}T?this.isSSOAddin(N)?(ca=!0,"omex"===Ea&&(ca=!1),"spapp"===Ea||"spcatalog"===Ea?(c.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),n.O9(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):P&&!ca?(c.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),n.O9(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)):(P&&"exchange"===Ea&&(J=!1),this.Vmd(N,U,L,Ea,J,K,Q,T,fa))):(c.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),n.O9(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):n.O9(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else n.O9(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(ra){this.ltc(),c.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",
ra.message),n.O9(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(N,U,L,J){this.Wmd(N,L[y.a.$4c]||null,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,U,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,L[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,J)}Vmd(N,U,L,J,P,K,ca,T,Q){this.cOc.Hd(N)?J=this.cOc.ka(N):(J=new A(N,this.getWebApplicationResource(N).split(",")[0],J,this.getDefaultDisplayName(N)),this.cOc.add(N,J));const fa=J.resource;N=H.fgi(fa,this.getWebApplicationId(N));const ha=OfficeExt.WACUtils.getHostSecure(U);N&&ha?N.toLowerCase()===ha.toLowerCase()?J.Vmd(P,K,L,ca,T,Q):(H.CSa('SSO Resource "'+fa+'" cannot be used from "'+U+'" origin due to domain mismatch.'),
c.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),n.O9(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(N||c.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),ha||c.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),n.O9(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}ltc(){c.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(N){return this.jm.getOsfControl(N)}isSSOAddin(N){return this.getOsfControl(N).getManifest().isSSOAddin()}getWebApplicationId(N){return this.getOsfControl(N).getManifest().getWebApplicationId()}getWebApplicationResource(N){return this.getOsfControl(N).getManifest().getWebApplicationResource()}getDefaultDisplayName(N){return this.getOsfControl(N).getManifest().getDefaultDisplayName()}static Thi(){try{const N=
{};D.a.rBa&&z.a.GEb&&(N.UiHostSupportsAuthTokenAddinList=H.b6e);N.UiHostSupportsAuthToken=z.a.GEb;return N}catch(N){c.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",N.message)}return null}static getInstance(N,U,L){H.La||(H.La=new H(N,void 0===L?null:L));return H.La}static CSa(N){window.console.warn&&window.console.warn(N)}static fgi(N,U){if(!N)return"";U||(U="");let L=N.toLowerCase();var J=U.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(J)||
(H.CSa('SSO App Id "'+U+'" is not a valid format. It will be rejected from store submission.'),c.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));L.endsWith(J)||(H.CSa('SSO Resource "'+N+'" does not end with App Id "'+U+'". It will be rejected from store submission.'),c.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!L.startsWith("https://")&&!L.startsWith("api://"))return H.CSa('SSO Resource "'+N+'" must be https:// or api:// protocol.'),c.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(U=0;U<N.length;U++){J=N.charAt(U);const P=I.a.charCodeAt(N,U);if(33>P||126<P||"&"===J||"?"===J||"#"===J||"%"===J||"\\"===J)return H.CSa('SSO Resource "'+N+'" contains an invalid character "'+J+'".'),c.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+J+"' in resource URI."),""}if(0<=N.indexOf("::"))return H.CSa('SSO Resource "'+N+'" contains an invalid string "::".'),c.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
N.length)return H.CSa('SSO Resource "'+N+'" is '+N.length+" characters and exceeds the max length of 120 characters."),c.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+N.length+"."),"";L.startsWith("api://")&&(L="https://"+L.substring(6,L.length));return 8===L.length?"":OfficeExt.WACUtils.getHostSecure(L)||""}}H.b6e="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");H.La=null;Object(w.a)(H,
"AppsForOfficeSingleSignOnManager",null,[808])},1295:function(w,B,a){a.r(B);w=a(0);var b=a(16),c=a(143),h;(function(t){t[t.none=0]="none";t[t.testEvent=1]="testEvent";t[t.test1Event=2]="test1Event";t[t.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";t[t.worksheetActivatedEvent=11]="worksheetActivatedEvent";t[t.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";t[t.worksheetAddedEvent=13]="worksheetAddedEvent";t[t.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";
t[t.worksheetDeletedEvent=15]="worksheetDeletedEvent";t[t.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";t[t.worksheetFilteredEvent=17]="worksheetFilteredEvent";t[t.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";t[t.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";t[t.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";t[t.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";t[t.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";t[t.worksheetFormulaChangedEvent=
23]="worksheetFormulaChangedEvent";t[t.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";t[t.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";t[t.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";t[t.worksheetMovedEvent=27]="worksheetMovedEvent";t[t.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";t[t.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";t[t.workbookFormulaReferenceStyleChangedEvent=30]=
"workbookFormulaReferenceStyleChangedEvent";t[t.chartAddedEvent=50]="chartAddedEvent";t[t.chartActivatedEvent=51]="chartActivatedEvent";t[t.chartDeactivatedEvent=52]="chartDeactivatedEvent";t[t.chartDeletedEvent=53]="chartDeletedEvent";t[t.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";t[t.tableDataChangedEvent=101]="tableDataChangedEvent";t[t.tableAddedEvent=102]="tableAddedEvent";t[t.tableDeletedEvent=103]="tableDeletedEvent";t[t.tableFilteredEvent=104]="tableFilteredEvent";t[t.agaveVisualUpdateEvent=
150]="agaveVisualUpdateEvent";t[t.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";t[t.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";t[t.commentAddedEvent=250]="commentAddedEvent";t[t.commentDeletedEvent=251]="commentDeletedEvent";t[t.commentChangedEvent=252]="commentChangedEvent";t[t.invocationMessage=1E3]="invocationMessage";t[t.cancellationMessage=1001]="cancellationMessage";t[t.metadataMessage=1002]="metadataMessage";t[t.visualSelectionChangedEvent=
2E3]="visualSelectionChangedEvent";t[t.visualChangeEvent=2001]="visualChangeEvent";t[t.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";t[t.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";t[t.shapeActivatedEvent=2101]="shapeActivatedEvent";t[t.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";t[t.shapeAddedEvent=2103]="shapeAddedEvent";t[t.shapeDeletedEvent=2104]="shapeDeletedEvent";t[t.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";
t[t.wacOperationEvent=2201]="wacOperationEvent";t[t.recordingStateChangedEvent=2202]="recordingStateChangedEvent";t[t.workbookActivatedEvent=2203]="workbookActivatedEvent";t[t.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";t[t.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";t[t.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";t[t.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";
t[t.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";t[t.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";t[t.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";t[t.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";t[t.rangePickerDeactivatedEvent=2701]="rangePickerDeactivatedEvent";t[t.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";t[t.lineageActivityFilterUpdatedEvent=
2801]="lineageActivityFilterUpdatedEvent";t[t.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";t[t.pivotTableAddedEvent=2900]="pivotTableAddedEvent";t[t.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";t[t.namedItemAddedEvent=3E3]="namedItemAddedEvent";t[t.namedItemDeletedEvent=3001]="namedItemDeletedEvent";t[t.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";t[t.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";
t[t.vbaRecorderRecordingChanged2Event=3202]="vbaRecorderRecordingChanged2Event";t[t.workbookActionRecordedEvent=3201]="workbookActionRecordedEvent";t[t.externalCodeServiceDiagnosticsNewEntryEvent=3300]="externalCodeServiceDiagnosticsNewEntryEvent";t[t.externalCodeServiceDiagnosticsFilterUpdatedEvent=3301]="externalCodeServiceDiagnosticsFilterUpdatedEvent";t[t.rangeValuesPreviewDismissedEvent=3400]="rangeValuesPreviewDismissedEvent";t[t.applicationUndoChangedEvent=3500]="applicationUndoChangedEvent";
t[t.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";t[t.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent";t[t.augmentationLoopAnnotationAddedEvent=65541]="augmentationLoopAnnotationAddedEvent"})(h||(h={}));Object(w.b)("MessageType",h);var f=a(806),e=a(263),k=a(777),l=a(60),r=a(40),v=a(186),u=a(1);a.d(B,"DdaEventDispatch",function(){return x});class x{constructor(t){this.ZD=null;this.Tqg={};this.Vqg={};this.ald={};this.mJd={};this.std=(m,
n)=>{m=this.$.pe.xf("Task","DdaEventDispatch.HandleServerEvent");n=n.fdg;for(let F=0;F<n.length;F++)switch(n[F].EventType){case 2:var A=n[F],y={};y.Name=A.Name;y.BindingType=A.BindingType;y.ColCount=A.ColCount;y.RowCount=A.RowCount;this.Uza(A.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,y,null);break;case 4:this.Uza(n[F].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(A=n[F],A.InstanceId){y=Array(A.Entries.length);for(var z=0;z<A.Entries.length;z++)y[z]=
x.rkc(A.Entries[z],A.IsRemoteOverride);0<A.Entries.length&&1===A.Entries[0].Category?this.arj(A.InstanceId,y):A.InstanceId&&this.Uza(A.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,y)}else{this.ald={};this.mJd={};for(y=0;y<A.Entries.length;y++)this.qWe(A.Entries[y],A.IsRemoteOverride);A=JSON.stringify(this.ald);y=JSON.stringify(this.mJd);z=JSON.stringify(this.Tqg);const D=JSON.stringify(this.Vqg);b.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${A}, Number of Not Fired event: ${y}, Total Number of Fired event: ${z}, Total Number of Not Fired event: ${D}`)}}m.stop()};
this.aSb=(m,n)=>{this.Uza(m,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,n)};this.$=t;this.LEc=this.std}G6b(t){t&&(this.Gma(),this.ZD.push(t))}cCc(t){this.ZD&&(Array.remove(this.ZD,t),this.ZD.length||(this.$.wantServerEvents=!1,this.$.hFj(this.LEc),this.ZD=null))}arj(t,m){const n=Object(c.a)(k.DdaFacade,e.a(this.$));r.TaskExtensions.Aa(n.hdi(t),A=>{if(v.b(A)){var y=A.result;A=n.$o(y);if(y)if(A.bqc)this.Uza(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m);else if(A.Hcc)for(y=0;y<m.length;y++)A.Hcc.push(m[y]);
else A.Hcc=m}else A.vi?b.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):A.Yj&&b.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ma,0)}zrj(t,m){const n=Object(c.a)(k.DdaFacade,e.a(this.$)),A=n.x1h(t);A?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(A,m,this.aSb):n.Poh(t,m)}qWe(t,m){let n=!1;const A=parseInt(t.Type,
10);var y=t.Target;const z=Object(c.a)(k.DdaFacade,e.a(this.$));if((y=z.Ij.ndi(A,y))&&0<Object.keys(y).length){n=!0;for(let D in y)if(y=D,z.Ij.a8b(y)){const I=Array(1);I[0]=x.rkc(t,m);if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var F=I[0][3];if(void 0!==F&&null!==F&&(F=Object(c.a)(Object,l.a.kl(F)))&&void 0!==F.triggerControlId&&null!==F.triggerControlId&&void 0!==F.triggerSource&&null!==F.triggerSource){let H=!1;m?(F.triggerSource="Unknown",H=!0):z.HCh(F.triggerControlId,
y)&&(F.triggerSource="ThisLocalAddin",H=!0);H&&(I[0][3]=l.a.ff(F))}}this.Uza(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,I)}}n?(this.Zmc(h[A],this.ald),this.Zmc(h[A],this.Tqg)):(this.Zmc(h[A],this.mJd),this.Zmc(h[A],this.Vqg))}Gma(){this.ZD||(this.ZD=[],this.$.hBe(this.LEc),this.$.wantServerEvents=!0)}Zmc(t,m){t in m||(m[t]=0);m[t]+=1}cG(t,m,n){const A={};A.Target=m;A.Category=65536;A.Type=t;A.Message=n;A.Id=-1;this.qWe(A,!1)}gWh(t,m){const n={Target:"",Category:2,Type:1E3};n.Message=m;n.Id=
0;m=Array(1);m[0]=x.rkc(n,!1);this.zrj(t,m)}ihc(t,m,n,A){const y={};y.Target=n;y.Category=65536;y.Type=m;y.Message=A;y.Id=-1;m=Array(1);m[0]=x.rkc(y,!1);this.Uza(t,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m)}fWh(t,m){this.Uza(t,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,m)}Uza(t,m,n,A){if(this.ZD){var y=Object(c.a)(k.DdaFacade,e.a(this.$));if(!y||m!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&m!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||y.Ij.a8b(t)){t=new f.a(m,t,
n,A);for(let z=0,F=this.ZD.length;z<F;z++)(m=this.ZD[z])&&m(t)}}}static rkc(t,m){const n=Array(6);n[0]=t.Category;n[1]=t.Type;n[2]=t.Target;n[3]=t.Message;n[4]=t.Id;n[5]=m;return n}}Object(w.a)(x,"DdaEventDispatch",null,[])},1317:function(w,B,a){a.d(B,"a",function(){return c});w=a(0);B=a(153);var b=a(95);class c extends B.a{constructor(){super(void 0,void 0,void 0,!0);this.BHa="AddinCommandsUILessDialog";this.i1c="WACDialogTitleText";this.Z_="0";this.eH=380;this.kF=190;this.Rg=this.BHa;this.ke=5;
this.yHg=String.format("{0}px",this.eH);this.Y_=String.format("{0}px",this.kF);this.mkf=this.Gw=!1;this.Rz()}Rz(){super.Rz();this.tk.style.width=this.yHg;this.tk.style.height=this.Y_;this.tk.style.padding=this.Z_}LB(h){this.OG();document.getElementById(this.qk(this.i1c)).innerText=h}OG(){super.OG();this.Md.style.width=String.format("{0}px",this.eH);this.Md.style.height=String.format("{0}px",this.kF);this.Md.removeAttribute(b.a.pg);this.Md.removeAttribute(b.a.DP)}hide(){this.z$a()}get Vda(){return this.tk}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(w.a)(c,"AddinCommandsUILessDialog",B.a,[767])},1325:function(w,B,a){a.r(B);var b={};a.r(b);a.d(b,"MacroRecorderEventHandler",function(){return gf});var c={};a.r(c);a.d(c,"AgaveOnSelectedReadoutHandler",function(){return Ui});var h=a(519),f=a(1),e=a(9),k=a(0),l=a(233),r=a(198),v=a(606);class u{constructor(){this.nmb=null}get e8g(){this.nmb||(this.nmb=new r.a,this.nmb.add(12),this.nmb.add(11));return this.nmb}yCi(M){return this.e8g.contains(M.operation)}Nhk(M){const za=[],Ab=M.payload;
for(const ec of Ab.batchedOperations)za.push(new v.a(M.operation,ec));return za}}Object(k.a)(u,"MacroRecorderBatchedEventList",null,[]);var x=a(734),t=a(16);class m{constructor(){this.YRc=this.ZRc=this.fYc=this.I1c=null}get operations(){this.fYc||(this.fYc=new r.a,this.Ae());return this.fYc}get kMc(){this.I1c||(this.I1c=new r.a,this.Oi());return this.I1c}get J4e(){this.YRc||(this.YRc=new r.a);return this.YRc}get featureGates(){this.ZRc||(this.ZRc=new r.a,this.kwd());return this.ZRc}Oi(){}kwd(){}Uf(M){this.kMc.add(M)}te(M){this.operations.contains(M)||
this.operations.add(M)}Bye(M){this.J4e.add(M)}}Object(k.a)(m,"MacroRecorderEventBase",null,[]);class n extends m{constructor(){super()}get eventId(){return 130}Ae(){this.te(100)}}Object(k.a)(n,"AccessibilityCheckRunEvent",m,[]);class A extends m{constructor(){super()}get eventId(){return 160}Ae(){this.te(241)}Oi(){this.Uf(M=>M.addToPrintArea)}}Object(k.a)(A,"AddedToPrintAreaEvent",m,[]);class y extends m{constructor(){super()}get eventId(){return 65}Ae(){this.te(516)}}Object(k.a)(y,"AutoFilterToggledEvent",
m,[]);class z extends m{constructor(){super()}get eventId(){return 118}Ae(){this.te(502)}Oi(){this.Uf(M=>!(M.O9a().FirstColumn===M.O9a().LastColumn&&M.O9a().FirstRow===M.O9a().LastRow))}}Object(k.a)(z,"AutoSumEvent",m,[]);class F extends m{constructor(){super()}get eventId(){return 223}Ae(){this.te(1032)}}Object(k.a)(F,"CellImageAltTextAppliedEvent",m,[]);class D extends m{constructor(M,za){super();this.jja=M;this.Epk=za}get eventId(){return this.jja}Ae(){this.te(529);this.te(594)}Oi(){this.Uf(M=>
this.Epk.includes(M.qqd()))}}Object(k.a)(D,"ChartPropertyAppliedEventBase",m,[]);class I extends D{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(k.a)(I,"ChartAxisChangedEvent",D,[]);class H extends D{constructor(){super(80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(k.a)(H,"ChartAxisTitleChangedEvent",D,[]);class N extends D{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(k.a)(N,"ChartDataLabelsChangedEvent",
D,[]);class U extends D{constructor(){super(76,[-100])}}Object(k.a)(U,"ChartDataSelectedEvent",D,[]);class L extends D{constructor(){super(83,[500,501,502])}}Object(k.a)(L,"ChartDataTableChangedEvent",D,[]);var J=a(664),P=a(382),K=a(353),ca=a(143);class T extends m{constructor(){super()}}Object(k.a)(T,"RichApiRequestExecutedEventBase",m,[]);class Q{constructor(M,za,Ab){this.response=this.request=this.eventId=this.source=null;M&&(this.source=M.source,this.eventId=M.eventId,this.request=za,this.response=
Ab)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(k.a)(Q,"MacroRecorderRichApiRequestExecutedPayload",null,[129]);class fa extends T{constructor(){super()}get eventId(){return 117}BC(M){fa.W$||(fa.W$=new J.a(P.a.Ei()),fa.W$.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),fa.W$.add("fa000000014"));return!!M&&fa.W$.contains(M.toLowerCase())}Ae(){this.te(507);this.te(10);this.te(576)}Oi(){this.Uf(M=>Object(K.a)(Q,M)&&(M=Object(ca.a)(Q,
M),M.isValid&&this.BC(M.source))?(t.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${M.eventId}`),!0):!1)}}fa.W$=null;Object(k.a)(fa,"ChartFormatRichApiRequestExecutedEvent",T,[]);class ha extends D{constructor(){super(85,[328,329,330,331,332,333,334,335])}}Object(k.a)(ha,"ChartGridlinesChangedEvent",D,[]);class Ea extends m{constructor(){super()}get eventId(){return 66}Ae(){this.te(528)}}Object(k.a)(Ea,"ChartInsertedEvent",m,[]);
class ra extends D{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(k.a)(ra,"ChartLegendChangedEvent",D,[]);class Z extends D{constructor(){super(75,[-101])}}Object(k.a)(Z,"ChartRowColumnSwitchedEvent",D,[]);class wa extends D{constructor(){super(79,[0,1,2,-102])}}Object(k.a)(wa,"ChartTitleChangedEvent",D,[]);class la extends D{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,
-222,-220,-129,-130,-131])}}Object(k.a)(la,"ChartTypeChangedEvent",D,[]);class ta extends m{constructor(){super()}get eventId(){return 131}Ae(){this.te(521)}}Object(k.a)(ta,"ConnectorFloatingObjectResizedEvent",m,[]);class Ca extends m{constructor(){super()}get eventId(){return 129}Ae(){this.te(109)}}Object(k.a)(Ca,"EntitySelectedEvent",m,[]);class Ga extends m{constructor(){super()}get eventId(){return 49}Ae(){this.te(149);this.te(147)}}Object(k.a)(Ga,"FindCellEvent",m,[]);class Oa extends m{constructor(){super()}get eventId(){return 96}Ae(){this.te(122)}}
Object(k.a)(Oa,"FloatingObjectAltTextAppliedEvent",m,[]);class eb extends m{constructor(){super()}get eventId(){return 93}Ae(){this.te(522)}}Object(k.a)(eb,"FloatingObjectDeletedEvent",m,[]);class nb extends m{constructor(){super()}get eventId(){return 94}Ae(){this.te(524)}}Object(k.a)(nb,"FloatingObjectMovedAndResizedEvent",m,[]);class $a extends m{constructor(){super()}get eventId(){return 95}Ae(){this.te(523)}}Object(k.a)($a,"FloatingObjectRotatedEvent",m,[]);class oa extends m{constructor(){super()}get eventId(){return 100}Ae(){this.te(543)}}
Object(k.a)(oa,"GroupDetailsShownOrHiddenEvent",m,[]);class Fa extends m{constructor(){super()}get eventId(){return 154}Ae(){this.te(125)}}Object(k.a)(Fa,"HyperlinksRemovedFromRangeEvent",m,[]);class X extends T{constructor(){super()}get eventId(){return 125}BC(M){X.W$||(X.W$=new J.a(P.a.Ei()),X.W$.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),X.W$.add("fa000000005"));return!!M&&X.W$.contains(M.toLowerCase())}Ae(){this.te(507);this.te(10);this.te(576)}Oi(){this.Uf(M=>Object(K.a)(Q,M)?(M=Object(ca.a)(Q,
M),M.isValid&&this.BC(M.source)):!1)}}X.W$=null;Object(k.a)(X,"IdeasRichApiRequestExecutedEvent",T,[]);class va extends m{constructor(){super()}get eventId(){return 136}Ae(){this.te(115)}}Object(k.a)(va,"LinkedEntityConvertedEvent",m,[]);class xa extends m{constructor(){super()}get eventId(){return 148}Ae(){this.te(114)}}Object(k.a)(xa,"LinkedEntityDisambiguationPaneToggledEvent",m,[]);class Pa extends m{constructor(){super()}get eventId(){return 127}Ae(){this.te(119)}}Object(k.a)(Pa,"MovedToEdgeEvent",
m,[]);class Ka extends m{constructor(){super()}get eventId(){return 135}Ae(){this.te(191)}}Object(k.a)(Ka,"NamedSheetViewCreatedEvent",m,[]);class Bb extends m{constructor(){super()}get eventId(){return 166}Ae(){this.te(200)}}Object(k.a)(Bb,"NamedSheetViewDeletedEvent",m,[]);class xb extends m{constructor(){super()}get eventId(){return 133}Ae(){this.te(192)}}Object(k.a)(xb,"NamedSheetViewExitedEvent",m,[]);class Ua extends m{constructor(){super()}get eventId(){return 162}Ae(){this.te(199)}}Object(k.a)(Ua,
"NamedSheetViewRenamedEvent",m,[]);class Jb extends m{constructor(){super()}get eventId(){return 167}Ae(){this.te(195)}}Object(k.a)(Jb,"NamedSheetViewSwitchedEvent",m,[]);class fc extends m{constructor(){super()}get eventId(){return 99}Ae(){this.te(174)}}Object(k.a)(fc,"OutlineLevelSetEvent",m,[]);class ya extends m{constructor(){super()}get eventId(){return 156}Ae(){this.te(244)}}Object(k.a)(ya,"PageBreakInsertedEvent",m,[]);class ob extends m{constructor(){super()}get eventId(){return 157}Ae(){this.te(245)}}
Object(k.a)(ob,"PageBreakRemovedEvent",m,[]);class Sb extends m{constructor(){super()}get eventId(){return 158}Ae(){this.te(246)}}Object(k.a)(Sb,"PageBreaksAllResetEvent",m,[]);class Ba extends m{constructor(){super()}get eventId(){return 112}Ae(){this.te(503)}Oi(){this.Uf(M=>!!M.pasteParameters.ClientEstimationFloatingObjectId&&2===M.pasteParameters.CopyPasteTargetType&&!M.isFromCurrentSession)}}Object(k.a)(Ba,"PasteArtOtherWorkbookEvent",m,[]);class Ia extends m{constructor(){super()}get eventId(){return 52}Ae(){this.te(503)}Oi(){this.Uf(M=>
!!M.pasteParameters.ClientEstimationFloatingObjectId&&2===M.pasteParameters.CopyPasteTargetType&&M.isFromCurrentSession)}}Object(k.a)(Ia,"PasteArtSameWorkbookEvent",m,[]);class cb extends m{constructor(){super()}get eventId(){return 110}Ae(){this.te(204)}}Object(k.a)(cb,"PasteHtmlEvent",m,[]);class Kb extends m{constructor(){super()}get eventId(){return 35}Ae(){this.te(506)}}Object(k.a)(Kb,"PasteRangeEvent",m,[]);class db extends m{constructor(){super()}get eventId(){return 111}Ae(){this.te(503)}Oi(){this.Uf(M=>
1===M.pasteParameters.CopyPasteTargetType)}}Object(k.a)(db,"PasteShadowWorkbookRangeEvent",m,[]);class gb extends m{constructor(){super()}get eventId(){return 42}Ae(){this.te(180)}}Object(k.a)(gb,"PasteStringEvent",m,[]);class yb extends m{constructor(){super()}get eventId(){return 134}Ae(){this.te(220)}}Object(k.a)(yb,"PendingMergeEvent",m,[]);class Nb extends m{constructor(){super()}get eventId(){return 122}Ae(){this.te(510)}}Object(k.a)(Nb,"PictureInsertedEvent",m,[]);class qc extends m{constructor(){super()}get eventId(){return 153}Ae(){this.te(161)}}
Object(k.a)(qc,"PivotDrillToggledEvent",m,[]);class Gb extends m{constructor(M,za){super();this.jja=M;this.opType=za}get eventId(){return this.jja}Ae(){this.te(225)}Oi(){this.Uf(M=>M.opType===this.opType)}}Object(k.a)(Gb,"PivotTableSettingsChangedEventBase",m,[]);class hb extends Gb{constructor(){super(171,4)}}Object(k.a)(hb,"PivotTableAllItemLabelsRepeatedEvent",Gb,[]);class qb extends Gb{constructor(){super(184,17)}}Object(k.a)(qb,"PivotTableAltTextDescriptionChangedEvent",Gb,[]);class ab extends Gb{constructor(){super(183,
16)}}Object(k.a)(ab,"PivotTableAltTextTitleChangedEvent",Gb,[]);class Mb extends Gb{constructor(){super(173,6)}}Object(k.a)(Mb,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",Gb,[]);class Ib extends Gb{constructor(){super(172,5)}}Object(k.a)(Ib,"PivotTableBlankLineAfterEachItemToggledEvent",Gb,[]);class fb extends Gb{constructor(){super(170,3)}}Object(k.a)(fb,"PivotTableColumnGrandTotalShownEvent",Gb,[]);class Db extends m{constructor(){super()}get eventId(){return 98}Ae(){this.te(132)}}Object(k.a)(Db,
"PivotTableCreatedEvent",m,[]);class Za extends Gb{constructor(){super(177,10)}}Object(k.a)(Za,"PivotTableDisplayErrorStringToggledEvent",Gb,[]);class sb extends Gb{constructor(){super(178,11)}}Object(k.a)(sb,"PivotTableDisplayNullStringToggledEvent",Gb,[]);class sa extends Gb{constructor(){super(179,12)}}Object(k.a)(sa,"PivotTableErrorStringChangedEvent",Gb,[]);class ba extends Gb{constructor(){super(174,7)}}Object(k.a)(ba,"PivotTableExpandCollapseButtonsShownEvent",Gb,[]);class ua extends Gb{constructor(){super(187,
20)}}Object(k.a)(ua,"PivotTableIndentChangedEvent",Gb,[]);class R extends Gb{constructor(){super(176,9)}}Object(k.a)(R,"PivotTableItemsWithNoDataOnColumnsShownEvent",Gb,[]);class Y extends Gb{constructor(){super(175,8)}}Object(k.a)(Y,"PivotTableItemsWithNoDataOnRowsShownEvent",Gb,[]);class La extends Gb{constructor(){super(186,19)}}Object(k.a)(La,"PivotTableLayoutTypeSetEvent",Gb,[]);class Ma extends Gb{constructor(){super(180,13)}}Object(k.a)(Ma,"PivotTableNullStringChangedEvent",Gb,[]);class lb extends m{constructor(){super()}get eventId(){return 149}Ae(){this.te(219)}}
Object(k.a)(lb,"PivotTablePivotLocationChangedEvent",m,[]);class pb extends m{constructor(){super()}get eventId(){return 102}Ae(){this.te(145)}}Object(k.a)(pb,"PivotTablePivotedEvent",m,[]);class Vb extends Gb{constructor(){super(182,15)}}Object(k.a)(Vb,"PivotTableRefreshDataOnLoadToggledEvent",Gb,[]);class Wa extends m{constructor(){super()}get eventId(){return 104}Ae(){this.te(50)}Oi(){this.Uf(M=>!!M.pivotTableId&&!!M.pivotTableName)}}Object(k.a)(Wa,"PivotTableRefreshedEvent",m,[]);class ka extends Gb{constructor(){super(168,
1)}}Object(k.a)(ka,"PivotTableRenamedEvent",Gb,[]);class Sa extends Gb{constructor(){super(169,2)}}Object(k.a)(Sa,"PivotTableRowGrandTotalShownEvent",Gb,[]);class Xb extends Gb{constructor(){super(181,14)}}Object(k.a)(Xb,"PivotTableSaveSourceDataWithFileToggledEvent",Gb,[]);var Mc=a(626);class jc extends m{constructor(){super()}get eventId(){return 155}Ae(){this.te(131)}Oi(){this.Uf(M=>{M=Object(ca.a)(Mc.a,M);return!!M&&!!M.QOa()&&!!M.hierarchyName})}}Object(k.a)(jc,"PivotTableSortedEvent",m,[]);
class $c extends Gb{constructor(){super(185,18)}}Object(k.a)($c,"PivotTableSubTotalsVisibilitySettingSetEvent",Gb,[]);class Jd extends m{constructor(){super()}get eventId(){return 206}Ae(){this.te(560)}}Object(k.a)(Jd,"PivotValueFieldSettingAppliedEvent",m,[]);class fd extends m{constructor(){super()}get eventId(){return 161}Ae(){this.te(243)}}Object(k.a)(fd,"PrintAreaClearedEvent",m,[]);class Kd extends m{constructor(){super()}get eventId(){return 159}Ae(){this.te(241)}Oi(){this.Uf(M=>!M.addToPrintArea)}}
Object(k.a)(Kd,"PrintAreaSetEvent",m,[]);class Yd extends m{constructor(){super()}get eventId(){return 57}Ae(){this.te(517)}}Object(k.a)(Yd,"RangeAutoFilterClearedEvent",m,[]);class te extends m{constructor(M,za){super();this.jja=M;this.k$d=za}get eventId(){return this.jja}Ae(){this.te(11)}Oi(){this.Uf(M=>16===M.q2().ValidMembers);this.Uf(M=>M.q2().Font.ValidMembers===this.k$d)}}Object(k.a)(te,"RangeFontFormattedEventBase",m,[]);class ve extends te{constructor(){super(3,4)}}Object(k.a)(ve,"RangeBoldedEvent",
te,[]);class qe extends m{constructor(){super()}get eventId(){return 2}Ae(){this.te(11)}Oi(){this.Uf(M=>128===M.q2().ValidMembers)}}Object(k.a)(qe,"RangeBorderedEvent",m,[]);class pc{}pc.hfb="Table";pc.kyc="Sheet";Object(k.a)(pc,"MacroRecorderEventConstants",null,[]);class nd extends m{constructor(){super()}get eventId(){return 113}Ae(){this.te(208)}Oi(){this.Uf(M=>M.getParameters().FilterType===pc.kyc)}}Object(k.a)(nd,"RangeCheckedItemsFilteredEvent",m,[]);class qd extends m{constructor(){super()}get eventId(){return 109}Ae(){this.te(105)}}
Object(k.a)(qd,"RangeConditionalFormattingCreatedEvent",m,[]);class tb extends m{constructor(){super()}get eventId(){return 124}Ae(){this.te(221)}}Object(k.a)(tb,"RangeConditionalFormattingRuleDeletedEvent",m,[]);class Dc extends m{constructor(){super()}get eventId(){return 29}Ae(){this.te(508)}Oi(){this.Uf(M=>3===M.Lt()||1===M.Lt()||4===M.Lt())}}Object(k.a)(Dc,"RangeContentClearedEvent",m,[]);class Tc extends m{constructor(){super()}get eventId(){return 40}Ae(){this.te(104)}}Object(k.a)(Tc,"RangeCopiedCutCellsInsertedEvent",
m,[]);class ub extends m{constructor(){super()}get eventId(){return 114}Ae(){this.te(209)}Oi(){this.Uf(M=>M.getParameters().FilterType===pc.kyc)}}Object(k.a)(ub,"RangeCustomFilteredEvent",m,[]);class Pb extends m{constructor(){super()}get eventId(){return 106}Ae(){this.te(121)}}Object(k.a)(Pb,"RangeDataValidationChangedEvent",m,[]);class ee extends te{constructor(){super(4,64)}}Object(k.a)(ee,"RangeDoubleUnderlinedEvent",te,[]);class Ad extends m{constructor(){super()}get eventId(){return 69}Ae(){this.te(190)}}
Object(k.a)(Ad,"RangeDuplicatesRemovedEvent",m,[]);class Ub extends m{constructor(){super()}get eventId(){return 1}Ae(){this.te(527);this.te(12)}}Object(k.a)(Ub,"RangeEditedEvent",m,[]);class tc extends m{constructor(){super()}get eventId(){return 164}Ae(){this.te(255)}Oi(){this.Uf(M=>4===M.actionType)}}Object(k.a)(tc,"RangeExternalLinksBrokeAllLinksEvent",m,[]);class yc extends m{constructor(){super()}get eventId(){return 119}Ae(){this.te(255)}Oi(){this.Uf(M=>3===M.actionType)}}Object(k.a)(yc,"RangeExternalLinksBrokeLinkEvent",
m,[]);class Sd extends m{constructor(){super()}get eventId(){return 205}Ae(){this.te(256)}kwd(){this.Bye("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(k.a)(Sd,"RangeExternalLinksChangeSourceEvent",m,[]);class Fd extends m{constructor(){super()}get eventId(){return 163}Ae(){this.te(553)}Oi(){this.Uf(M=>1===M.actionType)}}Object(k.a)(Fd,"RangeExternalLinksRefreshedAllEvent",m,[]);class se extends m{constructor(){super()}get eventId(){return 77}Ae(){this.te(553)}Oi(){this.Uf(M=>
0===M.actionType)}}Object(k.a)(se,"RangeExternalLinksRefreshedEvent",m,[]);class uc extends m{constructor(){super()}get eventId(){return 165}Ae(){this.te(224)}}Object(k.a)(uc,"RangeExternalLinksSetAutoRefreshEvent",m,[]);class Ra extends m{constructor(){super()}get eventId(){return 5}Ae(){this.te(11)}Oi(){this.Uf(M=>64===M.q2().ValidMembers)}}Object(k.a)(Ra,"RangeFillColoredEvent",m,[]);class vb extends m{constructor(){super()}get eventId(){return 59}Ae(){this.te(155)}}Object(k.a)(vb,"RangeFilledEvent",
m,[]);class Gc extends m{constructor(){super()}get eventId(){return 115}Ae(){this.te(176)}Oi(){this.Uf(M=>M.autoFilterOptions.AutoFilterType===pc.kyc&&!!M.autoFilterOptions.CriteriaType)}}Object(k.a)(Gc,"RangeFilterAppliedEvent",m,[]);class cd extends m{constructor(){super()}get eventId(){return 58}Ae(){this.te(176)}Oi(){this.Uf(M=>M.autoFilterOptions.AutoFilterType===pc.kyc&&!M.autoFilterOptions.CriteriaType)}}Object(k.a)(cd,"RangeFilterClearedEvent",m,[]);class Cd extends m{constructor(){super()}get eventId(){return 41}Ae(){this.te(518)}}
Object(k.a)(Cd,"RangeFilterReappliedEvent",m,[]);class Rd extends m{constructor(){super()}get eventId(){return 86}Ae(){this.te(150)}}Object(k.a)(Rd,"RangeFlashFilledEvent",m,[]);class Be extends te{constructor(){super(6,32)}}Object(k.a)(Be,"RangeFontColoredEvent",te,[]);class ad extends te{constructor(){super(7,8)}}Object(k.a)(ad,"RangeFontItalicizedEvent",te,[]);class Qc extends te{constructor(){super(8,1)}}Object(k.a)(Qc,"RangeFontNamedEvent",te,[]);class Zd extends te{constructor(){super(9,2)}}
Object(k.a)(Zd,"RangeFontSizedEvent",te,[]);class Tb extends m{constructor(){super()}get eventId(){return 74}Ae(){this.te(215)}}Object(k.a)(Tb,"RangeFormattedAsTableEvent",m,[]);class Yc extends m{constructor(){super()}get eventId(){return 97}Ae(){this.te(188)}}Object(k.a)(Yc,"RangeGroupedOrUngroupedEvent",m,[]);class Ob extends m{constructor(){super()}get eventId(){return 60}Ae(){this.te(11)}Oi(){this.Uf(M=>2===M.q2().ValidMembers)}}Object(k.a)(Ob,"RangeHorizontallyAlignedEvent",m,[]);class kc extends m{constructor(){super()}get eventId(){return 43}Ae(){this.te(526)}}
Object(k.a)(kc,"RangeHyperlinkAppliedEvent",m,[]);class Kc extends m{constructor(){super()}get eventId(){return 63}Ae(){this.te(11)}Oi(){this.Uf(M=>256===M.q2().ValidMembers)}}Object(k.a)(Kc,"RangeIndentChangedEvent",m,[]);class Wc extends m{constructor(){super()}get eventId(){return 53}Ae(){this.te(156)}Oi(){this.Uf(M=>2===M.Lt()||5===M.Lt()||6===M.Lt()||7===M.Lt())}}Object(k.a)(Wc,"RangeMergedEvent",m,[]);class Nd extends m{constructor(){super()}get eventId(){return 107}Ae(){this.te(216)}}Object(k.a)(Nd,
"RangeNamedCellStyleAppliedEvent",m,[]);class Ud extends m{constructor(){super()}get eventId(){return 12}Ae(){this.te(11)}Oi(){this.Uf(M=>32===M.q2().ValidMembers)}}Object(k.a)(Ud,"RangeNumberFormattedEvent",m,[]);var $d=a(1017);class $b extends m{constructor(){super()}get eventId(){return 108}Ae(){this.te(141)}Oi(){this.Uf(M=>Object(K.a)($d.a,M))}}Object(k.a)($b,"RangeSortedEvent",m,[]);class nc extends te{constructor(){super(10,128)}}Object(k.a)(nc,"RangeStrikedThroughEvent",te,[]);class Oc extends te{constructor(){super(11,
16)}}Object(k.a)(Oc,"RangeUnderlinedEvent",te,[]);class Hd extends m{constructor(){super()}get eventId(){return 61}Ae(){this.te(11)}Oi(){this.Uf(M=>1===M.q2().ValidMembers)}}Object(k.a)(Hd,"RangeVerticallyAlignedEvent",m,[]);class re extends m{constructor(){super()}get eventId(){return 62}Ae(){this.te(11)}Oi(){this.Uf(M=>8===M.q2().ValidMembers)}}Object(k.a)(re,"RangeWrapTextToggledEvent",m,[]);class fe extends m{constructor(){super()}get eventId(){return 103}Ae(){this.te(51)}}Object(k.a)(fe,"RefreshedAllEvent",
m,[]);class oc extends m{constructor(){super()}get eventId(){return 47}Ae(){this.te(148)}}Object(k.a)(oc,"ReplaceAllEvent",m,[]);class Xc extends m{constructor(){super()}get eventId(){return 226}Ae(){this.te(1025)}}Object(k.a)(Xc,"SampleTableCreatedEvent",m,[]);class ud extends m{constructor(){super()}get eventId(){return 91}Ae(){this.te(532)}Oi(){this.Uf(M=>95!==M.getShapeType()&&96!==M.getShapeType()&&97!==M.getShapeType()&&98!==M.getShapeType()&&100!==M.getShapeType()&&102!==M.getShapeType()&&
103!==M.getShapeType())}}Object(k.a)(ud,"ShapeInsertedEvent",m,[]);class Vd extends m{constructor(){super()}get eventId(){return 92}Ae(){this.te(531)}}Object(k.a)(Vd,"ShapeStyleSetEvent",m,[]);var ge=a(862);class Je extends m{constructor(M,za){super();this.jja=M;this.k$d=za}get eventId(){return this.jja}Ae(){this.te(581)}Oi(){this.Uf(M=>Object(K.a)(ge.a,M)&&4===M.getShapeTextFormat().ValidMembers);this.Uf(M=>Object(K.a)(ge.a,M)&&M.getShapeTextFormat().Font.ValidMembers===this.k$d)}}Object(k.a)(Je,
"ShapeTextFontFormattedEventBase",m,[]);class Ke extends Je{constructor(){super(193,4)}}Object(k.a)(Ke,"ShapeTextBoldedEvent",Je,[]);var nf=a(1019);class uf extends m{constructor(){super()}get eventId(){return 191}Ae(){this.te(581)}Oi(){this.Uf(M=>Object(K.a)(nf.a,M))}}Object(k.a)(uf,"ShapeTextChangedEvent",m,[]);class ef extends Je{constructor(){super(196,32)}}Object(k.a)(ef,"ShapeTextFontColorChangedEvent",Je,[]);class Ve extends Je{constructor(){super(197,1)}}Object(k.a)(Ve,"ShapeTextFontNameChangedEvent",
Je,[]);class bd extends Je{constructor(){super(198,2)}}Object(k.a)(bd,"ShapeTextFontSizeChangedEvent",Je,[]);class be extends m{constructor(){super()}get eventId(){return 199}Ae(){this.te(581)}Oi(){this.Uf(M=>Object(K.a)(ge.a,M)&&2===M.getShapeTextFormat().ValidMembers)}}Object(k.a)(be,"ShapeTextHorizontallyAlignedEvent",m,[]);class jb extends Je{constructor(){super(194,8)}}Object(k.a)(jb,"ShapeTextItalicizedEvent",Je,[]);class lc extends Je{constructor(){super(195,16)}}Object(k.a)(lc,"ShapeTextUnderlinedEvent",
Je,[]);class Zc extends m{constructor(){super()}get eventId(){return 200}Ae(){this.te(581)}Oi(){this.Uf(M=>Object(K.a)(ge.a,M)&&1===M.getShapeTextFormat().ValidMembers)}}Object(k.a)(Zc,"ShapeTextVerticallyAlignedEvent",m,[]);class dd extends m{constructor(){super()}get eventId(){return 13}Ae(){this.te(138)}}Object(k.a)(dd,"SheetAddedEvent",m,[]);var Qd=a(8);class ue extends m{constructor(){super()}get eventId(){return 142}Ae(){this.te(237)}Oi(){this.Uf(M=>!!M.insertDeleteMultiRangeParameters);this.Uf(M=>
!M.insertDeleteMultiRangeParameters.IsTableCommand);this.Uf(M=>{M=M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>M.DeltaColumn&&!M.DeltaRow&&(!!M.InsertDeleteRange.FirstRow||M.InsertDeleteRange.LastRow!==Qd.a.vB)||!M.DeltaColumn&&0>M.DeltaRow&&(!!M.InsertDeleteRange.FirstColumn||M.InsertDeleteRange.LastColumn!==Qd.a.Dz)})}}Object(k.a)(ue,"SheetCellsDeletedEvent",m,[]);class qa extends m{constructor(){super()}get eventId(){return 143}Ae(){this.te(237)}Oi(){this.Uf(M=>!!M.insertDeleteMultiRangeParameters);
this.Uf(M=>!M.insertDeleteMultiRangeParameters.IsTableCommand);this.Uf(M=>{M=M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<M.DeltaColumn&&!M.DeltaRow&&(!!M.InsertDeleteRange.FirstRow||M.InsertDeleteRange.LastRow!==Qd.a.vB)||!M.DeltaColumn&&0<M.DeltaRow&&(!!M.InsertDeleteRange.FirstColumn||M.InsertDeleteRange.LastColumn!==Qd.a.Dz)})}}Object(k.a)(qa,"SheetCellsInsertedEvent",m,[]);class Xa extends m{constructor(){super()}get eventId(){return 139}Ae(){this.te(237)}Oi(){this.Uf(M=>
!!M.insertDeleteMultiRangeParameters);this.Uf(M=>!M.insertDeleteMultiRangeParameters.IsTableCommand);this.Uf(M=>0>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Uf(M=>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Qd.a.vB)}}Object(k.a)(Xa,"SheetColumnDeletedEvent",
m,[]);class wb extends m{constructor(){super()}get eventId(){return 138}Ae(){this.te(237)}Oi(){this.Uf(M=>!!M.insertDeleteMultiRangeParameters);this.Uf(M=>!M.insertDeleteMultiRangeParameters.IsTableCommand);this.Uf(M=>0<M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.Uf(M=>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
Qd.a.vB)}}Object(k.a)(wb,"SheetColumnInsertedEvent",m,[]);class Rb extends m{constructor(){super()}get eventId(){return 14}Ae(){this.te(137)}}Object(k.a)(Rb,"SheetDeletedEvent",m,[]);class vc extends m{constructor(){super()}get eventId(){return 137}Ae(){this.te(185)}}Object(k.a)(vc,"SheetDirectionChangedEvent",m,[]);class Nc extends m{constructor(){super()}get eventId(){return 54}Ae(){this.te(139)}}Object(k.a)(Nc,"SheetDuplicatedEvent",m,[]);class id extends m{constructor(){super()}get eventId(){return 15}Ae(){this.te(207)}}
Object(k.a)(id,"SheetNameEditedEvent",m,[]);class Id extends m{constructor(){super()}get eventId(){return 90}Ae(){this.te(151)}}Object(k.a)(Id,"SheetPaneFrozenEvent",m,[]);class me extends m{constructor(){super()}get eventId(){return 120}Ae(){this.te(226)}}Object(k.a)(me,"SheetPrintSettingsSavedEvent",m,[]);var Wb=a(909);class Ec extends m{constructor(){super()}get eventId(){return 215}Ae(){this.te(507)}kwd(){this.Bye("Microsoft.Office.Excel.SheetProtectionMacroRecording")}Oi(){this.Uf(M=>Object.getType(M)===
Wb.a)}}Object(k.a)(Ec,"SheetProtectionPausedResumedEvent",m,[]);class hd extends m{constructor(){super()}get eventId(){return 64}Ae(){this.te(557)}}Object(k.a)(hd,"SheetReorderedEvent",m,[]);class je extends m{constructor(){super()}get eventId(){return 141}Ae(){this.te(237)}Oi(){this.Uf(M=>!!M.insertDeleteMultiRangeParameters);this.Uf(M=>!M.insertDeleteMultiRangeParameters.IsTableCommand);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Uf(M=>0>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Uf(M=>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Qd.a.Dz)}}Object(k.a)(je,"SheetRowDeletedEvent",m,[]);class Ee extends m{constructor(){super()}get eventId(){return 140}Ae(){this.te(237)}Oi(){this.Uf(M=>!!M.insertDeleteMultiRangeParameters);this.Uf(M=>!M.insertDeleteMultiRangeParameters.IsTableCommand);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Uf(M=>0<M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.Uf(M=>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Qd.a.Dz)}}Object(k.a)(Ee,"SheetRowInsertedEvent",m,[]);class Ge extends m{constructor(){super()}get eventId(){return 39}Ae(){this.te(135)}}Object(k.a)(Ge,"SheetRowsColumnsAutoFitEvent",m,[]);class bf extends m{constructor(){super()}get eventId(){return 36}Ae(){this.te(136)}}
Object(k.a)(bf,"SheetRowsColumnsResizedEvent",m,[]);class of extends m{constructor(){super()}get eventId(){return 68}Ae(){this.te(183)}}Object(k.a)(of,"SheetShowGridlinesToggledEvent",m,[]);class hf extends m{constructor(){super()}get eventId(){return 67}Ae(){this.te(184)}}Object(k.a)(hf,"SheetShowHeadingsToggledEvent",m,[]);class na extends m{constructor(){super()}get eventId(){return 89}Ae(){this.te(213)}}Object(k.a)(na,"SheetSpellCheckedEvent",m,[]);class S extends m{constructor(){super()}get eventId(){return 70}Ae(){this.te(515)}}
Object(k.a)(S,"SheetTabColoredEvent",m,[]);class Ja extends m{constructor(){super()}get eventId(){return 71}Ae(){this.te(157)}}Object(k.a)(Ja,"SheetVisibilityChangedEvent",m,[]);class rb extends m{constructor(){super()}get eventId(){return 126}Ae(){this.te(239)}}Object(k.a)(rb,"SheetsVisibilityChangedEvent",m,[]);class ma extends m{constructor(){super()}get eventId(){return 188}Ae(){this.te(203)}}Object(k.a)(ma,"SlicerInsertedEvent",m,[]);class ib extends m{constructor(){super()}get eventId(){return 189}Ae(){this.te(173)}Oi(){this.Uf(M=>
!M.clearFilter)}}Object(k.a)(ib,"SlicerSelectionAppliedEvent",m,[]);class Qb extends m{constructor(){super()}get eventId(){return 190}Ae(){this.te(173)}Oi(){this.Uf(M=>M.clearFilter)}}Object(k.a)(Qb,"SlicerSelectionClearedEvent",m,[]);class Fc extends m{constructor(){super()}get eventId(){return 27}Ae(){this.te(208)}Oi(){this.Uf(M=>M.getParameters().FilterType===pc.hfb)}}Object(k.a)(Fc,"TableCheckedItemsFilteredEvent",m,[]);class jd extends m{constructor(){super()}get eventId(){return 144}Ae(){this.te(237)}Oi(){this.Uf(M=>
!!M.insertDeleteMultiRangeParameters);this.Uf(M=>M.insertDeleteMultiRangeParameters.IsTableCommand);this.Uf(M=>0>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(k.a)(jd,"TableColumnDeletedEvent",m,[]);class ke extends m{constructor(){super()}get eventId(){return 145}Ae(){this.te(237)}Oi(){this.Uf(M=>!!M.insertDeleteMultiRangeParameters);this.Uf(M=>M.insertDeleteMultiRangeParameters.IsTableCommand);
this.Uf(M=>0<M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(k.a)(ke,"TableColumnInsertedEvent",m,[]);var ne=a(1018);class Te extends m{constructor(){super()}get eventId(){return 121}Ae(){this.te(141)}Oi(){this.Uf(M=>Object(K.a)(ne.a,M))}}Object(k.a)(Te,"TableColumnSortedEvent",m,[]);class Hb extends m{constructor(){super()}get eventId(){return 105}Ae(){this.te(193)}}Object(k.a)(Hb,
"TableConvertedToRangeEvent",m,[]);class Cc extends m{constructor(){super()}get eventId(){return 16}Ae(){this.te(206)}}Object(k.a)(Cc,"TableCreatedEvent",m,[]);class vd extends m{constructor(){super()}get eventId(){return 30}Ae(){this.te(209)}Oi(){this.Uf(M=>M.getParameters().FilterType===pc.hfb)}}Object(k.a)(vd,"TableCustomFilteredEvent",m,[]);class le extends m{constructor(){super()}get eventId(){return 25}Ae(){this.te(187)}Oi(){this.Uf(M=>1===M.options.OperationType)}}Object(k.a)(le,"TableCustomSortedEvent",
m,[]);class De extends m{constructor(){super()}get eventId(){return 28}Ae(){this.te(176)}Oi(){this.Uf(M=>M.autoFilterOptions.AutoFilterType===pc.hfb);this.Uf(M=>0===M.autoFilterOptions.CriteriaType)}}Object(k.a)(De,"TableFilterClearedEvent",m,[]);class Ce extends m{constructor(){super()}get eventId(){return 32}Ae(){this.te(176)}Oi(){this.Uf(M=>M.autoFilterOptions.AutoFilterType===pc.hfb);this.Uf(M=>{const za=new r.a;za.add(1);za.add(2);za.add(8);za.add(9);za.add(10);za.add(11);za.add(12);za.add(13);
za.add(14);za.add(15);za.add(16);za.add(17);za.add(18);za.add(19);za.add(20);za.add(21);za.add(22);za.add(23);za.add(24);za.add(25);za.add(26);za.add(27);za.add(28);za.add(29);za.add(30);za.add(31);za.add(32);za.add(33);za.add(34);za.add(35);za.add(36);za.add(37);za.add(38);za.add(39);return za.contains(M.autoFilterOptions.CriteriaType)})}}Object(k.a)(Ce,"TableItemFilteredEvent",m,[]);class af extends m{constructor(){super()}get eventId(){return 101}Ae(){this.te(217)}}Object(k.a)(af,"TableRenamedEvent",
m,[]);class Cf extends m{constructor(){super()}get eventId(){return 73}Ae(){this.te(211)}}Object(k.a)(Cf,"TableResizedEvent",m,[]);class Jf extends m{constructor(){super()}get eventId(){return 44}Ae(){this.te(514)}}Object(k.a)(Jf,"TableRowColumnRearrangedEvent",m,[]);class Ff extends m{constructor(){super()}get eventId(){return 146}Ae(){this.te(237)}Oi(){this.Uf(M=>!!M.insertDeleteMultiRangeParameters);this.Uf(M=>M.insertDeleteMultiRangeParameters.IsTableCommand);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.Uf(M=>0>M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(k.a)(Ff,"TableRowDeletedEvent",m,[]);class ic extends m{constructor(){super()}get eventId(){return 147}Ae(){this.te(237)}Oi(){this.Uf(M=>!!M.insertDeleteMultiRangeParameters);this.Uf(M=>M.insertDeleteMultiRangeParameters.IsTableCommand);this.Uf(M=>!M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.Uf(M=>0<M.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(k.a)(ic,
"TableRowInsertedEvent",m,[]);class W extends m{constructor(){super()}get eventId(){return 26}Ae(){this.te(177)}Oi(){this.Uf(M=>M.autoFilterOptions.AutoFilterType===pc.hfb)}}Object(k.a)(W,"TableSortedEvent",m,[]);class d extends m{constructor(){super()}get eventId(){return 87}Ae(){this.te(212)}}Object(k.a)(d,"TableStyleAppliedEvent",m,[]);class Na extends m{constructor(){super()}get eventId(){return 88}Ae(){this.te(196)}}Object(k.a)(Na,"TableStyleOptionToggledEvent",m,[]);class Eb extends m{constructor(){super()}get eventId(){return 31}Ae(){this.te(210)}Oi(){this.Uf(M=>
M.getParameters().FilterType===pc.hfb)}}Object(k.a)(Eb,"TableTop10FilteredEvent",m,[]);class ac extends m{constructor(){super()}get eventId(){return 207}Ae(){this.te(238)}}Object(k.a)(ac,"TextToColumnsEvent",m,[]);class Jc extends m{constructor(){super()}get eventId(){return 128}Ae(){this.te(559)}}Object(k.a)(Jc,"ValuesSortedEvent",m,[]);class xd extends m{constructor(){super()}get eventId(){return 55}Ae(){this.te(197)}}Object(k.a)(xd,"WorkbookCalculationModeSetEvent",m,[]);class Xd extends m{constructor(){super()}get eventId(){return 34}Ae(){this.te(181)}Oi(){this.Uf(M=>
!!M.parentCommentId)}}Object(k.a)(Xd,"WorkbookCommentRepliedEvent",m,[]);class xe extends m{constructor(){super()}get eventId(){return 33}Ae(){this.te(181)}Oi(){this.Uf(M=>!M.parentCommentId)}}Object(k.a)(xe,"WorkbookCommentedEvent",m,[]);class $e extends m{constructor(){super()}get eventId(){return 56}Ae(){this.te(128)}}Object(k.a)($e,"WorkbookRecalculatedEvent",m,[]);class Oe extends m{constructor(){super()}get eventId(){return 46}Ae(){this.te(171)}}Object(k.a)(Oe,"WorkbookRedoEvent",m,[]);class Re extends m{constructor(){super()}get eventId(){return 45}Ae(){this.te(170);
this.te(1033)}}Object(k.a)(Re,"WorkbookUndoEvent",m,[]);class Bf extends m{constructor(){super()}get eventId(){return 116}Ae(){this.te(507);this.te(576);this.te(10)}Oi(){this.Uf(M=>{if(Object(K.a)(Q,M)&&(M=Object(ca.a)(Q,M),void 0!==M.source&&null!==M.source&&void 0!==M.eventId&&null!==M.eventId))return t.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${M.source}; eventId: ${M.eventId}.`),!0;t.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");
return!1})}}Object(k.a)(Bf,"DefaultRichApiRequestExecutedEvent",m,[]);class Vf extends m{constructor(){super()}get eventId(){return 216}Ae(){this.te(1022)}}Object(k.a)(Vf,"TablelAltTextEditedEvent",m,[]);class Tf extends m{constructor(){super()}get eventId(){return 217}Ae(){this.te(263)}}Object(k.a)(Tf,"FloatingObjectZOrderChangedEvent",m,[]);var rg=a(1020);class bg extends m{constructor(){super()}get eventId(){return 192}Ae(){this.te(507)}Oi(){this.Uf(M=>Object(K.a)(rg.a,M)?!0:!1)}}Object(k.a)(bg,
"VisualPropertySetEvent",m,[]);class gh extends D{constructor(){super(219,[510])}}Object(k.a)(gh,"ChartSeriesDeletedEvent",D,[]);class xh extends m{get eventId(){return 220}Ae(){this.te(1027)}}Object(k.a)(xh,"ChartDataChangedEvent",m,[]);class Wg extends D{constructor(){super(221,[512])}}Object(k.a)(Wg,"ChartSeriesDataChangedEvent",D,[]);class Ya extends m{constructor(){super()}get eventId(){return 225}Ae(){this.te(269)}}Object(k.a)(Ya,"FloatingObjectPutFloatingImageInCellEvent",m,[]);class Cb extends m{constructor(){super()}get eventId(){return 224}Ae(){this.te(268)}}
Object(k.a)(Cb,"ImageInCellConvertToFloatingObjectEvent",m,[]);class cc{constructor(M){this.Yd=null;this.$=M}get macroRecorderEvents(){this.Yd||(this.Yd=new r.a,this.Yd.add(new Ub),this.Yd.add(new qe),this.Yd.add(new ve),this.Yd.add(new ee),this.Yd.add(new Ra),this.Yd.add(new Be),this.Yd.add(new ad),this.Yd.add(new Qc),this.Yd.add(new Zd),this.Yd.add(new nc),this.Yd.add(new Oc),this.Yd.add(new Ud),this.Yd.add(new dd),this.Yd.add(new Rb),this.Yd.add(new id),this.Yd.add(new Cc),this.Yd.add(new jd),
this.Yd.add(new ke),this.Yd.add(new Ff),this.Yd.add(new ic),this.Yd.add(new wb),this.Yd.add(new Xa),this.Yd.add(new Ee),this.Yd.add(new je),this.Yd.add(new le),this.Yd.add(new W),this.Yd.add(new Fc),this.Yd.add(new De),this.Yd.add(new Dc),this.Yd.add(new vd),this.Yd.add(new Eb),this.Yd.add(new Ce),this.Yd.add(new xe),this.Yd.add(new Xd),this.Yd.add(new Kb),this.Yd.add(new bf),this.Yd.add(new ue),this.Yd.add(new qa),this.Yd.add(new Ge),this.Yd.add(new Tc),this.Yd.add(new Cd),this.Yd.add(new kc),this.Yd.add(new gb),
this.Yd.add(new Jf),this.Yd.add(new Oe),this.Yd.add(new Re),this.Yd.add(new oc),this.Yd.add(new Ga),this.Yd.add(new Ia),this.Yd.add(new Wc),this.Yd.add(new Nc),this.Yd.add(new xd),this.Yd.add(new $e),this.Yd.add(new Yd),this.Yd.add(new cd),this.Yd.add(new vb),this.Yd.add(new Ob),this.Yd.add(new Hd),this.Yd.add(new re),this.Yd.add(new Kc),this.Yd.add(new hd),this.Yd.add(new y),this.Yd.add(new Ea),this.Yd.add(new hf),this.Yd.add(new of),this.Yd.add(new Ad),this.Yd.add(new Ja),this.Yd.add(new S),this.Yd.add(new Cf),
this.Yd.add(new Tb),this.Yd.add(new Z),this.Yd.add(new U),this.Yd.add(new se),this.Yd.add(new F),this.Yd.add(new la),this.Yd.add(new wa),this.Yd.add(new H),this.Yd.add(new ra),this.Yd.add(new N),this.Yd.add(new L),this.Yd.add(new I),this.Yd.add(new ha),this.Yd.add(new Rd),this.Yd.add(new d),this.Yd.add(new Na),this.Yd.add(new na),this.Yd.add(new Id),this.Yd.add(new ud),this.Yd.add(new Vd),this.Yd.add(new eb),this.Yd.add(new nb),this.Yd.add(new $a),this.Yd.add(new Oa),this.Yd.add(new Yc),this.Yd.add(new Db),
this.Yd.add(new fc),this.Yd.add(new oa),this.Yd.add(new af),this.Yd.add(new pb),this.Yd.add(new fe),this.Yd.add(new Wa),this.Yd.add(new Hb),this.Yd.add(new Pb),this.Yd.add(new Nd),this.Yd.add(new $b),this.Yd.add(new qd),this.Yd.add(new cb),this.Yd.add(new db),this.Yd.add(new Ba),this.Yd.add(new nd),this.Yd.add(new ub),this.Yd.add(new Gc),this.Yd.add(new z),this.Yd.add(new Nb),this.Yd.add(new yc),this.Yd.add(new me),this.Yd.add(new Te),this.Yd.add(new tb),this.Yd.add(new rb),this.Yd.add(new Pa),this.Yd.add(new Jc),
this.Yd.add(new Ca),this.Yd.add(new n),this.Yd.add(new ta),this.Yd.add(new xb),this.Yd.add(new yb),this.Yd.add(new Ka),this.Yd.add(new va),this.Yd.add(new vc),this.Yd.add(new xa),this.Yd.add(new lb),this.Yd.add(new qc),this.Yd.add(new Fa),this.Yd.add(new jc),this.Yd.add(new ya),this.Yd.add(new ob),this.Yd.add(new Sb),this.Yd.add(new Kd),this.Yd.add(new A),this.Yd.add(new fd),this.Yd.add(new Ua),this.Yd.add(new Fd),this.Yd.add(new tc),this.Yd.add(new uc),this.Yd.add(new Bb),this.Yd.add(new Jb),this.Yd.add(new ka),
this.Yd.add(new Sa),this.Yd.add(new fb),this.Yd.add(new hb),this.Yd.add(new Ib),this.Yd.add(new Mb),this.Yd.add(new ba),this.Yd.add(new Y),this.Yd.add(new R),this.Yd.add(new Za),this.Yd.add(new sb),this.Yd.add(new sa),this.Yd.add(new Ma),this.Yd.add(new Xb),this.Yd.add(new Vb),this.Yd.add(new ab),this.Yd.add(new qb),this.Yd.add(new $c),this.Yd.add(new La),this.Yd.add(new ua),this.Yd.add(new ma),this.Yd.add(new ib),this.Yd.add(new Qb),this.Yd.add(new uf),this.Yd.add(new Ke),this.Yd.add(new jb),this.Yd.add(new lc),
this.Yd.add(new ef),this.Yd.add(new Ve),this.Yd.add(new bd),this.Yd.add(new be),this.Yd.add(new Zc),this.Yd.add(new Sd),this.Yd.add(new Jd),this.Yd.add(new ac),this.Yd.add(new Ec),this.Yd.add(new Vf),this.Yd.add(new Tf),this.Yd.add(new bg),this.Yd.add(new gh),this.Yd.add(new Wg),this.Yd.add(new xh),this.Yd.add(new Cb),this.Yd.add(new Ya),this.Yd.add(new Xc),f.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.gBj());return this.Yd}adf(M,za){let Ab=this.bdf(M,this.macroRecorderEvents,
za);Ab||(Ab=this.bdf(M,cc.Qli(),za),!Ab&&this.Stf(M,cc.sUe,za)&&(Ab=cc.sUe));return Ab}bdf(M,za,Ab){const ec=new r.a;for(let Ic of za)this.Stf(M,Ic,Ab)&&ec.add(Ic);return 1===ec.count?ec.ka(0):1<ec.count?cc.R2h(ec):null}Stf(M,za,Ab){const ec=cc.Djj(M,za);return Ab?ec&&cc.tqk(M,za):ec}gBj(){const M=new r.a;for(let za of this.Yd){let Ab=!1;for(let ec of za.featureGates)if(!f.EwaSettings.Fa(ec)){M.add(za);Ab=!0;break}if(!Ab)for(let ec of za.J4e)if(!f.EwaSettings.getBooleanFeatureGate(ec,!1)){M.add(za);
break}}for(let za of M)this.Yd.remove(za)}static Qli(){cc.qKb||(cc.qKb=new r.a,cc.qKb.add(new fa),cc.qKb.add(new X));return cc.qKb}static Djj(M,za){return za.operations.contains(M.operation)}static tqk(M,za){za=za.kMc;if(!za.count)return!0;let Ab=!0;for(let ec of za)if(!ec(M.payload)){Ab=!1;break}return Ab}static R2h(M){let za=M.ka(0);for(let Ab of M)Ab.kMc.count>za.kMc.count&&(za=Ab);return za}}cc.qKb=null;cc.sUe=new Bf;Object(k.a)(cc,"MacroRecorderEventList",null,[]);var Rc=a(60),gd=a(124);class Md{equals(M,
za){return M===za}getHashCode(M){return M}zna(M){return M}}Object(k.a)(Md,"UserOperationNameComparer",null,[74,75]);class td{static Wli(){td.jf||(td.jf=new J.a(new Md),td.jf.add(507),td.jf.add(10),td.jf.add(576),td.jf.add(563),td.jf.add(564),td.jf.add(565),td.jf.add(566),td.jf.add(567),td.jf.add(568),td.jf.add(569),td.jf.add(570),td.jf.add(571),td.jf.add(572),td.jf.add(573),td.jf.add(574),td.jf.add(575),td.jf.add(501),td.jf.add(520),td.jf.add(1),td.jf.add(1002),td.jf.add(129),td.jf.add(198),td.jf.add(500),
td.jf.add(519),td.jf.add(538),td.jf.add(1E3),td.jf.add(1003),td.jf.add(144),td.jf.add(502),td.jf.add(505),td.jf.add(179),td.jf.add(205),td.jf.add(134),td.jf.add(230),td.jf.add(103),td.jf.add(110),td.jf.add(112),td.jf.add(113),td.jf.add(124),td.jf.add(133),td.jf.add(154),td.jf.add(162),td.jf.add(168),td.jf.add(172),td.jf.add(201),td.jf.add(222),td.jf.add(227),td.jf.add(513),td.jf.add(534),td.jf.add(539),td.jf.add(545),td.jf.add(600),td.jf.add(547),td.jf.add(555),td.jf.add(558),td.jf.add(562),td.jf.add(585),
td.jf.add(1001),td.jf.add(1005),td.jf.add(1008),td.jf.add(1010),td.jf.add(1011),td.jf.add(1012),td.jf.add(1018),td.jf.add(1029),td.jf.add(252),td.jf.add(253),td.jf.add(258),td.jf.add(101),td.jf.add(102),td.jf.add(108),td.jf.add(257),td.jf.add(119),td.jf.add(120),td.jf.add(123),td.jf.add(126),td.jf.add(127),td.jf.add(130),td.jf.add(140),td.jf.add(159),td.jf.add(160),td.jf.add(165),td.jf.add(166),td.jf.add(167),td.jf.add(169),td.jf.add(189),td.jf.add(223),td.jf.add(214),td.jf.add(228),td.jf.add(233),
td.jf.add(247),td.jf.add(504),td.jf.add(511),td.jf.add(512),td.jf.add(525),td.jf.add(533),td.jf.add(537),td.jf.add(542),td.jf.add(544),td.jf.add(548),td.jf.add(550),td.jf.add(551),td.jf.add(552),td.jf.add(554),td.jf.add(577),td.jf.add(584),td.jf.add(586),td.jf.add(587),td.jf.add(588),td.jf.add(592),td.jf.add(1009),td.jf.add(1016),td.jf.add(1017),td.jf.add(1024),td.jf.add(260),td.jf.add(597),td.jf.add(264),td.jf.add(596),td.jf.add(254),td.jf.add(262),td.jf.add(1030),td.jf.add(1031),td.jf.add(606));
return td.jf}}td.jf=null;Object(k.a)(td,"MacroRecorderUnrecognizedEventList",null,[]);var Fe=a(13),Se=a(142);let gf=class{constructor(M,za,Ab){za=void 0===za?new cc(M):za;Ab=void 0===Ab?new u:Ab;this.PAb=null;this.YWi=(ec,Ic)=>{this.vig()&&this.Ykd(Ic)};this.NEf=za;this.MEf=Ab;this.$=M;this.$.QY&&this.$.h0g(this.YWi);f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateMacroRecorderEventsHandler",!1)||M.ia.Va(297,this)}init(M){this.$.QY&&(M?this.PAb=M:t.ULS.sendTraceTag(537155424,0,
10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}Ykd(M){if(this.vig())try{if(this.MEf.yCi(M)){var za=this.MEf.Nhk(M);for(const Ab of za)this.W5e(Ab)}else this.W5e(M)}catch(Ab){za=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${gd.a(M.operation)}, Exception: ${Ab.stack}`;t.ULS.sendTraceTag(537155423,0,10,za);try{this.dWh(M)}catch(ec){}}}W5e(M){var za=this.NEf.adf(M,!0);za?(this.PAb(za.eventId,Rc.a.ff(M.payload)),t.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${za.eventId}`)):
(za=this.NEf.adf(M,!1))?t.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${za.eventId}, but failed to match filters`):td.Wli().contains(M.operation)||(this.PAb(0,Rc.a.ff(M.operation)),M=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${gd.a(M.operation)}`,t.ULS.sendTraceTag(537155420,0,50,M))}dWh(M){this.PAb(222,Rc.a.ff(M.operation))}vig(){return this.$.Yoa&&this.PAb&&this.$.p9?!0:!1}};gf=Object(x.a)([Object(Se.d)(Fe.Zb),Object(x.b)(0,
Object(Fe.fb)())],gf);Object(k.a)(gf,"MacroRecorderEventHandler",null,[690]);class Hf extends l.a{constructor(M){super();this.$=M;this.Oe()}create(){this.ve(this.$.ia.Ja(297)||new gf(this.$,new cc(this.$),new u))}static la(M){M.ia.Va(298,new Hf(M))}}Object(k.a)(Hf,"MacroRecorderEventHandlerFactory",l.a,[]);var Ef=a(2),Lf=a(570);class Wf{constructor(){this.DGg=new r.a}get v9b(){return this.DGg}Uci(M){t.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",M);const za=new r.a;for(const Ab of this.v9b)for(const ec of Ab.OLb)ec.id===
M&&za.add(ec);return za}oye(M){this.v9b.add(M)}$Aj(M){for(const za of this.v9b)if(za.cCe===M.cCe){this.v9b.remove(za);break}}static cBh(M,za,Ab){Ab=void 0===Ab?null:Ab;M=Wf.w5h(M);0<M.length&&(Wf.mFc(M,!1),Ab&&Ab(za,M))}static w5h(M){const za=[];if(M&&M.OLb&&0<M.OLb.count)for(const Ab of M.OLb)if(Ab.controls&&0<Ab.controls.count)for(const ec of Ab.controls)if(ec.menuItems&&0<ec.menuItems.count)for(const Ic of ec.menuItems)Array.add(za,Ic.id);return za}static mFc(M,za){if(M.length){var Ab=[];for(const ec of M)Ab.push(appChrome.actions.updateControlEnabledDisabledState(ec,
za));appChrome.api.dispatch(Ab)}}}Object(k.a)(Wf,"ContextMenuExtensibilityCache",null,[769,770]);var Sg=a(1385),Ze=a(5),kh=a(916),Eg=a(859);class th{P2a(M,za){za=void 0===za?null:za;if(M=Eg.a.CBb(M)){appChrome.addInApi.dispatchActionsToInstallAddIn(M,za);for(const Ab of M.tabs)if(Ab.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(M,()=>{});break}}}PTd(M){(M=Eg.a.CBb(M))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(M)}mfg(){}static kBh(M,za,Ab){Ab=void 0===Ab?null:Ab;M=th.jgi(M);
0<M.length&&(th.mFc(M,!1),Ab&&Ab(za,M))}static jgi(M){const za=[];if(M&&(M=M.uZ,M.lw&&0<M.lw.count))for(const Ab of M.lw)if(Ab.groups&&0<Ab.groups.length)for(const ec of Ab.groups)if(ec.controls&&0<ec.controls.length)for(const Ic of ec.controls)Array.add(za,Ic.id);return za}static mFc(M){if(M.length){var za=[];for(const Ab of M)za.push(appChrome.actions.updateControlEnabledDisabledState(Ab,!0));appChrome.api.dispatch(za)}}}Object(k.a)(th,"OneLineRibbonExtensibilityManager",null,[791]);var $h=a(991);
class zh{constructor(){this.pde=this.LNc=null;this.bof=(M,za)=>{let Ab=null;Ab=()=>{M.getIsUpgrading()?window.setTimeout(Ab,1E3):M.getUpgradingFailed()?th.mFc(za,!0):Ze.AFrameworkApplication.sa.Sv()};window.setTimeout(Ab,1E3)}}get q2c(){return this.LNc||(this.LNc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set q2c(M){this.LNc=M}get D7g(){return this.pde||(this.pde=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(M,
za){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(M,za)}Tsd(M,za,Ab,ec,Ic,ed,Ed){ed=void 0===ed?null:ed;Ed=void 0===Ed?null:Ed;t.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",M);if((M=za.Uma(Ic.ownerAddinInfo.storeType,Ic.ownerAddinInfo.solutionId))&&M.zE&&!M.zE.getIsUpgrading())if(za=null,0<M.zE.getNotificationParams().length&&(za=this.OHe(M.zE.getNotificationParams()[0]))&&2147758681===za.errorCode&&(M.isUpgraded=!0),2!==M.zE.getStatus()&&(1!==M.zE.getStatus()||
za&&2147758681===za.errorCode))za&&this.ljg(M,za,Ed);else try{Ab.setOwnerAddinEToken(M.zE.getEToken()),Ic.action(Ab,ec.Dga),ed&&ed()}catch(Pd){t.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",Ze.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Pd.stack:Pd.message)),$h.a.c2d(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}ljg(M,za,Ab){Ab=void 0===Ab?null:Ab;const ec=M.zE;
if(1===ec.getNotificationParams().length||za.umc){const Ic=za.vla,ed=za.rma;za.vla=()=>{ec.removeFirstNotification();if(0<ec.getNotificationParams().length){const Ed=this.OHe(ec.getNotificationParams()[0]);this.ljg(M,Ed)}2147758681===za.errorCode&&(th.kBh(M.Tq,ec,this.bof),Wf.cBh(M.nxb,ec,this.bof));Ic&&Ic()};za.rma=()=>{ed&&ed();Ab&&Ab()};$h.a.d2d(za)}}OHe(M){const za=new kh.a;za.rQa=M.infoType;za.id=M.id;za.title=M.title;za.description=M.description;za.buttonText=M.buttonTxt;za.vla=M.buttonCallback;
za.umc=M.highPriority;za.rma=M.dismissCallback;za.errorCode=M.errorCode;za.fnf=M.iframeNotificationUrl;return za}}Object(k.a)(zh,"AddinCommandsActionHandler",null,[768]);var Pf=a(81),eh=a(180),kg=a(737),bh=a(6),jh=a(778),Ih=a(736);class Oh{constructor(M,za){this.Wa=M;this.Lmh=za}U_h(M){if(void 0!==M&&null!==M&&M===bh.a.ZOe)M="ContextMenuCell";else return null;const za=this.Wa.Ze();this.j_h(za,M);return za}j_h(M,za){za=this.Lmh.Uci(za);for(let Ab of za){za=Ab.controls;for(let ec of za)this.WZh(M,ec)}}WZh(M,
za){var Ab=za.xX[jh.a.id];const ec=za.xX[jh.a.GZa],Ic=za.xX[jh.a.KZa];let ed="Image16by16",Ed=za.xX[jh.a.HZa];Ih.c(Ic)&&(ed="None");0<za.menuItems.count?(Ab=this.Wa.sy(Ab,Ab,ec,798637440),Ab.HSb(ed,Ic,null),this.S_h(Ab.menu,za),M.buttons.push(Ab)):M.buttons.push(this.Wa.yMa(Ab,ec,Ed,Ic,ed,null,!1))}S_h(M,za){const Ab=this.Wa.Ze();for(let ec of za.menuItems){za=ec.Gpa[jh.a.id];const Ic=ec.Gpa[jh.a.GZa],ed=ec.Gpa[jh.a.KZa];let Ed="Image16by16";const Pd=ec.Gpa[jh.a.HZa];Ih.c(ed)&&(Ed="None");za=this.Wa.yMa(za,
Ic,Pd,ed,Ed,null,!1);Ab.buttons.push(za)}M.Le.push(Ab)}}Object(k.a)(Oh,"AddInCommandsContextMenuExtensibilityHandler",null,[737]);var Rh=a(910);class Jh{constructor(){this.zk=null;this.visible=!1}}Object(k.a)(Jh,"AddinStatusCommandValues",null,[]);class vg{static zsj(M){const za=new Jh;za.zk=M.mwa;za.visible=za.zk?!0:!1;return za}static $Gc(M,za,Ab,ec,Ic){const ed=document.getElementById(Ab);ed?vg.w3j(M,za,ed,ec,Ic):t.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",
Ab))}static w3j(M,za,Ab,ec,Ic){Ab?M.mwa===CommonUIStrings.l_ErrorLoadingAddInsTitle?$h.a.d2j(za,Ab,ec,Ic):M.mwa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&$h.a.D3j(za,Ab):t.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(k.a)(vg,"AddinCommandsStatusHandler",null,[]);var Og=a(37),wg=a(236),cg=a(12),Pg=a(29),sh=a(90);class ji extends Og.a{constructor(M,za){super();this.agaveCommandManager=this.statusBarManager=null;this.ZLe=
()=>{this.OE&&this.OE.CLe()};this.Gif=()=>{this.raiseEvent("LAC")};this.vf=(Ab,ec)=>{!Ab.Ee&&wg.b(ec)&&this.statusBarManager&&(this.statusBarManager.WI(this),this.statusBarManager=null)};this.OE=za;this.$=M;Pg.a.mo()||(this.bIc=M.He+"OfficeAddinLabel-Medium14");this.$.ia.Od(29,Ab=>{this.statusBarManager=Ab;Ab.BM(this)});this.$.ea.Yl(this.vf);this.OE.IYg(this.Gif);this.$.ia.Od(206,Ab=>{this.agaveCommandManager=Ab;Ab.p_g(this.ZLe)})}yt(M){this.addHandler("LAC",M)}Ut(M){this.removeHandler("LAC",M)}ov(M,
za){if("QueryAddinLabel"!==M)return!1;M=!1;Pg.a.mo()?(M=appChrome.selectors.getControlLabel(sh.a.NJd),M=!(!M&&!this.OE.mwa)&&M!==this.OE.mwa):M=za[Rh.a.LabelText]!==this.OE.mwa;M&&(M=vg.zsj(this.OE),za[Rh.a.LabelText]=M.zk,za[Rh.a.Visible]=M.visible,window.setTimeout(()=>{this.$Gc()},0));return!0}mq(){return!0}$Gc(){if(this.$){if(Pg.a.mo()&&isNullOrUndefined(this.bIc)){const M=document.querySelector('button[data-unique-id="StatusBar-OfficeAddinLabel"]');M&&(this.bIc=M.getElementsByClassName("ms-Button-label")[0].id)}this.bIc&&
vg.$Gc(this.OE,this.$.domElement,this.bIc,cg.a.instance.ha(333),cg.a.instance.ha(334))}}dispose(){this.$.ea.gm(this.vf);this.OE.nCj(this.Gif);this.agaveCommandManager&&(this.agaveCommandManager.FDj(this.ZLe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.WI(this),this.statusBarManager=null);this.OE=this.$=null;super.dispose()}}Object(k.a)(ji,"AddinCommandsStatusBarManager",Og.a,[298,173]);var $f=a(178),Aa=a(119),zb=a(756),sc=a(863),Pc=a(1226),kd=a(805),ja=a(139),ia=a(583),
dc=a(138);class od{constructor(){this.g3a=null}setErrorMessageForAddin(M,za){this.g3a||(this.g3a={});this.g3a[M]=za}S7h(M){return this.g3a&&M in this.g3a?this.g3a[M]:null}}Object(k.a)(od,"AddinCommandsErrorManager",null,[]);var ae=a(106);class Pe{constructor(){this.wu=this.Sqa=0;this.X4c=null;this.Zzc=this.UJc=0;this.Uta=this.ISc=this.dOc=null}get $6b(){this.dOc||(this.dOc=new r.a);return this.dOc}get omd(){this.ISc||(this.ISc=new r.a);return this.ISc}get pMa(){this.Uta||(this.Uta=new r.a);return this.Uta}}
Object(k.a)(Pe,"AddinCommandsListLoaderContext",null,[]);var Xe=a(866);class vf{constructor(M,za){this.entitlement=M;this.metadata=za}zVb(){var M=this.entitlement;const za={};za.solutionId=M.solutionId;za.version=M.version;za.storeType=M.storeType;za.storeId=M.storeId;za.assetId=M.assetId;za.assetStoreId=M.assetStoreId;za.targetType=M.targetType;za.requireConsent=M.requireConsent||!1;za.isAddinCommands=!0;za.addinCommandsActionType=0;za.targetType=this.targetType;return za}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(k.a)(vf,"AddinEntitlementEx",null,[]);var Sf=a(273),xf=a(342);class Jg{}Object(k.a)(Jg,"AppsForOfficeEntitlementQueryInfo",null,[]);var yg=a(41),Xf=a(33);class Lg{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(k.a)(Lg,
"AddinAbstract",null,[]);class lg extends Sys.EventArgs{constructor(){super();this.Tq=this.en=null}}Object(k.a)(lg,"InsertionParamEventArgs",Sys.EventArgs,[]);class Kf{constructor(M,za,Ab,ec){this.pPa=Ic=>{let ed=!1,Ed=null;try{if(0<Ic.data.Fg.length){const Pd=Object(ca.a)(Object,yg.a(Ic.data.Fg)),Ae=Pd?Pd[this.appName]:null;Ae&&(Ed=Object(ca.a)(Object,yg.a(Ae.toString())))}ed=!0}catch(Pd){this.Lna(null)}ed&&this.uob&&this.uob(Ed)};this.Lna=Ic=>{this.qob&&this.qob(Ic?Ic.data:null)};this.Kqa=Ic=>{this.Gqb&&
this.Gqb(Ic?Ic.data:null)};this.kRb=Ze.AFrameworkApplication.da.Ra("RoamingServiceHandlerWebServiceBase");this.appName=M;this.uob=za;this.qob=Ab;this.Gqb=void 0===ec?null:ec}Tjd(M){this.dSh(M,this.pPa,this.Lna)}dSh(M,za,Ab){const ec=new Sys.StringBuilder(this.kRb);ec.append("RoamingServiceHandler.ashx?action=");ec.append("getAddinTeachingCalloutSettings");ec.append("&");ec.append(this.Mqd(M));ec.append("&");ec.append(Ze.AFrameworkApplication.fl);Ze.AFrameworkApplication.Wf.zp(ec.toString(),1,null,
null,!0,2,za,Ab,null)}ggc(M){this.hSh(M)}hSh(M){var za=new Sys.StringBuilder(this.kRb);za.append("RoamingServiceHandler.ashx?action=");za.append("saveAddinTeachingCalloutSettings");za.append("&");za.append(Ze.AFrameworkApplication.fl);za=za.toString();M=yg.c(M);Ze.AFrameworkApplication.Wf.zp(za,2,M,null,!0,4,null,this.Kqa,null)}Mqd(M){const za=new Sys.StringBuilder("requestedsettings=");for(let Ab=0;Ab<M.count;Ab++)za.append(M.ka(Ab)),Ab<M.count-1&&za.append(";");return za.toString()}}Object(k.a)(Kf,
"AddinTeachingUIRoamingRequestHandler",null,[]);class Dh extends Sys.EventArgs{constructor(M){super();this.solutionId=M.solutionId;this.assetId=M.assetId;this.storeType=M.storeType;this.storeId=M.storeId;this.assetStoreId=M.assetStoreId;this.targetType=M.targetType;this.width=M.width;this.height=M.height;this.displayName=M.displayName;this.version=M.version}}Object(k.a)(Dh,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var hh=a(355);class Da{constructor(M){this.j3a=this.en=null;this.sDc=
!1;this.Uta=this.iYb=this.Zga=this.Qh=this.hOc=this.cib=null;this.icj=()=>{const za=new Sf.ScriptSharpLegacyMap;this.j3a&&this.j3a.tabs&&!this.j3a.tabs[0].isOfficeTab&&za.fa("SDX.FeatureFlags","NonOfficeTab");this.cdb(Da.I9a(this.en),"ClickOnLaunch",za);this.iuc();this.j3a?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.j3a,()=>{const Ab=new lg;Ab.en=this.en;this.Xa.raiseEvent(zb.a.Dzf,Ab)}):t.ULS.sendTraceTag(508625355,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};
this.z6i=()=>{this.cdb(Da.I9a(this.en),"ClickOnClose");this.iuc()};this.a8i=()=>{this.cdb(Da.I9a(this.en),"ClickOnDismiss");this.iuc()};this.TKf=za=>{if(za&&(za=za.detail)&&za.id&&this.RCi(za.id)){const Ab=(za.action||"").toLowerCase();if(za.success&&"opened"===Ab)this.cdb(Da.I9a(this.en),"CampaignLaunched"),t.ULS.sendTraceTag(508625354,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.iuc(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",this.TKf,
!0);else{let ec;try{ec=JSON.stringify(za),t.ULS.sendTraceTag(508625353,220,15,"Campaign launch failure. Event:"+ec)}catch(Ic){ec="id : "+za.id+" telemetryEventName: "+za.telemetryEventName,t.ULS.sendTraceTag(508625352,220,50,"Error serializing campaign event. "+ec+" Error: "+(Ic?Ic.toString():""))}}}};this.pPa=za=>{za?this.Z0j(za)?(t.ULS.sendTraceTag(508625348,220,50,"should show teaching UI"),this.cib="AddinHasShown"in za&&za.AddinHasShown?za.AddinHasShown.toString():null,this.kOe()):(t.ULS.sendTraceTag(508625347,
220,50,"Not Show TeachingUI this time"),this.Zga(this.lwa,null)):(t.ULS.sendTraceTag(508625349,220,50,"userSettings is null"),this.cib=null,this.kOe())};this.Lna=za=>{t.ULS.sendTraceTag(508625346,220,10,"GET data from Roaming Settings Service with status: {0}, fallback",za?za.httpStatus:-1);this.Zga(this.lwa,null)};this.Kqa=za=>{t.ULS.sendTraceTag(508625345,220,10,"failed to POST data to Roaming Settings Service with status: {0}",za?za.httpStatus:-1)};this.Xa=M}get appName(){return Ze.AFrameworkApplication.da.Ra("WebAppShortName")}get Gtb(){this.hOc||
(this.hOc=new Kf(this.appName,this.pPa,this.Lna,this.Kqa));return this.hOc}get lwa(){this.iYb||(this.iYb=new r.a);return this.iYb}set lwa(M){this.iYb=M}get pMa(){this.Uta||(this.Uta=new r.a);return this.Uta}set pMa(M){this.Uta=M}PVg(M,za){window.addEventListener?(this.en=M,this.j3a=za,window.addEventListener("LaunchAddinTaskpane",this.icj,!0),window.addEventListener("DismissCallout",this.a8i,!0),window.addEventListener("CloseCallout",this.z6i,!0),window.addEventListener("FGWebSurfaceEvent",this.TKf,
!0)):t.ULS.sendTraceTag(508625357,220,15,"AddEventListenerForTeachingCallout failed to get Window")}Lfk(M,za,Ab,ec){this.Qh=M;this.lwa=za;this.pMa=Ab;this.Zga=ec;t.ULS.sendTraceTag(508625356,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",za?za.count.toString():"null",Ab?Ab.count.toString():"null");0<this.lwa.count||0<this.pMa.count?(M=new r.a,M.add(this.appName),this.Gtb.Tjd(M)):this.Zga(new r.a,null)}RCi(M){M=Xf.a.rn(M);return-1!==M.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==M.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==M.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==M.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==M.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==M.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}LDc(M){if(this.appName){const za={},Ab={};Ab.LastTeachingUIShowTime=(new Date).toUTCString();Ab.AddinHasShown=M;za[this.appName]=yg.c(Ab);this.Gtb.ggc(za);t.ULS.sendTraceTag(508625351,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else t.ULS.sendTraceTag(508625350,
220,10,"Fail to save roaming service since AppName is null")}iuc(){if(!this.sDc){const M=window.g_roamingAddinList;M&&(this.LDc(M),this.sDc=!0)}}kOe(){const M=this.Wzh();0===M.targetType?(M.solutionId?this.vsj(M):this.cdb(null,"NoSolutionId"),this.Tvg(M),this.Zga(this.lwa,null)):this.Zga(this.lwa,M);t.ULS.sendTraceTag(508625344,220,50,"Show teaching callout for: {0}",M.addinId)}vsj(M){const za=new Jg;za.callbackFunc=Ab=>{if(Ab.errorCode){this.cdb(M.solutionId,"FailToGetAppDetails");var ec=window.g_roamingAddinList;
ec&&this.LDc(ec)}else if(Ab.value)for(ec of Ab.value)if(Ab=ec[1],Ab===M.solutionId){const Ic={};Ic.solutionId=Ab;Ic.assetId=ec[5];Ic.storeType=ec[12];Ic.storeId=ec[11];Ic.assetStoreId=ec[6];Ic.targetType=ec[3];Ic.width=ec[7];Ic.height=ec[8];Ic.displayName=ec[0];Ic.version=ec[4];t.ULS.sendTraceTag(508625315,220,50,"Raise a teaching callout event for content addin: {0}.",M.solutionId);ec=new Dh(Ic);this.Xa.raiseEvent(zb.a.qjg,ec);break}};za.storeType=OSF.StoreTypeEnum.PrivateCatalog;za.fromInsertDialog=
!1;za.refresh=!1;this.Qh.queryEntitlementDetails(za)}Z0j(M){if("LastTeachingUIShowTime"in M){if(M=+new Date-+new Date(M.LastTeachingUIShowTime.toString()),M<Ze.AFrameworkApplication.da.uY("AddinShowTeachingUIIntervalInMS",864E5))return t.ULS.sendTraceTag(508625314,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",M),!1}else t.ULS.sendTraceTag(508625313,220,50,"userSetting has no date key");return!0}Wzh(){let M=new xf.a(new Lg,0),za=new xf.a(new Lg,0),Ab=0,ec=0,Ic=0;var ed=
new r.a;for(var Ed of this.lwa)ed.add(Ed);for(const Pd of this.pMa)ed.add(Pd);for(const Pd of ed)if(!("excatalog"!==Pd.storeType||Ih.c(Pd.installTimeInMS)||!Pd.installTimeInMS||Pd.installTimeInMS<=Ze.AFrameworkApplication.da.uY("DateTimeInMSForNewAddin",16409952E5))){ed=Da.b9e(Pd);if(this.cib&&(Ed=this.cib.split(","),0<Ed.length&&Array.contains(Ed,ed))){Ic++;t.ULS.sendTraceTag(508625312,220,50,"This addin has shown teaching UI before");continue}ed.startsWith("private_")?(M=Da.Lcf(Pd,M),ec++):(za=
Da.Lcf(Pd,za),Ab++)}t.ULS.sendTraceTag(508625311,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",ec,Ab,Ic);return 0<za.value?za.key:0<M.value?M.key:Object.assign(new Lg,{addinId:null,targetType:-1,solutionId:null})}cdb(M,za,Ab){Ab=void 0===Ab?null:Ab;M={["AppTeachingUICalloutAction"]:za,["SDX.Id"]:M,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Ab)for(const ec of Ab.keys)M[ec]=Ab.ka(ec);$f.a.sendTelemetryEvent(Object.assign(new hh.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(M)}))}Tvg(M){M&&(window.g_roamingAddinList=this.cib?this.cib+","+M.addinId:M.addinId)}static I9a(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}static Lcf(M,za){return za.value<M.installTimeInMS?new xf.a(Object.assign(new Lg,{addinId:Da.b9e(M),targetType:M.targetType,solutionId:M.solutionId}),M.installTimeInMS):za}static b9e(M){return Telemetry.PrivacyRules.IsPrivateAddin(M.storeType,
M.assetId,null,null,M.storeId)?"private_"+M.installTimeInMS:M.solutionId}}Object(k.a)(Da,"PrivateCatalogTeachingCalloutHandler",null,[]);var Lb=a(65);const rc=()=>{const M=Lb.a.H8(window.location.href.toLowerCase(),"wdomexsrctype");return!!M&&"4"===M},zc=()=>Lb.a.H8(window.location.href.toLowerCase(),"wdtpl"),zd=()=>{const M=Lb.a.H8(window.location.href.toLowerCase(),"wdomexsrctype");return!!M&&"1"===M};var Wd=a(865);class we extends Sys.EventArgs{constructor(M){super();this.properties=M}}Object(k.a)(we,
"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class He{constructor(M,za,Ab){this.Xa=new ae.a;this.context=new Pe;this.O0c=null;this.Obj=(ec,Ic,ed,Ed)=>{ec?(ec=new vf(ed.targetData,Ed),Ic&&this.context.$6b.add(ec),10===this.context.Sqa&&(this.context.omd.add(ec),0===ec.targetType&&this.context.pMa.add(ec))):(Ic=ed.targetData,t.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ic.solutionId,Ic.storeType,Ic.assetId,
null,null,Ic.storeId),Ic.storeType));this.cKd()};this.contextActivationMgr=M;this.O1g=za;this.Z6b=Ab;this.appName=Ze.AFrameworkApplication.da.Ra("WebAppShortName")}get ikb(){this.O0c||(this.O0c=new Da(this.Xa));return this.O0c}GYg(M){this.Xa.addHandler(zb.a.vBe,M)}k1g(M){this.Xa.addHandler(zb.a.qjg,M)}ehk(M){null!==M&&(this.context.Sqa=M[zb.a.X0],this.context.wu=M[zb.a.aX],this.context.UJc=this.context.Zzc=0,M=zb.a.tKa in M?M[zb.a.tKa]:0,-1!==this.context.Sqa&&0!==this.context.wu&&(this.context.X4c=
this.O1g.createAddinDataProvider(Wd.a(this.context.Sqa),this.contextActivationMgr),this.context.X4c?this.context.X4c.getEntitlementsAsync(this.contextActivationMgr.Dga,!0,M,za=>{this.ucj(za)}):t.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.Sqa)))}ucj(M){if(M&&0<M.length){this.context.UJc=M.length;const Ab=zc();for(let ec=0;ec<M.length;ec++){const Ic=M[ec];if(zd()&&Ic&&Ic.storeType&&"omex"===Ic.storeType.toLowerCase()&&Ic.assetId&&Ab&&Ic.assetId.toLowerCase()===
Ab.toLowerCase()){var za={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:He.I9a(Ic)};$f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Kl(za)}))}!Ic||1!==Ic.targetType&&-1!==Ic.targetType?this.cKd():(za={},Ze.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(za.solutionId=Ic.solutionId,za.version=Ic.version):(za.marketplaceId=Ic.solutionId,za.marketplaceVersion=
Ic.version),za.storeType=Ic.storeType,za.storeId=Ic.storeId,za.targetData=Ic,this.contextActivationMgr.isAddinCommandsExAsync(za,this.Obj))}}else this.cKd()}cKd(){var M;(M=this.context).Zzc=M.Zzc+1;this.context.Zzc>=this.context.UJc&&(this.Z6b.udg(this.context.Sqa,!1),0<this.context.UJc&&10===this.context.Sqa&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(M=!1,rc()&&(M=this.zTi(this.context.omd)),this.NSi(this.context.omd),M?this.Zga(this.jOe(this.context.$6b)):this.ikb.Lfk(this.contextActivationMgr,
this.context.$6b,this.context.pMa,(za,Ab)=>{const ec=new r.a;for(const Ic of za)za=Ic.zVb(),Ab&&Ab.solutionId===Ic.solutionId&&(za.showCallout=!0,this.ikb.Tvg(Ab)),ec.add(za);this.Zga(ec)})):this.Zga(this.jOe(this.context.$6b)))}jOe(M){const za=new r.a;if(M)for(const Ab of M)za.add(Ab.zVb());return za}Zga(M){M&&M.count||Xe.a.WFa(zb.a.W4c,"false",this.context.Sqa);M={["ack2"]:M};M[zb.a.X0]=this.context.Sqa;M[zb.a.aX]=this.context.wu;this.Xa.raiseEvent(zb.a.vBe,new we(M),this)}zTi(M){let za=!1;if(M&&
1>M.count)return za;const Ab=zc();if(!Ab)return za;for(const ec of M)if(ec.storeId&&ec.storeId.toLowerCase()===Ab.toLowerCase()||ec.assetId&&ec.assetId.toLowerCase()===Ab.toLowerCase())M={["SDX_Id"]:He.Lef(ec),["SDX_TargetType"]:Ih.c(ec.targetType)?"":ec.targetType.toString()},$f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Aa.a.Kl(M)})),za=!0;return za}NSi(M){if(!(M&&1>M.count))if(this.Z6b.SHi()){var za=this.Z6b.tei();za?(M=this.eaf(M,
za),t.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(M=this.eaf(M,null),t.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.Z6b.xVj(M)}else t.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}eaf(M,za){const Ab={};let ec=!1;for(const Ic of M)if(M=He.Lef(Ic))!za||M in za||(this.oL(Ic,M),t.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===M.toLowerCase()?ec||(ec=!0,Ab[M]=null):Ab[M]=null;return Ab}oL(M,za){var Ab=
M.installTimeInMS?(new Date(M.installTimeInMS)).toISOString():"";Ab={["SDX.Id"]:za,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ih.c(M.targetType)?"":M.targetType.toString(),["SDX.AdminDeploymentTime"]:Ab};$f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Kl(Ab)}));1===M.targetType&&(M={["SDX.Id"]:za,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},$f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.AppPinning",
dataFields:Aa.a.Kl(M)})))}static I9a(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}static Lef(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}}Object(k.a)(He,"AddInCommandsListLoader",null,[]);class jf{constructor(M){this.aOg=M}get Dga(){return this.aOg}insertOsfControl(M){return this.Dga.insertOsfControl(M)}getManifestInvaildErrorString(){return this.Dga.getManifestInvaildErrorString()}isAddinCommandsAsync(M,
za){this.Dga.isAddinCommandsAsync(M,za)}isAddinCommandsExAsync(M,za){this.Dga.isAddinCommandsExAsync(M,za)}ownerAddinControlRecreated(M,za){this.Dga.ownerAddinControlRecreated(M,za)}queryEntitlementDetails(M){this.Dga.queryEntitlementDetails(M)}}Object(k.a)(jf,"ContextActivationMgrWrapper",null,[765]);class yf{createAddinDataProvider(M,za){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(M,za.Dga)}static get instance(){yf.La||(yf.La=new yf);return yf.La}}yf.La=null;Object(k.a)(yf,
"OSFAddinDataProviderFactory",null,[761]);class pg{constructor(){this.Ver=1}}Object(k.a)(pg,"CacheItem",null,[]);class gg{constructor(M){this.BIa=M}wk(M){const za=this.BIa.getItem(M);if(za){let Ab=new pg;try{Ab=Sys.Serialization.JavaScriptSerializer.deserialize(za,!0)}catch(ec){return this.BIa.removeItem(M),null}return Ab.Data?Ab.Data:Ab.data}return null}tVa(M){this.BIa.removeItem(M)}}Object(k.a)(gg,"AppsDataCacheManager",null,[790]);class Xg{constructor(){new gg(kd.a.instance)}udg(M,za){M=zb.a.ibf()+
M;kd.a.instance.setItem(M,za.toString())}tei(){var M=zb.a.Mef();t.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",M);M=kd.a.instance.getItem(M);return yg.a(M)}xVj(M){const za=zb.a.Mef();t.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",za);kd.a.instance.setItem(za,yg.c(M))}SHi(){return!!kd.a.instance.localStorage}static get instance(){Xg.La||(Xg.La=new Xg);return Xg.La}}Xg.La=null;Object(k.a)(Xg,"AddInCommandsCacheManager",null,[759]);class aa{constructor(M,za,Ab,ec,Ic,ed){this.wu=M;this.en=
za;this.w4=Ab;this.displayName=Ic;this.Eyf=ed}}Object(k.a)(aa,"PostLaunchAddinCommandsParameters",null,[]);class Va{constructor(M){this.UVc=null;this.Tje=M}get aSa(){return this.UVc}P2a(M,za){this.Tje.P2a(M,void 0===za?null:za);this.UVc=M}PTd(M){this.Tje.PTd(M)}mfg(M){this.UVc=M}}Object(k.a)(Va,"RibbonExtensibilityManagerWithChangeDetection",null,[791]);var hc=a(915),Bc=a(108);class Td{static hcf(M){const za=new r.a;if(Td.XNe)for(var Ab of Td.XNe)za.add(Ab);Ab=null;switch(M){case "Workbook":Ab=Td.ysk;
break;case "Document":Ab=Td.eDh;break;case "Presentation":Ab=Td.dqj}if(Ab)for(const ec of Ab)za.add(ec);return za}}Td.XNe=["PrimaryCommandSurface","ContextMenu"];Td.ysk=null;Td.eDh=null;Td.dqj=null;Object(k.a)(Td,"ExtensionPointType",null,[]);class V{constructor(M){this.lpe=null;if(Ih.c(M))throw t.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.hFg=M}get OLb(){return this.lpe||(this.lpe=new r.a)}get cCe(){return this.hFg}}
Object(k.a)(V,"ContextMenuExtensibility",null,[771]);class bb{constructor(M,za,Ab){za=void 0===za?null:za;Ab=void 0===Ab?0:Ab;if(Ih.c(M))throw t.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.UNg=M;this.kRg=za;this.NJg=Ab}get uZ(){return this.UNg}get startedNode(){return this.kRg}get U0h(){return this.NJg}}Object(k.a)(bb,"RibbonExtensibility",null,[806]);class gc{constructor(M){this.QIg=
M.entitlement}get entitlement(){return this.QIg}createActionContext(M,za){M={};M.ownerAddinInfo=this.entitlement;M.action=za;return M}}Object(k.a)(gc,"AddInCommandsContextProvider",null,[]);class xc{constructor(M,za,Ab){this.Gce=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=M;this.eventBuilder=za;this.contextMenuBuilder=Ab}get addinInfo(){return this.Gce}mqh(M){return new gc(M)}createActionBuilder(M,za){return OfficeExt.DefaultControlActionBinder.createActionBuilder(M,
za.entitlement,za.manifest)}startApplyAddin(M){this.Gce=M;const za=this.mqh(M);this.actionBuilder=this.createActionBuilder(za,M)}endApplyAddin(){}Qmd(M,za,Ab){Ab=void 0===Ab?0:Ab;return this.ribbonBuilder.lw&&0<this.ribbonBuilder.lw.count?new bb(this.h0h(M,za),this.addinInfo.startedNode,Ab):null}s8e(){var M=void 0===M?null:M;if(this.contextMenuBuilder.Buc&&0<this.contextMenuBuilder.Buc.count){M||(M=this.addinInfo.entitlement.solutionId);M=new V(M);for(const za of this.contextMenuBuilder.Buc)M.OLb.add(za);
return M}return null}h0h(M,za){return this.ribbonBuilder.lw&&0<this.ribbonBuilder.lw.count?new Eg.a(this.ribbonBuilder.lw,M,za):null}}Object(k.a)(xc,"AddinCommandsBuilder",null,[]);class Gd{constructor(M,za,Ab,ec,Ic,ed,Ed){this.aYa=new Bc.a;this.wu=M;this.Qh=za;this.Lr=Ab;this.ribbonManager=ec;this.contextMenuManager=Ic;this.OE=ed;this.Vka=Ed;this.JR=Ze.AFrameworkApplication.sa.XE}kJb(M,za,Ab,ec,Ic,ed,Ed){const Pd=(Ae,Me,zf,Df)=>{Ic(Ae,Me,zf,Df);const fg=hc.a[this.wu]+Me.assetId;let qh;(()=>{let og=
this.aYa.Jf(fg);({value:qh}=og);return og})().returnValue&&(qh.stop(),qh=null,this.aYa.remove(fg))};if(0!==this.wu&&M){t.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",M.count);4===this.wu&&(t.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",ec)),this.uhh(M,ec),ed());for(const Ae of M)if(M=Ae,t.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Lr.lQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||
M.storeType,M.assetId,null,null,M.storeId))),this.Sxg(M))if(Ed&&M.requireConsent)Ed(M,Me=>{try{if(this.JR){const Df=hc.a[this.wu]+Me.solutionId,fg=this.JR.xf("ComponentAttach",Df);this.aYa.fa(Df,fg)}const zf=this.OE.Uma(Me.storeType,Me.solutionId);6!==this.wu&&(zf&&(this.J$b(zf),zf.zE.purge(!1)),this.Qh.insertOsfControl(this.pOb(Me,za,Ab,Pd)),zf&&this.Qh.ownerAddinControlRecreated(Me.solutionId,Me.storeType))}catch(zf){t.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.Lr.lQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(Me.solutionId,Me.ownerAddinStoreType||Me.storeType,Me.assetId,null,null,Me.storeId),Me.version,Me.storeType,Me.storeId,zf.message)),Pd(!1,Me,null,null)}});else try{if(this.JR){const zf=hc.a[this.wu]+M.solutionId,Df=this.JR.xf("ComponentAttach",zf);this.aYa.fa(zf,Df)}const Me=this.OE.Uma(M.storeType,M.solutionId);!Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFAddinLaunchRefactor",!1)||3!==Ze.AFrameworkApplication.sa.Sa.Hj&&
1!==Ze.AFrameworkApplication.sa.Sa.Hj&&2!==Ze.AFrameworkApplication.sa.Sa.Hj||3!==this.wu||"excatalog"===M.storeType||!Me||Me.isUpgraded?6!==this.wu&&(Me&&(this.J$b(Me),Me.zE.purge(!1)),this.Qh.insertOsfControl(this.pOb(M,za,Ab,Pd)),Me&&this.Qh.ownerAddinControlRecreated(M.solutionId,M.storeType)):(this.ribbonManager.mfg(Me.Tq),Pd(!0,M,null,Me.displayName))}catch(Me){t.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.Lr.lQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId,Me.message)),Pd(!1,M,null,null)}else Pd(!1,M,null,null)}}YPi(M,za,Ab,ec,Ic,ed){const Ed=(Pd,Ae,Me,zf)=>{ed(Pd,Ae,Me,zf);const Df=hc.a[this.wu]+Ae.solutionId;let fg;(()=>{let qh=this.aYa.Jf(Df);({value:fg}=qh);return qh})().returnValue&&(fg.stop(),fg=null,this.aYa.remove(Df))};if(6===this.wu&&M)if(t.ULS.sendTraceTag(592290762,220,50,
String.format("{0}: Install dynamic ribbon {1}",this.Lr.lQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId))),this.Sxg(M))try{if(this.JR){const Ae=hc.a[this.wu]+M.solutionId,Me=this.JR.xf("ComponentAttach",Ae);this.aYa.fa(Ae,Me)}const Pd=this.OE.Uma(M.storeType,M.solutionId);Pd||Ed(!1,M,null,null);Ze.AFrameworkApplication.sa&&Ze.AFrameworkApplication.sa.Sa.delayInstallAddInIsEnabled?this.Q8e(M,za,ec,Ic,Ab,Ae=>{Ed(Ae,M,Ab,Pd.displayName)}):
(this.Q8e(M,za,ec,Ic,Ab),Ed(!0,M,Ab,Pd.displayName))}catch(Pd){t.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.Lr.lQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId,Pd.message)),Ed(!1,M,null,null)}else Ed(!1,M,null,null)}v4i(M,za,Ab,ec,Ic,ed){if(ed)if(ed._isAddinCommandsManifest(this.Lr.lQ))try{Ze.AFrameworkApplication.sa&&
Ze.AFrameworkApplication.sa.Sa.delayInstallAddInIsEnabled?this.P8e(M,za,Ab,Ic,ed,Ed=>{ec(Ed,M,ed,ed.getDefaultDisplayName())}):(this.P8e(M,za,Ab,Ic,ed),ec(!0,M,ed,ed.getDefaultDisplayName()))}catch(Ed){t.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Lr.lQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,
null,M.storeId),M.version,M.storeType,M.storeId,Ed.message)),ec(!1,M,ed,ed.getDefaultDisplayName())}else t.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.Lr.lQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId)),ec(!1,M,null,null);else t.ULS.sendTraceTag(17586259,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Lr.lQ,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId)),ec(!1,M,null,null)}pOb(M,za,Ab,ec){const Ic={},ed=document.createElement("div");ed.setAttribute("visible","false");Ic.div=ed;Ic.id=M.solutionId;Ic.solutionId=M.solutionId;Ic.version=M.version;Ic.storeType=M.storeType;
Ic.storeId=M.storeId;Ic.assetId=M.assetId;Ic.assetStoreId=M.assetStoreId;Ic.isvirtualOsfControl=!0;Ic.virtualOsfControlActivationCallback=(Ed,Pd)=>{const Ae=this.OE.Uma(M.storeType,M.solutionId);Ae&&(Ae.isUpgraded&&(M.isUpgraded=!0),this.J$b(Ae));this.v4i(M,za,Ab,ec,Ed,Pd)};Ic.reason=3===this.wu?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Ic}P8e(M,za,Ab,ec,Ic,ed){ed=void 0===ed?null:ed;const Ed={};Ed.solutionId=
ec.getSolutionId();Ed.version=ec.getVersion();Ed.storeType=ec.getStoreType();Ed.storeId=ec.getStoreId();Ed.assetId=ec.getAssetId();Ed.assetStoreId=ec.getAssetStoreId();Ed.targetType=ec.getOsfControlType();let Pd=null,Ae=null;if(Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Pd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Lr.lQ,this.Lr.formFactor)).parseExtensions(Ed,Ic,this.Vka),Ae=Td.hcf(this.Lr.lQ);
else try{Pd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Lr.lQ,this.Lr.formFactor)).parseExtensions(Ed,Ic,this.Vka),Ae=Td.hcf(this.Lr.lQ)}catch(zf){throw t.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+zf.message),zf;}if(Ae&&0<Ae.count){if(Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Me=za(M);za=Ab(M);Ab=!!Ze.AFrameworkApplication.da&&Ze.AFrameworkApplication.da.na("AddinCommandsMultipleCustomTabsEnabled");
Me=new xc(Me,null,za);for(const zf of Ae)Me.commandSurface=zf,Pd.apply(Me,this.Vka,Ab)}else try{const zf=za(M),Df=Ab(M),fg=!!Ze.AFrameworkApplication.da&&Ze.AFrameworkApplication.da.na("AddinCommandsMultipleCustomTabsEnabled");Me=new xc(zf,null,Df);for(const qh of Ae)Me.commandSurface=qh,Pd.apply(Me,this.Vka,fg)}catch(zf){throw t.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+zf.message),zf;}if(OSF.OUtil.checkFlight(14))try{const zf=Me.Qmd(M.solutionId,
Ic.getDefaultDisplayName()),Df=Me.s8e();zf&&this.ribbonManager.P2a(zf,ed);Df&&this.contextMenuManager.oye(Df);this.OE.Pye(ec,zf,Df,Ic.getDefaultDisplayName());t.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Ic.getDefaultDisplayName())}catch(zf){throw OfficeExt.DevConsole.log(zf),t.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+zf.message),zf;}else try{const zf=Me.Qmd(M.solutionId,Ic.getDefaultDisplayName()),Df=Me.s8e();zf&&this.ribbonManager.P2a(zf);
Df&&this.contextMenuManager.oye(Df);this.OE.Pye(ec,zf,Df,Ic.getDefaultDisplayName());t.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Ic.getDefaultDisplayName())}catch(zf){throw t.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+zf.message),zf;}}}Q8e(M,za,Ab,ec,Ic,ed){ed=void 0===ed?null:ed;const Ed={};Ed.solutionId=M.solutionId;Ed.version=M.version;Ed.storeType=M.storeType;Ed.storeId=M.storeId;Ed.assetId=M.assetId;Ed.assetStoreId=M.assetStoreId;Ed.targetType=
M.targetType;const Pd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Lr.lQ,this.Lr.formFactor);try{const Ae=za.getManifest(),Me=Pd.parse(Ed,Ae,Ic,this.Vka,za.getSharedRuntimeId(),za),zf=Ab(M),Df=ec(M),fg=new xc(zf,null,Df);fg.commandSurface="PrimaryCommandSurface";Me.apply(fg,this.Vka,!0);if(fg.ribbonBuilder.lw&&0<fg.ribbonBuilder.lw.count){const qh=fg.Qmd(M.solutionId,za.getManifest().getDefaultDisplayName(),1);Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.P2a(qh,ed):qh&&this.ribbonManager.P2a(qh,ed);this.OE.JWg(za,qh,Ic,za.getManifest().getDefaultDisplayName());t.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",za.getManifest().getDefaultDisplayName())}}catch(Ae){t.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",za.getManifest().getDefaultDisplayName(),Ae.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Ae)}}J$b(M){M.Tq&&this.ribbonManager.PTd(M.Tq);
M.nxb&&this.contextMenuManager.$Aj(M.nxb);this.OE.IAj(M.zE.getStoreType(),M.zE.getSolutionId())}uhh(M,za){za=Wd.a(za);for(const Ab of this.OE.eab){if(Ab.zE.getStoreType()!==za)continue;let ec=!0;for(const Ic of M){const ed=Ic;if(ed&&Ab.Jvf(ed.storeType,ed.solutionId)){ec=!1;break}}ec&&(this.J$b(Ab),Ab.zE.purge(!1))}}Sxg(M){return!!M&&!!M.solutionId&&!!M.version&&!!M.storeType&&!!M.storeId}}Object(k.a)(Gd,"AddInCommandsIntegration",null,[]);class pe{constructor(M,za,Ab,ec,Ic,ed,Ed,Pd){Pd=void 0===
Pd?null:Pd;this.$b=new ae.a;this.fOc=M;this.DHg=za;this.jm=Ab;this.Bve=ec;this.w1a=Ic;this.WEg=ed;this.jYb=Ed;this.LNg=Pd}HYg(M){this.$b.addHandler(zb.a.wBe,M)}H_g(M){this.$b.addHandler(zb.a.Dzf,M)}j1g(M){this.$b.addHandler(zb.a.rjg,M)}NYg(M){this.$b.addHandler(zb.a.l7c,M)}rQi(M,za,Ab){const ec=Ab[zb.a.Dtb],Ic=void 0===Ab[zb.a.aX]?0:Ab[zb.a.aX];if(ec&&0!==Ic)if(0>=ec.count&&4!==Ic)this.mYf(new aa(Ic,null,null,za,null,!0));else{var ed=ec.count,Ed=new Va(new th),Pd=void 0===Ab[zb.a.X0]?-1:Ab[zb.a.X0],
Ae=new Gd(Ic,this.jm,this.fOc,Ed,this.DHg,this.w1a,this.jYb),Me=og=>this.Bve.zah(og.solutionId,this.jYb,this.fOc,M),zf=og=>this.Bve.J$g(og.solutionId),Df=(og,ch,ah)=>{ed--;ah=new aa(Ic,ch,Ed,za,ah,0>=ed);if(og&&ch)this.mYf(ah);else{if(3===Ic||ch&&ch.isUpgraded)og="",ch&&(og=Telemetry.PrivacyRules.GetPrivacyCompliantId(ch.solutionId,ch.ownerAddinStoreType||ch.storeType,ch.assetId,null,null,ch.storeId)),ch={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:og},
$f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Kl(ch)}));this.lYf(ah)}ed||Ze.AFrameworkApplication.sa.Sv()},fg=(og,ch,ah,Ch)=>{Df(og,ch,Ch)},qh=()=>{this.xJd();0>=ec.count&&4===Ic&&this.w1a.b_d()};6===Ic?(Pd=Ab[zb.a.oNa],Ab=Ab[zb.a.pNa],Ae.YPi(ec.ka(0),Pd,Ab,Me,zf,(og,ch,ah,Ch)=>{Df(og,ch,Ch)})):Ae.kJb(ec,Me,zf,Pd,fg,qh,this.LNg)}else $f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Kl({["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),t.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.fOc.lQ)),this.lYf(new aa(Ic,null,null,za,null,!0))}lYf(M){this.xJd(M);this.jkg(!1,M)}mYf(M){const za=M.en;let Ab=null;null!==za&&(Ab=za.storeType,Ab=Ab.toLowerCase());if(M&&"omex"===Ab&&(3===M.wu||za.isUpgraded)){var ec={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(za.solutionId,
za.ownerAddinStoreType||za.storeType,za.assetId,null,null,za.storeId)};$f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Aa.a.Kl(ec)}))}this.xJd(M);ec=zd()&&"omex"===Ab&&!!M.w4&&!!za.solutionId&&2===M.wu&&za.solutionId.toLowerCase()===zc().toLowerCase();var Ic="excatalog"===Ab&&3===M.wu;if("omex"===Ab&&M.w4&&(3===M.wu&&"hardcodedpreinstall"!==Ab||za.isUpgraded)||ec||Ic)ec=new lg,ec.en=za,ec.Tq=M.w4.aSa,this.$b.raiseEvent(zb.a.l7c,ec);ec=rc();Ic=
zc();ec&&za&&"excatalog"===za.storeType&&M.w4&&5===M.wu&&Ic&&(za.storeId&&za.storeId.toLowerCase()===Ic.toLowerCase()||za.assetId&&za.assetId.toLowerCase()===Ic.toLowerCase())&&(ec=new lg,ec.en=za,ec.Tq=M.w4.aSa,this.$b.raiseEvent(zb.a.l7c,ec),t.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."));za&&(Xg.instance.udg(Wd.b(Ab),!0),"uploadfiledevcatalog"===Ab&&(ec=this.WEg.createAddinDataProvider(Ab,this.jm))&&ec.localCacheAddinCommands(this.jm.Dga,za.solutionId,za.version,
za.storeId),Xe.a.WFa(zb.a.W4c,"true",Wd.b(Ab)));this.jkg(!0,M)}jkg(M,za){M?za.w4&&5===za.wu&&za.w4.aSa&&void 0!==za.en.showCallout&&null!==za.en.showCallout&&za.en.showCallout?((new Da(this.$b)).PVg(za.en,Eg.a.CBb(za.w4.aSa)),M=new lg,M.Tq=za.w4.aSa,M.en=za.en,this.$b.raiseEvent(zb.a.rjg,M)):3!==za.wu?za.Eyf&&this.w1a.b_d():za.w4&&za.w4.aSa&&"hardcodedpreinstall"!==za.en.storeType&&$h.a.f2j(za.displayName,za.w4.aSa,za.en.isAutoLaunched):3===za.wu?za.en&&"uploadfiledevcatalog"===za.en.storeType.toLowerCase()?
(za=this.jYb.S7h(za.en.solutionId),$h.a.c2d(za?za:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.w1a.Feg():za.Eyf&&this.w1a.b_d()}xJd(M){var za=(M=void 0===M?null:M)?M.en:null;const Ab=new lg;if(Ab.en=za){var ec=this.w1a.Uma(za.storeType,za.solutionId,6===M.wu?1:0);if(ec&&ec.Tq){Ab.Tq=ec.Tq;var Ic=zc();Ic=zd()&&!!za.solutionId&&!!Ic&&za.solutionId.toLowerCase()===Ic.toLowerCase()&&2===M.wu;if(3===M.wu&&"hardcodedpreinstall"!==za.storeType||Ic)M="",ec.Tq.uZ&&ec.Tq.uZ.lw&&
(ec=ec.Tq.uZ.lw.ka(0))&&(M=ec.id),za={["SDX_CommandPlacement"]:M,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(za.solutionId,za.ownerAddinStoreType||za.storeType,za.assetId,null,null,za.storeId)},$f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Aa.a.Kl(za)}))}}this.$b.raiseEvent(zb.a.wBe,Ab)}}Object(k.a)(pe,"LaunchAddinCommandsHandler",null,[763]);class Ne{}Ne.GZa="Alt";
Ne.HZa="Command";Ne.id="Id";Ne.KZa="Image16by16";Ne.TXb="LabelText";Ne.MZa="Title";Ne.GROUP="Group";Ne.ube="Groups";Ne.Zlb="Controls";Ne.button="Button";Ne.sea="FlyoutAnchor";Ne.LARGE="Large";Ne.SMALL="Small";Object(k.a)(Ne,"AddinDataNodeConstants",null,[]);var We=a(388);a(579);var pf=a(574);a(149);class Af{constructor(M,za){this.HIa=this.qfe=null;if(Ih.c(M)||Ih.c(za))throw t.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");
this.KHg=za;this._id=M;this.xX[Ne.id]=this._id}get id(){return this._id||""}get xX(){return this.qfe||(this.qfe={})}get controlType(){return this.KHg||""}get menuItems(){return this.HIa||(this.HIa=new r.a)}}Object(k.a)(Af,"ControlDefinition",null,[764]);class xg{constructor(M){this.Tne=null;if(Ih.c(M))throw t.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=M;this.Gpa[Ne.id]=this._id}get Gpa(){return this.Tne||
(this.Tne={})}get id(){return this._id||""}}Object(k.a)(xg,"MenuItemDefinition",null,[800]);class lh{constructor(M){this.Wta=null;if(Ih.c(M))throw t.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=M}get id(){return this._id}get controls(){return this.Wta||(this.Wta=new r.a)}}Object(k.a)(lh,"OfficeMenuDefinition",null,[762]);var ng=a(26);class sg{constructor(M,za,Ab){this.lM=
this.y_a=null;this.CXc=M;this.n_a=za;this.OZa=Ab;this.jNg=new r.a}get ivc(){return this.CXc}get Rwb(){return this.n_a}get p2c(){return this.OZa}addButton(M){t.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",M.actionType);this.lM=new Af(this.Owa(M.id),Ne.button);this.lM.xX[Ne.TXb]=M.label;this.lM.xX[Ne.GZa]=M.label;this.lM.xX[Ne.KZa]=M.icon["16"];this.Wub(this.lM.xX[Ne.id],M.action);this.dKa(this.lM.xX);this.y_a.controls.add(this.lM);this.lM=null}startBuildMenu(M){if(Ih.c(this.y_a))this.y_a=
new lh(M.id);else{const za=this.Owa(M.id);this.lM=new Af(za,Ne.sea);this.x4a(this.lM.xX,M);this.lM.xX[Ne.KZa]=M.icon["16"];this.lM.xX[Ne.HZa]=ng.a.alwaysEnabled}}addMenuItem(M){t.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",M.actionType);const za=new xg(this.Owa(M.id));this.x4a(za.Gpa,M);M.icon&&(za.Gpa[Ne.KZa]=M.icon["16"]);this.Wub(za.Gpa[Ne.id],M.action);this.dKa(za.Gpa);this.lM.menuItems.add(za)}endBuildMenu(){Ih.c(this.lM)?(this.Buc.add(this.y_a),this.y_a=null):(this.y_a.controls.add(this.lM),
this.lM=null)}get Buc(){return this.jNg}Wub(M,za){this.p2c.bindAction(M,za)}dKa(M){this.Rwb.dKa(M)}Owa(M){return this.ivc.NOa(M)}x4a(M,za){M[Ne.TXb]=za.label;M[Ne.GZa]=za.label}}Object(k.a)(sg,"ContextMenuExtensibilityCreator",null,[789,785]);class fh{constructor(M){this.bqb=M}get iLb(){return this.bqb}NOa(M){return this.iLb+M}}Object(k.a)(fh,"DefaultContextMenuNamingProvider",null,[788]);var Ig=a(1228);class Uf{bindAction(M,za){OfficeExt.DefaultControlActionBinder.bindAction(M,za)}}Object(k.a)(Uf,
"DefaultUIControlActionBinder",null,[787]);class Di{constructor(M){this.nHa=M}get command(){return this.nHa}dKa(M){M[Ne.HZa]=this.command}}Object(k.a)(Di,"DefaultUIControlCommandBinder",null,[786]);var Ei=a(31);class Xi{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(k.a)(Xi,"AddInControl",null,[]);class Ki{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(k.a)(Ki,
"AddInGroup",null,[]);class Pi{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(k.a)(Pi,"AddInMenuItem",null,[]);class lj{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(k.a)(lj,"AddInTab",null,[]);class uh{constructor(M,za,Ab,ec,Ic,ed){this.gYb=new r.a;this.knb=this.Zia=this.z_a=null;this.CXc=M;this.OZa=za;this.n_a=Ab;
this.qA=ec;this.jYb=Ic;this.zhe=ed}get ivc(){return this.CXc}get lw(){return this.gYb}get p2c(){return this.OZa}get Rwb(){return this.n_a}startBuildTab(M){const za=M.isOfficeTab?M.id:this.ivc.Lgf(M.id),Ab=M.isOfficeTab?null:M.label;this.z_a=Object.assign(new lj,{id:za,title:Ab,isOfficeTab:M.isOfficeTab,visible:M.visible,groups:[],tabType:M.tabType,insertBefore:M.insertBefore,insertAfter:M.insertAfter,autoFocus:M.autoFocus})}startBuildGroup(M){const za=this.Owa(M.id);this.Zia=Object.assign(new Ki,
{id:za,mlrId:M.mlrId,title:M.label,controls:[],groupType:0})}addNativeGroup(M){this.Zia=Object.assign(new Ki,{id:M.id,mlrId:M.mlrId,title:M.label,controls:[],groupType:1});this.z_a.groups.push(this.Zia)}addButton(M){const za=this.Owa(M.id);za&&(this.Wub(za,M.action),t.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",M.actionType),M=Object.assign(new Xi,{id:za,title:M.label,iconLocation:this.wpd(M),enabled:M.enabled,controlType:0,attributes:this.x4a()}),this.zhe.Zxe(new Ei.a(za,
this.Rwb.command.toString())),this.Zia.controls.push(M))}addNativeControl(M){M.id&&(t.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",M.actionType),M=Object.assign(new Xi,{id:M.id,title:"",iconLocation:"",enabled:M.enabled,controlType:2,attributes:this.x4a()}),this.Zia.controls.push(M))}startBuildMenu(M){const za=this.Owa(M.id);za&&(this.knb=Object.assign(new Xi,{id:za,title:M.label,iconLocation:this.wpd(M),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(M){const za=
this.Owa(M.id);za&&(this.Wub(za,M.action),t.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",M.actionType),M=Object.assign(new Pi,{id:za,title:M.label,iconLocation:this.wpd(M),enabled:M.enabled,attributes:this.x4a()}),this.zhe.Zxe(new Ei.a(za,this.Rwb.command.toString())),this.knb.menuItems.push(M))}endBuildMenu(){Ih.c(this.knb.id)||this.Zia.controls.push(this.knb);this.knb=null}endBuildGroup(){Ih.c(this.Zia.id)||this.z_a.groups.push(this.Zia);this.Zia=null}endBuildTab(){Ih.c(this.z_a.id)||
this.gYb.add(this.z_a);this.z_a=null}x4a(){const M={};this.dKa(M);return M}wpd(M){return M.icon["80"]?M.icon["80"]:M.icon["32"]}dKa(M){this.Rwb.dKa(M)}Owa(M){return this.ivc.NOa(M)}Wub(M,za){this.p2c.bindAction(M,za)}}Object(k.a)(uh,"OneLineRibbonExtensibilityCreator",null,[784,785]);class ej{constructor(M,za){this.bqb=M;this.OZa=new Uf;this.n_a=new Di(za)}J$g(M){M=new fh(M);return new sg(M,this.n_a,this.OZa)}zah(M,za,Ab,ec){Ab=new Ig.a(this.bqb,M,Ab,!0);return new uh(Ab,this.OZa,this.n_a,M,za,ec)}}
Object(k.a)(ej,"UIExtensibilityFactory",null,[760]);var ki=a(91),Gi=a(913),ai=a(22),$g=a(40),ei=a(76),gi=a(62);class Vh{get iAg(){return Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get jAg(){return Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)}constructor(M){this.rKa=
this.vKa=this.en=this.Tq=null;this.K4f=0;this.gcj=()=>{if(this.en&&this.rKa){const za=new ki.a(ng.a.E6,0,0,2,null);this.addinUICommandHandler.executeCommand(0,za,{["SourceControlId"]:this.rKa},null);t.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.g2j=(za,Ab)=>{za=null;if(Ab)if(za=Ab,this.en=za.en,(this.Tq=za.Tq)&&this.Tq.uZ&&this.Tq.uZ.lw&&(this.vKa=this.Tq.uZ.lw.ka(0)),this.vKa&&this.vKa.id)if(this.vKa.isOfficeTab)if(Ab=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),
za=this.en.solutionId,za in Ab?this.rKa=Ab[za]:(Ab=Vh.GetPrivacyCompliantId(this.en),t.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Ab}`),this.rKa=this.D1h(this.Tq)),this.rKa)if(ai.a.contains(this.vKa.id,bh.a.nR,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Eg.a.CBb(this.Tq),()=>{this.Mkg(this.Oqd(this.rKa))});else{if(Ab=this.$.Ga)Ab.P4c(this.$Tf),t.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else t.ULS.sendTraceTag(537170694,
220,10,"Failed to get button id for addin"),Ab={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Vh.GetPrivacyCompliantId(this.en),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(Ab)})),this.W9();else this.Okg(this.Oqd(this.vKa.id),0);else t.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),
Ab={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Vh.GetPrivacyCompliantId(this.en),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(Ab)})),this.W9();else this.W9()};this.$Tf=()=>{if(ai.a.contains(this.vKa.id,appChrome.selectors.getSelectedTabId(),!0)){var za=this.$.Ga;za&&za.J6f(this.$Tf);this.Mkg(this.Oqd(this.rKa))}};this.jcj=
()=>{var za={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Vh.IZa(this.PF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(za)}));this.W9();const Ab={};Ab[ei.a.di]=this.PF;za={};za.solutionId=this.PF.solutionId;za.assetId=this.PF.assetId;za.assetStoreId=this.PF.assetStoreId;za.height=0!=this.PF.height?this.PF.height:600;za.storeId=
this.PF.storeId;za.storeType=this.PF.storeType;za.targetType=this.PF.targetType;za.width=0!=this.PF.width?this.PF.width:600;za.displayName=this.PF.displayName;za.version=this.PF.version;za.isAddinCommands=!1;Ab[zb.a.Wka]=za;const ec=new ki.a(-741808261,0,0,2,null);$g.TaskExtensions.Aa(gi.GetServiceTaskFactory.je(this.$.ia,374,375,1),Ic=>{Ic=Ic.result;null!=Ic&&Ic.insertAgave(Ab,ec)},this.$.ma,3)};this.A6i=()=>{const za={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Vh.IZa(this.PF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(za)}));this.W9()};this.b8i=()=>{const za={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Vh.IZa(this.PF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(za)}));this.W9()};
this.Kqa=za=>{t.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${za?za.httpStatus:-1}`)};this.$=M.$;this.addinUICommandHandler=M;this.appName=Ze.AFrameworkApplication.da.Ra("WebAppShortName")||"Excel";this.T1g=Ze.AFrameworkApplication.da.eg("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}static GetPrivacyCompliantId(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}static IZa(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,
M.storeType,M.assetId,null,null,M.storeId)}Zzj(M){this.PF=M;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.jcj,!0),window.addEventListener("DismissCallout",this.b8i,!0),window.addEventListener("CloseCallout",this.A6i,!0))}Oqd(M){return"[id="+M+"]"}Okg(M,za){za>this.T1g?(window.clearTimeout(this.K4f),this.Nkg("[data-unique-id='pivotOverflowButton']"),t.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+
M)?this.Nkg(M):this.K4f=window.setTimeout(()=>{this.Okg(M,za+1)},1E3)}Mkg(M){var za=document.querySelector("button[data-unique-id='RightPaddle']");if(za)M={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Vh.GetPrivacyCompliantId(this.en),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(M)}));else if(za=document.querySelector("button"+
M),!za||"none"===window.getComputedStyle(za).display)if(za=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!za){za={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Vh.GetPrivacyCompliantId(this.en),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(za)}));t.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");
this.W9();return}this.trg(za,"ShowTeachingUIForAddinButton")}Nkg(M){M=document.querySelector("button"+M);if(!M&&(M=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!M)){M={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Vh.GetPrivacyCompliantId(this.en),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(M)}));t.ULS.sendTraceTag(537170690,
220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.W9();return}this.trg(M,"ShowTeachingUIForAddinTab")}trg(M,za){M.setAttribute("lpp-id","latestAddin");const Ab=Pf.a.instance.ie("Common.ISystemInitiatedFeedback");Ab&&M?(Ab.execute(ec=>{ec.logActivity(za,null)}),M={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Vh.GetPrivacyCompliantId(this.en),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(M)})),t.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(t.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),M={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Vh.GetPrivacyCompliantId(this.en),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(M)})),this.W9())}D1h(M){if(!M)return null;M=M.uZ;if((null===M||void 0===M?0:M.lw)&&0<M.lw.count)for(const za of M.lw)if(za.groups&&0<za.groups.length)for(const Ab of za.groups)if(Ab.controls&&0<Ab.controls.length)for(const ec of Ab.controls){if(ec.attributes&&0===ec.controlType&&ec.enabled)return ec.id;if(ec.menuItems)for(const Ic of ec.menuItems)if(Ic.attributes&&Ic.enabled)return ec.id}return null}Lkg(){var M="button[data-unique-id = 'Ribbon-InsertAppsForOffice']";
f.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&(M=this.jAg&&this.iAg?"button[data-unique-id = 'Ribbon-InsertAddInFlyout']":M);if((M=document.querySelector(M))&&"none"!==window.getComputedStyle(M).display)t.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{M=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==M){M={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Vh.IZa(this.PF),
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(M)}));t.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.W9();return}t.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const za=Pf.a.instance.ie("Common.ISystemInitiatedFeedback");null==za||null==M?(M={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Vh.IZa(this.PF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(M)})),t.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.W9()):(za.execute(Ab=>{Ab.logActivity("ShowTeachingUIForContentAddin",null)}),M={["AppTeachingUICalloutAction"]:"Show",["SDX.Id"]:Vh.IZa(this.PF),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl(M)})),t.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}LDc(M){const za={},Ab={};Ab.LastTeachingUIShowTime=(new Date).toUTCString();Ab.AddinHasShown=M;za[this.appName]=yg.c(Ab);this.Gtb=new Kf(this.appName,null,null,this.Kqa),this.Gtb.ggc(za),t.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}W9(){if(!this.sDc){const M=
window.g_roamingAddinList;M&&(this.LDc(M),this.sDc=!0)}}}Object(k.a)(Vh,"AddinTeachingCalloutHandler",null,[]);var lf=a(1192),E=a(430),da=a(11),Ha=a(199),Fb=a(44),bc=a(20),Vc=a(63),Sc=a(125),wd=a(153),md=a(195);class Ld extends wd.a{constructor(M,za,Ab,ec){super();this.Y_="calc(100% - 46px)";this.zba="15px";this.Z_="0";this.Dnb="WACDialogPanel";this.eH=695;this.Enb=462;this.kF="80%";this.smb=350;this.Mta="100%";this.sW=null;this.ke=5;this.Rg="AddinInstallDialog";this.MFg=M;this.k0=za;this.LSg=Ab;
this.RNg=ec}Rz(){super.Rz();this.tk.style.width=this.Mta;this.tk.style.height=this.Y_;this.tk.style.marginTop=this.zba;this.tk.style.padding=this.Z_;document.getElementById(this.qk("WACDialogButtonPanel")).style.display="none";this.Gla.setAttribute("tabindex","0");$addHandler(this.Gla,"keyup",Object(Sc.a)(this,this.onKeyUp,"onKeyUp"));const M=document.createElement("iframe");M.setAttribute("id","InstallAddinDialog");M.setAttribute("src","about:blank");M.setAttribute("width","100%");M.setAttribute("height",
"100%");M.setAttribute("marginHeight","0");M.setAttribute("marginWidth","0");M.setAttribute("frameBorder","0");M.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");const za=String.format("https://inclient.store.office.com/gyro/clientstore/flyoutdetails/{0}?client={1}&ui={2}&rs={2}",this.MFg,this.k0,this.LSg);M.setAttribute("src",za);this.sW=M;$addHandler(M,"load",Object(Sc.a)(this,this.onLoad,"onLoad"));$addHandler(window,"message",Object(Sc.a)(this,
this.onMessage,"onMessage"));this.tk.appendChild(M);this.tk.appendChild(this.lrh())}lrh(){const M=document.createElement("div");M.setAttribute("tabindex","0");$addHandler(M,"focus",Object(Sc.a)(this,this.Ecj,"onLoopPivotFocus"));return M}onKeyUp(M){13!==M.keyCode&&32!==M.keyCode||this.hide()}Ecj(){this.Gla.focus()}onLoad(){this.sW.focus()}onMessage(M){M=M.rawEvent;if(M.source===this.sW.contentWindow&&(M=(M=M.data)?M.split("|"):null)&&0<M.length&&("REFRESH_REQUIRED"===M[0]||"PRELOAD_MANIFEST"===M[0])){kd.a.instance.setItem("refreshRequired",
"true");const za={};za.solutionId=M[1];za.version=Ld.Y1i(M[3]);za.storeType=M[4];za.storeId=M[5];za.assetId=M[6];za.targetType=Ld.wlj(M[2]);za.assetStoreId=M[7];za.width=parseInt(M[8]);za.height=parseInt(M[9]);this.RNg(za)}}Xqa(){this.tk.style.width=this.Mta;this.tk.style.height=this.Y_;this.tk.style.marginTop=this.zba;this.tk.style.padding=this.Z_;this.eH>md.a.a4?(this.Md.style.width=String.format("{0}px",md.a.a4),this.Md.style.overflowX="scroll",Ze.AFrameworkApplication.isRtl?this.Md.style.right=
"0":this.Md.style.left="0"):(this.Md.style.width=String.format("{0}px",this.eH),this.Md.style.overflowX="hidden");this.Md.offsetHeight>md.a.fV||this.Enb+50>md.a.fV?(this.Md.style.height=String.format("{0}px",md.a.fV),this.Md.style.overflowY="scroll",this.Md.style.top="0",Ze.AFrameworkApplication.isRtl?this.Md.style.right="0":this.Md.style.left="0",this.tk.style.minHeight=String.format("{0}px",this.smb)):(this.Md.style.overflowY="hidden",this.Md.style.top="10%",this.Md.style.height=this.kF);this.rda()}rda(){if(this.Md){var M=
this.Md.style.zIndex;this.Md.style.zIndex="-9999";if(this.eH>md.a.a4)Ze.AFrameworkApplication.isRtl?this.Md.style.marginRight="0":this.Md.style.marginLeft="0";else{const za=String.format("{0}px",Math.floor(-this.Md.offsetWidth/2));Ze.AFrameworkApplication.isRtl?this.Md.style.marginRight=za:this.Md.style.marginLeft=za;Ze.AFrameworkApplication.isRtl?this.Md.style.right="50%":this.Md.style.left="50%"}this.Md.style.zIndex=String(M)}else t.ULS.sendTraceTag(509871430,306,10,"_divMessageBox is null in CenterDialog()")}OG(){super.OG();
const M=document.getElementById(this.qk(this.Dnb));M.style.width=String.format("{0}px",this.eH);M.style.height=this.kF}get Vda(){return this.tk}dispose(){super.dispose();$removeHandler(window,"message",Object(Sc.a)(this,this.onMessage,"onMessage"))}static wlj(M){switch(M){case "1":return 0;case "2":return 1;default:return 0}}static Y1i(M){const za=M.split(".");for(let Ab=0;Ab<4-za.length;Ab++)M+=".0";return M}}Object(k.a)(Ld,"AddinInstallDialog",wd.a,[]);class oe{constructor(){this.addInDetails=this.title=
null}}Object(k.a)(oe,"AddInCategoryData",null,[]);class Qe{constructor(){this.links=this.description=this.displayName=this.uniqueId=this.solutionId=null}}Object(k.a)(Qe,"AddInDetailData",null,[]);class cf{constructor(){this.href=this.text=null}}Object(k.a)(cf,"AddInLinkData",null,[]);var sf=a(122);class wf{constructor(M,za,Ab){this.lba=0;this.Pie=!1;this.Irb=[];this.Qa=M;this.kba=za;this.Hqe=Ab;t.ULS.sendTraceTag(508396508,220,50,"AddInCategoryManager Initialized")}Zpa(M,za){M&&za&&this.W_j(za)&&
this.Cnj()}W_j(M){0===M.dC&&(this.lba|=1);1===M.dC&&(this.lba|=2);2===M.dC&&(this.lba|=4);return!!this.lba}Cnj(){let M=null;const za={},Ab=this.tJi,ec=this.c0i;var Ic=this.kba.nN(0);const ed=this.kba.nN(1),Ed=this.kba.nN(2);2!==Ic.errorCode||ec.length?3===Ic.errorCode&&3===ed.errorCode?M={label:CommonUIStrings.l_AddinPickerGeneralError,iconName:"Common",ariaDescription:CommonUIStrings.l_AddinPickerGeneralError}:4!==Ic.errorCode||ec.length?!this.Luf&&(!this.j3||0!==Ed.errorCode&&5!==Ed.errorCode)||
Ed.av.length||t.ULS.sendTraceTag(508396506,220,50,"get popular add-ins for backstage error: empty category, Flag: {0} Popular error code: {1}",this.lba,Ed.errorCode):M={label:CommonUIStrings.l_AddinPickerServiceDisconnectedError,iconName:"StoreDisabled",ariaDescription:CommonUIStrings.l_AddinPickerServiceDisconnectedError}:M={label:CommonUIStrings.l_AddinPickerDisableError,iconName:"StoreDisabled",ariaDescription:CommonUIStrings.l_AddinPickerDisableError};Ic=!M;if(!Ic||Ab||ec.length)Ic?(za.mruAddIns=
ec,Ab&&(za.categories=this.Anj)):za.errorViewProps=M,appChrome.api.dispatch(appChrome.actions.setFileMenuAddInsData(za,Ic)),Ab&&Ic&&!this.Pie&&(this.Pie=!0,t.ULS.sendTraceTag(508396504,220,50,"Set Popular Add-ins List to Backstage Success. Flag: {0}",this.lba))}get Luf(){return!!(this.lba&4)}get tJi(){const M=this.kba.nN(2);return(this.Luf||this.j3)&&(0===M.errorCode||5===M.errorCode)&&!!M.av.length}get Anj(){if(Ih.c(this.Hqe))return[];var M=JSON.parse(this.Hqe);const za=[];for(var Ab of M)M=Object.assign(new oe,
{title:Ab.title,addInDetails:[]}),this.w$g(M,Ab.solutionIds),0<M.addInDetails.length&&Array.add(za,M);0<this.Irb.length&&(Ab=this.kba.nN(2),t.ULS.sendTraceTag(508396503,220,15,"{0} SolutionIds not found in mapping: {1}, collection length: {2}",this.Irb.length,this.Irb,Ab.av.length),this.Irb=[]);return za}get c0i(){var M=[],za=this.kba.nN(0);Array.addRange(M,za.av);za=this.kba.nN(1);Array.addRange(M,za.av);M.sort((Ab,ec)=>{Ab=sf.d(Ab.displayName);ec=sf.d(ec.displayName);return Xf.a.localeCompare(Ab,
ec)});za=[];for(const Ab of M)M=Object.assign(new Qe,{description:Ab.description,displayName:Ab.displayName,solutionId:Ab.solutionId,uniqueId:this.DBb(Ab)}),Array.add(za,M);return za}w$g(M,za){const Ab=this.d0i;let ec=0;for(const Ic of za){if(4===ec)break;if(Ab.contains(Ic))continue;za=this.kba.eza(Ic);if(!za){this.Irb.push(Ic);continue}const ed=Object.assign(new Qe,{description:za.description,displayName:za.displayName,solutionId:za.solutionId,uniqueId:this.DBb(za)});ed.links=[Object.assign(new cf,
{text:CommonUIStrings.l_AddinOneLink,href:"https://appsource.microsoft.com/en-us/product/office/"+za.solutionId})];Array.add(M.addInDetails,ed);++ec}}get d0i(){const M=[];var za=this.kba.nN(0);Array.addRange(M,za.av);za=this.kba.nN(1);Array.addRange(M,za.av);za=new J.a(P.a.Ei());for(const Ab of M)za.add(Ab.solutionId);return za}DBb(M){return this.j3?String.format("{0}#{1}",M.solutionId,M.storeId):M.solutionId}get j3(){return!!this.Qa&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",
!1)&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",!1)}}Object(k.a)(wf,"AddInCategoryManager",null,[]);var Gf=a(914);class ld{constructor(M){this.q_c=M}next(M){this.q_c=(9301*this.q_c+49297)%233280;return Math.floor(this.q_c/233280*M)}}Object(k.a)(ld,"Random",null,[]);var de=a(1022),ug=a(599);class Zf{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(k.a)(Zf,"GallerySectionProps",null,[]);var ag=a(1227);class Rf{constructor(){this.text=
this.href=null}}Object(k.a)(Rf,"LinkProps",null,[]);var Cg=a(1021);class Yg{constructor(M,za){this.Pte=!0;this.IRg=M;this.JRg=za}QDd(){null==kd.a.instance.getItem("AddinEntryPointSurveyShowed")&&this.Pte&&(this.Pte=!1,window.setTimeout(()=>{this.Nue=Pf.a.instance.ie("Common.ISystemInitiatedFeedback");null!=this.Nue&&this.Nue.execute(M=>{const za=this.qjc();this.H2h()||za&&(!za||"hidden"!==za.visibility)||(M.CXa(this.IRg,null),kd.a.instance.setItem("AddinEntryPointSurveyShowed","1"))})},this.JRg))}qjc(){let M=
null;try{const za=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");za&&(M=ja.a.gB(za.parentNode.parentNode.parentNode))}catch(za){t.ULS.sendTraceTag(508343957,220,10,"AddinFlyout get parent and parent get exception "+(za?za.toString():""))}return M}H2h(){let M=null;try{M=document.getElementById("BackstageGetAddIns")}catch(za){t.ULS.sendTraceTag(508343956,220,10,"Backstage get parent and parent get exception "+(za?za.toString():""))}return M}}Object(k.a)(Yg,"FpsHelper",null,[]);class Ng{constructor(M,
za,Ab,ec,Ic,ed,Ed){this.QSc={};this.LMg={};this.L_b={};this.Vge=this.yie=0;this.sie=null;this.FJg=6E4;this.Zpa=(Pd,Ae)=>{this.j3?this.fzj(Ae):(this.dzj(Ae),this.Dce&&this.Dce.Zpa(Pd,Ae))};this.emb=za;this.Nja=null;this.BMg=Ab;this.DMg=ec;this.fQg=Ic;this.Dce=void 0===Ed?null:Ed;this.Qa=(void 0===ed?null:ed)||Ze.AFrameworkApplication.da;this.emb.dra(this.Zpa);appChrome.addInApi.loadOfficeAddInIcons()}get inh(){return this.L_b}dzj(M){if(M.av)for(let za=0;za<M.av.length;za++)appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+
M.av[za].solutionId,M.av[za].iconUrl);else 0===M.errorCode&&t.ULS.sendTraceTag(509687429,220,10,"addinDetails is null which will lead to no icons registered")}get sBh(){return!!this.Qa&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get j3(){return!!this.Qa&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",
!1)}Fmj(M){const za=[];var Ab=new ld((new Date).getDate());for(var ec=0;30>ec;ec++)Array.add(za,Ab.next(M.count));Ab=0;for(const Ic of M){ec=!1;for(const ed of za)if(Ab===ed){ec=!0;break}Ab++;if(ec){let ed;(ed=Ic.addinInfo).AUP=20*ed.AUP}else if(1===Ic.addinInfo.priority){let ed;(ed=Ic.addinInfo).AUP=4*ed.AUP}else if(2===Ic.addinInfo.priority){let ed;(ed=Ic.addinInfo).AUP=2*ed.AUP}}M.Sc((Ic,ed)=>Ic.addinInfo.AUP<ed.addinInfo.AUP?1:-1);return M}wxa(M,za){const Ab={};Ab.width=M;Ab.height=za;Ab.backgroundColor=
"transparent";return Ab}Zcd(){return{flexDirection:"column"}}F9h(){const M={},za={},Ab={};za.root={margin:"0px","margin-left":"12px",width:"100%",maxWidth:"unset"};za.inner={margin:"-4px","margin-left":"18px"};Ab.root=this.wxa(100,100);Ab.flexContainer=this.Zcd();Ab.label={"margin-top":"4px","max-width":"86px","font-size":"12px","text-overflow":"ellipsis"};M.galleryButtonInExpanded=Ab;M.galleryStack=za;return M}x0h(){return Object.assign(new ag.a,{Id:"AddinFlyoutMoreButton",ExternalId:"AddinFlyoutMoreButton",
Icon:"AllApps_16",Command:this.fQg,LabelText:CommonUIStrings.l_AddinsFlyoutSeeAllButtonText,FullIconStyle:{root:{"max-width":"16px","max-height":"16px","min-width":"16px","min-height":"16px",border:"1px solid var(--border-color, #c8c8c8)","border-radius":"6px",padding:"15px 15px 15px 15px",overflow:"hidden"}},Role:"menuitem",Alt:CommonUIStrings.l_AddinsPickerGalleryButtonMoreArialText})}q_h(M,za,Ab){const ec={},Ic={width:"32px",height:"32px","border-radius":"6px",overflow:"hidden",padding:"7px",border:"1px solid var(--border-color, #c8c8c8)"};
Ze.AFrameworkApplication.isRtl&&(Ic.direction="ltr");ec.root=Ic;return Object.assign(new ag.a,{Id:Ab,ExternalId:Ab,Icon:"AddinFlyoutControl"+za.solutionId,Command:M===CommonUIStrings.l_PopularAddins?this.BMg:this.DMg,LabelText:za.displayName,Role:"menuitem",FullIconStyle:ec,Alt:za.description})}Tnj(M,za,Ab){const ec=Object.assign(new Zf,{SectionId:M,GalleryButtons:[]});for(let Ic=0;Ic<Ab;Ic++)Array.add(ec.GalleryButtons,this.q_h(M,za[Ic],this.QSc[za[Ic].solutionId]));return ec}ufi(){var M=[];const za=
this.emb.nN(0);Array.addRange(M,za.av);const Ab=this.emb.nN(1);Array.addRange(M,Ab.av);let ec=M.length;Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinFlyoutTelemetryEnabled",!0)&&t.ULS.sendTraceTag(509687428,220,15,"The MRU list number is {0}, myAddins: {1}|{2}, adminManaged: {3}|{4}",ec,Gf.a[za.errorCode],za.av.length,Gf.a[Ab.errorCode],Ab.av.length);M.sort((Me,zf)=>{Me=sf.d(Me.displayName);zf=sf.d(zf.displayName);return Xf.a.localeCompare(Me,zf)});const Ic=
3<ec;Ic&&(ec=2);for(var ed=0;ed<ec;ed++)this.GHe(M[ed]);let Ed=[];ed=null;!this.j3&&this.Nja?Ed=this.Nja:(ed=this.emb.nN(2),0!==ed.errorCode&&5!==ed.errorCode||ed.av.forEach(Me=>{-1!==Me.addinInfo.priority&&(this.GHe(Me),Ed.push(Me))}));let Pd=!0;Ed.length||(Pd=!1);Pd&&(Ed=this.j3?this.Kji(Ed,M):this.a5g(Ed,M),this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyEnabled",!1)&&(this.sie=new Yg("AddinFlyoutFeedbackSurvey",this.Qa.getIntFeatureGate("Microsoft.Office.SharedOnline.FlyoutSurveyTriggerTime",
this.FJg)),this.sie.QDd()));ed=Object.assign(new Lf.a,{Id:"FooterSection",ControlsId:"FooterSection.Controls",ControlList:[]});const Ae=Object.assign(new We.a,{ExternalId:"InsertMoreAddInsFromFooter",AriaDescription:CommonUIStrings.l_AddinsPickerFooterButtonMoreArialText});Array.add(ed.ControlList,Ae);appChrome.api.dispatch(appChrome.actions.setControlLabel("InsertMoreAddInsFromFooter",CommonUIStrings.l_AddinPickerButtonMore));ed=Object.assign(new pf.a,{Id:"Ribbon.AddinPicker",MenuSectionList:[],
MenuFooterSection:ed,UpdateDynamically:!0,IsFlexLayout:!0});2!==za.errorCode||M.length?3===za.errorCode&&3===Ab.errorCode?(t.ULS.sendTraceTag(509687426,220,10,"dataProvider invoke error hit"),M=this.Gmd("Common",CommonUIStrings.l_AddinPickerGeneralError),Array.add(ed.MenuSectionList,M)):this.sBh&&4===za.errorCode&&!M.length?(t.ULS.sendTraceTag(508598107,220,10,"dataProvider disconnecteddisabled error hit"),M=this.Gmd("StoreDisabled",CommonUIStrings.l_AddinPickerServiceDisconnectedError),Array.add(ed.MenuSectionList,
M)):(0<ec&&this.Roh(ed,M,ec,Ic),Pd&&(this.Vge=30<Ed.length?30:Ed.length,Array.add(ed.MenuSectionList,this.m0h(Ed,this.Vge)))):(t.ULS.sendTraceTag(509687427,220,10,"store disabled hit"),M=this.Gmd("StoreDisabled",CommonUIStrings.l_AddinPickerDisableError),Array.add(ed.MenuSectionList,M));this.Mgh();0===ed.MenuSectionList.length&&(ed.IsFlexLayout=!1,t.ULS.sendTraceTag(508340124,220,15,"The menu section list length is 0"));return ed}Mgh(){window.setTimeout(()=>{var M=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");
M&&M.firstChild&&M.firstChild.firstChild&&M.firstChild.firstChild.firstChild&&(M=M.firstChild.firstChild.firstChild.scrollTop,0<M&&(M={["scrollTopValue"]:M.toString()},$f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.ScrollableListView",dataFields:Aa.a.Kl(M)}))))},6E4)}m0h(M,za){const Ab=Object.assign(new Lf.a,{Id:"PopularAddinListSection",ControlsId:"PopularAddinListSection.Controls",ControlList:[],Title:CommonUIStrings.l_PopularAddins});for(let ec=0;ec<0+za&&ec<M.length;ec++)this.LMg.PopularAddInsListItem0=
M[ec].solutionId,this.PZh(Ab.ControlList,ec.toString(),M[ec]);return Ab}PZh(M,za,Ab){za=this.lsh(za,Ab);Array.add(M,za)}lsh(M,za){const Ab=[];var ec=Object.assign(new Rf,{text:CommonUIStrings.l_AddinOneLink,href:"https://appsource.microsoft.com/en-us/product/office/"+za.solutionId});Array.add(Ab,ec);ec={};ec["default"]="AddinFlyoutControl"+za.solutionId;const Ic=this.DBb(za);return Object.assign(new Cg.a,{Id:"PopularAddInsListItem"+M,ExternalId:"PopularAddInsListItem"+M,CommandId:"PopularAddInsListItem"+
M,CommandIdMapped:"1497204054",iconSet:ec,SecondaryLabel:null,Details:null,Label:za.displayName,ActionText:CommonUIStrings.l_AddinListAdd,Description:za.description,Links:Ab,ActionId:"PopularAddInsListItemAdd"+M,ActionIdMapped:"2882601901",ActionCommandValueId:Ic,CommandValueId:Ic})}DBb(M){return this.j3?String.format("{0}#{1}",M.solutionId,M.storeId):M.solutionId}P8a(M){if(!M)return null;var za=M.split("#");if(1!==za.length&&2!==za.length)return t.ULS.sendTraceTag(508912466,220,10,"GetAddinDetailByUniqueId: uniqueId's format is wrong"),
null;M=za[0].trim();za=2===za.length?za[1].trim():Ze.AFrameworkApplication.uiCulture;return this.emb.eza(M,za)}GHe(M){if(!(M.solutionId in this.QSc)){const za="AddinGalleryButton"+this.yie.toString();this.QSc[M.solutionId]=za;M=this.DBb(M);this.L_b[za]=M;this.L_b[za+"Add"]=M;this.yie++}}hsd(M){return M?this.L_b[M]:null}Gmd(M,za){const Ab=Object.assign(new Lf.a,{Id:"ErrorSection",ControlsId:"ErrorSection.Controls",ControlList:[]});M=Object.assign(new de.a,{Id:"ErrorView",ExternalId:"ReloadAddInPicker",
IconName:M,Label:za,RetryButtonTitle:"",OnRetryCommandId:"ReloadAddInPicker",AriaDescription:"StoreDisabled"===M?za:CommonUIStrings.l_AddinPickerTryAgainAriaLabel});Array.add(Ab.ControlList,M);return Ab}a5g(M,za){var Ab=new r.a;for(let ec=0;ec<M.length;ec++)Ab.add(M[ec]);this.Nja||(30<Ab.count&&(Ab=this.Fmj(Ab)),this.Nja=Ab.toArray());for(M=0;M<this.Nja.length;M++)for(Ab=0;Ab<za.length;Ab++)if(this.Nja[M].solutionId.toLowerCase()===za[Ab].solutionId.toLowerCase()){Array.remove(this.Nja,this.Nja[M--]);
break}return this.Nja}cei(M){var za=30,Ab=(new Date).getDate();za>M.length&&(za=M.length);var ec=new ld(Ab);for(Ab=new Set;Ab.size<za;){const Ic=ec.next(M.length);Ab.add(Ic)}for(za=0;za<M.length;za++)ec=M[za].addinInfo,Ab.has(za)?ec.AUP*=20:ec.AUP=1===ec.priority?4*ec.AUP:2===ec.priority?2*ec.AUP:1*ec.AUP;M.sort((Ic,ed)=>Ic.addinInfo.AUP<ed.addinInfo.AUP?1:-1);return M}Kji(M,za){M=M.filter(Ab=>!za.some(ec=>ec.solutionId.toLowerCase()===Ab.solutionId.toLowerCase()));return this.cei(M).slice(0,30)}fzj(M){if(0===
M.errorCode||2===M.dC&&5===M.errorCode)M.av?this.ezj(M.av):t.ULS.sendTraceTag(509687429,220,10,`fail to register icons for addin collection: ${sc.a[M.dC]}`)}ezj(M){var za,Ab,ec,Ic;for(let ed=0;ed<M.length;ed++)M[ed]&&M[ed].solutionId&&M[ed].iconUrl?appChrome.addInApi.registerAddinIcon("AddinFlyoutControl"+M[ed].solutionId,M[ed].iconUrl):t.ULS.sendTraceTag(508352214,220,10,"failed to register icon for addin: solutionId: {1}, iconUrl: {2}",null!==(Ab=null===(za=M[ed])||void 0===za?void 0:za.solutionId)&&
void 0!==Ab?Ab:"null",null!==(Ic=null===(ec=M[ed])||void 0===ec?void 0:ec.iconUrl)&&void 0!==Ic?Ic:"null")}Roh(M,za,Ab,ec){var Ic=CommonUIStrings.l_MyAddinSection;ec=void 0===ec?!1:ec;const ed=Object.assign(new Lf.a,{Id:"MRUAddinsSection",ControlsId:"MRUAddinsSection.Controls",ControlList:[],Title:Ic}),Ed=Object.assign(new ug.a,{Id:"MRUAddinsGalleryControl",ExternalId:"MRUAddinsGalleryControl",GalleryStyle:this.F9h(),Width:3,Type:4,GallerySections:[]});Array.add(M.MenuSectionList,ed);Array.add(ed.ControlList,
Ed);M=this.Tnj(Ic,za,Ab);ec&&Array.add(M.GalleryButtons,this.x0h());Ed.GallerySections.push(M)}Xnj(M){if(M)try{M.MenuItems=this.ufi()}catch(za){t.ULS.sendTraceTag(509687425,220,10,"GetReactGalleryMenu hit exception "+(za?za.toString():""))}else t.ULS.sendTraceTag(509687424,220,10,"PopulateMenu menuProps is null")}dispose(){}}Object(k.a)(Ng,"AppsFlyoutGenerator",null,[5]);var Zg=a(94);class Zh{constructor(M,za,Ab,ec,Ic,ed,Ed){Ed=void 0===Ed?null:Ed;this.disposed=!1;this.b7b=null;this.Ctb=0;this.insertTab=
"Insert";this.homeTab="Home";this.wsf=this.e2d=!1;this.rXh=1E3;this.wXh="AddinFlyoutFeedbackSurvey";this.xXh=15E3;this.O1d=!0;this.mch=`[{"title":"${CommonUIStrings.l_AddInCategoryTitleAddingPicturesIconsAndCharts}","solutionIds":["wa102957665","wa104381973","wa104051163","wa104104476","wa104379279","wa200000113","wa104380662","wa200004688","wa104379169","wa103147117","wa200004179","wa104380194","wa200003220","wa200004687"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleImprovingProductivityWithAI}","solutionIds":["wa200005271","wa200004935","wa200001584","wa200005281","wa200005333"]},{"title":"${CommonUIStrings.l_AddInCategoryTitleDataSyncAndAnalysis}","solutionIds":["wa104100404","wa104379220","wa104380662","wa104380050","wa104381859","wa200002503","wa104381717","wa200003692","wa200000018","wa200000169","wa200001306","wa104381841","wa104379190","wa104381695","wa104380711","wa104380978","wa200003784"]}]`;
this.ani=(Pd,Ae,Me)=>{if(Pd){if(Pd=this.P8a(Pd))Pd={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Pd.solutionId,Pd.storeType,Pd.assetId,Pd.storeId)},Pd.href=Ae,Pd.UILocation=Me,$f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.AddInListLinkClickedFromFlyout",dataFields:Aa.a.Kl(Pd)}))}else t.ULS.sendTraceTag(509089754,220,10,"Unique id is null.")};this.Boi=(Pd,Ae)=>{if(this.P6.j3){Pd=this.P8a(Pd);if(!Pd){t.ULS.sendTraceTag(508872144,220,10,"Fail to get a valid AddinDetail with provided unique id.");
return}Pd=Pd.zVb()}else Pd=this.vcf(Pd);if(Pd){var Me={[zb.a.Wka]:Pd,[ei.a.di]:this.jg.xxa(Pd)},zf=new ki.a(-741808261,0,this.$.Ie,Ae,"");this.$.Ga.Sd(zf,Me);this.jg.MMb("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,Pd);Ae={["solutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(Pd.solutionId,Pd.storeType,Pd.assetId,Pd.storeId),["UILocation"]:Ae};$f.a.sendTelemetryEvent(Object.assign(new hh.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyoutListView",dataFields:Aa.a.Kl(Ae)}))}else t.ULS.sendTraceTag(509362325,
220,10,"Get add-in entitlement fails.")};this.itd=(Pd,Ae)=>{if(Pd)if(Pd=this.P8a(Pd)){var Me=this.jg.Qh;Me=Me?Me.getAppUILocale()||"en-US":"en-US";this.b7b=new Ld(Pd.solutionId,"wac_excel",Me,zf=>{this.jg.MMb("installAddinFromFlyout",OSF.AgaveHostAction.ClickTrust,zf);const Df=new ki.a(-741808261,0,this.$.Ie,Ae,null);this.$.Ga.Sd(Df,{[zb.a.Wka]:zf,[ei.a.di]:this.jg.xxa(zf)});this.b7b&&this.b7b.hide();f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PopularAddinInstalledTelemetryEnabled",
!0)&&(zf=Telemetry.PrivacyRules.GetPrivacyCompliantId(zf.solutionId,zf.storeType,zf.assetId,null,null,zf.storeId),$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.InstallPopularAddinFromFlyout",dataFields:Aa.a.Kl({SolutionId:zf,HDg:Ae})})))});this.b7b.initializeAndShow("",null,null)}else t.ULS.sendTraceTag(508872143,220,10,"Can not find a valid addinDetail with provided unique id.");else t.ULS.sendTraceTag(509362328,220,10,"Unique id is null.")};this.Foi=(Pd,Ae)=>{if(Pd){if(this.P6.j3){Pd=
this.P6.P8a(Pd);if(!Pd){t.ULS.sendTraceTag(508872141,220,10,"Can not find a valid addinDetail with provided unique id");return}Pd=Pd.zVb()}else if(Pd=this.vcf(Pd),!Pd){t.ULS.sendTraceTag(509089755,220,10,"Get add-in entitlement fails.");return}var Me={[zb.a.Wka]:Pd,[ei.a.di]:this.jg.xxa(Pd)},zf=new ki.a(-741808261,0,this.$.Ie,Ae,"");this.$.Ga.Sd(zf,Me);f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MRUAddinInstalledTelemetryEnabled",!0)&&(Pd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Pd.solutionId,
Pd.storeType,Pd.assetId,null,null,Pd.storeId),$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.InstallMRUAddinFromFlyout",dataFields:Aa.a.Kl({SolutionId:Pd,HDg:Ae})})))}else t.ULS.sendTraceTag(509362326,220,10,"UniqueId is null.")};this.P8a=Pd=>this.P6.j3?this.P6.P8a(Pd):this.L6.eza(Pd);this.e5i=(Pd,Ae)=>{if(Ae)if(Ae)if(Pd=Ae.en){if(zd()||rc()){const zf=this.$.ea.workbookContext.WebExtensions;if(zf){let Df=!1;for(var Me of zf)if(Me.PrimaryMarketplace.SolutionId.toLowerCase()===
Pd.solutionId.toLowerCase()){Df=!0;break}if(!Df){t.ULS.sendTraceTag(512258444,220,15,"Not find add-in persisted in the template file.");return}}else{t.ULS.sendTraceTag(512258443,220,15,"Has no add-in persisted in the file.");return}}Ae=Ae.Tq;Me=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(Pd.solutionId in Me)Ae=Me[Pd.solutionId];else if(Ae=this.x5h(Ae),void 0===Ae||null===Ae){t.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Me=
new ki.a(ng.a.E6,0,0,2,null);this.executeCommand(0,Me,{["SourceControlId"]:Ae},null);Pd.isAutoLaunched=!0}else t.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else t.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else t.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.ugj=(Pd,Ae)=>{null==Ae?$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Aa.a.Kl({["AppTeachingUICalloutAction"]:"InvalidEventArgs",
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"})})):f.EwaSettings.isChangeGateEnabled("OfficeVSO:8180233_AddNullCheck")&&isNullOrUndefined(this.$)||(this.ikb=new Vh(this),this.ikb.Zzj(Ae),Pd=this.$.Ga,f.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.yBe?this.yEc?(Ae=appChrome.selectors.getSelectedTabId())&&sf.a(Ae,this.homeTab)?this.ikb.Lkg():null!==Pd&&(Pd.P4c(this.MMd),t.ULS.sendTraceTag(508564945,
220,50,"Register home tab switched event")):t.ULS.sendTraceTag(508564944,802,50,"selector is not ready"):null!==Pd&&(Pd.P4c(this.MMd),t.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))};this.MMd=(Pd,Ae)=>{Pd=this.insertTab;f.EwaSettings.isChangeGateEnabled("OfficeVSO:8058447_FixCDTeachingCalloutAnchorAfterFlyoutEnabled")&&this.yBe&&(Pd=this.homeTab);Ae.tabName===Pd&&(Ae=this.$.Ga,null!=Ae&&(Ae.J6f(this.MMd),t.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),
this.ikb.Lkg())};this.hcj=(Pd,Ae)=>{Pd=null;Ae&&(Pd=Ae);(null===Pd||void 0===Pd?0:Pd.Tq)&&this.OVj(Pd.Tq);this.$.xj();Pd&&Pd.en&&this.C7g(Pd.en)};this.zjk=(Pd,Ae)=>{Ae.dC===sc.a.o0i&&(this.Ctb|=1);Ae.dC===sc.a.v2g&&(this.Ctb|=2);this.Whg()&&appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("InsertAddInFlyout",!1))};this.$=M;t.ULS.shipAssertTag(537170659,0,!(void 0===za||null===za),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Fb.a.y1()}`);
this.jg=za;this.YOe=Ab;this.Y6b=ec;this.Kca=Ic;this.Etb=ed;this.Lr=new Gi.a;this.Vka=new od;this.hkd=Ed;Pc.a.FEb=Pc.a.J3e;this.lfd=new r.a;this.Q6a=new r.a;this.Z4c&&(this.e2d=Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",!1),this.L6=this.jg.L6,null!==this.L6?(M=this.lvc?new wf(Ze.AFrameworkApplication.da,this.L6,this.mch):null,this.P6=new Ng(Ze.AFrameworkApplication.Vd,this.L6,ng.a.Hsc.toString(),ng.a.nJb.toString(),"1296389134",
Ze.AFrameworkApplication.da,M),this.L6.dra(this.zjk)):t.ULS.sendTraceTag(509362330,220,10,"addinDetailsProvider is null"))}get yBe(){return Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)}get Z4c(){return Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)}get lvc(){return Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewBackstageEnabled",
!1)}dispose(){void 0!==this.Etb&&null!==this.Etb&&(this.Etb.dispose(),this.Etb=null);this.jg=this.$=null;this.disposed=!0}e_j(M,za){switch(M){case ng.a.E6:M=this.QZj(za);break;default:M=!1}return M}hf(M,za){return"Dev Box"===Ze.AFrameworkApplication.da.Ra("StatusBarEnvironmentNameToUse")?!1:619219938===za?!this.Whg():!1}executeCommand(M,za,Ab){M=$g.TaskExtensions.Wl();var ec=za.command;za=Ic=>{let ed=null;if(!Ic)return ed;(ed=Ic.CommandValueId)||(ed=this.P6.hsd(Ic.SourceControlId));ed||t.ULS.sendTraceTag(508560270,
220,10,"UniqueId is null.");return ed};switch(ec){case 843847158:break;case ng.a.Hsc:this.YPb();ec=Ab.UILocation;this.lvc?(Ab=za(Ab),this.itd(Ab,ec)):(Ab=Ab.SourceControlId)?this.itd(this.P6.hsd(Ab),ec):t.ULS.sendTraceTag(509362329,220,10,"Control id is null.");break;case ng.a.PDd:this.YPb();za=this.lvc?za(Ab):Ab.CommandValueId;ec=Ab.UILocation;"LinkClickedPayload"===Ab.Type?this.ani(za,Ab.Href,ec):this.itd(za,ec);break;case ng.a.Hwd:this.YPb();this.Boi(Ab.CommandValueId,Ab.UILocation);break;case ng.a.nJb:this.YPb();
ec=Ab.UILocation;if(this.lvc)Ab=za(Ab);else{Ab=Ab.SourceControlId;if(!Ab){t.ULS.sendTraceTag(508440995,220,10,"ControlId is null.");break}Ab=this.P6.j3?this.P6.hsd(Ab):this.P6.inh[Ab]}this.Foi(Ab,ec);break;case -2025863019:$h.a.c2d(Ab[zb.a.Y4c].toString(),()=>{bc.h(this.$).focus()});break;case -1777565636:lf.a.showUILessDialog(Ab[zb.a.Ftb].toString());this.jg.y2j(Ab[zb.a.Ftb].toString());break;case 1592314317:lf.a.hideUILessDialog(Ab[zb.a.Ftb].toString());this.jg.wsi(Ab[zb.a.Ftb].toString());break;
case ng.a.E6:M=this.Tsd(Ab);break;case ng.a.jJb:this.kJb(Ab);break;case ng.a.Sz:this.ssj(Ab);break;case ng.a.wra:this.wra(Ab);break;case ng.a.KGc:this.Etb.$Gc();break;case ng.a.refreshAddinCommands:this.Ixj();break;case 1949669462:this.Kca.Feg(!0);break;case -1014260128:M=this.executeDynamicAddInCommandsAPI(Ab);break;default:M=Ha.a(ec)}return M}Ue(M,za,Ab){M=!1;switch(za.command){case ng.a.PDd:case ng.a.Hwd:case ng.a.Hsc:case ng.a.nJb:M=!!Ab;break;case 843847158:case -2025863019:case -1777565636:case 1592314317:case ng.a.Sz:case ng.a.wra:case ng.a.KGc:case ng.a.refreshAddinCommands:case 1949669462:case ng.a.jJb:case -1014260128:M=
!0;break;case ng.a.E6:M=!Ze.AFrameworkApplication.protectedFile}return M}Whg(){return!f.EwaSettings.isChangeGateEnabled("OfficeVSO:8162137_NullCheckForFlyoutControlEnabled")||void 0!==this.$&&null!==this.$?0!==this.Ctb&&this.$.$0&&!f.EwaSettings.Fa(174):(t.ULS.sendTraceTag(508380621,220,15,"ewaControl is null"),!1)}mf(M,za,Ab){switch(za){case "PopulateAddInGallery":return f.EwaSettings.isChangeGateEnabled("OfficeVSO:7653071_PopulateAddInGalleryTelemetryEnabled")&&$f.a.sendTelemetryEvent(Object(Ef.a)(new hh.a,
{name:"Office.Extensibility.Host.PopulateAddinGallery",dataFields:Aa.a.Kl({})})),this.P6.Xnj(Ab),this.e2d&&(this.YPb(),this.QDd()),!0;default:return!1}}QDd(){kd.a.instance.getItem("AddinFlyoutOnExcelSurveyShowed")&&(this.O1d=!1);this.O1d&&(window.setTimeout(()=>{const M=this.qjc();M&&"hidden"!==M.visibility&&(this.wsf=!0)},this.rXh),this.O4f=window.setTimeout(()=>{this.wog=Pf.a.instance.ie("Common.ISystemInitiatedFeedback");kd.a.instance.setItem("removeFlyoutTaskTimeoutId",this.O4f.toString());this.wsf&&
this.wog&&this.wog.execute(M=>{const za=this.qjc();za&&"hidden"===za.visibility&&(M.CXa(this.wXh,null),this.O1d=!1,kd.a.instance.setItem("AddinFlyoutOnExcelSurveyShowed","1"))})},this.xXh))}qjc(){let M=null;try{const za=document.getElementById("Ribbon-InsertAddInFlyoutDropdown");za&&(M=ja.a.gB(za.parentNode.parentNode.parentNode))}catch(za){t.ULS.sendTraceTag(508911886,220,10,"AddinFlyout get parent and parent get exception "+(za?za.toString():""))}return M}YPb(){this.e2d&&(window.clearTimeout(this.O4f),
kd.a.instance.removeItem("removeFlyoutTaskTimeoutId"))}x5h(M){if(!M)return t.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((M=M.uZ)&&M.lw&&0<M.lw.count)for(let za of M.lw){if(za.groups&&1===za.groups.length){M=za.groups[0];if(M.controls&&1===M.controls.length){const Ab=M.controls[0];if(Ab.attributes&&!Ab.controlType&&Ab.enabled)return Ab.id}M.controls&&t.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}za.groups&&t.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}get dG(){return Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}ssj(M){if(M&&zb.a.X0 in M)if(this.jg){var za=M[zb.a.X0];this.dG?zb.a.c7b in M&&(M=M[zb.a.c7b],this.jg.jVa(za,M),1===M&&this.Sz(za,!0)):this.Sz(za,!0)}else t.ULS.sendTraceTag(509686150,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..");else t.ULS.sendTraceTag(509686151,220,10,"queryAddinDetailsWithActionData: invalid actionData.")}Sz(M,za){za=void 0===za?!1:za;this.jg?
(t.ULS.sendTraceTag(509686149,220,50,"QueryAddinDetails: providerType: {0}, refreshRequired: {1}",M,za),this.jg.Sz(M,za)):t.ULS.sendTraceTag(508564227,220,10,"QueryAddinDetails: abort because ddaFacadeService is null..")}Ixj(){if(this.Kca.ftc()){this.Kca.CLe();var M=this.rnd();if(M&&0<M.count)for(const za of M)M={[zb.a.X0]:za,[zb.a.aX]:4,[zb.a.tKa]:(new Date).getTime()},this.wra(M)}else Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&(t.ULS.sendTraceTag(509686148,220,50,"refreshAllAddinCommands: LoadingCompleteForAllProviders() returns {0}",this.Kca.ftc()),this.Sz(10,!0),this.Sz(0,!0))}wra(M){t.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${M[zb.a.aX]}, DataProvider ${M[zb.a.X0]}.`);this.Kca.ERj();window.setTimeout(()=>{if(void 0===this.jg||null===this.jg)t.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Fb.a.y1()}`);
else{const za=new He(new jf(this.jg.Qh),yf.instance,Xg.instance);za.GYg((Ab,ec)=>{Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.Sz(M[zb.a.X0]);this.kJb(ec.properties)});za.k1g(this.ugj);za.ehk(M)}},0)}kJb(M){if(!this.disposed){t.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${M[zb.a.aX]}.`);try{if(f.EwaSettings.Fa(174)){const ec=M[zb.a.Dtb];if(ec&&0<ec.count){const Ic=ec.count;for(let ed=Ic-1;0<=ed;ed--){const Ed=
ec.ka(ed);OSF.OsfControl.isFirstPartyStoreString(Ed.storeType)||ec.remove(ec.ka(ed))}if(ec.count<Ic){const ed=Object(Zg.d)(Se.a.resolve(Fe.p,{Oa:0}));$g.TaskExtensions.Aa(ed,()=>{ed.result.ej(36,null)},this.$.ma,3)}if(!ec.count)return}}if(void 0===this.jg||null===this.jg)t.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Fb.a.y1()}`);else{var za=null;za=Ze.AFrameworkApplication.da.na("HostInstallAddInsIsEnabled")?new pe(this.Lr,this.YOe,
new jf(this.jg.Qh),new ej(this.$.He,ng.a.E6),this.Kca,yf.instance,this.Vka,(ec,Ic)=>{const ed={};ed.InstanceId=ia.a.create().toString();ed.PrimaryMarketplace={};ed.PrimaryMarketplace.SolutionId=ec.solutionId;ed.PrimaryMarketplace.SolutionVersion=ec.version;ed.PrimaryMarketplace.MarketplaceType=ec.storeType;ed.PrimaryMarketplace.MarketplaceRef=ec.storeId;ed.WebExtensionType=1;this.jg.T4j(ed,()=>{Ic(ec)})}):new pe(this.Lr,this.YOe,new jf(this.jg.Qh),new ej(this.$.He,ng.a.E6),this.Kca,yf.instance,this.Vka);
za.NYg(this.e5i);za.HYg(this.hcj);var Ab=new Vh(this);za.H_g(Ab.gcj);za.j1g(Ab.g2j);this.$.ia.Ja(53).xr&&dc.a.get_instance().jk(5,null).continueWith(()=>{this.disposed||za.rQi(this.hkd,this.$.domElement,M)})}}catch(ec){t.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${ec.message}.`)}}}Tsd(M){const za=$g.TaskExtensions.Wl();M=M[this.Lr.Yla];const Ab=this.Y6b.q2c(M),ec=new lf.a(this.$,this.jg,Ab.ownerAddinInfo,za);return this.Fif(za,M,Ab,ec)}Fif(M,za,Ab,ec){this.Y6b.Tsd(za,
this.Kca,ec,new jf(this.jg.Qh),Ab,()=>{M=ec.mmh()},()=>{bc.h(this.$).focus()});return M}C7g(M){const za=$g.TaskExtensions.Wl();var Ab=this.jg.pea(M.solutionId);if(Ab){var ec=this.jg.iY(Ab);if(da.HelperMethods.yz(ec)&&0!==ec.SharedRuntime.State)return}ec=this.Y6b.D7g;const Ic=M.solutionId in ec?ec[M.solutionId]:null;if(Ic){const ed=this.Y6b.q2c(Ic),Ed=new lf.a(this.$,this.jg,ed.ownerAddinInfo,za),Pd=Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,null!==ed.ownerAddinInfo?ed.ownerAddinInfo.storeType:
M.storeType,M.assetId,null,null,M.storeId);ec=Ae=>{if(Ae){const Me={};for(const zf of Ae)Me[zf[0]]=zf[1];(Ae=zb.a.uBe in Me?Me[zb.a.uBe]:null)&&"true"===Ae.toLowerCase()&&(t.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${M.storeType}, StoreId ${M.storeId}, SolutionId ${Pd}.`),this.Fif(za,Ic,ed,Ed))}};t.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${M.storeType}, StoreId ${M.storeId}, SolutionId ${Pd}.`);if(Ab)ec(this.jg.iY(Ab).OsfPropertyBag);
else if(Ab=this.$.ea.workbookContext.WebExtensions)for(const Ae of Ab)if((1===Ae.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===M.targetType&&Ae.PrimaryMarketplace.MarketplaceType.toLowerCase()===M.storeType.toLowerCase()&&Ae.PrimaryMarketplace.MarketplaceRef.toLowerCase()===M.storeId.toLowerCase()&&Ae.PrimaryMarketplace.SolutionId.toLowerCase()===M.solutionId.toLowerCase()){ec(Ae.OsfPropertyBag);break}}}o5d(M,za,Ab){M&&(void 0===Ab||!Ab||za||this.lfd.contains(M)||
this.lfd.add(M),(Ab=this.Q6a.contains(M))&&za&&this.Q6a.remove(M),Ab||za||this.Q6a.add(M))}OVj(M){if((M=M.uZ)&&M.lw)for(let za of M.lw)if(za.groups)for(const Ab of za.groups)if(Ab.controls)for(const ec of Ab.controls)if(this.o5d(ec.id,ec.enabled,!0),1===ec.controlType&&ec.menuItems)for(const Ic of ec.menuItems)this.o5d(Ic.id,Ic.enabled,!0)}rnd(){const M=new r.a;f.EwaSettings.Fa(52)&&(this.$.ea.Qj.get(27)&&(M.add(0),M.add(16)),this.$.ea.Qj.get(33)&&M.add(1),M.add(8));return M}executeDynamicAddInCommandsAPI(M){let za=
!0;if(void 0===M||null===M||void 0===M[zb.a.Bzb]||null===M[zb.a.Bzb])return Vc.Task.Ua(!1);switch(M[zb.a.Bzb]){case 1:za=this.skk(M);break;case 2:za=this.RVj(M);break;case 4:this.Q6a.clear();this.Q6a.addRange(this.lfd);break;case 3:za=this.installContextualTab(M);break;default:za=!1}return Vc.Task.Ua(za)}QZj(M){return M&&this.Lr.Yla in M?(M=M[this.Lr.Yla])?this.Q6a.contains(M):!1:!1}skk(M){var za=null;let Ab=null,ec=null,Ic=!0;void 0!==M[zb.a.V7]&&null!==M[zb.a.V7]&&void 0!==M[this.Lr.Yla]&&null!==
M[this.Lr.Yla]&&void 0!==M[zb.a.U7]&&null!==M[zb.a.U7]&&(za=M[zb.a.V7],Ab=M[zb.a.Gec],ec=M[this.Lr.Yla],Ic=M[zb.a.U7]);if(!za||!ec)return t.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;M=(new Ig.a(this.$.He,za,this.Lr,!0)).NOa(ec);za={DynamicAddinCommandsApiName:"UpdateControlEnableState"};za.AssetId=Ab;za.MaskedTabId=M;za.IsToEnable=Ic;t.ULS.sendTraceTag(537170648,220,50,Rc.a.ff(za));this.o5d(M,Ic);E.a.aC.Sv();return!0}RVj(M){var za,Ab,ec=
null,Ic=null;let ed=null;var Ed=null;let Pd=!0;void 0!==M[zb.a.Sgd]&&null!==M[zb.a.Sgd]&&void 0!==M[zb.a.V7]&&null!==M[zb.a.V7]&&void 0!==M[this.Lr.Yla]&&null!==M[this.Lr.Yla]&&void 0!==M[zb.a.U7]&&null!==M[zb.a.U7]&&(ec=M[zb.a.Sgd],Ic=M[zb.a.V7],ed=M[zb.a.Gec],Ed=M[this.Lr.Yla],Pd=M[zb.a.U7]);if(!ec||!Ic||!Ed)return t.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;M=(new Ig.a(this.$.He,Ic,this.Lr,!0)).Lgf(Ed);Ed={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
Ed.StoreType=ec;Ed.AssetId=ed;Ed.MaskedTabId=M;Ed.IsToShow=Pd;t.ULS.sendTraceTag(537170646,220,15,Rc.a.ff(Ed));ec=this.Kca.Uma(ec,Ic,1);Ic=!1;if(null===(Ab=null===(za=null===ec||void 0===ec?void 0:ec.Tq)||void 0===za?void 0:za.uZ)||void 0===Ab?0:Ab.lw)for(let Ae of ec.Tq.uZ.lw)if(Ae.id===M){Ic=!0;break}if(!Ic)return t.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;za=[];Pd?appChrome.selectors.getSelectedTabId()!==M&&za.push(appChrome.actions.activateRibbonTab(M)):
(appChrome.selectors.getSelectedTabId()===M&&za.push(appChrome.actions.setCurrentTab(bh.a.nR)),za.push(appChrome.actions.deactivateRibbonTab(M)));appChrome.api.dispatch(za);return!0}vcf(M){if(this.L6){if(M=this.L6.eza(M)){const za={};za.solutionId=M.solutionId;za.version=M.version;za.storeType=M.storeType;za.storeId=M.storeId;za.assetId=M.assetId;za.assetStoreId=M.assetStoreId;za.targetType=M.targetType;za.displayName=M.displayName;za.width=M.width;za.height=M.height;return za}t.ULS.sendTraceTag(509362324,
0,10,"Get addinDetail fail.");return null}t.ULS.sendTraceTag(509362323,0,10,"No addinDetailManager instance.");return null}installContextualTab(M){let za=null,Ab=null,ec=null;var Ic=null;if(void 0!==M[zb.a.V7]&&null!==M[zb.a.V7]&&void 0!==M[zb.a.U7]&&null!==M[zb.a.U7]){const ed=M[zb.a.U7];za=M[zb.a.V7];void 0!==ed[zb.a.oNa]&&null!==ed[zb.a.oNa]&&void 0!==ed[zb.a.pNa]&&null!==ed[zb.a.pNa]&&(Ab=ed[zb.a.oNa],ec=ed[zb.a.pNa],Ic=ed[zb.a.Tgd])}if(!(za&&ec&&Ab&&Ic))return t.ULS.sendTraceTag(537170644,220,
15,"InstallContextualTab failed to invalid parameters"),!1;M=this.Kca.Uma(Ic.PrimaryMarketplace.MarketplaceType,Ic.PrimaryMarketplace.SolutionId,1);if(null===M||void 0===M?0:M.Tq)return t.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;M={};M.solutionId=Ic.PrimaryMarketplace.SolutionId;M.version=Ic.PrimaryMarketplace.SolutionVersion;M.storeType=Ic.PrimaryMarketplace.MarketplaceType;M.storeId=Ic.PrimaryMarketplace.MarketplaceRef;Ic.AssetMarketplace?(M.assetId=
Ic.AssetMarketplace.SolutionId,M.assetStoreId=Ic.AssetMarketplace.MarketplaceRef):(M.assetId=null,M.assetStoreId=null);M.targetType=Ic.WebExtensionOsfControlType;M.width=Ic.TaskpaneWidth;M.height=0;M.isAddinCommands=!0;Ic=new r.a;Ic.add(M);M={};M[zb.a.Dtb]=Ic;M[zb.a.aX]=6;M[zb.a.oNa]=Ab;M[zb.a.pNa]=ec;this.kJb(M);return!0}get yEc(){return!!window.appChrome&&!!appChrome.selectors}}Object(k.a)(Zh,"AddinUICommandHandler",null,[736,169,5]);var Vg=a(69);class di{constructor(M,za,Ab,ec){this.a1d=void 0===
M?null:M;this.x2c=void 0===za?null:za;this.afd=void 0===Ab?null:Ab;this.CAb=void 0===ec?0:ec}QEa(){return this.a1d()}activate(){return this.x2c()}deactivate(){this.afd()}dispose(){this.afd=this.x2c=this.a1d=null}}Object(k.a)(di,"FeatureActivator",null,[27,5]);var Uh=a(25),Wi=a(21);class qg extends kg.a{constructor(M){super(M);this.handler=null;this.iUg=()=>{t.ULS.sendTraceTag(38410434,0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.hg&
16384)}]`);const za=new eh.a;this.$.ia.Od(53,Me=>{t.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");za.setResult(Me)});const Ab=za.task,ec=new Wf,Ic=Sg.a.getInstance(),ed=new ji(this.$,Ic),Ed=gi.GetServiceTaskFactory.create(this.$.ia,203,this.ma,this.$a),Pd=this.tyj(ec),Ae=Object(Zg.d)(Se.a.resolve(Fe.jc,{Oa:this.$a}));return $g.TaskExtensions.Aa($g.TaskExtensions.Tg([Ab,Ed,Pd,Ae],this.ma),()=>{t.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");
$g.TaskExtensions.Aa(gi.GetServiceTaskFactory.create(this.$.ia,106,this.ma,this.$a),Me=>{this.handler=new Zh(this.$,Me.result,ec,new zh,Ic,ed,Pf.a.instance.Ii("Common.IExternalUICommandDefinitionMapping"));t.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");this.vg([this.handler]);this.$.ia.Va(198,this.handler)},this.ma,3)},this.ma,3)};this.qxh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ga.ihb(this.handler),this.$.ia.K1(198),this.handler=
null):t.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.ia.K1(204);Wi.a(Uh.a,19,this.$.ia,198)}}yg(){t.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Vg.a(this.$).add(Object(Ef.a)(new di,{a1d:()=>{const M=this.$.ea.HN&&this.$.ea.Ee&&!!(this.$.hg&16384)&&this.$.isEditMode;this.$.ea.Ee&&t.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${M}] IsSessionFullyLoaded [${this.$.ea.HN}] IsSessionActive [${this.$.ea.Ee}] ShowCommandUI [${!!(this.$.hg&
16384)}] IsEditMode [${this.$.isEditMode}]`);return M},x2c:this.iUg,afd:this.qxh,CAb:2}))}tyj(M){const za=gi.GetServiceTaskFactory.create(this.$.ia,102,this.ma,this.$a);return $g.TaskExtensions.Aa(za,()=>{t.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.ia.Va(204,new Oh(za.result,M))},this.ma,3)}static la(M){kg.a.dh(199,new qg(M))}}Object(k.a)(qg,"AddinUICommandHandlerFactory",kg.a,[]);var wh=a(1175),
ii=a(1178),vj=a(740);class wi extends l.a{constructor(M){super();this.$=M;this.Oe()}create(){let M;if(f.EwaSettings.Fa(355)){const za=gi.GetServiceTaskFactory.create(this.$.ia,106,this.$.ma,this.$a);let Ab=Object(Zg.d)(Se.a.resolve(Fe.Ob,{Oa:this.$a}));$g.TaskExtensions.Aa(Vc.Task.UB(za,Ab),()=>{this.ve(Object(vj.a)(this.$.ia,278,()=>new wh.CustomFunctionsInstaller(this.$,za.result,Ab.result)))},this.$.ma,3)}else M=Object(vj.a)(this.$.ia,278,()=>new ii.CustomFunctionsLegacyInstaller(this.$)),this.ve(M)}static la(M){M.ia.Va(279,
new wi(M))}}Object(k.a)(wi,"CustomFunctionsInstallerFactory",l.a,[]);var mh=a(96),Ri=a(52),Kg=a(48);let Ui=class{constructor(M,za){this.YUa=this.ZUa=null;this.xrg=(Ab,ec)=>{let Ic=null,ed=null,Ed=null;ec?(Object(K.a)(246,ec)?(Ic=ec.Ltb,Ed=ec.instanceId):Object(K.a)(477,ec)&&(Ic=ec.get_element(),Ed=ec.instanceId),Ic)?(ed=Object(ca.a)(686,Ab),ed)?this.h2f(Ed,Ic,ed)||Ed in this.YUa||(this.ZUa[Ed]=0,this.YUa[Ed]=Ri.a.instance.SF(()=>{10<=this.ZUa[Ed]||this.h2f(Ed,Ic,ed)?(delete this.ZUa[Ed],this.YUa[Ed].dispose(),
delete this.YUa[Ed]):this.ZUa[Ed]+=1},500,Kg.a.E2g,!0,!1)):t.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):t.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):t.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=M;this.$=za;this.R6c=!1;f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AgaveOnSelectedReadoutHandler",!1)||this.$.ia.Va(224,
this)}la(M){this.R6c?t.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.R6c=!0,this.YUa={},this.ZUa={},M?M.uZg(this.xrg):t.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(M){if(M){M.SCj(this.xrg);M=this.YUa;for(let za in M)mh.a.Ma(M[za]);this.ZUa=this.YUa=null;this.R6c=!1}else t.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}h2f(M,
za,Ab){if(this.YBi(Ab,M))return!1;M=za.querySelector("iframe");if(!M)return t.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;M=M.title;if(!M||!M.length)return t.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(M);return!0}YBi(M,za){return(M=M.Qh.getOsfControl(za))?M.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}};Ui=Object(x.a)([Object(Se.d)(Fe.e),
Object(x.b)(0,Object(Fe.g)()),Object(x.b)(1,Object(Fe.fb)())],Ui);Object(k.a)(Ui,"AgaveOnSelectedReadoutHandler",null,[687]);class pi extends l.a{constructor(M){super();this.$=M;this.Oe()}create(){const M=this.$.ia;$g.TaskExtensions.Aa(f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(Zg.d)(Se.a.resolve(Fe.g,{Oa:this.$a})):gi.GetServiceTaskFactory.je(M,211,212,this.$a),za=>{za=M.Ja(224)||new Ui(za.result,this.$);this.ve(za)},this.ma,3)}static la(M){M.ia.Va(225,
new pi(M))}}Object(k.a)(pi,"AgaveOnSelectedReadoutHandlerFactory",l.a,[]);var ci=a(777),jg=a(54);const Fh=(M,za)=>jg.a.CEd(64,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,Ze.AFrameworkApplication.da.eg("MaxRetriesForLoadingScript",0),M,za);var xi=a(220);class Sh{constructor(M,za,Ab){this.Qjf=ec=>{try{if(ec&&ec.rawEvent&&ec.rawEvent.origin&&this.iframe&&this.iframe.id){var Ic=this.zWf(ec.rawEvent.origin);const ed=this.zWf(document.domain);if(P.a.Ei().equals(ed,Ic))if(ec.rawEvent.source&&
ec.rawEvent.source.frameElement&&ec.rawEvent.source.frameElement.id&&P.a.Ei().equals(ec.rawEvent.source.frameElement.id,this.iframe.id)){Ic=null;try{Ic=JSON.parse(ec.rawEvent.data)}catch(Ed){t.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",Ed.message)}Ic?(Ic.statusCode!==xi.a.sJ||void 0!==Ic.error&&Ic.error?(t.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",
Ic.statusCode,Ic.error),this.onError()):(t.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.sZ(Ic.authorizationCode?Ic.authorizationCode:Ic.signInUrl)),$removeHandler(window,"message",this.Qjf),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):t.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):t.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):t.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else t.ULS.sendTraceTag(51451614,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else t.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else t.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(ed){t.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",ed.message)}};this.iframe=M;
this.sZ=za;this.onError=Ab;$addHandler(window,"message",this.Qjf)}zWf(M){let za="";try{M&&(za=-1<M.indexOf("//")?M.split("/")[2]:M.split("/")[0])&&(za=za.split(":")[0],za=za.split("?")[0])}catch(Ab){t.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Ab.message)}return za}static la(M,za,Ab){new Sh(M,za,Ab)}}Object(k.a)(Sh,"ResponseHandler",null,[]);var Ai=a(266);class qi{constructor(M){this.RJa=M}tryAuthenticate(M,za){this.Lfb(qi.MKg,()=>{M()},za)}tryAuthorize(M,za){this.Lfb(qi.TFg,
M,za)}getSignInUrl(M,za){this.Lfb(qi.Xte,M,za)}signOut(M,za){this.Lfb(qi.WQg,M,za)}Lfb(M,za,Ab){var ec=new Ai.QueryStringBuilder("AuthenticationProxyHandler.aspx");ec.ul("responseType",M);Ze.AFrameworkApplication.I2a(ec);ec=String.format("{0}{1}&{2}",this.RJa,ec.toString(),Ze.AFrameworkApplication.fl);const Ic=document.createElement("iframe");Ic.setAttribute("id","privateCatalogIframe");Ic.setAttribute("name","privateCatalogIframe");Ic.setAttribute("style","display: none");P.a.Ei().equals(M,qi.Xte)||
Ic.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Sh.la(Ic,za,Ab);Ic.setAttribute("src",ec);document.body.appendChild(Ic)}}qi.TFg="authcode";qi.MKg="identitytoken";qi.Xte="signinurl";qi.WQg="signout";Object(k.a)(qi,"AuthenticationProxy",null,[]);class yh{}yh.getUserId="getUserId";yh.getLastStoreUpdate="laststoreupdate";yh.getEntitlement="getEntitlements";yh.getEToken="getEToken";yh.getManifest="getManifest";yh.getAppState="getAppState";yh.getKilledApps=
"getRemovedAddins";yh.getAppDetails="getAppDetails";yh.removeApps="removeAddin";yh.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";yh.getPrivateCatalogAddIns="getAddIns";yh.getPrivateCatalogManifests="getAppManifests";yh.isStoreDisabled="isStoreDisabled";Object(k.a)(yh,"S2SWebRequestActions",null,[]);var li=a(588);class Ph{getUserId(M,za){const Ab=new r.a;Ab.add(new xf.a("corr",M));this.d_(yh.getUserId,Ab,1,za)}getLastStoreUpdate(M,za,Ab){const ec=new r.a;ec.add(new xf.a("lc",M));ec.add(new xf.a("corr",
za));this.d_(yh.getLastStoreUpdate,ec,1,Ab)}getEntitlement(M,za,Ab,ec){M=new r.a;M.add(new xf.a("av",za));M.add(new xf.a("corr",Ab));this.d_(yh.getEntitlement,M,1,ec)}getEToken(M,za,Ab,ec,Ic,ed){const Ed=new r.a;Ed.add(new xf.a("cmu",M));Ed.add(new xf.a("cmf",za));Ed.add(new xf.a("assetid",Ab));Ed.add(new xf.a("expver",ec));Ed.add(new xf.a("corr",Ic));this.d_(yh.getEToken,Ed,1,ed)}getManifest(M,za,Ab,ec){const Ic=new r.a;Ic.add(new xf.a("cmu",M));Ic.add(new xf.a("assetid",za));Ic.add(new xf.a("corr",
Ab));this.d_(yh.getManifest,Ic,1,ec)}getAppState(M,za,Ab){const ec=new r.a;ec.add(new xf.a("ma",M));ec.add(new xf.a("corr",za));this.d_(yh.getAppState,ec,1,Ab)}getKilledApps(M,za){const Ab=new r.a;Ab.add(new xf.a("corr",M));this.d_(yh.getKilledApps,Ab,1,za)}getAppDetails(M,za,Ab,ec){const Ic=new r.a;Ic.add(new xf.a("cmo",M));Ic.add(new xf.a("corr",Ab));this.sendWithBody(yh.getAppDetails,Ic,za,2,ec,!1)}removeApps(M,za,Ab){const ec=new r.a;ec.add(new xf.a("corr",za));this.sendWithBody(yh.removeApps,
ec,M,2,Ab,!1)}getLastPrivateCatalogUpdate(M,za,Ab,ec,Ic,ed){const Ed=new r.a;Ed.add(new xf.a("catalog","privatecatalog"));Ed.add(new xf.a("clientCode",M));Ed.add(new xf.a("clientVersion",za));Ed.add(new xf.a("corr",Ic));M=String.format("authorizationCode={0}&refreshToken={1}",Ab?Xf.a.Dh(Ab):"",ec?Xf.a.Dh(ec):"");this.sendWithBody(yh.getLastPrivateCatalogUpdate,Ed,M,2,ed,!0)}getPrivateCatalogAddIns(M,za,Ab,ec,Ic,ed){const Ed=new r.a;Ed.add(new xf.a("catalog","privatecatalog"));Ed.add(new xf.a("clientCode",
M));Ed.add(new xf.a("clientVersion",za));Ed.add(new xf.a("corr",Ic));M=String.format("authorizationCode={0}&refreshToken={1}",Ab?Xf.a.Dh(Ab):"",ec?Xf.a.Dh(ec):"");this.sendWithBody(yh.getPrivateCatalogAddIns,Ed,M,2,ed,!0)}getPrivateCatalogManifests(M,za,Ab,ec,Ic){const ed=new r.a;ed.add(new xf.a("catalog","privatecatalog"));ed.add(new xf.a("corr",ec));M=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Xf.a.Dh(M),za?Xf.a.Dh(za):"",Ab?Xf.a.Dh(Ab):"");this.sendWithBody(yh.getPrivateCatalogManifests,
ed,M,2,Ic,!0)}isStoreDisabled(M,za){const Ab=new r.a;Ab.add(new xf.a("corr",M));this.d_(yh.isStoreDisabled,Ab,2,za)}d_(M,za,Ab,ec){this.sendWithBody(M,za,null,Ab,ec,!1)}sendWithBody(M,za,Ab,ec,Ic,ed){const Ed=new Ai.QueryStringBuilder("AddinServiceHandler.ashx");Ed.ul("action",M);Ed.ul("app",li.a[Ze.AFrameworkApplication.sa.Sa.Hj]);for(const Pd of za)Ed.ul(Pd.key,Pd.value);za=String.format("{0}{1}&{2}",Ze.AFrameworkApplication.sa.Sa.nZ,Ed.toString(),Ze.AFrameworkApplication.fl);Ze.AFrameworkApplication.Wf.zp(za,
ec,Ab,null,!1,2,Pd=>{let Ae=null,Me=null;Pd&&Pd.data&&(Pd.data.responseHeaders["X-BlockedForMinor"]&&"1"===Pd.data.responseHeaders["X-BlockedForMinor"].toString()&&(Pd.data.httpStatus=451),Ae=Pd.data.Fg,Me=Pd.data.responseHeaders);Ic(Pd.data.httpStatus,Ae,Me)},Pd=>{var Ae=null;let Me=null;ed&&Pd&&Pd.data&&Pd.data.Fg&&(Ae=Pd.data.Fg,Me=Pd.data.responseHeaders);Ic(Pd.data.httpStatus,Ae,Me);if(Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){Ae={message:"AddinServiceHandler request failed"};Ae.code=Pd.data.httpStatus;Ae.action=M;if(Pd.data.request||Pd.data.request.get_headers())Ae["X-UserSessionId"]=Pd.data.request.get_headers()["X-UserSessionId"];408===Pd.data.httpStatus||503===Pd.data.httpStatus?t.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Ae)):t.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Ae))}else t.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Pd.data.httpStatus)},null,void 0,void 0,void 0,void 0,
"AddinServiceHandler_"+M,void 0,void 0,void 0,["X-UserKey"])}}Object(k.a)(Ph,"S2SWebRequestManager",null,[]);class mi extends l.a{constructor(M){super();this.g2f=this.ddaFacade=null;this.$=M;M.ia.Va(106,this);this.Oe()}get jg(){return this.ddaFacade||(this.ddaFacade=new ci.DdaFacade(this.$,this.g2f,this.Mh))}create(){t.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");Ze.AFrameworkApplication.disableWholeAppsForOfficeFeature?t.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${Ze.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
f.EwaSettings.Fa(359)?Pf.a.instance.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(M=>{M.isFeatureEnabled("mso_officeStore",!0).then(za=>{ci.DdaFacade.hbc=za;this.Nxb();return null})}):this.Nxb()}Nxb(){var M=this.$.ia;const za=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AgaveOnSelectedReadoutHandler",!1)?Object(Zg.d)(Se.a.resolve(Fe.e,{Oa:this.$a})):gi.GetServiceTaskFactory.je(M,224,225,this.$a);M=jg.a.CEd(63,()=>!(void 0===window.OSF||null===window.OSF),
this.$.xa.MaxRetriesForLoadingScript,this.$.ma,this.$a,106);const Ab=Fh(this.ma,this.$a),ec=Object(Zg.d)(Se.a.resolve(Fe.qb,{Oa:this.$a}));$g.TaskExtensions.Aa($g.TaskExtensions.Tg([za,M,Ab,ec],this.$.ma),()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?t.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Fb.a.y1()}`):this.kwi();t.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");
this.g2f=za.result;this.Mh=ec.result;this.ve(this.jg);t.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ma,3)}kwi(){f.EwaSettings.Fa(63)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Ph);this.$.Kg.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Ph,new qi(Ze.AFrameworkApplication.da.appSettings.WebServiceBase),f.EwaSettings.Fa(70),!0);OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new Ph);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&
OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Ph)}dispose(){mh.a.Ma(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static la(M){new mi(M)}}Object(k.a)(mi,"DdaFacadeServiceFactory",l.a,[]);class Yi{constructor(M,za,Ab,ec,Ic,ed){this.$=M;this.agaveCommandManager=ed}mf(){return!1}hf(){return!1}Ue(M,za,Ab,ec){let Ic=!1;switch(za.command){case -684355545:Ic=!0;break;case -741808261:Ic=!!Ab;break;case -859308420:Ic=!!ec&&1===ec.IA;break;case 418618014:Ic=1===M&&!!ec&&1===ec.IA;break;
case -167264441:Ic=Pg.a.xGb(this.$)&&1===M&&!!ec&&1===ec.IA;break;case -515602470:za=f.EwaSettings.Fa(217)&&2===M;Ic=(1===M||za)&&!!ec&&1===ec.IA;break;case 2086613372:Ic=f.EwaSettings.Fa(217)&&2===M&&!!ec&&1===ec.IA;break;case -1336341324:Ic=f.EwaSettings.Fa(417)&&1===M&&!!ec&&1===ec.IA;break;case 451940422:Ic=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===M&&!!ec&&1===ec.IA;break;case -1444574190:case -336193495:Ic=1===M&&!!ec&&1===ec.IA;break;case 1296389134:Ic=
1===M&&!!ec&&1===ec.IA;break;case ng.a.cab:Ic=1===M&&!!ec&&1===ec.IA;break;case 1221897806:Ic=f.EwaSettings.Fa(155)&&2===M;break;case 1172793074:case 1930653487:Ic=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===M;break;case -1753056834:Ic=!0;break;case 932597253:Ic=!0;break;case 301511274:Ic=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Ic=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",
!0)&&this.$.isEditMode;break;case 1723441034:Ic=this.$.isEditMode&&this.$.ea.nTb;break;case 1485761473:Ic=Pg.a.Noa()&&this.$.isEditMode}return Ic}executeCommand(M,za,Ab){var ec=$g.TaskExtensions.Wl();const Ic=za.command;switch(za.command){case ng.a.cab:this.agaveCommandManager.Gph(Ab.SourceControlId);break;case 1296389134:Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowFlyoutSurveyOnExcelEnabled",!1)&&kd.a.instance.getItem("removeFlyoutTaskTimeoutId")&&(window.clearTimeout(Number(kd.a.instance.getItem("removeFlyoutTaskTimeoutId"))),
kd.a.instance.removeItem("removeFlyoutTaskTimeoutId"));this.agaveCommandManager.$7j(Ab.SourceControlId,Ab.LabelText);break;case -684355545:this.agaveCommandManager.m9c();break;case -741808261:ec=this.agaveCommandManager.insertAgave(Ab,za);break;case -1336341324:f.EwaSettings.Fa(417)&&(ec=this.agaveCommandManager.LDb(Ab,M,za));break;case 1172793074:f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(ec=this.agaveCommandManager.LDb(Ab,M,za));break;case 1485761473:f.EwaSettings.isChangeGateEnabled("OfficeVSO::8205819_CopilotProxy_RegisterAndActivateAnnotationToKeepSessionAlive")||
this.mj?ec=this.agaveCommandManager.LDb(Ab,M,za):(ec=Se.a.resolve(Fe.j,{Oa:1}),ec=Object(Zg.d)(ec.then(ed=>{this.mj=ed;t.ULS.sendTraceTag(508397023,0,15,"Copilot proxy created IAugmentationLoopManager manager");return Object(Zg.a)(this.agaveCommandManager.LDb(Ab,M,za))})));break;case -859308420:case -515602470:case -167264441:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:ec=
this.agaveCommandManager.LDb(Ab,M,za);break;default:ec=Ha.a(Ic)}return ec}}Object(k.a)(Yi,"AgaveCommandHandler",null,[169]);class pj{}Object(k.a)(pj,"Selection",null,[]);var Aj=a(1234),Bj=a(1233),Cj=a(1235),ih=a(1231),Mh=a(1229);class mj{}Object(k.a)(mj,"SmartLookupApplicationInterface",null,[]);class Bi{}Object(k.a)(Bi,"ApplicationProperties",null,[]);class Gj{}Object(k.a)(Gj,"EnterpriseUserInfo",null,[]);class Ni{}Object(k.a)(Ni,"FeatureGates",null,[]);class qj{constructor(M,za,Ab){this.Adk=9E5;
this.Ddk=3E5;this.fGd=null;this.zDf="";this.cGd=0;this.zyb=Date.now;this.ZBa=M;this.tdb=za;(void 0===Ab||Ab)&&this.mnd()}Ohi(){var M=void 0===M?!0:M;const za=this.zyb();if(za<this.cGd+this.Adk)return za>this.cGd+this.Ddk&&this.mnd(),this.zDf;M&&this.mnd();return""}mnd(){this.fGd=this.fGd||new Promise(M=>{this.Phi().then(za=>{this.zDf=za;this.cGd=this.zyb();this.fGd=null;M(za)})})}Phi(){return this.tdb&&this.tdb.length?new Promise(M=>{this.ZBa.pD("SmartLookup",this.tdb).then(za=>{za.IsSuccess?za.Token||
(M(""),t.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(t.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+za.ErrorCode+": "+za.ErrorMessage),M(""));M(za.Token)}).catch(za=>{za=yg.c(za);t.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+za);M("")})}):(t.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(k.a)(qj,
"SmartLookupAuthenticationManager",null,[780]);class fj{static L7h(){switch(Object(ca.a)(String,Ze.AFrameworkApplication.Ge.AudienceGroup)||""){case "Dogfood":if(Ze.AFrameworkApplication.da){let M=Ze.AFrameworkApplication.da.Ra("UserPrincipalName");M=Xf.a.rn(M);const za=Ze.AFrameworkApplication.da.As("SmartLookupINTEnabledForSKITeam")?Ze.AFrameworkApplication.da.By("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(za,M)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static jhi(){switch(Ze.AFrameworkApplication.da.na("IntentSvcEnableEdogSourceLocationOverride")?
"EDOG":Ze.AFrameworkApplication.da.na("IntentSvcEnableProdSourceLocationOverride")?"PROD":Ze.AFrameworkApplication.da.na("IntentSvcEnableIntSourceLocationOverride")?"INT":fj.L7h()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(k.a)(fj,"Utils",null,[]);var Dj=a(569),gj=
a(181);class hj{constructor(M){t.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.gEf=Ze.AFrameworkApplication.da.na("IsTellMeUpSellEnterpriseEnabled");this.oWi=Ze.AFrameworkApplication.da.Ra("SmartLookupApprovedOriginPattern");this.tdb=Ze.AFrameworkApplication.da.Ra("SmartLookupShredderServiceEndpoint");this.SWi=Lb.a.uN(Ze.AFrameworkApplication.da.Ra("AppCatalogUrl")||"");this.sdb=new Ni;this.sdb.EnableAllTabV2=!0;this.sdb.EnableIntentService=!0;this.sdb.EnableInDocumentSearch=
Ze.AFrameworkApplication.da.na("SmartLookupEnableInDocumentSearch");this.sdb.EnableLocalSearch=Ze.AFrameworkApplication.da.na("SmartLookupEnableLocalSearch");this.sdb.IntentServiceEndpoint=fj.jhi();this.NWi=new qj(M,this.tdb)}get approvedOriginPattern(){return this.oWi}j2h(){return Promise.resolve(this.k2h())}k2h(){const M=new Bi;M.anid="";M.applicationVersion=Ze.AFrameworkApplication.buildVersion;M.appCorrelationId=gj.a.create().toString();M.themePlatform=hj.zrk;M.lcid=Ze.AFrameworkApplication.lcid;
M.launchUtcTime=(new Date).toUTCString();M.featureGates=this.sdb;var za=Dj.a.sN(Ze.AFrameworkApplication.lcid);za=za?za.name:null;M.market=this.Xic(za);M.uiLanguage=za;M.sessionId=Ze.AFrameworkApplication.userSessionId;M.themeId=0;M.parentalControl=hj.Wkj;const Ab=new Gj;Ab.CountryCode=this.Xic(za);Ab.ServiceEndpoint=this.tdb;Ab.IsGoLocal=!1;Ab.IsEnabled=this.gEf;Ab.IsEnterpriseEnabled=this.gEf;Ab.TenantRoot=this.SWi;M.enterpriseUserInfo=Ab;M.accessToken=this.NWi.Ohi();return M}Xic(M){M=M.split("-");
return M[M.length-1]}}hj.zrk="web";hj.Wkj="yes";Object(k.a)(hj,"SmartLookupManager",null,[757]);class ij extends Og.a{constructor(M){super();this.$=M;this.isFirstLaunch=!1}mf(){return!1}hf(){return!1}Ue(M,za){M=f.EwaSettings.Fa(127);return-983891024===za.command&&M}executeCommand(M,za){M=$g.TaskExtensions.Wl();-983891024===za.command&&this.ZPi();return M}ZPi(){var M=new hj(null);const za={};var Ab=bc.h(this.$).Zd(null).originalText;Ab=Object(Ef.a)(new pj,{neighborhood:Ab,mentionStart:0,mentionLength:Ab?
Ab.length:0});const ec=Object(Ef.a)(new mj,{selection:Ab,entryPoint:0});M.j2h().then(ed=>{ed.applicationName=ij.appName;ed.isFirstLaunch=this.isFirstLaunch;ed.themeId=5;za[ij.v6j]=JSON.stringify(ec);za[ij.b4g]=JSON.stringify(ed);this.isFirstLaunch=!1});M=new Aj.a("ExcelOnline","Web","en-Us");Ab=new Bj.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const Ic=new Cj.a;Ic.optionalProperties[ih.a.Im]=cg.a.instance.ha(1810);Ic.optionalProperties[ih.a.taskPaneWidth]=350;Ic.optionalProperties[ih.a.sourceLocationOverrideResourceId]=
"WAC.PROD.URL";Ic.Gt=za;Mh.a.instance.LBa(Ab,"Taskpane","SmartLookupSDXTaskpane",M,Ic)}}ij.b4g="AppProperties";ij.appName="Excel";ij.v6j="SmartLookupApplicationInterface";Object(k.a)(ij,"SmartLookupCommandHandler",Og.a,[169]);var Th=a(470);class nj extends kg.a{constructor(M){super(M)}yg(){Th.a(this.$,374,375,this.$a,M=>{this.vg([new Yi(this.$,null,null,null,null,M),new ij(this.$)])})}static la(M){kg.a.dh(76,new nj(M))}}Object(k.a)(nj,"AgaveCommandHandlerFactory",kg.a,[]);var ph=a(1236),Zi=a(118);
class Hi{constructor(){this.jg=null;this.tgb=(M,za,Ab,ec,Ic)=>{if(2===Ab){M=Ic?Ic:{};za=M.callback;Ab=M.refresh?M.refresh:!1;if(!za)return 16;Ze.AFrameworkApplication.da.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&null!=M.storeType?this.jg.Q_f(za,Ab,M.storeType):this.jg.WQd(za,Ab)}return 32};this.YAc=(M,za,Ab,ec,Ic)=>{if(2===Ab){M=Ic?Ic:{};za=M.Observer;if(!za)return t.ULS.sendTraceTag(509686147,220,10,"registerAddinDetailObserver: invalid actionData: {0}",JSON.stringify(M)),
16;if(!this.jg||!this.jg.L6)return t.ULS.sendTraceTag(509671006,220,10,"registerAddinDetailObserver: ddaFacadeService or its addinDetailsProvider is null, abort the operation, actionData: {0}",JSON.stringify(M)),16;this.jg.L6.dra(za)}return 32};this.zzj=(M,za,Ab,ec,Ic)=>{2===Ab&&(M=Ic?Ic.callback:null)&&this.jg.tZg(M);return 32};this.nzi=(M,za,Ab,ec,Ic)=>{2===Ab&&this.jg.MMb(null,OSF.AgaveHostAction.InsertAgave,Ic);return 32}}initialize(M){Hi.initialized||(this.jg=M,this.Oj(),Hi.initialized=!0)}Oj(){Ze.AFrameworkApplication.Vd.uh(ng.a.tgb,
Zi.a.frame,this.tgb,96);Ze.AFrameworkApplication.Vd.uh(ng.a.YAc,Zi.a.frame,this.YAc,96);Ze.AFrameworkApplication.Vd.xe(ng.a.iyj,Zi.a.frame,this.zzj);f.EwaSettings.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.OfficeVSO_7976369_RemoveAddinSearchFGs")&&Ze.AFrameworkApplication.Vd.uh(ng.a.Sof,Zi.a.frame,this.nzi,96)}static get instance(){Hi.La||(Hi.La=new Hi);return Hi.La}}Hi.La=null;Hi.initialized=!1;Object(k.a)(Hi,"AgaveCommandActor",null,[]);var Ii=a(1290),Oi=a(1232),yi=a(112),sj=a(330),
Ci=a(331),$i=a(1180),Gh=a(18),Hj=a(357);class Fi{constructor(){this.H5d=this.dJc=null;this.G5d=!1;this.E5d=null;this.MV=0;this.cJc=null}}Object(k.a)(Fi,"FirstPartyAddinTaskpaneOverrides",null,[]);class Si{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(k.a)(Si,"IdeasSelectionContext",null,[]);class tj extends Si{constructor(){super();this.hasTableHeaders=
this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(k.a)(tj,"IdeasTableSelectionContext",Si,[]);class uj{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(k.a)(uj,"AutoFilterRange",null,[]);class aj{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(k.a)(aj,"IdeasAutoFilterSource",null,[]);class ri{constructor(M,za){this.selection=M;this.tables=za}}Object(k.a)(ri,
"IdeasXLIMTableBoundaries",null,[]);var Nh=a(58),Xh=a(1025),bj=a(73),jj=a(145),C=a(45),ea=a(383),Ta=a(202),Yb=a(191),wc=a(576),Hc=a(249),rd=a(113),ce=a(146),Le=a(55);class Ue extends wd.a{constructor(){super();this.Y_="calc(100% - 46px)";this.zba="15px";this.Z_="0";this.Dnb="WACDialogPanel";this.eH=695;this.Enb=462;this.kF="80%";this.smb=350;this.Mta="100%";this.ke=5;this.Rg="AppsForOfficeInsertionDialog";this.ERc=!!Ze.AFrameworkApplication.da&&Ze.AFrameworkApplication.da.na("OfficeAddinEnableInsertDialogAccessibilityFix")}Rz(){super.Rz();
this.tk.style.width=this.Mta;this.tk.style.height=this.Y_;this.tk.style.marginTop=this.zba;this.tk.style.padding=this.Z_}Xqa(){this.tk.style.width=this.Mta;this.tk.style.height=this.Y_;this.tk.style.marginTop=this.zba;this.tk.style.padding=this.Z_;this.eH>md.a.a4?(this.Md.style.width=String.format("{0}px",md.a.a4),this.Md.style.overflowX="scroll",Ze.AFrameworkApplication.isRtl?this.Md.style.right="0":this.Md.style.left="0"):(this.Md.style.width=String.format("{0}px",this.eH),this.Md.style.overflowX=
"hidden");this.Md.offsetHeight>md.a.fV||this.Enb+50>md.a.fV?(this.Md.style.height=String.format("{0}px",md.a.fV),this.Md.style.overflowY="scroll",this.Md.style.top="0",Ze.AFrameworkApplication.isRtl?this.Md.style.right="0":this.Md.style.left="0",this.ERc||(this.Md.style.marginTop="-48px"),this.tk.style.minHeight=String.format("{0}px",this.smb)):(this.Md.style.overflowY="hidden",this.Md.style.top="10%",this.Md.style.height=this.kF);this.rda()}rda(){if(this.Md){var M=this.Md.style.zIndex;this.Md.style.zIndex=
"-9999";if(this.eH>md.a.a4)Ze.AFrameworkApplication.isRtl?this.Md.style.marginRight="0":this.Md.style.marginLeft="0";else{const za=String.format("{0}px",Math.floor(-this.Md.offsetWidth/2));Ze.AFrameworkApplication.isRtl?this.Md.style.marginRight=za:this.Md.style.marginLeft=za;Ze.AFrameworkApplication.isRtl?this.Md.style.right="50%":this.Md.style.left="50%"}this.Md.style.zIndex=String(M)}else t.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}OG(){super.OG();const M=document.getElementById(this.qk(this.Dnb));
M.style.width=String.format("{0}px",this.eH);M.style.height=this.kF}get Vda(){return this.tk}}Object(k.a)(Ue,"AppsForOfficeInsertionDialog",wd.a,[372]);class mf extends wd.a{constructor(M,za,Ab){M=void 0===M?!0:M;za=void 0===za?!0:za;Ab=void 0===Ab?null:Ab;super();this.Y_="calc(100% - 46px)";this.zba="15px";this.Z_="0";this.Dnb="WACDialogPanel";this.eH=695;this.Enb=462;this.kF="80%";this.smb=350;this.Mta="100%";this.lge=this.tja=null;this.Fge="auto";this.Gge="5px";this.Hge="auto";this.Ege="40px";
this.UZb="100px";this.Fnb="200px";this.ke=5;this.Rg="SDXDialog";this.D0b=M;this.gEb=za;this.PZb=Ab}Rz(){super.Rz();this.tk.style.width=this.Mta;this.tk.style.height=this.Y_;this.tk.style.marginTop=this.zba;this.tk.style.padding=this.Z_}Xqa(){this.tk.style.width=this.Mta;this.tk.style.height=this.D0b?this.Y_:"100%";this.tk.style.marginTop=this.D0b?this.zba:"0px";this.tk.style.padding=this.Z_;if(this.D0b){this.UZb&&this.Fnb&&(this.eH=parseInt(this.Fnb.substring(0,this.Fnb.length-2)),this.kF=this.UZb);
this.eH>md.a.a4?(this.Md.style.width=String.format("{0}px",md.a.a4),this.Md.style.overflowX="scroll",Ze.AFrameworkApplication.isRtl?this.Md.style.right="0":this.Md.style.left="0"):(this.Md.style.width=String.format("{0}px",this.eH),this.Md.style.overflowX="hidden");if(this.Md.offsetHeight>md.a.fV||this.Enb+50>md.a.fV)this.Md.style.height=String.format("{0}px",md.a.fV),this.Md.style.overflowY="scroll",this.Md.style.top="0",Ze.AFrameworkApplication.isRtl?this.Md.style.right="0":this.Md.style.left="0",
this.tk.style.minHeight=String.format("{0}px",this.smb);else{this.Md.style.overflowY="hidden";const M="%"===this.kF.substring(this.kF.length-1,this.kF.length),za=M?parseInt(this.kF.substring(0,this.kF.length-1)):parseInt(this.kF.substring(0,this.kF.length-2));this.Md.style.top=M?(100-za)/2+"%":100*(md.a.fV-za)/md.a.fV/2+"%";this.Md.style.height=this.kF}this.rda()}else this.Md.style.left=this.Fge,this.Md.style.right=this.Gge,this.Md.style.top=this.Hge,this.Md.style.bottom=this.Ege,this.Md.style.width=
this.Fnb,this.Md.style.height=this.UZb,this.Md.style.overflowX="hidden",this.Md.style.overflowY="hidden"}rda(){if(this.Md){var M=this.Md.style.zIndex;this.Md.style.zIndex="-9999";if(this.eH>md.a.a4)Ze.AFrameworkApplication.isRtl?this.Md.style.marginRight="0":this.Md.style.marginLeft="0";else{const za=String.format("{0}px",Math.floor(-this.Md.offsetWidth/2));Ze.AFrameworkApplication.isRtl?this.Md.style.marginRight=za:this.Md.style.marginLeft=za;Ze.AFrameworkApplication.isRtl?this.Md.style.right="50%":
this.Md.style.left="50%"}this.Md.style.zIndex=String(M)}else t.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}OG(){super.OG();const M=document.getElementById(this.qk(this.Dnb));M.style.width=String.format("{0}px",this.eH);M.style.height=this.kF}get r9(){return this.D0b}get Vda(){return this.tk}get instanceId(){return this.tja}set instanceId(M){this.tja=M}get wdc(){return this.lge}set wdc(M){this.lge=M}ESj(M,za,Ab,ec){this.Fge=M;this.Gge=za;this.Hge=Ab;this.Ege=ec}GSj(M,
za){this.UZb=M;this.Fnb=za}}Object(k.a)(mf,"SDXDialog",wd.a,[]);var rf=a(917),Of=a(107),Ag=a(304),tg;(function(M){M[M.Valid=2]="Valid";M[M.Invalid=4]="Invalid";M[M.All=6]="All"})(tg||(tg={}));Object(k.b)("MetadataState",tg);var mg=a(354);class O extends Og.a{constructor(M,za,Ab,ec,Ic){super();this.asa={};this.rYd={};this.gld={};this.CUa=this.sdxDialog=this.S2=null;this.chb=!1;this.Q6j=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAppsForOffice","Ribbon"],["LaunchAddinDialogFromTellMe",
"TellMe"],["TeachingCallout","TeachingCallout"],["AddinFlyoutMoreButton","AddinFlyoutSeeAll"],["InsertMoreAddInsFromFooter","InsertMoreAddInsFromFooter"],["InsertMoreAddInsFromBackstageFooter","InsertMoreAddInsFromBackstageFooter"],["LaunchMyAddInsFromBackstage","BackstageSeeAll"]]);this.Gph=ed=>{ed?(ed=new ki.a(-847286761,ei.a.Td,this.$.Ie,0,ed),this.$.Ga.Sd(ed,{["CalloutName"]:19})):t.ULS.sendTraceTag(509220127,220,10,"Control id is null.")};this.Eoi=(ed,Ed,Pd,Ae,Me)=>{if(2!==Pd)return 32;this.Msc(Me);
return 32};this.lJb=(ed,Ed,Pd,Ae,Me)=>{2===Pd&&(this.S2=new Ue,this.S2.initializeAndShow("",null,null),ed=Me.CommandValueId,Ed=[],Ed.push(Me.SourceControlId),Ed.push(ed),Ed.push(null),this.jg.Ozf(this.S2.Vda,Ed));return 32};this.Msc=ed=>{var Ed=ed[rf.a.yAb];ed=ed[rf.a.Cga];var Pd=ed.optionalProperties[ih.a.yVe];const Ae=ed.optionalProperties[ih.a.DVe],Me=ed.optionalProperties[ih.a.Om],zf=ed.optionalProperties[ih.a.dialogHeight],Df=ed.optionalProperties[ih.a.dialogWidth],fg=ed.optionalProperties[ih.a.dialogLeft],
qh=ed.optionalProperties[ih.a.CVe],og=ed.optionalProperties[ih.a.dialogTop],ch=ed.optionalProperties[ih.a.sVe];var ah=ed.optionalProperties.InstanceToken;ah=null!=ah?ah:(new ia.a(gj.a.create(),1)).toString();this.sdxDialog=new mf(Pd,Ae);null!=fg&&null!=qh&&null!=og&&null!=ch&&this.sdxDialog.ESj(fg,qh,og,ch);null!=zf&&null!=Df&&this.sdxDialog.GSj(zf,Df);this.sdxDialog.instanceId=ah;this.sdxDialog.wdc=ed.optionalProperties[ih.a.wdc];this.sdxDialog.initializeAndShow(Me,null,null);Pd={};Pd.div=this.sdxDialog.Vda;
Pd.id=ah;Pd.solutionId=Ed.getId();Pd.version=Ed.ZGa;Pd.storeType=Ed.getStoreType();Pd.storeId=Ed.getStoreId();Pd.assetId=null;Pd.assetStoreId=null;Pd.settings=null!=ed.Gt?ed.Gt:{};Pd.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Pd.osfControlType=OSF.OsfControlType.ContainerLevel;Pd.sourceLocationOverrideResourceId=ed.optionalProperties[ih.a.sourceLocationOverrideResourceId];Pd.featureGates=Ze.AFrameworkApplication.da.jbf(Ed.getId());Pd.onExtensionLaunchCallback=ed.optionalProperties[ih.a.onExtensionLaunchCallback];
Ed={};Ed.InstanceId=Pd.id;Ed.WebExtensionType=2;Ed.PrimaryMarketplace={};Ed.PrimaryMarketplace.SolutionId=Pd.solutionId;Ed.PrimaryMarketplace.MarketplaceType=Pd.storeType;Ed.PrimaryMarketplace.MarketplaceRef=Pd.storeId;Ed.PrimaryMarketplace.SolutionVersion=Pd.version;Ed.SrcLocationOverrideResourceId=Pd.sourceLocationOverrideResourceId;Ed.WebExtensionOsfControlType=6;Ed.OnExtensionLaunchCallback=Pd.onExtensionLaunchCallback;this.asa[Pd.solutionId]=Pd.settings;const {aAc:Ch,SAb:Qh}=this.Euc([],Pd.solutionId);
Ed.OsfPropertyBag=Ch;Ed.HostPropertyBag=Qh;this.jg.DMa(Ed);this.jg.Qh.insertOsfControl(Pd)};this.fqi=(ed,Ed,Pd,Ae,Me)=>{if(2!==Pd)return 32;ed=Me[rf.a.yAb];Pd=Me[rf.a.lMa];Me=Me[rf.a.Cga];Ed=new Ii.a;Ed.Pzi=Me.optionalProperties.InstanceToken;Ed.Im=Me.optionalProperties[ih.a.Im];Ed.KO=Me.optionalProperties[ih.a.KO];ih.a.taskPaneWidth in Me.optionalProperties&&(Ed.taskPaneWidth=Me.optionalProperties[ih.a.taskPaneWidth]);Ed.sourceLocationOverrideResourceId=Me.optionalProperties[ih.a.sourceLocationOverrideResourceId];
Ed.onTaskPaneClose=Me.optionalProperties[ih.a.onTaskPaneClose];Ed.onExtensionLaunchCallback=Me.optionalProperties[ih.a.onExtensionLaunchCallback];Ed.showLoadingSpinner=Me.optionalProperties[ih.a.showLoadingSpinner];Ed.Hy=Me.Gt;Ed.lMa=Pd;Pd=new ki.a(-859308420,0,2,0,"");Ae=ed.getStoreType()===OSF.StoreType.Sdx;const zf=new Xh.a;zf.L2=Me.optionalProperties.HeaderCssClass||Gh.a.lAb;zf.xkb=Me.optionalProperties.TitleCssClass;this.n_(Pd,ed.getId(),Ed,Ae,zf);return 32};this.Lpi=(ed,Ed,Pd,Ae,Me)=>{if(2!==
Pd)return 32;ed=Me[rf.a.yAb].getId();Me=Me[rf.a.Cga].optionalProperties[ih.a.sourceLocationOverrideResourceId];return ed?(this.jg.Qh.refreshOsfControl(ed,Me),32):8};this.Koj=ed=>{ed=ed.Result;if(ed=null===ed?null:ed.SolutionId)this.jg.rye(ed),rd.a(this.$).maa(3,ed)};this.kYf=(ed,Ed)=>{var Pd;const Ae=(ed=ed.Result)?ed.AgaveData:null;if(Ae){var Me=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ae.PrimaryMarketplace.SolutionId,Ae.PrimaryMarketplace.MarketplaceType,null===(Pd=null===Ae||void 0===Ae?void 0:
Ae.AssetMarketplace)||void 0===Pd?void 0:Pd.SolutionId,null,null,Ae.PrimaryMarketplace.MarketplaceRef);t.ULS.shipAssertTag(537170434,0,Ae.TaskpaneWidth===O.yUe,`Taskpane width is ${Ae.TaskpaneWidth}, assetId is ${Me}.`);if(Pd=this.gld[Ae.PrimaryMarketplace.SolutionId])Pd.dJc&&(Ae.TaskpaneTitle=Pd.dJc),Pd.H5d&&(Ae.TaskpaneTitleTag=Pd.H5d),Pd.G5d&&(Ae.ShowResizeChatButton=Pd.G5d),Pd.cJc&&(Ae.TaskpaneIconId=Pd.cJc),Pd.E5d&&(Ae.TaskpaneButtonTooltip=Pd.E5d),0<Pd.MV&&(Ae.TaskpaneWidth=Pd.MV);Ed&&(Ae.FocusOnIframeWhenLoaded=
Ed.focusOnIframeWhenLoaded,Ed.width&&(Ae.TaskpaneWidth=Ed.width),Ae.TaskpaneIconCssClass=Ed.Js,Ae.TaskpaneHeaderCssClass=Ed.L2,Ae.TaskpaneTitleCssClass=Ed.xkb,Ae.IsFirstPartyOptOutAppContextOptmization=Ed.isFirstPartyOptOutAppContextOptmization,Ae.ShowLoadingSpinner=Ed.showLoadingSpinner);if(this.asa[Ae.PrimaryMarketplace.SolutionId]){const {aAc:zf,SAb:Df}=this.Euc(Ae.OsfPropertyBag,Ae.PrimaryMarketplace.SolutionId);Ae.OsfPropertyBag=zf;Ae.HostPropertyBag=Df}wc.a(Ae)||(Ae.WebExtensionOsfControlType=
1);Ae.OnExtensionLaunchCallback=this.rYd[Ae.PrimaryMarketplace.SolutionId];Ae&&(this.jg.rye(ed.SolutionId),this.jg.DMa(Ae))}else t.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.zTh=ed=>{ed&&(this.skd.kyf(ed),this.cKe())};this.oYf=ed=>{ed=ed.toDataURL("image/jpeg");const Ed=this.jg.pea(O.Blf+"."+O.elc),Pd={};Pd.screenshot=ed;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Ed,"onScreenshot",Pd,()=>{})};this.Wni=
(ed,Ed,Pd,Ae,Me)=>{if(2!==Pd)return 32;if(yi.a.Fj(Me)||Me[rf.a.iOe]!==Oi.a.action)return 8;Ed=Me[rf.a.Cga];return Ed?(ed=(ed=this.mdi(Me))?this.jg.pea(ed):null)?(Me=this.jg.Loh(Me[rf.a.lMa],Ed.optionalProperties[ih.a.o2c]),f.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Pd=this.jg.iY(ed),Pd.TaskpaneTitle!==Ed.optionalProperties[ih.a.Im]&&(Pd.TaskpaneTitle=Ed.optionalProperties[ih.a.Im],Pd.TaskpaneIconCssClass=Ed.optionalProperties.IconCssClass,Pd.TaskpaneIconUrl=
Ed.optionalProperties.TaskPaneIconUrl,Pd.TaskpaneIconId=Ed.optionalProperties.TaskPaneIconId,Pd.OnExtensionLaunchCallback=Ed.optionalProperties[ih.a.onExtensionLaunchCallback],f.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(Ed=this.jg.Qh,Ed.changeIframeTitle(ed,Pd.TaskpaneTitle),Pd=Ed.getOsfControl(ed),Ed.raiseOsfControlStatusChange(Pd)):(Ed=this.jg.Qh.getOsfControl(ed),this.jg.Qh.raiseOsfControlStatusChange(Ed)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ed,
Me,this.aSb),32):8:8};this.aSb=(ed,Ed)=>{this.jg.$Vh(ed,Ed)};this.ZSd=()=>{$g.TaskExtensions.Xla(gi.GetServiceTaskFactory.je(this.$.ia,20,404,1),ed=>{ed.result.Ona()},this.$.ma)};this.$=M;this.viewBlockContainerHelpers=Ab;this.jg=za;this.skd=ec;this.Hl=Ic;this.Hl.xe(ng.a.Ljg,Zi.a.frame,this.fqi);this.Hl.xe(ng.a.D9f,Zi.a.frame,this.Lpi);this.Hl.xe(ng.a.N3e,Zi.a.frame,this.Wni);this.Hl.xe(ng.a.Msc,Zi.a.frame,this.Eoi);this.Hl.xe(ng.a.lJb,Zi.a.frame,this.lJb)}p_g(M){this.addHandler(O.lNd,M)}FDj(M){this.removeHandler(O.lNd,
M)}dispose(){mh.a.Ma(this.S2);this.S2=null;this.chb&&(this.$.ea.to(this.ZSd),this.chb=!1);super.dispose()}m9c(){this.S2&&this.S2.hide()}$7j(M,za){var Ab;if(M){this.raiseEvent(O.lNd);const ec=M.split("|");this.pUi(M,za,ec);this.S2=new Ue;this.S2.initializeAndShow("",null,null);this.jg.Ozf(this.S2.Vda,ec);window[O.Q1g]=null!==(Ab=this.Q6j.get(M))&&void 0!==Ab?Ab:"Unknown"}}LDb(M,za,Ab){var ec=$g.TaskExtensions.Wl();if(-515602470===Ab.command||-167264441===Ab.command||-336193495===Ab.command||2086613372===
Ab.command||-1444574190===Ab.command||-1336341324===Ab.command||451940422===Ab.command)ec=this.toi(M,za,Ab);418618014===Ab.command&&(za=new Ii.a,za.Im=cg.a.instance.ha(1823),ec=this.n_(Ab,O.isi,za,!0));if((Ab.tabName===this.$.He+bh.a.k$f||Ab.tabName===bh.a.i4)&&2===Ab.hh||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback Tutorials".split(" "),M[ei.a.qf])||M[ei.a.qf]===bh.a.AN)return this.ujf(M,Ab);if(7===Ab.hh&&M.SourceControlId===this.$.He+bh.a.Qza)return M.MenuItemId=bh.a.XRd,
this.ujf(M,Ab);1221897806===Ab.command&&(ec=this.tjg(Ab,"Format"));if(1930653487===Ab.command||1172793074===Ab.command)ec=this.tjg(Ab,"Data");-1753056834===Ab.command&&(ec=this.u3j(Ab));932597253===Ab.command&&(t.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Of.c(932597253,!0),za=new Ii.a,za.Im=cg.a.instance.ha(2163),za.sourceLocationOverrideResourceId=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?O.Toj:O.Voj,za.focusOnIframeWhenLoaded=
!0,za.taskPaneWidth=O.cnf,ec={},ec.LaunchSource=Object(ca.a)(String,M.SourceControlId),ec.LaunchMode="Default",za.Hy=ec,ec=this.n_(Ab,O.Uoj,za,!0));301511274===Ab.command&&(ec=this.G3j(Ab));if(515196233===Ab.command){za=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableTaskPaneFeedback",!1);ec=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",!1);var Ic=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",
!1)?Se.a.rg(Fe.pc):this.$.ia.Ja(465);Ic&&(Ic.XPa(),za||ec)&&(Ic.Myi(),ec&&Ic.kUj(10===Ab.hh));Ic=new Ii.a;Ic.Im=cg.a.instance.ha(2237);const ed={};ed.SourceUILocation=sj.a[Ab.hh];if(za||ec)ed.SessionID=this.$.ea.sessionId,za&&this.c_d(ed);Ic.Hy=ed;za=new Xh.a;za.L2=Gh.a.lAb;ec=this.n_(Ab,O.Fjj,Ic,!0,za,void 0,Ic.Im)}1723441034===Ab.command&&(za=new Ii.a,za.Im=cg.a.instance.ha(2249),za.focusOnIframeWhenLoaded=!0,za.taskPaneWidth=O.asj,ec=new Xh.a,ec.L2=Gh.a.q0e,ec=this.n_(Ab,Ag.c,za,!0,ec));f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&M.LoadDataFromPictureTaskpane&&(za={},ec=new Ii.a,ec.Im=cg.a.instance.ha(2276),za.SessionID=M.SessionID,ec.Hy=za,ec.focusOnIframeWhenLoaded=!0,ec=this.n_(Ab,M.DataFromPictureAssetId,ec,!0));1485761473===Ab.command&&Pg.a.Noa()&&(ec=this.Dni(Ab));return ec}insertAgave(M,za){var Ab=$g.TaskExtensions.Wl();const ec=this.$;let Ic;var ed=M[zb.a.Wka];Ic=M[ei.a.di];let Ed=null;Xh.a.key in M&&(Ed=M[Xh.a.key]);this.S2&&this.S2.hide();if(!Ic||!ed)return t.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),
Ab;this.$.x9&&bh.a.nia in M&&(Ic.EnabledInViewMode=M[bh.a.nia]);M=this.X4h(za.command);if(!Ic.EnabledInViewMode&&!ec.fv(null,!1,M))return Ab;let Pd=void 0===Ic.IsToBePersisted||null===Ic.IsToBePersisted||Ic.IsToBePersisted?0:16;if(1===Ic.TargetType)Ab=this.Kzi(Ic,ed,za,Ed,Pd);else{ed=bc.h(ec);Ab=this.viewBlockContainerHelpers.Klb(ed);const Ae=ec.ea.isNamedObjectViewMode?ec.pa.sheetName:ec.pa.name;let Me,zf,Df,fg;Ab?(ed=Ab.Ng,Me=ed.xg.top,zf=ed.xg.left,Df=Ab.fS.x,fg=Ab.fS.y):(Me=zf=1,Ab=this.viewBlockContainerHelpers.EPa(ed),
Df=Ab.x,fg=Ab.y);const qh=this.$.qa.ua.ze();Pd|=64;Ab=ea.a(this.$.userOperationManager,(og,ch,ah)=>{var Ch=ec.qa.ua,Qh=Me,vh=zf,Yh=Df,Ji=fg;og=Hc.b(og,this.Koj);const Kj=Ch.Pa(9,qh);Kj.sharedInfo=Ic;Kj.sheetName=Ae;Kj.positionRow=Qh;Kj.positionCol=vh;Kj.positionOffsetX=Yh;Kj.positionOffsetY=Ji;return Nh.g(Ch,"InsertWebExtension",Kj,og,ch,ah,null,0)},og=>new Ta.a(534,0,og,Pd),za)}return Ab}hmh(){var M=Pf.a.instance.ie("Common.App.ICustomerFeedbackUiWrapper");if(!f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",
!1)){var za=Pf.a.instance.ie("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.skd?this.skd.ipb?this.cKe():za.instance.Cgd(this.zTh):t.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}za={};Ze.AFrameworkApplication.da.r3c(za);M=M.instance.getContext(za);za={};"telemetryGroup"in M&&(za=M.telemetryGroup);za.processSessionId=M.sessionId;za.officeBuild=M.build;M.telemetryGroup=za;M.feedbackType=-1;M.userVoiceEnabled=!1;"disableIncludeScreenshot"in M||(M.disableIncludeScreenshot=
!1);"screenshot"in M||(M.screenshot=!1);M.disableScreenshotPreview=!1;M.includeScreenshotSelectedDefault=!0;return M}EYf(M){if(!this.CUa){var za=this.Epd();za=this.HHe(za);const Ab=new Xh.a;Ab.Js=Gh.a.nAb;Ab.L2=Gh.a.O0e;Ab.xkb=Gh.a.Yid;this.CUa=this.XDc(za,null,!1,null,Ab);ce.b(this.$).Lf(jj.a.opj,{["Location"]:M?sj.a[M.hh]:0,["InputMethod"]:M?Ci.a[M.method]:0},void 0,!0);f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.q7d()}}c_d(M){const za=this.$.ea.Qj.get(17);
Pf.a.instance.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ab=>{Ab.isFeatureEnabled("mso_sendASmile",za).then(ec=>{M.FeedbackEnabled=za&&ec;return null})})}bHi(){return this.jg.zMi(this.jg.yOa(O.lQa,this.Epd()))}onPaneClosed(M){var za;switch(M){case O.ocd:null===(za=this.mj)||void 0===za?void 0:za.unregister("Copilot")}}tjg(M,za){const Ab=bc.h(this.$),ec=new Ii.a;var Ic={};Ic.ActiveTab=za;Ic.DatapaneFlighting=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1);Ic.MergeIvyBiDataSources=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeIvyBiDataSources",!1);Ic.ComboChartUIInXLO=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSComboChartUIInXLO",!1);Ic.AceFlighting=!0;Ic.ThemeColorsFlighting=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&f.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Ic.UOMirror=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",
!1);Ic.FormatTaskPaneAceButtonDark=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);Ic.FormatTaskPaneBetterFeedbackButton=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);Ic.FormatTaskPaneBetterScrollbar=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);Ic.FormatTaskPaneUXImprovePhase2=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",
!1);Ic.ChartTPNewFontAndColorTheme=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTPNewFontAndColorTheme",!1);Ic.ChartFOTPRenderRefactor=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSTrendlineEquationFormat",!1);Ic.UOMirrorTaskPaneRefactor=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirrorTaskPaneRefactor",!1);this.c_d(Ic);Ic.startTimeMs=Date.now();Ic.UserSessionId=this.$.xa.UserSessionId;(za=Ab.ga.Ta.lp)&&(Ic.SubSelection=za);t.ULS.sendTraceTag(592524688,
0,50,`Chart task pane launched. UserSessionId: ${Ic.UserSessionId}, UILocation: ${void 0===M.hh||null===M.hh?"Null":sj.a[M.hh]}, SubSelection: ${za||"ChartRoot"}`);ec.Hy=Ic;ec.Im=cg.a.instance.ha(984);Ic=new Xh.a;Ic.L2=Gh.a.lAb;return this.n_(M,O.hgh,ec,!0,Ic)}u3j(M){const za=new Ii.a;za.Hy={};za.Im=cg.a.instance.ha(1809);za.KO=O.oAf;const Ab=new Xh.a;Ab.L2=Gh.a.lAb;return this.n_(M,O.oAf,za,!0,Ab,void 0,za.Im)}G3j(M){const za=new Ii.a;za.Hy={};za.Im=cg.a.instance.ha(2187);const Ab=new Xh.a;Ab.L2=
Gh.a.pMh;Ab.xkb=Gh.a.R0e;const ec=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavPaneWebReadOnly",!1);return this.n_(M,O.b1i,za,!0,Ab,ec)}ujf(M,za){const Ab=O.Blf;var ec=M[ei.a.qf].toString();const Ic={},ed=new Ii.a;ed.Im=cg.a.instance.ha(9);switch(ec){case "A0":Ic.query=(M[ei.a.di]||"").split("|").slice(2,Hj.a.t5).join("|");break;case "A1":Ic.query=M.CommandValueId;break;case "Help":Ic.query="";break;case bh.a.XRd:f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)?(ed.Im=cg.a.instance.ha(1775),ed.sourceLocationOverrideResourceId=O.elc,Ic.feedback=this.hmh()):Ic.query=ec;break;case "HelpArticle":Ic.query=M[ei.a.di];break;case "Tutorials":Ic.query=M.CommandValueId;break;case "ContactSupport":Ic.query=ec;ed.sourceLocationOverrideResourceId=O.pmh;break;case "ShowTraining":case "WhatsNew":Ic.query=ec;break;default:return Vc.Task.Ua(!0)}ed.Hy=Ic;ec=new Xh.a;ec.L2=Gh.a.lAb;return this.n_(za,Ab,ed,!1,ec,M[bh.a.nia]||!1)}HHe(M){const za={};za.SolutionId=O.lQa;za.Version=
"0.0.0.0";za.StoreType=OSF.StoreType.Sdx;za.StoreId=OSF.StoreType.Sdx;za.AssetId=null;za.AssetStoreId=null;za.Height=0;za.Width=0;za.TargetType=OSF.OsfControlTarget.TaskPane;za.IsToBePersisted=!1;za.SourceLocationOverrideResourceId=M;za.SharedRuntimeId=M;return za}toi(M,za,Ab){function ec(){Ed.LaunchMode="Default";Ic.Im=cg.a.instance.ha(1822);Ic.KO=O.B7b;Ic.Js=Gh.a.nAb;ed.Js=Gh.a.nAb}const Ic=new Ii.a,ed=new Xh.a,Ed={};this.CUa&&this.c_d(Ed);Ed.LaunchSource="";Ed.StartTimeMs=Date.now();Ed.CorrelationId=
gj.a.create().toString();Ic.Hy=Ed;Ic.focusOnIframeWhenLoaded=!0;Ic.taskPaneWidth=O.cnf;ed.L2=Gh.a.O0e;ed.xkb=Gh.a.Yid;switch(Ab.command){case -1444574190:let Pd,Ae,Me;Ed.LaunchMode="RecommendedPivotTables";Ed.SelectionContext="";Ed.LaunchSource="PivotTableHandRaise"===Object(ca.a)(String,M.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&f.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&M.SourceSelection){const zf=M.SourceSelection.split(",")[0];
za=f.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if((()=>{let Df=C.ab(zf,this.$.ta);({sheetName:Pd,m1f:Ae,range:Me}=Df);return Df})().returnValue&&!bc.h(this.$).Ud.m3(Me))M=this.$.ta.getItemByName(Pd),Ed.SelectionContext=JSON.stringify(Object(Ef.a)(new Si,{address:Ae,addressWithSheet:Pd+"!"+Me.Cy(!1),sheetId:bj.d(M),sheetName:Pd,isSheetEmpty:!1,columnCount:Me.width,rowCount:Me.height,columnIndex:Me.left+za,rowIndex:Me.top+za,selectionType:"Continuous"}));else if((M=
this.$.ue.getItemByName(Object(ca.a)(String,M.SourceSelection)))&&bj.n(M)){Me=Yb.a(M,!0);let Df=this.$.ta.getItemByName(M.sheetName);Ed.SelectionContext=JSON.stringify(Object(Ef.a)(new tj,{tableName:M.name,hasTableHeaders:Yb.d(M),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Me.Cy(!1),addressWithSheet:Df.name+"!"+Me.Cy(!1),sheetId:bj.d(Df),sheetName:Df.name,isSheetEmpty:!1,columnCount:Me.width,rowCount:Me.height,columnIndex:Me.left+za,rowIndex:Me.top+za,selectionType:"Continuous"}))}}Ic.Im=
cg.a.instance.ha(1821);Ic.KO=O.Wmj;Ic.Js=Gh.a.S2e;ed.Js=Gh.a.S2e;break;case -336193495:Ed.LaunchMode="RecommendedCharts";Ic.Im=cg.a.instance.ha(1820);Ic.KO=O.Jwj;Ic.Js=Gh.a.T2e;ed.Js=Gh.a.T2e;break;case -1336341324:if(!f.EwaSettings.Fa(417))return Vc.Task.Ua(!1);Ed.LaunchMode="NL";Ic.KO=O.B7b;switch(f.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Ic.Im=cg.a.instance.ha(1825);Ed.NLLaunchModeBrandingCandidatesIndex=1;break;
case 2:Ic.Im=cg.a.instance.ha(1826);Ed.NLLaunchModeBrandingCandidatesIndex=2;break;default:Ic.Im=cg.a.instance.ha(1824),Ed.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!f.EwaSettings.Fa(217))return Vc.Task.Ua(!1);Ed.LaunchMode="ChartDesigner";Ed.LaunchSelectionMode=za.toString();Ic.Im=cg.a.instance.ha(1827);Ic.KO=O.B7b;break;case 451940422:Ed.LaunchSource="AutoFilter";za=JSON.parse(M.CommandValueId);Ed.AutoFilterSource=JSON.stringify(Object.assign(new aj,{autoFilterRange:{sheetName:za.AutoFilterRange.SheetName,
firstColumn:za.AutoFilterRange.FirstColumn,lastColumn:za.AutoFilterRange.LastColumn,firstRow:za.AutoFilterRange.FirstRow,lastRow:za.AutoFilterRange.LastRow},autoFilterType:za.AutoFilterType,itemIndex:za.ItemIndex,id:za.Id}));ec();break;case -167264441:Ed.LaunchMode="ExcelIntelligence";Ed.TableName=M.tableName;Ic.Im=cg.a.instance.ha(2287);Ic.KO=O.B7b;Ic.Js=Gh.a.nAb;ed.Js=Gh.a.nAb;break;default:f.EwaSettings.Fa(217)&&(Ed.LaunchSelectionMode=za.toString()),f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",
!1)&&(Ed.XlimTableBoundaries=this.Pii()),ec()}Ic.sourceLocationOverrideResourceId=this.Epd();return this.CUa?this.CUa.hv(()=>this.fPj(Ed,Ic)):this.Pxi(Ab,Ic,ed,Ed)}Dni(M){const za=new Ii.a;f.EwaSettings.isChangeGateEnabled("OfficeVSO:8193341_CopilotHeaderTag")?(za.Im=ExcelRibbonStrings.Copilot,za.Tog=OfficeCommonStrings.PreviewTaskpaneHeaderTag):za.Im=O.joh;f.EwaSettings.isChangeGateEnabled("OfficeVSO:7904707_SDXTaskPaneHeaderIconSupport")&&(za.KO=O.ioh);za.focusOnIframeWhenLoaded=!0;za.taskPaneWidth=
O.yUe;var Ab={};Ab.AudienceGroup=Ze.AFrameworkApplication.Ge.AudienceGroup;Ab.StartTimeMs=Date.now();za.Hy=Ab;let ec=new Xh.a;ec.L2=Gh.a.q0e;if(f.EwaSettings.isChangeGateEnabled("OfficeVSO::8205819_CopilotProxy_RegisterAndActivateAnnotationToKeepSessionAlive")){const Ic=Ed=>{Ed.register(Ed.p2().L4("Copilot").J4(()=>{t.ULS.sendTraceTag(508347875,0,15,"Copilot AugLoop host received close message")}).activateAnnotation({annotationType:"FakeCopilotAnnotation",uu:!1,yFi:!0}).build())},ed=()=>this.n_(M,
O.ocd,za,!0,ec);if(this.mj)return Ic(this.mj),ed();Ab=Se.a.resolve(Fe.j,{Oa:1});return Object(Zg.d)(Ab.then(Ed=>{this.mj=Ed;Ic(this.mj);t.ULS.sendTraceTag(508347904,0,15,"Copilot proxy created IAugmentationLoopManager manager");return Object(Zg.a)(ed())}))}return this.n_(M,O.ocd,za,!0,ec)}Pxi(M,za,Ab,ec){this.CUa=this.XDc(this.HHe(za.sourceLocationOverrideResourceId),za,!1,M,Ab,!1);ec.NoActionMsgOnFirstInstance=!0;this.asa[O.lQa]=ec;return this.CUa}fPj(M,za){const Ab=this.jg.pea(this.jg.yOa(O.lQa,
za.sourceLocationOverrideResourceId));if(Ab){this.asa[O.lQa]=M;const {aAc:ec,SAb:Ic}=this.Euc(this.jg.iY(Ab).OsfPropertyBag,O.lQa);this.jg.iY(Ab).OsfPropertyBag=ec;this.jg.iY(Ab).HostPropertyBag=Ic}this.LBa(O.lQa,Oi.a.action,"LaunchIdeasAction",M,"1.0.0.0",za);return Vc.Task.Ua(!0)}Epd(){const M=Ze.AFrameworkApplication.Ge.AudienceGroup;if(f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPEApi",!1)){switch(M){case "Automation":case "Dogfood":case "Microsoft":return"Ideas.PPEApi.PPE"}return"Ideas.PPEApi"}switch(M){case "Automation":case "Dogfood":case "Microsoft":return"Insights.Https.PPE.Bundle"}return"Insights.Https.Bundle"}n_(M,
za,Ab,ec,Ic,ed,Ed){Ab=void 0===Ab?null:Ab;ec=void 0===ec?!1:ec;Ic=void 0===Ic?null:Ic;ed=void 0===ed?!1:ed;Ed=void 0===Ed?null:Ed;$g.TaskExtensions.Wl();Ab||(Ab=new Ii.a);const Pd={};Pd.SolutionId=za;Pd.Version="0.0.0.0";Pd.StoreType=ec?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Pd.StoreId=ec?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Pd.AssetId=null;Pd.AssetStoreId=null;Pd.Height=0;Pd.Width=0;Pd.TargetType=OSF.OsfControlTarget.TaskPane;Pd.IsToBePersisted=!1;Pd.SourceLocationOverrideResourceId=Ab.sourceLocationOverrideResourceId;
if(Ab.Im||Ed)this.gld[za]=Object(Ef.a)(new Fi,{dJc:Ab.Im,H5d:Ab.Tog,G5d:Ab.showResizeChatButton,E5d:Ed,cJc:Ab.KO});f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Ab.Hy||(Ab.Hy={}),Ab.Hy.ShowFeedback=this.$.isFeedbackEnabled,this.asa[za]=Ab.Hy):Ab.Hy&&(this.asa[za]=Ab.Hy);this.rYd[za]=Ab.onExtensionLaunchCallback;za={};za[ei.a.di]=Pd;Ed={};Ed.solutionId=Pd.SolutionId;Ed.version=Pd.Version;Ed.storeType=Pd.StoreType;Ed.storeId=
Pd.StoreId;Ed.assetId=Pd.AssetId;Ed.assetStoreId=Pd.AssetStoreId;Ed.height=Pd.Height;Ed.targetType=Pd.TargetType;Ed.width=Pd.Width;Ed.isAddinCommands=!ec;za[zb.a.Wka]=Ed;Ic||(Ic=new Xh.a);Ic.focusOnIframeWhenLoaded=Ab.focusOnIframeWhenLoaded;Ic.width=Ab.taskPaneWidth;Ic.showLoadingSpinner=Ab.showLoadingSpinner;za[Xh.a.key]=Ic;za[bh.a.nia]=ed;return this.insertAgave(za,M)}Kzi(M,za,Ab,ec,Ic){const ed=(Me,zf)=>{var Df=Me.SolutionId;const fg=OSF.OsfControl.isFirstPartyStoreString(Me.StoreType);fg&&Me.SourceLocationOverrideResourceId&&
(Df=this.jg.yOa(Df,Me.SourceLocationOverrideResourceId));var qh=this.jg.XKe(Df,null,Me.SharedRuntimeId);if(fg){if(qh&&(Df=this.jg.pea(Df))){const {aAc:og,SAb:ch}=this.Euc(this.jg.iY(Df).OsfPropertyBag,Me.SolutionId);if(Df=this.jg.Qh.getOsfControl(Df))Df.setSettings(og),Df.setHostSettings(ch)}Me.SharedRuntimeId&&qh||this.jg.Qh.refreshOsfControl(Me.SolutionId,Me.SourceLocationOverrideResourceId)}if(!qh){const og=this.$.qa.ua.ze();let ch=519;qh=(ah,Ch,Qh)=>{var vh=this.$.qa.ua;ah=Hc.b(ah,this.kYf);const Yh=
vh.Pa(9,og);Yh.sharedInfo=Me;return Nh.g(vh,"InsertAgaveTaskpane",Yh,ah,Ch,Qh,ec,0)};void 0===Me.IsToBePersisted||null===Me.IsToBePersisted||Me.IsToBePersisted||(ch=538,qh=(ah,Ch,Qh)=>{var vh=Telemetry.PrivacyRules.GetPrivacyCompliantId(Me.SolutionId,Me.StoreType,Me.AssetId,null,null,Me.StoreId);t.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Me.StoreType}, StoreId ${Me.StoreId}, SolutionId ${vh}.`);vh=this.$.qa.ua;ah=Hc.b(ah,this.kYf);const Yh=vh.Pa(9,void 0===
og?null:og);Yh.sharedInfo=Me;return Nh.g(vh,"ShowAgaveTaskpane",Yh,ah,Ch,Qh,ec,0)});Ic|=64;return ea.a(this.$.userOperationManager,qh,ah=>new Ta.a(ch,0,ah,Ic),zf)}return $g.TaskExtensions.Kea()},Ed=Me=>{var zf=Telemetry.PrivacyRules.GetPrivacyCompliantId(Me.solutionId,Me.storeType,Me.assetId,null,null,Me.storeId);t.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${zf} from ${Me.storeType}.`);zf={};const Df=new r.a;Df.add(Me);zf[zb.a.Dtb]=Df;zf[zb.a.aX]=3;Me=new ki.a(ng.a.jJb,0,this.$.Ie,
0,null);return this.$.Ga.Sd(Me,zf)};if(!f.EwaSettings.Fa(52)||M.StoreId===OSF.StoreType.FirstParty)return ed(M,Ab,ec);if(za.isAddinCommands)return Ed(za);const Pd=new eh.a,Ae={};Ae.solutionId=M.SolutionId;Ae.version=M.Version;Ae.storeType=M.StoreType;Ae.storeId=M.StoreId;Ae.targetData=M;this.jg.Qh.isAddinCommandsAsync(Ae,(Me,zf,Df)=>{Pd.setResult(zf);Me||(Me=Df.targetData,zf=Telemetry.PrivacyRules.GetPrivacyCompliantId(Me.SolutionId,Me.StoreType,Me.AssetId,null,null,Me.StoreId),t.ULS.sendTraceTag(537170438,
220,10,`Judging AddinCommands failed for ${zf} from ${Me.StoreType} during addin inserting`))});return $g.TaskExtensions.ts(Pd.task,Me=>Me.result?Ed(za):ed(M,Ab,ec),this.$.ma)}Euc(M,za){if(!this.asa[za])return{qyk:M,SAb:null};const Ab={},ec={};if(M)for(const ed of M){const [Ed,Pd]=ed;Ab[Ed]=Pd}M=this.asa[za];for(var Ic of Object.keys(M))za=M[Ic],Ic===O.BTh&&f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Ab[Ic]=ec[Ic]=Sys.Serialization.JavaScriptSerializer.serialize(za):
Ab[Ic]=ec[Ic]=Sys.Serialization.JavaScriptSerializer.serialize(za.toString());Ic=Object.keys(Ab).map(ed=>[ed,Ab[ed].toString()]);M=Object.keys(ec).map(ed=>[ed,ec[ed].toString()]);return{aAc:Ic,SAb:M}}pUi(M,za,Ab){const ec=this.$.xa.UserSessionId,Ic=this.$.xa.UICultureTag,ed=this.$.xa.UICultureTagLcid,Ed=this.$.xa.WacHostId;let Pd="",Ae="";5<=Ab.length&&(Pd=Ab[3],Ae=Ab[4]);this.qUi(Pd,Ae,M,za,Ic,ed,ec,Ed)}qUi(M,za,Ab,ec,Ic,ed,Ed,Pd){const Ae={};Ae.a=Ed;Ae.b=Ab;Ae.c=ec;Ae.d=M;Ae.e=za;Ae.f=Ic;Ae.g=ed;
Ae.h=Pd;Le.b().Ih(36,Ae)}cKe(){if($i.a.lJf())t.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.oYf);return}catch(M){t.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(M?M.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.oYf)}catch(M){t.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(M?M.toString():null))}}}XDc(M,za,Ab,ec,Ic,ed){za=void 0===za?
null:za;Ab=void 0===Ab?!1:Ab;ec=void 0===ec?null:ec;Ic=void 0===Ic?null:Ic;ed=void 0===ed?!0:ed;var Ed=M.SolutionId,Pd=Vc.Task.Ua(!1);M&&Ed&&M.SharedRuntimeId&&(ec=ec||new ki.a(-859308420,0,2,0,""),Ed={},Ed.solutionId=M.SolutionId,Ed.version=M.Version,Ed.storeType=M.StoreType,Ed.storeId=M.StoreId,Ed.assetId=M.AssetId,Ed.assetStoreId=M.AssetStoreId,Ed.height=M.Height,Ed.targetType=M.TargetType,Ed.width=0,Ed.isAddinCommands=!1,Ed.sharedRuntimeId=M.SharedRuntimeId,M.Preload=ed,Ic=Ic?Ic:new Xh.a,Ic.width=
0,za&&(ed=za,Ic.focusOnIframeWhenLoaded=ed.focusOnIframeWhenLoaded,Pd=new Fi,ed.Im&&(Pd.dJc=ed.Im),0<ed.taskPaneWidth&&(Pd.MV=ed.taskPaneWidth),ed.KO&&(Pd.cJc=ed.KO),f.EwaSettings.isChangeGateEnabled("OfficeVSO:7644290_MsFormsCorrelationId")&&ed.Hy&&(this.asa[M.SolutionId]=za.Hy),this.gld[M.SolutionId]=Pd,this.rYd[M.SolutionId]=za.onExtensionLaunchCallback),za={},za[ei.a.di]=M,za[zb.a.Wka]=Ed,za[Xh.a.key]=Ic,za[bh.a.nia]=Ab,Pd=this.insertAgave(za,ec));return Pd}LBa(M,za,Ab,ec,Ic,ed){ed=void 0===ed?
null:ed;if(M&&Ab){M=new Bj.a(M,OSF.StoreType.Sdx,OSF.StoreType.Sdx,Ic);Ic=new Aj.a("ExcelOnline","Web",this.$.xa.UICultureTag);const Ed=new Cj.a;Ed.optionalProperties[ih.a.o2c]=ec;ed&&(ec=ed,ec.sourceLocationOverrideResourceId&&(Ed.optionalProperties[ih.a.sourceLocationOverrideResourceId]=ec.sourceLocationOverrideResourceId),ec.Im&&(Ed.optionalProperties[ih.a.Im]=ec.Im),ec.Js&&(Ed.optionalProperties.IconCssClass=ec.Js),ec.B5d&&(Ed.optionalProperties.TaskPaneIconUrl=ec.B5d),ec.KO&&(Ed.optionalProperties.TaskPaneIconId=
ec.KO),ec.onExtensionLaunchCallback&&(Ed.optionalProperties[ih.a.onExtensionLaunchCallback]=ec.onExtensionLaunchCallback));Mh.a.instance.LBa(M,za,Ab,Ic,Ed)}}mdi(M){if(!yi.a.Fj(M)){var za=M[rf.a.yAb];if(za&&(za=za.getId(),M=M[rf.a.Cga],za&&M))return this.yOa(za,M.optionalProperties[ih.a.sourceLocationOverrideResourceId])}return null}yOa(M,za){za=void 0===za?null:za;return M&&za?`${M}.${za}`:M}X4h(M){switch(M){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return f.EwaSettings.Fa(217)?
1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;case 301511274:return 1023;default:return 1}}q7d(){this.$.ea.Gh?this.ZSd():(this.$.ea.el(this.ZSd),this.chb=!0)}Pii(){var M=this.$.ia.Ja(20);if(!M)return this.q7d(),"";M=M.Ona();if(!M)return this.q7d(),"";var za=this.$.ta.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.pa.sheetName:this.$.pa.name);za=bj.d(za);var Ab=bc.h(this.$).ga.ra.selectedRanges;const ec=[];for(const ed of Ab){Ab=new mg.a(ed,za);var Ic=
M.mPa(Ab,tg.Valid);Ab=[];if(Ic)for(const Ed of Ic)(Ic=Ed.table.PD)&&(Ic=Ic.range.toString())&&Ab.push(Ic);Ab=new ri(ed.toString(),Ab);ec.push(Ab)}return JSON.stringify(ec)}}O.lNd="IDS";O.Blf="FA000000012";O.lQa="FA000000005";O.isi="HelloWorld";O.hgh="FA000000014";O.elc="Help.GiveFeedback.Url";O.pmh="Help.ContactSupport.Url";O.BTh="feedback";O.oAf="FA000000066";O.Voj="PowerBi.Url";O.Toj="PowerBi.DevUrl";O.Uoj="FA000000054";O.b1i="FA000000064";O.Fjj="FA000000075";O.B7b="AnalyzeDataTaskPane";O.Jwj="RecommendedChartsTaskPane";
O.Wmj="PivotTableTaskPane";O.yUe=350;O.cnf=320;O.asj=320;O.ocd="FA000000124";O.joh="Copilot (Preview)";O.ioh="CopilotSDXTaskpane";O.Q1g="g_InstallOrigin";Object(k.a)(O,"AgaveCommandManager",Og.a,[733,734]);class Qa extends l.a{constructor(M){super();this.$=M;this.Oe()}create(){const M=this.$.ia,za=gi.GetServiceTaskFactory.create(M,106,this.ma,this.$a),Ab=gi.GetServiceTaskFactory.create(M,104,this.ma,this.$a);$g.TaskExtensions.Aa($g.TaskExtensions.Tg([Ab,za],this.ma),()=>{let ec=null;f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)&&(ec=Pf.a.instance.ie("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);Hi.instance.initialize(za.result);const Ic=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(vj.a)(this.$.ia,374,()=>new O(this.$,za.result,Ab.result,ec,Ze.AFrameworkApplication.Vd)):new O(this.$,za.result,Ab.result,ec,Ze.AFrameworkApplication.Vd);M.Va(206,Ic);this.ve(M.Ja(374)||M.Va(374,Ic))},this.ma,3);Pf.a.instance.register(ph.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Ve().$e(()=>
new ph.a(this.$.QA))}static la(M){M.ia.Va(375,new Qa(M))}}Object(k.a)(Qa,"AgaveCommandManagerFactory",l.a,[]);var mb=a(1238),mc=a(774);class Ac{constructor(){this.Lhe=this.fhe=this.dja=null;this.Gob=0}get displayName(){return this.dja}set displayName(M){this.dja=M}get email(){return this.fhe}set email(M){this.fhe=M}get federationProvider(){return this.Lhe}set federationProvider(M){this.Lhe=M}get identityType(){return this.Gob}set identityType(M){this.Gob=M}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(M){switch(M){case 4:return this.displayName;
case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,za){switch(M){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,
0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,za){M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}static srh(M){const za=new Ac;za.displayName=M.displayName;za.email=M.email;switch(M.authority){case mb.a.nVf:za.identityType=1;break;default:za.identityType=0}za.federationProvider="";return za}}Object(k.a)(Ac,"OfficeIdentityInfo",null,[]);class sd{static get i_e(){return sd.UIg}static h9a(M){return M in sd.i_e?sd.i_e[M].toString():M}}sd.UIg={["GeneralException"]:mc.a.generalException,
["AccessDenied"]:mc.a.k2c,["ApiNotAvailable"]:mc.a.G7b,["UserNotSignedIn"]:mc.a.c$d,["UserAborted"]:mc.a.Alb,["UnsupportedUserIdentity"]:mc.a.tjk,["InvalidResourceUrl"]:mc.a.hab,["InvalidGrant"]:mc.a.Inc,["AddinIsAlreadyRequestingToken"]:mc.a.S1g,["ResourceNotAllowed"]:mc.a.yJj,["ClientError"]:mc.a.Y$b,["ServerError"]:mc.a.serverError};sd.map=null;Object(k.a)(sd,"SingleSignOnErrorCodeMap",null,[]);class yd{constructor(M,za){this.ZXb=M;this.Gob=za}get accessToken(){return this.ZXb}set accessToken(M){this.ZXb=
M}get tokenIdenityType(){return this.Gob}set tokenIdenityType(M){this.Gob=M}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(M){switch(M){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,za){switch(M){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,
0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}
Object(k.a)(yd,"SingleSignOnToken",null,[]);class Od{constructor(){this.mde=null;this.Mse=this.Y2b=this.bH="";this.Zte=!0;this.options=null}get authChallenge(){return this.mde}set authChallenge(M){this.mde=M}get correlationId(){return this.bH}set correlationId(M){this.bH=M}get policy(){return null}set policy(M){}get resource(){return this.Y2b}set resource(M){this.Y2b=M}get scope(){return this.Mse}set scope(M){this.Mse=M}get silentLogin(){return this.Zte}set silentLogin(M){this.Zte=M}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(M){switch(M){case 3:return this.authChallenge;
case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,za){switch(M){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"string");return;case 7:this.correlationId=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}Object(k.a)(Od,"TokenParameters",null,[232]);class Uc{constructor(M,za){this.bnb=za;this.ix=M}get roamingSettings(){return null}getAccessToken(M){const za=this.bnb.getOsfControl(this.ix),
Ab=za.getManifest(),ec=Ab.getMarketplaceID();this.BSa(M,ec);return OfficeExtension.WacRuntime.Utility.createPromise((Ic,ed)=>{za.isFirstParty()&&this.bnb._enableFirstPartySSO?this.tCi(Ab,M)?Pf.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(M,ec).then(Ed=>{Ic(Ed)},Ed=>{ed(Ed)}):ed(mc.a.k2c):ed(mc.a.G7b)}).then(Ic=>{let ed;switch(Ic.authority){case mb.a.nVf:ed=1;break;default:ed=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new yd(Ic.accessToken,
ed))},Ic=>{this.logErrorResponse(M,ec,Ic);return Ic?OfficeExtension.WacRuntime.Utility.createPromise((ed,Ed)=>{Ed(OfficeExtension.WacRuntime.Utility.createRichApiException(Ic,sd.h9a(Ic)))}):OfficeExtension.WacRuntime.Utility.createPromise((ed,Ed)=>{Ed(OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.generalException,sd.h9a(mc.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const M=this.bnb.getOsfControl(this.ix);M.getManifest();const za=M.getManifest().getMarketplaceID();
return OfficeExtension.WacRuntime.Utility.createPromise((Ab,ec)=>{Pf.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(za).then(Ic=>{Ab(Ic)},Ic=>{ec(Ic.toString())})}).then(Ab=>{Ab=Ac.srh(Ab);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Ab)},Ab=>Ab?OfficeExtension.WacRuntime.Utility.createPromise((ec,Ic)=>{Ic(OfficeExtension.WacRuntime.Utility.createRichApiException(Ab,sd.h9a(Ab)))}):OfficeExtension.WacRuntime.Utility.createPromise((ec,Ic)=>
{Ic(OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.generalException,sd.h9a(mc.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(M){switch(M){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){switch(M){case 1:return this.f1h(za);case 3:return this.y2h();case 2:return this.vei()}M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}f1h(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,Od);return this.getAccessToken(M)}y2h(){return this.getAuthContext()}vei(){return this.getPrimaryIdentityInfo()}tCi(M,
za){let Ab=!1;const ec=M.getWebApplicationAuthorizations();M=null;for(const Ic of ec)if(Ic.getResource().toLowerCase()===za.resource.toLowerCase()){M=Ic;Ab=!0;break}if(!Ab)return!1;za=za.scope.split(" ,+");for(const Ic of za)if(Ic&&Ic.length){za=!1;for(const ed of M.getScopes())Ic.toLowerCase()===ed.toLowerCase()&&(za=!0);if(!za)return!1}return!0}BSa(M,za){M=this.dJf(M.resource);t.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:za,["resource"]:M})}logErrorResponse(M,za,Ab){M=this.dJf(M.resource);
t.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:za,["resource"]:M,["error"]:Ab})}dJf(M){return M.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(k.a)(Uc,"AuthenticationService",null,[]);class Dd{create(M,za){return new Uc(M,za)}}Object(k.a)(Dd,"AuthenticationServiceFactory",null,[]);var ye=a(1282);class ie{constructor(){this.context=null;this.errorCode=0}}Object(k.a)(ie,"NestedAppAuthContextResult",null,[]);class ze{static cqd(M,za){const Ab=new ie;(M=M.getOsfControl(za))&&
M.isFirstParty()?(Ab.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,M={},za=Ze.AFrameworkApplication.da.Ra("AADUserObjectId"),M.userObjectId=za?za:Ze.AFrameworkApplication.da.Ra("HostUserId"),M.userPrincipalName=Ze.AFrameworkApplication.da.Ra("UserPrincipalName"),M.tenantId=Ze.AFrameworkApplication.da.Ra("TenantId"),za=(Ze.AFrameworkApplication.da.Ra("HostAuthType")||"").toLowerCase(),M.authorityType="aad"===za?"aad":"msa"===za?"msa":"other",Ab.context=M):Ab.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied;
return Ab}}Object(k.a)(ze,"NestedAppAuthUtil",null,[]);var Ye=a(1024),tf=a(1002);class Qf{}Qf.generalException="generalException";Qf.invalidArgument="invalidArgument";Qf.oIf="notAllowed";Qf.G7b="apiNotAvailable";Qf.$ik="unresolvedPendingRequest";Qf.timeout="timeout";Qf.e3c="adalTimeout";Qf.c$d="userNotSignedIn";Qf.Alb="userAborted";Qf.jlg="silentSignInFailed";Qf.hab="invalidResourceUrl";Qf.Inc="invalidGrant";Qf.EOe="connectionLost";Qf.Y$b="clientError";Qf.serverError="serverError";Object(k.a)(Qf,
"WopiHostErrorCodes",null,[]);var ig=a(527);class df{}Object(k.a)(df,"OAuthCallerMetadata",null,[]);var Nf=a(30);class Mf{constructor(M){this.ZBa=M;this.LIg=Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}XTg(M,za,Ab,ec,Ic,ed){if(!this.ZBa)return ec=new Ye.a,ec.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(ec);const Ed=new df;Ed.AddinName=Ic;Ed.AddinTrustId=ed;let Pd=-1;ed=null;if(ec&&this.stf())ed=this.ZBa.hsg(zb.a.wJc,
M,ec,Mf.Nef(Ic),Ed);else{const Ae=Date.now();ed=this.ZBa.pD(zb.a.wJc,M,Ed).then(Me=>{Pd=Date.now()-Ae;const zf=(za||Ab)&&"login_required"===Me.ErrorCode;return(za&&("interaction_required"===Me.ErrorCode||"consent_required"===Me.ErrorCode||"invalid_grant"===Me.ErrorCode)||zf)&&this.stf()?this.ZBa.hsg(zb.a.wJc,M,null,Mf.Nef(Ic),Ed):Promise.resolve(Me)})}return ed.then(Ae=>{const Me=new Ye.a;Ae.IsSuccess?(Me.token=Ae.Token,Ae.Telemetry&&(Me.CYa=Ae.Telemetry.fromCache,Me.expiresOn=Ae.Telemetry.expiresOn)):
(Me.errorCode=this.OXi(Ae),Me.L5d=this.Ykj(Ae));return Me}).catch(()=>{const Ae=new Ye.a;Ae.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Ae)}).then(Ae=>{Ae.gla="OauthManager";0<=Pd&&(Ae.rDb=Pd);return Ae})}fFi(M){const za=(Ze.AFrameworkApplication.da.Ra(Ze.AFrameworkApplication.$aa)||"").toLowerCase();return(Nf.a.rBa||"teams"===za&&ig.a.GEb)&&!Mf.LEi(M)||!this.ZBa||!this.ZBa.qab()?!1:!0}stf(){return this.LIg||1!==tf.a.wic()}OXi(M){switch(M.ErrorCode){case "UserCancelled":case "interaction_required":M=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;
break;default:M=M.ErrorCode===Qf.Alb?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:M.ErrorCode===Qf.jlg?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:M.ErrorCode===Qf.hab?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:M.ErrorCode===Qf.Inc?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:M.ErrorCode===Qf.EOe?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return M}Ykj(M){let za="";(M=RegExp("AADSTS(\\d+)").exec(M.ErrorMessage))&&
1<M.length&&(za=M[1]);return za}static Nef(M){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,M)}static LEi(M){if(!M)return!1;M=M.toLowerCase();for(const za of ye.a.b6e)if(za===M)return!0;return!1}}Object(k.a)(Mf,"AppsforOfficeTokenFromOauthManager",null,[813]);class Qg{constructor(M){this.UWi=M}static Zsa(){if(Ze.AFrameworkApplication.da.na("AppForOfficeSSOV2IsEnabled")){var M=null;try{M=Pf.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(za){t.ULS.sendTraceTag(592061330,
1300,10,"Unable to resolve IOAuthManager: "+za)}M=new Mf(M);Qg.La=new Qg(M)}}static getInstance(){Qg.Lje||(Qg.Zsa(),Qg.Lje=!0);return Qg.La}}Qg.La=null;Qg.Lje=!1;Object(k.a)(Qg,"AppsForOfficeOauthManagerFactory",null,[807]);var Tg=a(1237),Bh=a(154);class bi{constructor(M,za,Ab,ec){this.menuItemId=M;this.PG=za;this.v9j=Ab;this.iUh=ec}}Object(k.a)(bi,"NewDocumentParameters",null,[]);const ni=M=>{var za=M.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",
3,0);var Ab=za.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Ab.addParameter("shortcuts","String[]",1,null,0);za.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Ab=za.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Ab.addParameter("shortcuts","Object",1,null,0);za=M.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Ab=za.addMethod("GetSharedFilePickerResponse",1,"Object",
1,1,"SharedFilePickerResponse",0);Ab.addParameter("pickerCustomizationJsonString","String",1,null,0);za=M.addType("Microsoft.Office.Auth","{8f3d8395-fba3-422f-9e98-33e38d23c2ba}","{e1b105a8-d9d5-4fc8-aa4e-3d90aeb48abf}",3,2);Ab=za.addMethod("GetAccessTokenFirstPartyOAuth",1,"Object",1,1,"AccessTokenFirstPartyOAuth",4);Ab.addParameter("appName","String",1,null,0);Ab.addParameter("target","String",1,null,0);za=M.addType("Microsoft.Office.AugLoopHostMessageReceivedEventArgs","{52ebe40e-6476-4f8d-81cb-89f5c90e2e76}",
"{891f2f5b-6598-4c8e-af9d-dc48bf34839f}",2,0);za.addProperty("Data",4,"String",1,!1,null,0);za=M.addType("Microsoft.Office.AugLoopEventService","{846cb932-2065-4d2e-b051-5d6673cca2d9}","{019765ca-6d77-447a-9bd8-b07dc47bc657}",3,2);Ab=za.addMethod("SendMessage",1,"Void",0,1,"SendMessage",4);Ab.addParameter("data","String",1,null,0);za.addMethod("_RegisterHostMessageReceivedEvent",2,"Void",0,1,"_RegisterHostMessageReceivedEvent",4);za.addMethod("_UnregisterHostMessageReceivedEvent",3,"Void",0,1,"_UnregisterHostMessageReceivedEvent",
4);za=M.addType("Microsoft.Office.CopilotOperationStartedEventArgs","{45400499-b374-4bc9-a709-18989d9cebd1}","{a7c458d5-f043-4d71-b091-03160b2c450e}",2,0);za.addProperty("BatchId",6,"String",1,!1,null,0);za=M.addType("Microsoft.Office.UndoService","{69f39738-6c6b-4497-9833-02728cf72dc3}","{9628bdd5-9267-4ca8-8162-82d0a7e484f8}",3,2);Ab=za.addMethod("EndCopilotOperation",5,"Void",0,0,"EndCopilotOperation",4);Ab.addParameter("batchId","String",1,null,0);Ab=za.addMethod("StartCopilotOperation",4,"Boolean",
1,0,"StartCopilotOperation",4);Ab.addParameter("batchId","String",1,null,0);za.addMethod("Undo",1,"Boolean",1,0,"Undo",4);za.addMethod("_RegisterUndoStackChangedEvent",2,"Void",0,1,"_RegisterUndoStackChangedEvent",4);za.addMethod("_UnregisterUndoStackChangedEvent",3,"Void",0,1,"_UnregisterUndoStackChangedEvent",4);za=M.addEnumType("Microsoft.Office.UserFeedbackType");za.addEnumField("Like",0);za.addEnumField("Dislike",1);za.addEnumField("Idea",2);za.addEnumField("Unclassified",3);za=M.addEnumType("Microsoft.Office.UserFeedbackUIType");
za.addEnumField("ModalDialog",0);za.addEnumField("Taskpane",1);za=M.addType("Microsoft.Office.UserFeedbackService","{92a3da31-eaf9-4225-b909-6c696483a7fb}","{c6f22ae8-52fa-45d5-a1bf-6b7b67f60f8b}",3,2);Ab=za.addMethod("CollectUserFeedback",1,"Void",0,1,"CollectUserFeedback",4);Ab.addParameter("feedbacktype","Microsoft.Office.UserFeedbackType",1,null,0);Ab.addParameter("UIType","Microsoft.Office.UserFeedbackUIType",1,null,0);Ab.addParameter("featureArea","String",1,null,0);Ab.addParameter("options",
"Object",1,null,0);za.addMethod("_RegisterUserFeedbackUIDismissedEvent",18,"Void",0,1,"_RegisterUserFeedbackUIDismissedEvent",4);za.addMethod("_UnregisterUserFeedbackUIDismissedEvent",19,"Void",0,1,"_UnregisterUserFeedbackUIDismissedEvent",4);za=M.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Ab=za.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Ab.addParameter("base64File","String",1,null,0);za=M.addType("Microsoft.ExcelServices.AppRuntimeService",
"{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);za.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Ab=za.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Ab.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);za=M.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);za.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",
2,!0,null,0);Ab=za.addMethod("Register",1,"Void",0,0,"Register",0);Ab.addParameter("metadata","String",1,null,0);Ab.addParameter("javascript","String",1,null,0);za=M.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);za.addProperty("Enabled",1,"Boolean",1,!1,null,0);za.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);za.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);za=M.addEnumType("Microsoft.Authentication.IdentityType");za.addEnumField("OrganizationAccount",
0);za.addEnumField("MicrosoftAccount",1);za=M.addEnumType("Microsoft.Authentication.AuthorityType");za.addEnumField("External",0);za.addEnumField("Msa",1);za.addEnumField("Aad",2);za=M.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);za.addProperty("DisplayName",4,"String",1,!1,null,0);za.addProperty("Email",3,"String",1,!1,null,0);za.addProperty("FederationProvider",2,"String",1,!1,null,0);za.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);za=M.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);za.addProperty("AppId",4,"String",1,!1,null,0);za.addProperty("Authority",2,"String",1,!1,null,0);za.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);za.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);za.addProperty("TenantId",6,"String",1,!1,null,0);za.addProperty("Upn",
1,"String",1,!1,null,0);za=M.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);za.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Ab=za.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Ab.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);za.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);za.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);za=M.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);za.addProperty("AuthChallenge",3,"String",1,!1,null,0);za.addProperty("CorrelationId",7,"String",1,!1,null,0);za.addProperty("Policy",4,"String",1,!1,null,0);za.addProperty("Resource",2,"String",1,!1,null,0);za.addProperty("Scope",
5,"String",1,!1,null,0);za.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);za=M.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);za.addProperty("AccessToken",2,"String",1,!1,null,0);za.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);za=M.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);za.addProperty("Id",1,"String",1,
!0,null,0);za.addProperty("Value",2,"Object",1,!1,null,0);za=M.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Ab=za.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Ab.addParameter("id","String",1,null,0);Ab=za.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Ab.addParameter("id","String",1,null,0);za=M.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);za.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Ab=za.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Ab.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);za=M.addEnumType("Microsoft.AppRuntime.AppRuntimeState");za.addEnumField("Inactive",0);za.addEnumField("Background",1);za.addEnumField("Visible",2);za=M.addEnumType("Microsoft.AppRuntime.Visibility");
za.addEnumField("Hidden",1);za.addEnumField("Visible",2);za=M.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);za.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Ab=za.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Ab.addParameter("jsonCreate","String",1,null,0);Ab=za.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Ab.addParameter("jsonUpdate",
"String",1,null,0);Ab=za.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Ab.addParameter("id","String",1,null,0);Ab=za.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Ab.addParameter("id","String",1,null,0);za.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);za=M.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);za.addProperty("Id",2,"String",1,!0,null,0);Ab=za.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Ab.addParameter("visibility","Boolean",1,null,0);za.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);za=M.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);za.addProperty("Enabled",3,"Boolean",1,!1,null,0);za.addProperty("Id",2,"String",1,!0,null,0);za.addProperty("Label",4,"String",1,!0,null,0);Ab=za.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Ab.addParameter("enabled","Boolean",1,null,0);za.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);za=M.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);za.addMethod("GetCount",3,"Int32",1,1,"Count",0);Ab=za.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Ab.addParameter("key","String",1,null,0);za.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);za.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);za=M.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");za.addEnumField("Unknown",0);za.addEnumField("Basic",
1);za.addEnumField("Premium",2);za=M.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Ab=za.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Ab.addParameter("feature","String",1,null,0);Ab.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Ab=za.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);Ab.addParameter("feature","String",1,null,0);Ab=za.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Ab.addParameter("feature","String",1,null,0);Ab.addParameter("fallbackValue","Boolean",1,null,0);za.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Ab=za.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Ab.addParameter("experienceId","String",1,null,0);Ab=za.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);Ab.addParameter("feature","String",1,null,0);za=M.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);za.addProperty("Id",5,"String",1,!0,null,0);za.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);za.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);za=M.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
za.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);za=M.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);za.addMethod("Disable",3,"Void",0,1,"Disable",0);za.addMethod("Enable",2,"Void",0,1,"Enable",0);za.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var Kh=a(187);class hi{constructor(M,za){this.dNg=M;this.yNg=za}createAndOpenWorkbook(M){if(M&&
M.length>this.dNg)throw t.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",M.length),OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.invalidArgument,Kh.a.ha(1769));const za=new bi("blank","agave",M?"streamBase64":"streamEmpty",M);let Ab=null;return OfficeExtension.WacRuntime.Utility.createPromise((ec,Ic)=>{const ed=new Bh.StandardDialog;ed.ke=4;ed.fn(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,Ed=>{2===Ed||0===Ed?Ic("Cancelled"):
(Ab=window.open(""),this.yNg.create(ec,Ic,za).$5a())})}).then(ec=>{if(!ec)throw OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.generalException,Kh.a.ha(1765));try{Ab.top.location.href=ec}catch(Ic){t.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",Nf.a.kq,Ic),t.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
Ab.location.replace(ec)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},ec=>{if("Cancelled"===ec)throw OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.oNd,Kh.a.ha(1768));Ab.close();this.Lbk();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){switch(M){case 1:return this.fph(za)}M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}fph(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.createAndOpenWorkbook(M)}Lbk(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.generalException,
Kh.a.ha(1765));}}Object(k.a)(hi,"WacWorkbook",null,[]);const Gg=(M,za)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof M+", objectId="+M+", value="+za);return null},ti=M=>{M.add("InternalTest","PreviewExecutionMethod",Gg)};var Ah=a(263),If=a(772),dg=a(773);class Dg{constructor(M){this.Pd=M}get $(){return this.Pd}}Object(k.a)(Dg,"RichApiPreviewExecutionContext",null,[]);var Yf=a(24),zg=a(1026),hg=a(219),Fg=a(223),Hh=a(140),Wh=a(14);class Li extends Fg.a{constructor(M,
za,Ab,ec,Ic){super(M,"Select Data");this.Xub=null;this.PTe=za;this.$ed=Ab;this.De=Ic;this.callback=ec}get Pe(){return"DdaBindingPrompt"}start(M,za){let Ab="<div class='"+Hh.a.WJh+" "+Gh.a.bB+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Hh.a.hN+"' /></div>";Ab=String.format(Ab,Xf.a.Bm(this.$ed.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.De.dl(this.Ce,Ab);this.Xub=Wh.DOMElementExtensions.getElementById(this.Ce,"bindingText");
M=za?M.d8a(za,this.$ed.DdaBindingsMethod.BindingId):null;(null===M||void 0===M?0:M.IsValidRef)?(za=new Yf.Range(M.Reference.FirstRow+1,M.Reference.FirstColumn+1,M.Reference.LastRow+1,M.Reference.LastColumn+1,!1,!1),this.Xub.value=M.Reference.SheetName+"!"+za):(M=bc.h(this.$).ga,this.Xub.value=bj.f(this.$.pa)||!M.ra.Zj?"":M.kma);this.initialize();this.Zi()}Ys(){this.E$c();this.addButton(0);this.addButton(1);super.Ys()}setFocus(){Wh.DOMElementExtensions.setFocus(this.Xub)}validate(){return!0}commit(){let M=
this.Xub.value.trim();const za=M.indexOf("!");-1!==za&&(M=this.Ehi(M.substring(0,za))+M.substr(za));this.PTe.addBinding(this.$ed,M,0,this.callback);return!0}S4a(){this.PTe.KT.Rj(If.a.internalError,this.callback);super.S4a()}Ehi(M){M=ai.a.trimStart(M.trim(),"=");return M.length?M.startsWith("'")&&M.endsWith("'")?M:da.HelperMethods.pfc(M):""}}Object(k.a)(Li,"DdaBindingPrompt",Fg.a,[]);class zi{constructor(M){this.ea=M}Rj(M,za){if(za){const Ab={};Ab.Error=M;Ab.Version=this.ea.Mg;za(Ab)}}xOa(M,za){this.Rj(M,
za)}DK(M,za){this.Rj(If.a.P7e(M.Errors[0].MessageId),za)}wy(M){M&&M(this.tK())}tK(){const M={Error:0};M.Version=this.ea.Mg;return M}}Object(k.a)(zi,"DdaErrorGenerator",null,[]);var Lh=a(234);class oi{constructor(M,za,Ab){this.$=M;this.KT=za;this.tD=Ab}qId(M,za){const Ab=M.DdaGoToByIdMethod.GoToType,ec=M.DdaGoToByIdMethod.SelectionMode,Ic=M.DdaGoToByIdMethod.Id.toString().trim(),ed=Ed=>{const Pd=this.$.ta.getItemByName(Ed.SheetName);(null===Pd||void 0===Pd?0:Pd.visible)?(bc.h(this.$).Wj(Ed,null,null,
null,3,"DdaNavigator.NavigateTo",void 0,void 0,void 0,void 0,!0),this.KT.wy(za)):this.KT.Rj(If.a.Jeh,za)};0===Ab?this.R0i(Ic,ec,M.DdaMethod.ControlId,ed,za):1===Ab?this.V0i(Ic,ec,ed,za):this.KT.Rj(If.a.qjk,za)}R0i(M,za,Ab,ec,Ic){this.tD.ddaGetBinding(Ab,M,ed=>{if(!Lh.a(ed)&&ed.Result&&ed.Result.Reference){ed=ed.Result;var Ed={};Ed.SheetName=ed.Reference.SheetName;Ed.FirstRow=ed.Reference.FirstRow;Ed.FirstColumn=ed.Reference.FirstColumn;Ed.LastRow=ed.Reference.LastRow;Ed.LastColumn=ed.Reference.LastColumn;
oi.k5c(Ed,za);1!==ed.BindingType?ec(Ed):this.tD.ddaGetBindingData(Ab,M,1,0,2,0,0,-1,-1,Pd=>{Lh.a(Pd)||!Pd.Result?this.KT.DK(Pd,Ic):(Pd=Pd.Result,2!==za&&(Ed.FirstRow-=Pd.Headers.length,0>Ed.FirstRow&&(Ed.FirstRow=0)),ec(Ed))},Ic)}else this.KT.xOa(If.a.Ulg,Ic)},Ic)}V0i(M,za,Ab,ec){var Ic=C.A(M);Ic?(Ic=C.v(Ic,this.$),oi.k5c(Ic,za),Ab(Ic)):this.$.ea.isNamedObjectViewMode&&this.$.ue.Qm(M)?this.$.ue.Sra(this.$.ue.getItemByName(M),"dda"):(Ic=ed=>{Lh.a(ed)||!ed.Result?this.$.ta.contains(M)?(ed={},ed.SheetName=
M,ed.FirstRow=0,ed.FirstColumn=0,ed.LastRow=0,ed.LastColumn=0,Ab(ed)):this.KT.xOa(If.a.Ulg,ec):(ed=ed.Result,oi.k5c(ed,za),Ab(ed))},this.$.ta.pa?this.tD.parseRangeForGoto(M,this.$.ta.pa.name,Ic,ec):this.tD.parseRange(M,Ic,ec))}static k5c(M,za){M.LastRow=2===za?M.FirstRow:M.LastRow;M.LastColumn=2===za?M.FirstColumn:M.LastColumn}}Object(k.a)(oi,"DdaNavigator",null,[]);const Qi=(M,za,Ab,ec,Ic,ed)=>{const Ed=M.Pa(1);Ed.request=za;return Nh.g(M,"ExecuteRichApiRequest",Ed,Ab,ec,Ic,ed,0)};var oh=a(307),
Eh;(function(M){M[M.unsupported=0]="unsupported";M[M.surface=1]="surface";M[M.combo=2]="combo";M[M.column=3]="column";M[M.column3D=4]="column3D";M[M.bar=5]="bar";M[M.bar3D=6]="bar3D";M[M.line=7]="line";M[M.line3D=8]="line3D";M[M.pie=9]="pie";M[M.pie3D=10]="pie3D";M[M.scatter=11]="scatter";M[M.bubble=12]="bubble";M[M.area=13]="area";M[M.area3D=14]="area3D";M[M.doughnut=15]="doughnut";M[M.radar=16]="radar";M[M.stock=17]="stock";M[M.waterfall=18]="waterfall";M[M.funnel=19]="funnel";M[M.treemap=20]="treemap";
M[M.sunburst=21]="sunburst";M[M.boxWhisker=22]="boxWhisker";M[M.histogram=23]="histogram";M[M.pareto=24]="pareto";M[M.regionMap=25]="regionMap";M[M.noVisibleSeries=26]="noVisibleSeries";M[M.complexDataSource=27]="complexDataSource";M[M.pivotChart=28]="pivotChart"})(Eh||(Eh={}));Object(k.b)("ChartCategory",Eh);class Hg{constructor(M,za){this.source=M;this.eventId=za}}Object(k.a)(Hg,"MacroRecorderEventData",null,[]);class Rg{constructor(M,za,Ab){this.parentName=M;this.$=za;this.request=Ab}Xfi(M){var za;
if(void 0===M||null===M||void 0===M.RequestBody||null===M.RequestBody)return null;const Ab=JSON.parse(M.RequestBody);if(void 0!==M.ActiveFloatingObjectId&&null!==M.ActiveFloatingObjectId){Ab.ActiveFloatingObjectId=M.ActiveFloatingObjectId;const ec=bc.h(this.$).ga.Ta.Fe;if(null===(za=null===ec||void 0===ec?void 0:ec.floatingObject)||void 0===za?0:za.Af)Ab.ActiveChartType=Eh[ec.floatingObject.Af.ChartCategory]}void 0!==M.SheetMultiRange&&null!==M.SheetMultiRange&&(Ab.SheetName=M.SheetMultiRange.SheetName);
return Ab}ggi(M){if(void 0===M||null===M||void 0===M.Result||null===M.Result)return null;M=M.Result;return void 0===M.ResponseBody||null===M.ResponseBody||M.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(M.ResponseBody.join(""))}fKi(M){return!!M&&!(void 0===M.eventId||null===M.eventId)&&0<M.eventId.length}xm(M){return()=>{if(this.$.p9){const za=this.Jah(this.request);if(this.fKi(za)){const Ab=this.Xfi(this.request),ec=this.ggi(M);if(Ab&&!yi.a.isEmpty(Ab)&&ec&&!yi.a.isEmpty(ec))return t.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Q(za,Ab,ec);t.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Ab?"(not null)":"(null)"}; responseInfo: ${ec?"(not null)":"(null)"}`}`)}}return new Q(null,null,null)}}Jah(M){const za=this.gKi(M.SolutionId),Ab=Rg.Cfi(M);if(Ab&&za)return t.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Ab,["request.SolutionId"]:M.SolutionId})}`),
new Hg(M.SolutionId,Ab);M=JSON.stringify({["recorderEventId"]:Ab,["isRecorderAwareAddin"]:za,["request.SolutionId"]:M.SolutionId});t.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${M}`);return null}gKi(M){if(!M)return!1;M=M.toLowerCase();return Rg.Tli().contains(M)}static Tli(){Rg.PDa||(Rg.PDa=new J.a(P.a.Ei()),Rg.PDa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Rg.PDa.add("fa000000005"),Rg.PDa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Rg.PDa.add("fa000000014"),Rg.PDa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));
return Rg.PDa}static Cfi(M){let za=null;var Ab=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Ab.test(M.RequestBody))za=Ab.exec(M.RequestBody)[1];else{M=M.RequestHeaders;if(!M)return za;Ab=Qd.a.O3i.toLowerCase();for(let ec=0;ec<M.length;ec++)if(M[ec].Name.toLowerCase()===Ab){za=M[ec].Value;break}}return za}}Rg.PDa=null;Object(k.a)(Rg,"DdaRichApiRequestRecorder",null,[]);class fi extends oh.a{constructor(M,za,Ab,ec,Ic,ed,Ed,Pd){super(10,0,za,Pd);this.Prb=Ab;this.Ynb=
ec;this.L7=Ic;this.MJa=ed;this.request=Ed;this.rXd=new Rg("10",M,Ed)}get WLc(){return this.MJa}get jJ(){return this.Prb}get Qma(){return this.Ynb}b7(M){return super.b7(M)||this.Fdh(M)}xm(){return this.rXd.xm(this.Nf)}ykb(){const M={OperationType:3};M.RichApiRequest=this.request;return M}Fdh(M){return(za,Ab,ec)=>Qi(M,this.request,Hc.b(za,this.Prb),Hc.a(Ab,this.Ynb),ec,this.L7)}}Object(k.a)(fi,"DdaRichApiRequestBatchOperation",oh.a,[]);class ui extends Ta.a{constructor(M,za,Ab,ec){super(576,0,Ab,ec);
this.rXd=new Rg("576",M,za)}xm(){return this.rXd.xm(this.Nf)}}Object(k.a)(ui,"DdaRichApiRequestOperation",Ta.a,[]);class Mi{constructor(M,za){this.CL=(Ab,ec)=>{this.KT.xOa(If.a.internalError,ec)};this.$=M;this.KT=za}ddaAddBinding(M,za,Ab,ec,Ic,ed,Ed){this.iN((Pd,Ae,Me)=>{var zf=this.$.qa.ua,Df=this.vna();Pd=Hc.b(Pd,ed);Ae=Hc.a(Ae,this.CL);const fg=zf.Pa(9);fg.controlId=M;fg.bindingId=za;fg.bindingType=Ab;fg.currentSheetName=Df;fg.formula=ec;fg.options=Ic;return Nh.g(zf,"DdaAddBinding",fg,Pd,Ae,Me,
Ed,0)},Ed,563)}ddaReleaseBinding(M,za,Ab,ec){this.iN((Ic,ed,Ed)=>{var Pd=this.$.qa.ua;Ic=Hc.b(Ic,Ab);ed=Hc.a(ed,this.CL);const Ae=Pd.Pa(9);Ae.controlId=M;Ae.bindingId=za;return Nh.g(Pd,"DdaReleaseBinding",Ae,Ic,ed,Ed,ec,0)},ec,564)}ddaGetBinding(M,za,Ab,ec){this.iN((Ic,ed,Ed)=>{var Pd=this.$.qa.ua;Ic=Hc.b(Ic,Ab);ed=Hc.a(ed,this.CL);const Ae=Pd.Pa(1);Ae.controlId=M;Ae.bindingId=za;return Nh.g(Pd,"DdaGetBinding",Ae,Ic,ed,Ed,ec,0)},ec,565,16)}ddaGetAllBindings(M,za,Ab){this.iN((ec,Ic,ed)=>{var Ed=this.$.qa.ua;
ec=Hc.b(ec,za);Ic=Hc.a(Ic,this.CL);const Pd=Ed.Pa(1);Pd.controlId=M;return Nh.g(Ed,"DdaGetAllBindings",Pd,ec,Ic,ed,Ab,0)},Ab,566,16)}ddaGetBindingData(M,za,Ab,ec,Ic,ed,Ed,Pd,Ae,Me,zf){this.iN((Df,fg,qh)=>{var og=this.$.qa.ua,ch=this.vna();Df=Hc.b(Df,Me);fg=Hc.a(fg,this.CL);const ah=og.Pa(1);ah.controlId=M;ah.bindingId=za;ah.coerceType=Ab;ah.valueFormat=ec;ah.filterType=Ic;ah.startRow=ed;ah.startCol=Ed;ah.rowCount=Pd;ah.colCount=Ae;ah.currentSheetName=ch;return Nh.g(og,"DdaGetBindingData",ah,Df,fg,
qh,zf,0)},zf,567,16)}ddaSetBindingData(M,za,Ab,ec,Ic,ed,Ed){this.iN((Pd,Ae,Me)=>{var zf=this.$.qa.ua,Df=this.vna();Pd=Hc.b(Pd,ed);Ae=Hc.a(Ae,this.CL);const fg=zf.Pa(9);fg.controlId=M;fg.bindingId=za;fg.startRow=Ab;fg.startCol=ec;fg.currentSheetName=Df;fg.bindingData=Ic;return Nh.g(zf,"DdaSetBindingData",fg,Pd,Ae,Me,Ed,0)},Ed,568)}ddaGetSelectedData(M,za,Ab,ec,Ic,ed,Ed){this.iN((Pd,Ae,Me)=>{var zf=this.$.qa.ua,Df=this.vna();Pd=Hc.b(Pd,ed);Ae=Hc.a(Ae,this.CL);const fg=zf.Pa(1);fg.controlId=M;fg.coerceType=
za;fg.valueFormat=Ab;fg.filterType=ec;fg.currentSheetName=Df;fg.formula=Ic;return Nh.g(zf,"DdaGetSelectedData",fg,Pd,Ae,Me,Ed,0)},Ed,569,16)}ddaSetSelectedData(M,za,Ab,ec,Ic){this.iN((ed,Ed,Pd)=>{var Ae=this.$.qa.ua,Me=this.vna();ed=Hc.b(ed,ec);Ed=Hc.a(Ed,this.CL);const zf=Ae.Pa(9);zf.controlId=M;zf.currentSheetName=Me;zf.formula=za;zf.bindingData=Ab;return Nh.g(Ae,"DdaSetSelectedData",zf,ed,Ed,Pd,Ic,0)},Ic,570)}ddaLoadSettings(M,za,Ab){this.iN((ec,Ic,ed)=>{var Ed=this.$.qa.ua;ec=Hc.b(ec,za);Ic=Hc.a(Ic,
this.CL);const Pd=Ed.Pa(1);Pd.controlId=M;return Nh.g(Ed,"DdaLoadSettings",Pd,ec,Ic,ed,Ab,0)},Ab,501,16)}ddaSaveSettings(M,za,Ab,ec,Ic){this.iN((ed,Ed,Pd)=>{var Ae=this.$.qa.ua;ed=Hc.b(ed,ec);Ed=Hc.a(Ed,this.CL);const Me=Ae.Pa(9);Me.controlId=M;Me.settings=za;Me.overwriteIfStale=Ab;return Nh.g(Ae,"DdaSaveSettings",Me,ed,Ed,Pd,Ic,0)},Ic,571)}ddaAddRowsColumns(M,za,Ab,ec,Ic,ed){this.iN((Ed,Pd,Ae)=>{var Me=this.$.qa.ua,zf=this.vna();Ed=Hc.b(Ed,Ic);Pd=Hc.a(Pd,this.CL);const Df=Me.Pa(9);Df.controlId=M;
Df.bindingId=za;Df.isRow=Ab;Df.currentSheetName=zf;Df.bindingData=ec;return Nh.g(Me,"DdaAddRowsColumns",Df,Ed,Pd,Ae,ed,0)},ed,572)}ddaDeleteAllDataValues(M,za,Ab,ec){this.iN((Ic,ed,Ed)=>{var Pd=this.$.qa.ua,Ae=this.vna();Ic=Hc.b(Ic,Ab);ed=Hc.a(ed,this.CL);const Me=Pd.Pa(9);Me.controlId=M;Me.bindingId=za;Me.currentSheetName=Ae;return Nh.g(Pd,"DdaDeleteAllDataValues",Me,Ic,ed,Ed,ec,0)},ec,573)}ddaClearBindingFormats(M,za,Ab,ec){this.iN((Ic,ed,Ed)=>{var Pd=this.$.qa.ua,Ae=this.vna();Ic=Hc.b(Ic,Ab);ed=
Hc.a(ed,this.CL);const Me=Pd.Pa(9);Me.controlId=M;Me.bindingId=za;Me.currentSheetName=Ae;return Nh.g(Pd,"DdaClearBindingFormats",Me,Ic,ed,Ed,ec,0)},ec,574)}ddaSetBindingFormats(M,za,Ab,ec,Ic,ed){this.iN((Ed,Pd,Ae)=>{var Me=this.$.qa.ua,zf=this.vna();Ed=Hc.b(Ed,Ic);Pd=Hc.a(Pd,this.CL);const Df=Me.Pa(9);Df.controlId=M;Df.bindingId=za;Df.currentSheetName=zf;Df.bindingData=Ab;Df.isSetFormats=ec;return Nh.g(Me,"DdaSetBindingFormats",Df,Ed,Pd,Ae,ed,0)},ed,575)}parseRange(M,za,Ab){this.iN((ec,Ic,ed)=>{const Ed=
this.$.qa.ua.ze();return Nh.v(this.$.qa.ua,M,-1,Hc.b(ec,za),Hc.a(Ic,this.CL),ed,Ab,Ed)},Ab,162,16)}parseRangeForGoto(M,za,Ab,ec){this.iN((Ic,ed,Ed)=>{const Pd=this.$.qa.ua.ze();return Nh.w(this.$.qa.ua,M,za,Hc.b(Ic,Ab),Hc.a(ed,this.CL),Ed,ec,Pd)},ec,562,16)}executeRichApiRequest(M,za,Ab){M.RequestFlags&=8191;if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:7867662_RichApiUndoThirdPartyFlight")){var ec=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichApiUndoThirdParty",!1);const Ic=0!==
(M.RequestFlags&128);ec||"sdxcatalog"===M.MarketplaceType||Ic||(M.RequestFlags&=-17)}f.EwaSettings.Fa(233)?this.qSh(this.$.qa.ua.ze(),za,()=>{this.KT.xOa(If.a.internalError,Ab)},Ab,M):(ec=ci.DdaFacade.pqd(M),!this.$.Rd.uB||ec&16?(ec|=64,this.$.userOperationManager.YH(new ui(this.$,M,(Ic,ed,Ed)=>Qi(this.$.qa.ua,M,Hc.b(Ic,za),Hc.a(ed,this.CL),Ed,Ab),ec))):(this.KT.xOa(If.a.$Mc,Ab),t.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed")))}vna(){return this.$.ea.isNamedObjectViewMode?this.$.pa.sheetName:
this.$.activeItemName}iN(M,za,Ab,ec){ec=void 0===ec?0:ec;!this.$.Rd.uB||ec&16?this.$.userOperationManager.YH(new Ta.a(Ab,0,M,ec|64)):(this.KT.xOa(If.a.$Mc,za),t.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}qSh(M,za,Ab,ec,Ic){let ed=ci.DdaFacade.pqd(Ic);if(!this.$.Rd.uB||ed&16){var Ed=this.$.pe.xf("UserAction","Rich Api request");this.$.userOperationManager.enqueueOperation(new fi(this.$,M,za,Ab,ec,Ed,Ic,ed|64),null)}else this.KT.xOa(If.a.$Mc,ec),t.ULS.sendTraceTag(537163158,
0,50,"Write operation is not allowed")}}Object(k.a)(Mi,"DdaWebServiceHelper",null,[]);class Ti{constructor(M,za,Ab,ec){this.YTh=M;this.fileSize=za;this.R5j=ec}}Object(k.a)(Ti,"DocumentFile",null,[]);class vi{}vi.generalException="GeneralException";vi.Q3g="ApiNotFound";vi.oNd="OperationCancelled";vi.invalidArgument="InvalidArgument";Object(k.a)(vi,"ErrorCodes",null,[]);class Sj{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(k.a)(Sj,"WacApiDelegates",null,[]);var Ej=a(634);class wj extends Sj{constructor(M,za){super();this.nwf=(Ab,ec)=>{Ab=wj.ynh(Ab,ec);if(!Ej.a(this.$,Ab))return!0;Ab=this.$.shortcutKeyManager.lgf(Ab);return!!Ab&&0<Ab.length};this.addinId=M;this.$=za}replaceShortcuts(M){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,M,this.nwf)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(M){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(M,
this.nwf)}static ash(M,za){const Ab=document.createEvent("KeyboardEvent");if(Nf.a.DC)Ab.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(M&8),!!(M&32),!!(M&4),!!(M&256));else{const ec=[];M&4&&ec.push("Shift");M&8&&ec.push("Control");M&32&&ec.push("Alt");Ab.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,ec.join(" "),!1,"en-US")}M=new Sys.UI.DomEvent(Ab);M.keyCode=za;return M}static ynh(M,za){if(Nf.a.Zh)switch(za){case 189:za=173;break;case 187:za=61;break;case 186:za=59}return wj.ash(M,
za)}}Object(k.a)(wj,"ExcelWacApiDelegates",Sj,[]);class kj{constructor(M){this.jNa={};this.KYi=M}KVg(M,za){this.Olc(M)||(this.jNa[M]={});if(this.KEi(M))return t.ULS.sendTraceTag(537163157,344,50,`App ${M} has reach the limit of number of cached files.`),If.a.rZi;this.jNa[M][za.YTh.toString()]=za;return If.a.success}i7h(M,za){let Ab=null;this.Olc(M)&&(Ab=this.jNa[M][za.toString()]);Ab||t.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${M}, fileHandler:${za}] doesn't exist`);return Ab}Olc(M){return M in
this.jNa}AAj(M,za){if(this.Olc(M)){const Ab=this.jNa[M];delete Ab[za.toString()];1>Object.keys(Ab).length&&delete this.jNa[M];return za.toString()in Ab?If.a.internalError:If.a.success}return If.a.internalError}KEi(M){return this.Olc(M)?Object.keys(this.jNa[M]).length>=this.KYi:!1}static getInstance(M){return M.ia.Ja(200)||M.ia.Va(200,new kj(kj.LYi))}static E1i(){return++kj.Jch}}kj.kYi=4194304;kj.LYi=1;kj.Jch=0;Object(k.a)(kj,"GetFileApiHelper",null,[]);class Tj{constructor(M){this.ix=M}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.ix)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){switch(M){case 1:return this.n2i()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){M=this.invokeMethod(M,
za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}n2i(){this.notifyActionHandlerReady();return null}}Object(k.a)(Tj,"AddinInternalService",null,[]);class xj{constructor(M,za){this.BJ=za;this.ix=M}getAppRuntimeState(){return this.BJ.getAppRuntimeState(this.ix)?2:1}setAppRuntimeState(M){switch(M){case 2:M=!0;break;case 1:M=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.invalidArgument,Kh.a.ha(1769));}this.BJ.setAppRuntimeState(this.ix,M)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,za){switch(M){case 2:return this.l2h();case 1:return this.uRj(za)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,
za){M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}l2h(){return this.getAppRuntimeState()}uRj(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");this.setAppRuntimeState(M);return null}}Object(k.a)(xj,"AppRuntimeService",null,[]);var bk=a(1027);class ck{constructor(M,za,Ab,ec){this.qA=M;this.N5=Ab;this.WB=ec.Qh.getOsfControl(za)}disable(){try{if(!Kh.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.pQe();
if(!this.Hvf())return this.qQe();this.N5.vik(this.qA)}catch(M){return t.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",M.message||"Unknown"),this.nQe()}return null}enable(){try{if(!Kh.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.pQe();if(!this.Hvf())return this.qQe();this.N5.oyj(this.qA)}catch(M){return t.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
M.message||"Unknown"),this.nQe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,
za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){switch(M){case 1:return this.QGa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){switch(M){case 3:return this.gBh();case 2:return this.nGh()}M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}gBh(){return this.disable()}nGh(){return this.enable()}QGa(){this._OnAccess();return null}pQe(){return bk.a(mc.a.notImplemented,
Kh.a.ha(1770))}qQe(){return bk.a(mc.a.sharedRuntimeNotAvailable,Kh.a.ha(1774))}nQe(){return bk.a(mc.a.generalException,Kh.a.ha(1765))}Hvf(){const M=this.WB.getSharedRuntimeId();return!!M&&0<M.length}}Object(k.a)(ck,"BeforeDocumentCloseNotification",null,[]);class dk{constructor(){this.Bue=this.Coe=this.Xq=!1}get enabled(){return this.Xq}set enabled(M){this.Xq=M}get nativeRuntime(){return this.Coe}set nativeRuntime(M){this.Coe=M}get streamingEnabled(){return this.Bue}set streamingEnabled(M){this.Bue=
M}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(M){switch(M){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,za){switch(M){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(za,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,za){M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}Object(k.a)(dk,"CustomFunctionEngineStatus",null,[]);class Ij{constructor(M,za,Ab){this.lLg=M;this.mLg=za;this.mPg=Ab}get status(){const M=new dk;M.enabled=this.lLg;M.streamingEnabled=this.mLg;M.nativeRuntime=!1;return M}register(M){return OfficeExtension.WacRuntime.Utility.createPromise(this.mPg(M))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(M){switch(M){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){switch(M){case 1:return this.izj(za)}M=this.invokeMethod(M,
za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}izj(M){const za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"string");return this.register(za,M)}}Object(k.a)(Ij,"CustomFunctionManager",null,[]);var ik=a(1001);class jk{constructor(M,za,Ab,ec){this.cee="";this.r_b=0;this.lS=M;this._id=za;this.ix=Ab;this.BJ=ec}get id(){return this._id}_RegisterStateChange(){this.r_b||this.lS.execute(M=>
{this.cee=M.kVa(this._id,za=>{this.BJ.eWh(this.ix,this._id,JSON.stringify(za))})});this.r_b++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.r_b--;this.r_b||this.lS.execute(M=>{M.sTd(this._id,this.cee)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(M){switch(M){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){switch(M){case 6:return this.HEg();case 7:return this.LEg()}M=
this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}HEg(){return this._RegisterStateChange()}LEg(){return this._UnregisterStateChange()}}Object(k.a)(jk,"LicenseFeature",null,[]);class kk{constructor(M,za){this.lS=Pf.a.instance.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.ix=M;this.BJ=za;this.bOg=this.BJ.Qh.getOsfControl(this.ix)}getFeatureTier(M,za){return OfficeExtension.WacRuntime.Utility.createPromise(Ab=>{const ec=1===za?1:2===
za?2:0;this.lS.execute(Ic=>{Ic.getFeatureTier(M,ec).then(ed=>{Ab(this.Tai(ed))},()=>{Ab(za)})})})}getLicenseFeature(M){M=new jk(this.lS,M,this.ix,this.BJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}isFeatureEnabled(M,za){return OfficeExtension.WacRuntime.Utility.createPromise(Ab=>{this.lS.execute(ec=>{ec.isFeatureEnabled(M,za).then(Ic=>{Ab(Ic)},()=>{Ab(za)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(M=>{this.lS.execute(za=>{za=
za.isFreemiumUpsellEnabled();M(za)})})}launchUpsellExperience(M){if(this.bOg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.lS.execute(za=>{za.launchUpsellExperience(M)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.k2c,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,za){switch(M){case 6:return this.JEg(za)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){switch(M){case 2:return this.h8h(za);case 5:return this.Sai(za);
case 1:return this.BFi(za);case 3:return this.rGi();case 4:return this.zQi(za)}M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}h8h(M){const za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"int");return this.getFeatureTier(za,M)}Sai(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getLicenseFeature(M)}BFi(M){const za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"boolean");return this.isFeatureEnabled(za,M)}rGi(){return this.isFreemiumUpsellEnabled()}zQi(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.launchUpsellExperience(M)}JEg(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");this._TestFireStateChangedEvent(M);return null}Tai(M){switch(M){case 1:return 1;case 2:return 2;default:return 0}}}Object(k.a)(kk,"License",
null,[]);var rj=a(186);const tk=(M,za,Ab)=>ec=>(Ic,ed)=>{$g.TaskExtensions.Aa(gi.GetServiceTaskFactory.create(za.ia,279,za.ma,1),Ed=>{Ed=Ed.result;let Pd=!1;var Ae=Ab.Qh.getOsfControl(M);let Me=null;Ae&&(Me=Ae.getStoreType(),(Ae=Ae.getManifest())&&Ae.getSharedRuntimeForCustomFunctions("Workbook")&&(Pd=!0));$g.TaskExtensions.Aa(Ed.$of(M,Me,ec,Pd),zf=>{rj.b(zf)?zf.result?Ic(null):ed(OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.invalidArgument,cg.a.instance.ha(1769))):ed(OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.generalException,
cg.a.instance.ha(1765)))},za.ma,3)},za.ma,3)};class ek{constructor(M){if(!M)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.DGd=M}areShortcutsInUse(M){return OfficeExtension.WacRuntime.Utility.createPromise((za,Ab)=>{this.DGd.checkShortcutsInUse(M).then(ec=>{za(ec)}).catch(ec=>{Ab(ec)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((M,za)=>{this.DGd.getShortcuts().then(Ab=>{M(Ab)}).catch(Ab=>{za(Ab)})})}replaceShortcuts(M){return OfficeExtension.WacRuntime.Utility.createPromise((za,
Ab)=>{this.DGd.replaceShortcuts(M).then(()=>{za(null)}).catch(ec=>{Ab(ec)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,za){switch(M){case 3:return this.E5g(za);case 1:return this.Khi();case 2:return this.wGj(za)}M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}E5g(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"Array<string>");return this.areShortcutsInUse(M)}Khi(){return this.getShortcuts()}wGj(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"any");return this.replaceShortcuts(M)}}Object(k.a)(ek,"ActionService",
null,[]);class lk{constructor(){this.data=null}}Object(k.a)(lk,"AugLoopHostMessageReceivedEventArgs",null,[]);var Uj=a(1028);class Mj{constructor(M,za,Ab){this.Cba=M;this.Uba=void 0===za?!1:za;this.OHa=(void 0===Ab?null:Ab)||OfficeExtension.WacRuntime.RichApi.getEventManager()}sendMessage(M){this.Uba||Uj.a.ZPj(M)}_RegisterHostMessageReceivedEvent(){this.Uba||(Mj.Y3f||(Uj.a.Zyj(M=>{this.OHa.fireEvent("",65542,Object.assign(new lk,{data:M}))}),Mj.Y3f=!0),this.OHa.register(this.Cba,"",65542))}_UnregisterHostMessageReceivedEvent(){this.Uba||
this.OHa.unregister(this.Cba,"",65542)}getTypeName(){return"Microsoft.Office.AugLoopEventService"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,
za){switch(M){case 1:return this.NPj(za);case 2:return this.GEg();case 3:return this.KEg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}NPj(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");this.sendMessage(M);return null}GEg(){this._RegisterHostMessageReceivedEvent();return null}KEg(){this._UnregisterHostMessageReceivedEvent();
return null}}Mj.Y3f=!1;Object(k.a)(Mj,"AugLoopEventService",null,[]);var uk=a(807),fk=a(528);class Jj{constructor(M,za,Ab){this.QXc=this.Bie=null;this.Cba=M;this.Rpe=za;if(this.Qa=Ab)this.Bie=this.Qa.Ra("GetAccessTokenOAuthFirstPartyAllowList")}Oci(){this.QXc||(this.QXc=fk.a.Ar(Pf.a.instance.ie("Common.App.OAuth.IOAuthManager")));return this.QXc}DGi(M,za){if(!this.Rpe||""===this.Cba||!this.Qa)return!1;const Ab=this.Rpe.getOsfControl(this.Cba);if(!Ab)return!1;let ec=!1;this.Bie.split(";").forEach(Ic=>
{za===Ic&&(ec=!0)});return this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)&&1===Ze.AFrameworkApplication.sa.Sa.Hj&&Ab.isFirstParty()&&M===Jj.m3g&&ec&&sf.d(Ab.getSolutionId())===Jj.n3g}getAccessTokenFirstPartyOAuth(M,za){let Ab;Ab=this.DGi(M,za)?ec=>{const Ic=this.Oci();Ic.continueWith(()=>{Ic.result.pD(M,za).then(ed=>{ec(ed);return ed})})}:ec=>{ec(Object.assign(new uk.a,{IsSuccess:!1,Token:null,ErrorCode:"NotEnabled",ErrorMessage:"OAuthManager is disabled."}))};return OfficeExtension.WacRuntime.Utility.createPromise(Ab)}getTypeName(){return"Microsoft.Office.Auth"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){switch(M){case 1:return this.e1h(za)}M=this.invokeMethod(M,
za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}e1h(M){const za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"string");return this.getAccessTokenFirstPartyOAuth(za,M)}}Jj.m3g="Maker";Jj.n3g="fa000000043";Object(k.a)(Jj,"Auth",null,[]);class Nj{constructor(){this.Ava=null}vhi(){this.Ava||(this.Ava=fk.a.Ar(Pf.a.instance.ie("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Ava}getSharedFilePickerResponse(M){return OfficeExtension.WacRuntime.Utility.createPromise((za,
Ab)=>{try{const ec=this.vhi();Vc.Task.WAA.call(null,ec).continueWith(()=>{const Ic=ec.result;if(Ic){let ed={};(()=>{let Ed=yg.d(M);({Ft:ed}=Ed);return Ed})().returnValue?Ic.Qod(ed).then(Ed=>{Ed&&0<Ed.length?za(Ed):Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(Ed=>{Ab(Ed)}):Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(ec){Ab(ec)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,za){switch(M){case 1:return this.uhi(za)}M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}uhi(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getSharedFilePickerResponse(M)}}Object(k.a)(Nj,"SharedFilePicker",null,[]);class mk{createInstance(M,za,Ab,ec,Ic){Ab=void 0===Ab?"":Ab;ec=void 0===ec?null:ec;Ic=void 0===Ic?null:Ic;switch(M){case "Microsoft.Office.ActionService":return new ek(za);case "Microsoft.Office.SharedFilePicker":return new Nj;
case "Microsoft.Office.Auth":return new Jj(Ab,ec,Ic);case "Microsoft.Office.AugLoopEventService":return new Mj(Ab)}return null}}Object(k.a)(mk,"WacApiHost",null,[]);class Vj{constructor(){this.isFeedbackSent=!1}}Object(k.a)(Vj,"UserFeedbackUIDismissedEventArgs",null,[]);var Wj=a(190),nk=a(224);class Xj{constructor(M,za,Ab,ec){this.Cba=M;this.UHg=za;this.Uba=void 0===Ab?!1:Ab;this.OHa=(void 0===ec?null:ec)||OfficeExtension.WacRuntime.RichApi.getEventManager()}onDismiss(M){this.OHa.fireEvent("",65546,
Object.assign(new Vj,{isFeedbackSent:M}))}onError(){}Sci(M){switch(M){case 0:return"Smile";case 1:return"Frown";case 2:return"Idea";case 3:return"Unclassified";default:return"Unclassified"}}Tci(M){switch(M){case 0:return"Modal";case 1:return"SidePane";default:return"Modal"}}Rci(M){const za={};za.isScenarioEnabled=M.isScenarioEnabled;za.scenarioType=M.scenarioType;if(M=M.question){const Ab={};Ab.questionUiType=M.questionUIType;Ab.questionUiBehavior=M.questionUIBehavior;Ab.questionInstruction=M.questionInstruction;
Ab.questionOptions=M.questionOptions;za.questionDetails=Ab}return za}o6b(M,za,Ab){"True"===Ab?M[za]=!0:"False"===Ab&&(M[za]=!1)}collectUserFeedback(M,za,Ab,ec){if(!this.Uba){const Ic={};Ze.AFrameworkApplication.da.r3c(Ic);const ed=this.UHg.getContext(Ic);ed.initialFeedbackType=this.Sci(M);ed.uiType=this.Tci(za);ed.telemetryGroup.featureArea=Ab;ec.v2Config.contextDataFiles&&(ed.isShareContextDataEnabled=!0,ed.getContextData=()=>Promise.all(nk.a.map(ec.v2Config.contextDataFiles,Ed=>window.fetch("data:application/octet-stream;base64,"+
Ed.base64Data).then(Pd=>Pd.blob()).then(Pd=>new File([Pd],Ed.fileName,{type:Ed.fileType})))));(M=ec.v2Config.scenarioConfig)&&(ed.scenarioConfig=this.Rci(M));this.o6b(ed,"showEmailAddress",ec.v2Config.isEmailCollectionEnabled);this.o6b(ed,"isFileUploadEnabled",ec.v2Config.isFileUploadEnabled);this.o6b(ed,"screenshot",ec.v2Config.isScreenshotEnabled);this.o6b(ed,"isThankYouPageDisabled",ec.v2Config.isThankYouPageDisabled);Wj.UISurfaces.Vdf().then(Ed=>{Ed.initializeFeedbackModal(ed,Object(Sc.a)(this,
this.onDismiss,"onDismiss"),Object(Sc.a)(this,this.onError,"onError"));return Ed})}}_RegisterUserFeedbackUIDismissedEvent(){this.Uba||this.OHa.register(this.Cba,"",65546)}_UnregisterUserFeedbackUIDismissedEvent(){this.Uba||this.OHa.unregister(this.Cba,"",65546)}getTypeName(){return"Microsoft.Office.UserFeedbackService"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,za){this.invokePropertySet(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,za){switch(M){case 1:return this.Bjh(za);case 18:return this.IEg();case 19:return this.MEg()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,za){M=this.invokeMethod(M,za);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}Bjh(M){const za=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
0,"int"),Ab=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"int"),ec=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,2,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,3,"object");this.collectUserFeedback(za,Ab,ec,M);return null}IEg(){this._RegisterUserFeedbackUIDismissedEvent();return null}MEg(){this._UnregisterUserFeedbackUIDismissedEvent();return null}}Object(k.a)(Xj,"UserFeedbackService",null,[]);class Pj{constructor(M,za,Ab,ec,Ic){this.Y4b=null;
this.tYb=M;this.ix=za;this.BJ=Ab;this.Pd=ec;this.uwe=Ic}hostName(){return"ExcelOnline"}appId(){return this.tYb}createInstance(M){switch(M){case "Microsoft.Authentication.AuthenticationService":return Pf.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.ix,this.BJ.Qh);case "Microsoft.Authentication.TokenParameters":return new Od;case "Microsoft.ExcelServices.CustomFunctionManager":M=f.EwaSettings.Fa(114);var za=f.EwaSettings.Fa(115);return new Ij(M,
za,tk(this.tYb,this.Pd,this.BJ));case "Microsoft.AppRuntime.AppRuntimeService":return new xj(this.ix,this.BJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return M=Ah.a(this.Pd),new ck(this.tYb,this.ix,M,this.BJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return M=Ah.a(this.Pd),new ik.DynamicRibbon(this.tYb,this.ix,this.BJ,M,M.$o(this.ix).un);case "Microsoft.Office.Licensing.License":return new kk(this.ix,this.BJ);case "Microsoft.InternalService.AddinInternalService":return new Tj(this.ix);
case "Microsoft.Office.AugLoopEventService":const Ab=Ah.a(this.Pd),ec=Ab.$o(this.ix).un;za=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===ec.PrimaryMarketplace.SolutionId&&f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.AugLoopEventServiceDevBypass",!1)&&("TestHost"===this.Pd.xa.DocumentHostInfo.HostTier||"Dogfood"===Ze.AFrameworkApplication.Ge.AudienceGroup);if(wc.a(ec)||za())return M=Ed=>(Pd,Ae,Me)=>{Ab.Ij.dtd({actionType:Ed,controlId:Pd,messageType:Me,targetId:Ae,message:""})},
M={register:M(1),unregister:M(2),fireEvent:(Ed,Pd,Ae)=>{Ab.Ij.$K(Pd,Ed)&&Ab.cG(Pd,Ed,JSON.stringify(Ae))}},new Mj(this.ix,!1,M);break;case "Microsoft.Office.UserFeedbackService":const Ic=Ah.a(this.Pd),ed=Ic.$o(this.ix).un;za=()=>"9202c06a-b7d3-466f-9adb-acad75789dbc"===ed.PrimaryMarketplace.SolutionId&&f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.UserFeedbackServiceDevBypass",!1)&&("TestHost"===this.Pd.xa.DocumentHostInfo.HostTier||"Dogfood"===Ze.AFrameworkApplication.Ge.AudienceGroup);
if(wc.a(ed)||za())return M=Ed=>(Pd,Ae,Me)=>{Ic.Ij.dtd({actionType:Ed,controlId:Pd,messageType:Me,targetId:Ae,message:""})},M={register:M(1),unregister:M(2),fireEvent:(Ed,Pd,Ae)=>{Ic.Ij.$K(Pd,Ed)&&Ic.cG(Pd,Ed,JSON.stringify(Ae))}},new Xj(this.ix,Pf.a.instance.resolve("Common.App.ICustomerFeedbackUiWrapper"),!1,M);break;default:if(this.Y4b||(this.Y4b=new mk),Ze.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthManagerAPI",!1)){if(za=this.Y4b.createInstance(M,this.uwe,
this.ix,this.BJ.Qh,Ze.AFrameworkApplication.da))return za}else if(za=this.Y4b.createInstance(M,this.uwe))return za}t.ULS.sendTraceTag(537163155,0,10,`Typename: ${M} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(mc.a.generalException,mc.a.generalException);}}Object(k.a)(Pj,"RichApiHost",null,[]);var Yj=a(396),Qj=a(32),ok=a(137),gk=a(38),hk=a(109),pk=a(297),vk=a(46),Zj=a(262),qk=a(7),rk=a(74);class Bg{constructor(M,
za,Ab,ec){this.De=this.rangePicker=null;this.$=M;this.jg=za;this.De=ec;this.Ug=new zi(M.ea);this.tD=new Mi(M,this.Ug);this.QHf=Ab;this.vgc=new Map}get KT(){return this.Ug}dispose(){this.$=this.vgc=null}hf(){return!1}mf(){return!1}executeCommand(M,za,Ab){M=za.command;switch(M){case 451041795:this.Ug.Rj(Ab[ei.a.di],Ab[ei.a.L7]);break;case 974713501:this.Loi(Ab[ei.a.di],Ab[ei.a.L7]);break;case 1237877382:this.Ug.wy(Ab[ei.a.L7]);break;default:return Ha.a(M)}return Vc.Task.Ua(!0)}Ue(M,za,Ab){if(M=!!Ab)switch(za.command){case 974713501:case 1237877382:case 451041795:break;
default:M=!1}return M}Loi(M,za){var Ab;const ec=M.DdaMethod;"undefined"===typeof ec.DispatchId?this.Ug.Rj(If.a.internalError,za):Bg.AEi(M)||this.$.hg&1?(ec.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new Li(this.$,this,M,za,this.De)).start(this.jg,M.DdaMethod.ControlId):ec.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.Tgi(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.mWj(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(M,this.iod(M.DdaMethod.ControlId),0,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.T2h(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.FRj(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.S2h(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.zAj(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.P1h(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.DEd(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(M.DdaAddRowsColumns.IsRow=!0,this.hze(M,za)):ec.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(M.DdaAddRowsColumns.IsRow=!1,this.hze(M,za)):ec.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.Lyh(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.yhh(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(M.DdaSetBindingFormats.IsSetFormats=!0,this.Ldg(M,za)):ec.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(M.DdaSetBindingFormats.IsSetFormats=!1,this.Ldg(M,za)):ec.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(M,M.DdaBindingsMethod.ItemName,M.DdaBindingsMethod.FailOnCollision?2:1,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.n8h(za):ec.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.qId(M,za):ec.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.f7h(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.g7h(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.BAj(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(M.DdaMethod.ControlId,M),this.Ug.wy(za)):
ec.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?this.MZi(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?this.JZi(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidGetNestedAppAuthContextMethod?this.cqd(M,za):ec.DispatchId===OSF.DDA.MethodDispId.dispidExecuteFeature?this.executeFeature(M,
za):ec.DispatchId===OSF.DDA.MethodDispId.dispidQueryFeature?this.queryFeature(M,za):this.Ug.Rj(If.a.tNd,za),f.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&ec.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(M=this.jg.iY(M.DdaMethod.ControlId),za="",M&&(za=ci.DdaFacade.getSolutionId(M,this.$),za=Telemetry.PrivacyRules.GetPrivacyCompliantId(za,M.OwnerAddinStoreType||M.PrimaryMarketplace.MarketplaceType,null===(Ab=M.AssetMarketplace)||
void 0===Ab?void 0:Ab.SolutionId,null,null,M.PrimaryMarketplace.MarketplaceRef)),t.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${ec.DispatchId}, AppID: ${za}`))):this.Ug.Rj(If.a.WWe,za)}T2h(M,za){M.DdaGetBindingData.CoerceType=Bg.iac(M.DdaGetBindingData.CoerceType);M.DdaGetBindingData.FilterType=Bg.q5e(M.DdaGetBindingData.FilterType);M.DdaGetBindingData.ValueFormat=Bg.Lxg(M.DdaGetBindingData.ValueFormat);if(this.xrc(M.DdaGetBindingData.CoerceType,za)){if(M.DdaGetBindingData){const Ab=M.DdaGetBindingData;
0===Ab.FilterType&&(Ab.FilterType=2);Ab.StartCol|=0;Ab.StartRow|=0;Ab.ColCount=void 0===Ab.ColCount?-1:Ab.ColCount;Ab.RowCount=void 0===Ab.RowCount?-1:Ab.RowCount}this.tD.ddaGetBindingData(M.DdaMethod.ControlId,M.DdaGetBindingData.BindingId,M.DdaGetBindingData.CoerceType,M.DdaGetBindingData.ValueFormat,M.DdaGetBindingData.FilterType,M.DdaGetBindingData.StartRow,M.DdaGetBindingData.StartCol,M.DdaGetBindingData.RowCount,M.DdaGetBindingData.ColCount,Ab=>{if(Lh.a(Ab)||!Ab.Result)this.Ug.DK(Ab,za);else{const ec=
this.Ug.tK();ec.Data=Bg.EHe(Ab.Result);za(ec)}},za)}}FRj(M,za){M.DdaSetBindingData.CoerceType=Bg.iac(M.DdaSetBindingData.CoerceType);if(this.xrc(M.DdaSetBindingData.CoerceType,za)){var Ab=Bg.p8c(M.DdaSetBindingData.CoerceType,M.DdaSetBindingData.Data);Bg.foc(Ab)?this.Ug.Rj(If.a.KKc,za):(1===Ab.CoerceType&&(Ab.CellFormat||(Ab.CellFormat=M.DdaSetBindingData.CellFormat),Ab.TableOptions||(Ab.TableOptions=M.DdaSetBindingData.TableOptions)),M.DdaSetBindingData&&(M.DdaSetBindingData.StartCol|=0,M.DdaSetBindingData.StartRow|=
0),this.tD.ddaSetBindingData(M.DdaMethod.ControlId,M.DdaSetBindingData.BindingId,M.DdaSetBindingData.StartRow,M.DdaSetBindingData.StartCol,Ab,ec=>{Lh.a(ec)?this.Ug.DK(ec,za):this.Ug.wy(za)},za))}}Tgi(M,za){M.DdaGetBindingData.CoerceType=Bg.iac(M.DdaGetBindingData.CoerceType);M.DdaGetBindingData.ValueFormat=Bg.Lxg(M.DdaGetBindingData.ValueFormat);M.DdaGetBindingData.FilterType=Bg.q5e(M.DdaGetBindingData.FilterType);if(this.xrc(M.DdaGetBindingData.CoerceType,za)){var Ab=this.iod(M.DdaMethod.ControlId);
Ab?this.tD.ddaGetSelectedData(M.DdaMethod.ControlId,M.DdaGetBindingData.CoerceType,M.DdaGetBindingData.ValueFormat,M.DdaGetBindingData.FilterType,Ab,ec=>{if(Lh.a(ec))this.Ug.DK(ec,za);else{const Ic=this.Ug.tK();Ic.Data=Bg.EHe(ec.Result);za(Ic)}},za):this.Ug.Rj(If.a.Vff,za)}}f7h(M,za){const Ab=M[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],ec=M[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Ic=M.DdaMethod.ControlId,ed=kj.getInstance(this.$);if(0>=ec)t.ULS.sendTraceTag(537163221,
344,15,"Invalid slice size. It should be greater than 0."),this.Ug.Rj(If.a.KAi,za);else if(ec>kj.kYi)t.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Ug.Rj(If.a.paf,za);else{var Ed=null;switch(Ab){case 1:Ed="Compressed";break;case 0:Ed="Text";break;case 2:Ed="Pdf";break;default:t.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Ab} is not supported.`);this.Ug.Rj(If.a.d5e,za);return}if("Text"===Ed)t.ULS.sendTraceTag(537163218,344,15,`Requested file type ${Ed} is not supported.`),
this.Ug.Rj(If.a.d5e,za);else{f.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(M=new Sys.StringBuilder,M.append(zg.a(this.$,Ed)),"Pdf"===Ed&&hg.a.Zp(M,Qd.a.Z_f,"WholeWorkbook"),M=M.toString()):M=zg.a(this.$,Ed);var Pd=null,Ae=new XMLHttpRequest;Ae.onreadystatechange=()=>{if(4===Ae.readyState)if(200===Ae.status){var Me=Ae.response;if(Me){Pd=new Uint8Array(Me);Me=this.Ug.tK();var zf=Pd.length,Df=kj.E1i(),fg={},qh=0;for(let og=0;og<zf;og+=ec){const ch=[],
ah=og+ec<zf?og+ec:zf;for(let Ch=0,Qh=og;Qh<ah;Ch++,Qh++)ch[Ch]=Pd[Qh];fg[(qh++).toString()]=ch}fg=new Ti(Df,zf,ec,fg);fg=ed.KVg(Ic,fg);fg!==If.a.success?this.Ug.Rj(fg,za):(Me[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Df,Me[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=zf,t.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${Ed}, the file size is ${zf}`),za(Me))}else t.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${Ed}.`),
this.Ug.Rj(If.a.internalError,za)}else 500===Ae.status?this.Ug.Rj(If.a.P7e(parseInt(Ae.statusText,10)),za):(t.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${Ed}.`),this.Ug.Rj(If.a.k1i,za))};Ae.open("GET",M,!0);Ae.responseType="arraybuffer";Ae.setRequestHeader("If-Modified-Since","0");Ae.send(null)}}}g7h(M,za){var Ab=M[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],ec=M[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];M=M.DdaMethod.ControlId;(Ab=
kj.getInstance(this.$).i7h(M,Ab))?(Ab=Ab.R5j,0>ec||ec>=Object.keys(Ab).length?this.Ug.Rj(If.a.avi,za):(ec=Ab[ec.toString()],Ab=this.Ug.tK(),Ab[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=ec,Ab[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=ec.length,za(Ab))):this.Ug.Rj(If.a.internalError,za)}BAj(M,za){var Ab=M[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];M=M.DdaMethod.ControlId;Ab=kj.getInstance(this.$).AAj(M,Ab);Ab===If.a.success?this.Ug.wy(za):this.Ug.Rj(Ab,
za)}mWj(M,za){M.DdaSetBindingData.CoerceType=Bg.iac(M.DdaSetBindingData.CoerceType);if(this.xrc(M.DdaSetBindingData.CoerceType,za)){var Ab=this.iod(M.DdaMethod.ControlId);if(Ab){var ec=Bg.p8c(M.DdaSetBindingData.CoerceType,M.DdaSetBindingData.Data),Ic=bc.h(this.$).ga;1===ec.CoerceType&&(!ec.Data&&Ic.ra.FU&&(ec.Headers||(ec.Headers=[]),ec.Headers.length||ec.Headers.push([]),ec.Headers[0].length||ec.Headers[0].push("")),Bg.foc(ec)||(ec.CellFormat||(ec.CellFormat=M.DdaSetBindingData.CellFormat),ec.TableOptions||
(ec.TableOptions=M.DdaSetBindingData.TableOptions)));if(Bg.foc(ec))this.Ug.Rj(If.a.KKc,za);else{var ed=Ic.ra.Ef.clone(),Ed=Ic.ra.activeCell.clone();this.tD.ddaSetSelectedData(M.DdaMethod.ControlId,Ab,ec,Pd=>{var Ae;if(Lh.a(Pd))this.Ug.DK(Pd,za);else{Pd=ed.clone();const Me=ec.Headers?ec.Headers[0].length:ec.Data[0].length;1!==ec.CoerceType||ec.Data?1===ec.CoerceType&&(null===(Ae=ec.TableOptions)||void 0===Ae?0:Ae.length)&&0==ec.TableOptions[0]?(Pd.top+=1,Pd.bottom=Pd.top+ec.Data.length-1):Pd.bottom=
Pd.top+ec.Data.length-(1===ec.CoerceType?0:1):Pd.bottom=Pd.top+1;Pd.right=Pd.left+Me-1;Ae=Pd.contains(Ed)?Ed:Pd.topLeft;Ic.updateSelection(Pd,Ae,0);this.Ug.wy(za)}},za)}}else this.Ug.Rj(If.a.ZJe,za)}}addBinding(M,za,Ab,ec){za?this.tD.ddaAddBinding(M.DdaMethod.ControlId,M.DdaBindingsMethod.BindingId,M.DdaBindingsMethod.BindingType,za,Ab,Ic=>{if(Lh.a(Ic))this.Ug.DK(Ic,ec);else{const ed=this.Ug.tK();ed.Bindings=Array(1);ed.Bindings[0]=this.jg.G8b(Ic.Result);ec(ed)}},ec):this.Ug.Rj(If.a.TOj,ec)}S2h(M,
za){this.tD.ddaGetBinding(M.DdaMethod.ControlId,M.DdaBindingsMethod.BindingId,Ab=>{if(Lh.a(Ab)||!Ab.Result)this.Ug.DK(Ab,za);else{const ec=this.Ug.tK();ec.Bindings=Array(1);ec.Bindings[0]=this.jg.G8b(Ab.Result);za(ec)}},za)}n8h(M){const za=this.Ug.tK(),Ab={};Ab[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;za[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Ab;M(za)}zAj(M,za){this.tD.ddaReleaseBinding(M.DdaMethod.ControlId,M.DdaBindingsMethod.BindingId,
Ab=>{Lh.a(Ab)?this.Ug.DK(Ab,za):this.Ug.wy(za)},za)}P1h(M,za){this.tD.ddaGetAllBindings(M.DdaMethod.ControlId,Ab=>{if(Lh.a(Ab))this.Ug.DK(Ab,za);else{const ec=this.Ug.tK();if(Ab.Result){Ab=Ab.Result;ec.Bindings=Array(Ab.length);for(let Ic=0;Ic<Ab.length;Ic++)ec.Bindings[Ic]=this.jg.G8b(Ab[Ic])}else ec.Bindings=null;za(ec)}},za)}DEd(M,za){this.tD.ddaLoadSettings(M.DdaMethod.ControlId,Ab=>{if(Lh.a(Ab))this.Ug.DK(Ab,za);else{const ec=this.Ug.tK();ec.Properties=Ab.Result;za(ec)}},za)}saveSettings(M,za){const Ab=
{Settings:[]};for(let ec=0;ec<M.DdaSettingsMethod.Properties.length;ec++){const Ic={};Ic.Name=M.DdaSettingsMethod.Properties[ec][0];Ic.Value=M.DdaSettingsMethod.Properties[ec][1];Ab.Settings[ec]=Ic}this.tD.ddaSaveSettings(M.DdaMethod.ControlId,Ab,M.DdaSettingsMethod.OverwriteIfStale,ec=>{Lh.a(ec)?this.Ug.DK(ec,za):this.Ug.wy(za)},za)}hze(M,za){const Ab=Bg.p8c(1,M.DdaAddRowsColumns.Data);Bg.foc(Ab)?this.Ug.Rj(If.a.KKc,za):this.tD.ddaAddRowsColumns(M.DdaMethod.ControlId,M.DdaAddRowsColumns.BindingId,
M.DdaAddRowsColumns.IsRow,Ab,ec=>{Lh.a(ec)?this.Ug.DK(ec,za):this.Ug.wy(za)},za)}Lyh(M,za){this.tD.ddaDeleteAllDataValues(M.DdaMethod.ControlId,M.DdaBindingsMethod.BindingId,Ab=>{Lh.a(Ab)?this.Ug.DK(Ab,za):this.Ug.wy(za)},za)}yhh(M,za){this.tD.ddaClearBindingFormats(M.DdaMethod.ControlId,M.DdaClearBindingFormats.BindingId,Ab=>{Lh.a(Ab)?this.Ug.DK(Ab,za):this.Ug.wy(za)},za)}Ldg(M,za){const Ab={},ec=M.DdaSetBindingFormats.IsSetFormats;ec?Ab.CellFormat=M.DdaSetBindingFormats.CellFormat:Ab.TableOptions=
M.DdaSetBindingFormats.TableOptions;this.tD.ddaSetBindingFormats(M.DdaMethod.ControlId,M.DdaSetBindingFormats.BindingId,Ab,ec,Ic=>{Lh.a(Ic)?this.Ug.DK(Ic,za):this.Ug.wy(za)},za)}executeRichApiRequest(M,za){var Ab;const ec=M.ArrayData,Ic={},ed=bc.h(this.$).ga;if(ec){if("WacPartition"===ec[0]){this.TRh(M,za);return}const Df=Object(ca.a)(ci.DdaFacade,Ah.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===ec[0]){var Ed=Df.$o(M.DdaMethod.ControlId);Ed&&(Ed.bqc=!0,Ed.m_f())}Ic.HttpMethod=ec[1];
Ic.PathAndQuery=ec[2];Ic.RequestHeaders=Bg.Ubf(ec[3]);Ic.RequestBody=ec[4];Ic.AppPermission=ec[5];Ed=ec[6];Ic.RequestFlags=Ed;var Pd=0;if(bj.i(this.$.pa))switch(ed.eh){case 1:Pd=2;break;case 2:Pd=3;break;case 64:Pd=16;break;case 128:Pd=4;break;default:Pd=1}var Ae=null;ed.Ta.XD&&(Ae=ed.Ta.XD.Xl);Ic.SheetMultiRange=C.r(ed.ra.selectedRanges,this.$);Ic.ActiveCell=C.v(ed.ra.activeCell,this.$);Ic.ActiveFloatingObjectId=Ae;Ic.SelectionState=Pd;Pd=this.jg.iY(M.DdaMethod.ControlId);Ic.InstanceId=Pd?Pd.InstanceId:
"";if(Pd&&Pd.PrimaryMarketplace){let fg;if(Pd.PrimaryMarketplace.MarketplaceType!==OSF.StoreType.InMemory)fg=Pd.PrimaryMarketplace.SolutionId,Ae=Pd.PrimaryMarketplace.MarketplaceType;else{if(!Pd.OwnerAddinSolutionId){t.ULS.sendTraceTag(512325018,344,10,"executeRichApiRequest: No OwnerAddinSolutionId for AppCommand");this.Ug.Rj(If.a.FFb,za);return}if(!Pd.OwnerAddinStoreType){t.ULS.sendTraceTag(512325017,344,10,"executeRichApiRequest: No OwnerAddinStoreType for AppCommand");this.Ug.Rj(If.a.FFb,za);
return}fg=Pd.OwnerAddinSolutionId;Ae=Pd.OwnerAddinStoreType}let qh=Telemetry.PrivacyRules.GetPrivacyCompliantId(fg,Ae,null===(Ab=Pd.AssetMarketplace)||void 0===Ab?void 0:Ab.SolutionId,null,null,Pd.PrimaryMarketplace.MarketplaceRef);Ic.CompliantSolutionId=qh;Ic.SolutionId=fg;Ic.MarketplaceType=Ae;Ic.SolutionVersion=Pd.PrimaryMarketplace.SolutionVersion;Ic.StoreLocation=Pd.PrimaryMarketplace.MarketplaceRef}else Ic.SolutionId=Ic.MarketplaceType="",Ic.CompliantSolutionId="";Ic.IsEventsEnabled=void 0===
Df||null===Df||Df.Ij.a8b(Ic.InstanceId);Ic.RequestGuid=gj.a.create().toString();Ab=Ic.RequestBody.length;if(Ab>this.$.xa.ExcelRichApiMaxAllowedRequestPayloadSize){this.Ug.Rj(If.a.WHj,za);t.ULS.sendTraceTag(537163213,0,50,`Request payload size:${Ab} exceeded the limit`);return}f.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Ed&4096&&(Ab=new Dg(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Ab,ti,ec),Ic.RequestBody=ec[4])}const Me=Bg.tff(Ic.RequestHeaders);
Bg.eOd++;const zf=Qj.a.Jd.Re;f.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&Ic&&Ic.RequestBody&&t.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${Ic.RequestBody.length}`);this.tD.executeRichApiRequest(Ic,Df=>{var fg;this.Rcg(zf,!0,Df.ServerCorrelationId);let qh=null,og=null;var ch=Df.ServerCorrelationId;if(null===(fg=null===Df||void 0===Df?void 0:Df.Errors)||void 0===fg?0:fg[0])qh=Df.Errors[0].MessageIdName,og=Df.Errors[0].Description,rk.a(this.$).Pf.wP(Df.Errors[0].MessageId);
if(Lh.a(Df)||!Df.Result)this.idb(ch,Me,"Server error",qh,og),this.Ug.DK(Df,za);else{let Ch=null;if(f.EwaSettings.Fa(233))if((fg=Df.Result)&&fg.length){for(let Yh=0;Yh<fg.length;Yh++)if(fg[Yh].RequestGuid===Ic.RequestGuid){Ch=fg[Yh];break}Ch||this.Ug.DK(Df,za)}else Ch=Df.Result;else Ch=Df.Result;if(!qh&&Ch&&Ch.ResponseBody&&Ch.ResponseBody[0])if(Df=Ch.ResponseBody[0],Df.startsWith('{"Error":')){1<Ch.ResponseBody.length&&(Df=Df.substring(0,Df.indexOf("}")+1),Df+="}");try{var ah=Rc.a.kl(Df);ah.Error&&
this.idb(ch,Me,"Pipeline error",ah.Error.Code,ah.Error.Message)}catch(Yh){this.idb(ch,Me,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.idb(ch,Me);else this.idb(ch,Me,"Server error",qh,og);const Qh=(ch=Ch.SheetMultiRange)?ch.SheetName:null;ah=Ch.ActiveFloatingObjectId;const vh=Ch.SelectionState;Df=5===vh&&!!ch||6===vh||7===vh||17===vh||8===vh;if(this.$.Rd.uB&&Df)this.Ug.Rj(If.a.$Mc,za),t.ULS.sendTraceTag(537163211,0,50,`${vh.toString()} is not allowed`);else if(5===
vh&&ch){if(this.$.ta&&Qh)if(this.$.ta.Qm(Qh))this.O2c(Qh);else{let Yh=null;Yh=()=>{this.$.ta.Qm(Qh)&&(t.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.O2c(Qh),this.$.ta.$Bc(Yh))};this.$.ta.B6b(Yh);if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Ji=null;Ji=()=>{this.$.ta.Qm(Qh)&&(this.O2c(Qh),this.$.ta.jra(Ji))};this.$.ta.Oka(Ji)}}}else if(6===vh||7===vh||17===vh||8===vh||9===vh){if(ch){const Yh=C.g(ch.Ranges);
if(Qh&&C.db(Yh,!0))if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.ta.Qm(Qh)){let Ji=null;Ji=()=>{this.Yvg(ed,Yh,Qh,vh);this.$.ta.jra(Ji)};this.$.ta.Oka(Ji)}else this.Yvg(ed,Yh,Qh,vh)}if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:7915114_SelectImageWhenPossibleUsingXluid")){if(7===vh||17===vh||8===vh)ah="{"+sf.e(ah)+"}",rd.a(this.$).EOj(ah)}else 7===vh?(ch="38.{"+sf.e(ah)+"}",rd.a(this.$).maa(0,ch,!0)):17===vh?(ch="38.{"+sf.e(ah)+"}",
rd.a(this.$).maa(5,ch,!0)):8===vh&&rd.a(this.$).maa(2,ah,!0);9===vh&&(this.$.xa.ApiCallToSetPageLayout=!0)}Ch.PostProcessActions?(ch=Rc.a.kl(Ch.PostProcessActions),this.Ooj(ch).then(()=>{this.xib(Ch,za);this.Zkd(M.DdaMethod.ControlId,Ic);return Promise.resolve(null)},Yh=>{this.xib(Ch,za,Yh);return Promise.reject(Yh)})):this.xib(Ch,za)}},Df=>{this.Rcg(zf,!1,null);this.idb(null,Me,"Web service error");za(Df)})}Zkd(M,za){const Ab=Object(ca.a)(ci.DdaFacade,Ah.a(this.$));(null===Ab||void 0===Ab?0:Ab.qXd)&&
Ab.$o(M)&&Bg.p_j(za.RequestHeaders)&&(t.ULS.sendTraceTag(537163209,0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${M}; SolutionId: ${za.SolutionId}.`),Ab.qXd.BHh(M))}TRh(M,za){var Ab=this.jg.iY(M.DdaMethod.ControlId);const ec=ci.DdaFacade.getSolutionId(Ab,this.$);var Ic=null;Ic=ci.DdaFacade.fza(Ab,this.$);Ic=new wj(Ic,this.$);Ic=new Pj(ec,M.DdaMethod.ControlId,this.jg,this.$,Ic);const ed={ResponseHeaders:[]};ed.ResponseBody=Array(1);Ab=Bg.Ubf(M.ArrayData[3]);
const Ed=Bg.tff(Ab);Ab=new hi(this.$.xa.CreateWorkbookMaxAllowedBase64Size,this.QHf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Ic,ni,Ab,M.ArrayData).then(Pd=>{if(!Pd)return this.qFd(!1,"The rich api executor call failed",Ed),t.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),ed.ResponseStatusCode=500,this.xib(ed,za),null;this.qFd(!0,"The rich api executor call succeeded",Ed);ed.ResponseStatusCode=Pd[0];ed.ResponseBody[0]=Pd[2];this.xib(ed,za);return null},Pd=>{ed.ResponseStatusCode=
400;ed.ResponseBody[0]=Pd.toString();this.qFd(!1,"The rich api executor call failed",Ed);t.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${ec}`);this.xib(ed,za);return null})}Rcg(M,za,Ab){Bg.eOd--;M=ok.a(Qj.a.Jd,M);t.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${M}, requests pending:${Bg.eOd}, request result:${za?"success":"false"}, server correlationid: ${Ab}.`)}xib(M,za,Ab){Ab=void 0===Ab?null:Ab;const ec=Array(3);ec[0]=M.ResponseStatusCode;
ec[1]=Bg.uii(M.ResponseHeaders);const Ic=[];var ed=!1;if(Ab&&M.ResponseBody){const Ed=Rc.a.kl(M.ResponseBody.join(""));Ed.Error||(ed={},ed.Error=Ab,ed.TraceIds=Ed.TraceIds,ed.ProcessedResults={},ed.ProcessedResults.Results=Ed.Results,Ic[0]=Rc.a.ff(ed),ed=!0)}ec[2]=ed?Ic:M.ResponseBody;M=this.Ug.tK();M.Data=ec;za(M)}qId(M,za){(new oi(this.$,this.Ug,this.tD)).qId(M,za)}MZi(M,za){t.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const Ab=M[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],
ec=M[zb.a.$4c],Ic=M[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];M=this.$.ia.Ja(232).L6a.NZi(M.DdaMethod.ControlId,Ab,ec,Ic);M===If.a.success?this.Ug.wy(za):(t.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.Ug.Rj(M,za))}JZi(M,za){t.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Ab=M[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],ec=M[zb.a.$4c],Ic=M[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.ia.Ja(232).L6a.OPj(M.DdaMethod.ControlId,Ab,
ec,Ic);this.Ug.wy(za)}getAccessToken(M,za){t.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Ab=(ec,Ic)=>{var ed;if(ec===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)ec=this.Ug.tK(),ec[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Ic.accessToken,za(ec);else{Ic=this.jg.iY(M.DdaMethod.ControlId);let Ed=null!==Ic.OwnerAddinStoreType?Ic.OwnerAddinStoreType:Ic.PrimaryMarketplace.MarketplaceType;t.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:ec.toString(),
["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ci.DdaFacade.getSolutionId(Ic,this.$),Ed,null===(ed=Ic.AssetMarketplace)||void 0===ed?void 0:ed.SolutionId,null,null,Ic.PrimaryMarketplace.MarketplaceRef),["storeType"]:Ed})}.`);this.Ug.Rj(ec,za)}};$g.TaskExtensions.Aa(gi.GetServiceTaskFactory.create(this.$.ia,137,this.$.ma,1),ec=>{const Ic=this.jg.Qh,ed=Qg.getInstance();ye.a.getInstance(Ic,ec.result,ed).getAccessToken(M.DdaMethod.ControlId,!0,M,Ab)},this.$.ma)}getAuthContext(M,za){$g.TaskExtensions.Aa(gi.GetServiceTaskFactory.create(this.$.ia,
137,this.$.ma,1),()=>{var Ab=this.jg.Qh.getOsfControl(M.DdaMethod.ControlId);if(Ab.isFirstParty()){Ab=Ab.getManifest();var ec=Ab.getMarketplaceID(),Ic=Ab.getWebApplicationId(),ed=Ab.getWebApplicationMsaId();Pf.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(ec).then(Ed=>{const Pd=this.Ug.tK(),Ae={};Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Ic;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=ed||Ic;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
Ed.upn;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Ed.userId;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Ed.authority;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Tg.a.A2h(Ed.authorityType);Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Ed.isAnonymous;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ed.tenantId;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ed.supportsAuthToken;
Pd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ae;za(Pd)},Ed=>{const Pd=this.Ug.tK(),Ae={},Me=new Tg.a;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Ic;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=ed||Ic;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Me.upn;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Me.userId;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Me.authority;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=
Me.authorityType;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Me.isAnonymous;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Me.tenantId;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Ed;Ae[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Me.supportsAuthToken;Pd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ae;Pd.Error=1;za(Pd)})}},this.$.ma)}cqd(M,za){M=ze.cqd(this.jg.Qh,M.DdaMethod.ControlId);M.errorCode===
If.a.success?(M=Object.assign({},this.Ug.tK(),M.context),za(M)):this.Ug.Rj(M.errorCode,za)}executeFeature(M,za){32===Ze.AFrameworkApplication.Vd.qh(M[0],2)?za(this.Ug.tK()):this.Ug.Rj(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,za)}queryFeature(M,za){M=[32===Ze.AFrameworkApplication.Vd.qh(M[0],1),!0];M=Object.assign({},this.Ug.tK(),M);za(M)}oEi(M){const za=bc.h(this.$).ga;return 16===za.eh&&!!za.Ta.Fe&&!!za.Ta.Fe.floatingObject&&ai.a.equals(za.Ta.Fe.floatingObject.id,M,!0)}iod(M){const za=
bc.h(this.$).ga;return za.ra.Zj?1===za.eh||this.oEi(M)?za.kma:null:null}xrc(M,za){return 1!==M&&2!==M&&3!==M?(this.Ug.Rj(If.a.eNe,za),!1):!0}qFd(M,za,Ab){const ec={};ec.a=this.$.xa.UserSessionId;ec.b=M;ec.c=za;ec.d=null;ec.e=Ab;Le.b().Ih(37,ec)}idb(M,za,Ab,ec,Ic){Ab=void 0===Ab?null:Ab;ec=void 0===ec?null:ec;Ic=void 0===Ic?null:Ic;const ed={};M&&(ed.ServerCorrelationId=M);void 0!==za&&null!==za&&(ed.Source=za);Ab&&(ed.ErrorType=Ab);ec&&(ed.MessageId=ec);Ic&&(ed.StatusDescription=Ic);f.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&
ec&&"ExternalDataRefreshFailed"===ec&&(ed.StatusDescription="");t.ULS.sendTraceTag(50688452,0,50,Rc.a.ff(ed))}Ooj(M){let za=new Promise(Ab=>{Ab(null)});for(let Ab=0;Ab<M.length;Ab++)za=this.Noj(za,M[Ab]);return za}Noj(M,za){const Ab=this;return Ko(function*(){if(!za)return t.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),M.then(()=>Promise.reject(Bg.J8a(vi.generalException,cg.a.instance.ha(1765),null)));switch(za.actionType){case 1:case 2:M=M.then(()=>{const ed=Object(ca.a)(ci.DdaFacade,
Ah.a(Ab.$));if(ed.$o(za.controlId))switch(ed.Ij.dtd(za),za.messageType){case 14:case 100:ed.pXd.t8b(za);break;case 11:case 12:ed.PKj.Iub(za);break;case 51:case 52:ed.NKj.Iub(za);break;case 2101:case 2102:ed.OKj.Iub(za);break;case 2E3:ed.QKj.t8b(za);break;case 2201:Ab.$.Yoa&&ed.qXd.F6g(za);break;case 2203:ed.RKj.G6g(za);break;case 2700:f.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&ed.oXd.t8b(za);break;case 65541:ed.nXd.E6g(za)}else t.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${za.controlId}] doesn't exist.`);
return Promise.resolve(null)});break;case 3:M=M.then(()=>{Ab.Eni(za);return Promise.resolve(null)});break;case 15:f.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(M=M.then(()=>{Ab.wpi(za);return Promise.resolve(null)}));break;case 4:M=M.then(()=>{var ed=bc.h(Ab.$).ga.ra.activeCell;ed.top!==za.row+1&&ed.left!==za.column+1&&(ed=C.v(Yf.Range.ef(za.row+1,za.column+1),Ab.$),bc.h(Ab.$).Wj(ed,null,null,null,3,"DdaMethodHandler.ShowCard"));Th.a(Ab.$,243,242,0,Ed=>{Ed.Ajb(za.row+1,za.column+
1,1,!1,!1)});return Promise.resolve(null)});break;case 7:M=M.then(()=>{Object(ca.a)(ci.DdaFacade,Ah.a(Ab.$)).Ij.YYe(za.controlId,za.isEnableEvents);return Promise.resolve(null)});break;case 5:M=M.then(()=>Ab.Rvh(za));break;case 6:M=M.then(()=>Ab.xjj(za));break;case 8:M=M.then(()=>{f.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(ca.a)(ci.DdaFacade,Ah.a(Ab.$)).xhh();const ed=new Zj.a(qk.a.nm,5,null);vk.a(Ab.$).Ts(ed);return Promise.resolve(null)});
break;case 9:M=M.then(()=>Ab.JRj(za));break;case 10:M=M.then(()=>Ab.Fsk(za));break;case 11:M=M.then(()=>Ab.Esk());break;case 12:M=M.then(()=>Ab.Bsk());break;case 13:M=M.then(()=>Ab.Csk(za));break;case 14:M=M.then(()=>Ab.Dsk(za));break;case 16:M=M.then(()=>Promise.resolve(za));break;case 17:M=M.then(()=>Ab.TNj(za,Object(ca.a)(ci.DdaFacade,Ah.a(Ab.$))));break;case 18:bc.h(Ab.$).focus();break;case 19:Ab.Lif(za.entryType,!1,za.options);break;case 20:Ab.Lif(za.entryType,!0,za.options);break;case 21:const ec=
Ah.a(Ab.$);M=M.then(()=>ec.nXd.jni(za));break;case 22:const Ic=Ah.a(Ab.$);M=M.then(()=>Ic.nXd.kni(za));break;case 23:(Pg.a.xGb(Ab.$)||Pg.a.Noa())&&Ab.jg.r$f.hqi(za.worksheetId,za.anchorCell,za.values,za.options);break;case 24:(Pg.a.xGb(Ab.$)||Pg.a.Noa())&&Ab.jg.r$f.poi(za.worksheetId);break;default:M=M.then(()=>Promise.reject(Bg.J8a(vi.Q3g,cg.a.instance.ha(1766),null)))}return M})}wpi(M){var za=Object(ca.a)(ci.DdaFacade,Ah.a(this.$)).$o(M.controlId);if(za&&!(0===M.operationType^!za.zha)){bc.h(this.$).cFb=
!0;switch(M.operationType){case 0:var Ab=new pk.a(document.createElement("input"));Ab.text=M.range;za.xyi(bc.h(this.$).Xj.quh(Ab,new Yj.a(this.$)));za.zha.startEdit(!0);break;case 1:za.k5f();this.rangePicker=null;break;case 2:za.zha.mwg(M.range);break;case 3:za.zha.mwg(M.startingRange);za=M.expandSelection;Ab=M.getNextDataRegionCell;let ec=0;switch(M.keyboardDirectionValue){case 2:ec=38;M=za&&Ab?105288353:za?-31900117:Ab?542791952:137938150;break;case 3:ec=40;M=za&&Ab?-1297307319:za?-1603798598:Ab?
1713663844:-798660877;break;case 0:ec=37;M=za&&Ab?-403586027:za?2039316657:Ab?-2012742350:-1470715894;break;case 1:ec=39;M=za&&Ab?784916030:za?589730764:Ab?1324884057:-1231471547;break;default:M=1461300262}za=this.Qbc("keydown",ec,za,Ab);bc.h(this.$).nRb(za,new ki.a(M,1,0,8,null))}bc.h(this.$).cFb=!1}}Qbc(M,za,Ab,ec){const Ic=document.createEvent("KeyboardEvent");if(Nf.a.DC)Ic.initKeyboardEvent(M,!1,!1,window.self,"A",0,ec,!1,Ab,!1);else{let ed="";Ab&&(ed+="Shift");ec&&(ed+=0<ed.length?" Control":
"Control");Ic.initKeyboardEvent(M,!1,!1,window.self,"A",0,ed,!1,"en-US")}M=new Sys.UI.DomEvent(Ic);M.keyCode=za;return M}Eni(M){switch(M.operationType){case 1:$g.TaskExtensions.Aa(gi.GetServiceTaskFactory.create(this.$.ia,153,this.$.ma,1),za=>{za.result.fWd()},this.$.ma,3);break;case 2:if(M=Object(ca.a)(ci.DdaFacade,Ah.a(this.$)).$o(M.controlId))M.bqc=!0,M.m_f()}}Rvh(M){const za=M.fileBase64;return za&&za.length>this.$.xa.CreateWorkbookMaxAllowedBase64Size?Promise.reject(Bg.J8a(vi.invalidArgument,
cg.a.instance.ha(1769),"Application.CreateWorkbook")):(new Promise((Ab,ec)=>{const Ic=new Bh.StandardDialog;Ic.ke=4;Ic.fn(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,ed=>{2!==ed&&0!==ed||ec(Bg.J8a(vi.oNd,cg.a.instance.ha(1768),"Application.CreateWorkbook"));ed=new bi("blank","agave",za?"streamBase64":"streamEmpty",za);this.QHf.create(Ab,ec,ed).$5a()})})).then(Ab=>{this.vgc.set(M.fakeFileId,Ab);return Promise.resolve(null)},Ab=>Ab?Promise.reject(Ab):
Promise.reject(Bg.J8a(vi.generalException,cg.a.instance.ha(1765),"Application.CreateWorkbook")))}xjj(M){return new Promise((za,Ab)=>{if(this.vgc.has(M.fakeFileId)){const ec=this.vgc.get(M.fakeFileId);Ab=new Bh.StandardDialog;Ab.ke=4;Ab.fn(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,Ic=>{1===Ic&&da.HelperMethods.rh(ec,void 0,void 0,"DdaMethodHandler.fileUrl");za(null)})}else Ab(Bg.J8a(vi.generalException,cg.a.instance.ha(1765),"Document.Open"))})}JRj(M){return new Promise(za=>
{Object(ca.a)(ci.DdaFacade,Ah.a(this.$)).s$f=M.runtimeCalculationMode;const Ab=this.$.ia.Ja(268);Ab&&Ab.rJd(3===M.runtimeCalculationMode);za(null)})}Fsk(M){Pg.a.pIb(this.$)&&this.$.ia.Ja(331).yib(0,M.urlStr,!0,!0,null);return Promise.resolve(null)}Esk(){Pg.a.pIb(this.$)&&this.$.ia.Ja(331).yib(1,null,!0,!0,null);return Promise.resolve(null)}Bsk(){Pg.a.pIb(this.$)&&this.$.ia.Ja(331).VYe();return Promise.resolve(null)}Csk(M){Pg.a.pIb(this.$)&&this.$.ia.Ja(331).yib(5,M.urlStr,!0,!0,null);return Promise.resolve(null)}Dsk(M){if(Pg.a.pIb(this.$)){const za=
this.$.ia.Ja(331);for(const Ab of za.kea)Ab.IsActive&&Ab.HostEditUrl&&Ab.UrlStr===M.hostEditUrlStr&&da.HelperMethods.rh(Ab.HostEditUrl,"_blank")}return Promise.resolve(null)}TNj(M,za){const Ab=dg.a.tO;M=Rc.a.kl(M.payload);const ec={};"eventId"in M&&"payload"in M&&(ec.eventId=M.eventId,ec.payload=M.payload);za.cG(2201,Ab,Rc.a.ff(ec));return Promise.resolve(null)}Lif(M,za,Ab){const ec=Se.a.rg(Fe.p);ec&&(M=this.v3h(M))&&(za?ec.removeEntry(M):ec.E3c(M,Ab))}v3h(M){switch(M){case 0:return 64;case 1:if(f.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 69}}O2c(M){M=
Object(ca.a)(hk.a,this.$.ta.getItemByName(M));(null===M||void 0===M?0:M.visible)&&M.activate({disableAutoFocusOnGrid:!0,scenario:"dda"})}Yvg(M,za,Ab,ec){var Ic=M.ra.Ot;const ed=Ic<za.length&&za[Ic].contains(M.ra.activeCell);M=ed?M.ra.activeCell:za[0].topLeft;Ic=ed?Ic:0;bc.h(this.$).G2(za,Ic,Ab,null,M,null,null,3,"DdaMethodHandler.UpdateSelection",void 0,void 0,void 0,6===ec)}static get ixh(){Bg.eua||(Bg.eua={},Bg.eua[Microsoft.Office.WebExtension.CoercionType.Table]=1,Bg.eua[Microsoft.Office.WebExtension.CoercionType.Text]=
2,Bg.eua[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,Bg.eua[Microsoft.Office.WebExtension.CoercionType.Html]=4,Bg.eua[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return Bg.eua}static get lxh(){Bg.nnb||(Bg.nnb={},Bg.nnb[Microsoft.Office.WebExtension.FilterType.All]=1,Bg.nnb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return Bg.nnb}static get mxh(){Bg.onb||(Bg.onb={},Bg.onb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,Bg.onb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=
1);return Bg.onb}static Ubf(M){if(!M||!M.length)return null;const za=Array(M.length/2);for(let Ab=0;Ab<M.length/2;Ab++)za[Ab]={},za[Ab].Name=M[2*Ab],za[Ab].Value=M[2*Ab+1];return za}static uii(M){if(!M||!M.length)return null;const za=Array(2*M.length);for(let Ab=0;Ab<M.length;Ab++)za[2*Ab]=M[Ab].Name,za[2*Ab+1]=M[Ab].Value;return za}static old(M){if(!M||!M.length)return null;const za=Array(M.length);for(let Ab=0,ec=M.length;Ab<ec;Ab++){const Ic=M[Ab].length;if(Ic){za[Ab]=Array(Ic);for(let ed=0;ed<
Ic;ed++)za[Ab][ed]=null==M[Ab][ed]?null:M[Ab][ed].toString()}else return null}return za}static iac(M){return"string"===typeof M?gk.a.ft(Bg.ixh,M,0):M}static q5e(M){return"string"===typeof M?gk.a.ft(Bg.lxh,M,0):M}static Lxg(M){return"string"===typeof M?gk.a.ft(Bg.mxh,M,0):M}static AEi(M){switch(M.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static p8c(M,za){const Ab={};Ab.CoerceType=M;1===Ab.CoerceType?(Ab.Data=Bg.old(za.Rows),Ab.Headers=Bg.old(za.Headers)):
Ab.Data=Bg.old(za);return Ab}static EHe(M){return 1===M.CoerceType?{["Headers"]:M.Headers,["Rows"]:M.Data}:M.Data}static foc(M){return 1===M.CoerceType?!M.Data&&!M.Headers:!M.Data}static tff(M){let za="Unknown";if(!M)return za;for(let Ab=0;Ab<M.length;Ab++)if(M[Ab].Name.toLowerCase()===Qd.a.SKj){za=M[Ab].Value;break}return za}static p_j(M){if(!M)return!1;const za=Qd.a.P3i.toLowerCase();for(let Ab=0;Ab<M.length;Ab++)if(M[Ab].Name.toLowerCase()===za)return!0;return!1}static J8a(M,za,Ab){const ec={};
ec.Code=M;ec.Message=za;ec.Location=Ab;ec.ActionIndex=0;return ec}}Bg.eua=null;Bg.nnb=null;Bg.onb=null;Bg.eOd=0;Object(k.a)(Bg,"DdaMethodHandler",null,[169,5]);class Oj extends kg.a{constructor(M){super(M)}yg(){const M=gi.GetServiceTaskFactory.create(this.$.ia,106,this.ma,this.$a),za=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateNewAndOpenUX",!1)?Object(Zg.d)(Se.a.resolve(Fe.gc,{Oa:this.$a})):gi.GetServiceTaskFactory.create(this.$.ia,165,this.ma,this.$a),Ab=Fh(this.ma,this.$a),
ec=Object(Zg.d)(Se.a.resolve(Fe.Mb,{Oa:this.$a}));$g.TaskExtensions.Aa($g.TaskExtensions.Tg([M,za,Ab,ec],this.ma),()=>{const ed=M.result,Ed=Pf.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.vg([new Bg(this.$,ed,Ed,ec.result)])},this.ma,3);const Ic=Pf.a.instance;$g.TaskExtensions.Aa(gi.GetServiceTaskFactory.create(this.$.ia,137,this.$.ma,this.$a),()=>{Ic.register(Dd,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Ve().$e(()=>
new Dd)},this.$.ma)}static la(M){kg.a.dh(82,new Oj(M))}}Object(k.a)(Oj,"DdaCommandHandlerFactory",kg.a,[]);h.a.Pk(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");(()=>{e.a.Ia(M=>{f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateMacroRecorderEventsHandler",!1)||Hf.la(M)})})();(()=>{e.a.Ia(M=>{f.EwaSettings.Fa(52)&&qg.la(M)})})();(()=>{e.a.Ia(M=>{f.EwaSettings.Fa(114)&&wi.la(M)})})();
(()=>{e.a.Ia(M=>{f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2AgaveOnSelectedReadoutHandler",!1)||pi.la(M)});e.a.Ia(mi.la)})();(()=>{e.a.Ia(M=>{nj.la(M);Qa.la(M)})})();e.a.Ia(Oj.la);String(b);String(c);window.___1692616129070_closurehack=b;window.___1692616129070_closurehack=c},1385:function(w,B,a){w=a(0);var b=a(198),c=a(106);class h{constructor(){this.SXe=this.displayName=this.nxb=this.Tq=this.zE=null;this.isUpgraded=!1}Jvf(e,k){return this.zE.getStoreType().toLowerCase()===
e.toLowerCase()&&this.zE.getSolutionId().toLowerCase()===k.toLowerCase()}}Object(w.a)(h,"AddinCommandsResourceItem",null,[]);a.d(B,"a",function(){return f});class f{constructor(){this.eOc=null;this.fTc=0;this.MUc=!1;this.$b=new c.a;this.dLg=new b.a}IYg(e){this.$b.addHandler("AddinCommandsLoadingMessageChanged",e)}nCj(e){this.$b.removeHandler("AddinCommandsLoadingMessageChanged",e)}get mwa(){return this.eOc}Wib(e){e!==this.eOc&&(this.eOc=e,this.$b.raiseEvent("AddinCommandsLoadingMessageChanged"))}ERj(){this.fTc++;
this.mwa||this.Wib(CommonUIStrings.l_LoadingAddInsTitle)}b_d(){this.fTc--;this.ftc()&&(this.MUc?this.mwa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Wib(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Wib(null))}Feg(e){this.MUc=!0;this.Wib((void 0===e?0:e)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}CLe(){this.MUc=!1;this.ftc()?this.Wib(null):this.Wib(CommonUIStrings.l_LoadingAddInsTitle)}ftc(){return 0>=this.fTc}get eab(){return this.dLg}Uma(e,
k,l){l=void 0===l?0:l;for(const r of this.eab)if(r.Jvf(e,k)&&(!r.Tq||r.Tq.U0h===l))return r;return null}Pye(e,k,l,r){const v=new h;v.zE=e;v.Tq=k;v.nxb=l;v.displayName=r;this.eab.add(v)}JWg(e,k,l,r){const v=new h;v.zE=e;v.Tq=k;v.nxb=null;v.SXe=l;v.displayName=r;this.eab.add(v)}IAj(e,k){let l=0;for(const r of this.eab)r.zE.getStoreType()===e&&r.zE.getSolutionId()===k?this.eab.removeAt(l):l++}static getInstance(){f.La||(f.La=new f);return f.La}}f.La=null;Object(w.a)(f,"AddinCommandsResourceManager",
null,[])},772:function(w,B,a){a.d(B,"a",function(){return c});w=a(0);var b=a(38);class c{static get LZi(){return c.aoe||(c.aoe={["-2002156328"]:c.eNe,["-1954750170"]:c.Vff,["317650254"]:c.qjh,["-1005263101"]:c.DAi,["1353664579"]:c.aPj,["159671765"]:c.EAi,["1446690022"]:c.paf,["1150069548"]:c.KKc,["-1409306331"]:c.ZJe,["338507772"]:c.FTe,["-457159301"]:c.tkj,["-1037701970"]:c.Iwh,["-1893322318"]:c.JAi,["965579896"]:c.Kwh,["93287890"]:c.Jwh,["358088857"]:c.xSj,["-1223650923"]:c.FTe,["2007306190"]:c.lfh,
["1549955423"]:c.IGe,["-1275974171"]:c.IAi,["382101082"]:c.Bjj,["-898776235"]:c.t0i,["335464256"]:c.k0i,["1677378049"]:c.HAi,["-261992848"]:c.mik,["-980820954"]:c.IGe,["-931375837"]:c.Ajj,["929186550"]:c.PEh,["-982144310"]:c.$rj,["-785741187"]:c.AAi,["2125217573"]:c.LAi,["299124955"]:c.CAi,["1669853884"]:c.eLj,["-1515932330"]:c.rjh,["314621024"]:c.oYh,["-300049690"]:c.qfh,["14766835"]:c.UXj,["-1251992761"]:c.WWe,["-2087635043"]:c.invalidOrTimedOutSession,["2100961153"]:c.invalidOrTimedOutSession,
["-1218744139"]:c.invalidSheetName,["-1468309555"]:5006,["-315732528"]:c.invalidOrTimedOutSession,["611268539"]:c.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:c.$Ja,["49173765"]:c.$Ja,["-907155566"]:c.$Ja,["-1201603824"]:c.$Ja,["1541165282"]:c.$Ja,["-1347753427"]:c.$Ja,["134912532"]:c.$Ja,["1780971550"]:c.responsePayloadSizeLimitExceeded})}static P7e(h){return b.a.ft(c.LZi,h.toString(),c.internalError)}}c.success=0;c.eNe=1E3;c.Vff=1001;c.qjh=1002;c.DAi=1003;c.aPj=
1004;c.EAi=1005;c.paf=1008;c.d5e=1009;c.invalidSheetName=1014;c.KKc=2E3;c.ZJe=2001;c.FTe=2002;c.tkj=2003;c.Iwh=2004;c.JAi=2005;c.Kwh=2007;c.Jwh=2008;c.xSj=2009;c.lfh=2014;c.TOj=3E3;c.IGe=3002;c.IAi=3004;c.Bjj=3005;c.t0i=3006;c.k0i=3007;c.HAi=3008;c.mik=3009;c.Ajj=3010;c.UXj=4002;c.tNd=5E3;c.internalError=5001;c.WWe=5002;c.FFb=5004;c.qjk=5007;c.avi=5008;c.r8f=5011;c.invalidOrTimedOutSession=5012;c.$Mc=5016;c.$Ja=5102;c.WHj=5103;c.responsePayloadSizeLimitExceeded=5104;c.Jeh=7001;c.Ulg=7002;c.PEh=8E3;
c.$rj=8001;c.AAi=8010;c.LAi=8011;c.CAi=8012;c.eLj=8020;c.rjh=8021;c.oYh=8022;c.qfh=8023;c.rZi=11E3;c.k1i=11001;c.KAi=11002;c.aoe=null;Object(w.a)(c,"DdaErrorIds",null,[])},773:function(w,B,a){a.d(B,"a",function(){return h});w=a(0);var b=a(16),c=a(112);class h{constructor(){this.gTd=0;this.QZ={};this.jxa={}}ndi(f,e){return this.QZ[h.s8c(f,e)]}YYe(f,e){e||void 0!==this.jxa[f]&&null!==this.jxa[f]?e&&void 0!==this.jxa[f]&&null!==this.jxa[f]&&delete this.jxa[f]:this.jxa[f]=1}a8b(f){return void 0===this.jxa[f]||
null===this.jxa[f]}dtd(f){const e=h.s8c(f.messageType,f.targetId);1===f.actionType?this.Fpi(f.controlId,f.messageType,e):2===f.actionType&&this.wqi(f.controlId,f.messageType,e)}oBj(f){if(f){var e=Object.keys(this.QZ);if(!(void 0===e||null===e||0>=e.length))for(const k of e)e=this.QZ[k],e[f]&&(delete e[f],Object.keys(e).length||delete this.QZ[k])}}$K(f,e){f=h.s8c(f,e);f=this.QZ[f];return!!f&&0<Object.keys(f).length}sri(){return!c.a.isEmpty(this.QZ)}Hwf(){return 0<this.gTd}Z7h(){const f=[],e=this.QZ;
for(let r in e){var k=r,l=e[r];for(let v in l){l=v;const u={};u.eventType=parseInt(k.split("#")[0],10);u.targetId=k.split("#")[1];u.addinId=l;f.push(u)}}return f}Fpi(f,e,k){if(this.QZ[k])k=this.QZ[k],k[f]=k[f]?k[f]+1:1;else{let l={};l[f]=1;this.QZ[k]=l}100===e&&this.gTd++}wqi(f,e,k){if(this.QZ[k]){const l=this.QZ[k];if(f){const r=l[f];1===r?(delete l[f],Object.keys(l).length||delete this.QZ[k]):l[f]=r-1;100===e&&this.gTd--}else b.ULS.sendTraceTag(537170459,0,50,`The OsfControl[${f}] doesn't register event with key[${k}].`)}else b.ULS.sendTraceTag(537170460,
0,50,`The event with key[${k}] that will be unregistered doesn't exist.`)}static s8c(f,e){return String.format("{0}#{1}",f,e)}}h.tO="Workbook";Object(w.a)(h,"RichApiEventRegistration",null,[])},774:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);class b{}b.generalException="GeneralException";b.invalidArgument="InvalidArgument";b.notImplemented="NotImplemented";b.k2c="AccessDenied";b.notSupported="NotSupported";b.G7b="ApiNotAvailable";b.oIf="NotAllowed";b.oNd="OperationCancelled";b.c$d="UserNotSignedIn";
b.Alb="UserAborted";b.tjk="UnsupportedUserIdentity";b.hab="InvalidResourceUrl";b.Inc="InvalidGrant";b.S1g="AddinIsAlreadyRequestingToken";b.yJj="ResourceNotAllowed";b.Y$b="ClientError";b.serverError="ServerError";b.jnh="ControlIdNotFound";b.nKj="RibbonApiNotAvailable";b.hostRestartNeeded="HostRestartNeeded";b.invalidRibbonDefinition="InvalidRibbonDefinition";b.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(w.a)(b,"ErrorCodes",null,[])},777:function(w,B,a){a.r(B);var b=a(0),c=a(2),h=
a(16),f=a(1229),e=a(106);class k{constructor(na,S,Ja){this._id=na;this.ZEg=S;this.fHg=Ja;this.Fpf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get R1g(){return this.ZEg}get Tjh(){return this.fHg}execute(na,S,Ja){Ja=Ja||{};Ja.commandMode=this.Fpf;S.invokeAppCommand(this.R1g,this.Tjh,Ja,()=>{na.Zcj(this.id)})}}Object(b.a)(k,"AddinNativeActionBase",null,[453]);class l extends k{constructor(na,S){super(1,na,S);this.Fpf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(b.a)(l,"AddinTakeSnapshotAction",
k,[]);class r{Qoh(na){return new k(3,na,this.B1h().getNativeActionName(3))}B1h(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(b.a)(r,"AddinNativeActionManager",null,[432]);var v=a(153);class u{invokeAppCommand(na,S,Ja,rb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(na,S,Ja,rb)}static getInstance(){u.La||(u.La=new u);return u.La}}u.La=null;Object(b.a)(u,"OSFAddinCommandsRuntimeManager",null,[431]);var x=a(5),t=a(195),m=a(30);class n extends v.a{constructor(na,S,
Ja){super();this.uca=null;this.i1c="WACDialogTitleText";this.Z_="0";this.zba="15px";this.xHg="0px";this.Y_="calc(100% - 30px)";this.wHg="100%";this.Ere=0;this.$b=new e.a;this.aFg=new r;this.ke=5;this.Rg=this.BHa=Ja;this.nRc=na;this.mge=S;this.ERc=!!x.AFrameworkApplication.da&&x.AFrameworkApplication.da.na("OfficeAddinEnableInsertDialogAccessibilityFix")}c0g(na){this.$b.addHandler("OnDialogClosedEventKey",na)}LUj(){this.JIa=null}Rz(){super.Rz();this.tk.style.width="100%";this.tk.style.height=this.gEb?
this.Y_:this.wHg;this.tk.style.marginTop=this.gEb?this.zba:this.xHg;this.tk.style.padding=this.Z_}OG(){super.OG();this.Md.style.width=String.format("{0}px",this.nRc*window.innerWidth/100);this.Md.style.height=String.format("{0}px",this.mge*window.innerHeight/100);this.Md.style.minWidth="0px";this.ERc&&x.AFrameworkApplication.isRtl&&100===this.nRc&&(this.Md.style.right="0px",this.Md.style.marginRight="0px");this.uca=document.getElementById(this.qk(this.i1c));this.uca.style.position="absolute";this.uca.style.whiteSpace=
"nowrap";this.uca.style.textOverflow="ellipsis";x.AFrameworkApplication.isRtl?(this.uca.style.right="14px",this.uca.style.left="44px"):(this.uca.style.right="44px",this.uca.style.left="14px")}LB(na){super.LB(na);this.uca&&this.uca.setAttribute("title",na)}get Vda(){return this.tk}mWd(){this.Md.style.width=String.format("{0}px",this.nRc*window.innerWidth/100);this.Md.style.height=String.format("{0}px",this.mge*window.innerHeight/100);this.Md.style.overflowY="hidden";this.Md.style.overflowX="hidden";
this.Md.style.marginTop="";this.Md.style.top="";m.a.PY&&x.AFrameworkApplication.isRtl?(this.Md.style.right="",this.Md.style.marginRight=""):(this.Md.style.left="",this.Md.style.marginLeft="")}hide(){this.aFg.Qoh(this.BHa).execute(this,u.getInstance(),{});this.Ere=window.setTimeout(()=>{this.$b.raiseEvent("OnDialogClosedEventKey",this.BHa);t.a.prototype.hide.call(this)},500)}Zcj(na){3===na&&(window.clearTimeout(this.Ere),this.$b.raiseEvent("OnDialogClosedEventKey",this.BHa),super.hide())}}Object(b.a)(n,
"AppsForOfficeDialog",v.a,[393,394]);class A{constructor(){this.dialog=this.Rg=null}}Object(b.a)(A,"DialogInfo",null,[]);class y{}y.url="url";y.height="height";y.width="width";y.fgd="displayInIframe";y.tmc="hideTitle";Object(b.a)(y,"DialogSettings",null,[]);class z{constructor(){this.height=this.width=0;this.Rg=this.controlId=this.pageUrl=null;this.tmc=this.fgd=!1}}Object(b.a)(z,"DisplayDialogParams",null,[]);class F extends Sys.EventArgs{constructor(na,S,Ja,rb,ma){Ja=void 0===Ja?null:Ja;rb=void 0===
rb?"":rb;ma=void 0===ma?"":ma;super();this.controlId=na;this.messageType=S;this.messageContent=Ja;this.messageOrigin=rb;this.targetOrigin=ma}}Object(b.a)(F,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class D extends Sys.EventArgs{constructor(na,S,Ja,rb,ma){Ja=void 0===Ja?null:Ja;rb=void 0===rb?"":rb;ma=void 0===ma?"":ma;super();this.controlId=na;this.messageType=S;this.messageContent=Ja;this.messageOrigin=rb;this.targetOrigin=ma}}Object(b.a)(D,"OnMessageParentEventArgs",Sys.EventArgs,[]);var I=a(41),
H=a(33),N=a(181),U=a(108);class L{constructor(na){this.$b=new e.a;this.W7i=(S,Ja)=>{if(S=this.NOa(Ja))this.jm.purgeDialogControl(Ja),L.mba.remove(S),this.$b.raiseEvent("OnMessageParentEventKey",new D(S,OSF.DialogMessageType.DialogClosed,null,null,"*"))};this.jm=na}k0g(na){this.$b.addHandler("OnMessageParentEventKey",na)}j0g(na){this.$b.addHandler("OnMessageDialogEventKey",na)}showDialog(na,S,Ja,rb){if(L.mba.Hd(S))h.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),
Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const ne=I.b(na),Te=ne[y.url];if(this.jm.getOsfControl(S).checkAppDomains(Te)){var ma=new z;ma.width=ne[y.width];ma.height=ne[y.height];ma.pageUrl=Te;ma.fgd=ne[y.fgd];ma.tmc=ne[y.tmc];ma.controlId=S;ma.Rg=N.a.create().toString();var ib=new A;ib.Rg=ma.Rg;var Qb=this.jm.getOsfControl(ma.controlId).getManifest().getDefaultDisplayName(),Fc=this.jm.getOsfControl(ma.controlId).getStoreType().toLowerCase();na=null;na=(4===x.AFrameworkApplication.sa.Sa.Hj&&
"hardcodedpreinstall"===Fc||"sdxcatalog"===Fc)&&ma.tmc?this.createAndShowAppsForOfficeDialog(ma.width,ma.height,ma.Rg,!0,Qb):this.createAndShowAppsForOfficeDialog(ma.width,ma.height,ma.Rg,!1,Qb);var jd=this.jm.getOsfControl(ma.controlId),ke=jd.getManifest();S={};S.id=ma.Rg;S.solutionId=jd.getSolutionId();S.version=jd.getVersion();S.storeType=Fc;S.storeId=jd.getStoreId();S.assetId=jd.getAssetId();S.assetStoreId=jd.getAssetStoreId();S.ownerAddinSolutionId=jd.getOwnerAddinSolutionId();S.ownerAddinStoreType=
jd.getOwnerAddinStoreType();S.appDomains=ke.getAppDomains();S.dialogUrl=Te;S.osfControlType=1;S.agaveName=Qb;S.div=na.Vda;h.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(S.solutionId,S.ownerAddinStoreType||S.storeType,S.assetId,null,null,S.storeId),H.a.hz(ma.pageUrl));this.jm.insertDialogControl(S);na.c0g(this.W7i);ib.dialog=na;L.mba.fa(ma.controlId,ib);rb&&rb(S);Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else h.ULS.sendTraceTag(19940611,
344,10,"ShowDialog: dialog url not in app domains list."),Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(ne){h.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",ne.message),Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}NZi(na,S,Ja,rb){x.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===rb&&(rb=Ja);try{const ma=this.NOa(na);ma&&this.$b.raiseEvent("OnMessageParentEventKey",
new D(ma,OSF.DialogMessageType.DialogMessageReceived,S,Ja,rb))}catch(ma){return h.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",ma.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Lwb(na,S){if(L.mba.Hd(na))try{const Ja=L.mba.ka(na);Ja.dialog&&Ja.dialog.hide();this.jm.purgeDialogControl(Ja.Rg);L.mba.remove(na);S(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Ja){h.ULS.sendTraceTag(18371106,
344,10,"CloseDialog: action failed. Exception message: {0}",Ja.message),S(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else h.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),S(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}OPj(na,S,Ja,rb){x.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===rb&&(rb=Ja);if(L.mba.Hd(na)&&(na=L.mba.ka(na),na.dialog))try{this.$b.raiseEvent("OnMessageDialogEventKey",
new F(na.Rg,OSF.DialogMessageType.DialogParentMessageReceived,S,Ja,rb))}catch(ma){h.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",ma.message)}}NOa(na){let S=null;for(const Ja of L.mba)if(Ja.value.Rg===na){S=Ja.key;break}return S}createAndShowAppsForOfficeDialog(na,S,Ja,rb,ma){na=new n(na,S,Ja);ma=rb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,ma);rb&&(na.gEb=!1,na.Gw=!1);na.initializeAndShow(ma,null,null);na.LUj();return na}static Dli(){return L.mba}static getInstance(na){L.La||
(L.La=new L(na));return L.La}}L.La=null;L.mba=new U.a;Object(b.a)(L,"AppsForOfficeDialogManager",null,[384]);var J=a(1282),P=a(713),K=a(382),ca=a(198),T=a(389),Q=a(863);class fa{constructor(){this.AUP=this.priority=0}}Object(b.a)(fa,"AddinDetailInfo",null,[]);class ha{constructor(na){this.solutionIds=null;this.errorCode=0;this.failure=null;this.tX=na}}Object(b.a)(ha,"AddinCollection",null,[]);class Ea extends Sys.EventArgs{constructor(na,S,Ja,rb){rb=void 0===rb?null:rb;super();this.dC=na;this.errorCode=
S;this.av=Ja;this.failure=rb}}Object(b.a)(Ea,"AddinDetailsRefreshedEventArgs",Sys.EventArgs,[]);class ra{constructor(na){this.errorCode=na;this.av=[];this.failure=null}}Object(b.a)(ra,"GetAddinDetailsResult",null,[]);var Z=a(756),wa=a(832);class la{}Object(b.a)(la,"GetEntitlementDetailsParameters",null,[]);var ta=a(122),Ca=a(213),Ga=a(85);class Oa{constructor(na,S,Ja){Ja=void 0===Ja?null:Ja;this.$b=new e.a;this.Dr=new P.a(K.a.Ei());this.Gl=new T.a;this.XIa=null;this.WCa=(rb,ma,ib)=>{if(ib)if(Oa.NJb(rb,
ib,window.performance.now()-ma),0===ib.errorCode){let Fc;if(ib.value){let jd=0;Fc=Array(ib.value.length);ib.value.forEach(ke=>{Fc[jd++]=ke})}else Fc=[];this.Px(rb,Fc)}else if(-1===ib.errorCode||10===ib.errorCode)this.Px(rb,[]);else{var Qb={};Qb.collectionType=Q.a[rb];Qb.invokeResultCode=ib.errorCode;Qb["queryResult.Value"]=ib.value?String.format("Length: {0}",ib.value.length):"null";Qb.queryStart=ma;Qb.queryDuration=window.performance.now()-ma;this.Gl.fa(rb,Object.assign(new ha(rb),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",
Qb)}));h.ULS.sendTraceTag(512231324,220,15,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Q.a[rb],this.Gl.ka(rb).failure.toString(),JSON.stringify(this.Gl.ka(rb).failure))}else Qb={},Qb.collectionType=Q.a[rb],Qb.queryResult=ib?"not null":"null",Qb.queryStart=ma,Qb.queryDuration=window.performance.now()-ma,this.Gl.fa(rb,Object.assign(new ha(rb),{errorCode:3,failure:Error.create("QueryAddinDetails hit an invocation failure",Qb)})),
h.ULS.sendTraceTag(512231323,220,10,"OnQueryAddinDetailsCompleted: fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Q.a[rb],this.Gl.ka(rb).failure.toString(),JSON.stringify(this.Gl.ka(rb).failure))};this.Zpa=(rb,ma)=>{rb=Object.assign(new ha(ma.dC),{solutionIds:new ca.a});var ib=ma.av;for(const Qb of ib)ib=Qb.solutionId,this.Dr.Hd(ib)?this.Dr.fa(ib,this.FKb(this.Dr.ka(ib),ma.dC,Qb)):this.Dr.add(ib,Qb),rb.solutionIds.add(ib);this.Gl.fa(ma.dC,rb)};this.MW=new Ca.a;
this.MW.add(OSF.StoreTypeEnum.MarketPlace,0);this.MW.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Qa=na;this.jm=S;this.au=Ja;this.Iob=Oa.HCb(na,"https://store-images.s-microsoft.com");this.iwa(this.Zpa)}get BGb(){return this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Qh(){return this.jm.value}nN(na){if(!this.e9(na))return na=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Q.a[na]}),Object.assign(new ra(1),{failure:na});
if(this.Gl.ka(na).failure)return Object.assign(new ra(this.Gl.ka(na).errorCode),{failure:this.Gl.ka(na).failure});h.ULS.shipAssertTag(509870082,220,!!this.Gl.ka(na).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",na);const S=new ra(0);for(const Ja of this.Gl.ka(na).solutionIds)this.Dr.Hd(Ja)&&Array.add(S.av,this.Dr.ka(Ja));return S}eza(na){return this.Dr.Hd(na)?this.Dr.ka(na):null}dra(na){if(na){this.iwa(na);for(const Ja of this.Gl.keys)if(this.e9(Ja)&&
!this.Gl.ka(Ja).failure){h.ULS.shipAssertTag(509870081,220,!!this.Gl.ka(Ja).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",Ja);var S=[];for(const rb of this.Gl.ka(Ja).solutionIds)Array.add(S,this.Dr.ka(rb));S=new Ea(Ja,this.Gl.ka(Ja).errorCode,S);na(null,S)}}}get name(){return"AddinDetailsManager"}jVa(){}Sz(na,S){S=void 0===S?!1:S;0!==na&&10!==na?h.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",wa.a[na]):this.MOb(na,
this.WCa,S)}iwa(na){this.$b.addHandler(Z.a.h3a,na)}xtd(na){const S={};S.collectionType=Q.a[na];this.Gl.fa(na,Object.assign(new ha(na),{errorCode:2,failure:Error.create("The store is disabled.",S)}));h.ULS.sendTraceTag(510253056,220,50,"Fail to query add-in details for collectionType '{0}' - failure: {1}; errorInfo: {2}",Q.a[na],this.Gl.ka(na).failure.toString(),JSON.stringify(this.Gl.ka(na).failure))}H1d(){return this.e9(2)?this.Qa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?
!!this.Gl.ka(2).failure:!1:!0}MOb(na,S,Ja){Ja=void 0===Ja?!1:Ja;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",na);na!==OSF.StoreTypeEnum.MarketPlace&&na!==OSF.StoreTypeEnum.PrivateCatalog?h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",na):(this.H1d()&&this.queryStoreDisabled(0,(rb,ma)=>{ma?this.xtd(2):(rb=window.performance.now(),S(2,rb,this.Gqd()))}),this.queryStoreDisabled(na,(rb,ma)=>{if(rb===OSF.StoreTypeEnum.MarketPlace&&ma)this.xtd(0);else if(rb===
OSF.StoreTypeEnum.PrivateCatalog&&ma)this.xtd(1);else{var ib=window.performance.now();this.Qh.getEntitlementDetails(Object.assign(new la,{storeType:rb,refresh:Ja}),Qb=>{S(this.MW.ka(rb),ib,Qb)})}}))}Px(na,S){na=new Ea(na,0,S);this.$b.raiseEvent(Z.a.h3a,na)}e9(na){return this.Gl.Hd(na)?!!this.Dr:!1}get pub(){return this.au?!this.au.AreThirdPartyAddInsAllowed||this.au.AppsForOfficeThirdPartyIsDisabled:!this.Qa.na("AreThirdPartyAddInsAllowed")||this.Qa.na("AppsForOfficeThirdPartyIsDisabled")}get dHb(){return this.au?
!this.au.AppsForOfficeAllowExternalMarketplace:!this.Qa.na("AppsForOfficeAllowExternalMarketplace")}get Iqa(){return this.au?this.au.PopularAddinDetailsJsonString:this.Qa.Ra("PopularAddinDetailsJsonString")}queryStoreDisabled(na,S){if(this.pub)S(na,!0);else if(na===OSF.StoreTypeEnum.MarketPlace&&this.dHb)S(na,!0);else{const Ja=Oa.BVb(na);if(Ja){const rb=window.performance.now();this.Qh.queryStoreDisabled(Ja,ma=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",
na,ma,rb,window.performance.now()-rb);S(na,ma)})}else S(na,!1)}}FKb(na,S,Ja){return na?Ja?2===S?Oa.kCa(Ja,na):Oa.kCa(na,Ja):na:Ja}Gqd(){if(!this.XIa){const na=JSON.parse(this.Iqa);this.h8a(na);this.XIa=na}return Oa.B4a(0,this.XIa)}h8a(na){Oa.eub(na);this.D3a(na);this.WAb(na)}D3a(na){const S=this.qvb();for(var Ja=0;Ja<na.length&&0<S.count;Ja++){const rb=na[Ja];if(S.Hd(rb.solutionId)){let ma=String.format("Found an override, solutionId: {0}",rb.solutionId);const ib=S.ka(rb.solutionId);ib&&(isNaN(ib.addinInfo.priority)||
(ma=String.format("{0}; AddinInfo.Priority: update {1} to {2}",ma,rb.addinInfo.priority,ib.addinInfo.priority),rb.addinInfo.priority=ib.addinInfo.priority),isNaN(ib.addinInfo.AUP)||(ma=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ma,rb.addinInfo.AUP,ib.addinInfo.AUP),rb.addinInfo.AUP=ib.addinInfo.AUP),ib.displayName&&(ma=String.format("{0}; DisplayName: update {1} to {2}",ma,rb.displayName,ib.displayName),rb.displayName=ib.displayName),ib.iconUrl&&(ma=String.format("{0}; IconUrl: update {1} to {2}",
ma,rb.iconUrl,ib.iconUrl),rb.iconUrl=ib.iconUrl),ib.description&&(ma=String.format("{0}; Description: update {1} to {2}",ma,rb.description,ib.description),rb.description=ib.description));S.remove(rb.solutionId);this.BGb&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ma)}}for(const rb of S.keys)Ja=S.ka(rb),Ja.displayName&&Ja.iconUrl&&Ja.addinInfo&&(na.push(Ja),this.BGb&&h.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",
JSON.stringify(Ja)))}qvb(){const na=new P.a(K.a.Ei());let S=this.Qa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!S)return na;S=S.trim();if(12>=S.length)return 0<S.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",S),na;this.BGb&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",S);try{const Ja=[],rb=S.split("|");for(let ma=rb.length-1;0<=ma;ma--){const ib=
rb[ma],Qb=ib.split("\\");if(2>Qb.length){Ja.push(ib);continue}const Fc=Oa.MNb(Qb);Fc?na.Hd(Fc.solutionId)||na.add(Fc.solutionId,Fc):Ja.push(ib)}this.BGb&&0<Ja.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ja.join("|"));this.BGb&&0<na.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",na.count,JSON.stringify(Ga.toArray(na.values)));return na}catch(Ja){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
S,Ja.toString())}return na}WAb(na){for(let S=0;S<na.length;S++)ta.c(na[S].iconUrl.toLowerCase(),"http",0)||(na[S].iconUrl=String.format("{0}/image/apps.{1}",this.Iob,na[S].iconUrl))}static NJb(na,S,Ja){const rb={};rb.AddinCollectionType=Q.a[na];rb.ErrorCode=S.errorCode;rb.AddinCount=S.value?S.value.length:0;na=window.performance.now();S=Date.now()-x.AFrameworkApplication.g1;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",
Ja,na,S,JSON.stringify(rb))}static B4a(na,S){const Ja={};Ja.errorCode=na;Ja.value=S;return Ja}static BVb(na){return na===OSF.StoreTypeEnum.MarketPlace?"omex":na===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static kCa(na,S){S.solutionId=S.solutionId||na.solutionId;S.version=S.version||na.version;S.storeType=S.storeType||na.storeType;S.storeId=S.storeId||na.storeId;S.assetId=S.assetId||na.assetId;S.assetStoreId=S.assetStoreId||na.assetStoreId;S.displayName=S.displayName||na.displayName;S.provider=
S.provider||na.provider;S.description=S.description||na.description;S.iconUrl=S.iconUrl||na.iconUrl;S.webApplicationId=S.webApplicationId||na.webApplicationId;S.highResolutionIconUrl=S.highResolutionIconUrl||na.highResolutionIconUrl;S.licenseUrl=S.licenseUrl||na.licenseUrl;S.privacyUrl=S.privacyUrl||na.privacyUrl;S.addinInfo=S.addinInfo||na.addinInfo;isNaN(S.targetType)&&(S.targetType=na.targetType);isNaN(S.height)&&(S.height=na.height);isNaN(S.width)&&(S.width=na.width);return S}static eub(na){for(const S of na)isNaN(S.targetType)&&
(S.targetType=1),S.assetId=S.assetId||S.solutionId,S.storeId=S.storeId||"en-US",S.storeType=S.storeType||"omex",S.assetStoreId=S.assetStoreId||"omex",isNaN(S.width)&&(S.width=0),isNaN(S.height)&&(S.height=0)}static MNb(na){const S={};let Ja=0;Ja<na.length&&0<na[Ja].trim().length&&na[Ja].trim().toLowerCase().startsWith("wa")&&(S.solutionId=na[Ja].trim(),S.addinInfo=Object.assign(new fa,{priority:Number.NaN,AUP:Number.NaN}),++Ja<na.length&&0<na[Ja].trim().length&&(S.addinInfo.priority=parseInt(na[Ja].trim())),
++Ja<na.length&&0<na[Ja].trim().length&&(S.addinInfo.AUP=parseInt(na[Ja].trim())),++Ja<na.length&&0<na[Ja].trim().length&&(S.displayName=na[Ja].trim()),++Ja<na.length&&0<na[Ja].trim().length&&(S.iconUrl=na[Ja].trim()),++Ja<na.length&&0<na[Ja].trim().length&&(S.description=na[Ja].trim()));return S.solutionId?S:null}static HCb(na,S){na=na.Ra("AddinImageStoreServiceUrl");if(!na)return S;na=na.toLowerCase();return na.startsWith("http://")||na.startsWith("https://")?na:S}}Object(b.a)(Oa,"AddinDetailsManager",
null,[381,382]);class eb{constructor(na,S){this.failure=null;this.tX=na;this.errorCode=void 0===S?0:S}}Object(b.a)(eb,"AddinQueryResult",null,[]);class nb extends eb{constructor(na,S){super(na,void 0===S?0:S);this.solutionIds=null}}Object(b.a)(nb,"AddinCollection",eb,[]);var $a;(function(na){na[na.stop=-1]="stop";na[na.y5j=0]="skip";na[na.query=1]="query"})($a||($a={}));Object(b.b)("QueryStrategy",$a);var oa=a(914);class Fa{constructor(na,S,Ja){Ja=void 0===Ja?null:Ja;this.$b=new e.a;this.Dr=new P.a(K.a.Ei());
this.Gl=new T.a;this.oP=new T.a;this.XIa=null;this.WCa=(rb,ma,ib)=>{if(ib)if(Fa.NJb(rb,ib,window.performance.now()-ma),0===ib.errorCode){let Qb;if(ib.value){let Fc=0;Qb=Array(ib.value.length);ib.value.forEach(jd=>{Qb[Fc++]=jd})}else Qb=[];this.Px(new eb(rb),Qb)}else-1===ib.errorCode||10===ib.errorCode?this.Px(new eb(rb),[]):(rb=this.z8c(rb,ma,ib),this.Px(rb));else rb=Fa.A8c(rb,ma),this.Px(rb)};this.Zpa=(rb,ma)=>{if(0!==ma.errorCode)this.Gl.fa(ma.dC,Object.assign(new nb(ma.dC,ma.errorCode),{failure:ma.failure}));
else{rb=Object.assign(new nb(ma.dC),{solutionIds:new ca.a});var ib=ma.av;for(const Qb of ib)ib=Qb.solutionId,this.Dr.Hd(ib)?this.Dr.fa(ib,this.FKb(this.Dr.ka(ib),ma.dC,Qb)):this.Dr.add(ib,Qb),rb.solutionIds.add(ib);this.Gl.fa(ma.dC,rb);this.U$(rb.tX,1)}};this.MW=new Ca.a;this.MW.add(OSF.StoreTypeEnum.MarketPlace,0);this.MW.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Qa=na;this.jm=S;this.au=Ja;this.Iob=Fa.HCb(na,"https://store-images.s-microsoft.com");this.iwa(this.Zpa)}get YQd(){return!!this.Qa&&
this.Qa.isChangeGateEnabled("QueryPopularForOmexOnlyEnabled")}get dG(){return!!this.Qa&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get isAnonymousUser(){return!!this.Qa&&this.Qa.na("IsAnonymousUser")}get Cld(){return!!this.Qa&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get iBb(){return!!this.Qa&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get o8(){return this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",
!1)}get Qh(){return this.jm.value}nN(na){if(this.dG&&!this.Aoa(na))return new ra(0);if(!this.e9(na))return na=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Q.a[na]}),Object.assign(new ra(1),{failure:na});if(this.Gl.ka(na).failure)return Object.assign(new ra(this.Gl.ka(na).errorCode),{failure:this.Gl.ka(na).failure});h.ULS.shipAssertTag(509870082,220,!!this.Gl.ka(na).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",
na);const S=new ra(0);for(const Ja of this.Gl.ka(na).solutionIds)this.Dr.Hd(Ja)&&Array.add(S.av,this.Dr.ka(Ja));return S}eza(na){return this.Dr.Hd(na)?this.Dr.ka(na):null}dra(na){if(na){this.iwa(na);for(const S of this.Gl.keys){if(this.dG&&!this.Aoa(S))continue;if(!this.e9(S)||this.Gl.ka(S).failure)continue;h.ULS.shipAssertTag(509870081,220,!!this.Gl.ka(S).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",S);const Ja=[],rb=this.Gl.ka(S);for(const ma of rb.solutionIds)Array.add(Ja,
this.Dr.ka(ma));na(null,new Ea(S,rb.errorCode,Ja,rb.failure))}}}get name(){return"AddinDetailsManager1"}jVa(na,S){if(this.dG&&Fa.MRa(na)){var Ja=ma=>{this.Px(Fa.mLa(ma,4,"The connected service is disabled."));this.U$(ma,-1)},rb=ma=>{this.Px(Fa.mLa(ma,0,"The user doesn't have any addin installed."),[]);this.U$(ma,0)};0===na?(this.pFb(0,S,Ja,rb),this.pFb(2,S,Ja,()=>{this.RUa(this.WCa)})):10===na&&this.U$(1,1)}}Sz(na,S){Fa.MRa(na)?this.MOb(na,this.WCa,void 0===S?!1:S):h.ULS.sendTraceTag(509870080,220,
50,"QueryAddinDetails: skipping providerType: {0}.",wa.a[na])}iwa(na){this.$b.addHandler(Z.a.h3a,na)}pFb(na,S,Ja,rb){this.Aoa(na)||(3===S&&Ja?Ja(na):2===S&&rb?rb(na):this.U$(na,1))}Aoa(na){return this.oP.Hd(na)}U$(na,S){if(this.dG){var Ja=this.Aoa(na);if(!Ja||-1!==this.oP.ka(na)&&this.oP.ka(na)!==S)h.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",Q.a[na],Ja?$a[this.oP.ka(na)]:"undefined",$a[S]),this.oP.fa(na,S)}}z8c(na,S,Ja){const rb={};rb.collectionType=
Q.a[na];rb.invokeResultCode=Ja.errorCode;rb["queryResult.Value"]=Ja.value?String.format("Length: {0}",Ja.value.length):"null";rb.queryStart=S;rb.queryDuration=window.performance.now()-S;return Object.assign(new eb(na,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",rb)})}b0j(){return this.e9(2)?this.Qa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins")?3===this.Gl.ka(2).errorCode:!1:!0}BTb(na){return this.dG&&this.oP.Hd(na)?1===this.oP.ka(na):!0}MOb(na,
S,Ja){Ja=void 0===Ja?!1:Ja;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",na);if(na!==OSF.StoreTypeEnum.MarketPlace&&na!==OSF.StoreTypeEnum.PrivateCatalog)h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",na);else{var rb=this.MW.ka(na);this.c0j(na)&&this.BTb(2)&&this.RUa(S);this.BTb(rb)&&(this.iBb&&this.isAnonymousUser?(na=Fa.n8c(rb),this.Px(na)):this.VQd(na,S,Ja))}}c0j(na){return this.YQd?na===OSF.StoreTypeEnum.MarketPlace:!0}VQd(na,S,Ja){this.queryStoreDisabled(na,
(rb,ma)=>{if(rb===OSF.StoreTypeEnum.MarketPlace&&ma)ma=Fa.pLa(0),this.Px(ma);else if(rb===OSF.StoreTypeEnum.PrivateCatalog&&ma)ma=Fa.pLa(1),this.Px(ma);else{var ib=window.performance.now();this.Qh.getEntitlementDetails(Object.assign(new la,{storeType:rb,refresh:Ja}),Qb=>{S(this.MW.ka(rb),ib,Qb)})}})}RUa(na){this.b0j()&&this.queryStoreDisabled(0,(S,Ja)=>{Ja?(S=Fa.pLa(2),this.Px(S)):(S=window.performance.now(),na(2,S,this.Gqd()))})}Px(na,S){S=void 0===S?null:S;0!==na.errorCode?(h.ULS.shipAssertTag(509116673,
220,!S,"The parameter addinDetails must be null for any failed queries"),h.ULS.shipAssertTag(509116672,220,!!na.failure,"The result.Failure must not be available for any failed queries"),this.C1d(na)?h.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",Q.a[na.tX],oa.a[na.errorCode],na.failure?na.failure.toString():"null",JSON.stringify(na.failure)):h.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}",
"(downgraded error)",Q.a[na.tX],oa.a[na.errorCode],na.failure?na.failure.toString():"null",JSON.stringify(na.failure))):(h.ULS.shipAssertTag(509116643,220,!!S,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",Q.a[na.tX]),h.ULS.sendTraceTag(509116642,220,50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails",Q.a[na.tX],S?S.length:-1));na=new Ea(na.tX,na.errorCode,S,na.failure);this.$b.raiseEvent(Z.a.h3a,na)}C1d(na){return 3===
na.errorCode&&(this.iBb&&-2147208619===Fa.KCb(na)||this.Cld&&-2===Fa.KCb(na))||4===na.errorCode?!1:2!==na.errorCode}e9(na){return this.Gl.Hd(na)?!!this.Dr:!1}get pub(){return this.au?!this.au.AreThirdPartyAddInsAllowed||this.au.AppsForOfficeThirdPartyIsDisabled:!this.Qa.na("AreThirdPartyAddInsAllowed")||this.Qa.na("AppsForOfficeThirdPartyIsDisabled")}get dHb(){return this.au?!this.au.AppsForOfficeAllowExternalMarketplace:!this.Qa.na("AppsForOfficeAllowExternalMarketplace")}get Iqa(){return this.au?
this.au.PopularAddinDetailsJsonString:this.Qa.Ra("PopularAddinDetailsJsonString")}queryStoreDisabled(na,S){if(this.pub)S(na,!0);else if(na===OSF.StoreTypeEnum.MarketPlace&&this.dHb)S(na,!0);else{const Ja=Fa.BVb(na);if(Ja){const rb=window.performance.now();this.Qh.queryStoreDisabled(Ja,ma=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",na,ma,rb,window.performance.now()-rb);S(na,ma)})}else S(na,!1)}}FKb(na,S,Ja){return na?
Ja?2===S?Fa.kCa(Ja,na):Fa.kCa(na,Ja):na:Ja}Gqd(){if(!this.XIa){const na=JSON.parse(this.Iqa);this.h8a(na);this.XIa=na}return Fa.B4a(0,this.XIa)}h8a(na){Fa.eub(na);this.D3a(na);this.WAb(na)}D3a(na){const S=this.qvb();for(var Ja=0;Ja<na.length&&0<S.count;Ja++){const rb=na[Ja];if(S.Hd(rb.solutionId)){let ma=String.format("Found an override, solutionId: {0}",rb.solutionId);const ib=S.ka(rb.solutionId);ib&&(isNaN(ib.addinInfo.priority)||(ma=String.format("{0}; AddinInfo.Priority: update {1} to {2}",ma,
rb.addinInfo.priority,ib.addinInfo.priority),rb.addinInfo.priority=ib.addinInfo.priority),isNaN(ib.addinInfo.AUP)||(ma=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ma,rb.addinInfo.AUP,ib.addinInfo.AUP),rb.addinInfo.AUP=ib.addinInfo.AUP),ib.displayName&&(ma=String.format("{0}; DisplayName: update {1} to {2}",ma,rb.displayName,ib.displayName),rb.displayName=ib.displayName),ib.iconUrl&&(ma=String.format("{0}; IconUrl: update {1} to {2}",ma,rb.iconUrl,ib.iconUrl),rb.iconUrl=ib.iconUrl),ib.description&&
(ma=String.format("{0}; Description: update {1} to {2}",ma,rb.description,ib.description),rb.description=ib.description));S.remove(rb.solutionId);this.o8&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ma)}}for(const rb of S.keys)Ja=S.ka(rb),Ja.displayName&&Ja.iconUrl&&Ja.addinInfo&&(na.push(Ja),this.o8&&h.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",JSON.stringify(Ja)))}qvb(){const na=new P.a(K.a.Ei());
let S=this.Qa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!S)return na;S=S.trim();if(12>=S.length)return 0<S.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",S),na;this.o8&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",S);try{const Ja=[],rb=S.split("|");for(let ma=rb.length-1;0<=ma;ma--){const ib=rb[ma],Qb=ib.split("\\");if(2>Qb.length){Ja.push(ib);continue}const Fc=
Fa.MNb(Qb);Fc?na.Hd(Fc.solutionId)||na.add(Fc.solutionId,Fc):Ja.push(ib)}this.o8&&0<Ja.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ja.join("|"));this.o8&&0<na.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",na.count,JSON.stringify(Ga.toArray(na.values)));return na}catch(Ja){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
S,Ja.toString())}return na}WAb(na){for(let S=0;S<na.length;S++)ta.c(na[S].iconUrl.toLowerCase(),"http",0)||(na[S].iconUrl=String.format("{0}/image/apps.{1}",this.Iob,na[S].iconUrl))}static MRa(na){return 0===na||10===na}static A8c(na,S){const Ja={};Ja.collectionType=Q.a[na];Ja.queryResult="null";Ja.queryStart=S;Ja.queryDuration=window.performance.now()-S;return Object.assign(new eb(na,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ja)})}static mLa(na,S,Ja){const rb={};rb.collectionType=
Q.a[na];na=new eb(na,S);0!==S&&(na.failure=Error.create(Ja,rb));return na}static pLa(na){return Fa.mLa(na,2,"The store is disabled.")}static n8c(na){const S={};S.collectionType=Q.a[na];S.invokeResultCode=-2147208619;S.queryDuration=0;return Object.assign(new eb(na,3),{failure:Error.create("Anonymous users do not have installed add-ins.",S)})}static KCb(na){return na.failure?na.failure.invokeResultCode:-1E3}static NJb(na,S,Ja){const rb={};rb.AddinCollectionType=Q.a[na];rb.ErrorCode=S.errorCode;rb.AddinCount=
S.value?S.value.length:0;na=window.performance.now();S=Date.now()-x.AFrameworkApplication.g1;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Ja,na,S,JSON.stringify(rb))}static B4a(na,S){const Ja={};Ja.errorCode=na;Ja.value=S;return Ja}static BVb(na){return na===OSF.StoreTypeEnum.MarketPlace?"omex":na===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static kCa(na,S){S.solutionId=S.solutionId||
na.solutionId;S.version=S.version||na.version;S.storeType=S.storeType||na.storeType;S.storeId=S.storeId||na.storeId;S.assetId=S.assetId||na.assetId;S.assetStoreId=S.assetStoreId||na.assetStoreId;S.displayName=S.displayName||na.displayName;S.provider=S.provider||na.provider;S.description=S.description||na.description;S.iconUrl=S.iconUrl||na.iconUrl;S.webApplicationId=S.webApplicationId||na.webApplicationId;S.highResolutionIconUrl=S.highResolutionIconUrl||na.highResolutionIconUrl;S.licenseUrl=S.licenseUrl||
na.licenseUrl;S.privacyUrl=S.privacyUrl||na.privacyUrl;S.addinInfo=S.addinInfo||na.addinInfo;isNaN(S.targetType)&&(S.targetType=na.targetType);isNaN(S.height)&&(S.height=na.height);isNaN(S.width)&&(S.width=na.width);return S}static eub(na){for(const S of na)isNaN(S.targetType)&&(S.targetType=1),S.assetId=S.assetId||S.solutionId,S.storeId=S.storeId||"en-US",S.storeType=S.storeType||"omex",S.assetStoreId=S.assetStoreId||"omex",isNaN(S.width)&&(S.width=0),isNaN(S.height)&&(S.height=0)}static MNb(na){const S=
{};let Ja=0;Ja<na.length&&0<na[Ja].trim().length&&na[Ja].trim().toLowerCase().startsWith("wa")&&(S.solutionId=na[Ja].trim(),S.addinInfo=Object.assign(new fa,{priority:Number.NaN,AUP:Number.NaN}),++Ja<na.length&&0<na[Ja].trim().length&&(S.addinInfo.priority=parseInt(na[Ja].trim())),++Ja<na.length&&0<na[Ja].trim().length&&(S.addinInfo.AUP=parseInt(na[Ja].trim())),++Ja<na.length&&0<na[Ja].trim().length&&(S.displayName=na[Ja].trim()),++Ja<na.length&&0<na[Ja].trim().length&&(S.iconUrl=na[Ja].trim()),++Ja<
na.length&&0<na[Ja].trim().length&&(S.description=na[Ja].trim()));return S.solutionId?S:null}static HCb(na,S){na=na.Ra("AddinImageStoreServiceUrl");if(!na)return S;na=na.toLowerCase();return na.startsWith("http://")||na.startsWith("https://")?na:S}}Object(b.a)(Fa,"AddinDetailsManager1",null,[381,382]);class X{constructor(na,S){this.description=this.provider=this.displayName=this.assetStoreId=this.assetId=this.storeId=this.storeType=this.version=this.solutionId=this.addinInfo=null;this.width=this.height=
this.targetType=0;this.privacyUrl=this.licenseUrl=this.highResolutionIconUrl=this.webApplicationId=this.iconUrl=null;this.solutionId=na.solutionId;this.version=na.version;this.storeType=na.storeType;this.storeId=na.storeId;this.assetId=na.assetId;this.assetStoreId=na.assetStoreId;this.displayName=na.displayName;this.provider=na.provider;this.description=na.description;this.targetType=na.targetType;this.height=na.height;this.width=na.width;this.iconUrl=na.iconUrl;this.webApplicationId=na.webApplicationId;
this.highResolutionIconUrl=na.highResolutionIconUrl;this.licenseUrl=na.licenseUrl;this.privacyUrl=na.privacyUrl;this.addinInfo=void 0===S?null:S}zVb(){const na={};na.solutionId=this.solutionId;na.version=this.version;na.storeType=this.storeType;na.storeId=this.storeId;na.assetId=this.assetId;na.assetStoreId=this.assetStoreId;na.targetType=this.targetType;na.displayName=this.displayName;na.width=this.width;na.height=this.height;return na}}Object(b.a)(X,"AddinDetail",null,[]);class va{constructor(na,
S,Ja,rb,ma){this.Z3b=null;this.Qa=na;this.jm=S;this.YIa=Ja;this.UOg=rb;this.hnb=ma}Sz(na,S){this.Qh.queryAppDetails(this.UOg,this.hnb,this.solutionIds,na,(Ja,rb)=>{let ma=null;if(rb){ma=Array(rb.length);for(let ib=0;ib<rb.length;ib++)ma[ib]=new X(rb[ib],this.jWi(rb[ib].solutionId))}S(Ja,ma||[])})}get wGi(){return!!this.Qh.queryAppDetails}jWi(na){return this.YIa.ka(na)}get solutionIds(){if(!this.Z3b){this.Z3b=new ca.a;for(const na of this.YIa.keys)this.Z3b.add(ta.d(na))}return this.Z3b.toArray()}get Qh(){return this.jm.value}}
Object(b.a)(va,"AddinDetailsLoader",null,[]);class xa{constructor(na,S){this.failure=null;this.tX=na;this.errorCode=void 0===S?0:S}}Object(b.a)(xa,"AddinQueryResult",null,[]);class Pa extends xa{constructor(na,S){super(na,void 0===S?0:S);this.C4d=this.solutionIds=null}}Object(b.a)(Pa,"AddinCollection",xa,[]);var Ka=a(732);class Bb extends Ka.a{constructor(){super(K.a.Ei())}}Object(b.a)(Bb,"AddinDetailTable",Ka.a,[]);var xb;(function(na){na[na.stop=-1]="stop";na[na.y5j=0]="skip";na[na.query=1]="query"})(xb||
(xb={}));Object(b.b)("QueryStrategy",xb);class Ua{constructor(na,S,Ja){Ja=void 0===Ja?null:Ja;this.$b=new e.a;this.Dr=new P.a(K.a.Ei());this.Gl=new T.a;this.oP=new T.a;this.YIa=this.rPc=null;this.WCa=(rb,ma,ib)=>{ib?(Ua.NJb(rb,ib,window.performance.now()-ma),0===ib.errorCode?(ma=ib.value?Ua.U3g(ib.value):[],this.Px(new xa(rb),ma)):-1===ib.errorCode||10===ib.errorCode?this.Px(new xa(rb),[]):(rb=this.z8c(rb,ma,ib),this.Px(rb))):(rb=Ua.A8c(rb,ma),this.Px(rb))};this.Zpa=(rb,ma)=>{if(0!==ma.errorCode&&
5!==ma.errorCode)this.aug(ma.dC,Object.assign(new Pa(ma.dC,ma.errorCode),{failure:ma.failure}));else{rb=Object.assign(new Pa(ma.dC,ma.errorCode),{solutionIds:new ca.a,C4d:new ca.a});var ib=ma.av;for(const Fc of ib){ib=Fc.solutionId;const jd=Fc.storeId;if(this.Dr.Hd(ib)){var Qb=this.Dr.ka(ib);Qb.Hd(jd)?Qb.fa(jd,this.FKb(Qb.ka(jd),ma.dC,Fc)):Qb.add(jd,Fc)}else Qb=new Bb,Qb.add(jd,Fc),this.Dr.add(ib,Qb);rb.solutionIds.add(ib);rb.C4d.add(jd)}this.aug(ma.dC,rb)}};this.MW=new Ca.a;this.MW.add(OSF.StoreTypeEnum.MarketPlace,
0);this.MW.add(OSF.StoreTypeEnum.PrivateCatalog,1);this.Qa=na;this.jm=S;this.au=Ja;this.Iob=Ua.HCb(na,"https://store-images.s-microsoft.com");this.SYc=null;this.iwa(this.Zpa)}get h9b(){if(!this.rPc){const na=JSON.parse(this.Iqa);this.h8a(na);this.rPc=na}return this.rPc}get YQd(){return!!this.Qa&&this.Qa.isChangeGateEnabled("QueryPopularForOmexOnlyEnabled")}get dG(){return!!this.Qa&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",!1)}get isAnonymousUser(){return!!this.Qa&&
this.Qa.na("IsAnonymousUser")}get Cld(){return!!this.Qa&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNoMailboxFixEnabled",!0)}get iBb(){return!!this.Qa&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutUserNotSignedInFixEnabled",!0)}get o8(){return this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutDiagnosticTraceEnabled",!1)}get Qh(){return this.jm.value}get MOd(){this.SYc||(this.SYc=new va(this.Qa,this.jm,this.Bnj,0,this.Qh.getAppUILocale()));
return this.SYc}nN(na){if(this.dG&&!this.Aoa(na))return new ra(0);if(!this.e9(na))return na=Error.create("AddinDetails is not ready yet",{["errorCode"]:1,["collectionType"]:Q.a[na]}),Object.assign(new ra(1),{failure:na});const S=this.Gl.ka(na);if(S.failure)return Object.assign(new ra(S.errorCode),{failure:S.failure});h.ULS.shipAssertTag(509870082,220,!!S.solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",na);const Ja=new ra(S.errorCode);for(let rb=
0;rb<S.solutionIds.count;rb++){const ma=S.solutionIds.ka(rb),ib=S.C4d.ka(rb);if(this.Dr.Hd(ma)){const Qb=this.Dr.ka(ma);Qb.Hd(ib)?Array.add(Ja.av,Qb.ka(ib)):h.ULS.sendTraceTag(508610437,220,15,"The addin with solutionId '{0}' in '{1}' must contain storeId '{2}' when the collection is ready.",ma,na,ib)}else h.ULS.sendTraceTag(508610436,220,15,"The addin with solutionId '{0}' in '{1}' must exist when the collection is ready.",ma,na)}return Ja}eza(na,S){S=void 0===S?null:S;if(na=this.y1h(na))if(S||(S=
this.uiCulture),na.Hd(S))return na.ka(S);return null}y1h(na){return this.Dr.Hd(na)?this.Dr.ka(na):null}dra(na){if(na){this.iwa(na);for(const S of this.Gl.keys){if(this.dG&&!this.Aoa(S))continue;if(!this.e9(S)||this.Gl.ka(S).failure)continue;h.ULS.shipAssertTag(509870081,220,!!this.Gl.ka(S).solutionIds,"_addinCollectionDict[{0}].SolutionIds must be valid when the collectionType is ready.",S);const Ja=[],rb=this.Gl.ka(S);for(const ma of rb.solutionIds)Array.add(Ja,this.Dr.ka(ma));na(null,new Ea(S,rb.errorCode,
Ja,rb.failure))}}}get name(){return"AddinDetailsManager2"}jVa(na,S){if(this.dG&&Ua.MRa(na)){var Ja=ma=>{this.Px(Ua.mLa(ma,4,"The connected service is disabled."));this.U$(ma,-1)},rb=ma=>{this.Px(Ua.mLa(ma,0,"The user doesn't have any addin installed."),[]);this.U$(ma,0)};0===na?(this.pFb(0,S,Ja,rb),this.pFb(2,S,Ja,()=>{this.RUa(this.WCa,this.h9b)})):10===na&&this.U$(1,1)}}Sz(na,S){Ua.MRa(na)?this.MOb(na,this.WCa,void 0===S?!1:S):h.ULS.sendTraceTag(509870080,220,50,"QueryAddinDetails: skipping providerType: {0}.",
wa.a[na])}iwa(na){this.$b.addHandler(Z.a.h3a,na)}pFb(na,S,Ja,rb){this.Aoa(na)||(3===S&&Ja?Ja(na):2===S&&rb?rb(na):this.U$(na,1))}Aoa(na){return this.oP.Hd(na)}U$(na,S){if(this.dG){var Ja=this.Aoa(na);if(!Ja||-1!==this.oP.ka(na)&&this.oP.ka(na)!==S)h.ULS.sendTraceTag(508610435,220,50,"RegisterCollectionType: collectionType: {0}, strategy: {1} -> {2}.",Q.a[na],Ja?xb[this.oP.ka(na)]:"undefined",xb[S]),this.oP.fa(na,S)}}z8c(na,S,Ja){const rb={};rb.collectionType=Q.a[na];rb.invokeResultCode=Ja.errorCode;
rb["queryResult.Value"]=Ja.value?String.format("Length: {0}",Ja.value.length):"null";rb.queryStart=S;rb.queryDuration=window.performance.now()-S;return Object.assign(new xa(na,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",rb)})}H1d(na){if(this.YQd&&na!==OSF.StoreTypeEnum.MarketPlace)return!1;if(this.BTb(2)){if(!this.e9(2))return!0;if(this.Qa.isChangeGateEnabled("Microsoft.Office.SharedOnline.RequeryPopularAddins"))return 3===this.Gl.ka(2).errorCode}return!1}BTb(na){return this.dG&&
this.oP.Hd(na)?1===this.oP.ka(na):!0}MOb(na,S,Ja){Ja=void 0===Ja?!1:Ja;h.ULS.sendTraceTag(510248470,220,50,"QueryAddinDetailsInternal: storeType: {0}.",na);if(na!==OSF.StoreTypeEnum.MarketPlace&&na!==OSF.StoreTypeEnum.PrivateCatalog)h.ULS.shipAssertTag(509753571,220,!1,"Unsupported storeType: {0}",na);else{var rb=this.MW.ka(na);this.H1d(na)&&this.RUa(S,this.dpj);this.BTb(rb)&&(this.iBb&&this.isAnonymousUser?(na=Ua.n8c(rb),this.Px(na)):this.VQd(na,S,Ja))}}get dpj(){return this.Gl.Hd(2)?null:this.h9b}VQd(na,
S,Ja){this.queryStoreDisabled(na,(rb,ma)=>{if(rb===OSF.StoreTypeEnum.MarketPlace&&ma)ma=Ua.pLa(0),this.Px(ma);else if(rb===OSF.StoreTypeEnum.PrivateCatalog&&ma)ma=Ua.pLa(1),this.Px(ma);else{var ib=window.performance.now();this.Qh.getEntitlementDetails(Object.assign(new la,{storeType:rb,refresh:Ja}),Qb=>{S(this.MW.ka(rb),ib,Qb)})}})}RUa(na,S){na=void 0===na?null:na;S=void 0===S?null:S;null===na&&(na=this.WCa);this.queryStoreDisabled(0,(Ja,rb)=>{rb?(Ja=Ua.pLa(2),this.Px(Ja)):null!=S?this.Px(new xa(2,
5),S):this.Esj(na)})}Px(na,S){S=void 0===S?null:S;0!==na.errorCode&&5!==na.errorCode?(h.ULS.shipAssertTag(509116673,220,!S,"The parameter addinDetails must be null for any failed queries"),h.ULS.shipAssertTag(509116672,220,!!na.failure,"The result.Failure must not be available for any failed queries"),this.C1d(na)?h.ULS.sendTraceTag(510253056,220,10,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","",Q.a[na.tX],oa.a[na.errorCode],na.failure?
na.failure.toString():"null",JSON.stringify(na.failure)):h.ULS.sendTraceTag(508610434,220,50,"NotifyAddinDetailsRefreshedHandlers{0}: collectionType '{1}'; errorCode: {2}; failure: {3}; errorInfo: {4}","(downgraded error)",Q.a[na.tX],oa.a[na.errorCode],na.failure?na.failure.toString():"null",JSON.stringify(na.failure))):(h.ULS.shipAssertTag(509116643,220,!!S,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}' - The parameter addinDetails is null.",Q.a[na.tX]),h.ULS.sendTraceTag(509116642,220,
50,"NotifyAddinDetailsRefreshedHandlers: collectionType '{0}'; contains {1} addinDetails, errorCode: {2}",Q.a[na.tX],S?S.length:-1,oa.a[na.errorCode]));na=new Ea(na.tX,na.errorCode,S,na.failure);this.$b.raiseEvent(Z.a.h3a,na)}C1d(na){return 3===na.errorCode&&(this.iBb&&-2147208619===Ua.KCb(na)||this.Cld&&-2===Ua.KCb(na))||4===na.errorCode?!1:2!==na.errorCode}aug(na,S){this.Gl.fa(na,S);this.U$(na,1)}e9(na){return this.Gl.Hd(na)?!!this.Dr:!1}get uiCulture(){return this.au&&this.au.UICulture?this.au.UICulture:
x.AFrameworkApplication.uiCulture}get pub(){return this.au?!this.au.AreThirdPartyAddInsAllowed||this.au.AppsForOfficeThirdPartyIsDisabled:!this.Qa.na("AreThirdPartyAddInsAllowed")||this.Qa.na("AppsForOfficeThirdPartyIsDisabled")}get dHb(){return this.au?!this.au.AppsForOfficeAllowExternalMarketplace:!this.Qa.na("AppsForOfficeAllowExternalMarketplace")}get Bnj(){if(!this.YIa){this.YIa=new P.a(K.a.Ei());const na=JSON.parse(this.Iqa);for(const S of na)this.YIa.add(S.solutionId,S.addinInfo)}return this.YIa}get Iqa(){return this.au?
this.au.PopularAddinDetailsJsonString:this.Qa.Ra("PopularAddinDetailsJsonString")}queryStoreDisabled(na,S){if(this.pub)S(na,!0);else if(na===OSF.StoreTypeEnum.MarketPlace&&this.dHb)S(na,!0);else{const Ja=Ua.BVb(na);if(Ja){const rb=window.performance.now();this.Qh.queryStoreDisabled(Ja,ma=>{h.ULS.sendTraceTag(509679070,220,50,"queryStoreDisabled: storeType: {0}, disabled: {1}, queryStart: {2}, queryDuration: {3}",na,ma,rb,window.performance.now()-rb);S(na,ma)})}else S(na,!1)}}FKb(na,S,Ja){return na?
Ja?2===S?Ua.kCa(Ja,na):Ua.kCa(na,Ja):na:Ja}Esj(na){const S=window.performance.now();if(this.MOd&&this.MOd.wGi)this.MOd.Sz(!1,(rb,ma)=>{this.D3a(ma);na(2,S,Ua.B4a(rb,ma))});else{var Ja=JSON.parse(this.Iqa);this.h8a(Ja);na(2,S,Ua.B4a(0,Ja))}}h8a(na){Ua.eub(na);this.D3a(na);this.WAb(na)}D3a(na){const S=this.qvb();for(var Ja=0;Ja<na.length&&0<S.count;Ja++){const rb=na[Ja];if(S.Hd(rb.solutionId)){let ma=String.format("Found an override, solutionId: {0}",rb.solutionId);const ib=S.ka(rb.solutionId);ib&&
(isNaN(ib.addinInfo.priority)||(ma=String.format("{0}; AddinInfo.Priority: update {1} to {2}",ma,rb.addinInfo.priority,ib.addinInfo.priority),rb.addinInfo.priority=ib.addinInfo.priority),isNaN(ib.addinInfo.AUP)||(ma=String.format("{0}; AddinInfo.AUP: update {1} to {2}",ma,rb.addinInfo.AUP,ib.addinInfo.AUP),rb.addinInfo.AUP=ib.addinInfo.AUP),ib.displayName&&(ma=String.format("{0}; DisplayName: update {1} to {2}",ma,rb.displayName,ib.displayName),rb.displayName=ib.displayName),ib.iconUrl&&(ma=String.format("{0}; IconUrl: update {1} to {2}",
ma,rb.iconUrl,ib.iconUrl),rb.iconUrl=ib.iconUrl),ib.description&&(ma=String.format("{0}; Description: update {1} to {2}",ma,rb.description,ib.description),rb.description=ib.description));S.remove(rb.solutionId);this.o8&&h.ULS.sendTraceTag(509379136,220,50,"ApplyOverridesToPopularAddinDetails: {0}.",ma)}}for(const rb of S.keys)Ja=S.ka(rb),Ja.displayName&&Ja.iconUrl&&Ja.addinInfo&&(na.push(Ja),this.o8&&h.ULS.sendTraceTag(509379107,220,50,"ApplyOverridesToPopularAddinDetails: append an override to popular addins: {0}.",
JSON.stringify(Ja)))}qvb(){const na=new P.a(K.a.Ei());let S=this.Qa.getStringFeatureGate("Microsoft.Office.SharedOnline.CustomizablePopularAddins","");if(!S)return na;S=S.trim();if(12>=S.length)return 0<S.length&&h.ULS.sendTraceTag(509379106,220,10,"BuildPopularAddinDetailOverrides: skipping the overrides: {0}.",S),na;this.o8&&h.ULS.sendTraceTag(509379105,220,50,"BuildPopularAddinDetailOverrides: overrideString: {0}.",S);try{const Ja=[],rb=S.split("|");for(let ma=rb.length-1;0<=ma;ma--){const ib=
rb[ma],Qb=ib.split("\\");if(2>Qb.length){Ja.push(ib);continue}const Fc=Ua.MNb(Qb);Fc?na.Hd(Fc.solutionId)||na.add(Fc.solutionId,Fc):Ja.push(ib)}this.o8&&0<Ja.length&&h.ULS.sendTraceTag(509379104,220,10,"BuildPopularAddinDetailOverrides: skipped records: {0}.",Ja.join("|"));this.o8&&0<na.count&&h.ULS.sendTraceTag(509379103,220,50,"BuildPopularAddinDetailOverrides: {0} valid overrides: {1}.",na.count,JSON.stringify(Ga.toArray(na.values)));return na}catch(Ja){h.ULS.sendTraceTag(509379102,220,10,"BuildPopularAddinDetailOverrides: failed in parsing the overrideString: {0}; exception: {1}.",
S,Ja.toString())}return na}WAb(na){for(let S=0;S<na.length;S++)ta.c(na[S].iconUrl.toLowerCase(),"http",0)||(na[S].iconUrl=String.format("{0}/image/apps.{1}",this.Iob,na[S].iconUrl))}static MRa(na){return 0===na||10===na}static A8c(na,S){const Ja={};Ja.collectionType=Q.a[na];Ja.queryResult="null";Ja.queryStart=S;Ja.queryDuration=window.performance.now()-S;return Object.assign(new xa(na,3),{failure:Error.create("QueryAddinDetails hit an invocation failure",Ja)})}static mLa(na,S,Ja){const rb={};rb.collectionType=
Q.a[na];na=new xa(na,S);0!==S&&(na.failure=Error.create(Ja,rb));return na}static pLa(na){return Ua.mLa(na,2,"The store is disabled.")}static n8c(na){const S={};S.collectionType=Q.a[na];S.invokeResultCode=-2147208619;S.queryDuration=0;return Object.assign(new xa(na,3),{failure:Error.create("Anonymous users do not have installed add-ins.",S)})}static KCb(na){return na.failure?na.failure.invokeResultCode:-1E3}static NJb(na,S,Ja){const rb={};rb.AddinCollectionType=Q.a[na];rb.ErrorCode=S.errorCode;rb.AddinCount=
S.value?S.value.length:0;na=window.performance.now();S=Date.now()-x.AFrameworkApplication.g1;h.ULS.sendTraceTag(512231322,220,50,"AddinDetailsManager.LogQueryCompletedResult - Time elapsed: {0} ms; window: {1} ms; framework: {2} ms; fields: {3}",Ja,na,S,JSON.stringify(rb))}static B4a(na,S){const Ja={};Ja.errorCode=na;Ja.value=S;return Ja}static BVb(na){return na===OSF.StoreTypeEnum.MarketPlace?"omex":na===OSF.StoreTypeEnum.PrivateCatalog?"excatalog":null}static kCa(na,S){S.solutionId=S.solutionId||
na.solutionId;S.version=S.version||na.version;S.storeType=S.storeType||na.storeType;S.storeId=S.storeId||na.storeId;S.assetId=S.assetId||na.assetId;S.assetStoreId=S.assetStoreId||na.assetStoreId;S.displayName=S.displayName||na.displayName;S.provider=S.provider||na.provider;S.description=S.description||na.description;S.iconUrl=S.iconUrl||na.iconUrl;S.webApplicationId=S.webApplicationId||na.webApplicationId;S.highResolutionIconUrl=S.highResolutionIconUrl||na.highResolutionIconUrl;S.licenseUrl=S.licenseUrl||
na.licenseUrl;S.privacyUrl=S.privacyUrl||na.privacyUrl;S.addinInfo=S.addinInfo||na.addinInfo;isNaN(S.targetType)&&(S.targetType=na.targetType);isNaN(S.height)&&(S.height=na.height);isNaN(S.width)&&(S.width=na.width);return S}static U3g(na){const S=Array(na.length);for(let Ja=0;Ja<S.length;Ja++)S[Ja]=new X(na[Ja],na[Ja].addinInfo);return S}static eub(na){for(const S of na)isNaN(S.targetType)&&(S.targetType=1),S.assetId=S.assetId||S.solutionId,S.storeId=S.storeId||"en-US",S.storeType=S.storeType||"omex",
S.assetStoreId=S.assetStoreId||"omex",isNaN(S.width)&&(S.width=0),isNaN(S.height)&&(S.height=0)}static MNb(na){const S={};let Ja=0;Ja<na.length&&0<na[Ja].trim().length&&na[Ja].trim().toLowerCase().startsWith("wa")&&(S.solutionId=na[Ja].trim(),S.addinInfo=Object.assign(new fa,{priority:Number.NaN,AUP:Number.NaN}),++Ja<na.length&&0<na[Ja].trim().length&&(S.addinInfo.priority=parseInt(na[Ja].trim())),++Ja<na.length&&0<na[Ja].trim().length&&(S.addinInfo.AUP=parseInt(na[Ja].trim())),++Ja<na.length&&0<
na[Ja].trim().length&&(S.displayName=na[Ja].trim()),++Ja<na.length&&0<na[Ja].trim().length&&(S.iconUrl=na[Ja].trim()),++Ja<na.length&&0<na[Ja].trim().length&&(S.description=na[Ja].trim()));return S.solutionId?S:null}static HCb(na,S){na=na.Ra("AddinImageStoreServiceUrl");if(!na)return S;na=na.toLowerCase();return na.startsWith("http://")||na.startsWith("https://")?na:S}}Object(b.a)(Ua,"AddinDetailsManager2",null,[380]);class Jb{constructor(na,S){this.Vfb="popular";this.xBe="addinDetails";this.DIe=
"cache-lastUpdate";this.aIe="builtin-lastUpdate";this.MXf=144E5;this.Qa=this.YO=null;this.w4i=(Ja,rb)=>{2===rb.dC&&0===rb.errorCode&&(this.W8c=rb.av,this.w9b=this.now,h.ULS.sendTraceTag(508352221,220,50,"AddinDetailsCacheManager.onAddinDetailsUpdated: cached popular addins were refreshed."))};this.YO=S;this.Qa=na;this.YO.dra(this.w4i);this.MXf=this.Qa.getIntFeatureGate("Microsoft.Office.SharedOnline.PopularCacheExpirationTime",144E5)}get sJi(){return this.w9b?this.now.getTime()-this.w9b.getTime()>=
this.MXf:!0}nN(na){var S=this.YO.nN(na);2===na&&this.rJi(S.errorCode)&&(na=this.W8c,null!=na?(this.sJi&&this.YO.RUa(null,null),S=this.toDateString(this.now),S=this.toDateString(this.D8c)===S?this.l8c(5,this.YO.h9b):this.l8c(0,na)):(Jb.boa&&(S=this.l8c(5,this.YO.h9b)),this.D8c=this.now,this.YO.RUa(null,null)));return S}l8c(na,S){var Ja=void 0===Ja?null:Ja;return Object.assign(new ra(na),{av:S,failure:Ja})}toDateString(na){return na.toISOString().substring(2,16)}get D8c(){const na=Jb.LYa(this.Vfb,this.aIe);
return null!==na?new Date(na):new Date(0)}set D8c(na){Jb.WFa(this.Vfb,na.toISOString(),this.aIe)}get w9b(){const na=Jb.LYa(this.Vfb,this.DIe);return null!==na?new Date(na):new Date(0)}set w9b(na){Jb.WFa(this.Vfb,na.toISOString(),this.DIe)}get W8c(){const na=Jb.LYa(this.Vfb,this.xBe);let S=null;na&&(S=JSON.parse(na));return S}set W8c(na){na=JSON.stringify(na);Jb.WFa(this.Vfb,na,this.xBe)}get now(){return new Date}rJi(na){return 2!==na&&4!==na}eza(na,S){return this.YO.eza(na,void 0===S?null:S)}dra(na){this.YO.dra(na)}get name(){return"AddinDetailsCacheManager"}jVa(na,
S){this.YO.jVa(na,S)}Sz(na,S){this.YO.Sz(na,void 0===S?!1:S)}static LYa(na,S){let Ja=null;try{const rb=Jb.xpg;if(void 0!==rb&&rb){const ma=Z.a.nic(na)+"_"+S;Ja=rb.getItem(ma)}else h.ULS.sendTraceTag(508352219,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(rb){h.ULS.sendTraceTag(508352218,220,10,"Failed to get AddinCommands Cache {0} for suffix {1}.",na,S)}return Ja}static WFa(na,S,Ja){try{const rb=Jb.xpg;if(void 0!==rb&&rb){const ma=Z.a.nic(na)+"_"+Ja;rb.setItem(ma,
S)}else h.ULS.sendTraceTag(508352217,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(rb){h.ULS.sendTraceTag(508352216,220,10,"Failed to set AddinCommands Cache {0} for suffix {1}.",na,Ja)}}static get xpg(){if(!Jb.boa)return null;let na=null;try{na=localStorage}catch(S){Jb.boa=!1,na=null,h.ULS.sendTraceTag(508352215,220,10,`Failed to use localStorage: error name: ${S.name}; message: ${S.message}; stack: ${S.stack}`)}return na}}Jb.boa=!0;Object(b.a)(Jb,"AddinDetailsCacheManager",
null,[381]);class fc{static createInstance(na,S,Ja){Ja=void 0===Ja?null:Ja;na=fc.MIi(na)?fc.P1g(na)?new Jb(na,new Ua(na,S,Ja)):new Fa(na,S,Ja):new Oa(na,S,Ja);h.ULS.sendTraceTag(508352212,220,50,`AddinDetailsManagerFactory.CreateInstance: Creating an instance of ${na.name}`);return na}static MIi(na){return(na||x.AFrameworkApplication.da).getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutNotifyObserverFailuresEnabled",!1)}static P1g(na){return(na||x.AFrameworkApplication.da).getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsCacheManagerEnabled",
!1)}}Object(b.a)(fc,"AddinDetailsManagerFactory",null,[]);var ya=a(865),ob=a(1228),Sb=a(1317),Ba=a(991),Ia=a(190),cb=a(1236),Kb=a(126),db=a(81),gb=a(96),yb=a(664),Nb=a(143),qc=a(353),Gb=a(125),hb=a(566),qb=a(180),ab=a(37),Mb=a(913),Ib=a(1192),fb=a(82);class Db{constructor(){this.command=0;this.properties=null}}Object(b.a)(Db,"DdaRequestInfo",null,[]);var Za=a(772),sb=a(76);class sa extends fb.a{constructor(na,S){super();this.requests=[];this.disposed=this.f$b=!1;this.rj=()=>{if(!this.disposed){this.grid.me.Pp(this.rj);
this.f$b=!1;const Ja=this.requests;this.requests=[];for(let rb of Ja)this.ddaFacade.zN(rb.command,rb.properties)}};this.ddaFacade=na;this.grid=S}Ayh(na,S){this.disposed||(this.f$b||(this.grid.me.yq(this.rj),this.f$b=!0),this.requests.push(Object(c.a)(new Db,{command:na,properties:S})))}dispose(){if(!this.disposed){this.disposed=!0;this.f$b&&this.grid.me.Pp(this.rj);var na=this.requests;this.requests=null;for(let S of na)(na=S.properties?S.properties[sb.a.L7]:null)&&this.ddaFacade.Rj(Za.a.FFb,na);
this.ddaFacade=this.grid=null;super.dispose()}}static Wjh(na,S){var Ja=!1;974713501===na&&(S=(na=S?S[sb.a.di]:null)?na.DdaMethod:null)&&S.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Ja=na.ArrayData,Ja=!!Ja&&64===(Ja[6]&64));return Ja}}Object(b.a)(sa,"DdaCellEditDelayRequestHandler",fb.a,[]);var ba=a(806);class ua extends ba.a{constructor(na,S,Ja,rb,ma,ib,Qb){super(na,S,Ja);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=rb;
this.messageContent=ma;this.messageOrigin=ib;this.targetOrigin=Qb}}Object(b.a)(ua,"DialogMessageReceivedEventArgs",ba.a,[]);class R extends ba.a{constructor(na,S,Ja,rb,ma,ib,Qb){super(na,S,Ja);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=rb;this.messageContent=ma;this.messageOrigin=ib;this.targetOrigin=Qb}}Object(b.a)(R,"DialogParentMessageReceivedEventArgs",ba.a,[]);var Y=a(1),La=a(20);class Ma{constructor(na){this.Qh=this.b6c=null;this.Pcj=(S,
Ja)=>{this.handlers.Hd(Ja.controlId)&&(S=new ua(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Ja.controlId,null,Ja.messageType,Ja.messageContent,Ja.messageOrigin,Ja.targetOrigin),this.handlers.ka(Ja.controlId)(S),Ja.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(Ja.controlId))};this.Ocj=(S,Ja)=>{this.Guc.Hd(Ja.controlId)&&(S=new R(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Ja.controlId,null,Ja.messageType,Ja.messageContent,Ja.messageOrigin,Ja.targetOrigin),
this.Guc.ka(Ja.controlId)(S))};this.handlers=new U.a;this.Guc=new U.a;this.hl=na;this.L6a.k0g(this.Pcj);this.L6a.j0g(this.Ocj)}get L6a(){this.b6c||(this.b6c=L.getInstance(this.contextActivationMgr));return this.b6c}get contextActivationMgr(){!this.Qh&&this.hl&&(this.Qh=this.hl.Qh);return this.Qh}addHandler(na,S,Ja,rb){h.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const ma=ib=>{ib===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.fa(na,S),this.hl.wy(Ja)):
(h.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.hl.Rj(ib,Ja))};this.handlers.Hd(na)?ma(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(na,rb,ma)}BWg(na,S,Ja){h.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!");this.Guc.fa(na,S);this.hl.wy(Ja)}removeHandler(na,S){this.handlers.Hd(na)?(h.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.L6a.Lwb(na,
Ja=>{this.handlers.remove(na);Ja===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.hl.wy(S):(h.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.hl.Rj(Ja,S))})):this.hl.Rj(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,S)}FBj(na,S){h.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!");this.Guc.remove(na);this.hl.wy(S)}showDialog(na,S,Ja){try{Y.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&
La.h(this.hl.$).Kd&&La.h(this.hl.$).Yt(!0),this.L6a.showDialog(S,na,Ja,rb=>{this.hl.RWg(this.Bbh(rb))})}catch(rb){h.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${rb.message}`),Ja(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Bbh(na){const S={};S.InstanceId=na.id;S.WebExtensionType=na.osfControlType===OSF.OsfControlTarget.InContent?0:1;S.PrimaryMarketplace={};S.PrimaryMarketplace.SolutionId=na.solutionId;S.PrimaryMarketplace.SolutionVersion=
na.version;S.PrimaryMarketplace.MarketplaceRef=na.storeId;S.PrimaryMarketplace.MarketplaceType=na.storeType;S.OwnerAddinSolutionId=na.ownerAddinSolutionId;S.OwnerAddinStoreType=na.ownerAddinStoreType;return S}static la(na){if(!na.$.ia.Ja(232)){const S=new Ma(na);na.$.ia.Va(232,S)}}}Object(b.a)(Ma,"DialogMessageReceivedEventManager",null,[811]);class lb{constructor(na,S){this.ZD=null;this.jja=na;this.ORg=S}G6b(na){na&&(this.ZD||(this.ZD=[]),this.ZD.push(na))}cCc(na){this.ZD&&Array.remove(this.ZD,na)}get eventId(){return this.jja}get targetId(){return this.ORg}get fri(){return 0<
this.ZD.length}iYi(na){return this.eventId!==na.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===na.ddaBinding.Name:!0}J9b(na){this.ZD&&Array.forEach(this.ZD,S=>{S(na)})}VDa(){this.ZD=[]}}Object(b.a)(lb,"DdaEventRegistration",null,[]);class pb{constructor(na){this.QH=null;this.mAa=!1;this.Qf=()=>{this.QH.forEach(S=>{S.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&S.J9b(new ba.a(S.eventId,
"",null))})};this.hl=na}invokeDdaMethod(na,S){const Ja={};Ja[sb.a.di]=na;Ja[sb.a.L7]=S;this.hl.zN(974713501,Ja)}registerDdaEventAsync(na,S,Ja,rb,ma){pb.wGb(na)?(pb.dyd(na)&&this.Jud(),this.QH||(this.QH=[]),S=this.KAb(na,Ja),S||(S=new lb(na,Ja),this.QH.push(S)),S.G6b(rb),this.hl.wy(ma)):this.hl.Rj(-1,ma)}unregisterDdaEventAsync(na,S,Ja,rb,ma){pb.wGb(na)?((na=this.KAb(na,Ja))&&na.cCc(rb),this.hl.wy(ma)):this.hl.Rj(-1,ma)}Jud(){this.mAa||(La.h(this.hl.$).ga.W0(this.Qf),this.mAa=!0)}KAb(na,S){if(!this.QH)return null;
for(let Ja=0;Ja<this.QH.length;Ja++){const rb=this.QH[Ja];if(rb.eventId===na&&rb.targetId===S)return rb}return null}static wGb(na){return na===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static dyd(na){return na===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}Object(b.a)(pb,"EmbeddingPage",null,[803]);var Vb=a(192);class Wa extends ba.a{constructor(na,S,Ja,rb,ma,ib,Qb,Fc){super(na,S,Ja);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=ib-rb.Reference.FirstColumn;
this.columnCount=Fc;na=Math.max(ma,rb.Reference.FirstRow);ma=Math.min(ma+Qb-1,rb.Reference.LastRow);na>ma?this.startRow=this.rowCount=void 0:(this.startRow=na-rb.Reference.FirstRow,this.rowCount=ma-na+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}Object(b.a)(Wa,"DdaBindingSelectionEventArgs",ba.a,[]);var ka=a(212),Sa=a(24),Xb=a(45),Mc=a(429),jc=a(40),$c=a(576),Jd=a(133),fd=a(54),Kd=a(91),
Yd=a(14),te=a(11),ve=a(113);class qe{}qe.zNh="ewa-wx-disabled-div";qe.yNh="ewa-wx-container-div";qe.P0e="ewa-ptp-nov2-flex";Object(b.a)(qe,"CssClassNames",null,[]);var pc=a(94),nd=a(142),qd=a(13),tb=a(323),Dc=a(202),Tc=a(383);const ub=qe.zNh,Pb=qe.yNh;class ee extends Vb.a{constructor(na,S,Ja,rb){rb=void 0===rb?!1:rb;super();this.Dib=0;this.QH=null;this.mAa=!1;this.Nzc=null;this.PX=0;this.Icc=this.B_a=this.Ofe=this.lde=null;this.$Uc=this.kle=!1;this.gYc=this.zha=this.jae=null;this.Qf=()=>{this.enabled&&
(this.aQj(),this.Nzc=Xb.d(La.h(this.$).ga.ra.selectedRanges))};this.Tif=ma=>{ma.controlId===this.Rf.InstanceId&&Array.forEach(this.QH,ib=>{ib.iYi(ma)&&ib.J9b(ma)})};this.ZJf=ma=>{ma=Object(Nb.a)(246,ma);if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:8220021_ExcludingMisMatchingPaneAndData")&&null!=(null===ma||void 0===ma?void 0:ma.Ki)&&(null===ma||void 0===ma?void 0:ma.Ki.InstanceId)!==this.Rf.InstanceId)h.ULS.sendTraceTag(508302915,220,15,"InstanceIds mismatching for webExtensionPane and webExtensionData.");
else if(ma&&!ma.KY())if(!this.Rf||OSF.OsfControl.isFirstPartyStoreString(this.Rf.PrimaryMarketplace.MarketplaceType)||this.$.$0){ma.Ki=this.Rf;ma.wm=this.hl;this.jae=ma;this.BFc(ma.Ltb);const ib=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&te.HelperMethods.yz(this.Rf)&&this.Rf.Preload&&!this.Rf.TaskpaneVisible;ib?ma.wLd():Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(ma.wLd(),(this.Rf.SharedRuntime&&1===this.Rf.SharedRuntime.LifeTime||
this.Rf.SharedRuntimeId)&&!this.Rf.TaskpaneVisible&&ma.cA(!1)):((this.Rf.SharedRuntime&&1===this.Rf.SharedRuntime.LifeTime||this.Rf.SharedRuntimeId)&&!this.Rf.TaskpaneVisible&&ma.cA(!1),ma.wLd());this.nab||ib||ma.yqa();this.$.ia.Ja(77).A5f(this.ZJf);this.bda=Object(Nb.a)(259,ma)}else h.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(ma,ib)=>{3===ib.control.floatingObject.type&&ib.control.floatingObject.un.InstanceId===this.r5.WebExtensionId&&
(this.bda=Object(Nb.a)(259,ib.control),this.BFc(ib.control.ig.firstChild),ve.a(this.$).VBc(this.onFloatingObjectControlAdded))};this.Pd=na.$;this.hl=na;this.Rf=Ja;this.Rf.InstanceId=Ja.SrcLocationOverrideResourceId?na.yOa(Ja.InstanceId,Ja.SrcLocationOverrideResourceId):Ja.InstanceId;this.Kj=S;this.r5={};this.r5.WebExtensionId=Ja.InstanceId;this.UVf="osfControl_"+Ja.InstanceId;this.Tfd="disabled_"+Ja.InstanceId;this.r5.BindingData=Ja.BindingData;this.nab=this.hl.nab(Ja.InstanceId);this.Xnc=this.hl.Xnc(Ja.InstanceId);
this.Qpe=Ja.WebExtensionOsfControlType;this.iZf=rb}get controlId(){return this.Rf.InstanceId}get pHi(){return this.$Uc}xyi(na){this.zha||(this.zha=na)}k5f(){this.zha&&(this.zha.dispose(),this.zha=null)}get controlType(){return this.Rf.WebExtensionType}get ownerAddinSolutionId(){return this.Rf.OwnerAddinSolutionId}get $(){return this.Pd}get enabled(){return!this.PX}get visible(){return this.Rf.TaskpaneVisible}get CB(){return this.gYc}get QP(){return this.Rf.SrcLocationOverrideResourceId?this.hl.yOa(this.Rf.PrimaryMarketplace.SolutionId,
this.Rf.SrcLocationOverrideResourceId):this.Rf.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Rf.SrcLocationOverrideResourceId}get un(){return this.Rf}get bda(){return this.lde}set bda(na){this.lde=na}get osfControlType(){return this.Qpe}get Pxa(){return this.Ofe}set Pxa(na){this.Ofe=na}get Hcc(){return this.B_a}set Hcc(na){this.B_a=na}get focusOnIframeWhenLoaded(){return this.Rf.FocusOnIframeWhenLoaded}get bqc(){return this.kle}set bqc(na){this.kle=na}Yvd(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Rf.PrimaryMarketplace.MarketplaceType)&&
Y.EwaSettings.Fa(174)){const S=Object(pc.d)(nd.a.resolve(qd.p,{Oa:0}));jc.TaskExtensions.Aa(S,()=>{S.result.ej(36,null)},this.ma,3);return this}if(1===this.Rf.WebExtensionType)jc.TaskExtensions.Aa(Mc.a(this.$),S=>{S.result.Mbc(this.$.ia,77,5,this.ZJf,1)},this.ma,3);else{var na=this.x5e();const S=ve.a(this.$);na||(na={Type:3},na.Id=this.r5.WebExtensionId,na.WebExtensionData=this.Rf,na.ContentHtml="<div/>",na.Version=0,na.AbsoluteLeft=0,na.AbsoluteTop=0,na.AbsoluteRight=0,na.AbsoluteBottom=0,na.Width=
0,na.Height=0,na.ZOrder=0,na.OriginDeltaX=0,na.OriginDeltaY=0,na=new ka.a(na),S.ybc(na,null),na=S.Mt(na.oj()));na?(this.BFc(na.ig.firstChild),this.bda=Object(Nb.a)(259,na)):S.x6b(this.onFloatingObjectControlAdded)}return this}Unf(na){this.BFc(na);return this}owc(){this.iZf||this.hl.Qh.purgeOsfControl(this.controlId,!1);const na=this.$.qa.ua.ze();Tc.a(this.$.userOperationManager,(Ja,rb,ma)=>tb.e(this.$.qa.ua,this.Rf.InstanceId,Ja,rb,ma,na),Ja=>new Dc.a(606,0,Ja,64),null);this.ftg(!0);const S=this.x5e();
S&&ve.a(this.$).deleteFloatingObject(S);this.hl.Ij.oBj(this.controlId);this.hl.Ij.YYe(this.controlId,!0);this.gYc=null}ILd(na){this.r5=na}invokeDdaMethod(na,S){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Ja={};Ja[sb.a.di]=na;Ja[sb.a.L7]=S;this.hl.zN(974713501,Ja)}else this.hl.Rj(Za.a.FFb,S)}vyj(na,S,Ja,rb){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!ee.oDh(na)||void 0!==S&&null!==S&&void 0!==this.d8a(S)&&
null!==this.d8a(S))if(h.ULS.sendTraceTag(36444195,0,50,`eventId: ${na}, targetId: ${S}`),ee.wrf(na)&&this.kti(),ee.dyd(na)&&this.Jud(),ee.urf(na))this.$Uc=!0,this.hl.$.ia.Ja(232).addHandler(this.controlId,Ja,rb,S);else if(ee.vrf(na))this.$Uc=!0,this.hl.$.ia.Ja(232).BWg(this.controlId,Ja,rb);else{ee.trf(na)&&this.Vif(-1777565636,rb);this.QH||(this.QH=[]);var ma=this.KAb(na,S);ma||(ma=new lb(na,S),this.QH.push(ma));ma.VDa();ma.G6b(Ja);this.hl.wy(rb);na===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&
this.B_a&&(this.Icc=Ja)}else this.hl.Rj(3002,rb);else this.hl.Rj(-1,rb)}yik(na,S,Ja,rb){ee.urf(na)?this.hl.$.ia.Ja(232).removeHandler(this.controlId,rb):ee.vrf(na)?this.hl.$.ia.Ja(232).FBj(this.controlId,rb):(ee.trf(na)&&this.Vif(1592314317,rb),S=this.KAb(na,S),this.enabled?(S&&(S.cCc(Ja),S.fri||Array.remove(this.QH,S),this.QH.length?ee.wrf(na)&&this.gtg(!1):this.ftg(!1)),this.hl.wy(rb)):this.hl.Rj(-1,rb))}la(na){Yd.DOMElementExtensions.getElementById(na,this.UVf)||na.appendChild(Yd.DOMElementExtensions.xi(this.CB))}showHide(na){Yd.DOMElementExtensions.setVisible(this.CB,
na)}resize(na,S){Yd.DOMElementExtensions.jA(this.CB,na);Yd.DOMElementExtensions.gM(this.CB,S)}QVe(na){if(!this.PX&&!Yd.DOMElementExtensions.getElementById(this.CB,this.Tfd)&&this.CB){const S=document.createElement("div");S.id=this.Tfd;S.className=ub;S.style.backgroundImage="url("+fd.a.current.Jq(101)+")";S.style.opacity=na?"1":"0";S.style.backgroundRepeat="no-repeat";S.style.backgroundPosition="center";this.CB.insertBefore(S,this.CB.firstChild)}this.PX++}jGh(){0<this.PX&&this.PX--;this.PX||(Yd.DOMElementExtensions.xi(Yd.DOMElementExtensions.getElementById(this.CB,
this.Tfd)),this.mAa&&!Xb.R(this.Nzc,La.h(this.$).ga.ra.selectedRanges)&&this.Qf(null,null))}d8a(na){if(!this.r5||!this.r5.BindingData)return null;for(let S=0;S<this.r5.BindingData.length;S++)if(this.r5.BindingData[S].Name===na)return this.r5.BindingData[S];return null}getDefaultIconUrl(){const na=this.hef();return na?na.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Rf.TaskpaneTitle)return this.Rf.TaskpaneTitle;const na=this.hef();return na?na.getDefaultDisplayName():null}m_f(){if(this.B_a&&
this.Icc){const na=new ba.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.B_a);this.Icc(na);this.Icc=this.B_a=null}}cA(na){this.jae&&this.jae.cA(na)}iSj(){this.$.ea.isNamedObjectViewMode&&this.DJi()&&(this.$.ia.Ja(34).hSj(this.CB),this.showHide(!1));if(this.hl.Prk){if(!this.iZf){const na={};na.div=this.CB;na.id=this.Rf.InstanceId;na.solutionId=this.Rf.PrimaryMarketplace.SolutionId;na.version=this.Rf.PrimaryMarketplace.SolutionVersion;na.storeId=this.Rf.PrimaryMarketplace.MarketplaceRef;
na.storeType=this.Rf.PrimaryMarketplace.MarketplaceType;na.ownerAddinSolutionId=this.Rf.OwnerAddinSolutionId;na.ownerAddinStoreType=this.Rf.OwnerAddinStoreType;this.Rf.AssetMarketplace?(na.assetId=this.Rf.AssetMarketplace.SolutionId,na.assetStoreId=this.Rf.AssetMarketplace.MarketplaceRef):(na.assetId=null,na.assetStoreId=null);na.settings=this.Rf.OsfPropertyBag;na.hostSettings=this.Rf.HostPropertyBag;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?na.reason=
this.nab?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Xnc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:na.reason=this.nab?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;na.osfControlType=0===this.Rf.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;na.isForUILessAction=4===this.Rf.WebExtensionOsfControlType;
na.sourceLocationOverrideResourceId=this.Rf.SrcLocationOverrideResourceId;na.focusOnIframeWhenLoaded=this.Rf.FocusOnIframeWhenLoaded;$c.a(this.Rf)&&(na.featureGates=x.AFrameworkApplication.da.jbf(na.solutionId));na.hostInfoFlags=0;this.Pxa&&(na.hostInfoFlags|=2);te.HelperMethods.yz(this.Rf)&&(na.hostInfoFlags|=1);this.$.$0||(h.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),na.hostInfoFlags|=4);Y.EwaSettings.Fa(553)&&(na.hostInfoFlags|=8);na.sharedRuntimeId=this.Rf.SharedRuntime?
this.Rf.SharedRuntime.Resid:this.Rf.SharedRuntimeId;!te.HelperMethods.yz(this.Rf)||this.Rf.Preload||$c.a(this.Rf)||this.hl.Qh.getOsfControl(a(777).DdaFacade.getSolutionId(this.Rf,this.$))||(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.hl.OUf(this.Rf):this.hl.OUf(this.Rf));na.onExtensionLaunchCallback=this.Rf.OnExtensionLaunchCallback;na.initialDisplayMode=this.Rf.TaskpaneVisible?2:1;Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&
(na.titleOverride=this.un.TaskpaneTitle);this.hl.Qh.insertOsfControl(na)}this.PX=0}else this.QVe(!0)}ftg(na){this.gtg(na);this.fik()}kti(){this.Dib||this.Kj.G6b(this.Tif);this.Dib++}gtg(na){0<this.Dib&&(na?this.Dib=0:this.Dib--,this.Dib||this.Kj.cCc(this.Tif))}Jud(){if(!this.mAa){const na=La.h(this.$).ga;this.Nzc=Xb.d(La.h(this.$).ga.ra.selectedRanges);na.W0(this.Qf);this.mAa=!0}}fik(){this.mAa&&(La.h(this.$).ga.s4(this.Qf),this.mAa=!1)}UOj(na){var S=new Sa.Range(na.Reference.FirstRow+1,na.Reference.FirstColumn+
1,na.Reference.LastRow+1,na.Reference.LastColumn+1,!1,!1);1===na.BindingType&&(na.HasHeaders&&--S.top,na.HasTotals&&(S.bottom+=1));var Ja=La.h(this.$).ga.ra.selectedRanges;na=S.gab(this.Nzc);Ja=S.gab(Ja);return(S=S.Sg(La.h(this.$).ga.ra.activeRange))&&(Jd.e(na)&&!Jd.e(Ja)||!Jd.e(na)&&!Jd.e(Ja)&&!Xb.R(na,Ja))?S:null}aQj(){Array.forEach(this.QH,na=>{if(na.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&na.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.hl.Ij.a8b(this.controlId))if(na.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)na.J9b(new ba.a(na.eventId,this.controlId,null));else if(na.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const S=this.d8a(na.targetId);if((null===S||void 0===S?0:S.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.ue.pa.sheetName:this.$.ta.pa.name)===S.Reference.SheetName){const Ja=this.UOj(S);Ja&&na.J9b(new Wa(na.eventId,this.controlId,this.hl.G8b(S),S,Ja.top-1,Ja.left-1,Ja.height,Ja.width))}}})}KAb(na,S){if(!this.QH)return null;
for(let Ja=0;Ja<this.QH.length;Ja++){const rb=this.QH[Ja];if(rb.eventId===na&&rb.targetId===S)return rb}return null}x5e(){const na=ve.a(this.$).jY;for(let S=na.length-1;0<=S;--S){const Ja=na[S];if(3===Ja.floatingObject.type&&Ja.floatingObject.un.InstanceId===this.r5.WebExtensionId)return Ja}return null}DJi(){for(let na=0;na<this.$.ue.count;na++)if(this.$.ue.getItem(na).imageId===this.r5.WebExtensionId)return!0;return!1}BFc(na){this.gYc=na;this.CB.id=this.UVf;this.CB.className=Pb;this.CB.dir=this.$.isChromeRtl?
"rtl":"ltr";this.iSj()}hef(){if(!this.enabled)return null;const na=$c.a(this.un)?"":this.un.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.un.PrimaryMarketplace.SolutionId,na)}Vif(na,S){try{if(h.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.Qpe)this.hl.Rj(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,S);else{const Ja={};Ja[Z.a.Ftb]=this.controlId;const rb=new Kd.a(na,0,this.$.isEditMode?2:1,0,null);this.$.Ga.Sd(rb,
Ja);this.hl.wy(S)}}catch(Ja){h.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${Ja.message}.`),this.hl.Rj(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,S)}}static oDh(na){return na===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||na===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static wrf(na){return na===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||na===OSF.DDA.EventDispId.dispidSettingsChangedEvent||na===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static dyd(na){return na===
OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||na===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static urf(na){return na===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static vrf(na){return na===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static trf(na){return na===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(b.a)(ee,"OsfControl",Vb.a,[810]);class Ad{constructor(){this.k3a={}}add(na){this.k3a[na]=!0}remove(na){delete this.k3a[na]}clear(){for(const na of Object.keys(this.k3a))delete this.k3a[na]}ikf(){return 0<
Object.keys(this.k3a).length}A1h(){return Object.keys(this.k3a)}}Object(b.a)(Ad,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Ub=a(60);class tc{constructor(na,S,Ja){this.X3f=this.W3f=0;this.mTb=this.igb=null;this.U5i=()=>{var rb=La.h(this.$).ga.Ta.XD;if(this.Nxd(rb)&&(rb=this.ZBb(rb))){var ma={};ma.chartId=rb;ma.worksheetId=this.wna();ma=Ub.a.ff(ma);this.Xma(51,rb,ma);this.Xma(51,this.wna(),ma)}};this.V5i=()=>{if(this.igb){var rb={};rb.chartId=this.igb;rb.worksheetId=this.mTb;
rb=Ub.a.ff(rb);this.Xma(52,this.igb,rb);this.Xma(52,this.mTb,rb)}rb=La.h(this.$).ga.Ta.XD;this.Nxd(rb)?(this.igb=this.ZBb(rb),this.mTb=this.wna()):this.mTb=this.igb=null};this.$=na;this.Ij=S;this.Kj=Ja}Iub(na){51===na.messageType?this.W3f=this.XKa(na.actionType,this.W3f,this.U5i):52===na.messageType&&(this.X3f=this.XKa(na.actionType,this.X3f,this.V5i))}XKa(na,S,Ja){if(1===na)S||La.h(this.$).ga.Ta.f4c(Ja),S++,this.lWj();else if(2===na){if(1>S)return S;1===S&&La.h(this.$).ga.Ta.dUd(Ja);S--}return S}Xma(na,
S,Ja){S&&this.Ij.$K(na,S)&&this.Kj.cG(na,S,Ja)}ZBb(na){return na&&na.floatingObject?(na=na.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===na.length?na[0]:null:null}wna(){const na=this.$.ta.pa;return na&&0===na.dJ?na.sheetId:null}lWj(){const na=La.h(this.$).ga.Ta.XD;this.Nxd(na)&&(this.igb=this.ZBb(na),this.mTb=this.wna())}Nxd(na){return!!na&&!!na.floatingObject&&0===na.floatingObject.type}}Object(b.a)(tc,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var yc=
a(773),Sd=a(196),Fd=a(630),se=a(109),uc=a(358),Ra=a(63);class vb extends fb.a{constructor(na,S,Ja){super();this.PX=this.UDa=0;this.Qf=(rb,ma)=>{if(this.enabled&&!(this.xtf()||null!==ma&&void 0!==ma&&ma.Twf)&&(rb=Object(Nb.a)(se.a,this.$.ta.pa))&&0===rb.dJ){const ib=rb.sheetId,Qb=this.iaf();let Fc=null,jd=null;this.Ij.Hwf()&&(Fc=this.grid.Ud.Di(this.grid.ga.ra.activeCell),jd=ib in this.gsc?this.gsc[ib]:null);this.IEe(ib,Qb)&&jc.TaskExtensions.Aa(Ra.Task.Ua(!0),()=>{this.Cqi(ib,Qb);this.oqi(ib,Qb,Fc,
jd)},this.ma);this.RWe(ib,Qb,Fc)}};this.$=na;this.Ij=S;this.Kj=Ja;this.grid=La.h(na);this.gSa={};this.gsc={}}get enabled(){return!this.PX&&0<this.UDa}t8b(na){Object(Nb.a)(uc.a,this.$.ta);1===na.actionType?(this.UDa||this.grid.ga.W0(this.Qf),this.UDa++):2!==na.actionType||1>this.UDa||(1===this.UDa&&this.grid.ga.s4(this.Qf),this.UDa--)}kFc(na){na?this.PX++:(0<this.PX&&this.PX--,this.PX||this.Qf(null,new Fd.a(!1)))}iaf(){return this.grid.ga.ra.selectedRanges}IEe(na,S){return Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?
(!!na&&Sd.e(this.gSa)||na in this.gSa)&&!Xb.R(this.gSa[na],S):na in this.gSa&&!Xb.R(this.gSa[na],S)}RWe(na,S,Ja){this.gSa[na]=Xb.d(S);this.gsc[na]=Ja}xtf(){return this.grid.Kd||this.grid.Al}T5e(na,S){this.Ij.$K(14,na)&&this.Kj.cG(14,na,S);this.Ij.$K(14,yc.a.tO)&&this.Kj.cG(14,yc.a.tO,S)}Cqi(na,S){const Ja={};Ja.worksheetId=na;Ja.address=this.Sqd(S);S=Ub.a.ff(Ja);this.T5e(na,S)}oqi(na,S,Ja,rb){if(this.Ij.Hwf()){var ma="";let ib="";rb&&(ma=rb.Xl);Ja&&(ib=Ja.Xl);rb?Ja?(S=Ja.usedRange.gab(S),ma!==ib&&
this.jhc(ma,"",na),this.jhc(ib,this.Sqd(S),na)):this.jhc(ma,"",na):Ja&&(ma=Ja.usedRange.gab(S),this.jhc(ib,this.Sqd(ma),na))}}jhc(na,S,Ja){if(this.Ij.$K(100,na)){const rb={};rb.address=S;rb.worksheetId=Ja;this.Kj.cG(100,na,Ub.a.ff(rb))}}Sqd(na){return Xb.i(na,",",this.$,!1)}dispose(){0<this.UDa&&this.grid.ga.s4(this.Qf);this.gsc=this.gSa=null;this.UDa=0;this.Kj=this.Ij=this.$=this.grid=null}}Object(b.a)(vb,"RichApiEventSelectionChangedHandler",fb.a,[]);var Gc=a(354);class cd extends vb{constructor(na,
S,Ja){super(na,S,Ja);this.Ryf=this.Syf=null}iaf(){return Gc.a.Wbc(this.grid.ga.rangePicker.gO)}IEe(na,S){return this.Syf!==na||!Xb.R(this.Ryf,S)}RWe(na,S){this.Syf=na;this.Ryf=Xb.d(S)}xtf(){return!this.grid.Kd&&!this.grid.Al}T5e(na,S){this.Ij.$K(2700,yc.a.tO)&&this.Kj.cG(2700,yc.a.tO,S)}}Object(b.a)(cd,"RichApiEventPickedRangesChangedHandler",vb,[]);class Cd{constructor(na,S,Ja){this.oVa=this.nVa=0;this.xLa=this.xla=null;this.FNf=()=>{var rb=La.h(this.$).ga.Ta.XD;if(0<this.oVa&&this.xla&&this.xLa){var ma=
{};ma.shapeId=this.xla;ma.worksheetId=this.xLa;ma=Ub.a.ff(ma);this.fireEvent(2102,this.xla,ma)}this.zLi(rb)?(this.xla=this.Egk(rb),this.xLa=this.wna(),this.xla&&this.xLa)?0<this.nVa&&(rb={},rb.shapeId=this.xla,rb.worksheetId=this.xLa,rb=Ub.a.ff(rb),this.fireEvent(2101,this.xla,rb)):h.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.xla}', or worksheet id: '${this.xLa}' from a Floating object or gridview.`):this.xLa=this.xla=null};this.$=na;this.Ij=S;this.Kj=
Ja}Iub(na){const S=La.h(this.$).ga;1===na.actionType?(this.nVa||this.oVa||S.Ta.f4c(this.FNf),2101===na.messageType?this.nVa++:2102===na.messageType&&this.oVa++):2===na.actionType&&(2101===na.messageType?this.nVa=0<this.nVa?this.nVa-1:0:2102===na.messageType&&(this.oVa=0<this.oVa?this.oVa-1:0),this.nVa||this.oVa||S.Ta.dUd(this.FNf))}zLi(na){return!!na&&!!na.floatingObject&&(0===na.floatingObject.type||7===na.floatingObject.type||1===na.floatingObject.type||3===na.floatingObject.type||5===na.floatingObject.type)}Egk(na){if(!na||
!na.floatingObject)return null;na=na.floatingObject.id;var S=na.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));S=S&&1===S.length?S[0]:null;return S?S:(h.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${na}', but we failed.`),null)}wna(){const na=this.$.ta.pa;return na&&0===na.dJ?na.sheetId:null}fireEvent(na,S,Ja){S&&this.Ij.$K(na,S)&&this.Kj.cG(na,S,Ja)}}Object(b.a)(Cd,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class Rd{constructor(na,
S,Ja){this.a4f=this.$3f=this.b4f=this.Z3f=0;this.Hij=(rb,ma)=>{rb=Object(Nb.a)(se.a,ma.pa);this.kcb(rb)&&(ma={},ma.worksheetId=rb.sheetId,ma=Ub.a.ff(ma),this.Xma(11,rb.sheetId,ma))};this.Kij=(rb,ma)=>{rb=Object(Nb.a)(se.a,ma.ZC);this.kcb(rb)&&(ma={},ma.worksheetId=rb.sheetId,ma=Ub.a.ff(ma),this.Xma(12,rb.sheetId,ma))};this.Iij=(rb,ma)=>{rb=Object(Nb.a)(se.a,ma.pa);this.kcb(rb)&&(ma={},ma.worksheetId=rb.sheetId,rb=Ub.a.ff(ma),this.Xma(11,null,rb,!0))};this.Jij=(rb,ma)=>{rb=Object(Nb.a)(se.a,ma.ZC);
this.kcb(rb)&&(ma={},ma.worksheetId=rb.sheetId,rb=Ub.a.ff(ma),this.Xma(12,null,rb,!0))};this.$=na;this.Ij=S;this.Kj=Ja}Iub(na){11===na.messageType?na.targetId===yc.a.tO?this.I6g(na.actionType):this.H6g(na.actionType):12===na.messageType&&(na.targetId===yc.a.tO?this.J6g(na.actionType):this.K6g(na.actionType))}H6g(na){this.Z3f=this.XKa(na,this.Z3f,this.Hij)}K6g(na){this.b4f=this.XKa(na,this.b4f,this.Kij)}I6g(na){this.$3f=this.XKa(na,this.$3f,this.Iij)}J6g(na){this.a4f=this.XKa(na,this.a4f,this.Jij)}XKa(na,
S,Ja){1===na?S=this.WKa(S,Ja):2===na&&(S=this.bNa(S,Ja));return S}WKa(na,S){na||this.$.ta.zj(S);na++;return na}bNa(na,S){if(1>na)return na;1===na&&this.$.ta.dk(S);na--;return na}kcb(na){return!!na&&0===na.dJ}Xma(na,S,Ja,rb){S=(void 0===rb?0:rb)?yc.a.tO:S;this.Ij.$K(na,S)&&this.Kj.cG(na,S,Ja)}}Object(b.a)(Rd,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Be=a(251),ad=a(15),Qc=a(235);class Zd extends Sys.EventArgs{constructor(na,S,Ja,rb){super();this.sheet=na;this.ifh=S;this.offsetX=Ja;
this.offsetY=rb}}Object(b.a)(Zd,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);class Tb{constructor(na,S,Ja){this.Z$b=null;this.XBd=!1;this.onPointerDown=rb=>{let ma;3===rb.de?((()=>{let ib=this.gridView.Dic(rb.clientPoint);({q5a:ma}=ib);return ib})(),this.XBd=!!ma&&this.gridView.ga.ra.XWe(ma)):this.XBd=!1;this.Z$b=rb.clientPoint;return!1};this.Of=rb=>{if(this.gridView.inRangePicker||this.gridView.Al||this.XBd||rb.shiftKey||rb.ctrlKey||rb.Da.button!==Sys.UI.MouseButton.leftButton||!this.Z$b||!rb.clientPoint||
rb.clientPoint.x!==this.Z$b.x||rb.clientPoint.y!==this.Z$b.y)return!1;let ma;var ib=(()=>{let Fc=this.gridView.Dic(rb.clientPoint);({q5a:ma}=Fc);return Fc})().returnValue;const Qb=Object(Nb.a)(se.a,this.$.ta.pa);if(ib&&Qb&&0===Qb.dJ){if(!this.gridView.ga.ra.r8.contains(ma))return!1;ib=new Zd(Qb,ma,te.HelperMethods.AOd(ib.x),te.HelperMethods.AOd(ib.y));this.Lij(ib)}return!1};this.$=na;this.gridView=La.h(na);this.Ij=S;this.Kj=Ja;this.bAj()}dispose(){this.Tik()}bAj(){for(const na of this.gridView.Rq){const S=
na.domElement;Be.a.instance.va(ad.a.Cf,S,this.onPointerDown);Qc.a.instance.va(ad.a.click,S,this.Of)}}Tik(){for(const na of this.gridView.Rq){const S=na.domElement;Be.a.instance.Ca(ad.a.Cf,S,this.onPointerDown);Qc.a.instance.Ca(ad.a.click,S,this.Of)}}Lij(na){var S=na.sheet;if(this.kcb(S)){var Ja={};Ja.worksheetId=S.sheetId;Ja.address=na.ifh.toString();Ja.offsetX=na.offsetX;Ja.offsetY=na.offsetY;na=S.sheetId;this.Ij.$K(21,na)&&(S=Ub.a.ff(Ja),this.Kj.cG(21,na,S));na=yc.a.tO;this.Ij.$K(21,na)&&(Ja=Ub.a.ff(Ja),
this.Kj.cG(21,na,Ja))}}kcb(na){return!!na&&0===na.dJ}}Object(b.a)(Tb,"RichApiEventSingleClickedHandler",null,[]);class Yc{constructor(na,S,Ja){this.CPb=0;this.Yfb=this.fgb=null;this.bVf=()=>{const rb=La.h(this.$).ga.Ta.XD;if(rb)if(this.vxf(rb)){const ma=this.wna();this.$kd(ma);this.fgb=rb.floatingObject.id;this.Yfb=ma}else this.fgb&&(this.$kd(this.Yfb),this.Yfb=this.fgb=null);else this.fgb&&(this.$kd(this.Yfb),this.Yfb=this.fgb=null)};this.$=na;this.Ij=S;this.Kj=Ja}t8b(na){2E3===na.messageType&&(1===
na.actionType?(this.CPb||La.h(this.$).ga.Ta.f4c(this.bVf),this.CPb++,this.qSj()):2===na.actionType&&this.CPb&&(1===this.CPb&&La.h(this.$).ga.Ta.dUd(this.bVf),this.CPb--))}$kd(na){var S;const Ja={};Ja.worksheetId=na;Ja.revisionLoad=!1;if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(Y.EwaSettings.Fa(616)||Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7872385_ChartPlayerManualPlacement"))){const rb=La.h(this.$).ga.Ta.XD;(null===(S=null===rb||
void 0===rb?void 0:rb.floatingObject)||void 0===S?0:S.Af)?Ja.selectedVisualId=rb.floatingObject.Af.VisualID:Ja.selectedVisualId=null}S=Ub.a.ff(Ja);na&&this.Ij.$K(2E3,na)&&this.Kj.cG(2E3,na,S)}wna(){const na=this.$.ta.pa;return na&&0===na.dJ?na.sheetId:null}qSj(){const na=La.h(this.$).ga.Ta.XD;this.vxf(na)&&(this.fgb=na.floatingObject.id,this.Yfb=this.wna())}vxf(na){return!!na&&na.wCd()}}Object(b.a)(Yc,"RichApiEventVisualSelectionChangedHandler",null,[]);class Ob{constructor(na,S,Ja){this.DPb=0;this.rzg=
!0;this.xhc=0;this.SAd=!0;this.eLe=()=>{const rb=document.hasFocus();if(this.rzg!==rb){if(rb){const ma=Ub.a.ff({});this.Kj.cG(2203,yc.a.tO,ma)}this.rzg=rb}};this.fLe=rb=>{(0<rb.timeRemaining()||rb.didTimeout)&&this.eLe();window.requestIdleCallback(this.fLe)};this.$=na;this.Ij=S;this.Kj=Ja;window.requestIdleCallback||(this.SAd=!1)}G6g(na){1===na.actionType?(this.DPb||this.W6g(),this.DPb++):2!==na.actionType||1>this.DPb||(1===this.DPb&&this.Nzh(),this.DPb--)}W6g(){if(this.Ij.$K(2203,yc.a.tO))if(this.SAd){const na=
{};na.timeout=this.$.xa.CheckFocusTimeout;this.xhc=window.requestIdleCallback(this.fLe,na)}else this.xhc=window.setInterval(this.eLe,this.$.xa.CheckFocusTimeInterval)}Nzh(){this.SAd?window.cancelIdleCallback(this.xhc):window.clearInterval(this.xhc)}}Object(b.a)(Ob,"RichApiEventWorkbookActivatedHandler",null,[]);var kc;(function(na){na[na.none=0]="none";na[na.registerEvent=1]="registerEvent";na[na.unregisterEvent=2]="unregisterEvent";na[na.customFunction=3]="customFunction";na[na.showCard=4]="showCard";
na[na.createWorkbook=5]="createWorkbook";na[na.openWorkbook=6]="openWorkbook";na[na.enableEvents=7]="enableEvents";na[na.closeWorkbook=8]="closeWorkbook";na[na.setCalculationMode=9]="setCalculationMode";na[na.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";na[na.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";na[na.workbookLinksEnableContent=12]="workbookLinksEnableContent";na[na.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";na[na.workbookLinksOpenWorkbook=
14]="workbookLinksOpenWorkbook";na[na.rangePicker=15]="rangePicker";na[na.enableRichApiRecording=16]="enableRichApiRecording";na[na.recordAction=17]="recordAction";na[na.focus=18]="focus";na[na.businessBarShow=19]="businessBarShow";na[na.businessBarHide=20]="businessBarHide";na[na.augmentationLoopActivateAnnotation=21]="augmentationLoopActivateAnnotation";na[na.augmentationLoopSubmitSignal=22]="augmentationLoopSubmitSignal";na[na.showRangeValuesPreview=23]="showRangeValuesPreview";na[na.hideRangeValuesPreview=
24]="hideRangeValuesPreview"})(kc||(kc={}));Object(b.b)("PostProcessActionType",kc);var Kc=a(263),Wc=a(62);class Nd{constructor(na,S,Ja){this.VVf=null;this.Ykd=(rb,ma)=>{const ib=yc.a.tO,Qb={};Qb.eventId=rb;Qb.payload=ma;this.Ij.$K(2201,ib)&&this.Kj.cG(2201,ib,Ub.a.ff(Qb))};this.$=na;this.Ij=S;this.Kj=Ja;this.Xxi()}F6g(na){1===na.actionType?(this.$.p9=!0,Object(Nb.a)(a(777).DdaFacade,Kc.a(this.$)).Zkd(!0)):2===na.actionType&&(this.$.p9=!1);this.VVf=na.controlId;h.ULS.sendTraceTag(537170456,0,50,`AttachOrDetachMacroRecorderEventHandler: actionType: ${kc[na.actionType]}; controlId: ${this.VVf}; this.ewaControl.IsMacroRecorderListening: ${this.$.p9}.`)}BHh(na){Object(Nb.a)(a(777).DdaFacade,
Kc.a(this.$)).V5e(na,this.$.p9)}Xxi(){this.$.QY&&jc.TaskExtensions.Aa(Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateMacroRecorderEventsHandler",!1)?Object(pc.d)(nd.a.resolve(qd.Zb,{Oa:1})):Wc.GetServiceTaskFactory.je(this.$.ia,297,298,1),na=>{(na=na.result)&&na.init(this.Ykd)},this.$.ma,3)}}Object(b.a)(Nd,"RichApiMacroRecorderEventHandler",null,[]);class Ud{}Object(b.a)(Ud,"StyleCacheItem",null,[]);class $d{constructor(na,S,Ja){this.$=na;this.gridView=S;this.Mh=Ja}mla(na){this.range=
na;this.rac=Array(na.width);this.pIc=Array.from({length:na.height},()=>Array(na.width))}ZRj(na,S,Ja,rb){this.Fvf(na,S)&&(this.pIc[na-this.range.top][S-this.range.left]||(this.pIc[na-this.range.top][S-this.range.left]={backgroundColor:Ja.backgroundColor}),Ja.backgroundColor=rb)}aSj(na,S,Ja){if(this.Fvf(na,S)){na=Sa.Range.ef(na,S);var rb=this.gridView.Zd(na);rb&&(this.rac[S-this.range.left]||(this.rac[S-this.range.left]=rb.width),S=this.Mh.w2d(this.gridView,[na],Ja,!1),"Success"!==S.kind&&h.ULS.sendTraceTag(508303323,
0,10,`InstantaneousGridContentRestorer.setColumnWidth: failed to set column width - ${S.reason}.`))}}restore(){this.range&&(this.rac.forEach((na,S)=>{na=this.Mh.w2d(this.gridView,[Sa.Range.ef(this.range.top,this.range.left+S)],na,!1);"Success"!==na.kind&&h.ULS.sendTraceTag(508303322,0,10,`InstantaneousGridContentRestorer.restore: failed to set column width - ${na.reason}`)}),this.pIc.forEach((na,S)=>{na.forEach((Ja,rb)=>{rb=Sa.Range.ef(this.range.top+S,this.range.left+rb);if(rb=this.gridView.Zd(rb))rb.cell.backgroundColor=
Ja.backgroundColor})}),this.rac=this.pIc=this.range=void 0)}Fvf(na,S){if(!this.range)return h.ULS.sendTraceTag(508303321,0,15,"InstantaneousGridContentRestorer.isRowColInRange: range not yet created - begin has not been called"),!1;(na=this.range.contains(Sa.Range.ef(na,S)))||h.ULS.sendTraceTag(508303320,0,10,"InstantaneousGridContentRestorer.isRowColInRange: row/column not in range");return na}}Object(b.a)($d,"InstantaneousGridContentRestorer",null,[]);var $b=a(214),nc=a(148);class Oc{constructor(na,
S,Ja,rb){this.dfi=ma=>{const ib=ma.Gf.block;if(this.Pw.Sg(ib.xg)){this.aYf([ib.xg]);const Qb=La.h(this.$).XV(ib.xg),Fc=()=>this.UXf([ib.xg]);setTimeout(()=>{Qb.skeletonMode?setTimeout(()=>{Qb.skeletonMode?h.ULS.sendTraceTag(508303319,0,10,"RichApiRangeValuesPreview.getRangeCallback: skeleton mode not dismissed within alloted time."):Fc()},Oc.sCg):Fc()},Oc.kDg)}};this.JTa=(ma,ib)=>{0===ib.Bu&&576!==ib.ni.operation.operationName&&this.AEb(!0)};this.dMd=ma=>{this.fHc&&(this.cWh(ma),this.sR())};this.$=
na;this.Ij=S;this.Kj=Ja;this.gridView=La.h(this.$);this.Bnc=new $d(this.$,this.gridView,rb)}hqi(na,S,Ja,rb){this.Ruf(na)?(S=this.pdh(S,Ja))?this.Nqa?h.ULS.sendTraceTag(509227293,0,15,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview already showing, exit"):(this.worksheetId=na,this.Pw=S,this.values=Ja,this.Iaa(rb)):h.ULS.sendTraceTag(509384200,0,10,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to calculate range"):h.ULS.sendTraceTag(509384201,
0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: not showing the preview, desired worksheet not supported for this operation")}poi(na){this.Ruf(na)?this.AEb(!1):h.ULS.sendTraceTag(509359639,0,50,"RichApiRangeValuesPreview.handleHideRangeValuesPreviewPostProcessAction: not hiding the preview, desired worksheet not supported for this operation")}Iaa(na){this.aYf(this.K9e());na&&(h.ULS.sendTraceTag(509227290,0,50,`RichApiRangeValuesPreview.showPreview: options: ${JSON.stringify(na)}`),
na.autoexpandTable&&this.udh(),na.autofitColumns&&this.Pch());this.fHc=this.gridView.QI.Iaa(this.Pw,this.dfi).then(S=>{h.ULS.sendTraceTag(509384199,0,50,"RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: preview shown");this.Nqa=S;this.Bnc.mla(this.Pw);this.UXf(this.K9e());this.$.userOperationManager.xt(this.JTa);S.fDc.then(()=>this.dMd(!0),()=>this.dMd(!0));return Promise.resolve()},S=>{h.ULS.sendTraceTag(509384198,0,10,`RichApiRangeValuesPreview.handleShowRangeValuesPreviewPostProcessAction: failed to show preview, rejectionString = ${S}`);
this.sR();return Promise.resolve()})}AEb(na){this.fHc&&(h.ULS.sendTraceTag(509359638,0,50,"RichApiRangeValuesPreview.hidePreview: showPromise exists, will hide preview"),this.fHc.then(()=>{const S=this.Nqa;this.dMd(na);S&&S.koa("RichApiRangeValuesPreview")},()=>{h.ULS.sendTraceTag(509383618,0,10,"RichApiRangeValuesPreview.hidePreview: unexpected rejection of this.showPromise")}))}pdh(na,S){na=Xb.ab(na,this.$.ta);if(na.returnValue)return new Sa.Range(na.range.top,na.range.left,na.range.top+S.length-
1,na.range.left+S[0].length-1,!0,!0)}Ruf(na){const S=this.$.ta.pa;return S&&na===S.sheetId}aYf(na){this.Old(na,(S,Ja,rb,ma)=>{ma.cell.Pqa=this.values[S][Ja];return!0})}UXf(na){this.qsa&&this.Old(na,(S,Ja,rb,ma)=>{this.Bnc.ZRj(rb.top,rb.left,ma,this.q8h(rb.top));return!0});if(this.$3a){const S=this.Pw.gab(na);0<S.length&&this.$3a&&this.$3a.forEach((Ja,rb)=>{this.Bnc.aSj(S[0].top,this.Pw.left+rb,Ja)})}}Old(na,S){for(let rb=0;rb<this.values.length;++rb)for(let ma=0;ma<this.values[rb].length;++ma){const ib=
Sa.Range.ef(this.Pw.top+rb,this.Pw.left+ma);if(!na||na.some(Qb=>Qb.contains(ib))){var Ja=this.gridView.Dw(ib);if((!Ja||ib.equals(Ja.topLeft))&&(Ja=this.gridView.Zd(ib))&&!S(rb,ma,ib,Ja))return}}}K9e(){return this.gridView.ya.yy().filter(na=>na.pa===this.$.pa).map(na=>na.xg)}cWh(na){this.Ij.$K(3400,this.worksheetId)&&(na=Ub.a.ff({type:"RangeValuesPreviewDismissed",source:"Local",wxk:na}),this.Kj.cG(3400,this.worksheetId,na))}sR(){this.$.userOperationManager.ur(this.JTa);this.QJj();this.qsa=this.worksheetId=
this.fHc=this.values=this.Pw=this.Nqa=void 0}udh(){if(this.Pw){var na=this.Sii(this.Pw);if(na){h.ULS.sendTraceTag(509227289,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table directly above or to the left of the range - faking autoexpand table");var S=(ib,Qb)=>{var Fc;return null===(Fc=this.gridView.Zd(Sa.Range.ef(ib,Qb)))||void 0===Fc?void 0:Fc.backgroundColor},Ja=na.usedRange.top;if(na.attributes&16){var rb=S(na.usedRange.top,na.usedRange.left);++Ja}var ma=S(Ja,na.usedRange.left);
S=S(Ja+1,na.usedRange.left);this.qsa={Pqg:na.usedRange.top,hud:rb,Rdk:ma,r9g:S}}else h.ULS.sendTraceTag(508303318,0,50,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: table autoexpand requested but no table found")}else h.ULS.sendTraceTag(509227291,0,10,"RichApiRangeValuesPreview.calculateSimulatedAutoexpandData: this should never be called with no preview range set")}Pch(){this.$3a=Array(this.Pw.width);let na=!1;this.Old(void 0,(S,Ja,rb,ma)=>{var ib;if(this.gridView.Dw(rb))return na=
!0,!1;S=ma.cell;S=S.ROe(S.Pqa);S>ma.width&&(this.$3a[Ja]=Object(nc.a)(null!==(ib=this.$3a[Ja])&&void 0!==ib?ib:0,S));return!0});na&&(this.$3a=void 0)}QJj(){this.Bnc.restore();Xb.z(this.Pw,(na,S)=>{na=Sa.Range.ef(na,S);if(na=this.gridView.Zd(na))na.cell.Pqa=void 0})}q8h(na){return this.qsa.hud&&na===this.qsa.Pqg?this.qsa.hud:0===(na-this.qsa.Pqg-(this.qsa.hud?1:0))%2?this.qsa.Rdk:this.qsa.r9g}Sii(na){const S=$b.b(this.gridView.$,na,!0);if(!(1<S.length)){var Ja=ma=>{var ib;const Qb=null!==(ib=this.gridView.Ud.Rii(ma))&&
void 0!==ib?ib:this.gridView.Ud.Tii(ma);if(Qb)return Qb},rb=Ja(na);if(rb&&0===S.length)return rb;if(0!==S.length&&(na=Xb.Y(na,S[0].usedRange),1===na.length))return Ja(na[0])}}}Oc.kDg=20;Oc.sCg=100;Object(b.a)(Oc,"RichApiRangeValuesPreview",null,[]);class Hd{}Object(b.a)(Hd,"SessionRecreationInfo",null,[]);class re{constructor(na,S,Ja){this.$=na;this.Ij=S;this.runtimeCalculationMode=Ja}f1i(){return Y.EwaSettings.Fa(234)?this.Ij.sri()||0!==this.runtimeCalculationMode:!1}Pah(){var na={};na.eventRegistrationInfos=
this.Ij.Z7h();na.runtimeCalculationMode=this.runtimeCalculationMode;na=Object(c.a)(new Hd,{runtimeState:na});const S={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};S.RequestBody=JSON.stringify(na);S.RequestFlags=1;return S}}Object(b.a)(re,"RichApiRuntimeStateHandler",null,[]);class fe{constructor(na,S,Ja,rb,ma,ib,Qb,Fc,jd){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=
this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=na;this.processUtcTime=S;this.dequeueUtcTime=Ja;this.inQueueDurationInMS=rb;this.executionDurationInMS=ma;this.operationCount=ib;this.ServerCorrelationId=Qb;this.UserOperationName=Fc;this.IsDocumentHidden=jd}}Object(b.a)(fe,"UserOperationQueueItemsStatisticsData",null,[]);var oc=a(335),Xc=a(35),ud=a(18),Vd=a(306),ge=a(51),Je=a(611),Ke=a(73),nf=a(59),uf=a(77);class ef extends oc.a{constructor(na,S,Ja){super(Ja,na);this.Oza=
this.hashCode=null;this.Zac=!1;this.Np=(rb,ma)=>{ma.Gf.hash===this.hashCode&&this.Oza&&Object(Nb.a)(a(777).DdaFacade,this.$.ia.Ja(35)).e3j(this.Oza.InstanceId)};this.ph=(rb,ma)=>{switch(ma.Gf.block.state){case 1:case 3:case 5:this.Mha(ma)}};this.Bk=()=>{this.ROb(!0)};this.rr=(rb,ma)=>{this.isVisible&&this.TYa(ma.ZC);this.clearCache()};this.Jg=(rb,ma)=>{this.WXa(ma.pa,!!ma.ZC)};this.Jz=()=>{this.$.ea.wqa()};this.BZa=S;this.domElement.classList.add(Xc.a.Xfc);this.domElement.classList.add(ud.a.bB);Ja.tabIndex=
0;this.WXa(this.$.pa,!1);this.uf.la("mousedown",this.Jz);this.uf.la("contextmenu",rb=>{uf.g(rb)});this.$.ta.CM(this.rr);this.$.ue.CM(this.rr);this.$.ue.zj(this.Jg);this.$.ta.zj(this.Jg);this.ya.Zu(this.ph);this.ya.bK(this.Np);this.ya.wt(this.Bk);this.$u(this.JCa)}get ya(){return this.BZa}dispose(){this.$&&(this.$.ta.mO(this.rr),this.$.ue.mO(this.rr),this.$.ue.dk(this.Jg),this.$.ta.dk(this.Jg));this.BZa&&(this.BZa.Tt(this.ph),this.BZa.EL(this.Np),this.BZa.ds(this.Bk));this.Vx(this.JCa);this.clearCache();
gb.a.Ma(this.BZa);this.BZa=null;Yd.DOMElementExtensions.xi(this.domElement);super.dispose()}hSj(na){Yd.DOMElementExtensions.xi(Yd.DOMElementExtensions.getElementById(this.domElement,na.id));this.domElement.appendChild(na)}iwd(){if(this.Oza&&!this.Zac){var na=Object(Nb.a)(a(777).DdaFacade,Kc.a(this.$)).$o(this.Oza.InstanceId);na&&(na.resize(this.Oza.Width,this.Oza.Height),na.la(this.domElement),na.showHide(!0),this.Zac=!0)}}mcb(){return!0}Mha(na){this.Oza=na.Gf.block.qg;this.Zac=!1;this.iwd()}TYa(na){this.$.ea.b3&&
na&&(na.Nu||(na.Nu=new Vd.a),na.Nu.ql=new ge.a(this.domElement.scrollLeft,this.domElement.scrollTop),na.Nu.gOb=20)}clearCache(){this.ya.tVa(this.hashCode,"ClearCacheWebExtensionView");this.Oza=this.hashCode=null;this.Zac=!1}WXa(na,S){if(this.isVisible=!!na&&Ke.o(na))this.hashCode=this.ya.dwa(na,nf.a.Ycc,this.hashCode),this.RFc(S)}static YKa(na){if(!na.ia.Ja(34)){const S=na.Yh;na.ia.Va(34,new ef(na,new Je.a(na,na.ea,na.qa.Cn,3,0),S.appendChild(S.ownerDocument.createElement("div"))))}}}Object(b.a)(ef,
"WebExtensionView",oc.a,[809,482,5]);var Ve=a(236),bd=a(446),be=a(58),jb=a(29),lc=a(127),Zc=a(52),dd=a(48),Qd=a(186),ue=a(123),qa=a(69),Xa=a(32),wb=a(34),Rb=a(234),vc=a(22),Nc=a(12),id=a(249),Id=a(771),me=a(55),Wb=a(178),Ec=a(868);const hd=na=>{Wb.a.sendOtelEvent(Object.assign(new Ec.a,{otelEvent:na}))},je=na=>{Wb.a.sendOtelCustomerContent(Object.assign(new Ec.a,{otelEvent:na}))};var Ee=a(916),Ge=a(26),bf=a(759);class of{constructor(na,S,Ja){this.bBc=0;this.jxe=new Set;this.ovf=!1;this.$=na;this.Ij=
S;this.Kj=Ja}E6g(na){1===na.actionType?this.Ij.$K(65541,yc.a.tO)?this.bBc++:h.ULS.sendTraceTag(509649754,0,10,"AugmentationLoop AnnotationAdded event is not registered"):2===na.actionType&&0<this.bBc&&this.bBc--}H4i(na,S){if(0===this.bBc)h.ULS.sendTraceTag(509649753,0,50,"No event listeners. Event not fired.");else if(S){na=S.annotation;var Ja=[];Ja.push({content:JSON.stringify(S.annotation),annotationType:bf.a.L8(na),id:na.id});this.Kj.cG(65541,yc.a.tO,JSON.stringify({annotationProperties:Ja}))}else h.ULS.sendTraceTag(509649752,
0,10,"Event args are null")}jni(na){const S=this;return Ko(function*(){if(!S.Ij.$K(65541,yc.a.tO))h.ULS.sendTraceTag(509649751,0,10,"Event is not registered");else if(!S.jxe.has(na.annotationType)){var Ja=yield nd.a.resolve(qd.j,{Oa:1});S.ovf||(Ja.register(Ja.p2().L4("RichApi").J4(()=>{}).build()),S.ovf=!0);Ja.iha("RichApi",{annotationType:na.annotationType,uu:!1,XU:S.H4i.bind(S)});S.jxe.add(na.annotationType)}})}kni(na){return Ko(function*(){(yield nd.a.resolve(qd.j,{Oa:1})).NUb(JSON.parse(na.content));
h.ULS.sendTraceTag(509649750,0,100,`Submit operation for type: ${na.signalType}`)})}}Object(b.a)(of,"RichApiAugmentationLoopHandler",null,[]);a.d(B,"DdaFacade",function(){return hf});class hf extends ab.a{constructor(na,S,Ja){super();this.Kj=this.jm=this.ea=null;this.Th=[];this.uNa=null;this.disposed=this.initialized=this.IXb=this.jTe=!1;this.CGa=null;this.oyc=[];this.dTe=[];this.lUa=[];this.x6a=null;this.pOd=new yb.a(K.a.Ei());this.X6b=new P.a(K.a.Ei());this.UNb=[];this.kXf=[];this.Iyb=350;this.yBa=
this.V_=null;this.U1c=!1;this.ose=this.nse=this.dse=this.mse=this.lse=this.jse=this.fse=this.kse=this.gse=this.ise=this.ese=this.hse=null;this.XEg=3E3;this.gOc=!1;this.YO=this.opb=null;this.gi=()=>{this.CGa=this.ea.Kp.WebExtensions;var rb=ib=>Y.EwaSettings.Fa(114)?!ib.Pxa:!0,ma=ib=>Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7116850_fixDialogApiOsfControlDeletedBySheetLocking")?!ib.pHi:!0;for(let ib=this.Th.length-1;0<=ib;--ib){let Qb=this.Th[ib];!this.VVh(Qb.controlId)&&rb(Qb)&&ma(Qb)&&(Qb.owc(),
this.Th.splice(ib,1))}if(this.CGa)for(let ib=0,Qb=this.CGa.length;ib<Qb;ib++)rb=this.CGa[ib],(ma=this.$o(rb.WebExtensionId))&&ma.ILd(rb)};this.txc=rb=>{this.raiseEvent("csc",rb.getID())};this.MMb=(rb,ma,ib)=>{if(ma===OSF.AgaveHostAction.KeyboardShortcuts){var Qb=Object(Nb.a)(Object,ib);ma={};ma.keyCode=Qb.keyCode;ma.type="keydown";ma.ctrlKey=Qb.ctrlKey;ma.shiftKey=Qb.shiftKey;ma.altKey=Qb.altKey;ma.metaKey=Qb.metaKey;Qb=this.$o(rb);rb=Qb.bda;ma.srcElement=Object(qc.a)(246,rb)?rb.Ltb:La.h(this.$).Df;
rb=new Sys.UI.DomEvent(ma);Qb=hf.fza(Qb.un,this.$);ma={};ma.focusedAddinId=Qb;Qb=new Kd.a(1461300262,1,this.$.Ie,6,null);La.h(this.$).nRb(rb,Qb,ma)}else if(ma===OSF.AgaveHostAction.Select)this.Hif(!0);else if(ma===OSF.AgaveHostAction.UnSelect)this.Hif(!1);else if(ma===OSF.AgaveHostAction.CancelDialog)this.zN(-684355545,null);else if(ma===OSF.AgaveHostAction.InsertAgave)rb={},ib&&(this.opb=ib,rb[Z.a.Wka]=ib,rb[sb.a.di]=this.xxa(ib),this.zN(-741808261,rb));else if(ma===OSF.AgaveHostAction.ClickTrust)this.n5c&&
ib&&(this.opb=ib);else if(ma===OSF.AgaveHostAction.OsfControlLoad)this.n5c&&this.opb&&ib&&this.B5g(this.opb,ib)&&ib.storeType&&(this.opb=null,this.Sz(ya.b(ib.storeType)));else if(ma===OSF.AgaveHostAction.InsertDevManifest)rb={},ib&&(rb[Z.a.Wka]=ib,rb[sb.a.di]=this.xxa(ib),this.zN(-741808261,rb));else if(ma===OSF.AgaveHostAction.InsertDevManifestError)rb=Object(Nb.a)(Object,ib),rb={[Z.a.Y4c]:this.jm.getDevManifestInvalidUrlErrorString(rb.manifestUrl)},this.zN(-2025863019,rb);else if(ma===OSF.AgaveHostAction.NotifyHostError)rb=
{[Z.a.Y4c]:this.jm.getManifestInvaildErrorString()},this.zN(-2025863019,rb);else if(ma===OSF.AgaveHostAction.RefreshAddinCommands)Y.EwaSettings.Fa(52)&&this.zN(Ge.a.refreshAddinCommands,null);else if(ma===OSF.AgaveHostAction.CtrlF6Exit||ma===OSF.AgaveHostAction.CtrlF6ExitShift){if(Qb=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateEwaAccessibilityManager",!1)?nd.a.rg(qd.eb):this.$.ia.Ja(15)){(rb=this.$o(rb).bda)&&rb.fIc();m.a.Zh&&document.activeElement.blur();var Fc={keyCode:117,
type:"keydown",ctrlKey:!0};Fc.shiftKey=ma===OSF.AgaveHostAction.CtrlF6ExitShift;Fc.srcElement=Object(qc.a)(246,rb)?rb.Ltb:La.h(this.$).Df;rb=new Sys.UI.DomEvent(Fc);Qb.kqa(rb)}}else if(ma===OSF.AgaveHostAction.PageIsReady){if((rb=this.$o(rb).bda)&&rb.r3a===OSF.OsfControlTarget.TaskPane&&(rb=this.$.ia.Ja(183))&&this.Th)for(Qb of this.Th)hf.OQa(Qb.QP)&&rb.nl(!0,!1)}else if(ma===OSF.AgaveHostAction.TabExit){ma=this.$o(rb);const ne=ma.bda;ne?ne.r3a===OSF.OsfControlTarget.InContent?ne.wyf():ne.r3a===OSF.OsfControlTarget.TaskPane&&
(m.a.Zh&&document.activeElement.blur(),Ia.UISurfaces.Pl().then(Te=>{const Hb=Object(qc.a)(246,ne)?ne:null;Hb?Hb.isResizable?Te.focusResizeHandle():Te.focusTabbedTaskPaneArea():Te.focusTabbedTaskPaneArea();return null})):ma&&4===ma.osfControlType&&this.jm.notifyAgave(rb,OSF.AgaveHostAction.TabIn)}else if(ma===OSF.AgaveHostAction.TabExitShift)(ma=this.$o(rb),Qb=ma.bda)?Qb.r3a===OSF.OsfControlTarget.InContent?Qb.xyf():Qb.r3a===OSF.OsfControlTarget.TaskPane&&(rb=Object(qc.a)(246,Qb)?Qb:null)&&(m.a.Zh&&
document.activeElement.blur(),rb.oTj()):ma&&4===ma.osfControlType&&this.jm.notifyAgave(rb,OSF.AgaveHostAction.TabIn);else if(ma===OSF.AgaveHostAction.EscExit||ma===OSF.AgaveHostAction.ExitNoFocusable||ma===OSF.AgaveHostAction.ExitNoFocusableShift)if(Qb=this.$o(rb).bda)Qb.fIc();else{if(ma===OSF.AgaveHostAction.EscExit){ma=null;for(Fc of L.Dli())if(Fc.value.Rg===rb){Fc.value.dialog.hide();ma=Fc.key;break}ma&&(rb=this.$o(ma))&&4!==rb.osfControlType&&this.Qh.notifyAgave(ma,OSF.AgaveHostAction.TabIn)}}else if(ma===
OSF.AgaveHostAction.InstallCustomFunctions)if(Y.EwaSettings.Fa(114)){qa.a(this.$).i7e(()=>!1);var jd=this.$.ia;jc.TaskExtensions.Aa(Wc.GetServiceTaskFactory.je(jd,278,279,1),ne=>{ne=ne.result;jd.Ja(278)||jd.Va(278,ne);const Te=ib.osfControl.getStoreType();ne.Yof(ib.osfControl.getSolutionId(),Te,hf.g6h(ib.osfControl),ib).Cra()},this.ma,3)}else h.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(ma===OSF.AgaveHostAction.UninstallCustomFunctions)if(Y.EwaSettings.Fa(114)){qa.a(this.$).i7e(()=>
!1);var ke=this.$.ia;jc.TaskExtensions.Aa(Wc.GetServiceTaskFactory.je(ke,278,279,1),ne=>{ne=ne.result;ke.Ja(278)||ke.Va(278,ne);ne.itg(ib.solutionId,ib.storeType).Cra()},this.ma,3)}else h.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else ma===OSF.AgaveHostAction.SendTelemetryEvent?hd(ib):ma===OSF.AgaveHostAction.SendCustomerContent?je(ib):ma===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.aQi(ib):ma===
OSF.AgaveHostAction.RefreshRibbonGallery?(rb=this.$.ia.Ja(519))&&rb.qtd(ib):ma===OSF.AgaveHostAction.RemoveAppCommandsAddin?this.LBj(ib.solutionId):ma===OSF.AgaveHostAction.GetOriginalControlId&&(rb=new ob.a(this.$.He,ib.ownerAddinSolutionId,new Mb.a,!0),ib.originalControlId=rb?rb.zTe(ib.controlId):ib.controlId)};this.bQj=(rb,ma)=>{const ib=Array(2);ib[0]=ma;ib[1]=null;this.Kj.gWh(rb,JSON.stringify(ib))};this.qij=()=>{this.$.pa&&Ke.o(this.$.pa)&&this.$.ia.Ja(34).iwd()};this.fg=()=>{this.AAf()};this.ph=
(rb,ma)=>{rb=ma.Gf;(rb=(rb=rb.block.state&1?rb.block.qg:null)?rb.CustomFunctionsObjects:null)&&this.Tcd(rb)};this.aV=(rb,ma)=>{var ib,Qb;1===ma.Bu&&(rb=ma.ni)&&(ma=new fe(ue.toTimestamp(rb.enqueueUtcTime),ue.toTimestamp(rb.processUtcTime),ue.toTimestamp(rb.dequeueUtcTime),ue.getElapsedMilliseconds(rb.enqueueUtcTime,rb.processUtcTime),ue.getElapsedMilliseconds(rb.processUtcTime,rb.dequeueUtcTime),rb.operationCount,(null===(Qb=null===(ib=rb.operation)||void 0===ib?void 0:ib.Nf)||void 0===Qb?0:Qb.ServerCorrelationId)?
rb.operation.Nf.ServerCorrelationId:null,rb.operation?Enum.toString(bd.a,rb.operation.operationName):null,Id.a.nG(ue.getElapsedMilliseconds(rb.enqueueUtcTime,Xa.a.Jd.Re))),ib=Sys.Serialization.JavaScriptSerializer.serialize(ma),h.ULS.sendTraceTag(50872916,0,50,ib))};this.vf=(rb,ma)=>{!this.ea.Ee&&Ve.a(ma)?(Array.forEach(this.Th,this.oMf),this.Th.length=0,this.IXb=!1):(ma.vI&&(h.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.e9f()),this.rO(),Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&
(this.IXb=!1))};this.ro=()=>{Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(h.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.e9f());this.rO();Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.IXb=!1)};this.oMf=rb=>{rb.owc();this.raiseEvent("cd",rb.controlId)};this.Pd=na;this.q5c=S;this.initialize(Ja);Ma.la(this);this.s$f=0;(na=(na=!(m.a.Xr||m.a.i3))&&!m.a.Zh)&&OfficeExt.ShortcutKeyDispatchManager.init();
this.eLg={}}get J3a(){return this.V_||(this.V_=new cb.a(this.$.QA))}bAe(na){this.addHandler("cd",na)}RCj(na){this.removeHandler("cd",na)}vZg(na){this.addHandler("csc",na)}TCj(na){this.removeHandler("csc",na)}sZg(na){this.addHandler("ca",na)}QCj(na){this.removeHandler("ca",na)}tZg(na){this.addHandler("ci",na)}uZg(na){this.addHandler("ekros",na)}SCj(na){this.removeHandler("ekros",na)}UNd(na,S){try{return JSON.parse(na)[S].toLowerCase()}catch(Ja){return""}}mZj(na){const S=this.UNd(na,"AudienceGroup"),
Ja=this.UNd(na,"SessionOrigin");try{const rb=parseInt(this.UNd(na,"Ring"),10);if("automation"!==S&&"bluechicken"!==Ja&&-2<=rb)return!0}catch(rb){if("automation"!==S&&"bluechicken"!==Ja)return!0}return!1}get Qh(){if(!this.jm){const na={},S=!(this.$.hg&1),Ja=fd.a.current.FB,rb=this.$.workbookContext,ma=Kb.a.XL+Kb.a.wac;na.pageBaseUrl=Ja.LayoutsContentUrlPrefix;na.appName=OSF.AppName.ExcelWebApp;na.appVersion="16";na.appSettings=this.s$h();na.singleSignOnSettings=J.a.Thi();na.clientMode=S?OSF.ClientMode.ReadOnly:
OSF.ClientMode.ReadWrite;na.appUILocale=this.$.xa.UICultureTag;na.dataLocale=this.$.xa.DataCultureTag;na.docUrl=rb.ClientUrl;na.hostControl=this;na.formFactor=OSF.FormFactor.Default;na.lcid=this.$.VG.toString();na.localizedScriptsUrl=Kb.a.XL+Kb.a.jbd;na.localizedImagesUrl=ma;na.localizedStylesUrl=Kb.a.XL+Kb.a.WNe;na.localizedResourcesUrl=ma;na.osfOmexBaseUrl=Ja.OsfOmexBaseUrl;na.firstPartyManifestCDNUrl=Ja.FirstPartyAddInManifestCDN;na.sdxAssetsToPrefetchMapping=x.AFrameworkApplication.da.Ra("SdxAssetsToPrefetchMapping");
na.sdxCdnUrl=Ja.SdxCdnUrl;na.sdx1CdnUrl=Ja.Sdx1CdnUrl;na.forceUseSdx1Cdn=Ja.ForceUseSdx1Cdn;na.sdxDmsUrl=Ja.SdxDmsUrl;na.sovereignFederationDMSToken=Ja.SovereignFederationDMSToken;na.sovereignFederationDMSTokenSuffix=Ja.SovereignFederationDMSTokenSuffix;na.devCatalogUrl=Ja.DevCatalogUrl;na.controlStatusChanged=this.txc;na.notifyHost=this.MMb;na.allowExternalMarketplace=this.$.ea.Qj.get(27)&&hf.hbc;na.enableAddinCommands=Y.EwaSettings.Fa(52);na.enableBlackForestRedirect=Y.EwaSettings.Fa(87);na.enableMyOrg=
this.$.ea.Qj.get(33);na.enableMyApps=this.$.ea.Qj.get(34);na.enableDevCatalog=Y.EwaSettings.Fa(43);na.enablePrivateCatalog=this.g_j();na.showSignOutFromPrivateCatalogMessage=this.$.ea.Qj.get(36);na.enableUploadFileDevCatalog=Y.EwaSettings.Fa(52)&&!Y.EwaSettings.Fa(254);na.userNameHashCode=H.a.hz(x.AFrameworkApplication.userName);na.envCode=this.$.xa.OfficeAddinTelemetryDataSourceCode.toString();na.enableSingleSignOnForAddin=x.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;na.enableDisplayBlockedMinorError=
Y.EwaSettings.Fa(171);na.hideAppsExtensionUrl=x.AFrameworkApplication.hideAppsExtensionUrl;na.enableAnonymousUseLegacyCatalogService=Y.EwaSettings.Fa(162);na.enableInsertDialogAccessibilityFix=Y.EwaSettings.Fa(169);na.disableAppsForOfficeThirdParty=Y.EwaSettings.Fa(174);na.enableFirstPartySSO=Y.EwaSettings.Fa(186);na.wacSessionId=this.$.xa.UserSessionId;na.disableLogging=!this.$.xa.AriaLoggingIsEnabled;na.enableFirstPartySDXErrorMessages=Y.EwaSettings.Fa(198);na.isHostDocumentDomain=Y.EwaSettings.Fa(209);
na.loggableUserId=x.AFrameworkApplication.da.Ra("LoggableUserId");na.sessionStartInfoJson=x.AFrameworkApplication.da.Ra("SessionStartInfoJson");na.wopiHostOriginFromPostMessage=x.AFrameworkApplication.wopiHostOriginFromPostMessage;na.wopiHostOriginFromWacPropBag=x.AFrameworkApplication.da.Ra("PostMessageOrigin");na.wacIsEmbedded=x.AFrameworkApplication.da.na("IsEmbedded");na.accessibilityAllowFocusAddinTaskpane=x.AFrameworkApplication.da.na("AccessibilityAllowFocusAddinTaskpane");na.enableRemoveAppCommandsAddin=
x.AFrameworkApplication.da.na("RemoveAppCommandsAddinIsEnabled");na.isHostFrameTrustCheckEnabledForAddIns=x.AFrameworkApplication.da.na("HostFrameTrustCheckIsEnabledForAddIns");na.isHostFrameTrusted=x.AFrameworkApplication.isHostFrameTrusted;na.agaveAddinUploadEnabled=Y.EwaSettings.Fa(45);na.hostAllowedOfficeStore=x.AFrameworkApplication.da.na("HostAllowedOfficeStore");na.hostAllowedSdxEmbedding=x.AFrameworkApplication.da.na("HostAllowedSdxEmbedding");na.hostInstallAddIns=x.AFrameworkApplication.da.Ra("HostInstallAddIns");
na.hostInstallAddInsIsEnabled=x.AFrameworkApplication.da.na("HostInstallAddInsIsEnabled");na.approvedAddIns=x.AFrameworkApplication.da.Ra("ApprovedAddIns");na.addinEnforceHttpsIsEnabled=this.mZj(na.sessionStartInfoJson);na.hostFeatureGateFlag=0;na.isUpnCheckEnabled=x.AFrameworkApplication.da.na("IsUpnCheckEnabled");na.wacUpn=x.AFrameworkApplication.da.Ra("UserPrincipalName");na.isReactRibbonEnabled=jb.a.isReactRibbonEnabled();na.enableSetFocusOnTaskpaneOnUserAction=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",
!1);na.isSafariWithIndexedDBDisabled=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&m.a.BRa;na.isIndexedDBDisabled=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&m.a.BRa||Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&m.a.Zh;na.enableCustomShortcuts=!0;na.changeGetModifierKeyStringOutputOrder=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");na.officeJsUrl=x.AFrameworkApplication.xV("OfficeJs/excel.js",
5);na.enableOfficeJsUrlParam=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.jm=new OSF.ContextActivationManager(na);this.jm.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.jm.setWSA(x.AFrameworkApplication.Up);this.jm&&"undefined"!==typeof this.jm.hostCheckReadyHandler&&x.AFrameworkApplication.u_g(Object(Gb.a)(this.jm,this.jm.hostCheckReadyHandler,"hostCheckReadyHandler"));try{const ib=db.a.instance.resolve("Common.App.OAuth.IOAuthManager");
this.jm.setOAuthManager(ib)}catch(ib){}}return this.jm}get Prk(){return this.U1c}get Ij(){return this.hse}get yra(){return this.ese}get pXd(){return this.ise}get oXd(){return this.gse}get PKj(){return this.kse}get NKj(){return this.fse}get OKj(){return this.jse}get QKj(){return this.lse}get RKj(){return this.mse}get qXd(){return this.nse}get r$f(){return this.ose}get HY(){return this.eLg}get $(){return this.Pd}get nXd(){return this.dse}G8b(na){const S={};S.Name=na.Name;S.BindingType=na.BindingType;
S.HasHeaders=na.HasHeaders;na.IsValidRef&&(S.ColCount=na.Reference.LastColumn-na.Reference.FirstColumn+1,S.RowCount=na.Reference.LastRow-na.Reference.FirstRow+1);return S}get Z4c(){return x.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&x.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)}Ozf(na,S){const Ja=this.Q$g(S);let rb=null;if(x.AFrameworkApplication.da.isChangeGateEnabled("OfficeVSO:7073634_TellMeLaunchAddinDialogSetTabIdEnabled")&&
Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1)&&null!==S&&"LaunchAddinDialogFromTellMe"===S[0])null!==Ja.assetId&&"undefined"!==typeof Ja.assetId&&(rb="{98143890-AC66-440E-A448-ED8771A02D52}");else if(this.Z4c){const ma=this.$.ea.Qj.get(27);!ma||null===S||"InsertMoreAddInsFromFooter"!==S[0]&&"InsertMoreAddInsFromBackstageFooter"!==S[0]?!ma||null===S||"AddinFlyoutMoreButton"!==S[0]&&"LaunchMyAddInsFromBackstage"!==S[0]||(rb="0"):rb="{98143890-AC66-440E-A448-ED8771A02D52}"}this.jm.launchInsertDialog(na,
rb,Ja)}get L6(){return this.sKa}get sKa(){this.n5c&&!this.YO&&(this.Hzj&&this.AHh(this.XEg),this.YO=fc.createInstance(x.AFrameworkApplication.da,new hb.a(()=>this.jm),{["AppsForOfficeAllowExternalMarketplace"]:this.allowExternalMarketplace,["AppsForOfficeThirdPartyIsDisabled"]:this.xbk,["AreThirdPartyAddInsAllowed"]:this.$.$0,["PopularAddinDetailsJsonString"]:hf.Iqa,["UICulture"]:x.AFrameworkApplication.uiCulture}));return this.YO}get xbk(){return Y.EwaSettings.Fa(174)}get allowExternalMarketplace(){return this.$.ea.Qj.get(27)}get n5c(){return x.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)}static get Iqa(){return'[{"displayName":"Bing Maps","solutionId":"wa102957661","version":"1.5.0.0","targetType":0,"width":600,"height":600,"description":"The Bing Maps add-in makes it easy to plot locations and visualize your data through Bing Maps in Excel","iconUrl":"45.d6c30518-91f7-4e79-b846-0813b56a1b2d.75cc16b5-7155-4a84-8094-a4ae7e997116.688fcadb-9dca-414b-91d4-2075b00c2772.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1770}},{"displayName":"Mini Calendar and Date Picker","solutionId":"wa102957665","version":"1.3.0.0","targetType":0,"width":240,"height":220,"description":"Add a mini monthly calendar to your spreadsheet and use it to insert dates or the current time.","iconUrl":"31013.352a833c-760b-49ee-b384-f9718a71d650.3966871d-bbca-4abd-996d-777127e5f717.aac00a7f-336d-4d49-9fbb-f41bc3db4515.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.vertex42.com/privacy.html","addinInfo":{"priority":1,"AUP":20064}},{"displayName":"Bubbles","solutionId":"wa103147117","version":"1.1.0.0","targetType":0,"width":500,"height":500,"description":"Visualize your data in a fun and interactive way using bubbles to quickly identify patterns.","iconUrl":"6406.490601bf-78b6-49e5-be4f-e671fe712516.9fc1cb98-b071-4854-918e-40a0d2c7a467.49ae5470-5b06-4fa6-8762-6977e397810a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://roljs.azurewebsites.net/bubbles-privacy-statement","addinInfo":{"priority":1,"AUP":40}},{"displayName":"Geographic Heat Map","solutionId":"wa103304320","version":"1.1.0.0","targetType":0,"width":480,"height":350,"description":"This app will help you visualize data across geographic locations. It\'s simply formatting on a map.","iconUrl":"33870.9aae8635-7790-49e5-9809-7704d4347793.cf84e746-9ce3-4a9a-83c5-4efc8117bc45.2cdca20b-36a0-45d8-bc0e-859ce6e806da.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"","addinInfo":{"priority":-1,"AUP":359}},{"displayName":"QR4Office","solutionId":"wa104051163","version":"1.2.0.3","targetType":1,"width":0,"height":0,"description":"A first-of-its-kind QR-generator that integrates seamlessly into your Office documents.","iconUrl":"53638.20ce8aca-39c5-4b97-b87a-47d0f3e21e0d.0b60ea0f-7e02-4465-baeb-bb55c723d670.9147ef8e-cf16-47cf-af10-ef553e88804d.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://q.michaelzlat.com/","addinInfo":{"priority":1,"AUP":1369}},{"displayName":"Wikipedia","solutionId":"wa104099688","version":"1.4.0.0","targetType":1,"width":0,"height":0,"description":"Find and quote related information from Wikipedia.","iconUrl":"7450.110c9a11-7db2-4228-b768-f1ad828e16be.9bd16ea2-22ff-455c-9f92-70de827e079a.aeef7210-898b-4a79-82b5-b648805129b9.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674774/Asset_733b35d6-e5e0-4163-b45d-3396185864bd/WIKIPEDIAAPPFOROFFICELICENSETE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":2,"AUP":368}},{"displayName":"Solver","solutionId":"wa104100404","version":"3.0.0.1","targetType":1,"width":0,"height":0,"description":"Solve optimization models in Excel Online and Excel on iPad, upward compatible from Solver in Excel.","iconUrl":"37315.adb6ef87-ef0f-4f99-b639-c08a45950b58.cb56fe0c-c385-43b5-8c1b-88701ddbb898.c5239aae-28c3-4dec-8338-e6c0ceef5b82.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":3,"AUP":3146}},{"displayName":"People Graph","solutionId":"wa104104476","version":"1.4.0.0","targetType":0,"width":580,"height":400,"description":"Transform cold data into a cool picture.","iconUrl":"49387.7b82fde0-3b87-471f-a121-86215bd4c0d4.5c5551ff-1f1c-4fdd-83a0-9a311307f989.b07f3a4e-26ca-4174-83e2-a8953ecb5eb6.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949674809/Asset_488b8377-7de8-40ce-82ca-0a2fd48220dd/PEOPLEGRAPHAPPFOROFFICELICENSE.docx","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":1,"AUP":1364}},{"displayName":"E2D3","solutionId":"wa104379169","version":"2.0.1.0","targetType":0,"width":800,"height":680,"description":"Create dynamic and interactive graphs on Excel","iconUrl":"1677.6b2891ac-505f-41cc-80f6-db53a4274b85.62a2ad24-69c3-41ae-9419-bd700be3f626.67a1d711-d2ca-4e12-94b8-49464dc829ec.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://e2d3.org/privacy","addinInfo":{"priority":1,"AUP":68}},{"displayName":"XLMiner Analysis ToolPak","solutionId":"wa104379190","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistical analysis in Excel Online, with functions matching the Analysis ToolPak in desktop Excel.","iconUrl":"2225.9cbf413e-e33f-4be9-90ef-2fdb353c52a1.6e475dbb-9ae3-4b89-ae41-004faa21a088.e9552e6b-53ec-4728-ba49-ba04757c6dd0.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-analysis-toolpak-app","addinInfo":{"priority":3,"AUP":6262}},{"displayName":"Stock Connector","solutionId":"wa104379220","version":"8.0.0.0","targetType":1,"width":0,"height":0,"description":"Link stocks, currency, & crypto prices to cells in Excel spreadsheets and update them in real time.","iconUrl":"35421.d104d786-d979-48bb-9827-1b28ac5178cf.c0696ae0-87b8-4c16-ab8c-171be18ca0a9.8dcfdc9c-2863-4fa9-905d-84ff8534af7a.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://michael-saunders.com/stocksapp/pages/privacy.html","addinInfo":{"priority":1,"AUP":1710}},{"displayName":"Symbols and Characters - Fast Symbol Lookup","solutionId":"wa104379279","version":"2.1.0.0","targetType":1,"width":0,"height":0,"description":"Symbols and characters | Fast symbol and emoticon search with convenient auto-lookup","iconUrl":"53409.631e9a68-2435-4716-b1b8-dc48b99d3f85.d2f9c29f-cf48-4dcc-8202-fcbc5e4d1482.0216011c-2369-4ee7-8351-ac51d77015c2.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/legalconditions/Default.aspx","addinInfo":{"priority":1,"AUP":673}},{"displayName":"Microsoft Dynamics Office Add-in","solutionId":"wa104379629","version":"1.3.0.0","targetType":1,"width":0,"height":0,"description":"The Microsoft Dynamics Office Add-in enables data connections to Microsoft Dynamics systems.","iconUrl":"2287.eac0bf67-c34b-4302-aaa9-a07c1e560721.16c405d8-e48b-42e1-ac8f-7c402b8ae0d1.5ce79e5f-d108-48a7-b34b-75c71b620973.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949677398/Asset_e3871df6-665b-4927-a7fe-cd9e228611cc/LCSTermsofUseFinalFebruary2016.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":3,"AUP":2790}},{"displayName":"officeatwork | Template Chooser for Office - M365","solutionId":"wa104380050","version":"3.4.0.0","targetType":1,"width":0,"height":0,"description":"Access your centrally shared templates in Office, Teams, SharePoint Online, and other Apps.","iconUrl":"21517.40f3490e-24f2-4502-9a44-28e543d36a75.cc0236b1-594c-49ad-9462-3f787be3cd4f.f383d0e6-2de8-4367-9108-e62781456dad","licenseUrl":"https://links.officeatwork.com/officeatwork-licenseterms","privacyUrl":"https://links.officeatwork.com/officeatwork-privacypolicy","addinInfo":{"priority":1,"AUP":588}},{"displayName":"Lucidchart Diagrams for Excel","solutionId":"wa104380194","version":"1.1.2.0","targetType":1,"width":0,"height":0,"description":"The easiest way to draw and insert flowcharts, mockups, UML, mind maps and more in Office documents.","iconUrl":"21470.3fa72610-07ba-489f-b48f-1fcb5ca4253a.fc3d89ad-c9dc-445c-9baa-074b7b8f0cfb.9bc93e17-dd72-4215-b8b0-0cf81a3d9925.png","licenseUrl":"https://www.lucidchart.com/pages/tos","privacyUrl":"https://www.lucidchart.com/pages/privacy","addinInfo":{"priority":3,"AUP":358}},{"displayName":"Microsoft PowerApps Office Add-in","solutionId":"wa104380330","version":"1.3.0.1","targetType":1,"width":0,"height":0,"description":"The Microsoft PowerApps Office Add-in enables data connections to Microsoft PowerApps systems","iconUrl":"60124.e1dfe8b1-6892-4a07-bb52-91fc1006be11.a6787a94-2200-4943-9d6a-f9efb8369662.47ff6184-6b13-4120-955b-1c285e83cbc7.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836617/Product_42949679879/Asset_661a2a7f-2764-43c5-aef4-25bc316a1b08/DynamicsAppforOfficeSLTEnglish.pdf","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=271135","addinInfo":{"priority":2,"AUP":597}},{"displayName":"Adobe Acrobat for Microsoft Word, Excel, and PowerPoint","solutionId":"wa104380526","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Do more with enterprise PDF tools, built right into your favorite Microsoft 365 apps.","iconUrl":"832.4553b45a-c9b7-42b8-9c57-e33b57f5df4d.80d83ec3-4ec7-4f7d-b45f-36b1f0c05e78.3d5b10f9-0a9c-4ac1-84fc-b7439dfb4f35.png","licenseUrl":"https://www.adobe.com/go/terms_en","privacyUrl":"https://www.adobe.com/go/privacy_policy_en","addinInfo":{"priority":1,"AUP":1812}},{"displayName":"ChartExpo\u2122 for Excel","solutionId":"wa104380662","version":"1.0.0.7","targetType":0,"width":655,"height":390,"description":"Select a chart, select your data, and create Insightful charts without hardwork!","iconUrl":"47793.590471af-7e3e-4855-8e7f-1438a654488b.5e466c13-5861-4e47-bf0e-d6a735f06208.7800aa4f-c6b6-43bb-8099-c14624743abc.png","licenseUrl":"https://www.chartexpo.com/Home/EULA","privacyUrl":"https://www.chartexpo.com/Home/OfficeAppPrivacy","addinInfo":{"priority":1,"AUP":434}},{"displayName":"Facebook Ads Manager for Excel","solutionId":"wa104380711","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"The fastest way to view performance data for all of your Facebook ad accounts.","iconUrl":"47990.d08ffb67-b1f0-4ef6-ac6f-4b5379c5d285.a5cb5ec2-3726-4cf0-ae84-5d8ee7ee3439.3af0d784-7a14-4e39-897b-24e4e633fb76.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.facebook.com/about/privacy","addinInfo":{"priority":3,"AUP":353}},{"displayName":"Script Lab, a Microsoft Garage project","solutionId":"wa104380862","version":"1.5.0.0","targetType":1,"width":0,"height":0,"description":"Create, run, and share your Office Add-in code snippets from within Excel, Word, or PowerPoint.","iconUrl":"52703.9fd54003-f1a2-4196-a8a8-ea11bec509a8.9b4da1d4-cb1c-46e6-9463-8a258eb273e6.b5c7baa9-2a17-4db7-b0dd-ca9dea75bd27.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/?LinkId=521839","addinInfo":{"priority":-1,"AUP":1299}},{"displayName":"Excel-to-Word Document Automation","solutionId":"wa104380955","version":"3.16.2.1","targetType":1,"width":0,"height":0,"description":"Update Word and PowerPoint documents from Excel data, calculations, text, tables, and charts.","iconUrl":"44742.554108a6-3275-4065-9a18-887d38776dca.31f4b432-c6cb-49c5-9fba-56c194301365.e534a91d-b3f5-445e-bdbd-1559dbb4b396.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://analysisplace.com/Privacy","addinInfo":{"priority":3,"AUP":371}},{"displayName":"Journal Entry Batch Creator for Financial Edge NXT","solutionId":"wa104380978","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Create new journal entry batches in Financial Edge NXT via Excel (for existing customers)","iconUrl":"10843.146167ad-49b2-41d3-aff7-76ed38a0ea33.da610372-55d7-45b3-9134-1aa080eaa154.adce15a7-2cb2-4d79-90f8-6888df00287e.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.blackbaud.com/privacy-shield","addinInfo":{"priority":3,"AUP":297}},{"displayName":"Mobile Data Collection - Scan-IT to Office","solutionId":"wa104381026","version":"1.2.0.0","targetType":1,"width":0,"height":0,"description":"Real-time mobile data collection and barcode scanning for Excel and Word ","iconUrl":"7989.6963e6f3-4ebf-4a63-82b7-734a5a002866.814dcb0f-f024-477c-9b9b-9407aef3d56a.a4027334-e000-4b89-bd22-18d0d906a688.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tec-it.com/en/website/legalconditions/Default.aspx#Privacy","addinInfo":{"priority":3,"AUP":935}},{"displayName":"Functions Translator, a Microsoft Garage project","solutionId":"wa104381504","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Translate the Excel functions and formulas between different languages","iconUrl":"6460.beedf6f4-7724-4c03-8e90-d6cc7d58e77c.a85b2258-a967-4d48-898f-a8db56e4d9c6.1b6557bd-4e89-4bad-a3d7-0ad2f0f0ee55.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://go.microsoft.com/fwlink/p/?LinkId=123161","addinInfo":{"priority":2,"AUP":1421}},{"displayName":"Cryptosheets","solutionId":"wa104381695","version":"1.0.10.0","targetType":1,"width":0,"height":0,"description":"The easiest way to pull live, real-time, and historical cryptocurrency data directly into a sheet.","iconUrl":"44479.63cc4a83-c6d9-41b8-ab03-721c5071695c.9ab58e20-a9a3-4915-8ece-423d1fbe8e5f.af1fbf7c-11e4-4278-a726-d902df022e8c.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://cryptosheets.com/privacy","addinInfo":{"priority":3,"AUP":373}},{"displayName":"Microsoft Power Automate for Excel","solutionId":"wa104381701","version":"1.0.0.4","targetType":1,"width":0,"height":0,"description":"Automate repetitive tasks by integrating your favorite apps and services with Power Automate.","iconUrl":"24472.5327e164-9595-41b5-94b6-dc524c42d5f6.318749ea-0f55-45b9-aee5-b89aae584a0c.73475625-266a-4866-b041-d9536d4673bb.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":2,"AUP":8162}},{"displayName":"Tiller Money Feeds","solutionId":"wa104381717","version":"1.0.3.0","targetType":1,"width":0,"height":0,"description":"Manage your money, your way with the most powerful automated personal finance service for Excel.","iconUrl":"57987.b83fa962-bb4f-4dd1-89e2-6b40f8b0a724.95198c12-4345-4728-b4c6-d3e76bb58555.affa1083-0e0c-4cf9-b006-636291dae421.png","licenseUrl":"https://go.microsoft.com/fwlink/?LinkID=521715&omkt=en-US","privacyUrl":"https://www.tillerhq.com/privacy","addinInfo":{"priority":1,"AUP":192}},{"displayName":"FYI for Office","solutionId":"wa104381841","version":"1.0.2.2","targetType":1,"width":0,"height":0,"description":"Standardise your output and enforce filing across your practice with FYI.","iconUrl":"55705.a91d847f-3878-41c0-90a2-1a25491d561e.6ece2a38-0dd7-4c23-abd0-2d418443543e.4218a512-bae0-420b-b293-2194a885c9aa.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848155/Product_42949682443/Asset_5cb37a96-0b6a-4b64-bbf2-fa24ee29cec5/eula.pdf","privacyUrl":"https://www.fyidocs.com/privacy","addinInfo":{"priority":2,"AUP":696}},{"displayName":"VitalTax | Making Tax Digital (MTD) for VAT","solutionId":"wa104381859","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Submit your VAT return directly from Excel and digitally link your data to HMRC","iconUrl":"10434.1d05b34e-479a-4769-bf99-07b416b11cbc.482ef49e-8635-4bfe-bb8d-e5ce4a2a4e61.be642c2c-717a-424c-96d8-8cea91a28e75.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474848420/Product_42949682533/Asset_28a3de04-adcc-4a88-8d42-b3493d67599a/ENDUSERLICENSEAGREEMENT.docx","privacyUrl":"https://vitaltax.uk/privacy-policy","addinInfo":{"priority":1,"AUP":382}},{"displayName":"Microsoft Visio Data Visualizer","solutionId":"wa104381973","version":"1.0.0.4","targetType":0,"width":732,"height":448,"description":"Quickly and easily visualize your data into polished Visio diagrams within Excel.","iconUrl":"28591.0bb30ee2-d030-40d4-ba7e-3cb028cacb85.45958ca1-0858-42f7-9002-36ecaceadb38.84405685-1ffe-4d1d-9782-069079dc8d28.png","licenseUrl":"https://visio.officeapps.live.com/va/resources/licenseterms.html","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":1,"AUP":10559}},{"displayName":"XL-Connector 365","solutionId":"wa104382023","version":"2.0.0.1","targetType":1,"width":0,"height":0,"description":"Salesforce connector for Microsoft Office Online and Microsoft Office for Mac","iconUrl":"22105.87e56e91-0218-41b6-baf7-cd6d66ed7064.2132bae0-8ca0-4c27-ba4c-949cf6364791.f1ed243e-17f7-41ff-b99a-341d95cc8088.gif","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.xappex.com/docs/xl-connector-365-docs/xl-connector-365-privacy-policy","addinInfo":{"priority":3,"AUP":1674}},{"displayName":"Analytic Solver","solutionId":"wa200000018","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Analyze risk, find the best way to allocate resources using Monte Carlo Simulation and Optimization","iconUrl":"13898.dda126ef-5dd2-44ef-b6bc-a6cb0309f3a1.5b43104b-37e9-4650-8c16-71e032e6cb7d.e1dd0809-9020-4553-ba59-1479f07f4705.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683093/Asset_5ef7a7a3-cb57-4c16-8fe4-6032d115bc04/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":2,"AUP":1315}},{"displayName":"Analytic Solver Data Mining","solutionId":"wa200000019","version":"23.1.0.0","targetType":1,"width":0,"height":0,"description":"Forecast the future, train and deploy predictive models using Data/Text Mining and Machine Learning","iconUrl":"34090.1ece6668-5136-4cbf-8b60-e7747688efc8.cfabfded-2a53-4b39-9eda-001adba2da25.c6775c6d-8ebd-4525-90d6-1304a00887d8.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474836842/Product_42949683094/Asset_8b514640-453a-4c63-9e63-d0c3f2b29f37/FrontlineSystemsSoftwareLicens.pdf","privacyUrl":"https://www.solver.com/frontline-systems-privacy-policy-solver-app","addinInfo":{"priority":-1,"AUP":640}},{"displayName":"draw.io Diagrams","solutionId":"wa200000113","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Easily embed draw.io diagrams from cloud storage","iconUrl":"14142.2ec57164-ba5b-42ee-8253-ade72ca74c8d.e8efbcc8-e27f-4682-9321-eb111eb3bc68.950e1c22-0dd9-4079-807b-145ecdb6df9c.png","licenseUrl":"https://pinpointprod.blob.core.windows.net/marketing/Partner_21474849055/Product_42949683254/Asset_f99133a0-53c0-4c21-905f-757b27070c6a/drawioEULATermsofServicedrawio.pdf","privacyUrl":"https://desk.draw.io/support/solutions/articles/16000096192-privacy-policy-for-draw-io-add-in-for-microsoft-office","addinInfo":{"priority":2,"AUP":441}},{"displayName":"SAP Analytics Cloud for Office","solutionId":"wa200000169","version":"1.15.0.0","targetType":1,"width":0,"height":0,"description":"Use Microsoft Excel\u2019s strengths to get deeper insights into your SAP Analytics Cloud data.","iconUrl":"22967.ffbd93af-2e67-49da-bff8-62f9e5029e69.9930b4d4-9fd9-4eac-8578-8c77ca3d7e15.3a9c2449-9616-45b4-83e5-2f8360c19338.png","licenseUrl":"https://hcs.cloud.sap/office/eula.html","privacyUrl":"https://www.sap.com/about/legal/privacy.html","addinInfo":{"priority":3,"AUP":1112}},{"displayName":"iServer365 Import Tool","solutionId":"wa200000421","version":"2.1.4.7","targetType":1,"width":0,"height":0,"description":"Import data from Excel Workbooks to your iServer365 Repository","iconUrl":"31253.df1e5367-d9bc-46a7-8259-9b24225f294e.24914354-af15-4aa0-8ead-1c9d3e44a16d.8c184953-6f7c-4728-add7-e9aa9aa1c7a1.png","licenseUrl":"https://www.orbussoftware.com/orbus-store-app-terms","privacyUrl":"https://www.orbussoftware.com/privacy-policy","addinInfo":{"priority":3,"AUP":471}},{"displayName":"Jira Cloud for Excel","solutionId":"wa200000556","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Export Jira data to Excel - Combine the power of Jira with the flexibility of Excel","iconUrl":"56884.e2ba98e8-580f-430a-a0f6-2d54d53d7762.fb12baec-4bec-40e4-8dfc-21c060e87964.7ef37c2b-d095-4918-89f1-25637b11e385.png","licenseUrl":"https://www.microsoft.com/en-us/store/standard-application-license-terms","privacyUrl":"https://www.atlassian.com/legal/privacy-policy","addinInfo":{"priority":3,"AUP":83858}},{"displayName":"Refinitiv Add-in","solutionId":"wa200000565","version":"1.0.0.58","targetType":1,"width":0,"height":0,"description":"Build your models in Excel using Refinitiv\u2019s unique content and analytics","iconUrl":"22646.a3a6e343-b9d7-46ab-aad8-c0fc34c7b498.395fe483-7a9c-4c7f-ae27-4082290d2ccf.2a4f9940-98cd-460a-a422-d954187c3909.png","licenseUrl":"https://download.microsoft.com/download/F/D/8/FD8BA8F2-72AF-45D9-B39E-230B26CBD39D/StandardContractMarch2019.pdf","privacyUrl":"https://www.refinitiv.com/en/policies/privacy-statement","addinInfo":{"priority":-1,"AUP":356}},{"displayName":"AI-aided Formula Editor","solutionId":"wa200001584","version":"2.6.0.0","targetType":1,"width":0,"height":0,"description":"GPT-4-powered AI features like formula generation and explanation built-in a modern Formula Editor.","iconUrl":"65260.49589048-b9b0-4c4d-9166-9853dbc8d0d0.00f729b3-2b4d-4d96-a381-52c6e940cf4e.1e8d39fe-6248-4e13-b4cc-1e61e02c196d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.10studio.tech/privacy","addinInfo":{"priority":1,"AUP":679}},{"displayName":"McGraw Hill","solutionId":"wa200002270","version":"3.0.0.0","targetType":1,"width":0,"height":0,"description":"McGraw Hill tool application aimed to assist students to learn and leverage Microsoft Excel.","iconUrl":"10994.a2611ae6-e1fb-468e-9a75-4292ffd45f92.3e087ea2-0e00-40c2-9e26-d5c264f97fae.ffc523c3-0e09-439c-9422-af52e0770aff.png","licenseUrl":"https://www.mheducation.com/terms-use.html?external_browser=2","privacyUrl":"https://www.mheducation.com/privacy.html?external_browser=2","addinInfo":{"priority":3,"AUP":118855}},{"displayName":"Jasperactive for Office","solutionId":"wa200002334","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Web-based learning for Microsoft Word, Microsoft Excel and for Microsoft PowerPoint.","iconUrl":"24398.0a1bdc08-ac9f-4231-8e69-4eb02a692937.a4408ec1-bba8-4f97-961d-09257a62e38a.0013100a-0ba3-4b30-b729-14bf64da59dc.png","licenseUrl":"https://jasperactive.com/end-user-license-agreement","privacyUrl":"https://jasperactive.com/privacy-policy","addinInfo":{"priority":3,"AUP":1991}},{"displayName":"XLSTAT Cloud","solutionId":"wa200002503","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Statistics and data analysis add-in.","iconUrl":"49744.000d2e73-975d-42e3-8f0f-ca360dc2cc60.8a9d0e1f-183b-4ab0-b765-b64f7b230131.6ebabbd6-be54-4fd5-8e89-3e07680d70ba.png","licenseUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/CLUF.pdf","privacyUrl":"https://xlstat365.s3.us-east-2.amazonaws.com/legal/PRIVACY_POLICY.pdf","addinInfo":{"priority":1,"AUP":272}},{"displayName":"PitchBook for Excel","solutionId":"wa200002663","version":"1.6.0.0","targetType":1,"width":0,"height":0,"description":"Strengthen your analysis and build better financial models using PitchBook\u2019s data.","iconUrl":"50447.f729f52c-6484-4a27-9fd9-9a62d0ad734b.8b8a588c-46ce-4201-bddc-3d6086c7d7f2.3d88619d-29d6-49b5-a2ba-33bb2a724d32.png","licenseUrl":"https://pitchbook.com/terms-of-use","privacyUrl":"https://pitchbook.com/privacy-policy","addinInfo":{"priority":-1,"AUP":768}},{"displayName":"FRED Data","solutionId":"wa200003692","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"Download data from the Federal Reserve Bank of St. Louis Economic Data (FRED).","iconUrl":"51797.9b2b8182-033d-4060-9ca5-866292d44261.be4b3e57-cbb1-436a-98af-42040dca76d3.1d354664-b22f-4494-a818-f28e5304fc35.png","licenseUrl":"https://fred.stlouisfed.org/fred-addin/legal.html","privacyUrl":"https://research.stlouisfed.org/privacy.html","addinInfo":{"priority":1,"AUP":185}},{"displayName":"Advanced formula environment, a Microsoft Garage project","solutionId":"wa200003696","version":"1.1.0.0","targetType":1,"width":0,"height":0,"description":"Create, edit, and reuse formulas.","iconUrl":"42604.70ef3bb6-fd4c-4868-b560-ed816d7473dd.f2947730-eef9-434b-a86d-fa6e3bafe076.525d558d-aea8-4a78-89dd-576bcceda686.png","licenseUrl":"https://support.office.com/client/61994a3b-2c87-41c4-a88d-a6455efa362d?omkt=en-US","privacyUrl":"https://privacy.microsoft.com/en-us/privacystatement","addinInfo":{"priority":-1,"AUP":382}},{"displayName":"Spreadsheet Sync","solutionId":"wa200003784","version":"1.2.0.1","targetType":1,"width":0,"height":0,"description":"It syncs your QBO Adv data directly with Excel, enabling businesses to build customized reports ","iconUrl":"19754.85145a97-15c6-4376-9196-8515ee6dfda2.17b17ce3-53d9-4050-b1a9-cd8f6d333853.43963bbc-6904-4da7-8514-7b2e0bb7b291.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.intuit.com/privacy","addinInfo":{"priority":3,"AUP":404}},{"displayName":"ArcGIS for Excel","solutionId":"wa200004179","version":"2022.3.6.0","targetType":1,"width":0,"height":0,"description":"Discover new patterns and bring Excel data to life with maps using ArcGIS.","iconUrl":"14874.7ac80e32-4af3-4961-b3a6-2e871982b721.910edbf9-9d95-4224-a14c-7935fbbf3263.64da2c2e-9f1d-4b19-9264-dfe092cbe3eb.png","licenseUrl":"https://www.esri.com/en-us/legal/terms/master-agreement-product","privacyUrl":"https://www.esri.com/en-us/privacy/privacy-statements/privacy-statement","addinInfo":{"priority":3,"AUP":403}},{"displayName":"Cegid Expert Connector for Excel","solutionId":"wa200004571","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Application apportant des fonctions personnalis\u00e9es pour exporter des donn\u00e9es de Cegid Expert.","iconUrl":"10618.583afe98-a839-46f6-a732-dbbf9ac8ac05.b4296dcd-6aea-4fb5-9e1d-d2a88879c875.ee35bc13-726a-4c70-8c82-dd0e375097d6.png","licenseUrl":"https://www.cegid.com/fr/cgv","privacyUrl":"https://www.cegid.com/fr/privacy-policy","addinInfo":{"priority":3,"AUP":2501}},{"displayName":"QR Code Tracker","solutionId":"wa200004687","version":"1.0.0.1","targetType":1,"width":0,"height":0,"description":"QR Code Tracker lets you easily generate/scan QR codes in a sheet.","iconUrl":"35614.d62fd4d2-7872-42e1-a0c2-405317558142.c8500959-825f-4100-b3e6-c21597165a0b.f5cfa5f9-1345-4020-805c-d8345f029ae2.png","licenseUrl":"https://www.formiraex.com/QR_Code_Tracker/license.html","privacyUrl":"https://www.formiraex.com/QR_Code_Tracker/privacy-policy.html","addinInfo":{"priority":3,"AUP":120}},{"displayName":"Zebra BI Charts for Office","solutionId":"wa200004688","version":"1.0.0.0","targetType":0,"width":1000,"height":500,"description":"The most powerful charting visual in Excel & PowerPoint with a complete set of advanced charts! ","iconUrl":"9365.95df6186-f63a-4f9b-8cd5-414e80da57c8.ef9390f9-280b-4847-b1c6-c6fa272d852c.33527d56-43f3-4e84-bfe0-2bb6d2c2594d.png","licenseUrl":"https://zebrabi.com/legal/?doc=eula","privacyUrl":"https://zebrabi.com/legal/?doc=privacy-policy-visuals","addinInfo":{"priority":1,"AUP":120}},{"displayName":"Flow | Your instant translator for the enterprise","solutionId":"wa200004858","version":"2.0.0.0","targetType":1,"width":0,"height":0,"description":"Access on-brand translations with Flow all across the internet","iconUrl":"21223.73dc3f42-d93e-46d2-ac41-21e4e22f1e9d.9e6a4242-8ef5-4d96-8f3e-e8dd4eebf01b.ea39d408-2aa7-45a1-bab6-3adbaca33d44.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.lengoo.com/privacy-policy","addinInfo":{"priority":3,"AUP":18}},{"displayName":"AI Formula Generator Bot for Excel","solutionId":"wa200004935","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Transform your text instructions into Excel formulas in seconds with the help of AI.","iconUrl":"15321.02bef729-7dee-4518-80a6-f1201acff812.20f898b8-6e94-4547-b2c1-2680aff4db58.e0447c81-0b85-428e-8e98-0c3ecefac08c.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://excelformulabot.com/privacy-policy","addinInfo":{"priority":1,"AUP":286}},{"displayName":"Ghostwriter","solutionId":"wa200005107","version":"1.0.0.5","targetType":1,"width":0,"height":0,"description":"Introducing Ghostwriter OpenAI GPT-3 for Microsoft Office \u2013 the revolutionary writing assistant ","iconUrl":"8283.9a73910f-bc07-461c-a5aa-da58e2ce898e.24d0d825-2d57-4a56-9377-9087d459417f.b690bd3b-df98-4bef-bfc3-14135f3786f8.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://creativedatastudios.com/privacypolicy.html","addinInfo":{"priority":-1,"AUP":19}},{"displayName":"Sage Reporting 365","solutionId":"wa200005246","iconUrl":"40546.f88bb9d8-63aa-45c5-9857-bba65a51e0dd.6bd00930-2608-40f8-b6b9-6b9b7660abf7.8c645fcb-d1e3-4b8d-82a5-cea0150a26a3.png","targetType":1,"width":0,"height":0,"description":"Sage Reporting 365 is a Business Intelligence software providing access to your management data","version":"1.0.0.3","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://blog.infineo.online/privacy","addinInfo":{"priority":3,"AUP":165}},{"displayName":"ChatGPT for Excel","solutionId":"wa200005271","version":"1.0.0.0","targetType":1,"width":0,"height":0,"description":"Unlock the power of Excel with ChatGPT intelligence.","iconUrl":"55257.86bed75f-2814-457c-b505-403f890ae109.bd03c17e-334d-4b64-b573-33cf7a68a966.65bd7d1b-46c0-4876-a3a5-d2b84c95918d.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://chatgptforexcel.com/privacy-policy","addinInfo":{"priority":1,"AUP":1541}},{"displayName":"Numerous.ai","solutionId":"wa200005281","iconUrl":"19340.b57a7be8-416b-490a-9c58-b5567322666d.bc5fbf37-4907-473d-826c-150e0ae698aa.35f4cdd6-af50-49e7-8607-efcddc63f117.png","targetType":1,"width":0,"height":0,"description":"Use AI to generate formulas, categorize items, format cells, and perform repetitive tasks.","version":"1.0.0.0","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://numerous.ai/privacy.html","addinInfo":{"priority":1,"AUP":283}},{"displayName":"FormulAI","solutionId":"wa200005333","version":"1.0.0.2","targetType":1,"width":0,"height":0,"description":"FormulAI is a powerful Microsoft Excel formula assistant using AI.","iconUrl":"18944.a414168a-5468-4d7d-905c-6a9ff954a4a8.ad819f3c-11ba-4124-975b-22d1d3b278cc.d82fb89a-dcbe-49d9-9013-de1b3221d003.png","licenseUrl":"https://go.microsoft.com/fwlink/?linkid=2041178","privacyUrl":"https://www.formulai.xyz/privacy-policy","addinInfo":{"priority":1,"AUP":4}}]'}get Hzj(){return x.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RegisterPopulateCommandRefactorEnabled",
!1)}AHh(na){window.setTimeout(()=>{this.iSh()},na)}iSh(){this.gOc?h.ULS.sendTraceTag(508826715,220,50,"The 1st attempt succeeded."):(h.ULS.sendTraceTag(508826716,220,15,"the 1st attempt was timeout, trigger another try."),this.Sz(0,!0))}static MRa(na){return 0===na||10===na}jVa(na,S){this.sKa&&this.sKa.jVa(na,S)}Sz(na,S){this.sKa&&(!this.gOc&&hf.MRa(na)&&(this.gOc=!0),this.sKa.Sz(na,S))}YAc(na){this.sKa&&this.sKa.dra(na)}B5g(na,S){return K.a.Ei().equals(na.solutionId,S.solutionId)&&K.a.Ei().equals(na.storeType,
S.storeType)}WQd(na,S){if(x.AFrameworkApplication.da.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.Q_f(na,S,OSF.StoreTypeEnum.MarketPlace);else{const Ja={};Ja.callbackFunc=na;Ja.storeType=OSF.StoreTypeEnum.MarketPlace;Ja.fromInsertDialog=!1;Ja.refresh=S;this.jm.queryEntitlementDetails(Ja)}}Q_f(na,S,Ja){const rb={};rb.callbackFunc=na;rb.storeType=Ja;rb.fromInsertDialog=!1;rb.refresh=S;this.jm.queryEntitlementDetails(rb)}invokeDdaMethod(na,S){const Ja=this.$o(na.DdaMethod.ControlId);
Ja?Ja.invokeDdaMethod(na,S):this.Rj(Za.a.internalError,S)}registerDdaEventAsync(na,S,Ja,rb,ma){(S=this.$o(S))?hf.wGb(na)?S.vyj(na,Ja,rb,ma):this.Rj(Za.a.tNd,ma):this.Rj(Za.a.internalError,ma)}unregisterDdaEventAsync(na,S,Ja,rb,ma){(S=this.$o(S))?hf.wGb(na)?S.yik(na,Ja,rb,ma):this.Rj(Za.a.tNd,ma):this.Rj(Za.a.internalError,ma)}dispose(){if(!this.disposed){this.$.uo(this.fg);this.ea.gm(this.vf);this.ea.nO(this.ro);this.ea.Ky(this.gi);this.q5c.detach(this);this.$.userOperationManager.ur(this.aV);if(Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeleteCustomFunctionsObjectsManager",
!1)){const na=La.h(this.$);null===na||void 0===na?void 0:na.ya.Tt(this.ph)}this.oyc=this.Th=this.Kj=this.q5c=this.Pd=null;this.uNa&&(this.uNa.dispose(),this.uNa=null);gb.a.Ma(this.pXd);gb.a.Ma(this.oXd);this.x6a&&(this.x6a.dispose(),this.x6a=null);super.dispose();this.disposed=!0;h.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed")}}lod(na){return(na=this.$o(na))?na.getDefaultIconUrl():null}kFc(na){if(this.jTe!==na){this.jTe=na;for(let S=0,Ja=this.Th.length;S<Ja;S++){const rb=this.Th[S];na?
rb.QVe(!1):rb.jGh()}this.pXd.kFc(na);this.oXd.kFc(na)}}E6h(na){return(na=this.$o(na))?na.getDefaultDisplayName():null}Rj(na,S,Ja){const rb={};rb[sb.a.di]=na;rb[sb.a.L7]=S;this.zN(451041795,rb,void 0===Ja?!0:Ja)}wy(na){const S={};S[sb.a.L7]=na;this.zN(1237877382,S)}zN(na,S,Ja){Ja=void 0===Ja?!0:Ja;const rb=new Kd.a(na,0,this.$.Ie,0,null),ma=S?S[sb.a.L7]:null;this.x6a&&La.h(this.$).Kd&&sa.Wjh(na,S)?this.x6a.Ayh(na,S):(na=this.$.Ga.Sd(rb,S),Ja&&jc.TaskExtensions.Aa(na,ib=>{Qd.a(ib)?this.Rj(Za.a.internalError,
ma,!1):ib.result||(La.h(this.$).Kd?this.Rj(Za.a.FFb,ma,!1):this.Rj(Za.a.internalError,ma,!1))},this.ma,8))}vmh(na){return!!this.Wma(S=>hf.getSolutionId(S.un,this.$)===hf.getSolutionId(na,this.$)&&S.un.PrimaryMarketplace.MarketplaceType===na.PrimaryMarketplace.MarketplaceType&&S.un.PrimaryMarketplace.MarketplaceRef===na.PrimaryMarketplace.MarketplaceRef&&S.un.PrimaryMarketplace.SolutionVersion===na.PrimaryMarketplace.SolutionVersion)}$o(na){return this.Wma(S=>S.controlId.startsWith(na))}GVh(na){return this.Wma(S=>
S.Pxa===na)}y5e(na){return this.Wma(S=>S.QP===na&&!!S.Pxa)}O5e(na,S,Ja,rb){return this.Wma(ma=>ma.QP===na&&ma.un.PrimaryMarketplace.MarketplaceRef.toLowerCase()===S.toLowerCase()&&ma.un.PrimaryMarketplace.MarketplaceType.toLowerCase()===Ja.toLowerCase()&&!!ma.un.SharedRuntime&&!!ma.un.SharedRuntime.Resid&&!!rb&&!!rb.Resid&&ma.un.SharedRuntime.Resid.toLowerCase()===rb.Resid.toLowerCase())}o6g(na,S){if(na=this.$o(na))na.la(S),na.showHide(!0)}e3j(na){(na=this.$o(na))&&na.showHide(!1)}DMa(na){var S;if(1!==
na.WebExtensionType||this.$.hg&8388608&&na.TaskpaneVisible||this.$.hg&8388608&&!na.TaskpaneVisible&&te.HelperMethods.yz(na)){let Ja=null;te.HelperMethods.yz(na)&&(Ja=hf.fza(na,this.$),na.TaskpaneWidth||(na.TaskpaneWidth=this.Iyb));const rb=(new ee(this,this.Kj,na)).Yvd();h.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(na.PrimaryMarketplace.SolutionId,na.OwnerAddinStoreType||na.PrimaryMarketplace.MarketplaceType,null===(S=na.AssetMarketplace)||
void 0===S?void 0:S.SolutionId,null,null,na.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${na.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${te.HelperMethods.yz(na)}`);Ja&&(rb.Pxa=Ja);this.Th.push(rb);this.yBa=null;this.nab(na.InstanceId)||(na=String.format("{0}|{1}|{2}|{3}|{4}",na.PrimaryMarketplace.SolutionId,na.PrimaryMarketplace.SolutionVersion,na.PrimaryMarketplace.MarketplaceRef,na.PrimaryMarketplace.MarketplaceType,na.WebExtensionType),this.raiseEvent("ci",na))}}T4j(na,S){na.TaskpaneWidth=
this.Iyb;na.TaskpaneVisible=!0;const Ja={};Ja.SolutionId=na.PrimaryMarketplace.SolutionId;Ja.TargetType=na.WebExtensionType;Ja.Version=na.PrimaryMarketplace.SolutionVersion;Ja.StoreType=na.PrimaryMarketplace.MarketplaceType;Ja.StoreId=na.PrimaryMarketplace.MarketplaceRef;na.AssetMarketplace?(Ja.AssetId=na.AssetMarketplace.SolutionId,Ja.AssetStoreId=na.AssetMarketplace.MarketplaceRef):(Ja.AssetId=null,Ja.AssetStoreId=null);Ja.Width=na.TaskpaneWidth;const rb=new ee(this,this.Kj,na,!0);rb.Yvd();this.Th.push(rb);
const ma=()=>{this.wVa(rb.controlId);this.Qh.purgeOsfControl(rb.controlId,!1);S()};let ib=null;ib=Zc.a.instance.SF(()=>{rb.CB&&(gb.a.Ma(ib),ib=null,this.Qh.insertBlankControlWithErrorUX(this.pOb(rb,Ja),ma))},100,dd.a.kxh)}Tcd(na){if(na&&na.length){var S=[];na.forEach(Ja=>{if(Ja.ContainsCustomFunctions){const rb=hf.fza(Ja,this.$);this.pOd.contains(rb)||(this.pOd.add(rb),this.kXf.push(Ja));this.vmh(Ja)||S.push(Ja)}});S.length&&this.eQe(S)}}mSe(na,S){this.$o(na.InstanceId)||(S=S(),na=(new ee(this,this.Kj,
na)).Unf(S),this.Th.push(na),this.yBa=null)}y2j(na){hf.p6a.Hd(na)&&hf.p6a.ka(na).initializeAndShowWithTitle()}wsi(na){hf.p6a.Hd(na)&&hf.p6a.ka(na).hide()}hdi(na){var S=null;let Ja,rb,ma=null;Ja=hf.rsd(na,!0);if(!Ja)return h.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Ra.Task.Ua(null);(rb=this.jm.getOsfControl(hf.getSolutionId(Ja,this.$)))&&(S=rb.getManifest())&&(ma=S.getSharedRuntimeForCustomFunctions("Workbook"));if(S=ma&&1===ma.LifeTime?
this.O5e(Ja.PrimaryMarketplace.SolutionId,Ja.PrimaryMarketplace.MarketplaceRef,Ja.PrimaryMarketplace.MarketplaceType,ma):this.GVh(na))return Ra.Task.Ua(S.controlId);const ib=new qb.a;te.HelperMethods.Arc(ma)&&(Ja.SharedRuntime=ma);na=rb?rb.getNotificationParams():[];if(!na.length)return this.KQe(Ja);this.njg(na,()=>{jc.TaskExtensions.Aa(ib.task,()=>{this.KQe(Ja)},this.ma,3)},()=>{});return ib.task}x1h(na){na=hf.rsd(na,!1);if(!na)return h.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),
null;let S=null;var Ja=this.jm.getOsfControl(hf.getSolutionId(na,this.$));Ja&&(Ja=Ja.getManifest())&&(S=Ja.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return te.HelperMethods.Arc(S)&&(na=this.O5e(na.PrimaryMarketplace.SolutionId,na.PrimaryMarketplace.MarketplaceRef,na.PrimaryMarketplace.MarketplaceType,S))?na.controlId:null}Poh(na,S){var Ja=hf.rsd(na,!1);if(Ja){var rb=null,ma=this.jm.getOsfControl(hf.getSolutionId(Ja,this.$));ma&&(ma=ma.getManifest())&&(rb=ma.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
if(te.HelperMethods.Arc(rb)){Ja.SharedRuntime=rb;var ib=Ja.PrimaryMarketplace.SolutionId;ma=Ja.PrimaryMarketplace.SolutionVersion;var Qb=OSF.OsfManifestManager.getCachedManifest(ib,ma);if(Qb)if(this.X6b.Hd(na))rb=this.X6b.ka(na),jc.TaskExtensions.Aa(rb,ke=>{(ke=ke.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ke,S,this.Kj.aSb)},this.ma,3);else{var Fc={};Fc.solutionId=ib;Fc.version=ma;Fc.storeType=Ja.PrimaryMarketplace.MarketplaceType;Fc.storeId=Ja.PrimaryMarketplace.MarketplaceRef;
Ja.AssetMarketplace?(Fc.assetId=Ja.AssetMarketplace.SolutionId,Fc.assetStoreId=Ja.AssetMarketplace.MarketplaceRef):(Fc.assetId=null,Fc.assetStoreId=null);Fc.targetType=OSF.OsfControlTarget.TaskPane;var jd=new qb.a;Ja=jc.TaskExtensions.Wl();Ja=new Ib.a(this.$,this,Fc,Ja);rb=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(ib,rb.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Qb,rb,ma);Ja.createUILessSandbox(Fc,Qb,(ke,ne)=>{ke&&!ne?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(ke,
S,this.Kj.aSb),jd.setResult(ke)):jd.setResult(null);this.X6b.remove(na)});this.X6b.fa(na,jd.task)}}}else h.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}UKe(na){(na=this.y5e(na))&&(na.un.SharedRuntime||this.OPb(na.controlId))}OPb(na){(na=this.y5e(na))&&this.wVa(na.controlId)}HCh(na,S){if(!this.Th||!na||!S)return!1;if(na.toLowerCase()===S.toLowerCase())return!0;let Ja=null,rb=null;for(let ma=0,ib=this.Th.length;ma<ib;ma++){const Qb=this.Th[ma];
if(Qb.ownerAddinSolutionId&&(Qb.controlId===na&&(Ja=Qb.ownerAddinSolutionId.toLowerCase()),Qb.controlId===S&&(rb=Qb.ownerAddinSolutionId.toLowerCase()),Ja&&rb))break}return Ja&&Ja===rb?!0:!1}RWg(na){this.$o(na.InstanceId)||(na=new ee(this,this.Kj,na),this.Th.push(na),this.yBa=null)}a5f(na){if(this.Th&&0<=na&&na<this.Th.length){const S=this.Th[na],Ja=S.CB;this.Th.splice(na,1);this.oMf(S);Yd.DOMElementExtensions.xi(Ja)}}wVa(na){if(this.Th)for(let S=0,Ja=this.Th.length;S<Ja;S++)if(this.Th[S].controlId===
na){this.a5f(S);break}}LBj(na){if(this.Th){na=na.toLowerCase();for(let S=0,Ja=this.Th.length;S<Ja;S++)if(na===this.Th[S].ownerAddinSolutionId.toLowerCase()){this.a5f(S);break}}}V6g(na){na.jl&&(this.$o(na.floatingObject.un.InstanceId)||(this.Xnc(na.floatingObject.un.InstanceId)||this.oyc.push(na.floatingObject.un.InstanceId),this.DMa(na.floatingObject.un)),this.ea.isNamedObjectViewMode&&this.o6g(na.floatingObject.un.InstanceId,na.ig))}J5e(na){return null==this.Th?null:this.Th.find(S=>1===S.controlType&&
vc.a.equals(S.QP,na,!0))}pea(na){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7645729_ConsolidateFindOsfControlFromSolutionId"))return na=this.J5e(na),null===na||void 0===na?void 0:na.controlId;if(this.Th)for(let S=0,Ja=this.Th.length;S<Ja;S++)if(1===this.Th[S].controlType&&vc.a.equals(this.Th[S].QP,na,!0))return this.Th[S].controlId;return null}zMi(na){return(na=this.J5e(na))?na.visible:!1}hVh(na){const S=[];if(this.Th)for(let Ja=0,rb=this.Th.length;Ja<rb;Ja++)vc.a.equals(this.Th[Ja].QP,na,!0)&&
S.push(this.Th[Ja].controlId);return S}NVh(na,S){if(!S||!na)return null;if(this.Th)for(let Ja=0,rb=this.Th.length;Ja<rb;Ja++)if(1===this.Th[Ja].controlType&&vc.a.equals(this.Th[Ja].QP,na,!0)&&this.Th[Ja].un.SharedRuntime&&vc.a.equals(this.Th[Ja].un.SharedRuntime.Resid,S.Resid,!0))return this.Th[Ja].controlId;return null}yOa(na,S){S=void 0===S?null:S;return na?S?`${na}.${S}`:na:""}XKe(na,S,Ja){if(this.yBa===na)return!0;this.yBa=na;let rb=null,ma=!1;if(!rb&&this.Th)for(let ib=0,Qb=this.Th.length;ib<
Qb;ib++)if(1===this.Th[ib].controlType&&vc.a.equals(this.Th[ib].QP,na,!0)){let Fc=!1,jd=!1;S?(Fc=!0,jd=!!this.Th[ib].un.SharedRuntime&&vc.a.equals(this.Th[ib].un.SharedRuntime.Resid,S.Resid,!0)):Ja&&(Fc=!0,jd=vc.a.equals(this.Th[ib].un.SharedRuntimeId,Ja,!0));if(!Fc||jd){jd&&this.Th[ib].cA(!0);rb=this.Th[ib].controlId;ma=!0;this.yBa=null;break}}rb&&this.raiseEvent("ca",rb);return ma}setAppRuntimeState(na,S){var Ja;if(na){const rb=this.$o(na);if(rb&&te.HelperMethods.yz(rb.un))rb.cA(S),S&&(this.raiseEvent("ca",
na),(null===(Ja=rb.CB)||void 0===Ja?0:Ja.firstChild)&&(na=rb.CB.firstChild.title)&&0<na.length&&this.J3a.QPj(na));else throw h.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Nc.a.instance.ha(2250));}else throw h.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Nc.a.instance.ha(2251));}getAppRuntimeState(na){if(na)if((na=this.$o(na))&&te.HelperMethods.yz(na.un))na=na.un.TaskpaneVisible;else throw h.ULS.sendTraceTag(537170563,
0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Nc.a.instance.ha(2250));else throw h.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Nc.a.instance.ha(2251));return na}d8a(na,S){return(na=this.$o(na))?na.d8a(S):null}nab(na){return this.ZKe(this.oyc,na)}Xnc(na){return this.ZKe(this.dTe,na)}rye(na){this.dTe.push(na)}iY(na){return(na=this.$o(na))?na.un:null}tJd(na){this.raiseEvent("ekros",na,this)}OUf(na){if(na){var S=
this.$o(na.InstanceId);S&&(na.SharedRuntime||na.SharedRuntimeId||(this.wVa(S.controlId),this.Qh.purgeOsfControl(S.controlId,!1)),S={},S.SolutionId=na.PrimaryMarketplace.SolutionId,S.TargetType=na.WebExtensionType,S.Version=na.PrimaryMarketplace.SolutionVersion,S.StoreType=na.PrimaryMarketplace.MarketplaceType,S.StoreId=na.PrimaryMarketplace.MarketplaceRef,na.AssetMarketplace?(S.AssetId=na.AssetMarketplace.SolutionId,S.AssetStoreId=na.AssetMarketplace.MarketplaceRef):(S.AssetId=null,S.AssetStoreId=
null),S.Width=na.TaskpaneWidth,S.SharedRuntimeId=na.SharedRuntimeId,this.urg(S))}}Gma(){this.Kj.Gma()}cG(na,S,Ja){this.Kj.cG(na,S,Ja)}V5e(na,S){S=hf.buh(S);na=this.iY(na);this.Kj.ihc(na.InstanceId,2202,yc.a.tO,S)}Zkd(na){for(let S=0,Ja=this.Th.length;S<Ja;S++)this.V5e(this.Th[S].controlId,na)}aWh(na,S){S=hf.vph(S);this.Kj.ihc(na,65539,"",S)}eWh(na,S,Ja){this.Kj.ihc(na,1,S,Ja)}$Vh(na,S){this.Kj.fWh(na,S)}Loh(na,S){return[[2,1E3,"",JSON.stringify([na,S]),0,!1]]}zCi(){return!!this.yra&&this.yra.ikf()}xhh(){this.yra&&
this.yra.clear()}bWh(){if(this.yra&&this.yra.ikf()){var na=this.yra.A1h();for(const S of na){na=this.hVh(S);for(const Ja of na)this.Kj.ihc(Ja,65540,"","{}")}}}oyj(na){this.yra.add(na)}vik(na){this.yra.remove(na)}Wma(na){if(!this.Th)return null;for(const S of this.Th)if(na(S))return S;return null}KQe(na){const S=new qb.a,Ja=hf.fza(na,this.$);if(te.HelperMethods.yz(na))h.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.hXf(na,rb=>{rb?(na.InstanceId=rb.InstanceId,
na.WebExtensionOsfControlType=3,na.TaskpaneVisible=!1,this.DMa(na),S.setResult(na.InstanceId)):(h.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(na.PrimaryMarketplace.SolutionId,na.PrimaryMarketplace.MarketplaceType,null,null,null,na.PrimaryMarketplace.MarketplaceRef)} failed`),S.setException(Error.create("Null insert data")))});else{hf.p6a.fa(na.InstanceId,new Sb.a);const rb=hf.p6a.ka(na.InstanceId).Vda;this.sqh(na,rb,Ja);this.hXf(na,
null);S.setResult(na.InstanceId)}return S.task}sqh(na,S,Ja){this.$o(na.InstanceId)||(na=new ee(this,this.Kj,na),na.Pxa=Ja,na.Unf(S),this.Th.push(na),this.yBa=null)}hXf(na,S){const Ja=hf.fza(na,this.$);if(!this.pOd.contains(Ja))this.UNb.push(na),1<=this.UNb.length&&this.iXf(na,S);else if(S)for(const rb of this.kXf)if(hf.fza(rb,this.$)===Ja){S(rb,0);break}}iXf(na,S){let Ja=null;const rb={};rb.SolutionId=hf.getSolutionId(na,this.$);rb.TargetType=na.WebExtensionType;rb.Version=na.PrimaryMarketplace.SolutionVersion;
rb.StoreType=na.PrimaryMarketplace.MarketplaceType;rb.StoreId=na.PrimaryMarketplace.MarketplaceRef;na.AssetMarketplace?(rb.AssetId=na.AssetMarketplace.SolutionId,rb.AssetStoreId=na.AssetMarketplace.MarketplaceRef):(rb.AssetId=null,rb.AssetStoreId=null);rb.Width=na.TaskpaneWidth;rb.ContainsCustomFunctions=!0;te.HelperMethods.yz(na)&&(rb.SharedRuntimeId=na.SharedRuntime.Resid);const ma=this.$.qa.ua;na=this.$.qa.ua.ze();const ib=ma.Pa(9,na);ib.sharedInfo=rb;const Qb=jd=>{jd=lc.a.kh(jd.data);h.ULS.sendTraceTag(537170528,
0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${wb.a.Me(jd)}`)},Fc=jd=>{jd&&!Rb.a(jd)||h.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(rb.SolutionId,rb.StoreType,rb.AssetId,null,null,rb.StoreId)} finish with errors: ${wb.a.Me(jd.Errors)}`);this.UNb.shift();0<this.UNb.length&&this.iXf(this.UNb[0],S)};if(S){const jd=ke=>{const ne=ke.Result;(Ja=ne?ne.AgaveData:null)||
S(null,ke.Errors?ke.Errors[0].ErrorCause:5001);S(Ja,0)};na=(ke,ne,Te)=>be.g(ma,"InsertAgaveTaskpane",ib,id.b(ke,Fc,jd),id.a(ne,Qb),Te,null,0)}else na=(jd,ke,ne)=>be.g(ma,"InsertAgaveTaskpane",ib,id.b(jd,Fc),id.a(ke,Qb),ne,null,0);Tc.a(this.$.userOperationManager,na,jd=>new Dc.a(519,0,jd,64),null)}g_j(){return this.$.Kg.get(35)}QBj(na){na=this.$o(na);(null===na||void 0===na?0:na.zha)&&na.k5f()}t2i(na){var S=this.Wma(Ja=>hf.OQa(Ja.QP));S&&(S=this.Qh.getOsfControl(S.controlId))&&S.notifyAgave(OSF.AgaveHostAction.SendMessage,
na)}uDi(){return!!this.Wma(na=>1===na.controlType&&hf.OQa(na.QP))}tDi(){const na=this.Wma(S=>hf.OQa(S.QP));return na?na.CB?Yd.DOMElementExtensions.isVisible(na.CB):!1:!1}nTj(){const na=this.Wma(S=>hf.OQa(S.QP));na&&(na.cA(!0),this.raiseEvent("ca",na.controlId))}initialize(na){var {DdaEventDispatch:S}=a(1295);const Ja=void 0===this.$||null===this.$||Y.EwaSettings.Fa(234);void 0!==this.$&&null!==this.$||h.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Ja&&h.ULS.sendTraceTag(537170524,
0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(ef.YKa(this.$),this.ea=this.$.ea,this.Kj=new S(this.$),this.$.zn(this.fg),this.ea.Yl(this.vf),this.ea.dK(this.ro),this.ea.kx(this.gi),this.$.userOperationManager.xt(this.aV),Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeleteCustomFunctionsObjectsManager",!1)&&(S=La.h(this.$),null===S||void 0===S?void 0:S.ya.Zu(this.ph)),this.AAf(),this.xcj(),this.kxi(),this.$.ia.Va(35,this),this.q5c.la(this),
Ja&&h.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.hse=new yc.a,Ja&&h.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.kse=new Rd(this.$,this.Ij,this.Kj),new Tb(this.$,this.Ij,this.Kj),this.ise=new vb(this.$,this.Ij,this.Kj),this.gse=new cd(this.$,this.Ij,this.Kj),this.fse=new tc(this.$,this.Ij,this.Kj),this.jse=new Cd(this.$,this.Ij,this.Kj),this.lse=new Yc(this.$,this.Ij,this.Kj),this.mse=new Ob(this.$,this.Ij,
this.Kj),this.$.QY&&(this.nse=new Nd(this.$,this.Ij,this.Kj)),this.ose=new Oc(this.$,this.Ij,this.Kj,na),this.x6a=new sa(this,La.h(this.$)),Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.ese=new Ad),this.dse=new of(this.$,this.Ij,this.Kj),this.initialized=!0,h.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}VVh(na){if(!this.CGa)return null;for(let S=0,Ja=this.CGa.length;S<Ja;S++)if(na.startsWith(this.CGa[S].WebExtensionId))return this.CGa[S];
return null}AAf(){var na,S=this.ea;if(S.Ee&&!this.IXb){if(S.workbookContext){if(this.U1c=this.$.ea.Qj.get(22),null===(na=S.workbookContext.WebExtensions)||void 0===na?0:na.length){na=S.workbookContext.WebExtensions;S=!1;for(let Ja=na.length-1;0<=Ja;Ja--){if(!this.ea.isNamedObjectViewMode){this.oyc.push(na[Ja].InstanceId);if(1!==na[Ja].WebExtensionType){na.splice(Ja,1);continue}if(te.HelperMethods.yz(na[Ja])&&0!==na[Ja].SharedRuntime.State)1===na[Ja].SharedRuntime.State?na[Ja].TaskpaneVisible=!1:2===
na[Ja].SharedRuntime.State?na[Ja].TaskpaneVisible=!0:h.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!na[Ja].ContainsCustomFunctions&&!na[Ja].TaskpaneVisible&&!$c.a(na[Ja])){na.splice(Ja,1);continue}}const rb=OSF.OsfControl.isFirstPartyStoreString(na[Ja].PrimaryMarketplace.MarketplaceType);if(Y.EwaSettings.Fa(174)&&!rb&&(na.splice(Ja,1),!S)){S=!0;const ma=Object(pc.d)(nd.a.resolve(qd.p,{Oa:3}));jc.TaskExtensions.Aa(ma,()=>{ma.result.ej(36,null)},this.ma,3)}Y.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&
na[Ja].PrimaryMarketplace&&hf.OQa(na[Ja].PrimaryMarketplace.SolutionId)&&(h.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),na.splice(Ja,1))}this.eQe(na)}}else this.U1c=!1;this.IXb=!0}}Hif(na){const S=La.h(this.$),Ja=S.ga.Ta.Fe;if(Ja&&na){na=!1;if(this.Th)for(const rb of this.Th)if(hf.OQa(rb.QP)||hf.cHi(rb.QP)||hf.CIi(rb.QP)){na=!0;break}na||S.ga.Ta.wK(Ja)}}xcj(){this.Qh&&this.ea.isNamedObjectViewMode&&this.$.pa&&Ke.o(this.$.pa)&&(this.$.ia.Ja(34).tU?
this.$.ia.Ja(34).iwd():this.$.ia.Ja(34).$u(this.qij))}eQe(na){let S=null;S=Ja=>{const rb=Ja.WebExtensionData,ma=Ja.IsTaskPane,ib=Ja.RecordHandler,Qb=()=>{this.lUa.shift();0<this.lUa.length&&S(this.lUa[0])};if(this.pea(rb.PrimaryMarketplace.SolutionId))Qb();else{ma&&(rb.WebExtensionOsfControlType=1);var Fc=$c.a(rb);if(!ma||rb.TaskpaneVisible||Fc||rb.SharedRuntime&&0!==rb.SharedRuntime.State||rb.ContainsCustomFunctions){var jd=new ee(this,this.Kj,rb,!ma);h.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(rb.PrimaryMarketplace.SolutionId,
rb.PrimaryMarketplace.MarketplaceType,null,null,null,rb.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${rb.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${te.HelperMethods.yz(rb)}`);jd.Yvd();te.HelperMethods.yz(rb)&&(jd.Pxa=hf.fza(rb,this.$),rb.TaskpaneWidth=this.Iyb);Fc&&(rb.WebExtensionToolTip="");!Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")&&ma&&rb.TaskpaneVisible&&!Fc&&(rb.TaskpaneWidth=this.Iyb);this.Th.push(jd);var ke=this.yBa=null;ke=Zc.a.instance.SF(()=>
{jd.CB&&(gb.a.Ma(ke),ke=null,ib&&ib(Ja,jd),Qb())},100,dd.a.jxh)}else Qb()}};for(let Ja=0;Ja<na.length;Ja++){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:7610902_EnforceDefaultTaskpaneWidth")){const rb=na[Ja].WebExtensionType===OSF.OsfControlTarget.TaskPane,ma=$c.a(na[Ja]);rb&&!ma&&(na[Ja].TaskpaneWidth=this.Iyb)}if(!this.$o(na[Ja].InstanceId))if(1!==na[Ja].WebExtensionType)this.DMa(na[Ja]);else if(!Y.EwaSettings.Fa(52))this.Csb(na[Ja],S);else if(this.$.hg&8388608||na[Ja].TaskpaneVisible){const rb=
{};rb.solutionId=na[Ja].PrimaryMarketplace.SolutionId;rb.version=na[Ja].PrimaryMarketplace.SolutionVersion;rb.storeType=na[Ja].PrimaryMarketplace.MarketplaceType;rb.storeId=na[Ja].PrimaryMarketplace.MarketplaceRef;rb.targetData=na[Ja];this.Qh.isAddinCommandsAsync(rb,(ma,ib,Qb)=>{if(ma){var Fc=Qb.targetData;if(ib)if(rb.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())ma=rb.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),ib=rb.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),
(ma||ib)&&te.HelperMethods.yz(Fc)&&this.Csb(Fc,S);else if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.Xoi(Qb,S);else{let jd=!1;this.WQd(ke=>{if(!ke.errorCode){if(ke.value)for(const ne of ke.value){if(jd)break;jd=ta.e(ne[1])===ta.e(Fc.PrimaryMarketplace.SolutionId)}jd?te.HelperMethods.yz(Fc)&&this.Csb(Fc,S):(ke={},ke.SolutionId=Qb.solutionId,ke.Version=Qb.version,ke.StoreType=Fc.PrimaryMarketplace.MarketplaceType,ke.StoreId=Qb.storeId,ke.AssetId=
null,ke.AssetStoreId=null,ke.Width=Fc.TaskpaneWidth,ke.TargetType=Fc.WebExtensionType,Fc.TaskpaneVisible=!0,this.$we(ke,Fc,S))}},!0)}else this.Csb(Fc,S)}else ma=Qb.targetData,h.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ma.PrimaryMarketplace.SolutionId,ma.PrimaryMarketplace.MarketplaceType,null,null,null,ma.PrimaryMarketplace.MarketplaceRef)} from ${ma.PrimaryMarketplace.MarketplaceType} during document loading`)})}}}Xoi(na,S){let Ja=
!1;this.WQd(rb=>{const ma=na.targetData;if(!rb.errorCode){if(rb.value)for(const ib of rb.value){if(Ja)break;Ja=ta.e(ib[1])===ta.e(ma.PrimaryMarketplace.SolutionId)}Ja?te.HelperMethods.yz(ma)&&this.Csb(ma,S):(rb={},rb.SolutionId=na.solutionId,rb.Version=na.version,rb.StoreType=ma.PrimaryMarketplace.MarketplaceType,rb.StoreId=na.storeId,rb.AssetId=null,rb.AssetStoreId=null,rb.TargetType=ma.WebExtensionType,rb.Width=ma.TaskpaneWidth,ma.TaskpaneVisible=!0,this.$we(rb,ma,S))}},!0)}Csb(na,S){const Ja={};
Ja.WebExtensionData=na;Ja.IsTaskPane=!0;this.lUa.push(Ja);1===this.lUa.length&&S(Ja)}$we(na,S,Ja){const rb={};rb.ActivationInfo=na;rb.WebExtensionData=S;rb.IsTaskPane=!1;rb.RecordHandler=(ma,ib)=>{const Qb=ma.ActivationInfo;this.Qh.insertBlankControlWithErrorUX(this.pOb(ib,Qb),()=>{this.wVa(ib.controlId);this.Qh.purgeOsfControl(ib.controlId,!1);this.urg(Qb)})};this.lUa.push(rb);1===this.lUa.length&&Ja(rb)}urg(na){var S={};S.solutionId=na.SolutionId;S.version=na.Version;S.storeType=na.StoreType;S.storeId=
na.StoreId;S.assetId=na.AssetId;S.assetStoreId=na.AssetStoreId;S.targetType=na.TargetType;S.sharedRuntimeId=na.SharedRuntimeId;na=new ca.a;na.add(S);S={};S[Z.a.Dtb]=na;S[Z.a.aX]=3;na=new Kd.a(Ge.a.jJb,0,this.$.Ie,0,null);this.$.Ga.Sd(na,S)}pOb(na,S){const Ja={};Ja.div=na.CB;Ja.id=na.controlId;Ja.solutionId=S.SolutionId;Ja.version=S.Version;Ja.storeId=S.StoreId;Ja.storeType=S.StoreType;Ja.osfControlType=OSF.OsfControlTarget.TaskPane;return Ja}e9f(){if(Y.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const Ja=
[];for(var na=0;na<this.Th.length;na++){var S=this.Th[na];0!==S.osfControlType&&3!==S.osfControlType&&4!==S.osfControlType||Ja.push(S)}na=!1;for(S=0;S<Ja.length;S++){const rb=Ja[S];this.wVa(rb.controlId);!na&&rb&&rb.un&&(na=te.HelperMethods.yz(rb.un))}na&&this.zN(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}Y.EwaSettings.Fa(355)&&jc.TaskExtensions.Aa(Wc.GetServiceTaskFactory.je(this.$.ia,278,279,3),Ja=>{Ja&&(Ja=Ja.result)&&(this.$.ia.Ja(278)||this.$.ia.Va(278,Ja),Ja.apf().Cra())},this.ma,
3)}rO(){var na=new re(this.$,this.Ij,this.s$f);void 0===this.$||null===this.$?h.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):Y.EwaSettings.Fa(234)&&h.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.Ij||null===this.Ij));if(na.f1i()){const S=()=>{},Ja=ma=>{ma=lc.a.kh(ma.data);h.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${wb.a.Me(ma)}.`)},
rb=na.Pah();na=hf.pqd(rb);na|=64;this.$.userOperationManager.YH(new Dc.a(507,0,(ma,ib,Qb)=>be.g(this.$.qa.ua,"ExecuteRichApiRequest",this.Rah(rb),id.b(ma,S),id.a(ib,Ja),Qb,null,0),na))}}Rah(na){const S=this.$.qa.ua.Pa(1);S.request=na;return S}ZKe(na,S){if(na)for(let Ja=0;Ja<na.length;Ja++)if(vc.a.equals(na[Ja],S,!0))return!0;return!1}Q$g(na){const S={};S.navigationMode=OSF.OsfNavigationMode.DefaultMode;S.assetId=null;S.category=null;if(!na||3>na.length)return S;if(na[0]){const Ja=parseInt(na[0],10);
isNaN(parseInt(Ja,10))||(S.navigationMode=Ja)}na[1]&&(S.assetId=na[1]);na[2]&&(S.category=na[2]);return S}kxi(){var na=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(na&&"*"!==na.trim()){this.uNa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new pb(this),na,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Kg.get(2));try{this.uNa.init()}catch(S){try{this.uNa.dispose()}catch(Ja){}this.uNa=null;h.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+
S.message)}na={};na.a=this.$.xa.UserSessionId;me.b().Ih(39,na)}}njg(na,S,Ja){const rb=hf.b$g(na[0]),ma=rb.vla,ib=rb.rma;rb.vla=()=>{ma&&ma();const Qb=rb.rQa!==OSF.InfoType.Error?S:null;na.shift();na.length?this.njg(na,Qb,Ja):Qb&&Qb()};rb.rma=()=>{ib&&ib();Ja&&rb.rQa!==OSF.InfoType.Error&&Ja()};Ba.a.d2d(rb)}s$h(){const na={};na.AddinRibbonControlsOverriddenByApi=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();na.AddinActionDefinitionHybridMode=Y.EwaSettings.Fa(556).toString();
na.UseActionIdForUILessCommand=Y.EwaSettings.Fa(559).toString();na.AllowStorageAccessByUserActivationOnIFrame=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();na.RequirementSetRibbonApiOnePointTwo=Y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();na.flightingTreatmentVariables=x.AFrameworkApplication.da.qhc;na.ShortcutInfoArrayInUserPreferenceData=Y.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();
na.DisabledChangeGates=x.AFrameworkApplication.da.Ra("DisabledChangeGates");na.DmsSdxListWorkbook=x.AFrameworkApplication.KWe;return na}static get hbc(){return hf.rfe}static set hbc(na){hf.rfe=na}static getSolutionId(na){let S=na.PrimaryMarketplace.SolutionId;Y.EwaSettings.Fa(261)&&na.OwnerAddinSolutionId&&(S=na.OwnerAddinSolutionId);return S}static pqd(na){return na.RequestFlags&1&&256!==(na.RequestFlags&256)?0:16}static fza(na,S){S=hf.getSolutionId(na,S);return hf.maf(S,na.PrimaryMarketplace.SolutionVersion,
na.PrimaryMarketplace.MarketplaceType,na.PrimaryMarketplace.MarketplaceRef)}static buh(na){return JSON.stringify({["recording"]:na})}static vph(na){const S={};S.visibility=na?"Visible":"Hidden";return JSON.stringify(S)}static g6h(na){let S=na.getSolutionId(),Ja=na.getVersion(),rb=na.getStoreType();na=na.getStoreId();return hf.maf(S,Ja,rb,na)}static maf(na,S,Ja,rb){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",na,S,hf.sii(Ja).toString(),rb)}static rsd(na,S){var Ja=na.split("|");if(7>Ja.length)return h.ULS.sendTraceTag(537170509,
0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Ja[0])return h.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${Ja[0]}'.`),null;let rb=Ja[1];const ma=Ja[2],ib=hf.tii(Ja[3]),Qb=Ja[4];Ja=Ja[5];rb&&rb.length||(rb=Ja);Ja={};Ja.InstanceId=String.format("{{{0}}}",N.a.create().toString());Ja.WebExtensionOsfControlType=4;Ja.WebExtensionType=1;Ja.PrimaryMarketplace={};Ja.PrimaryMarketplace.SolutionId=
rb;Ja.PrimaryMarketplace.SolutionVersion=ma;Ja.PrimaryMarketplace.MarketplaceRef=Qb;Ja.PrimaryMarketplace.MarketplaceType=ib;Ja.ContainsCustomFunctions=S?!0:!1;S&&(Ja.OsfPropertyBag=[["customFunctionAddinId",na]]);return Ja}static tii(na){na=parseInt(na,10);return na===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:na===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:na===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:na===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:na===OSF.StoreTypeEnum.FileSystem?
OSF.StoreType.FileSystem:na===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:na===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:na===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:na===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:na===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:na===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static sii(na){return na===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:
na===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:na===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:na===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:na===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:na===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:na===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:na===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:na===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:na===OSF.StoreType.UploadFileDevCatalog?
OSF.StoreTypeEnum.UploadFileDevCatalog:na===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}xxa(na){const S={};S.Version=na.version;S.AssetId=na.assetId;S.AssetStoreId=na.assetStoreId;S.StoreType=na.storeType;S.Height=na.height;S.SolutionId=na.solutionId;S.StoreId=na.storeId;S.TargetType=na.targetType;S.Width=1===S.TargetType?0:na.width;S.SharedRuntimeId=na.sharedRuntimeId;return S}static wGb(na){return na===OSF.DDA.EventDispId.dispidSettingsChangedEvent||na===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||
na===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||na===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||na===OSF.DDA.EventDispId.dispidRichApiMessageEvent||na===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||na===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||na===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static b$g(na){return Object(c.a)(new Ee.a,{rQa:na.infoType,id:na.id,title:na.title,description:na.description,buttonText:na.buttonTxt,vla:na.buttonCallback,
umc:na.highPriority,rma:na.dismissCallback,errorCode:na.errorCode,fnf:na.iframeNotificationUrl})}static OQa(na){let S="FA000000014"===na;S||(S="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===na);return S}static cHi(na){return"FA000000005"===na}static CIi(na){return"FA000000064"===na}}hf.p6a=new U.a;hf.rfe=!0;Object(b.a)(hf,"DdaFacade",ab.a,[170,801,686,802,803,5])},806:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);class b{constructor(c,h,f,e){this.ddaBinding=null;this.dispid=0;this.ArrayData=
this.controlId=null;this.dispid=c;this.controlId=h;this.ddaBinding=f;this.ArrayData=void 0===e?null:e}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(w.a)(b,"DdaEventArgs",null,[])},859:function(w,B,a){w=a(0);class b{constructor(){this.title=this.id=this.tabs=null}}Object(w.a)(b,"AddInDataTransferObject",null,[]);a.d(B,"a",function(){return c});class c{constructor(h,f,e){this.gYb=h;this.UEg=f;this.VEg=e}get lw(){return this.gYb}get mWg(){return this.UEg}get nWg(){return this.VEg}static CBb(h){return(h=
h.uZ)?Object.assign(new b,{tabs:h.lw.toArray(),id:h.mWg,title:h.nWg}):null}}Object(w.a)(c,"OneLineRibbonExtensibility",null,[])},863:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);var b;(function(c){c[c.o0i=0]="myAddins";c[c.v2g=1]="adminManaged";c[c.Dyk=2]="popular"})(b||(b={}));Object(w.b)("AddinCollectionType",b)},865:function(w,B,a){a.d(B,"a",function(){return b});a.d(B,"b",function(){return c});const b=h=>{let f=null;switch(h){case 0:f="omex";break;case 1:f="spcatalog";break;case 2:f=
"spapp";break;case 3:f="filesystem";break;case 4:f="exchange";break;case 6:f="registry";break;case 7:f="inmemory";break;case 8:f="uploadfiledevcatalog";break;case 9:f="hardcodedpreinstall";break;case 10:f="excatalog";break;case 16:f="wopicatalog"}return f},c=h=>{let f=-1;switch(h.toLowerCase()){case "omex":f=0;break;case "spcatalog":f=1;break;case "spapp":f=2;break;case "filesystem":f=3;break;case "exchange":f=4;break;case "registry":f=6;break;case "inmemory":f=7;break;case "uploadfiledevcatalog":f=
8;break;case "hardcodedpreinstall":f=9;break;case "excatalog":f=10;break;case "wopicatalog":f=16}return f}},913:function(w,B,a){a.d(B,"a",function(){return c});w=a(0);var b=a(12);class c{constructor(){this.H3e={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.G3e={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",b.a.instance.ha(1633),b.a.instance.ha(1637)],["tabformulas"]:["Ribbon.Formulas",b.a.instance.ha(1634),
b.a.instance.ha(1638)],["tabdeveloper"]:["Ribbon.Developer",b.a.instance.ha(1635),b.a.instance.ha(1639)],["tabaddins"]:["Ribbon.AddIns",b.a.instance.ha(1636),b.a.instance.ha(1640)]};this.dgc=null}get Yla(){return"SourceControlId"}get lQ(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}xbi(){if(!this.dgc){this.dgc={};for(const h of Object.keys(this.H3e))this.dgc[h]=this.H3e[h];for(const h of Object.keys(this.G3e))this.dgc[h]=this.G3e[h][0]}}}Object(w.a)(c,"AddinCommandsStringProvider",
null,[758])},914:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);var b;(function(c){c[c.OK=0]="OK";c[c.Zxk=1]="notReady";c[c.tzk=2]="storeDisabled";c[c.sxk=3]="invokeFailure";c[c.gzk=4]="serviceDisabled";c[c.Zvk=5]="builtinAddinDetails"})(b||(b={}));Object(w.b)("AddinDetailsQueryError",b)},916:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);class b{constructor(){this.rQa=0;this.vla=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.umc=!1;this.fnf=this.rma=
null}}Object(w.a)(b,"AddInCommandsNotificationParameters",null,[])},991:function(w,B,a){w=a(0);var b=a(16),c=a(125),h=a(173),f=a(15),e=a(95);class k extends Sys.UI.Control{constructor(L,J,P,K){super(document.createElement("div"));this.iW=this.gW=this.Uy=this.zJ=this.LJ=this.Jta=this.fva=null;this.xob=this.yua=!1;this.content=this.ns=null;this.s5=0;this.tGe=null;this.kX=0;this.ATf=null;this.yda=()=>{this.dismiss();return!0};this.Yue=L;this.dqe=J;this.vS=P;this.NM=K;this.Ri=J.ownerDocument;this.Wlc=
this.Gw=this.Sob=!1}get wZ(){this.fva||(this.fva=this.Ri.createElement("div"),this.fva.id=this.qk("WACCalloutOuter"),this.fva.className="WACCalloutOuter",this.fva.setAttribute(e.a.pg,e.a.vub),this.fva.style.width=this.s5+"px");return this.fva}get Tub(){if(!this.Jta){this.Jta=this.Ri.createElement("div");this.Jta.id=this.qk("WACCalloutBeakContainer");this.Jta.className="WACCalloutBeakContainer";var L="CalloutBeakTopFilled_32x16x32";if(5===this.kX||6===this.kX||4===this.kX)L="CalloutBeakBottomFilled_32x16x32";
L=h.createClusteredImage(32,16,L,"WACCalloutBeak",!0,"");this.Jta.appendChild(L)}return this.Jta}set Tub(L){this.Jta=L}get VQa(){return this.Sob}get title(){return this.ns}set title(L){this.ns!==L&&(this.ns=L,this.gW&&(this.gW.innerText=this.ns))}get Gw(){return this.yua}set Gw(L){this.yua!==L&&(this.yua=L,this.LJ&&(this.LJ.contains(this.Uy)&&!this.yua?this.LJ.removeChild(this.Uy):!this.LJ.contains(this.Uy)&&this.yua&&this.jye()))}get Wlc(){return this.xob}set Wlc(L){this.xob!==L&&(this.xob=L,this.LJ&&
(this.LJ.contains(this.gW)&&!this.xob?this.LJ.removeChild(this.gW):!this.LJ.contains(this.gW)&&this.xob&&this.wze()))}show(){this.Sob||(this.Kqh(),this.Vo(),this.dqe.appendChild(this.wZ),this.wZ.style.display="Block",this.yWj(),this.Sob=!0,this.ATf&&this.ATf())}dismiss(){this.Sob&&(this.N7(),this.dqe.removeChild(this.wZ),this.Sob=!1,this.NM&&this.NM())}dispose(){this.dismiss();this.gW=this.Uy=this.zJ=this.Jta=this.LJ=this.fva=null;Sys.Component.prototype.dispose.call(this)}qk(L){return this.get_element().id+
L}Kqh(){this.LJ=this.Ri.createElement("div");this.LJ.id=this.qk("WACCalloutHeader");this.LJ.className="WACCalloutHeader";this.Gw&&this.jye();this.Wlc&&this.wze();this.zJ=this.Ri.createElement("div");this.zJ.id=this.qk("WACCalloutContent");this.zJ.className="WACCalloutContent";this.zJ.style.width=190<this.s5?this.s5-26+"px":"164px";this.zJ.appendChild(this.content);this.wZ.appendChild(this.Tub);this.wZ.appendChild(this.LJ);this.wZ.appendChild(this.zJ)}jye(){this.Uy=this.Ri.createElement("a");this.Uy.className=
"WACCalloutCloseAnchor";this.Uy.id=this.qk("WACCalloutCloseAnchor");this.Uy.href="#";this.LJ.appendChild(this.Uy);const L=h.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Uy.appendChild(L)}wze(){this.gW=this.Ri.createElement("div");this.gW.className="WACCalloutTitle UIFontBold";this.gW.style.width=190<this.s5?this.s5-30+"px":"160px";this.gW.id=this.qk("WACCalloutTitle");this.gW.innerText=this.title;this.LJ.contains(this.Uy)?this.LJ.insertBefore(this.gW,
this.Uy):this.LJ.appendChild(this.gW)}yWj(){var L=this.Yue;let J;if(1===this.kX){var P=this.tGe.y+16;J=-16}else 2===this.kX||3===this.kX||0===this.kX?(P=L.y+L.height+15,J=-15):(P=L.y-this.wZ.clientHeight-15-2,J=this.wZ.clientHeight-1);this.wZ.style.top=P+"px";this.Tub.style.top=J+"px";1===this.kX?(L=this.tGe.x-16,this.wZ.style.left="50%",this.wZ.style.marginLeft=-this.s5/2+"px",P=Sys.UI.DomElement.getBounds(this.wZ),this.Tub.style.left=L-P.x+"px"):(P=L.x+this.Yue.width/2,2===this.kX||5===this.kX?
(L=20,P-=36):0===this.kX||4===this.kX?(L=this.s5/2-16,P-=this.s5/2):(L=this.s5-20-32,P=P-this.s5+36),this.wZ.style.left=P+"px",this.Tub.style.left=L+"px")}Vo(){this.Gw&&!this.iW&&(this.iW=this.yda,this.vS.va(f.a.click,this.Uy,this.iW,null))}N7(){this.Gw&&this.iW&&(this.vS.Ca(f.a.click,this.Uy,this.iW),this.iW=null)}}Object(w.a)(k,"Callout",Sys.UI.Control,[434]);class l extends k{constructor(L,J,P,K,ca,T){super(L,P,ca.NV,void 0===T?null:T);this.joe=0;this.Of=()=>{this.dismiss();return!0};this.s5=this.Dbi(K);
this.h2a=J;this.Jh=ca;this.Ick=7;this.eo=this.h2a.ownerDocument.createElement("div");this.eo.className="ModalCalloutControlOverlay";this.eo.tabIndex=0;this.h2a.insertBefore(this.eo,this.h2a.firstChild)}show(){this.VQa||(this.Jh.Bzc(),this.Jh.ZS(!1),this.eo.style.zIndex=String(this.Jh.y6),super.show(),this.Zk(),this.joe=window.setTimeout(Object(c.a)(this,this.dismiss,"dismiss"),1E3*this.Ick))}dismiss(){this.VQa&&(this.Jh.VP(!1),this.Hk(),this.h2a&&this.h2a.contains(this.eo)&&this.h2a.removeChild(this.eo),
super.dismiss(),window.clearTimeout(this.joe))}Zk(){this.Jh.jwa(Object(c.a)(this,this.dismiss,"dismiss"));this.Jh.oD.va(f.a.click,this.eo,this.Of)}Hk(){this.Jh.shb(Object(c.a)(this,this.dismiss,"dismiss"));this.Jh.oD.Ca(f.a.click,this.eo,this.Of)}Dbi(L){let J=0;switch(L){case 0:J=190;break;case 1:J=250;break;case 2:J=300;break;case 3:J=360}return J}}Object(w.a)(l,"ModalCallout",k,[]);var r=a(472),v=a(190);class u extends l{constructor(L,J,P,K,ca,T){super(L,J,P,K,ca,void 0===T?null:T);this.K1b=null}show(){if(!this.VQa){const L=
Object.assign(new r.a,{onShow:()=>{l.prototype.show.call(this)}});v.UISurfaces.KK().then(J=>{const P=J.externalNotification();this.K1b=J.addNotification(P,L);return null},J=>{b.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null})}}dismiss(){this.VQa&&this.K1b&&(v.UISurfaces.KK().then(L=>{L.removeNotification(this.K1b);return this.K1b=null},L=>{b.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",L);return null}),super.dismiss())}}Object(w.a)(u,
"ReactManagedModalCallout",l,[]);var x=a(5);class t{static ysh(L,J,P){var K=void 0===K?null:K;return x.AFrameworkApplication.sa.Sa.zU?new u(L,J,P,3,x.AFrameworkApplication.sa,K):new l(L,J,P,3,x.AFrameworkApplication.sa,K)}}Object(w.a)(t,"ModalCalloutControlFactory",null,[]);var m=a(56),n=a(911),A=a(601),y=a(912),z=a(154),F=a(61),D=a(39),I=a(81),H=a(859),N=a(736);a.d(B,"a",function(){return U});class U{static get J3a(){return U.V_||(U.V_=I.a.instance.Ii("Common.Utils.IAriaNotifier"))}static lQe(L,
J,P,K){U.qM&&U.qM.VQa&&U.qM.dismiss();U.qM=t.ysh(J,L,L);U.qM.content=P;N.b(K)||(U.qM.title=K,U.qM.Wlc=!0);L=new Sys.UI.Bounds(0,0,F.a.uDb(),F.a.tDb());U.qM.kX=U.X3h(L,J,U.qM.s5);U.qM.show();U.J3a&&U.J3a.Jra(P.innerText,!0)}static Jcd(L,J,P,K){K=void 0===K?null:K;v.UISurfaces.KK().then(ca=>{let T=null;U.Oqb&&(ca.removeNotification(U.Oqb),U.Oqb=null);const Q=ca.callout(Object.assign(new n.a,{target:L,title:J,content:P,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new y.a,
{onDismiss:()=>{ca.removeNotification(T)},directionalHint:null!=K?K:null})})),fa=Object.assign(new r.a,{expirationOptions:Object.assign(new A.a,{displayTimeoutSeconds:7,onExpire:()=>{ca.removeNotification(U.Oqb)}})});T=U.Oqb=ca.addNotification(Q,fa);return null},ca=>{b.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",ca);return null})}static c2d(L,J){J=void 0===J?null:J;U.qM&&U.qM.VQa&&U.qM.dismiss();const P=new z.StandardDialog;P.AXa=!1;P.ke=0;P.mD(m.a.MPi,CommonUIStrings.l_DialogError,
N.b(L)?U.waf():L,J)}static d2d(L){U.qM&&U.qM.VQa&&U.qM.dismiss();b.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",L.errorCode));const J=N.b(L.description)?U.waf():L.description,P=new z.StandardDialog;let K=null;L.vla?(P.ke=1,P.Ke(1,L.buttonText),P.K4(1)):P.ke=0;K=ca=>{1===ca?L.vla():L.rma&&L.rma()};P.AXa=!1;0===L.rQa?P.mD(L.errorCode,L.title?L.title:CommonUIStrings.l_DialogError,J,K):1===L.rQa?P.JV(L.title?L.title:CommonUIStrings.l_DialogWarning,J,
K):P.osa(L.title?L.title:CommonUIStrings.l_DialogInfo,J,K)}static X3h(L,J,P){let K=4;const ca=L.x+L.width-J.x-J.width;J.x-L.x+J.width/2<=P/2?K=5:ca+J.width/2<=P/2&&(K=6);return K}static e2j(L,J,P,K){K=void 0===K?!1:K;(J=H.a.CBb(J))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(J,ca=>{ca&&(K||U.Jcd(ca,P,L,5))})}static f2j(L,J,P){P=void 0===P?!1:P;U.e2j(J.startedNode?J.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,
L),J,J.startedNode?J.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,L),P)}static d2j(L,J,P,K){if(U.Qwg)L=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,P,K,CommonUIStrings.l_InsertionDialogRefresh)),U.Jcd(J,L,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{J=D.a.Ur(J);var ca=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),T=document.createElement("span");T.innerText=
ca[0];var Q=document.createElement("span");Q.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,P,K,CommonUIStrings.l_InsertionDialogRefresh);Q.className="UIFontBold";P=document.createElement("span");P.innerText=ca[1];K=document.createElement("div");Sys.UI.DomElement.addCssClass(K,"ModalCalloutControl");K.appendChild(T);K.appendChild(Q);K.appendChild(P);U.lQe(L,J,K,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static D3j(L,J){var P=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,
K=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;U.Qwg?U.Jcd(J,P,K):(J=D.a.Ur(J),U.lQe(L,J,U.tbh(K),P))}static tbh(L){const J=document.createElement("div");Sys.UI.DomElement.addCssClass(J,"ModalCalloutControl");J.innerText=L;return J}static waf(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get Qwg(){return x.AFrameworkApplication.sa.Sa.rm&&x.AFrameworkApplication.sa.Sa.zU}}U.qM=null;U.Oqb=null;U.V_=null;Object(w.a)(U,"AddInCommandsNotificationFactory",
null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.agave.js.map/8e77adaa89f1a1ac0e20803018caec81/EwaTS.agave.js.map