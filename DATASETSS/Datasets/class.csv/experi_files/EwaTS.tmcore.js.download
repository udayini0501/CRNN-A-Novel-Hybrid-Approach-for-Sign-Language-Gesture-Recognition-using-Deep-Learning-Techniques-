'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[27],{1188:function(w,B,a){a.r(B);w=a(0);var b=a(16);class c{constructor(l,r,v,u,x,t){l&&(this.N=l);r&&(this.S=r);v&&(this.M=v);u&&(this.F=u);null!=x&&(this.L=x);null!=t&&(this.C=t)}}Object(w.a)(c,"SerializableExceptionEntry",null,[]);class h{constructor(l,r,v,u,x){this.T=l;this.L=r;this.S=v;this.I=u;this.V=x}}Object(w.a)(h,"SerializableLogCache",null,[]);class f{constructor(l,r,v,u,x,t,m=!1,n=null,A=null){this.T=
this.G=0;this.C=this.M=null;this.D=0;this.G=t;this.T=u;this.M=l;this.C=r;this.D=1E3*x+v;m&&(this.O=1);n&&(this.A=n);A&&(this.E=A)}Zfh(){if(!this.E)return 0;let l=7,r=0;this.E.N&&(l+=6+f.sda(this.E.N),r++);this.E.S&&(l+=6+f.sda(this.E.S),r++);this.E.M&&(l+=6+f.sda(this.E.M),r++);this.E.F&&(l+=6+f.sda(this.E.F),r++);this.E.L&&(l+=6+f.sda(this.E.L),r++);this.E.C&&(l+=6+f.sda(this.E.C),r++);1<r&&(l+=r-1);return l}plh(){let l=a(1188).LogCache.CTi+f.sda(this.G)+f.sda(this.T)+this.M.length+f.sda(this.C)+
f.sda(this.D)+this.Zfh();1===this.O&&(l+=6);if(this.A){l+=7;for(let r=0,v=this.A.length;r<v;++r)l+=this.A[r].length+3}return l}static sda(l){return(""+l).length}}Object(w.a)(f,"SerializableLogEntry",null,[]);var e=a(394);a.d(B,"LogCache",function(){return k});class k{constructor(l,r,v){this.d1c=0;this.n1b=null;this.iGa=this.M4b=this.mnb=0;this.e0c=l;this.T0a=r;this.G0=v;this.e0c=262144>l?l:262144;this.eNg=this.e0c-4*(this.T0a+25);this.reset()}reset(){this.n1b=[];this.mnb=25;this.d1c=(new Date).getTime()}get count(){return this.n1b.length}get NWb(){return this.M4b}set NWb(l){this.M4b=
l}xWg(l){if(l){l.message=this.UVb(l.message,"message",l.tag);var r=l.Qjd;r&&(r.name=this.UVb(r.name,"Exception.Name",l.tag),r.stack=this.UVb(r.stack,"Exception.Stack",l.tag),r.message=this.UVb(r.message,"Exception.Message",l.tag),r.file=this.UVb(r.file,"Exception.File",l.tag));if(l.Aj)for(var v=0;v<l.Aj.length;v++)l.Aj[v].length>this.T0a&&(l.Aj[v]=l.Aj[v].substr(0,this.T0a-13)+"... [trimmed]",b.ULS.sendTraceTag(3465240,100,50,"Trimmed arg {0} for log {1}",v,e.a(l.tag)));r=r?new c(r.name,r.stack,r.message,
r.file,r.line,r.column):null;l=new f(l.message,l.category,l.level,l.timestamp-this.d1c,l.zFd,l.tag,l.jIi,l.Aj,r);r=l.plh();0<this.M4b&&r+this.mnb>this.M4b&&(v=this.count,this.reset(),b.ULS.sendTraceTag(0,100,15,"The log size is too large to be accepted by the server, throwing away {0} logs.",v));Array.add(this.n1b,l);this.mnb+=r}}UVb(l,r,v){let u=l;l&&l.length>this.T0a&&(u=l.substr(0,this.T0a-13)+"... [trimmed]",b.ULS.sendTraceTag(3465240,100,50,"Trimmed {0} for log {1}",r,e.a(v)));return u}get xEi(){return this.mnb>
this.eNg}serialize(){return b.ULS.ff(new h(this.d1c,this.n1b,this.G0,this.iGa,1))}get o3d(){return this.e0c}get bFd(){return this.T0a}}k.CTi=31;Object(w.a)(k,"LogCache",null,[47,48])},1356:function(w,B,a){a.r(B);w=a(649);B=a(0);var b=a(16),c=a(65);class h{constructor(){this.NSf=xa=>{xa=xa.rawEvent;let Pa=xa.blockedURI;Pa=c.a.p4(Pa);const Ka={};Ka.effectiveDirective=xa.effectiveDirective;Ka.violatedDirective=xa.violatedDirective;Ka.originalPolicy=xa.originalPolicy;Ka.blockedURI=Pa;Ka.disposition=xa.disposition;
b.ULS.sendTraceTag(588084128,306,15,"{0}",Ka)};$addHandler(document,"securitypolicyviolation",this.NSf)}dispose(){$removeHandler(document,"securitypolicyviolation",this.NSf)}}Object(B.a)(h,"ContentSecurityPolicyListener",null,[5]);var f=a(260);class e{constructor(){this.Fd=null}get name(){return"Common.App.ContentSecurityPolicy"}init(){this.Fd.resolve("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener")}dispose(){const xa=this.Fd.Ii("Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener");
xa&&xa.dispose()}nk(xa){this.Fd=xa;this.Fd.register(h,"Common.App.ContentSecurityPolicy.ContentSecurityPolicyListener").Ve().$e(()=>new h)}static main(){f.a.instance.$k(new e)}}Object(B.a)(e,"ContentSecurityPolicyPackage",null,[3,4]);var k=a(41);class l{constructor(){this.File=this.Message=null;this.Column=this.Line=0;this.ClientAppVersion=this.Stack=null;this.AppMode=this.AppType=0;this.DeobfuscateWithSourceMaps=!1;this.DataPlumber=this.SessionStartInfoJson=null;this.IsShuttingDown=!1;this.ErrorName=
this.Flight=null}tQj(){return k.c(this)}}Object(B.a)(l,"DiagnosticsRequest",null,[]);var r=a(5),v=a(490),u=a(33),x=a(84);class t{constructor(xa,Pa,Ka,Bb,xb){this.RJa=xa;this.ZGa=Pa;this.y5=Ka;this.GOc=Bb;this.ELg=xb}Vcg(xa,Pa){try{this.Nrh().send(this.t0h(xa,Pa))}catch(Ka){b.ULS.sendTraceTag(6161306,201,10,"Could not send error report [{0}]",Ka.toString())}}Nrh(){const xa=new XMLHttpRequest;xa.open("POST",this.RJa,!0);xa.setRequestHeader("Content-Type","text/json; charset=utf-8");r.AFrameworkApplication.userSessionId&&
xa.setRequestHeader(x.a.aMc,u.a.Yea(r.AFrameworkApplication.userSessionId));this.ZGa&&xa.setRequestHeader(x.a.CCa,this.ZGa);if(r.AFrameworkApplication.Wf){const Pa=r.AFrameworkApplication.Wf.I_;Pa&&xa.setRequestHeader(x.a.HMc,Pa)}return xa}t0h(xa,Pa){if(!xa)return null;Pa=Pa?"<stack>"+Pa+"</stack>":"";const Ka=new l;Ka.Message=xa.message;Ka.File=xa.source;Ka.Line=xa.line;Ka.Column=xa.column;Ka.Stack=Pa;Ka.ClientAppVersion=this.ZGa;Ka.AppType=this.y5;Ka.AppMode=this.GOc;Ka.DeobfuscateWithSourceMaps=
this.ELg;r.AFrameworkApplication.da.na("JavaScriptCrashJsonTagEnabled")&&(Ka.SessionStartInfoJson=r.AFrameworkApplication.da.appSettings.SessionStartInfoJson||"",r.AFrameworkApplication.th&&(Ka.DataPlumber=k.c(r.AFrameworkApplication.th)),Ka.IsShuttingDown=r.AFrameworkApplication.ij,Ka.Flight=r.AFrameworkApplication.flightId,Ka.ErrorName=v.a.baf(xa));return Ka.tQj()}}Object(B.a)(t,"JavascriptErrorReporter",null,[466]);class m{build(xa,Pa,Ka,Bb,xb){return new t(xa,Pa,Ka,Bb,xb)}}Object(B.a)(m,"JavascriptErrorReporterFactory",
null,[451]);class n{nk(xa){xa.register(m,"Common.App.Diagnostics.JavascriptErrorReporterFactory").as("Common.IJavascriptErrorReporterFactory").Ve().$e(()=>new m)}get name(){return"Common.App.Diagnostics"}init(){}dispose(){}static main(){f.a.instance.$k(new n)}}Object(B.a)(n,"DiagnosticsPackage",null,[3,4]);var A=a(54),y=a(103),z=a(233),F=a(40),D=a(180),I=a(353),H=a(37),N=a(59),U=a(44),L=a(125),J=a(1188);class P{constructor(xa=null,Pa=null,Ka=null,Bb=null,xb=null,Ua=null,Jb=null,fc=null){this.bFd=
3072;this.o3d=65536;this.Ewg=6E4;this.Qpg=2E3;this.MUe=1E4;this.rFe=5E3;this.qFe=!1;this.NWb=0;null!=xa&&(this.bFd=xa);null!=Pa&&(this.o3d=Pa);null!=Ka&&(this.Ewg=Ka);null!=Bb&&(this.Qpg=Bb);null!=xb&&(this.MUe=xb);null!=Ua&&(this.rFe=Ua);null!=Jb&&(this.qFe=Jb);null!=fc&&0<fc&&(this.NWb=fc)}}Object(B.a)(P,"UlsUploadConfiguration",null,[]);var K=a(394);class ca{constructor(xa,Pa,Ka=null){this.q_b=0;this.NRc=!1;this.wLb=0;this.wnb=null;this.gsb=0;this.yj=null;this.W_d=this._disposing=!1;this.rF=this.a1c=
this.OYb=this.JZb=0;this.zEc=!1;this.$Za=0;Ka||(Ka=new P);this.C_c=xa;this.uploadUrl=Pa;this.uploadUrl.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&b.ULS.disable();this.PSg=Ka.Ewg;this.lSg=Ka.Qpg;this.mIg=Ka.MUe;this.QSg=Ka.rFe;this.PFg=Ka.qFe;this.Bja=new J.LogCache(Ka.o3d,Ka.bFd,xa);this.Bja.NWb=Ka.NWb;this.jWd();this.U8f();this.V8f()}U8f(){this.wnb=[];this.NRc=!1}AY(xa){1<this.$kb?256>this.wnb.length?Array.add(this.wnb,xa):this.NRc=!0:(this.Bja.xWg(xa),this.dUi(xa)&&
!this.aWe()?(this.H6e("LogIndicatesError in HandleTrace"),b.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",K.a(xa.tag))):this.Bja.xEi&&(this.fBb(!1,!0),b.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size")))}dUi(xa){return!!xa&&(1===xa.zFd||10===xa.level)}aWe(){return!1}dispose(){this._disposing||(this._disposing=!0,this.hXh(),b.ULS.Z_d(null),window.clearTimeout(this.$Za),window.clearTimeout(this.JZb),window.clearTimeout(this.OYb),this.OYb=
this.JZb=this.$Za=0)}hXh(){this.mode=2;this.Uif();this.zEc=!1;this.rZe();this.H6e("FlushForAppClose")}MWb(xa,Pa){xa.iGa=this.wLb;return this.Fwg(xa.serialize(),Pa)?(this.wLb++,!0):!1}Fwg(xa,Pa){Pa=this.PFg||!Pa;this.yj&&Pa||(this.yj=new XMLHttpRequest);if(0===this.yj.readyState||4===this.yj.readyState)return this.yj.open("POST",this.uploadUrl,Pa),this.yj.setRequestHeader("Content-Type","application/json"),this.yj.setRequestHeader(ca.DZd,this.C_c),Pa&&(this.yj.timeout=this.QSg),this.yj.send(xa),!0;
b.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",{["UploadId"]:this.wLb,["XhrReadyState"]:this.yj.readyState});return!1}$hj(){this.yj&&this.yj.abort()}OFc(xa,Pa,Ka){try{return window.setTimeout(()=>{b.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",Pa,Ka);xa()},Pa)}catch(Bb){b.ULS.sendTraceTag(0,100,15,"SetTimeoutToLogOriginAndExecute: Calling Window.SetTimeout() failed with exception: {0}",Bb.toString());if(!this.W_d){this.W_d=!0;try{xa()}finally{this.W_d=
!1}}return 0}}V8f(){try{window.clearTimeout(this.JZb)}catch(xa){b.ULS.sendTraceTag(0,100,15,"ResetDelayedLoggingTimer: Calling Window.ClearTimeout() failed with exception: {0}",xa.toString())}this.JZb=this.OFc(Object(L.a)(this,this.Uif,"handleDelayedLogs"),this.mIg,"ResetDelayedLoggingTimer")}get $kb(){return b.ULS.$kb+this.gsb}Uif(){const xa=this.wnb.length;if(xa){var Pa=this.wnb,Ka=this.NRc;this.U8f();b.ULS.sendTraceTag(3731798,100,50,"HandleDelayedLogs {0}",{["Count"]:xa,["Limit"]:256,["ExceededLimit"]:Ka});
this.gsb++;for(Ka=0;Ka<xa;Ka++)this.AY(Pa[Ka]);this.gsb--}this.V8f()}jWd(){try{window.clearTimeout(this.OYb)}catch(xa){b.ULS.sendTraceTag(0,100,15,"ResetCadenceTimer: Calling Window.ClearTimeout() failed with exception: {0}",xa.toString())}this.OYb=this.OFc(Object(L.a)(this,this.fBb,"flushImpl"),this.PSg,"ResetCadenceTimer")}get mode(){return this.rF}set mode(xa){const Pa=this.rF;this.rF=xa;if(0===this.rF&&0!==Pa)try{const Ka=this.a1c;this.a1c=0;window.clearTimeout(Ka)}catch(Ka){b.ULS.sendTraceTag(0,
100,15,"set_Mode: Calling Window.ClearTimeout() failed with exception: {0}",Ka.toString())}else 0!==this.rF&&0===Pa&&(this.a1c=this.OFc(Object(L.a)(this,this.rZe,"endThrottling"),this.lSg,"ThrottlingMode Setter"))}rZe(){this.mode=0;this.zEc&&(this.zEc=!1,this.fBb())}JTb(xa){return 2===this.mode||1===this.mode&&!xa}H6e(xa){b.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",xa);this.fBb(!0)}dBb(){this.G6e(0)}G6e(xa){this.$Za||(this.$Za=this.OFc(Object(L.a)(this,this.fBb,"flushImpl"),
xa,"FlushAsynchronous"))}fBb(xa,Pa){this.gsb++;try{window.clearTimeout(this.$Za)}catch(Bb){b.ULS.sendTraceTag(0,100,15,"FlushImpl: Calling Window.ClearTimeout() failed with exception: {0}",Bb.toString())}this.$Za=0;if(this.Bja.count)if(!Pa&&this.JTb(xa))b.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",xa?"sync":"async"),this.zEc=!0;else{this.mode=xa?2:1;this.jWd();b.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",xa?"sync":"async",this.Bja.count);
try{var Ka=this.MWb(this.Bja,xa)}catch(Bb){this.$hj(),Ka=!1}Ka?(this.Bja.reset(),this.q_b=0):(this.q_b++,this.q_b<ca.HFf?this.G6e(ca.gDc):(this.Bja.reset(),this.wLb++,this.q_b=0))}else this.jWd();this.gsb--}UDb(){}ttb(){}}ca.HFf=3;ca.gDc=15E3;ca.DZd="X-UserSessionId";Object(B.a)(ca,"UploadingUlsHost",null,[26,5]);var T=a(566);const Q=xa=>{let Pa=0;r.AFrameworkApplication.da&&(Pa=r.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.WordOnline.bUlsFetchRequestOption",-1),-1===Pa&&(Pa=r.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.Excel.bUlsFetchRequestOption",
-1)),-1===Pa&&(Pa=r.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.PowerPointOnline.bUlsFetchRequestOption",-1)),-1===Pa&&(Pa=r.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.SharedOnline.bUlsFetchRequestOption",0)));return Pa===xa};class fa{constructor(xa,Pa,Ka,Bb){this.iGa=xa;this.T6c=Pa;this.sessionId=Ka;this.version=Bb}}Object(B.a)(fa,"UploadState",null,[]);class ha{constructor(xa){this.wMg=xa}get UOi(){return this.wMg}}Object(B.a)(ha,"FetchRequestArgs",null,[]);var Ea=
a(81),ra=a(544);class Z extends Sys.EventArgs{constructor(xa){super();this.Aj=xa}}Object(B.a)(Z,"UlsLoggingEventArgs",Sys.EventArgs,[]);var wa=a(213),la=a(672);class ta extends ca{constructor(xa,Pa,Ka,Bb,xb,Ua=null){super(r.AFrameworkApplication.userSessionId,ta.VZh(ta.u3h(xa,Bb),Pa,Ka,Ua),new P(void 0,r.AFrameworkApplication.Gli(),Bb.eg("BulsUploadFrequencyInMs",6E4),void 0,void 0,void 0,void 0,r.AFrameworkApplication.i9b));this.Dge=!1;this.LZc=this.Srb=this.vYb=this.FJ=null;this.mTf=(Jb,fc)=>{fc.Pbb(ta.w5d)&&
(this.Srb=this.Pgf())};this.kj=Ka;this.Gta=Bb;(this.Qrb=this.Gta.Ra("RemoteUlsETag"))&&ta.s_f(this.Gta.Ra("RemoteUlsSuppressions"));xb&&(this.vYb=xb,this.vYb.y4c(this.mTf));this.tde=r.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.OfficeVSO_8117458_bUlsUploadsFailingUnexpectedlyHeaderIsEnabled");this.YOc=!1;this.Xme=new T.a(()=>la.ClientRequestBuilder.S9e(r.AFrameworkApplication.da.na,r.AFrameworkApplication.da.getBooleanFeatureGate))}get events(){return this.FJ||
(this.FJ=new Sys.EventHandlerList)}ttb(xa){this.events.addHandler(ta.Vsg,xa)}get ufb(){return null}get INd(){return null}get s7c(){return this.Gta.na("BUlsExceptionLoggingIsEnabled")}dispose(){this.Dge||(this.Dge=!0,super.dispose(),this.vYb&&this.vYb.u6f(this.mTf))}V3h(){return Error().stack}Pgf(){let xa=null;if(this.Gta.As(ta.w5d)){xa=new wa.a;const Pa=this.Gta.By(ta.w5d);for(let Ka=0;Ka<Pa.length;Ka++)xa.fa(Pa[Ka],!0)}return xa}AY(xa){this.Srb||(this.Srb=this.Pgf());if(this.Srb&&this.Srb.Hd(xa.tag))try{!xa.Qjd&&
this.s7c?xa.Qjd=new ra.a(Error()):xa.message+=". JsCallStack: "+this.V3h()}catch(Ka){xa.message+=" [Failed to add callstack for this tag. BUlsExceptionLoggingIsEnabled="+this.s7c+" ("+Ka.message+")]"}super.AY(xa);const Pa=this.events.getHandler(ta.Vsg);xa=new Z(xa);Pa&&Pa(null,xa)}MWb(xa,Pa){if(this.kj){if(!this.gjg)return!1;const Ka=xa.serialize();if(0<r.AFrameworkApplication.i9b&&Ka.length>r.AFrameworkApplication.i9b)return!1;xa.iGa=this.wLb++;if(Q(0)){if(this.Nig())return this.gSb(this.uploadUrl,
Ka),!0;this.Eze(this.uploadUrl,Ka,Pa&&!this.ufb?0:3,1,Pa&&r.AFrameworkApplication.ij,xa.iGa,this.ufb,this.INd)}else{if(this.Nig()){if(Q(1))return this.gSb(this.uploadUrl,Ka),!0;window.console&&window.console.log&&window.console.log("Send shuttingDown buls from common")}this.R3c(this.uploadUrl,Ka,3,1,xa.iGa,this.ufb,this.INd)}return!0}return Q(0)?super.MWb(xa,Pa):(this.XPj(this.uploadUrl,xa.serialize()),!0)}Txc(xa){this.tde&&this.TXj();try{if(xa&&xa.data&&xa.data.responseHeaders&&ta.pEb in xa.data.responseHeaders){var Pa=
xa.data.responseHeaders[ta.pEb];Pa!==this.Qrb&&(this.Qrb=Pa,ta.s_f(xa.data.responseHeaders[ta.iud]))}}catch(Ka){b.ULS.sendTraceTag(593847297,100,50,"Failed to process tag suppressions. [Message: {0}] [Stack: {1}]",Ka.message,Ka.stack)}}Awc(xa){const Pa=xa.data;if(!Pa)b.ULS.sendTraceTag(5002497,100,15,"Request Item is null! RequestFailedEventArgs = {0}",xa);else if(13===Pa.status)b.ULS.sendTraceTag(6399108,100,50,"Request timed out in the ClientRequestManager queue. Falling back to default XHR."),
this.Fwg(Pa.request.get_body(),!1);else if(!Pa.responseHeaders)b.ULS.sendTraceTag(5002498,100,15,"Item.ResponseHeader is null! RequestItem id = {0}, responseXml = {1}, data = {2}, HttpStatusCode = {3}",Pa.id,Pa.WVa,Pa.Fg,Pa.httpStatus),this.tde&&this.qgh();else if(!(ta.MAi in Pa.responseHeaders||(xa=Pa.httpStatus,400<=xa&&499>=xa))){var Ka=Pa.state;Ka.T6c>=ca.HFf||(Q(0)?window.setTimeout(()=>{this.Eze(Pa.request.get_url(),Pa.request.get_body(),3,Ka.T6c+1,!1,Ka.iGa,Ka.sessionId,Ka.version)},ca.gDc):
window.setTimeout(()=>{this.R3c(Pa.request.get_url(),Pa.request.get_body(),3,Ka.T6c+1,Ka.iGa,Ka.sessionId,Ka.version)},ca.gDc))}}Eze(xa,Pa,Ka,Bb,xb,Ua,Jb,fc){Q(0)?this.kj.zp(xa,2,Pa,this.hdd(),!1,Ka,Object(L.a)(this,this.Txc,"onSuccessfulUpload"),Object(L.a)(this,this.Awc,"onFailedUpload"),new fa(Ua,Bb,Jb,fc),null,xb,this.Gta.eg("BulsClientRequestManagerQueueTimeInMS",3E4),void 0,"19",Jb,void 0,fc,[ta.pEb,ta.iud]):this.R3c(xa,Pa,Ka,Bb,Ua,Jb,fc)}R3c(xa,Pa,Ka,Bb,xb,Ua,Jb){let fc;fc=Q(2)||Q(3)?new ha(!0):
new ha(!1);this.kj.WVg(xa,Pa,this.hdd(),fc,Ka,Object(L.a)(this,this.Txc,"onSuccessfulUpload"),Object(L.a)(this,this.Awc,"onFailedUpload"),new fa(xb,Bb,Ua,Jb),this.Gta.eg("BulsClientRequestManagerQueueTimeInMS",3E4),Ua,Jb,[ta.pEb,ta.iud])}XPj(xa,Pa){const Ka={};Ka.body=Pa;Ka.method="POST";Ka.headers=this.hdd();if(Q(2)||Q(3))Ka.keepalive=!0;window.fetch(xa,Ka).then(()=>null,()=>{b.ULS.sendTraceTag(509149207,100,50,"exception from buls fetch");return null})}qgh(){const xa=this.Xme.value;xa&&this.gjg&&
(this.YOc=!0,xa.bug(ta.tlf,"1"))}TXj(){const xa=this.Xme.value;xa&&this.YOc&&(this.YOc=!1,xa.bug(ta.tlf,"0"))}hdd(){let xa=null;this.Qrb&&(xa={},xa[ta.pEb]=this.Qrb);if(this.s7c){const Pa=r.AFrameworkApplication.sa;let Ka=null;Pa&&(Ka=Pa.Sa);Ka&&(xa||(xa={}),xa[ta.Zri]=Ka.zCa,xa[ta.$ri]=Ka.Hj,xa[ta.esi]=r.AFrameworkApplication.EDi?"1":"0",Q(0)||(xa[ta.Rri]="text/plain"))}return xa}gSb(xa,Pa){this.kj.gSb(xa,Pa)}Nig(){return r.AFrameworkApplication.ij||r.AFrameworkApplication.Xqc}get fKj(){this.LZc||
(this.LZc=this.Gta.eg("bULSUploadRetryDelayWhenDisconnectedInMilliseconds",6E4));return this.LZc}get gjg(){const xa=this.kj.obb;return xa&&(new Date).getTime()-this.kj.EPi.getTime()>=this.fKj?!0:!xa}static u3h(xa,Pa){Pa=Pa.Ra("BulsEndpointUrl");return ta.iuf(Pa)?Pa:xa}static iuf(xa){return!(void 0===xa||null===xa)&&""!==xa}static VZh(xa,Pa,Ka,Bb){xa=ta.cVg(xa,Pa);xa=ta.vYg(xa,Ka);xa=ta.MWg(xa,Bb);return xa=ta.sYg(xa)}static cVg(xa,Pa){return Pa?c.a.Zm(xa,"build",r.AFrameworkApplication.buildVersion):
xa}static vYg(xa,Pa){if(!Pa)return xa;Pa=Pa.I_;return Pa?xa=c.a.Zm(xa,x.a.sXb,Pa):xa}static MWg(xa,Pa){return ta.iuf(Pa)?c.a.Zm(xa,"officeserverversion",Pa):xa}static sYg(xa){return r.AFrameworkApplication.userSessionId&&""!==r.AFrameworkApplication.userSessionId?c.a.Zm(xa,r.AFrameworkApplication.rGa,r.AFrameworkApplication.userSessionId):xa}static s_f(xa){b.ULS.Q$b();if(xa){xa=xa.split(",");for(const Pa of xa)xa=parseInt(Pa),!isNaN(xa)&&isFinite(xa)&&b.ULS.m6b(xa)}}}ta.pEb="X-bULS-SuppressionETag";
ta.iud="X-bULS-SuppressedTags";ta.Zri="X-bULS-OfficeAppMode";ta.$ri="X-bULS-OfficeAppType";ta.esi="X-bULS-UseSourceMaps";ta.tlf="X-NoUls";ta.Rri="Content-Type";ta.Vsg="CommonUlsTraceEventKey";ta.w5d="TagCallStackInclusionList";ta.MAi="X-InvalidUlsJson";Object(B.a)(ta,"CommonUlsHost",ca,[]);var Ca=a(106);class Ga extends ta{constructor(xa,Pa){super(xa,!1,r.AFrameworkApplication.Wf,Ea.a.instance.Ii("Common.IRefreshableAppSettings")||r.AFrameworkApplication.da,Ea.a.instance.Ii("Common.IRefreshableAppSettings"),
Pa);this.Ihk="usu";this.Fhk="ufu";this.Pd=null;this.Xa=new Ca.a}get $(){this.Pd||(this.Pd=0<N.a.getRegisteredEwaInstances().length?N.a.pv(document.body):null);return this.Pd}AY(xa){1===xa.zFd&&(xa.message="Assert: "+xa.message);super.AY(xa)}aWe(){return!0}MWb(xa,Pa){if(r.AFrameworkApplication.ij&&r.AFrameworkApplication.ura)return!1;let Ka=null;this.$&&(Ka=this.$.pe.xf("UserAction","CommonUlsHostOverrides:UploadLogs"));Pa=!r.AFrameworkApplication.ura&&Pa;xa=super.MWb(xa,Pa);Ka&&Ka.stop();return xa}Txc(xa){super.Txc(xa);
this.Xa.raiseEvent(this.Ihk,xa)}Awc(xa){super.Awc(xa);this.Xa.raiseEvent(this.Fhk,xa)}}Object(B.a)(Ga,"CommonUlsHostOverrides",ta,[449,26,5]);class Oa{$ph(xa,Pa){return new Ga(xa,Pa)}}Object(B.a)(Oa,"CommonHostFactory",null,[463]);var eb=a(66);class nb extends H.a{constructor(xa){super();this.vac=xa;Sys.Application.registerDisposableObject(this)}ttb(xa){this.vac.ttb(xa)}AY(xa){this.vac.AY(xa)}UDb(xa){this.vac.UDb(xa)}dBb(){this.vac.dBb()}static la(xa,Pa=null){const Ka=new D.a;Object(I.a)(nb,r.AFrameworkApplication.zFa)||
(Pa=Pa||new Oa,U.a.Mxi(()=>{var Bb;if(r.AFrameworkApplication.browserUlsIsEnabled){var xb=xa+"/RemoteUls.ashx";nb.$&&(xb=nb.DXg(xb));const Ua=this.Yff();xb=Pa.$ph(xb,Ua);null===(Bb=r.AFrameworkApplication.zFa)||void 0===Bb?void 0:Bb.dispose();r.AFrameworkApplication.zFa=xb;b.ULS.setTraceLevel(50);b.ULS.Z_d(xb);Ka.setResult(new nb(xb))}else b.ULS.disable()},!r.AFrameworkApplication.h_j()));return Ka.task}static DXg(xa){const Pa=this.Yff();return c.a.Zm(xa,"officeserverversion",Pa)}static Yff(){return nb.$?
eb.d(nb.$)?nb.$.workbookContext.BuildVersion:nb.$.xa.BuildVersion:null}static get $(){nb.Pd||(nb.Pd=0<N.a.getRegisteredEwaInstances().length?N.a.pv(document.body):null);return nb.Pd}}nb.Pd=null;Object(B.a)(nb,"EwaUlsHost",H.a,[449,26,5]);class $a extends z.a{constructor(xa){super();this.Mra=xa;this.Oe()}create(){F.TaskExtensions.Aa(nb.la(this.Mra),xa=>{xa=xa.result;y.a.Ip.Va(135,xa);this.ve(xa)},this.ma)}}Object(B.a)($a,"EwaUlsHostFactory",z.a,[]);var oa=a(238),Fa=a(38);class X{constructor(xa){this.Qoe=
null;this.kOi=xa}get fJd(){return this.Qoe||(this.Qoe={})}irj(xa,Pa,Ka){!xa&&Pa.source&&(xa=Fa.a.ft(this.fJd,Pa.source)+1,this.fJd[Pa.source]=xa,xa-1&xa||b.ULS.sendTraceTag(537155536,0,15,`${xa} errors seen for location=${Pa.source}`));Pa.source&&1!==Fa.a.ft(this.fJd,Pa.source,1)||(b.ULS.sendTraceTag(537155535,0,50,"JavaSctipCrashProcessor.ProcessJavascriptError: Sending request to log JavaScript crash in the server"),this.kOi.Vcg(Pa,Ka))}}Object(B.a)(X,"JavaScriptCrashProcessor",null,[202]);var va=
a(78);Type.registerNamespace("_Ewa");Object(w.a)();Type.registerNamespace("Common.App.ContentSecurityPolicy");e.main();Type.registerNamespace("Common.App.Diagnostics");n.main();Type.registerNamespace("DiagUse");y.a.Ip.Va(43,new $a(A.a.current.FB.ServerUriBase));(()=>{try{oa.a.$hf().continueWith(xa=>{try{if(y.a.Ip.Ja(42))b.ULS.sendTraceTag(537155532,0,50,"JavaScriptCrashProcessorBootstrapper: already initialized");else{const Pa=xa.result,Ka=Ea.a.instance.resolve("Common.IJavascriptErrorReporterFactory").build(A.a.current.FB.ServerUriBase+
Pa.LayoutsRelativeUri+"/diagnostics.ashx",Pa.BuildVersion,1,0,!0);y.a.Ip.Va(42,new X(Ka));b.ULS.sendTraceTag(537155533,0,50,"JavaScriptCrashProcessorBootstrapper: initialized and ready to be used")}}catch(Pa){b.ULS.sendTraceTag(537155531,0,15,`JavaScriptCrashProcessorBootstrapper: An exception occured while initializing JavascriptErrorProcessor, Message: ${Pa.message}, Callstack: ${Pa.stack}`)}},3,null,va.a.current)}catch(xa){b.ULS.sendTraceTag(537155530,0,15,`JavaScriptCrashProcessorBootstrapper: an exception occured, Message: ${xa.message}, Callstack: ${xa.stack}`)}})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tmcore.js.map/9565ba3b1d2f027ebbe399d4c40d67ec/EwaTS.tmcore.js.map