'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[20],{1376:function(w,B,a){a.r(B);w=a(519);var b=a(1),c=a(9);B=a(0);var h=a(737),f=a(62),e=a(40),k=a(990);class l extends h.a{constructor(n){super(n)}yg(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.ia,102,this.$.ma,this.$a),n=>{this.vg([new k.FormulaBarCommandHandler(this.$,n.result)])},this.$.ma)}static la(n){h.a.dh(280,new l(n))}}Object(B.a)(l,"FormulaBarCommandHandlerFactory",h.a,[]);var r=a(233),
v=a(6),u=a(897),x=a(53),t=a(740);class m extends r.a{constructor(n){super();this.$=n;this.Oe()}create(){x.a.instance.Kha(v.a.jna);const n=f.GetServiceTaskFactory.je(this.$.ia,388,387,this.$a);e.TaskExtensions.Aa(e.TaskExtensions.Tg([n],this.ma),()=>{this.ve(Object(t.a)(this.$.ia,172,()=>new u.FormulaBar(this.$,n.result)))},this.$.ma,3)}}Object(B.a)(m,"FormulaBarFactory",r.a,[]);w.a.Pk(".ewa-fb{height:20px;background-color:#fff;color:#444;overflow:hidden;padding:10px 8px;position:relative;margin:auto}.grid-visual-refresh .ewa-fb{height:32px;overflow:hidden;padding:0;background-color:#f5f5f5}.ewa-fb-placeholder{color:#bbb}.ewa-root-ltr .ewa-fb{padding-right:4px}.ewa-root-rtl .ewa-fb{padding-left:4px}.ewa-fb-text-box,.ewa-fb-presence-cover{display:inline-block;margin:0 0 0 1px;padding:0;height:18px;width:100%;z-index:101}.ewa-fb-presence-cover{opacity:.2;position:absolute;margin:1px 10px 0 10px}.ewa-fb-text-box,.ewa-fb-text-box-new-theme,.ewa-fb-text-box-monospace-experiment{overflow:hidden;border:1px solid #e6e7e8;outline:none;resize:none;position:relative;flex-grow:1;white-space:pre}.ewa-fb-text-box:focus-within{outline:1px auto}.grid-visual-refresh .ewa-fb-text-box{background-color:#fff;height:18px;line-height:22px;margin:0 0 0 0;top:4px;width:auto;position:relative;padding:2px}.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#fff;height:18px;line-height:18px;margin:0;top:4px;width:auto;position:relative;padding:2px}.ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:18px;overflow:hidden;margin-top:1px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:100%;width:calc(100% - 4px);scrollbar-width:thin;scrollbar-color:#b1b0b0 #fff}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:start{background-color:#fff;height:18px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-button:end{background-color:#fff;height:4px}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:10px;background-color:#b1b0b0}.ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar{width:6px}.ewa-fb-extended .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{overflow-y:auto;overflow-x:hidden}.grid-visual-refresh .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit;height:inherit}.grid-visual-refresh .ewa-fb-text-box.ie .ewa-rteTextElement>.ewa-rteLine{line-height:inherit}.ewa-fb-text-box.ql-container{pointer-events:none}.ewa-fb-text-box .ewa-rteTextElement{pointer-events:all}.ewa-root-ltr .ewa-fb-text-box,.ewa-root-ltr .ewa-fb-presence-cover{left:33px}.ewa-root-ltr .grid-visual-refresh .ewa-fb-text-box{right:4px;left:38px}.ewa-root-rtl .ewa-fb-text-box .ewa-root-rtl .ewa-fb-presence-cover{right:33px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-text-box{right:38px;left:4px}.ewa-fb .functionbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101}.green-fill-paths:hover path{fill:#107c41}.grid-visual-refresh .ewa-fb .functionbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-root-ltr .grid-visual-refresh .ewa-fb .functionbox{margin-right:3px}.ewa-root-rtl .grid-visual-refresh .ewa-fb .functionbox{margin-left:3px}.ewa-fb-presence-cover-internal{height:100%}.ewa-root-ltr .ewa-fb-presence-cover-internal{margin-right:50px}.ewa-root-rtl .ewa-fb-presence-cover-internal{margin-left:50px}.ewa-fb .functionbox .clip13x13{margin:2px 8px 1px 8px}.grid-visual-refresh .ewa-fb .functionbox .clip13x13{margin-top:4px;margin-bottom:4px}.ewa-fb .functionbox:hover .ewaboot_formulabar13{margin-top:-13px}.ewa-root-ltr .ewa-fb.drop-down{padding-left:3px}.ewa-root-rtl .ewa-fb.drop-down{padding-right:3px}.ewa-fb .ok-cancel-buttons-container{position:relative;z-index:101;display:none;flex-flow:row}.ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{display:flex;order:1;height:22px;border:1px solid #e6e7e8;top:4px}.ewa-root-rtl .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-left:3px}.ewa-root-ltr .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{margin-right:3px}.grid-visual-refresh .ewa-fb .ok-cancel-buttons-container{position:relative}.ewa-fb .okbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;margin:0 2px 0 2px;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .okbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb .cancelbox{position:relative;top:10px;width:29px;height:18px;background-color:#fff;border:1px solid #e6e7e8;z-index:101;display:flex;justify-content:center;align-items:center}.grid-visual-refresh .ewa-fb .cancelbox{position:relative;top:4px;height:22px;background-color:#fff}.ewa-fb-nb{display:flex;flex-flow:row}.grid-visual-refresh .ewa-fb-nb{background-color:#f5f5f5;height:32px}.ewa-fb-nb .ewa-fb.drop-down{flex:1 1 auto}.grid-visual-refresh .ewa-fb-nb .ewa-fb.drop-down{right:0;height:32px;display:flex;flex-flow:row}.ewa-fb-name-box-placeholder{position:relative;width:118px;float:left;display:block;overflow:hidden;height:20px;background-color:#fff;padding:2px;align-self:center;margin:0 0 0 4px}.ewa-root-rtl .ewa-fb-name-box-placeholder{float:right;margin:0 4px 0 0}.button-disabled{pointer-events:none;background-color:#f0f0f0 !important}.ewa-fb-extended .ewa-fb-expand-button-img{transform:rotate(180deg)}.ewa-fb-expand-button-container{padding-top:3px;position:absolute;z-index:102}.ewa-root-ltr .ewa-fb-expand-button-container{padding-right:7px;right:0}.ewa-root-rtl .ewa-fb-expand-button-container{padding-left:7px;left:0}.ewa-fb-text-div-container{width:100%;position:relative}.ewa-fb-refactor .ewa-fb-text-div-container{order:2}body.ewa-fb-drag-resize *{cursor:inherit !important}body.ewa-fb-drag-resize{cursor:ns-resize}.ewa-fb-drag-handler{position:absolute;height:6px;width:100%;cursor:ns-resize;z-index:102;bottom:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.ewa-fb-text-box-new{height:calc(100% - 8px);box-sizing:border-box;width:100%}.grid-visual-refresh .ewa-fb-refactor.ewa-fb-nb .ewa-fb.drop-down{height:inherit}.grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{height:auto;overflow:hidden;white-space:pre-wrap}.ewa-root-ltr .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:20px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-refactor .ewa-fb-text-box.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:20px}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .functionbox{top:0;order:2;border:none;margin:0}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .okbox{top:0;margin:0;border:none;order:1}.grid-visual-refresh .ewa-fb-refactor .ewa-fb .cancelbox{top:0;border:none;order:0}.ewr-presentMode-on .ewa-fb{color:#f3f2f1}.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#3c3c3c;border:1px solid #3c3c3c;border-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.grid-visual-refresh .ewa-fb-nb{background-color:#323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb,.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb-nb{background-color:#000 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .functionbox{background-color:#323130;border:1px solid #323130}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .functionbox{background-color:#000 !important;border:1px solid #000 !important}.ewr-presentMode-on .green-fill-paths:hover path{fill:#37a660}.ewr-presentMode-on .ewa-fb-refactor .ewa-fb .ok-cancel-buttons-container{border:none}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on .ewa-fb .okbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .okbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on .ewa-fb .cancelbox{background-color:#3c3c3c;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on.ewr-namedsheetview.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-on.ewr-namedsheetview .ewa-fb .cancelbox{background-color:#292827 !important;border:1px solid #292827 !important}.ewr-presentMode-on .ewa-fb-expand-button-img{fill:#e1dfdd}.ewr-presentMode-on .ql-editor *::selection{background-color:#605e5c}.ewr-presentMode-on .functionbox.button-disabled{background-color:#323130 !important}.ewr-presentMode-on .ewa-fb-function-button-img{fill:#e1dfdd}.ewr-presentMode-on .functionbox.button-disabled .ewa-fb-function-button-img{fill:#8a8886 !important}.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-text-box.ewa-fb-text-box-new,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .functionbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .okbox,.ewr-presentMode-transition .ewa-fb .okbox,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb .cancelbox,.ewr-presentMode-transition .ewa-fb .cancelbox{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb,.ewr-presentMode-transition.grid-visual-refresh .ewa-fb-nb,.ewr-presentMode-transition .functionbox.button-disabled{transition:background-color .4s linear,color .4s linear}.ewa-fb-nb.ewa-fb-refactor.ewa-fb-fluent{height:24px;background-color:#f5f5f5;color:#444;overflow:hidden;padding:4px 8px;position:relative;margin:0;gap:8px;flex-flow:row}.ewa-fb-fluent .ewa-fb.drop-down{flex-flow:row;gap:8px;padding-left:0;padding-right:0}.ewa-fb-fluent .ewa-fb.drop-down .ok-cancel-buttons-container{display:flex;width:66px;border:1px solid #d1d1d1;border-radius:4px;flex-flow:row;top:0;margin:0}.ewa-fb-fluent .functionbox{display:flex;align-items:center;justify-content:center}.ewa-root-ltr .ewa-fb-fluent .functionbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-root-rtl .ewa-fb-fluent .functionbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-ltr .ewa-fb-fluent .cancelbox{border-top-left-radius:4px;border-bottom-left-radius:4px}.ewa-root-rtl .ewa-fb-fluent .cancelbox{border-top-right-radius:4px;border-bottom-right-radius:4px}.ewa-fb-fluent .cancelbox:hover,.ewa-fb-fluent .okbox:hover,.ewa-fb-fluent .functionbox:hover,.ewa-fb-fluent .ewa-fb-expand-button-container:hover{background-color:#f5f5f5}.ewa-fb-fluent .cancelbox:focus,.ewa-fb-fluent .okbox:focus,.ewa-fb-fluent .functionbox:focus,.ewa-fb-fluent .ewa-fb-expand-button-container:focus{background-color:#e0e0e0}.ewa-fb-fluent .cancelbox.button-disabled,.ewa-fb-fluent .okbox.button-disabled,.ewa-fb-fluent .functionbox.button-disabled{pointer-events:none;background-color:#fff !important}.ewa-fb-fluent .cancelbox.button-disabled path,.ewa-fb-fluent .okbox.button-disabled path,.ewa-fb-fluent .functionbox.button-disabled path{fill:#bdbdbd}.ewa-fb-fluent .ewa-fb-text-div-container{display:flex;border-radius:4px;flex-flow:column}.ewa-fb-fluent .ewa-fb-expand-button-container{order:1;height:20px;width:20px;border-radius:4px;flex-grow:0;padding:0}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 4px 0 0}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-expand-button-container{margin:2px 0 0 4px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new{border:1px solid #d1d1d1;border-radius:4px;top:0;line-height:16px;padding:3px 0 5px 0;color:#242424}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-right:4px}.ewa-root-ltr .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie.no-scrollbar-gutter-support .ewa-rteTextElement>.ewa-rteLine{padding-right:10px}.ewa-root-rtl .ewa-fb-refactor.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new.not-ie .ewa-rteTextElement>.ewa-rteLine{padding-left:12px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement>.ewa-rteLine{cursor:text}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{height:calc(100% - 4px);width:calc(100% - 22px);margin-top:2px;scrollbar-gutter:stable;cursor:default}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement::-webkit-scrollbar-thumb{border-radius:4px;background-color:#808080;background-clip:padding-box}.ewa-root-ltr .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 8px}.ewa-root-rtl .ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new .ewa-rteTextElement{padding:0 4px 0 14px}.ewa-fb-fluent .ewa-fb-text-box.ewa-fb-text-box-new:focus-within{outline:none;border-bottom:2px solid #107c41}.ewa-fb-fluent .ql-editor *::selection{background:#616161;color:#fff}.ewa-fb-nb-fix{flex:0 0 auto !important}.ewa-fb-nb .cui-cb{flex:0 1 auto;align-self:center;z-index:101}.ewa-fb-refactor.ewa-fb-nb .cui-cb{align-self:baseline;top:4px}@media screen and (-ms-high-contrast:active){.ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button path,.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button .ewa-svg-icon path,.ewa-fb-nb .cui-cb-focus .cui-dd-arrow-button .ewa-svg-icon path{fill:HighlightText}.ewa-fb-nb .cui-cb .cui-cb-input{border-color:WindowText;background-color:Window !important}.ewa-fb-nb .cui-fa-dropped .cui-dd-arrow-button{background-color:Highlight}.ewa-fb-nb .cui-dd-arrow-button .ewa-svg-icon path{fill:ButtonText}}.ewa-root-ltr .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 0 0 4px}.ewa-root-rtl .grid-visual-refresh .ewa-fb-nb .cui-cb{position:relative;margin:0 4px 0 0}.ewa-fb-nb .cui-cb-input{height:14px;font-size:14.7px;font-family:Calibri}.grid-visual-refresh .ewa-fb-nb .cui-cb-input{height:18px}.ewa-fb-nb .cui-dd-arrow-button{height:18px;background-color:#fff}.grid-visual-refresh .ewa-fb-nb .cui-dd-arrow-button{height:18px;padding-top:2px;padding-bottom:2px}.ewr-presentMode-on .ewa-fb-nb .cui-cb-input{background-color:#3c3c3c;color:#f3f2f1;border:1px solid #3c3c3c;border-top-left-radius:2px;border-bottom-left-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-cb-input{background-color:#3c3c3c !important;border:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-cb-input{border-color:#37a660 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-cb-input{background-color:#292827;border:1px solid #292827}.ewr-presentMode-on .ewa-fb-nb .cui-dd-arrow-button{background-color:#3c3c3c;border-top:1px solid #3c3c3c;border-right:1px solid #3c3c3c;border-bottom:1px solid #3c3c3c;border-top-right-radius:2px;border-bottom-right-radius:2px}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{background-color:#3c3c3c !important;border-top:1px solid #3c3c3c !important;border-right:1px solid #3c3c3c !important;border-bottom:1px solid #3c3c3c !important}.ewr-presentMode-on .ewa-fb-nb .cui-cb:hover .cui-dd-arrow-button{border-color:#37a660 !important}.ewr-presentMode-on .ewa-fb-nb-dropdown-button-img{fill:#e1dfdd}.ewr-presentMode-on .ewa-fb-nb .cui-disabled .cui-dd-arrow-button .ewa-fb-nb-dropdown-button-img{fill:#8a8886 !important}.ewr-presentMode-on.ewr-namedsheetview .ewa-fb-nb .cui-dd-arrow-button{background-color:#292827;border-top:1px solid #292827;border-right:1px solid #292827;border-bottom:1px solid #292827}#presentModeNamedObjectsMenu{z-index:1056 !important;background-color:#3c3c3c !important;border:1px solid #323130 !important}#presentModeNamedObjectsMenu .cui-ctl-mediumlabel{color:#e1dfdd !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover .cui-ctl-mediumlabel,#presentModeNamedObjectsMenu .cui-ctl-menu:focus .cui-ctl-mediumlabel{color:#f3f2f1 !important}#presentModeNamedObjectsMenu .cui-ctl-menu:hover,#presentModeNamedObjectsMenu .cui-ctl-menu:focus{background-color:#484644 !important;border-color:#484644 !important}.ewr-presentMode-transition .ewa-fb-nb .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-cb-input,.ewr-presentMode-transition .ewa-fb-nb .cui-dd-arrow-button,.ewr-presentMode-transition .ewa-fb-nb .cui-disabled .cui-dd-arrow-button{transition:background-color .4s linear,color .4s linear}");
(()=>{c.a.Ia(n=>{n.ia.Va(186,new m(n));b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateFormulaBarCommandHandler",!1)||l.la(n)})})();String(k);window.___1692616129318_closurehack=k},897:function(w,B,a){a.r(B);w=a(0);var b=a(16),c=a(92),h=a(5),f=a(121),e=a(15),k=a(96),l=a(731),r=a(30),v=a(374),u=a(67),x=a(151),t=a(89);class m{}m.$Kh="ewa-fb";m.fLh="ewa-fb-placeholder";m.gLh="ewa-fb-text-box";m.jLh="ewa-fb-text-box-new-theme";m.hLh="ewa-fb-text-box-monospace-experiment";m.iLh="ewa-fb-text-box-new";
m.p0e="ewa-fb-refactor";m.n0e="ewa-fb-extended";m.g2i="not-ie";m.e8e="functionbox";m.tmi="green-fill-paths";m.HT="drop-down";m.Pvc="ok-cancel-buttons-container";m.GJf="okbox";m.YJe="cancelbox";m.o0e="ewa-fb-nb";m.eLh="ewa-fb-name-box-placeholder";m.Pwa="button-disabled";m.cLh="ewa-fb-expand-button-img";m.bLh="ewa-fb-expand-button-container";m.kLh="ewa-fb-text-div-container";m.m0e="ewa-fb-drag-resize";m.aLh="ewa-fb-drag-handler";m.dLh="ewa-fb-fluent";m.P1i="no-scrollbar-gutter-support";m.h1e="ewa-svg-icon";
m.C1="cui-disabled";Object(w.a)(m,"CssClassNames",null,[]);var n=a(6),A=a(277),y=a(633),z=a(631),F=a(489),D=a(170),I=a(145),H=a(82),N=a(100);class U extends N.a{constructor(ba,ua,R,Y,La,Ma){super(ba);this.XQ=()=>{this.domElement.disabled||(this.qac.className=this.Zcc+" "+this.KGf)};this.WQ=()=>{this.domElement.disabled||(this.qac.className=this.Zcc+" "+this.K_i)};this.nQf=lb=>{if(!this.domElement.disabled){const pb=lb.keyCode;if("mousedown"===lb.type||13===pb||32===pb)this.qac.className=this.Zcc+
" "+this.kqj}};this.oQf=()=>{this.domElement.disabled||(this.qac.className=this.Zcc+" "+this.KGf)};this.Zcc=R;this.KGf=Y;this.K_i=La;this.kqj=Ma;this.uf.la("mouseover",this.XQ);this.uf.la("mouseout",this.WQ);this.uf.la("focus",this.XQ);this.uf.la("blur",this.WQ);this.uf.la("mousedown",this.nQf);this.uf.la("keydown",this.nQf);this.uf.la("mouseup",this.oQf);this.uf.la("keyup",this.oQf);this.qac=ua}}Object(w.a)(U,"PseudoClassBehavior",N.a,[]);var L=a(14);class J extends H.a{constructor(ba){super();this.Jwd=
[];this.$=ba}dispose(){k.a.df(this.Jwd);this.Jwd.length=0;this.$=null;super.dispose()}u8b(ba,ua,R,Y,La){const Ma=L.DOMElementExtensions.getElementById(this.$.domElement,this.$.He+ba);ba=ba===ua?Ma:L.DOMElementExtensions.getElementById(this.$.domElement,this.$.He+ua);if(!Ma)return null;R=new U(Ma,ba,R,Y,"",La);this.Jwd.push(R);return R}}J.Rbh="ewa-menu-btn-hover";J.Tbh="ewa-menu-btn-pressed";Object(w.a)(J,"InitializePseudoClasses",H.a,[]);var P=a(29),K=a(261),ca=a(204),T=a(161),Q=a(40),fa=a(20);class ha{constructor(ba,
ua){this.$=ba;this.gf=ua;A.a(this.$).um(this)}get Df(){return this.gf.Ha.sh}get uk(){return fa.h(this.$).Kd&&fa.h(this.$).Ls}get Zg(){return K.a.z7e}nl(ba,ua){ua||L.DOMElementExtensions.setFocus(this.Df);return!ua}Il(ba){return L.DOMElementExtensions.Sj(this.Df,ba)}Vn(){}ap(){}dispose(){A.a(this.$).bD(this)}}Object(w.a)(ha,"FormulaBarFocusManager",null,[57,5]);var Ea=a(235),ra=a(251),Z=a(18),wa=a(54),la=a(91),ta=a(750),Ca=a(173),Ga=a(1);class Oa extends H.a{constructor(ba=null,ua,R,Y=null){super();
this.FUa=this.M$a=this.B8a=this.eAc=null;this.qmd=P.a.oB()?16:13;this.rmd=P.a.oB()?16:13;this.MNf=()=>{const La=new la.a(753860909,2,this.$.Ie,2,null);this.$.Ga.Sd(La);return!0};this.NNf=La=>La.Da.keyCode===c.a.tn?(La=new la.a(753860909,1,this.$.Ie,2,null),this.$.Ga.Sd(La),!0):!1;this.ONf=()=>{if(this.gridView.Kd){const La=this.gridView.il;Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7561900_InsertFunctionPositionBugFix")?La.Ha.P8b():La.Ha.mI=!0}return!1};this.$=R;this.gridView=fa.h(R);this.qn=ua;
this.svgIconProvider=Y;P.a.oB()?this.B8a=L.DOMElementExtensions.getElementById(this.$.domElement,this.$.He+n.a.sBb):(this.rZh=ua.ha(1035),this.eAc=ba.u8b(n.a.sBb,n.a.sBb,m.e8e+" "+m.HT,m.tmi,""),this.B8a=this.eAc.domElement);this.Kvi(this.B8a)}Kvi(ba){Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8026743_insertFunctionButtonTooltipEnabled")&&(ba.role="button",ba.title=this.qn.ha(1035));this.M$a=this.svgIconProvider?this.svgIconProvider.ffa(ta.a.qZh,this.qmd,this.rmd,ba,void 0,void 0,void 0,this.qn.ha(1035)):
Ca.createClusteredImageFromClusterWithImageClass(this.rmd,this.qmd,Z.a.RNh,wa.a.Bj(0),null,null,!0,this.qn.ha(1035));ba.appendChild(this.M$a);Ea.a.instance.va(e.a.click,ba,this.MNf);f.KeyInputManager.instance.va(e.a.Ne,ba,this.NNf);ra.a.instance.va(e.a.Cf,ba,this.ONf)}dispose(){this.d8d(this.B8a);this.B8a=null;P.a.oB()||(k.a.Ma(this.eAc),this.eAc=null);L.DOMElementExtensions.xi(this.M$a);this.FUa=this.M$a=null;super.dispose()}d8d(ba){ba&&(Ea.a.instance.Ca(e.a.click,ba,this.MNf),f.KeyInputManager.instance.Ca(e.a.Ne,
ba,this.NNf),ra.a.instance.Ca(e.a.Cf,ba,this.ONf))}dlk(ba){!this.FUa&&this.svgIconProvider&&(this.FUa=this.svgIconProvider.ffa(ta.a.xZh,this.qmd,this.rmd,this.B8a,void 0,void 0,void 0,this.rZh))&&this.FUa.classList.add("ewa-fb-function-button-img");this.M$a&&this.FUa&&(L.DOMElementExtensions.setVisible(this.M$a,!ba),L.DOMElementExtensions.setVisible(this.FUa,ba))}}Object(w.a)(Oa,"FormulaBarFunctionControl",H.a,[]);var eb=a(183),nb=a(175),$a=a(47),oa=a(8),Fa=a(166),X=a(150),va=a(11);const xa=P.a.oB()?
1:2;class Pa{constructor(ba){this.iya=this.Mma=this.Zya=this.HSc=this.GSc=this.FSc=null;this.Nqc=this.vyd=this.f3=!1;this.BIe=this.o9f=0;this.xpb=P.a.oB()?16:0;this.Qre=0;this.Nhc=P.a.oB()?24:Fa.c;this.zwc=ua=>{this.g4e();ua.Da.rawEvent.preventDefault();return!0};this.vwc=ua=>{this.vyd=!0;this.o9f=ua.clientPoint.y;document.body.classList.add(m.m0e);this.f3||(this.SVa=0);this.d7a.la("mousemove",this.IMf,!0);this.d7a.la("touchmove",this.IMf);this.d7a.la("mouseup",this.TKd);this.d7a.la("touchend",this.TKd);
this.d7a.la("mouseleave",this.TKd);return!0};this.TKd=()=>{this.vyd=!1;this.SVa=P.a.oB()?this.f3?this.Zya.clientHeight-this.Nhc:0:this.Tr.clientHeight-this.Nhc;document.body.classList.remove(m.m0e);this.d7a.VH();b.ULS.sendTraceTag(575426571,0,50,`FormulaBarResizeControl.OnDragHandlerResizeEnd formula bar drag resized to: ${this.Tr.clientHeight} pixel`)};this.IMf=ua=>{this.vyd?(ua=va.HelperMethods.Kic(ua).y,ua=this.ydf(this.SVa+Math.min(ua,this.$.domElement.clientHeight-75)-this.o9f),this.f3=ua>=this.lineHeight,
L.DOMElementExtensions.toggleCssClass(this.Tr,m.n0e,this.f3),ua=this.Nhc+Math.round(Math.max(ua-xa,0)),(P.a.oB()?this.Zya.clientHeight:this.Tr.clientHeight)!==ua&&(this.Tr.style.height=ua+"px",this.$.RVa())):b.ULS.shipAssertTag(537161935,0,!1,"FormulaBarResizeControl.OnDragHandlerResize: reached OnDragHandlerResize with isDuringResize false")};this.ZQ=ua=>{this.f3&&(this.nOa=Math.round((Math.round(this.nOa/this.lineHeight)+(0<ua.ota?1:-1))*this.lineHeight));ua.Da.preventDefault();return!1};this.t$=
()=>{this.LIj();this.Nqc&&(eb.a.instance.Ca(e.a.tL,document.body,this.t$),eb.a.instance.Ca(e.a.lCa,document.body,this.t$),nb.a.instance.Ca(e.a.Wg,document.body,this.t$),this.Nqc=!1);return!1};this.gh=()=>{this.nOa=0};this.rZ=ua=>{this.Nqc||(eb.a.instance.va(e.a.tL,document.body,this.t$),eb.a.instance.va(e.a.lCa,document.body,this.t$),nb.a.instance.va(e.a.Wg,document.body,this.t$),this.Nqc=!0);ua.preventDefault()};this.jhj=ua=>{this.nOa=this.BIe;ua.preventDefault()};this.$=ba;this.d7a=X.a.instance.AMa(document.body.ownerDocument)}get lineHeight(){return this.xpb?
this.xpb:oa.a.B7e}set lineHeight(ba){this.xpb=ba}get Tr(){const {FormulaBar:ba}=a(897);this.FSc||(this.FSc=ba.sjc(this.$));return this.FSc}get Ohc(){this.GSc||(this.GSc=document.getElementById(n.a.tBb));return this.GSc}get vea(){this.HSc||(this.HSc=document.getElementById(n.a.tBb+"_"+n.a.pJc));return this.HSc}get nOa(){return this.vea.scrollTop}set nOa(ba){this.BIe=ba;this.vea.scrollTop!==ba&&(this.vea.scrollTop=ba)}get wYh(){return 2*this.lineHeight-xa}get SVa(){return this.Qre}set SVa(ba){this.Qre=
ba}g4e(){this.f3=!this.f3;L.DOMElementExtensions.toggleCssClass(this.Tr,m.n0e,this.f3);this.f3&&!this.SVa&&(this.SVa=this.wYh);this.Tr.style.height=this.Nhc+(this.f3?this.SVa:0)+"px";this.Mma.setAttribute(n.a.nx,this.f3?"Collapse the formula bar":"Expand the formula bar");this.$.RVa();b.ULS.sendTraceTag(575426572,0,50,`FormulaBarResizeControl.OnExpandButtonClick formula bar ${this.f3?"expanded":"collapsed"}`)}gvh(ba){this.Zya=document.createElement("div");this.Zya.id=this.$.He+n.a.E7e;this.Zya.className=
m.kLh;this.Mma=Pa.orh(this.$.He,ba);this.Zya.appendChild(this.Mma);this.iya=Pa.Mqh(this.$.He);this.Zya.appendChild(this.iya);return this.Zya}Qzj(){eb.a.instance.va(e.a.$r,this.Mma,this.zwc);nb.a.instance.va(e.a.ji,this.Mma,this.zwc);eb.a.instance.va(e.a.$r,this.iya,this.vwc);nb.a.instance.va(e.a.ji,this.iya,this.vwc)}Tzj(){eb.a.instance.va(e.a.yG,this.Ohc,this.ZQ);$a.a.addHandler(this.vea,e.a.scroll,this.rZ);$a.a.addHandler(this.vea,e.a.focus,this.jhj);fa.h(this.$).ga.add_activeCellChanged(this.gh)}Rik(){void 0!==
this.Mma&&null!==this.Mma&&(eb.a.instance.Ca(e.a.$r,this.Mma,this.zwc),nb.a.instance.Ca(e.a.ji,this.Mma,this.zwc));void 0!==this.iya&&null!==this.iya&&(eb.a.instance.Ca(e.a.$r,this.iya,this.vwc),nb.a.instance.Ca(e.a.ji,this.iya,this.vwc));void 0!==this.Ohc&&null!==this.Ohc&&eb.a.instance.Ca(e.a.yG,this.Ohc,this.ZQ);fa.h(this.$).ga.remove_activeCellChanged(this.gh)}LIj(){this.nOa=Math.round(this.ydf(this.nOa))}ydf(ba){return Math.round(ba/this.lineHeight)*this.lineHeight}static orh(ba,ua){const R=
document.createElement("a");R.id=ba+n.a.zYh;R.classList.add(m.bLh);L.DOMElementExtensions.KB(R,n.a.xA);R.setAttribute(n.a.nx,"Expand the formula bar");ua.ffa(ta.a.Gkh,12,12,R,P.a.oB()?20:null,P.a.oB()?20:null).classList.add(m.cLh);return R}static Mqh(ba){const ua=document.createElement("div");ua.id=ba+n.a.xYh;ua.className=m.aLh;return ua}}Object(w.a)(Pa,"FormulaBarResizeControl",null,[]);N=a(250);var Ka=a(45),Bb=a(1006),xb=a(191),Ua=a(113),Jb=a(46),fc=a(1088);class ya{}ya.disabled="disabled";ya.z7j=
"stale";ya.eqj="presentationMode";Object(w.a)(ya,"NameBoxStateUpdateKey",null,[]);class ob extends N.a{constructor(ba,ua){super(document.createElement("div"));this.Nh=null;this.ufk=()=>{this.$.Ga.PDb("PopulateNameBoxMenu",{menuId:"NameBox"})};this.mLd=()=>{var R=this.gridView.ga;const Y=R.ra.ZDb()?R.ra.Oyb:R.ra.activeRange;R=Y.isSingle?R.ra.activeCell.toString():Y.mfi();this.xO(R)};this.Em=(R,Y)=>{this.eha(R,Y);this.vSb(R,Y)};this.vSb=()=>{let R=fc.c(this.$,this.gridView);Bb.c(R,!0)||(this.Nh&&(R=
this.$.ue.getItemByName(this.Nh))&&R.deactivate(),this.xO(this.gridView.ga.ra.activeCell.toString()))};this.VLb=(R,Y)=>{var La,Ma;if((R=Y.pa)&&(!Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8137505_AvoidViewportJumpWhenScrollingNamedObject")||(null===(La=Y.ZC)||void 0===La?void 0:La.name)!==(null===(Ma=Y.pa)||void 0===Ma?void 0:Ma.name))){La=R.usedRange;2===R.type&&(La=xb.a(R));Ma=this.gridView.ga.ra.Zj;var lb=this.gridView.inRangePicker||this.gridView.Al,pb=!1;2===R.type&&Ma&&!lb&&(Ma=this.gridView.ga.ra.activeRange,
pb=R.sheetName===this.$.ta.pa.name&&!!Ma&&Ma.top===La.top&&Ma.left===La.left&&Ma.bottom===La.bottom&&Ma.right===La.right);La=Ka.v(La,this.$),La.NamedObjectName=R.name,La.SheetName=R.sheetName,this.gridView.Wj(La,null,null,null,60,"EditableNamedObjectsDropdownList.OnActiveNamedObjectChanged",0,!0,!0,null,Y.disableAutoFocusOnGrid);Y=Bb.a(R.name);this.xO(Y.name,Y.fullName)}};this.Qq=()=>{const R=fc.b(this.gridView);null!=R&&this.xO(R.name)};this.ENf=(R,Y)=>{this.mLd(R,Y)};this.rj=()=>{this.O6a(!1)};
this.fDa=()=>{this.O6a(!0)};this.eDa=()=>{this.O6a(!1)};this.Hz=()=>{this.O6a(!this.$.isEditMode)};this.$Q=(R,Y)=>{this.O6a(Y.HS?!0:!this.$.isEditMode)};this.onKeyDown=R=>R.Da.keyCode===c.a.tGa?(this.gridView.focus(),!0):!1;this.eha=()=>{this.d9d({[ya.z7j]:!0})};this.$=ba;this.gridView=fa.h(ba);this.e$g(ua)&&(this.xO(this.gridView.ga.ra.activeCell.toString()),this.O6a(Jb.a(this.$).Wr()||!this.$.isEditMode),this.Zk(),f.KeyInputManager.instance.va(e.a.Ne,this.domElement,this.onKeyDown.bind(this)))}dispose(){this.$&&
(this.$.Rd.NUd(this.fDa.bind(this)),this.$.Rd.MUd(this.eDa.bind(this)),this.$.ea.r4(this.Hz.bind(this)),Ua.a(this.$).WBc(this.ENf.bind(this)),Ua.a(this.$).zUd(this.Qq.bind(this)),Jb.a(this.$).Pi.lra(this.$Q.bind(this)),this.$.ue&&(this.$.ue.dk(this.VLb.bind(this)),this.$.ue.$Bc(this.vSb.bind(this)),this.$.ue.$Bc(this.W2f.bind(this)),this.$.ue.Z$(this.eha.bind(this)),this.$.ue.jra(this.eha.bind(this)),this.$.ue.kra(this.eha.bind(this)),this.$.ue.fQb(this.eha.bind(this))),this.$.ta&&this.$.ta.dk(this.Em.bind(this)));
if(this.gridView){const ba=this.gridView.ga;ba.aaa(this.vSb.bind(this));ba.s4(this.mLd.bind(this));ba.Ta.pR(this.Qq.bind(this))}super.dispose()}blk(ba){this.d9d({[ya.eqj]:ba})}e$g(ba){const ua=document.getElementById(this.$.He+n.a.C7e);void 0!==ua&&null!==ua&&ba.removeChild(ua);appChrome.renderNameBoxUI(this.domElement,this.ufk.bind(this));ba.insertBefore(this.domElement,ba.firstChild);return!0}Zk(){this.$.Rd.U4c(this.fDa.bind(this));this.$.Rd.T4c(this.eDa.bind(this));this.$.ea.U0(this.Hz.bind(this));
const ba=this.gridView.ga;this.$.ue.zj(this.VLb.bind(this));this.$.ta.zj(this.Em.bind(this));ba.Ska(this.vSb.bind(this));ba.W0(this.mLd.bind(this));ba.Ta.cK(this.Qq.bind(this));Ua.a(this.$).G4c(this.Qq.bind(this));Ua.a(this.$).y6b(this.ENf.bind(this));Jb.a(this.$).Pi.Rka(this.$Q.bind(this));this.$.ue.B6b(this.vSb.bind(this));this.$.ue.B6b(this.W2f.bind(this));this.$.ue.V0(this.eha.bind(this));this.$.ue.Oka(this.eha.bind(this));this.$.ue.Pka(this.eha.bind(this));this.$.ue.X2a(this.eha.bind(this))}xO(ba,
ua=""){this.Nh=""!==ua?ua:this.Nh;appChrome.setNamedObjectOrActiveCellRange(ua,ba)}O6a(ba){this.d9d({[ya.disabled]:ba})}W2f(ba,ua){fc.a(this.$,!0);this.eha(ba,ua)}d9d(ba){appChrome.updateNameBoxState(ba)}}Object(w.a)(ob,"NameBox",N.a,[5]);var Sb=a(188);const Ba=m.GJf+" "+m.HT,Ia=m.YJe+" "+m.HT;class cb extends H.a{constructor(ba=null,ua,R,Y){super();this.Tvb=this.SLb=this.Uvb=this.TLb=this.IP=this.PQ=null;this.aL=this.yqc=!1;this.O3f=()=>{this.gridView.ZM.Yp(this.sj);this.gridView.ZM.yq(this.rj);
this.yqc=!0};this.sj=()=>{this.AGb?this.Dqg(!0):this.Pvc.style.display="flex"};this.rj=()=>{this.AGb?this.Dqg(!1):this.Pvc.style.display="none"};this.PQf=Ma=>this.dwc(!0,`OkCancelEditControl.OnOkClick: ${Ma.de}`,va.HelperMethods.qu(Ma));this.QQf=Ma=>this.dwc(!0,`OkCancelEditControl.OnOkKeyDown: ${Ma.de}`);this.VKf=Ma=>this.dwc(!1,`OkCancelEditControl.OnCancelClick: ${Ma.de}`,va.HelperMethods.qu(Ma));this.YKf=Ma=>this.dwc(!1,`OkCancelEditControl.OnCancelKeyDown: ${Ma.de}`);this.onPointerDown=()=>{this.gridView.Kd&&
(this.gridView.il.Ha.mI=!0);return!1};const {FormulaBar:La}=a(897);this.$=R;this.gridView=fa.h(R);this.aL=P.a.aL();this.Pvc=cb.Wci(R);this.AGb=P.a.Uoa();Y?(this.TLb=Y.APa(ta.a.pLe,16),this.Uvb=Y.APa(ta.a.Vyh,16),this.AGb&&!P.a.oB()&&(this.SLb=Y.APa(ta.a.$gh,16),this.Tvb=Y.APa(ta.a.Wyh,16),this.TLb.style.display="none",this.Uvb.style.display="none")):(this.TLb=Ca.createClusteredImageFromClusterWithImageClass(16,16,Z.a.JNh,wa.a.Bj(1),null,null,!0,ua.ha(1041)),this.Uvb=Ca.createClusteredImageFromClusterWithImageClass(16,
16,Z.a.LNh,wa.a.Bj(1),null,null,!0,ua.ha(1042)));P.a.oB()?(this.PQ=L.DOMElementExtensions.getElementById(this.$.domElement,this.$.He+La.Ovc),this.IP=L.DOMElementExtensions.getElementById(this.$.domElement,this.$.He+La.R9b)):(this.XJd=ba.u8b(La.Ovc,La.Ovc,Ba,"",""),this.PQ=this.XJd.domElement,this.s9c=ba.u8b(La.R9b,La.R9b,Ia,"",""),this.IP=this.s9c.domElement);this.PQ.appendChild(this.TLb);this.IP.appendChild(this.Uvb);this.AGb&&(P.a.oB()?(this.PQ.classList.add(m.Pwa),this.IP.classList.add(m.Pwa)):
(this.PQ.appendChild(this.SLb),this.IP.appendChild(this.Tvb)));this.gridView.cellTextEditBox.Yp(this.sj);this.gridView.cellTextEditBox.yq(this.rj);Ea.a.instance.va(e.a.click,this.PQ,this.PQf);f.KeyInputManager.instance.va(e.a.Ne,this.PQ,this.QQf);ra.a.instance.va(e.a.Cf,this.PQ,this.onPointerDown);Ea.a.instance.va(e.a.click,this.IP,this.VKf);f.KeyInputManager.instance.va(e.a.Ne,this.IP,this.YKf);ra.a.instance.va(e.a.Cf,this.IP,this.onPointerDown);this.aL&&this.gridView.zZg(this.O3f)}dispose(){this.gridView&&
this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.Qp(this.sj),this.gridView.cellTextEditBox.Pp(this.rj));this.gridView&&this.aL&&(this.gridView.XCj(this.O3f),this.yqc&&(this.gridView.ZM.Qp(this.sj),this.gridView.ZM.Pp(this.rj),this.yqc=!1));this.PQ&&(Ea.a.instance.Ca(e.a.click,this.PQ,this.PQf),f.KeyInputManager.instance.Ca(e.a.Ne,this.PQ,this.QQf),ra.a.instance.Ca(e.a.Cf,this.PQ,this.onPointerDown),this.PQ=null);this.IP&&(Ea.a.instance.Ca(e.a.click,this.IP,this.VKf),f.KeyInputManager.instance.Ca(e.a.Ne,
this.IP,this.YKf),ra.a.instance.Ca(e.a.Cf,this.IP,this.onPointerDown),this.IP=null);P.a.oB()||(k.a.Ma(this.XJd),this.XJd=null,k.a.Ma(this.s9c),this.s9c=null);this.AGb&&!P.a.oB()&&(L.DOMElementExtensions.xi(this.Tvb),this.Tvb=null,L.DOMElementExtensions.xi(this.SLb),this.SLb=null);super.dispose()}dwc(ba,ua,R=null){const Y=this.gridView.il;if(R){const La=this.gridView.Ls?"formulaBar_end_edit_ok_cancel_btn":"cell_text_end_edit_ok_cancel_btn";let Ma;Ma=[Object(Sb.a)(this.gridView.cellTextEditBox.Ha.xFa)];
Sb.b(this.$).OFa(R.rawEvent,La,Ma)}this.yqc&&this.gridView.ZM.PH?this.gridView.ZM.endEdit(ba,ua,0):Y.endEdit(ba,ua,0);this.gridView.focus();return!0}Dqg(ba){if(P.a.oB())ba?(this.PQ.classList.remove(m.Pwa),this.IP.classList.remove(m.Pwa)):(this.PQ.classList.add(m.Pwa),this.IP.classList.add(m.Pwa));else{const ua=ba?"block":"none";ba=ba?"none":"block";this.TLb.style.display=ua;this.Uvb.style.display=ua;this.SLb.style.display=ba;this.Tvb.style.display=ba}}static Wci(ba){const {FormulaBar:ua}=a(897);return document.getElementById(ba.He+
ua.FJf)}}Object(w.a)(cb,"OkCancelEditControl",H.a,[]);var Kb=a(298),db=a(275),gb=a(77),yb=a(199),Nb=a(12),qc=a(264),Gb=a(206),hb=a(297),qb=a(146),ab=a(164),Mb=a(53),Ib=a(325),fb=a(283),Db=a(168),Za;(function(ba){ba[ba.loaded=0]="loaded";ba[ba.error=1]="error";ba[ba.loading=2]="loading";ba[ba.unloaded=3]="unloaded";ba[ba.missing=4]="missing";ba[ba.undefined=5]="undefined";ba[ba.unexpected=6]="unexpected"})(Za||(Za={}));Object(w.b)("LoadStatus",Za);a.d(B,"FormulaBar",function(){return sb});class sb extends v.a{constructor(ba,
ua=null){super(fa.h(ba));this.Mpg=null;this.lId=["nameBox","nameBoxData"];this.qie=this.uy=this.clearContentNotifier=this.nameBox=this.Tr=null;this.hae=!1;this.vea=null;this.Doc=this.EIe=this.Otf=this.RCf=this.aEb=!1;this.GNi=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarFontValidation",!1);this.Fxg=!1;this.SXh=Ga.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.FormulaBarFontStatusLogDelay",2E3);this.sj=()=>{this.cpc&&(this.hae=!1);this.V_d();this.Doc&&this.JJc(!this.Lsf)};
this.rj=()=>{this.V_d();this.Xd||this.LLe();this.Doc&&this.JJc(!1)};this.JJc=R=>{sb.bza&&this.EIe!==R&&(L.DOMElementExtensions.toggleCssClass(sb.bza,m.Pwa,R),this.EIe=R)};this.fUf=()=>{this.Kd||this.Ha.disabled||this.startEdit(!0,!1,null)};this.oq=()=>{this.LEa()};this.$Q=(R,Y)=>{this.LEa();sb.bza&&(Y.HS?sb.bza.classList.add(m.Pwa):this.e5c())};this.Rt=(R,Y)=>{R=this.grid;this.cpc&&(this.hae=!0);this.Kd?(this.Zab||(Y.rGb||this.UG(null),this.raiseEvent(v.a.bwb,Y)),this.Xd&&this.Zab||(this.Xd?R.cellTextEditBox.Ha.isCursorAttached()&&
!this.Ha.isCursorAttached()&&R.cellTextEditBox.Ha.clearCursorFormatLocation():this.Xd||this.flb())):R.Kd&&this.LEa()};this.ph=(R,Y)=>{(R=this.grid.ga.ra.activeCell)&&(Y=this.grid.cF(Y.Gf.hash))&&R.If(Y.xg)&&this.LEa()};this.XLd=(R,Y)=>{-185374993===Y.command&&this.LEa()};this.Jg=()=>{this.LEa();Q.TaskExtensions.Aa(ca.a(this.$.ia),()=>{this.Ueg()},this.ma,11)};this.pga=()=>{this.Ueg();Mb.a.instance.rha(n.a.jna,["formulaButton","textbox","textboxData"]);Mb.a.instance.eaa(n.a.jna,["formulaButton","textbox",
"textboxData"]);Mb.a.instance.daa(n.a.jna,["formulaButton"])};this.onKeyDown=R=>{if(!this.Xd){var Y=this.$.shortcutKeyManager.Lt(R.Da);this.kZf(R.Da,Y)}if(R.Da.keyCode===c.a.XG){var La=this.uza();Y=L.DOMElementExtensions.zy(La);La=L.DOMElementExtensions.v2(La);return L.DOMElementExtensions.QWa(R.Da,Y,La)}return!1};this.VQ=()=>{this.e5c()};this.uFb=()=>{this.Tr?(this.nameBox=new ob(this.$,this.Tr),this.qHj()):this.U7f()};ua||b.ULS.sendTraceTag(509223749,0,50,"FormulaBar.ctor: SVGIconProvider must always exist.");
P.a.Uoa()?(this.qie=new Pa(ba),this.initialize(this.r_d(ba,ua)),this.mOa.Qzj()):(this.initialize(sb.hUj(ba)),this.Tr=sb.sjc(ba));if(h.AFrameworkApplication.sa.Sa.qj){const R=document.getElementById("AdditionalBarsRegion");R&&(R.style.height="")}this.ayd=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5160311_CrossBookCrossSheetDataBookPickerOverlay");this.CF=new Kb.a(this.Tr,1);this.hGi=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:6148798_FormulaBarCrossSessionPicker");this.hcb=this.pE&&Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8026558_ParenthesesCoupling");
this.cpc=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaBarTabbingBehaviorChangeXLO",!1);this.Otf=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7367969_formulaEditingLogLoadedFontStatus");this.rnc=new J(ba);this.rnc.u8b(n.a.Bqg,n.a.Bqg,n.a.ndk+" cui-TabRowRight",J.Rbh,J.Tbh);this.A7e=new Oa(this.rnc,Nb.a.instance,ba,ua);this.f4i=new cb(P.a.oB()?void 0:this.rnc,Nb.a.instance,ba,ua);this.Mpg=fb.b(()=>{this.sgg()},1,this.$.ma,"FormulaBar.setTextBoxForActiveItem",!0);ba.ta.zj(this.Jg);
ua=this.grid;ua.cellTextEditBox.Yp(this.sj);ua.cellTextEditBox.yq(this.rj);ua.cellTextEditBox.kKa(this.Rt);ua.tH(this.oq);ua.ya.Zu(this.ph);ua.ya.Hca(this.ph);ua.L6b(this.XLd);Jb.a(ba).Pi.Rka(this.$Q);ba.ea.R0(this.VQ);Ua.a(ba).G4c(this.oq);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&ba.ia.Od(313,R=>{this.clearContentNotifier=R;this.clearContentNotifier.Y3c(this.Rt)});f.KeyInputManager.instance.va(e.a.Ne,this.Df,this.onKeyDown);ua=this.Ha.style;qc.c(ua,
ba.isChromeRtl,"0px");ua.textAlign=this.pqf?"right":"left";this.isVisible=!1;this.ayd&&(this.Ha.isVisible=!1);D.a(this.$).mKa(this.pga);this.$.ea.CAa&&(b.ULS.sendTraceTag(537161948,0,50,"FormulaBar: CommandUI already generated when registering to: OnCommandUIAttachCompleted"),this.pga(null,null));this.LEa();this.e5c();this.Ha.wig=!0;this.cyi();A.a(ba).um(this);this.Ha.mAe(this.fUf);this.Zab=!1;this.uy=new ha(this.$,this);P.a.Zyd()&&this.xwi();this.Ha.fT(()=>{Mb.a.instance.daa(n.a.jna,["textbox","textboxData"]);
this.toggleEditingEvents(!1)});this.Doc=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8106214_disableFunctionButtonV2")}set text(ba){this.Xd&&this.Kd?this.Ha.setPlainText(ba):super.text=ba}get Kd(){return super.Kd}set Kd(ba){super.Kd=ba;this.toggleEditingEvents(ba)}get Lsf(){return this.Vmc||0>=this.text.length}get TUb(){return!0}get formattedText(){return this.Xd?this.Ha.getFormattedText():super.formattedText}set formattedText(ba){this.Xd?this.Ha.setFormattedText(ba):super.formattedText=ba}get Lab(){return this.Kd}get isVisible(){return L.DOMElementExtensions.isVisible(this.Tr)}set isVisible(ba){this.ayd?
L.DOMElementExtensions.setVisible(this.Tr,ba):(L.DOMElementExtensions.setVisible(this.Tr,ba),this.Ha.isVisible=ba)}get Df(){return this.Tr}get uk(){return this.isVisible}get Zg(){return K.a.amd}get mOa(){return this.qie}nl(ba,ua){ba=!1;ua||(ba=this.DXh());return ba}dispose(){const ba=this.$;if(ba){ba.ta.dk(this.Jg);var ua=this.grid;ua.cellTextEditBox.Qp(this.sj);ua.cellTextEditBox.Pp(this.rj);ua.cellTextEditBox.BVa(this.Rt);ua.XI(this.oq);ua.ya.Tt(this.ph);ua.ya.AVa(this.ph);Jb.a(this.$).Pi.lra(this.$Q);
ba.ea.q4(this.VQ);Ua.a(ba).zUd(this.oq);ua=D.a(this.$);f.KeyInputManager.instance.Ca(e.a.Ne,this.Df,this.onKeyDown);P.a.Uoa()&&this.mOa.Rik();ua&&ua.FVa(this.pga);A.a(ba).bD(this);Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&(this.clearContentNotifier&&this.clearContentNotifier.MBc(this.Rt),ba.ia.K1(313))}this.Ha&&this.Ha.X5f(this.fUf);this.nameBox&&this.$.ea.to(this.uFb);k.a.df([this.CF,this.A7e,this.f4i,this.rnc,this.nameBox]);k.a.Ma(this.uy);this.Tr&&
(L.DOMElementExtensions.oK(this.Tr),this.Tr.className="");b.ULS.sendTraceTag(537161946,0,50,"FormulaBar.Dispose: setting this.formulaBarElement to null");this.Tr=null;super.dispose()}endEdit(ba,ua,R,Y=null){this.Ha.addEventLogRecord("FormulaBar.EndEdit",{["Commit"]:ba,["Caller"]:ua});this.nFa(!1);if(this.Kd){var La=null;this.cpc&&Y&&(La=this.$.shortcutKeyManager.Lt(Y));var Ma=this.grid.me;this.Xd||this.Ha.clear("FormulaBar.EndEdit");this.Kd=!1;this.AH(!0);this.LRa()&&this.grid.vx&&this.grid.vx.oOa&&
this.grid.vx.Aib(n.a.aFb);if(ba){var lb=new y.a(this.grid.ga.ra.activeCell,Ma.text,Ma.text,!1,this.grid.$.ta.pa);this.q0f(lb);null!==lb&&(Ma.text=lb.newValue)}else this.Ha.setPlainText(this.text);lb=new z.a(this.grid.ga.ra.activeCell,Ma.text,ba);this.cRd(lb);Ma.endEdit(ba,`${ua}->FormulaBar.EndEdit`,R,Y);this.Ewf(La)||Ma.Ha.focus();this.Ha.Wjb("FormulaBar.EndEdit")}else this.Ha.Wjb("FormulaBar.EndEdit",{["IsEditing"]:"false"})}q8(ba,ua,R,Y=!0,La=!0){super.q8(ba,ua,R,Y,La);this.Xd&&this.grid.me.q8(ba,
ua,R,Y,La)}mZf(ba){if(this.Xd){const ua=this.grid.me,R=this.Ha.selection;R.length&&ua.q8(R.index,R.length,ba,!1,!1)}}Il(ba){return L.DOMElementExtensions.Sj(this.Tr,ba)}Vn(){h.AFrameworkApplication.sa.zi.Sp(this.Zg)}ap(){}dvg(ba){this.nameBox.blk(ba);this.A7e.dlk(ba)}B9d(){if(this.vea){var ba=Object(Db.g)(this.text);this.aEb!==ba&&(this.tgg(ba),this.aEb=ba)}}iKd(){this.Ha.addEventLogRecord("FormulaBar.OnAutoCompleteCommandHandled");const ba=this.grid.me;if(this.Xd){if(!ba.Kd||!this.Kd)return;ba.formattedText=
this.formattedText}else ba.text=this.text;ba.setCaretPosition(this.Ha.caretPosition)}eNb(ba){this.Ha.disabled||(this.grid.cellTextEditBox.Ha.mI=!0,this.Xd&&this.Kd||this.startEdit(!1,!0,ba),this.Cla())}RTa(ba){this.Xd?(this.mR&&(this.nP=this.Ha.caretPosition,this.DW=this.Ha.b_.length),this.pE&&this.UG(null)):super.RTa(ba);this.tha();this.Hsg()}sqa(ba){var ua=this.$.shortcutKeyManager.Lt(ba);const R=this.Xd&&this.Zab;1872288872===ua||125627505===ua||267796030===ua?super.sqa(ba):R?gb.g(ba):this.Kd&&
this.grid.me.Kd&&(ua=this.grid.me,this.Xd?ua.formattedText=this.formattedText:ua.text=this.text,ua.setCaretPosition(this.Ha.caretPosition),this.gLc(),this.hcb&&0===this.Ha.selection.length&&this.UG(null,null),this.hGi&&this.inRangePicker&&this.$3d(),super.sqa(ba))}Qf(ba,ua){this.Kd&&super.Qf(ba,ua)}Ev(ba,ua){this.Kd&&super.Ev(ba,ua)}xwi(){const ba=this.grid.Zd(void 0);ba?(this.aEb=ba.xz||Object(Db.g)(ba.text),this.tgg(this.aEb)):b.ULS.sendTraceTag(509720320,0,50,"FormulaBar.initTextElementStyles: failed to get active cell")}tgg(ba){L.DOMElementExtensions.toggleCssClass(this.vea,
m.hLh,ba);this.Otf&&!this.RCf&&this.aEb&&(this.RCf=!0,this.WTi());this.dqk(ba)}dqk(ba){this.GNi&&!this.Fxg&&ba&&(this.Fxg=!0,this.fqk(),this.gqk(),this.eqk())}fqk(){const ba=window.getComputedStyle(this.vea).getPropertyValue("font-family").replace(/[""]/g,"").toLowerCase().split(",").map(R=>R.trim()),ua=sa.map(R=>R.toLowerCase()).reduce((R,Y,La)=>`${R?R+",":R} ${Y}=${Y===ba[La]}`,"");b.ULS.sendTraceTag(508687192,0,50,`FormulaBar.validateMonospaceFontFamily: ${ua}`)}gqk(){void document.fonts.ready.then(()=>
{var ba=document.createElement("canvas").getContext("2d");ba.font=`11pt ${sa.join(", ")}`;const ua=ba.measureText(".").width;ba=ba.measureText("X").width;b.ULS.sendTraceTag(508687191,0,50,`FormulaBar.validateMonospaceFontWidth: equals=${ua===ba}, dot=${ua}, x=${ba}`)})}eqk(){void document.fonts.ready.then(()=>{const ba=gridRenderer.CanvasRendererGlobals.getFontsLoadStatus(sa);ba.forEach(ua=>{ua.status=Za[ua.status]});b.ULS.sendTraceTag(508687190,0,50,`FormulaBar.validateMonospaceFontFace: ${JSON.stringify(ba)}`)})}WTi(){setTimeout(()=>
{const ba=gridRenderer.CanvasRendererGlobals.getFontsLoadStatus(sa);let ua="FormulaBar: Formula fonts load status: ";for(const R of ba)ua+=`${R.font}: ${Za[R.status]}; `;b.ULS.sendTraceTag(509642332,0,50,ua)},this.SXh)}r_d(ba,ua){this.Tr=sb.sjc(ba);this.Tr.classList.add(m.o0e);this.Tr.classList.add(m.p0e);P.a.oB()&&this.Tr.classList.add(m.dLh);const R=this.mOa.gvh(ua);ua=sb.Zbc(this.Xd,!0);R.appendChild(ua);sb.bza=sb.eRe(ba.He);const Y=sb.aRe(),La=sb.LRe(ba.He),Ma=sb.KRe(ba.He),lb=sb.zQe(ba.He);Ma.tabIndex=
-1;lb.tabIndex=-1;La.appendChild(lb);La.appendChild(Ma);La.appendChild(sb.bza);Y.appendChild(La);Y.appendChild(R);ba=sb.BRe(ba.He);this.Tr.appendChild(ba);this.Tr.appendChild(Y);const pb=new hb.a(ua,this.Xd,!1);this.vea=ua;this.mOa.lineHeight=pb.o9h();pb.fT(()=>{Ib.c(pb.sh,l.a.ariaLabel,"formula bar")});pb.fT(()=>{this.mOa.Tzj()});pb.isVisible=!1;return pb}QTa(ba){this.rAc(ba);super.QTa(ba);qb.b(this.$).Lf(I.a.BYh,{["Location"]:"canvas"});r.a.Dj&&window.focus();const ua=this.$.shortcutKeyManager.Lt(ba);
this.Xd&&this.kZf(ba,ua);this.Ha.disabled||this.Xd&&this.Kd||this.startEdit(!0,!1,ba);let R;R={};R.wasEditing=this.Kd;R.formulaBar=!0;let Y=this.cm(ba,ua);!Y&&yb.d(ua,this.mbb,!0)&&(Y=this.Ewf(ua)?!0:this.grid.ga.cm(ba,ua,R));Y||ab.a(this.$).BFd(ba,0,7)}startEdit(ba,ua,R){const Y=this.grid;if(!this.Kd||!Y.Kd){this.Ha.Wjb("FormulaBar.StartEdit");this.Ha.addEventLogRecord("FormulaBar.StartEdit",{["SetCaretPositionToEnd"]:ba,["IsOnMouseDown"]:ua});qb.b(Y.$).Lf(I.a.AYh,{["Location"]:"canvas"});this.Kd=
this.Zab=!0;Y.St&&Y.St.$Ec(this);Y.cellTextEditBox.AH(!1);Y.cellTextEditBox.gWd();this.Qfg(!1);var La=()=>{var Ma=Y.$.ta.pa;const lb=Y.Zd(null);Ma=new F.a(lb,Ma,void 0,void 0,void 0,this.Apd(lb));this.dRd(Ma);this.Xd&&this.ISb(Y.cellTextEditBox.Ha.TH);!this.Xd&&lb&&lb.u2d&&(this.text="");this.Xd?(window.setTimeout(()=>{if(this.Kd&&Y.Kd){Y.Kd&&Y.cellTextEditBox.Ha.detachCursorFormat();if(!this.UG(null)){const Vb=Y.cellTextEditBox.formattedText;var pb=this.Ha.caretPosition;const Wa=Vb.Text.length;pb=
this.Ha.text.length!==Wa?Wa:pb;this.formattedText=Vb;this.Ha.caretPosition=pb}this.Zab=!1;this.Ha.clearHistory()}else this.Kd=!1},0),Y.cellTextEditBox.nWd()):(ua||(this.flb(),this.UG(null)),Y.cellTextEditBox.nWd(),this.Zab=!1)};if(Y.Kd)Y.bE=1,La();else if(this.Ha.mI=!0,Q.TaskExtensions.Aa(Y.startEdit(!1,1,R,!1,void 0,ua,1),Ma=>{Ma.result?(Y.Kd||(this.Ha.addErrorLogRecord("FormulaBar.StartEdit","tag_cnkc7"),b.ULS.sendTraceTag(37003425,0,10,"FormulaBar.StartEdit: grid.IsEditing is false after calling grid.StartEdit. Stack=")),
this.Kd&&Y.Kd?(Y.cellTextEditBox.Ha.mI=!0,Ma=Y.Zd(null),this.Ha.Z6e(Number.NaN,this.Apd(Ma)),ba&&this.Ha.setCaretPositionToEnd(),La()):this.Kd=!1):this.Kd=!1},this.ma,11),this.Ha.mI=!1,R=Y.Zd(null),null===R||void 0===R?0:R.Bzd)this.Ha.addEventLogRecord("FormulaBar.StartEditStripOutLegacyArrayCurlyBraces"),this.text=va.HelperMethods.xng(this.text)}}ctd(ba){super.ctd(ba);this.Doc&&this.grid&&this.grid.Kd&&2===ba&&this.JJc(!this.Lsf)}gh(ba,ua){super.gh(ba,ua);this.V_d()}eXa(ba){Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7549189_logsForNullTextboxInvestigation")&&
b.ULS.sendTraceTag(509445518,0,50,`FormulaBar.set_textBox: Setting the text box for the formula bar, textBox defined: ${!!ba}`);super.eXa(ba)}V_d(){const ba=this.grid;ba.Kd&&2===ba.bE||this.LEa()}fi(){var ba=this.grid;this.Kd&&ba.Kd&&(ba=ba.me,ba.text=this.text,ba.setCaretPosition(this.Ha.caretPosition),this.inRangePicker&&this.Ha.focus())}LEa(){this.Xd?this.Mpg():this.sgg()}sgg(){if(this.Ha){var ba=this.grid;this.Ha.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal",{["IsEditing"]:this.Kd,
["TextBox.Initialized"]:this.Ha.initialized,["Grid.IsEditing"]:ba.Kd});if(!this.Kd){var ua=Jb.a(this.$).Wr();this.Tr.disabled=ua||!this.$.isEditMode;var R=(ua=this.$.BX===ba)&&1===ba.ga.eh;this.Ha.initialized&&(this.Ha.disabled=this.Tr.disabled||ua&&!R);ua=new Gb.a(this.Ha.style);var Y=!1;if(R)if(ba.Kd)this.Ha.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"CellTextEditBox.Text"}),R=ba.cellTextEditBox.text;else{Y=ba.Zd(null);R=new T.a(this.$.ta);
if(!Y||!R.WHb(Y.range,ba))return;ba=R.yk;R=Y.Cj;var La=Y.formulaBarText;const Ma=Y.text;this.Ha.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["sheetProtection.IsLocked"]:ba,["activeCell.IsHidden"]:R,["activeCell.FormulaBarText"]:!!La,["activeCell.Text"]:!!Ma});R=ba&&R?"":La||Ma;Y=Y.u2d}else R="",La=ba.ga.Ta.Fe,La=(null===La||void 0===La?0:La.floatingObject)?La.floatingObject.$d:null,64===ba.ga.eh&&La&&La.IsShapeFormulaPresent&&((ba=(ba=La.ShapeText)?ba.substring(ba.indexOf("\nFormula:")+
9,ba.indexOf(";FormulaVal:")):null)?(this.Ha.addEventLogRecord("FormulaBar.setTextBoxForActiveItemInternal.SetActiveCellContents",{["ActiveCellContents"]:"ShapeFormula"}),R="="+ba):b.ULS.sendTraceTag(537161938,0,15,"FormulaBar.setTextBoxForActiveItemInternal: IsShapeFormulaPresent is true but formula not found in shapeText"));this.Qfg(Y);this.Rob=this.E9b();ua.OB.direction=this.g9?t.a.rtl:t.a.GSa;ua.OB.textAlign=this.g9?t.a.right:t.a.left;ua.fX();this.text=R}}}Ueg(){var ba=this.$.BX;if(this.ayd){const ua=
!!this.grid.ZM&&this.grid.ZM.PH;this.isVisible=ba=!!ba&&this.$.bmd&&!this.$.ea.Je.inEmbedView;ua||(this.Ha.isVisible=ba)}else this.isVisible=!!ba&&this.$.bmd&&!this.$.ea.Je.inEmbedView;this.$.kI(n.a.t3d);this.$.GL()}Qfg(ba){L.DOMElementExtensions.toggleCssClass(this.Ha.domElement,m.fLh,ba)}uza(){return this.Tr.querySelectorAll(L.DOMElementExtensions.hE+", div[tabindex]")}zy(){return L.DOMElementExtensions.zy(this.uza())}DXh(){const ba=this.zy();return ba?(L.DOMElementExtensions.setFocus(ba),!0):!1}kZf(ba,
ua){ua=-287251124===ua||-1925065947===ua||1764140053===ua;db.a.ORa()&&ua&&ba.preventDefault()}e5c(){this.JJc(!this.$.isEditMode)}ISb(ba){this.Xd&&(this.Ha.TH=ba)}toggleEditingEvents(ba){this.Ha.toggleEditingEvents(ba)}cyi(){this.Tr?Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InitNameBoxEagerly",!1)?this.uFb():Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:7134788_FixingNameBoxReliabliity")?this.$.ea.Gh?this.uFb():this.$.ea.el(this.uFb):this.$.ea.el(this.uFb):this.U7f()}qHj(){Mb.a.instance.rha(n.a.jna,
this.lId);Mb.a.instance.eaa(n.a.jna,this.lId);Mb.a.instance.daa(n.a.jna,this.lId)}U7f(){b.ULS.sendTraceTag(537161947,0,50,"FormulaBar.ctor: this.formulaBarElement is null (probably after dispose)")}Ewf(ba){return this.cpc&&!this.hae&&(125627505===ba||706199415===ba)}get text(){return super.text}static sjc(ba){return document.getElementById(ba.He+n.a.w6a)}static hUj(ba){const ua=Ga.EwaSettings.Xd(),R=sb.sjc(ba);R.classList.add(m.o0e);sb.bza=sb.eRe(ba.He);const Y=sb.Zbc(ua,!0),La=sb.aRe();La.appendChild(sb.bza);
La.appendChild(Y);const Ma=sb.LRe(ba.He),lb=sb.KRe(ba.He),pb=sb.zQe(ba.He);Ma.appendChild(lb);Ma.appendChild(pb);La.appendChild(Ma);ba=sb.BRe(ba.He);R.appendChild(ba);R.appendChild(La);const Vb=new hb.a(Y,ua,!1);Vb.fT(()=>{Ib.c(Vb.sh,l.a.ariaLabel,"formula bar")});Vb.isVisible=!1;return Vb}static aRe(){const ba=document.createElement("div");ba.className=m.$Kh;ba.classList.add(m.HT);return ba}static LRe(ba){const ua=document.createElement("div");ua.id=ba+sb.FJf;ua.className=m.Pvc;ua.classList.add(m.HT);
return ua}static Zbc(ba,ua){const R=db.a.ORa(),Y=document.createElement(R?"div":"textarea");Y.className=m.gLh;P.a.HIi()&&Y.classList.add(m.jLh);ua&&ba&&Y.classList.add(m.iLh);ba?Y.classList.add(m.g2i):(Y.setAttribute(x.a.d7c,u.a.off),Y.setAttribute(x.a.wrap,u.a.virtual),Y.setAttribute(x.a.spellcheck,u.a.xGa),L.DOMElementExtensions.KB(Y,n.a.K3a),Y.tabIndex=0);!P.a.oB()||window.CSS&&window.CSS.supports&&window.CSS.supports("scrollbar-gutter","stable")||Y.classList.add(m.P1i);R?(Y.id=n.a.tBb,ba||Y.setAttribute(x.a.contentEditable,
u.a.x$d)):(Y.cols=20,Y.rows=2);return Y}static eRe(ba){const ua=document.createElement("div");ua.id=ba+n.a.sBb;ua.className=m.e8e;L.DOMElementExtensions.KB(ua,n.a.xA);ua.setAttribute(n.a.nx,"insert function");ua.tabIndex=0;ua.classList.add(m.HT);return ua}static KRe(ba){const ua=document.createElement("div");ua.id=ba+sb.Ovc;ua.className=m.GJf;L.DOMElementExtensions.KB(ua,n.a.xA);ua.setAttribute(n.a.nx,"commit edit");ua.tabIndex=0;ua.classList.add(m.HT);return ua}static zQe(ba){const ua=document.createElement("div");
ua.id=ba+sb.R9b;ua.className=m.YJe;L.DOMElementExtensions.KB(ua,n.a.xA);ua.setAttribute(n.a.nx,"cancel edit");ua.tabIndex=0;ua.classList.add(m.HT);return ua}static BRe(ba){const ua=document.createElement("div");ua.id=ba+n.a.C7e;ua.className=m.eLh;return ua}}sb.FJf="okCancelButtonContainer";sb.Ovc="okboxButton";sb.R9b="cancelboxButton";sb.bza=null;Object(w.a)(sb,"FormulaBar",v.a,[57]);const sa=["Consolas","Monaco","Menlo","Courier New","monospace"]}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrd.js.map/4b6b48f157779abee0dfde8f35a88b9d/EwaTS.vrd.js.map