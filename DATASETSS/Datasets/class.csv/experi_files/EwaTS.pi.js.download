'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1112:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);class b{}b.jNc="b-ring_Apc_Trans";b.sAg="cdn_static_resource_ewa_image";Object(w.a)(b,"ResourceHosts",null,[])},1113:function(w,B,a){a.d(B,"a",function(){return h});w=a(0);var b=a(60),c=a(1211);class h{static Mmd(f,e,k,l){l=void 0===l?null:l;h.jvc||(h.jvc=Array.isArray(b.a.kl(k.xa.NetworkMeasurementUrlList))?b.a.kl(k.xa.NetworkMeasurementUrlList):null);
const r=[];for(let v=0;v<h.jvc.length;v++){const u=h.jvc[v];let x=u.key;x||(x=u.Key);if(l&&!l.includes(x))continue;let t=u.value;t||(t=u.Value);x&&t&&r.push(new c.a(k,x,t,f,e))}return r}}h.jvc=null;Object(w.a)(h,"NetworkConnectionHelpers",null,[])},1115:function(w,B,a){a.d(B,"a",function(){return b});const b=c=>{const h=Array(c.length);for(let f=0,e=c.length;f<e;f++)h[f]=c[f].cloneNode(!0);return h}},1119:function(w,B,a){a.d(B,"a",function(){return f});w=a(0);var b=a(16),c=a(39),h=a(65);a=a(748);
class f extends a.a{constructor(e,k){super(e,k);b.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.YBa;this.$za=!0}get linkText(){return f.jEf}lqa(e){super.lqa(e);c.a.openWindow(4,h.a.IK(f.iEf))}BG(e){super.BG(e);f.dGd&&f.dGd(null)}static initialize(e,k,l,r){b.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.YBa=e;f.jEf=k;f.iEf=l;f.dGd=r}}f.YBa=null;f.jEf=null;f.iEf=null;f.dGd=null;
Object(w.a)(f,"WacGdprNoticeBusinessBarEntry",a.a,[])},1120:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);class b{}b.Iid="ewa-bb";b.PIh="ewa-bb-entry";b.N_e="ewa-bb-react";b.QIh="ewa-bb-entry-body";b.WIh="ewa-bb-icon";b.SIh="ewa-bb-entry-icon";b.VIh="ewa-bb-entry-title";b.UIh="ewa-bb-entry-message";b.L_e="ewa-bb-entry-button";b.TIh="ewa-bb-entry-link";b.RIh="ewa-bb-entry-close";b.M_e="ewa-bb-entry-button-holder";b.OIh="ewa-bb-content";Object(w.a)(b,"CssClassNames",null,[])},1121:function(w,
B,a){a.d(B,"a",function(){return b});w=a(0);a=a(748);class b extends a.a{constructor(c,h){super(c,h);this.su=!0;this.title=b.v5;this.message=b.u5}get actionButton(){return b.O_}Go(c){super.Go(c);(c=b.cW)&&c(null)}static initialize(c,h,f,e){b.v5=c;b.u5=h;b.O_=f;b.cW=e}}b.v5=null;b.u5=null;b.O_=null;b.cW=null;Object(w.a)(b,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1122:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);a=a(748);class b extends a.a{constructor(c,h){super(c,h);this.su=
!0;this.title=b.v5;this.message=b.u5}get actionButton(){return b.O_}Go(c){super.Go(c);(c=b.cW)&&c(null)}static initialize(c,h,f,e){b.v5=c;b.u5=h;b.O_=f;b.cW=e}}b.v5=null;b.u5=null;b.O_=null;b.cW=null;Object(w.a)(b,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1123:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);a=a(883);class b extends a.a{constructor(c,h,f){super(c,h,f);b.O_&&b.cW&&(this.su=!0);this.title=b.v5;this.message=b.u5}get actionButton(){return b.O_}static initialize(c,h,
f,e){b.v5=c;b.u5=h;b.O_=f;b.cW=e}Go(c){super.Go(c);b.cW&&b.cW(null)}}b.v5=null;b.u5=null;b.O_=null;b.cW=null;Object(w.a)(b,"DataCleansingBusinessBarEntry",a.a,[])},1124:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);a=a(748);class b extends a.a{constructor(c,h){super(c,h);this.su=!0;this.title=b.v5;this.message=b.u5}get actionButton(){return b.O_}Go(c){super.Go(c);(c=b.cW)&&c(null)}static initialize(c,h,f,e){b.v5=c;b.u5=h;b.O_=f;b.cW=e}}b.v5=null;b.u5=null;b.O_=null;b.cW=null;Object(w.a)(b,
"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1125:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);a=a(748);class b extends a.a{constructor(c,h){super(c,h);this.su=!0;this.title=b.oKb;this.message=b.YBa}get actionButton(){return b.odb}Go(c){super.Go(c);b.$Ba&&b.$Ba(null)}static initialize(c,h,f,e){b.oKb=c;b.YBa=h;b.odb=f;b.$Ba=e}}b.oKb=null;b.YBa=null;b.odb=null;b.$Ba=null;Object(w.a)(b,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1126:function(w,B,a){a.d(B,"a",
function(){return b});w=a(0);a=a(748);class b extends a.a{constructor(c,h){super(c,h);b.odb&&b.$Ba&&(this.su=!0);this.title=b.oKb;this.message=b.YBa}get actionButton(){return b.odb}Go(c){super.Go(c);b.$Ba&&b.$Ba(null)}static initialize(c,h,f,e){b.oKb=c;b.YBa=h;b.odb=f;b.$Ba=e}}b.oKb=null;b.YBa=null;b.odb=null;b.$Ba=null;Object(w.a)(b,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1168:function(w,B,a){a.r(B);w=a(0);var b=a(16),c=a(92),h=a(121),f=a(15),e=a(96),k=a(56),l=a(33),r=a(30),
v=a(14),u=a(250),x=a(1120),t=a(6),m=a(277),n=a(1121),A=a(748),y=a(1195),z=a(883);class F extends z.a{constructor(sa,ba,ua){super(sa,ba,ua)}BG(sa){super.BG(sa)}}Object(w.a)(F,"EditAttemptReadOnlyBusinessBarEntry",z.a,[]);var D=a(46);class I extends A.a{constructor(sa,ba,ua,R){super(sa,ba);this.error=ua;this.options=R;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.su=!(R&4)}Go(sa){super.Go(sa);this.error.Appearance&=
-33;D.a(this.businessBar.$).Vw([this.error])}}Object(w.a)(I,"ErrorBusinessBarEntry",A.a,[]);var H=a(91);class N extends I{constructor(sa,ba,ua,R,Y){super(sa,ba,ua,R);this.command=Y;this.BY=!0}oZ(sa){super.oZ(sa);this.businessBar.$.Ga.Sd(new H.a(this.command,sa,this.businessBar.$.Ie,10,null))}}Object(w.a)(N,"ErrorAndCommandBusinessBarEntry",I,[]);var U=a(12);class L{constructor(sa,ba,ua,R,Y,La,Ma,lb,pb,Vb){this.oM=this.oba=this.jS=0;this.wGg=sa;this.Mck=ba;this.pM=ua;this.IKg=Ma;this.yob=l.a.hz(pb);
this.RIg=pb;this.Tde=lb;this.JKg=Vb;0!==R&&(this.jS=R);0!==Y&&(this.oba=Y);0!==La&&(this.oM=La)}get title(){return L.ha(this.Mck)}get message(){return L.ha(this.pM)}get messageId(){return this.pM}get iconName(){return this.JKg}get E4a(){return this.wGg}get actionButton(){return L.ha(this.jS)}get HKa(){return L.ha(this.oba)}get link(){return L.ha(this.oM)}get Js(){return this.IKg}get businessBarType(){return this.Tde}get hash(){return this.yob}get alt(){const {BusinessBarControl:sa}=a(1168);switch(this.Js){case sa.Hma:return L.ha(26);
case sa.Sy:return L.ha(25);case sa.Qk:return L.ha(24);default:return L.ha(0)}}get yya(){return this.RIg}set businessBarType(sa){this.Tde=sa}static ha(sa){return U.a.instance.ha(sa)}}Object(w.a)(L,"EwaBusinessBarEntry",null,[]);class J extends L{constructor(sa,ba,ua,R,Y,La,Ma,lb,pb){super(sa,0,ba,ua,R,Y,La,Ma,lb,pb)}get title(){return""}}Object(w.a)(J,"EwaNoTitleBusinessBarEntry",L,[]);var P=a(77);class K extends A.a{constructor(sa,ba){super(sa,ba);this.BY=this.su=!0}Go(sa){super.Go(sa);this.set_visible(!1);
this.businessBar.$.GL();this.businessBar.$.Ga.Sd(new H.a(1038998010,sa,this.businessBar.$.Ie,10,null))}oZ(sa){super.oZ(sa);this.businessBar.$.Ga.Sd(new H.a(-722953877,sa,this.businessBar.$.Ie,10,null))}BG(sa){this.businessBar.removeEntry(55);P.g(sa)}}Object(w.a)(K,"ExternalLinksEnableContentBusinessBarEntry",A.a,[]);class ca extends A.a{constructor(sa,ba){super(sa,ba);this.su=!0;this.BY=!1}Go(sa){super.Go(sa);this.businessBar.$.Ga.Sd(new H.a(-722953877,sa,this.businessBar.$.Ie,10,null))}BG(sa){this.businessBar.removeEntry(5);
P.g(sa)}}Object(w.a)(ca,"ExternalLinksShowErrorBusinessBarEntry",A.a,[]);var T=a(11);class Q extends A.a{constructor(sa,ba,ua){super(sa,ba);this.sEb=ua;this.su=!0}Go(sa){super.Go(sa);T.HelperMethods.eV(this.businessBar.$.VG,this.sEb,this.businessBar.$.cS)}}Object(w.a)(Q,"HelpButtonBusinessBarEntry",A.a,[]);class fa extends A.a{constructor(sa,ba,ua){super(sa,ba);this.sEb=ua;this.$za=!0}lqa(sa){super.lqa(sa);T.HelperMethods.eV(this.businessBar.$.VG,this.sEb,this.businessBar.$.cS)}}Object(w.a)(fa,"HelpTextBusinessBarEntry",
A.a,[]);var ha=a(76);class Ea extends A.a{constructor(sa,ba,ua,R){super(sa,ba);this.sEb=ua;this.command=R;this.$za=!0;this.su=1461300262!==R}Go(sa){super.Go(sa);this.businessBar.$.Ga.Sd(new H.a(this.command,sa,this.businessBar.$.Ie,10,null))}lqa(sa){super.lqa(sa);const ba=new H.a(-859308420,sa,this.businessBar.$.Ie,12,null);this.businessBar.$.Ga.Sd(ba,{[ha.a.di]:"HelpID="+this.sEb,["InputMethod"]:sa,[ha.a.qf]:t.a.AN,[t.a.nia]:!0})}}Object(w.a)(Ea,"HelpTextTaskPaneAndCommandBusinessBarEntry",A.a,[]);
class ra extends A.a{constructor(sa,ba){super(sa,ba);this.BY=this.su=!0}Go(sa){super.Go(sa);this.set_visible(!1);this.businessBar.$.GL();this.businessBar.$.Ga.Sd(new H.a(-1081442996,sa,this.businessBar.$.Ie,10,null))}oZ(sa){super.oZ(sa);this.businessBar.$.Ga.Sd(new H.a(1702917262,sa,this.businessBar.$.Ie,10,null))}BG(sa){this.businessBar.removeEntry(59);P.g(sa)}}Object(w.a)(ra,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",A.a,[]);var Z=a(1124);class wa extends A.a{constructor(sa,ba){super(sa,
ba);(this.policyManager=sa.$.ia.Ja(274))?(this.message=this.policyManager.nzc,this.title=this.policyManager.title,this.$za=!0):b.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}lqa(sa){super.lqa(sa);(sa=this.policyManager.scj)&&sa(null)}}Object(w.a)(wa,"PolicyBusinessBarEntry",A.a,[]);var la=a(1122),ta=a(1126),Ca=a(1125);a(428);var Ga=a(107),Oa=a(26);class eb extends A.a{constructor(sa,
ba){super(sa,ba);this.su=!0;this.title=""}Go(sa){super.Go(sa);Ga.c(Oa.a.m1i);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(w.a)(eb,"UnsupportedBrowserBusinessBarEntry",A.a,[]);var nb=a(1119),$a=a(125),oa=a(903),Fa=a(962),X=a(1182);class va{constructor(){this.COc=new X.a;this.AOc=new X.a;this.zOc=new X.a;this.h$g(this.COc);this.g$g(this.AOc);this.f$g(this.zOc);this.OTc=new X.a;this.NTc=new X.a;this.MTc=new X.a;this.Fbh(this.OTc);this.Ebh(this.NTc);this.Dbh(this.MTc);
this.VPc=new X.a;this.A$g(this.VPc);this.eKa(this.VPc);this.eKa(this.zOc);this.eKa(this.AOc);this.eKa(this.COc);this.eKa(this.NTc);this.eKa(this.OTc);this.eKa(this.MTc)}yii(sa,ba){switch(sa){case 1:return this.bmi(ba);case 2:return this.d2h(ba)}return Fa.a.X1d?this.VPc:null}h$g(sa){sa.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);sa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);sa.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}g$g(sa){sa.add("Headline",
CommonUIStrings.l_WildFirePPTBizBarHeadline);sa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);sa.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}f$g(sa){sa.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);sa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);sa.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}Fbh(sa){sa.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);sa.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);sa.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);sa.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);sa.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);sa.add("OverlayBig","Get the Word app");sa.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");sa.add("OverlaySmallSplit1","Discover Word");sa.add("OverlaySmallSplit2","designed for the iPad.");
sa.add("SkipButton","Skip for now")}A$g(sa){sa.add("Headline","Get the Office Online extension for Chrome");sa.add("UseAppButton","Get the extension");sa.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}Ebh(sa){sa.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);sa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);sa.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);sa.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);
sa.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);sa.add("OverlayBig","Get the PowerPoint app");sa.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");sa.add("OverlaySmallSplit1","Discover PowerPoint");sa.add("OverlaySmallSplit2","designed for the iPad.");sa.add("SkipButton","Skip for now")}Dbh(sa){sa.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);sa.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
sa.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);sa.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);sa.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}eKa(sa){sa.add("Corporation","Microsoft Corporation")}bmi(sa){switch(sa){case 3:return this.OTc;case 2:return this.NTc;case 1:return this.MTc}return null}d2h(sa){switch(sa){case 3:return this.COc;case 2:return this.AOc;case 1:return this.zOc}return null}static get instance(){va.La||
(va.La=new va);return va.La}}va.La=null;Object(w.a)(va,"WildFireStringFactory",null,[]);var xa=a(5),Pa=a(39);class Ka{constructor(sa,ba,ua,R,Y,La){this.eYc=null;this._id=sa;this.PYc=ba;this.cKg=void 0===Y?null:Y;this.Tob=R;this.grb=void 0===La?null:La;this.WGa=null;this.m2a=ua;this.Lrb=va.instance.yii(ba,sa)}xQe(){this.WGa=new oa.a(this.title,this.message,null);this.WGa.addButton(this.nIe,Object($a.a)(this,this.PKf,"onButtonOneClick"),"");this.m2a&&this.WGa.zXg(this.pIe,Object($a.a)(this,this.SKf,
"onButtonTwoClick"));this.WGa.yda=Object($a.a)(this,this.gWe,"dismissBar");this.WGa.image=3;this.WGa.id=16;this.WGa.closeable=!0}get title(){return this.Lrb.ka("Headline")}get message(){return this.Lrb.ka("CallToAction")}get mok(){return this.m2a}get nIe(){return this.m2a?this.Lrb.ka("InstallButton"):this.Lrb.ka("UseAppButton")}get pIe(){return this.m2a?this.Lrb.ka("OpenAppButton"):""}PKf(){this.m2a?this.Ozi():this.cok()}SKf(){this.m2a&&this.Uij()}get openUrl(){this.eYc||(this.eYc=this.cKg());return this.eYc}Ozi(){b.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.Tob&&this.grb&&this.grb();Fa.a.S2f(this._id,this.PYc)}Uij(){this.openUrl&&(b.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Tob&&this.grb&&this.grb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(Fa.a.qDe(this._id),this.openUrl,0,!1))}cok(){Fa.a.X1d?this.Kbh():(b.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),Fa.a.Y_d("BizBarClicked"),1!==this.PYc&&2!==this.PYc||Fa.a.rih(this.openUrl,this.Tob,
this._id,this.grb))}Kbh(){this.Tob?b.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):b.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Pa.a.m2(xa.AFrameworkApplication.da.appSettings.WildFireChromeExtensionUrl.toString())}vBh(){this.Tob?b.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):b.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");Fa.a.Y_d(Fa.a.chh)}gWe(){Fa.a.X1d?this.vBh():(Fa.a.Y_d(Fa.a.J9e(this._id)),b.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static Ovh(){const sa=
xa.AFrameworkApplication.sa.Sa,ba=new Ka(sa.Hj,Fa.a.Nhf(),8<r.a.LEb,1===sa.zCa,()=>sa.gv,sa.iMj());b.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return ba}}Object(w.a)(Ka,"WildFireBusinessBar",null,[]);class Bb extends A.a{constructor(sa,ba){super(sa,ba);this.GGa=Ka.Ovh();this.su=!0;this.BY=this.GGa.mok;this.title=this.GGa.title;this.message=this.GGa.message}get actionButton(){return this.GGa.nIe}get HKa(){return this.GGa.pIe}Go(sa){super.Go(sa);this.GGa.PKf(null)}oZ(sa){super.oZ(sa);
this.GGa.SKf(null)}BG(sa){super.BG(sa);this.GGa.gWe(null)}}Object(w.a)(Bb,"WildFireMobileAppBusinessBarEntry",A.a,[]);var xb=a(261),Ua=a(22),Jb=a(193),fc=a(164),ya=a(53),ob=a(2),Sb=a(181),Ba=a(1127),Ia=a(71),cb=a(145),Kb=a(568),db=a(1);class gb extends A.a{constructor(sa,ba,ua,R){super(sa,ba);this.officeScriptsCommandManager=ua.ia.Ja(519);b.ULS.shipAssertTag(512276321,0,!!this.officeScriptsCommandManager);this.id=Sb.a.create();this.$=ua;this.title=U.a.instance.ha(2282);this.message="";this.t4d=U.a.instance.ha(2278);
this.myg=U.a.instance.ha(2279);this.kyg=U.a.instance.ha(2280);this.KOe=U.a.instance.ha(2281);this.update(R)}update(sa){this.scriptLink=sa.scriptLink;this.runStatus=sa.runStatus;this.buttonText=sa.buttonText||"";this.XSi(sa.clickId);this.oIj();"preparing"===this.runStatus?(this.Tra(0),this.message=String.format(U.a.instance.Qd(208),this.buttonText),this.su=!0,this.Wva=this.t4d,this.Kwb=this.xka=this.Yeb):"running"===this.runStatus?(this.Tra(0),this.message=String.format(U.a.instance.Qd(207),this.buttonText),
this.su=!0,this.Wva=this.t4d,this.Kwb=this.xka=this.Yeb):"succeeded"===this.runStatus?(this.Tra(0),this.message=String.format(U.a.instance.Qd(210),this.buttonText),"true"===sa.hasLogs?(this.su=!0,this.Wva=this.kyg,this.xka=this.WUf,this.BY=!0,this.t5c=this.myg,this.u5c=this.XUf):(this.su=!0,this.Wva=this.myg,this.xka=this.XUf)):"runFailed"===this.runStatus?(this.Tra(1),this.message=String.format(U.a.instance.Qd(209),this.buttonText),this.L$a=sb.Hma,"true"===sa.hasLogs?(this.su=!0,this.Wva=this.kyg,
this.xka=this.WUf,"false"===sa.isOwner&&(this.BY=!0,this.t5c=this.KOe,this.u5c=this.XLf)):"false"===sa.isOwner&&(this.su=!0,this.Wva=this.KOe,this.xka=this.XLf)):"fetchFailed"===this.runStatus?(this.Tra(1),this.L$a=sb.Hma,this.message=U.a.instance.ha(2284)):"canceled"===this.runStatus?(this.Tra(0),this.L$a=sb.Sy,this.message=String.format(U.a.instance.Qd(212),this.buttonText)):"alreadyRunning"===this.runStatus?(this.Tra(5),this.L$a=sb.Sy,this.message=String.format(U.a.instance.Qd(211),this.buttonText),
this.su=!0,this.Wva=this.t4d,this.Kwb=this.xka=this.Yeb):"initializing"===this.runStatus&&(this.Tra(0),this.L$a=sb.Qk,this.message=U.a.instance.ha(2283))}get Js(){return this.L$a}get actionButton(){return this.Wva}get HKa(){return this.t5c}Go(sa){super.Go(sa);this.xka&&this.xka()}oZ(sa){super.oZ(sa);this.HKa&&this.u5c()}BG(sa){super.BG(sa);this.Kwb&&this.Kwb()}oIj(){this.message="";this.L$a=sb.Qk;this.su=!1;this.Wva="";this.xka=void 0;this.BY=!1;this.t5c="";this.u5c=void 0;this.hideCloseButton=!1;
this.Kwb=void 0}Yeb(){const sa=Sb.a.create().toString();this.officeScriptsCommandManager.oni(sa);this.ktc(-2186799,sa)}WUf(){const sa=Sb.a.create().toString();this.officeScriptsCommandManager.nni(sa);this.ktc(1036446140,sa)}XUf(){const sa=Sb.a.create();if(this.scriptLink)if(db.EwaSettings.getBooleanFeatureGate(Kb.a.BCa,!1))this.officeScriptsCommandManager.utd(this.id.toString(),this.scriptLink,sa);else{const ba=new Ba.b(this.scriptLink);this.officeScriptsCommandManager.utd(this.id.toString(),JSON.stringify(ba),
sa)}this.ktc(-585097204,sa.toString())}XLf(){const sa=Sb.a.create().toString();this.officeScriptsCommandManager.mni(sa);this.ktc(-639858579,sa)}XSi(sa){const ba=[];ba.push(Object(ob.a)(new Ia.a,{name:"id",string:this.id.toString()}));ba.push(Object(ob.a)(new Ia.a,{name:"hasScriptLink",bool:!!this.scriptLink}));ba.push(Object(ob.a)(new Ia.a,{name:"runStatus",string:this.runStatus}));ba.push(Object(ob.a)(new Ia.a,{name:"clickId",string:sa}));ba.push(Object(ob.a)(new Ia.a,{name:"hasButtonText",bool:!!this.buttonText&&
""!==this.buttonText}));Ga.a(cb.a.Q3i,void 0,void 0,ba)}ktc(sa,ba){const ua=[];ua.push(Object(ob.a)(new Ia.a,{name:"id",string:this.id.toString()}));ua.push(Object(ob.a)(new Ia.a,{name:"hasScriptLink",bool:!!this.scriptLink}));ua.push(Object(ob.a)(new Ia.a,{name:"runStatus",string:this.runStatus}));ua.push(Object(ob.a)(new Ia.a,{name:"clickId",string:ba}));Ga.d(sa,void 0,void 0,void 0,void 0,void 0,ua)}}Object(w.a)(gb,"OfficeScriptsRunStatusBusinessBarEntry",A.a,[]);var yb=a(142),Nb=a(13),qc=a(52);
class Gb extends z.a{constructor(sa,ba,ua,R,Y,La){super(sa,ba,ua);qc.a.instance.create(()=>{this.showCallout(ba,R)},Y,La,!0,!0)}showCallout(sa,ba){if(this.businessBar&&this.businessBar.Moa(sa.E4a)&&this.oCe()){sa=new H.a(-847286761,0,this.businessBar.$.Ie,0,null);var ua={};ua.CalloutName=ba;db.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?ua.Target=this.pN():ua.Target=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:
this.jS.domElement;this.businessBar.$.Ga.Sd(sa,ua)}}oCe(){return!0}}Object(w.a)(Gb,"CalloutBusinessBarEntry",z.a,[]);class hb extends Gb{constructor(sa,ba,ua,R,Y,La){super(sa,ba,ua,R,Y,La)}oCe(){if(!db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;if(!this.businessBar)return!1;const sa=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)?yb.a.rg(Nb.pc):this.businessBar.$.ia.Ja(465);
return sa&&sa.TDc?!1:!0}}Object(w.a)(hb,"OptimizeWorkbookCalloutBusinessBarEntry",Gb,[]);var qb=a(18),ab=a(119);class Mb extends A.a{constructor(sa,ba,ua){super(sa,ba);this.update(ua)}update(sa){this.title=sa.title?sa.title:"";this.message=sa.message?sa.message:"";const ba=this.Tnh(sa.businessBarType);this.Tra(ba);this.hideCloseButton=!!sa.hideCloseButton;if(db.EwaSettings.isChangeGateEnabled("OfficeVSO:7958899_LogMsFormsDataSyncBizBarShown")){const ua=[];ua.push(ab.a.Ci("Reason",sa.reason,2));ua.push(ab.a.Ci("Type",
ba.toString(),2));Ga.a("MsFormsDataSyncBizBarShown",void 0,void 0,ua)}}Tnh(sa){switch(sa){case "error":return 1;case "blocked":return 2;case "severeWarning":return 3;case "success":return 4;case "warning":return 5;default:return 0}}}Object(w.a)(Mb,"MsFormsDataSyncStatusBusinessBarEntry",A.a,[]);class Ib extends A.a{constructor(sa,ba,ua,R){super(sa,ba);this.BY=this.su=!0;this.zqj=ua;this.p3g=R}Go(sa){super.Go(sa);this.businessBar.$.Ga.Sd(new H.a(this.zqj,sa,this.businessBar.$.Ie,10,null))}oZ(sa){super.Go(sa);
this.businessBar.$.Ga.Sd(new H.a(this.p3g,sa,this.businessBar.$.Ie,10,null))}}Object(w.a)(Ib,"DualCommandActionsBusinessBarEntry",A.a,[]);var fb=a(1123),Db=a(391),Za=a(155);a.d(B,"BusinessBarControl",function(){return sb});class sb extends u.a{constructor(sa,ba){super(ba);this.$6e=v.DOMElementExtensions.hE+",div";this.CX=Array(74);this.qke=this.vp=!1;this.qZ=ua=>{if(ua.Da.keyCode===c.a.XG){var R=this.Df.querySelectorAll(this.$6e);const Y=v.DOMElementExtensions.zy(R);R=v.DOMElementExtensions.v2(R);
return v.DOMElementExtensions.QWa(ua.Da,Y,R)}return!1};this.Pd=sa;this.set_visible(!1);db.EwaSettings.isChangeGateEnabled("OfficeVSO:8190523_BizBarHeaderTTVRFix")||(this.addCssClass(x.a.Iid),db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&this.addCssClass(x.a.N_e));h.KeyInputManager.instance.va(f.a.Ne,this.Df,this.qZ);m.a(sa).um(this)}get Zg(){return xb.a.E8c}get Df(){return this.domElement}get uk(){return this.get_visible()}get $(){return this.Pd}nl(sa,ba){db.EwaSettings.isChangeGateEnabled("OfficeVSO:7627987_BizBarA11yFocusFix")?
ba||v.DOMElementExtensions.setFocus(v.DOMElementExtensions.zy(this.Df.querySelectorAll(this.$6e))):ba||v.DOMElementExtensions.setFocus(this.domElement.firstChild);return!ba}Il(sa){return v.DOMElementExtensions.Sj(this.Df,sa)}Vn(){}ap(){}dispose(){this.vp||(h.KeyInputManager.instance.Ca(f.a.Ne,this.Df,this.qZ),e.a.df(this.CX),this.CX=Array(74),this.Pd=null,super.dispose(),this.vp=!0)}Moa(sa){if(!this.get_visible())return!1;sa=this.CX[sa];return!!sa&&sa.isVisible}wnd(sa){return this.Moa(sa)?this.CX[sa].pN():
null}HH(sa){return!!this.CX[sa]}qWb(sa,ba){if(sa=this.CX[sa])sa.update(ba),sa.Ujk()}MD(sa,ba,ua,R){ua=void 0===ua?null:ua;R=void 0===R?null:R;db.EwaSettings.isChangeGateEnabled("OfficeVSO:8190523_BizBarHeaderTTVRFix")?Object(Za.a)(()=>{this.wye(sa,ba,ua,R)},this.Pd.ma):this.wye(sa,ba,ua,R)}wye(sa,ba,ua,R){ua=void 0===ua?null:ua;R=void 0===R?null:R;let Y=!1;if(db.EwaSettings.isChangeGateEnabled("OfficeVSO:8190523_BizBarHeaderTTVRFix")&&!this.qke){var La=db.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?`${x.a.Iid} ${x.a.N_e}`:x.a.Iid;this.addCssClass(La);this.qke=!0}if(this.HH(sa))ua=this.CX[sa].get_visible();else{this.set_visible(!0);La=sb.Uhf(this.$)[sa];this.CX[sa]=this.z1(sa,ba,ua,R);ua=!1;Y=!0;R="";let Ma=0;ba&&(R=ba.MessageIdName,Ma=ba.MessageId);const lb=La.yya,pb=ya.a.instance.Gea(new Date);b.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${sa}, time from app interactive: ${pb}`);db.EwaSettings.isChangeGateEnabled("OfficeVSO:7232357_AvoidBsqmReportingForSuccessBizBars")&&
4===La.businessBarType||fc.a(this.$).lVd(La.hash,R,Ma,k.a.AKc,!0,1,ba,lb)}ua||!y.BusinessBarManager.Xkc().includes(sa)&&!Y||(this.CX[sa].set_visible(!0),this.$.GL())}removeEntry(sa){return this.lBj(sa)}kTd(){e.a.df(this.CX);this.CX=Array(74);this.set_visible(!1)}lBj(sa){if(!this.HH(sa))return!1;e.a.Ma(this.CX[sa]);this.CX[sa]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.GL();return!0}z1(sa,ba,ua,R){ua=void 0===ua?null:ua;R=void 0===R?null:R;const Y=sb.Uhf(this.$)[sa],La=!!(this.$.hg&
64),Ma=this.$.Jbb()&&db.EwaSettings.isChangeGateEnabled("OfficeVSO:7976786_EnableFileSaveAsForSaveToOneDriveScenario");switch(sa){case 23:sa=Ma?new z.a(this,Y,617689800):new A.a(this,Y);break;case 2:case 4:case 25:case 26:case 36:case 35:sa=new A.a(this,Y);break;case 12:case 29:case 30:case 31:case 32:case 57:sa=La?new z.a(this,Y,-8805455):new A.a(this,Y);break;case 34:sa=La?new Ib(this,Y,-8805455,-104572626):new A.a(this,Y);break;case 22:sa=new F(this,Y,-8805455);break;case 46:case 45:sa=La?new N(this,
Y,ba,0,-8805455):new I(this,Y,ba,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:sa=new I(this,Y,ba,0);break;case 19:sa=new A.a(this,Y);break;case 47:sa=new I(this,Y,ba,0);break;case 6:case 14:sa=new Q(this,Y,ba.HelpTopicId);break;case 67:case 65:sa=new fa(this,Y,ba.HelpTopicId);break;case 73:sa=new fa(this,Y,Db.a.sYf);break;case 72:sa=new F(this,Y,-1698025133);break;case 37:sa=new fa(this,Y,t.a.Rwh);break;case 38:sa=new A.a(this,Y);break;case 71:sa=new A.a(this,Y);break;case 68:sa=new F(this,
Y,924877417);break;case 16:sa=new A.a(this,Y);sa.title=l.a.Bm(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);sa.message=l.a.Bm(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:sa=new z.a(this,Y,-1762562205);sa.hideCloseButton=!0;break;case 20:sa=new Bb(this,Y);break;case 21:case 56:sa=new A.a(this,Y);break;case 28:sa=new A.a(this,Y);break;case 24:sa=new eb(this,Y);break;case 27:sa=new wa(this,Y);break;case 39:sa=new nb.a(this,Y);break;case 40:sa=new n.a(this,Y);
break;case 41:sa=new la.a(this,Y);break;case 42:sa=new Z.a(this,Y);break;case 48:sa=new A.a(this,Y);break;case 49:sa=new A.a(this,Y);break;case 50:sa=new A.a(this,Y);break;case 51:sa=new A.a(this,Y);break;case 52:sa=new A.a(this,Y);break;case 53:sa=new Ca.a(this,Y);break;case 54:sa=new ta.a(this,Y);break;case 55:sa=new K(this,Y);break;case 5:sa=new ca(this,Y);break;case 58:sa=new z.a(this,Y,-1753056834);ba?(ba=ba.Directive,Ua.a.Ns(ba)||"&nbsp;"===ba||(sa.message=ba)):ua&&(sa.message=ua);break;case 59:sa=
new ra(this,Y);break;case 60:sa=new A.a(this,Y);break;case 63:sa=new fa(this,Y,t.a.V2i);break;case 61:sa=new Ea(this,Y,t.a.X7g,-8805455);break;case 66:sa=new Ea(this,Y,t.a.Xvj,1461300262);break;case 62:sa=new hb(this,Y,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout");sa.message=ua;break;case 70:sa=new fb.a(this,Y,-1190551534);break;case 64:sa=new gb(this,Y,this.$,R);break;case 69:sa=new Mb(this,Y,R);break;default:sa=new I(this,Y,ba,7)}sa.xQe();return sa}static Uhf(sa){const ba=
sa.Jbb()&&db.EwaSettings.isChangeGateEnabled("OfficeVSO:7976786_EnableFileSaveAsForSaveToOneDriveScenario");sa=Jb.a.Roa()?261:260;return sb.eIe||(sb.eIe=[new L(0,276,277,278,0,0,sb.Hma,1,"BB_UnableToRefreshLock"),new L(1,276,277,278,0,0,sb.Hma,1,"BB_UnableToRefreshLockExpected"),new L(2,268,269,0,0,0,sb.Sy,5,"BB_WorkbookAlmostTooLarge"),new L(3,270,271,272,0,0,sb.Hma,1,"BB_WorkbookTooLarge"),new L(4,259,sa,0,0,0,sb.Sy,5,"BB_ExternalWorkbookLinksDisabled"),new L(5,263,262,264,0,0,sb.Hma,5,"BB_ExternalWorkbookLinksShowError",
"Warning_MessageBar_16"),new L(6,265,266,267,0,0,sb.Qk,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new L(7,251,252,253,0,0,sb.Qk,5,"BB_UnsupportedFeatures"),new L(8,0,0,0,0,0,sb.Qk,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new L(9,0,0,0,0,0,sb.Qk,0,"BB_CollabDataStringsLocaleMismatch"),new L(10,0,0,0,0,0,sb.Qk,0,"BB_CollabDataLocaleMismatch"),new L(11,279,280,281,0,0,sb.Hma,1,"BB_LastGenericStatusError"),new L(12,282,283,284,0,0,sb.Sy,5,"BB_ScratchPadWarning"),new L(13,285,286,287,0,0,sb.Hma,
1,"BB_AuthenticationLost"),new L(14,288,289,290,0,0,sb.Sy,5,"BB_OdfCompatibilityIssues"),new L(15,0,575,0,0,0,sb.Sy,5,"BB_PivotChartInteractivityMissingWarning"),new L(16,0,0,0,0,0,sb.Qk,2,"BB_WorkbookIsIrmProtected"),new L(17,0,0,0,0,0,sb.Qk,0,"BB_BIFeatureNotAvailable"),new L(18,291,292,287,0,0,sb.Sy,5,"BB_AnonymousCreateMode"),new L(19,254,255,0,0,0,sb.Sy,5,"BB_UnsupportedInteractiveReportEditing"),new L(20,0,0,0,0,0,sb.Qk,0,"BB_MobileAppCampaignBizBar"),new L(21,297,298,0,0,0,sb.Qk,0,"BB_TransientServerCommunicationFailures"),
new L(22,1643,1654,1655,0,0,sb.Qk,5,"BB_EditAttemptInReadOnly"),new L(23,1643,ba?2348:1654,ba?2349:0,0,0,sb.Qk,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new L(24,0,T.HelperMethods.pjk(),1632,0,0,sb.Qk,3,"BB_UnsupportedBrowser"),new L(25,300,301,0,0,0,sb.Qk,2,"BB_ReadOnlyPermissions"),new L(26,302,303,0,0,0,sb.Qk,2,"BB_DocumentIsIrmProtectedWarning"),new L(27,0,0,0,0,0,sb.Sy,5,"BB_PolicyWarningMessage"),new L(28,1285,299,0,0,0,sb.Qk,0,"BB_WorkingOnIt"),new L(29,1643,1641,1642,0,0,sb.Qk,2,"BB_PasswordProtectedWorkbookLockedForEdit"),
new L(30,1656,1657,1658,0,0,sb.Qk,5,"BB_WorkbookIsReadOnlyRecommended"),new L(31,1643,1659,1660,0,0,sb.Qk,5,"BB_WorkbookHasPasswordToModify"),new L(32,1643,1661,1664,0,0,sb.Qk,3,"BB_LegacySharedWorkbookEditWarning"),new L(33,1651,1662,253,0,0,sb.Qk,5,"BB_LegacyConnectionsWarning"),new L(34,1643,1960,1961,1962,0,sb.Qk,0,"BB_TooManyLoadBlockingFloatingObjects"),new L(35,1652,1653,0,0,0,sb.Qk,2,"BB_GroupedSlicers"),new L(36,313,314,0,0,0,sb.Sy,5,"BB_ThirdPartyAddinDisabled"),new L(37,1789,1790,0,0,1791,
sb.Qk,5,"BB_FinanceLinkedEntityDisclaimerBar"),new L(38,1818,1819,0,0,0,sb.Sy,5,"BB_WolframDeprecationAlertBar"),new L(39,0,0,0,0,0,sb.Qk,0,"BB_WacGdprNotice"),new L(40,0,0,0,0,0,sb.Qk,0,"BB_AutomaticSensitivityLabel"),new L(41,0,0,0,0,0,sb.Qk,0,"BB_RecommendedSensitivityLabel"),new L(42,0,0,0,0,0,sb.Qk,0,"BB_MandatorySensitivityLabel"),new L(43,315,316,317,0,0,sb.Qk,0,"BB_LocalStorageDisabled"),new L(44,632,633,0,0,0,sb.Qk,0,"BB_AutoRefreshDisabled"),new L(45,1014,1012,1016,1314,0,sb.Qk,4,"BB_CorruptedFileRepaired"),
new L(46,1015,1013,1016,1314,0,sb.Qk,5,"CorruptedOdsFileRepaired"),new L(47,273,274,275,0,0,sb.Sy,5,"BB_MinorVersionLimitReached"),new L(48,304,305,0,0,0,sb.Sy,5,"BB_SensitivityApplicationGenericError"),new L(49,306,308,0,0,0,sb.Sy,5,"BB_SensitivityApplicationTooLargeFileError"),new L(50,307,308,0,0,0,sb.Sy,5,"BB_SensitivityApplicationLabelNotSupportedError"),new L(51,309,310,0,0,0,sb.Sy,5,"BB_SensitivityApplicationLabelDisabledError"),new L(52,311,312,0,0,0,sb.Sy,5,"BB_SensitivityApplicationMandatoryConflictError"),
new L(53,0,0,0,0,0,sb.Sy,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new L(54,0,0,0,0,0,sb.Sy,5,"BB_SensitivityApplicationSetLabelError"),new L(55,2119,2120,2121,2124,0,sb.Qk,5,"BB_ExternalWorkbookLinksPromptEnableContent","Warning_MessageBar_16"),new L(56,297,298,0,0,0,sb.Qk,0,"BB_NetworkDown"),new L(57,318,319,320,0,0,sb.Qk,2,"BB_DefaultToViewDueToCogs"),new L(58,1815,1816,1817,0,0,sb.Qk,1,"BB_RefreshLinkedEntityErrorBar"),new L(59,1792,1793,1794,1795,0,sb.Qk,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),
new J(60,250,0,0,0,sb.Qk,5,"BB_CanvasHealth"),new L(61,1017,1018,1314,0,1019,sb.Qk,5,"BB_MismatchedFileFormatConverted"),new L(62,2238,0,2240,0,0,sb.Qk,5,"BB_OptimizeWorkbook"),new L(63,321,322,0,0,323,sb.Qk,0,"BB_NovModePostDepreciation"),new L(64,0,0,0,0,0,sb.Qk,0,"BB_OfficeScriptsRunning"),new L(65,2214,2215,0,0,2217,sb.Qk,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new L(66,324,325,0,0,326,sb.Qk,5,"BB_ReadOnlyPivotTable"),new L(67,2214,2216,0,0,2217,sb.Qk,0,"BB_PowerQueryRefreshHostNotSupported"),
new L(68,1057,r.a.$pc?1059:1058,1056,0,0,sb.Qk,4,"BB_RefreshPageAfterEnablingTheExtension"),new L(69,0,0,0,0,0,sb.Qk,0,"BB_MsFormsDataSyncStatus"),new L(70,0,0,0,0,0,sb.Sy,5,"BB_DataCleansingSuggestions"),new J(71,2324,0,0,0,sb.Qk,4,"BB_EditInMiniWAC","EditExcel_16"),new L(72,2326,2327,2325,0,0,sb.Sy,5,"BB_PowerQueryUnsupportedTeams"),new L(73,2326,2328,0,0,2217,sb.Sy,5,"BB_PowerQueryEnableThirdPartyCookies")])}}sb.Hma=qb.a.ULh;sb.Sy=qb.a.WLh;sb.Qk=qb.a.VLh;sb.eIe=null;Object(w.a)(sb,"BusinessBarControl",
u.a,[57])},1193:function(w,B,a){w=a(0);var b=a(2),c=a(16),h=a(30),f=a(96),e=a(15),k=a(143),l=a(353),r=a(82),v=a(8),u=a(67),x=a(13),t=a(142),m=a(470);class n{constructor(la,ta){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=ta;this.parentElement=la}Cph(){const la=this.Dph();m.a(this.$,243,242,0,ta=>{this.cardViewManager=ta;ta.z2j(this.parentElement,la)})}Ilf(){this.cardViewManager&&this.cardViewManager.C$a(-1,
-1,this.parentElement)}Dph(){const la={layoutId:"AutoDetectTooltip"};la.description=this.longDescription;la.convertToDomainName=this.convertToDomainName;la.longDescription=this.longDescription;la.urlValue=this.urlValue;la.imageAltText=this.imageAltText;la.helpText=this.helpText;la.helpId=this.helpId;return la}}Object(w.a)(n,"AutoDetectCardManager",null,[]);var A=a(35),y=a(222),z=a(33),F=a(235),D=a(18),I=a(54);class H extends r.a{constructor(la,ta,Ca){super();this.Of=Ga=>{if(Ga.Be.id===this.lNa.firstChild.id){Ga=
this.XFe;const Oa={};Oa.Id=Ga.Kub;this.convertToLinkedEntityManager.gcd(Oa,!0,Ga);this.lNa.removeChild(this.lNa.firstChild);return!0}return!1};this.XFe=la;this.convertToLinkedEntityManager=ta;this.lNa=document.createElement("div");this.lNa.className="clip16x16";this.qAa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',z.a.Bm("autodetectid"+this.XFe.left),D.a.qjd,I.a.Bj(11));Ca.dl(this.lNa,this.qAa);la=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");
F.a.instance.va(e.a.click,la,this.Of)}get domElement(){return this.lNa}dispose(){if(this.lNa){const la=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");F.a.instance.Ca(e.a.click,la,this.Of)}super.dispose()}static get Mbh(){return"clip16x16"}}Object(w.a)(H,"AutoDetectColumnHeaderButton",r.a,[]);var N=a(1),U=a(1115),L=a(11),J=a(20),P=a(213);class K extends r.a{constructor(la,ta,Ca){super();this.De=null;this.$=la;this.gridView=J.h(la);this.convertToLinkedEntityManager=ta;this.De=
Ca;this.Lad=new P.a}dispose(){super.dispose()}MBh(la){for(let ta of this.gridView.Ola)for(let Ca of ta){const Ga=Ca,Oa=Ga.Dx,eb=U.a(Ga.S8);this.qVg(la,eb,Oa);Ga.o_d(eb)}}qVg(la,ta,Ca){if(ta.length){var Ga=Ca.length;Ca[Ga-1]<la.left||(Ca=L.HelperMethods.zA(new y.a(Ca),0,Ga,la.left,L.HelperMethods.HI),0>Ca||!(ta=ta[Ca]))||(this.gridView.rtl?ta.classList.add(A.a.ePh):ta.classList.add(A.a.dPh),this.Lad.Hd(la.left)||this.Lad.add(la.left,new H(la,this.convertToLinkedEntityManager,this.De)),la=this.Lad.ka(la.left).domElement,
!ta.getElementsByClassName(H.Mbh).length&&this.T6j(ta)&&ta.appendChild(la))}}T6j(la){const ta=parseInt(la.style.width,10);var Ca=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";Ca=K.mrh(Ca);la=gridRenderer.CanvasRendererGlobals.measureTextWidth(this.De.Hgi(la.firstChild.innerHTML),Ca,!0,N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<ta-(ta/2+la/2)?!0:!1}static mrh(la){return`${"normal"} ${"normal"} ${la} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}
Object(w.a)(K,"AutoDetectColumnHeaderManager",r.a,[]);var ca=a(436),T=a(24),Q=a(73),fa=a(161),ha=a(14),Ea=a(12),ra=a(107),Z=a(71);a.d(B,"a",function(){return wa});class wa extends r.a{constructor(la,ta,Ca,Ga,Oa){super();this.isMac=h.a.isMac;this.y2a=-1;this.icc=null;this.Fxa=-1;this.kSa=this.Rrc=this.W2d=this.CBa=this.YFe=!1;this.hX=null;this.fi=()=>{this.AAa&&this.gridView&&this.p_()};this.Bf=()=>{this.Fx()};this.Of=()=>{this.vMa();J.h(this.$).nl(!0,!1)};this.OCa=(nb,$a)=>{$a?(this.kug(this.icc),
this.Ckg()):(nb=[29],this.gridView.ee.cn(nb),this.gridView.ee.Yn(null,nb),this.hX&&this.hX.Ilf())};this.ml=()=>{this.nbb()&&this.Ql.hide();1===this.gridView.ga.eh&&this.p_()};this.Iz=()=>{const nb=this.gridView.ga.eh;this.gridView.ga.ra.activeCell&&1===nb&&this.p_()};this.onKeyUp=nb=>this.Isc?this.CBa?!1:17===nb.Da.keyCode&&this.W2d?(this.kSa?(this.Ckg(),this.Hhb()):this.Reg(),!0):!1:this.CBa=!1;this.onKeyDown=nb=>{if(!this.Isc)return this.CBa=!1;this.W2d=!1;this.CBa=nb.ctrlKey;switch(nb.Da.keyCode){case 27:return this.kSa?
(this.OCa(null,!1),this.Hhb()):this.hX&&(this.hX.Ilf(),this.Reg()),!0;case 13:if(this.kSa)return this.kSa=!1,this.vMa(),!0;break;case 17:return this.W2d=!0}return!1};const {AutoDetectActionButton:eb}=a(1256);this.$=la;this.Lub=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);ta||c.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=Ga;Ga.fOb();this.Ql=new eb(la,ta,this.Of,
Ca,"");this.n7g=new K(this.$,Ga,Oa);this.gridView=J.h(this.$);this.gridView.ga.eK(this.fi);this.gridView.me.ntb(this.fi);this.gridView.$u(this.Iz);la.Zl(this.Bf);la.cC(this.ml);this.gridBlockManager=Object(k.a)(514,this.gridView.ya);this.vu=la.frame.QB;this.p_()}get Df(){return this.Ql.domElement(1)}get Isc(){const la=this.Ql.domElement(wa.Eia);return la?ha.DOMElementExtensions.isVisible(la):!1}get AAa(){return this.$.isEditMode&&N.EwaSettings.Fa(128)&&N.EwaSettings.Fa(131)&&(new fa.a(this.$.ta)).yk?
!1:-1!==this.Fxa}dispose(){this.gridView&&this.gridView.ga.YI(this.fi);if(this.$){const la=this.$;la.Rp(this.Bf);la.JE(this.ml);J.h(la).Vx(this.Iz)}f.a.Ma(this.Ql);this.vu=this.$=this.gridView=this.Ql=null;super.dispose()}Fx(){this.OCa(null,!1);this.y2a=-1;this.Ql.hide();this.Zhk();this.kSa=!1}Hhb(){this.Ql.getButton(wa.Eia).LQb();this.kSa=!1}Reg(){this.Ql.getButton(wa.Eia).Sfb();this.kug(this.icc);this.kSa=!0;N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",
!1)?void t.a.Pu(x.g).then(la=>{la.aha(Ea.a.instance.ha(1751))}):this.$.ia.Od(211,la=>{la.aha(Ea.a.instance.ha(1751))})}onAutoDetectUIShown(){if(this.AAa&&-1!==this.y2a)this.convertToLinkedEntityManager.onAutoDetectUIShown()}o7g(la){var ta=new T.Range(1===la.top?1:la.top-1,la.left,la.bottom,la.right,!0,!1);ta=this.gridView.getRangeInformation(ta);for(const Ca of ta)if(Object(l.a)(ca.AutoDetectRange,Ca)&&this.moc(la,!1,Ca))return!0;return!1}vMa(){if(this.AAa&&-1!==this.y2a){this.Ql.getButton(wa.Eia).Sfb();
var la={};la.Id=this.Fxa;la.StringId=null;this.convertToLinkedEntityManager.gcd(la,!0,this.icc);c.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");la=[Object(b.a)(new Z.a,{name:"Domain",int64:this.Fxa})];ra.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,la);this.Fxa=-1}}x3h(){let la=Ea.a.instance.ha(1747);if(-1!==this.Fxa){la+=" ";try{la+=this.convertToLinkedEntityManager.IIb(this.Fxa.toString())}catch(ta){c.ULS.sendTraceTag(537166982,0,
10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.Fxa}`)}}la+=" ";return la=this.Lub?la+Ea.a.instance.ha(1750):la+Ea.a.instance.ha(this.isMac?1749:1748)}Ckg(){this.Lub&&(this.hX||(this.hX=new n(this.Df,this.$),this.hX.convertToDomainName=Ea.a.instance.ha(1752),this.hX.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.hX.imageAltText=Ea.a.instance.ha(1754),this.hX.helpId="HID_DataTypes_Wolfram",this.hX.helpText=
Ea.a.instance.ha(1753)),this.hX.longDescription=this.convertToLinkedEntityManager.N6d(this.y2a.toString()),this.hX.Cph())}moc(la,ta,Ca){if((new T.Range(Ca.top,Ca.left,Ca.bottom===v.a.Bh?Ca.bottom:Ca.bottom+1,Ca.right,!0,!1)).If(la)){if(ta){if(Ca&&Ca.Kub!==this.y2a){this.y2a=Ca.Kub;la=Ca.Kub.toString();ta=this.Lub?"":this.convertToLinkedEntityManager.N6d(la);const Ga=this.convertToLinkedEntityManager.Tti(la);this.Ql.xlb(this.convertToLinkedEntityManager.IIb(la),ta,Ga,wa.Eia)}this.Fxa=Ca.Kub;this.icc=
Ca}return!0}return!1}p_(){if(this.convertToLinkedEntityManager){var la=this.gridView.ga.eh;if(this.gridBlockManager&&this.gridBlockManager.Ftd){var ta=this.gridView.ga.ra.activeCell,Ca=!this.gridBlockManager.Kt(ta),Ga=this.gridView.getRangeInformation(this.gridView.Rl);for(const Oa of Ga)if(Object(l.a)(ca.AutoDetectRange,Oa))switch(Ga=Oa,Ga.khh){case 3:if(this.moc(ta,!0,Ga)){if(1!==la||Ca){this.Fx();return}c.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");
this.VSd();this.Ql.Wha(ta,this.OCa);this.YFe||(this.YFe=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.LoadClassifier",!1)||N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TestGate.PasteClassifier",!1))&&this.n7g.MBh(Ga);break;default:c.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.Fx()}}kug(la){const ta=[29];this.gridView.ee.Yn(la,
ta);this.gridView.ee.Iu(ta)}nbb(){return this.$.ea.isNamedObjectViewMode&&Q.f(this.$.pa)}VSd(){this.Lub&&!this.Rrc&&this.vu&&(this.vu.Rw(e.a.Ne,this.$.domElement,this.onKeyDown,!0),this.vu.Rw(e.a.tg,this.$.domElement,this.onKeyUp,!0),this.Rrc=!0)}Zhk(){this.Lub&&this.Rrc&&this.vu&&(this.vu.Yw(e.a.Ne,this.$.domElement,this.onKeyDown,!0),this.vu.Yw(e.a.tg,this.$.domElement,this.onKeyUp,!0),this.Rrc=!1)}static get Eia(){return 1}static D5h(la){return Ea.a.instance.ha(1808)+u.a.space+la}}Object(w.a)(wa,
"AutoDetectManager",r.a,[])},1195:function(w,B,a){a.r(B);w=a(734);var b=a(0),c=a(16),h=a(5),f=a(96),e=a(30),k=a(37),l=a(82),r;(function(ha){ha[ha.unableToRefreshLock=0]="unableToRefreshLock";ha[ha.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";ha[ha.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";ha[ha.workbookTooLarge=3]="workbookTooLarge";ha[ha.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";ha[ha.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";
ha[ha.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";ha[ha.unsupportedFeatures=7]="unsupportedFeatures";ha[ha.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";ha[ha.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";ha[ha.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";ha[ha.lastGenericStatusError=11]="lastGenericStatusError";ha[ha.scratchPadWarning=12]="scratchPadWarning";ha[ha.authenticationLost=13]=
"authenticationLost";ha[ha.odfCompatibilityIssues=14]="odfCompatibilityIssues";ha[ha.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";ha[ha.workbookIsIrmProtected=16]="workbookIsIrmProtected";ha[ha.biFeatureNotAvailable=17]="biFeatureNotAvailable";ha[ha.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";ha[ha.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";ha[ha.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";ha[ha.transientServerCommunicationFailures=
21]="transientServerCommunicationFailures";ha[ha.editAttemptInReadOnly=22]="editAttemptInReadOnly";ha[ha.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";ha[ha.unsupportedBrowser=24]="unsupportedBrowser";ha[ha.readOnlyPermissions=25]="readOnlyPermissions";ha[ha.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";ha[ha.policyWarningMessage=27]="policyWarningMessage";ha[ha.workingOnIt=28]="workingOnIt";ha[ha.passwordProtectedWorkbookLockedForEdit=29]=
"passwordProtectedWorkbookLockedForEdit";ha[ha.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";ha[ha.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";ha[ha.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";ha[ha.legacyConnectionsBB=33]="legacyConnectionsBB";ha[ha.tooManyLoadBlockingFloatingObjectsBB=34]="tooManyLoadBlockingFloatingObjectsBB";ha[ha.groupedSlicersBB=35]="groupedSlicersBB";ha[ha.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";
ha[ha.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";ha[ha.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";ha[ha.wacGdprNotice=39]="wacGdprNotice";ha[ha.automaticSensitivityLabel=40]="automaticSensitivityLabel";ha[ha.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";ha[ha.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";ha[ha.localStorageDisabled=43]="localStorageDisabled";ha[ha.autoRefreshDisabled=44]="autoRefreshDisabled";ha[ha.corruptedFileRepaired=
45]="corruptedFileRepaired";ha[ha.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";ha[ha.minorVersionLimitReached=47]="minorVersionLimitReached";ha[ha.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";ha[ha.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";ha[ha.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";ha[ha.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";
ha[ha.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";ha[ha.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";ha[ha.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";ha[ha.promptEnableExternalLinks=55]="promptEnableExternalLinks";ha[ha.networkDown=56]="networkDown";ha[ha.defaultToViewDueToCogs=57]="defaultToViewDueToCogs";ha[ha.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";
ha[ha.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";ha[ha.canvasHealth=60]="canvasHealth";ha[ha.mismatchedFileFormatConverted=61]="mismatchedFileFormatConverted";ha[ha.optimizeWorkbook=62]="optimizeWorkbook";ha[ha.novModePostDepreciation=63]="novModePostDepreciation";ha[ha.officeScriptsRunning=64]="officeScriptsRunning";ha[ha.powerQueryRefreshDataSourceNotSupported=65]="powerQueryRefreshDataSourceNotSupported";ha[ha.readOnlyPivotTable=66]="readOnlyPivotTable";
ha[ha.powerQueryRefreshHostNotSupported=67]="powerQueryRefreshHostNotSupported";ha[ha.refreshPageAfterEnablingTheExtension=68]="refreshPageAfterEnablingTheExtension";ha[ha.msFormsDataSyncStatus=69]="msFormsDataSyncStatus";ha[ha.dataCleansingSuggestions=70]="dataCleansingSuggestions";ha[ha.editInMiniWAC=71]="editInMiniWAC";ha[ha.powerQueryUnsupportedTeams=72]="powerQueryUnsupportedTeams";ha[ha.powerQueryEnableThirdPartyCookies=73]="powerQueryEnableThirdPartyCookies";ha[ha.count=74]="count"})(r||(r=
{}));Object(b.b)("EwaBusinessBarEntryType",r);var v=a(6),u=a(1121);class x extends Sys.EventArgs{constructor(ha,Ea,ra){ra=void 0===ra?null:ra;super();this.E4a=ha;this.kgd=Ea;this.data=ra}}Object(b.a)(x,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var t=a(1124),m=a(1122),n=a(1126);a(1125);var A=a(1119),y=a(484),z=a(62),F=a(40),D=a(670),I=a(34),H=a(1),N=a(20),U=a(66),L=a(74),J=a(962),P=a(142),K=a(13),ca=a(1123),T=a(94);a.d(B,"BusinessBarManager",function(){return fa});var Q;let fa=Q=
class extends l.a{constructor(ha,Ea){Ea=void 0===Ea?!ha.b9:Ea;super();this.Xa=new k.a;this.cT=null;this.CRc=[];this.Zvc=()=>{this.$.qa.HQa?this.removeEntry(13):this.ej(13,null)};this.Uj=(ra,Z)=>{for(let wa=0,la=Q.Xkc().length;wa<la;wa++)ra=Q.Xkc()[wa],this.removeEntry(ra);Z.context&&0<Z.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),
this.removeEntry(21));this.GGj()};this.ip=(ra,Z)=>{var wa;ra=this.IUh(Z.errors);let la=[];for(let Ca=0,Ga=ra.length;Ca<Ga;++Ca){const Oa=ra[Ca];if(1===Oa.Type&&Oa.Appearance&32)la=this.Upi(Oa,la);else if(Z.MQj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var ta=(null===(wa=Z.context)||void 0===wa?0:wa.stopwatch)?Z.context.stopwatch.pf:-1;5E3>ta?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${ta}ms).`):
h.AFrameworkApplication.YLi()||this.pYg(Oa,Z.context.methodName)}ta=[...Q.Xkc()];for(let eb=0,nb=la.length;eb<nb;++eb){const $a=la[eb];this.ej($a,Oa);Array.remove(ta,$a)}for(let eb=0,nb=ta.length;eb<nb;++eb)this.removeEntry(ta[eb])}};this.vf=(ra,Z)=>{this.Bf(ra,Z)};this.Bf=()=>{const ra=this.$.ea;ra.Ee||ra.pj()||(this.kTd(),this.CRc.length=0)};this.fg=(ra,Z)=>{this.$.ea.pj()&&!Z.VY||this.Lnf(Z.VY)};this.oNb=()=>{const ra=this.$.userOperationManager.Jkc();ra&&ra.operation.flags&1&&this.Sjg()};this.COf=
()=>{this.Sjg()};this.gi=()=>{this.VKe();this.bkg()};this.VQ=()=>{if(this.$.x9&&this.$.ea.pj()&&this.$.ea.Ee)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const ra=this.$.ia.Ja(331);ra&&ra.WNa||this.removeEntry(55);this.removeEntry(5)}};this.$=ha;this.v3a=Ea;this.j6g();h.AFrameworkApplication.Wf&&h.AFrameworkApplication.Wf.etb(this);
this.z2a=Array(74);for(let ra=0;74>ra;ra++)this.z2a[ra]=null;this.ik=D.EcmaDateClock.instance;this.Ayf=this.ik.Re.getTime();Ea&&(Ea=ha.qa,Ea.wA(this.ip),Ea.gu(this.Uj),Ea.jtb(this.Zvc),Ea.S2a(this.Zvc),ha.ea.Yl(this.vf),ha.ea.kx(this.gi),ha.zn(this.fg),ha.Zl(this.Bf),ha.ea.R0(this.VQ),ha.userOperationManager.xt(this.oNb),H.EwaSettings.Fa(158)&&ha.ea.Qj.get(45)&&h.AFrameworkApplication.da.na("SupportsPolicies")||this.Gjf(),this.Lnf(U.c(ha)))}Gjf(){I.a.xs(this.$.ea.MI)&&this.ip(this,new y.a(this.$.ea.MI,
null,!1,-1,-1,-1,-1,"",-1,"",-1))}XYg(ha){this.Xa.addHandler("bBarAttachedOrDetached",ha)}get thd(){return this.CRc}get domElement(){return this.cT?this.cT.domElement:null}dispose(){if(this.$){const ha=this.$,Ea=ha.qa;Ea.IB(this.ip);Ea.Kv(this.Uj);Ea.KBc(this.Zvc);Ea.bQb(this.Zvc);ha.ea.gm(this.vf);ha.ea.Ky(this.gi);ha.uo(this.fg);ha.Rp(this.Bf);ha.ea.q4(this.VQ);ha.userOperationManager.ur(this.oNb);N.h(ha).me.Qp(this.COf)}f.a.Ma(this.cT);this.$=this.cT=null;super.dispose()}QCi(ha){switch(ha){case 4:case 5:case 11:case 55:case 59:case 7:case 37:case 38:case 71:return!0;
default:return!1}}ej(ha,Ea,ra,Z,wa){ra=void 0===ra?null:ra;Z=void 0===Z?null:Z;wa=void 0===wa?null:wa;if(!this.$.isMobileMode||this.QCi(ha))this.v3a&&!this.HH(ha)&&(this.z2a[ha]=this.ik.Hia,this.cT.MD(ha,Ea,Z,wa),this.Xa.raiseEvent("bBarAttachedOrDetached",new x(ha,!0,ra))),Ea&&32===Ea.Appearance&&L.a(this.$).Pf.aga(Ea)}b3j(ha,Ea,ra,Z){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");A.a.initialize(ha,Ea,ra,Z);this.ej(39,null)}X1j(ha,Ea,ra,Z){u.a.initialize(ha,Ea,ra,
Z);this.ej(40,null)}n4j(ha,Ea,ra,Z){m.a.initialize(ha,Ea,ra,Z);this.ej(41,null)}A2j(ha,Ea,ra,Z){ca.a.initialize(ha,Ea,ra,Z);this.ej(70,null)}C3j(ha,Ea,ra,Z){t.a.initialize(ha,Ea,ra,Z);this.ej(42,null)}u4j(ha,Ea,ra,Z){n.a.initialize(ha,Ea,ra,Z);this.ej(54,null)}removeEntry(ha){this.v3a&&(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(r,ha)}`),this.z2a[ha]=null,this.cT.removeEntry(ha)&&this.Xa.raiseEvent("bBarAttachedOrDetached",
new x(ha,!1)))}Moa(ha){return this.v3a?this.cT.Moa(ha):!1}HH(ha){return this.v3a?this.cT.HH(ha):!1}Vdb(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")}nLb(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}j6g(){const {BusinessBarControl:ha}=a(1168);if(this.v3a&&!this.cT){N.h(this.$).me.Yp(this.COf);var Ea=document.getElementById(this.$.He+
v.a.gIe);this.cT=new ha(this.$,Ea)}}kTd(){this.v3a&&this.cT.kTd()}GGj(){if(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const Ea=this.ik.Hia;if(3E5<=Ea-this.Ayf){this.Ayf=Ea;for(let ra=0;74>ra;ra++){var ha=this.z2a[ra];if(ha&&(ha=Ea-ha,3E5<=ha)){const Z=Enum.toString(r,ra);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${Z}] was activated but not turned off for ${ha} Millis`)}}}}}IUh(ha){const Ea=[];for(const ra of ha)switch(ra.MessageId){case -113742550:const Z=
[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||I.a.Jj(ha,Z))&&Ea.push(-113742550)}return I.a.IE(ha,Ea)}Upi(ha,Ea){switch(ha.MessageId){case 2113407564:const ra=I.a.z4a([1821390342,-943219229,-502303485,1437034227]);for(let Z=0;Z<ra.length;Z++)ra[Z].HelpTopicId=ha.HelpTopicId,ra[Z].HelpDescription=ha.HelpDescription,this.CRc.push(ra[Z])}switch(ha.MessageId){case -395951567:this.ej(6,ha);break;case 1643490758:this.ej(4,ha);break;
case -907264831:this.ej(5,ha);break;case 757111532:case 2113407564:this.ej(7,ha);break;case 2010656511:this.ej(15,ha);break;case 1321660996:this.$.Led=!0;this.ej(8,ha);break;case 526339737:this.$.Led=!0;this.ej(9,ha);break;case -407088521:this.ej(10,ha);break;case 1756116017:this.ej(14,ha);break;case -1703455218:this.ej(17,ha);break;case 1393475740:this.ej(25,ha);break;case -949523941:this.ej(26,ha);break;case 1779381952:this.ej(44,ha);break;case 1421575100:this.ej(45,ha);break;case 613676060:this.ej(46,
ha);break;case 1233668252:this.ej(61,ha);break;case 1911608588:ha=!!(this.$.hg&64);!this.$.ea.pj()&&ha&&Ea.push(29);break;case 1544494907:break;case -655555355:Ea.push(this.VBd()?1:0);break;case -1221382671:Ea.push(2);break;case 1662282929:Ea.push(3);break;case 104919273:this.$.ea.pj()||Ea.push(30);break;case -689453604:ha=!!(this.$.hg&64);this.$.ea.Skf=!0;!this.$.ea.pj()&&ha&&Ea.push(31);break;case 157762400:this.$.ea.Bpc=!0;!this.$.ea.pj()&&this.$.hg&64&&!this.$.isEditMode&&Ea.push(32);break;case -1125398042:!this.$.ea.pj()&&
this.$.hg&64&&!this.$.isEditMode&&Ea.push(34);break;case -73730134:!this.$.ea.pj()&&this.$.hg&64&&Ea.push(33);break;case -293349236:Ea.push(65);break;case 1580811823:Ea.push(67);break;case -37299333:break;case 136737622:Ea.push(47);break;case -1780327030:this.ej(55,ha);break;case -113742550:this.ej(57,ha);break;case -260312420:this.$.ea.pj()||Ea.push(66);break;case 784737213:this.$.ea.pj()||Ea.push(70);break;default:this.ej(11,ha)}return Ea}Gwi(){if(h.AFrameworkApplication.da.na("WildFireExcelBizBar")&&
!J.a.THi(J.a.J9e(1))&&(e.a.jq||e.a.Dj)){const ha=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(T.d)(P.a.resolve(K.E,{Oa:1})):z.GetServiceTaskFactory.create(this.$.ia,155,this.$.ma,1);F.TaskExtensions.Aa(ha,()=>{this.ej(20,null)},this.ma,3)}}Vvi(ha){ha||3!==this.$.workbookContext.WorkbookNovType||this.ej(63,null)}get ojk(){return h.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UnsupportedBrowserVersionSoftBlockIsEnabled",
!1)}Dwi(){this.ojk&&e.a.eNi&&this.ej(24,null)}Lnf(ha){(!ha&&!this.$.printingEnabled||this.$.Kg.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.ej(16,null));this.Gwi();this.VKe();this.bkg();this.Vvi(ha);this.Dwi()}VKe(){this.$.workbookContext.Options&32768&&this.S2j()}S2j(){this.z2a[37]||this.ej(37,null)}b5j(){this.z2a[38]||this.ej(38,null)}bkg(){this.$.workbookContext.Options&
524288&&this.ej(59,null)}ykg(ha,Ea){this.ej(58,ha,null,Ea)}E3c(ha,Ea){var ra=null,Z=null;ra=void 0===ra?null:ra;Z=void 0===Z?null:Z;Ea=void 0===Ea?null:Ea;this.cT.HH(ha)?this.cT.qWb(ha,Ea):this.ej(ha,null,ra,Z,Ea)}Sjg(){this.$.hg&8&&this.ej(12,null)}VBd(){const ha=this.$.ia.Ja(38);return ha?ha.E6d:!1}pYg(ha,Ea){if(!this.HH(21)&&-1387426400!==ha.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const ra={};ra.FailedMethod=Ea;this.ej(21,
ha,ra)}}static Xkc(){return Q.mCe||(Q.mCe=[0,1,2,3])}wnd(ha){return this.cT.wnd(ha)}};fa.mCe=null;fa=Q=Object(w.a)([Object(P.d)(K.p),Object(w.b)(0,Object(K.fb)())],fa);Object(b.a)(fa,"BusinessBarManager",l.a,[281,5,91])},1211:function(w,B,a){w=a(0);var b=a(16),c=a(266);class h{constructor(k,l){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=k;
this.caller=l;this.reset()}reset(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null}}Object(w.a)(h,"NetworkTestResult",null,[]);var f=a(598);a.d(B,"a",function(){return e});class e{constructor(k,l,r,v,u){this.url="";this.W$a=!1;this.lJ=-1;this.testIteration=0;this.baseUrl=r;this.LLf=v;this.Qud=l;this.result=new h(l,u)}runTest(){try{if(this.W$a)return b.ULS.sendTraceTag(537155206,0,50,`NetworkTestReq.RunTest: a test for the host ${this.Qud} is already mid way, not starting a new one.`),
!1;this.reset();this.W$a=!0;this.result.startTimeMs=Date.now();const k=new c.QueryStringBuilder(this.baseUrl);k.H6("tid",this.result.startTimeMs.toString());this.url=k.toString();this.iPj();this.testIteration++;this.result.testIteration=this.testIteration;return!0}catch(k){return this.NAb("Exeption: "+k.message),!1}}reset(){this.url="";this.result.reset();this.W$a=!1;this.lJ=-1}clearTimeout(){-1!==this.lJ&&(window.clearTimeout(this.lJ),this.lJ=-1)}iPj(){try{const k=new XMLHttpRequest;k.onreadystatechange=
()=>{4===k.readyState&&(200===k.status?this.XVh():this.NAb(`Error when downloading resource. status code: ${k.status}, status text: ${k.statusText}`,k.status.toString()))};k.onerror=()=>{this.NAb(`Client error when attempting to download resource. status code: ${k.status}, response: ${k.statusText}`)};this.lJ=window.setTimeout(()=>{this.lJ=-1;this.NAb("Request timeout")},1E4);k.open("GET",this.url,!0);k.send(null)}catch(k){this.NAb("Exeption: "+k.message)}}XVh(){this.W$a&&(this.result.reqTotalDurationMs=
Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=f.a(this.url),this.result.isSuccess=!0,this.yac())}NAb(k,l){l=void 0===l?null:l;this.W$a&&(this.clearTimeout(),this.result.errorMessage=k,this.result.isSuccess=!1,this.result.errorStatusCode=l,this.yac())}yac(){this.W$a=!1;this.LLf&&this.LLf(this.result,this.Qud)}}Object(w.a)(e,"NetworkTestReq",null,[])},1256:function(w,B,a){a.r(B);a.d(B,"AutoDetectActionButton",function(){return e});w=a(0);B=a(82);var b=a(1193),
c=a(54),h=a(12),f=a(20);class e extends B.a{constructor(k,l,r,v,u){super();this.$=k;this.DF=v.Rxb(k,l,r,"",c.a.Bj(11),u,"AutoDetectPointerDown",h.a.instance.ha(1808)+"...")}get Dy(){return this.DF.Dy}dispose(){this.DF.dispose();this.$=null;super.dispose()}domElement(k){return this.DF.domElement(k)}getButton(k){return this.DF.getButton(k,!1)}xlb(k,l,r,v){this.DF.aZa(b.a.D5h(k),l,v);this.DF.lLc(r,l,v)}Wha(k,l){const r=f.h(this.$),v=r.Gd.xk(k);k=r.hj(k,v);const u=r.mi(v).so;if(k&&0<=k.x&&0<=k.y&&u.width>
k.width+160){let x=k.bottomRight.x+this.Dy,t=k.topLeft.y+this.Dy,m=!1;x+160>u.bottomRight.x&&(x=k.topLeft.x-this.Dy,m=!0);if(t<u.topLeft.y+this.Dy){if(r.Gd.KFa){this.hide();return}t=u.topLeft.y+this.Dy}this.DF.Bhd(l,v);this.Po(x,t,r.rtl,v,m)}else this.hide()}Po(k,l,r,v,u){this.DF.Po(k,l,r,v,!1,u)}hide(){this.DF.hide()}}Object(w.a)(e,"AutoDetectActionButton",B.a,[])},1326:function(w,B,a){function b(G,pa){this.ID=G;this.type=pa}function c(G,pa){this.value=G;this.contextId=pa}function h(G,pa,kb,Zb,Lc,
Bd,he,Ie){this.type=G;this.startTime=null==kb||void 0==kb.value?new c(kb,null):kb;this.endTime=null==Zb||void 0==Zb.value?new c(Zb,null):Zb;null!=Lc&&void 0!=Lc.value||new c(Lc,null);null!=Bd&&void 0!=Bd.value||new c(Bd,null);this.operationType=Ie}function f(G){this.ID=G}function e(){this.Ih=[];this.Vtb=[];this.C5c=0;this.duration=this.startTime=null;this.Oec={};this.dHd=this.GHd=this.q7c=-1}function k(G){const pa=new Cb.StandardDialog;pa.ke=4;G=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+
String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,G)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;pa.JV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,G,Le)}function l(G,pa){return Ko(function*(){if(Object(Lg.m)(G.pa)){const kb=G.pa.sheetProcessedData;Object(Hj.a)(kb);return pa.map(Zb=>ig(Zb,!0)).filter(Zb=>kb.value.qbb(Zb))}return[]})}function r(G){switch(G){case 0:return 1;case 2:return 2;case 1:return 4;default:throw X.ULS.sendTraceTag(508559903,0,10,
`ConvertExtraSpacesTypeToTrimWhitespaceType: Unknown ExtraSpacesPaddingType ${G}`),Error.argument("illegal ExtraSpacesPaddingType");}}function v(G,pa,kb,Zb,Lc){return Ko(function*(){const Bd=Object(fe.u)(G.activeItemName,null,pa),{TLd:he,SLd:Ie,qNd:ff}=t();Object(od.a)(G.userOperationManager,(qf,eg,dh)=>Mf.z(G.qa.ua,Lc,Bd,Zb,Object($d.b)(qf,he),Object($d.a)(eg,Ie),dh,null),qf=>new ae.a(258,0,qf),null);yield ff;return kb.length})}function u(G,pa,kb){return Ko(function*(){const Zb=Object(fe.u)(G.activeItemName,
null,pa),Lc=G.qa.ua.ze({Epa:!0,voa:1}),{TLd:Bd,SLd:he,qNd:Ie}=t();Object(od.a)(G.userOperationManager,(ff,qf,eg)=>Ob.l(G.qa.ua,Zb,Object(fe.o)(Yd.h(G).ga.ra.activeCell,G),kb,!1,null,null,!0,!1,Object($d.b)(ff,Bd),Object($d.a)(qf,he),eg,null,Lc,null),ff=>new ae.a(11,0,ff),null);yield Ie;return-1})}function x(G,pa,kb){return Ko(function*(){const Zb=Object(fe.u)(G.activeItemName,null,pa),{TLd:Lc,SLd:Bd,qNd:he}=t(),Ie=Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8123182_DataCleansingReduceWhitespaceTypes")?
kb.reduce((qf,eg)=>qf|eg,0):kb[0];Object(od.a)(G.userOperationManager,(qf,eg,dh)=>{var nh=G.qa.ua;qf=Object($d.b)(qf,Lc);eg=Object($d.a)(eg,Bd);const Ug=nh.Pa(9,null);Ug.ranges=Zb;Ug.trimWhitespaceType=Ie;return Ob.g(nh,"TrimWhitespace",Ug,qf,eg,dh,null,0)},qf=>new ae.a(253,0,qf),null);const {Result:ff}=yield he;return ff})}function t(){const G=new Wc.a;return{TLd(pa){pa&&Gd.a.Ph(pa.Errors)?(X.ULS.sendTraceTag(509617682,0,10,"DataCleansing onOperationSuccess: Ewa result contains error messages after applying"),
G.setResult(null)):pa?(X.ULS.sendTraceTag(537163359,0,20,"DataCleansing onOperationSuccess: Suggestion applied successfully"),G.setResult(pa)):(X.ULS.sendTraceTag(508424517,0,10,"DataCleansing onOperationSuccess: Ewa result is null after applying"),G.setResult(null))},SLd(pa){X.ULS.sendTraceTag(509617681,0,10,`DataCleansing onOperationFailed: Ewa result contains error messages HttpStatus [${pa.data.httpStatus}]`);G.setResult(null)},qNd:Qb.e(G.task)}}function m(G,pa,kb){kb=void 0===kb?new Map:kb;return G.reduce((Zb,
Lc)=>{Lc=pa(Lc);const Bd=Zb.get(Lc);Bd?Zb.set(Lc,Bd+1):Zb.set(Lc,1);return Zb},kb)}function n(G,pa,kb){kb=void 0===kb?new Map:kb;for(const Zb of G)G=pa(Zb),A(kb,G,()=>[]).push(Zb);return kb}function A(G,pa,kb){G.has(pa)||G.set(pa,kb());return G.get(pa)}function y(G){const pa=[];G.forEach(kb=>pa.push(...kb));return pa}function z(G){return Array.from(G).reduce((pa,kb)=>{var [Zb,Lc]=kb;return Object.assign({},pa,{[Zb]:Lc})},{})}function F(G,pa){return pa instanceof Map?z(pa.entries()):pa}function D(G){return Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_ActivateResolver",
!1)?G.find(ti.typeGuard):G.find(Fg.typeGuard)}function I(G){return y([G.filter(Yf.typeGuard),G.filter(If.typeGuard)])}function H(G){let pa;pa=0+G.filter(Yf.typeGuard).reduce((kb,Zb)=>{var Lc,Bd;return kb+(null!==(Bd=null===(Lc=null===Zb||void 0===Zb?void 0:Zb.suggestions)||void 0===Lc?void 0:Lc.length)&&void 0!==Bd?Bd:0)},0);return pa+=G.filter(If.typeGuard).length}function N(G){G=y(I(G).map(pa=>Yf.typeGuard(pa)?pa.suggestions:[pa]));return m(G,U)}function U(G){return If.typeGuard(G)?"ExtraSpaces":
G.type}function L(G){const pa=new Map;n(G,kb=>kb.tableIdentifier).forEach((kb,Zb)=>{pa.set(Zb,N(kb))});return pa}function J(G){G=y(G.map(pa=>pa.suggestions.filter(P)));return m(G,pa=>pa.variationsType)}function P(G){return"NumberFormattingInconsistency"===G.type}function K(G){return G.filter(Yf.typeGuard).reduce((pa,kb)=>{var Zb=kb.tableRange;kb=kb.suggestions;Zb&&kb&&(Zb=ig(Zb,!1).Cy(!1),pa[Zb]=ca(pa[Zb],kb));return pa},{})}function ca(G,pa){return pa.reduce((kb,Zb)=>{({type:Zb}=Zb);Zb in kb?kb[Zb]++:
Zb&&(kb[Zb]=1);return kb},null!==G&&void 0!==G?G:{})}function T(G,pa){if(Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8222616_RefineDiscoverabilityTriggers")&&(Object(oh.c)(G)||Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&G.isMobileMode))return!0;G=pa.hostState;pa=pa.worksheetState;return!!G.errorState||G.isInViewMode||pa.isInNamedSheetView||pa.isProtected}a.r(B);var Q={};a.r(Q);a.d(Q,"NetworkConnectionStateManager",function(){return rb});var fa={};a.r(fa);
a.d(fa,"EnrichmentTaskPane",function(){return Eb});var ha={};a.r(ha);a.d(ha,"ProactiveSuggestionManager",function(){return xh});var Ea={};a.r(Ea);a.d(Ea,"ZoomManager",function(){return Wd});var ra={};a.r(ra);a.d(ra,"ProactiveSuggestionDebugToolsManager",function(){return mc});var Z={};a.r(Z);a.d(Z,"UnifiedConsentAdapter",function(){return Ye});var wa={};a.r(wa);a.d(wa,"ExtendedTooltipsManager",function(){return tf});var la={};a.r(la);a.d(la,"DataCleansingHostManager",function(){return Rg});var ta=
{};a.r(ta);a.d(ta,"DataCleansingAnnotationsManager",function(){return wj});var Ca={};a.r(Ca);a.d(Ca,"SharedUIControlsFactory",function(){return Xj});var Ga={};a.r(Ga);a.d(Ga,"AutoAdjustColumnsManager",function(){return Pj});var Oa={};a.r(Oa);var eb={};a.r(eb);a.d(eb,"SdxManifestPrefetcher",function(){return Qj});var nb={};a.r(nb);a.d(nb,"ThemesManager",function(){return Zj});var $a={};a.r($a);a.d($a,"CalcInterfaceAdapter",function(){return M});var oa={};a.r(oa);a.d(oa,"CalcManager",function(){return Rj});
var Fa=a(0),X=a(16),va=a(5),xa=a(126),Pa=a(411);class Ka extends Pa.a{constructor(G){super(G)}get uxb(){return!1}createElement(){const G=document.createElement("link");G.setAttribute("rel","stylesheet");G.setAttribute("type","text/css");G.setAttribute("href",this.Wx);return G}idd(){return null}lBc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.eD.Wx)}}Object(Fa.a)(Ka,"CssResource",Pa.a,[]);var Bb=a(469),xb=a(269),Ua=a(33),Jb=a(63);class fc{constructor(){this.w2b=this.A_b=
null}MRi(){this.A_b||(X.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.A_b=Jb.Task.WAA(fc.TRi(),fc.IRi()),this.A_b.continueWith(G=>{X.ULS.sendTraceTag(21030599,324,10,"{0}",Ua.a.Hod(G.exception))},5));return this.A_b}ORi(){if(!this.w2b)try{X.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.w2b=Jb.Task.WAA(fc.Lhd(xb.a.create(va.AFrameworkApplication.da.Ra("DimeUrl"),null,null))),this.w2b.continueWith(G=>{X.ULS.sendTraceTag(39978391,
324,10,"{0}",Ua.a.Hod(G.exception))},5)}catch(G){X.ULS.sendTraceTag(594874951,324,10,"{0}",Ua.a.Hod(G))}return this.w2b}static TRi(){var G=fc.Okc("inproductmessaging.js");G=xb.a.create(G,null,null);return fc.Lhd(G)}static IRi(){var G=fc.Okc("inproductmessaging.css");G=new Ka(G);return fc.Lhd(G)}static Okc(G){return xa.a.Xwb(String.format("ipm/{0}",G))}static Lhd(G){Bb.a.uya(G);return G.adb}}Object(Fa.a)(fc,"DependencyDownloader",null,[226]);class ya{}ya.gkj="inProductMessagingOverlayDiv";ya.gnj="PlayButtonImage";
ya.AGj="ReplayButtonImage";Object(Fa.a)(ya,"Constants",null,[]);class ob{constructor(){this.Tte=this.moe=this.ode=!0;this.BGj=this.hnj=null;this.n0i=!1;this.locale=null;this.Tsg={}}get eGe(){return this.ode}set eGe(G){this.ode=G}get CGf(){return this.moe}set CGf(G){this.moe=G}get $jg(){return this.Tte}set $jg(G){(this.Tte=G)&&this.oVj()}oVj(){this.Dze(ya.gnj,this.hnj);this.Dze(ya.AGj,this.BGj)}Dze(G,pa){pa&&(this.Tsg[G]=pa)}}Object(Fa.a)(ob,"FirstRunExperienceUISettings",null,[222]);class Sb{constructor(){this.completed=
this.GAj=!1}}Object(Fa.a)(Sb,"FirstRunExperienceViewData",null,[221]);var Ba=a(169),Ia=a(118),cb=a(26);class Kb{constructor(G,pa,kb){this.wWh=(Zb,Lc,Bd,he,Ie)=>{2===Bd&&this.h0b.iQi(Ie);return 32};this.WAh=(Zb,Lc,Bd,he,Ie)=>{2===Bd&&this.h0b.fQi(Ie);return 32};this.Dui=(Zb,Lc,Bd)=>2===Bd?this.h0b.WHd():32;this.Cui=(Zb,Lc,Bd)=>2===Bd?this.h0b.THd():32;this.Na=G;this.Jh=pa;this.h0b=kb}Oj(){this.Na.uh(cb.a.yWh,Ia.a.frame,this.wWh,64);this.Na.xe(cb.a.g6e,Ia.a.frame,this.Dui);this.Na.xe(cb.a.f6e,Ia.a.frame,
this.Cui);this.Na.xe(cb.a.VAh,Ia.a.frame,this.WAh);this.Na.xe(cb.a.H7f,Ia.a.frame,Ba.ActionManager.Ui);this.Na.xe(cb.a.cHj,Ia.a.frame,Ba.ActionManager.Ui);this.Na.xe(cb.a.dHj,Ia.a.frame,Ba.ActionManager.Ui);this.Jh&&this.Jh.Sv()}}Object(Fa.a)(Kb,"InProductMessagingActor",null,[]);var db=a(143);class gb{constructor(){this.f4f=this.r9f=this.Oog=this.Jsc=this.instance=null}}Object(Fa.a)(gb,"DimeExperienceUISettings",null,[]);var yb=a(149),Nb=a(475);class qc{constructor(G,pa,kb,Zb,Lc){this.Rhc=!1;this.Wyb=
null;this.Na=G;this.GJa=pa;this.Z2b=kb;this.y5=Zb;this.GOc=Lc}Ixi(G){yb.b("getHeaderApi")?G.isFeatureEnabled("MsoPremiumBadge",!0).then(pa=>{const kb=G.isFreemiumUpsellEnabled();kb&&(appChrome.getHeaderApi().then(Zb=>{Zb.updatePremiumStatus(pa,kb);return null}),G.kVa("MsoPremiumBadge",Zb=>{appChrome.getHeaderApi().then(Lc=>{Lc.updatePremiumStatus(Zb.isEnabled,kb);return null})}));return null}):X.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}iQi(G){this.Z2b.MRi().continueWith(()=>
{this.GJa.U4j(G)})}fQi(G){let pa="gopremium",kb=null,Zb=()=>{};G?(G.experience&&""!==Object(db.a)(String,G.experience)&&(pa=Object(db.a)(String,G.experience)),G.onTaskComplete&&(Zb=G.onTaskComplete),G.campaignId&&""!==Object(db.a)(String,G.campaignId)&&(kb=Object(db.a)(String,G.campaignId))):X.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.Fzf(pa,Zb,kb)}Fzf(G,pa,kb){kb=void 0===kb?null:kb;if(this.Rhc&&this.Wyb){const Zb={};Zb.experience=G||"gopremium";Zb.campaignId=
kb||Nb.b(this.y5,this.GOc,Object(db.a)(String,Zb.experience),!0);this.Na.qh(cb.a.H7f,2);X.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+Zb.experience);try{const Lc=Object.assign(new gb,{instance:this.Wyb,Jsc:Zb,Oog:pa||(()=>{}),r9f:Bd=>{X.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+Bd.status)},f4f:()=>{X.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.Rhc=!1;this.Wyb=null}});this.GJa.a3j(Lc)}catch(Lc){X.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+
Lc.message),this.Rhc=!1,this.Wyb=null,this.Na.Eg(cb.a.Shc,2,{["experience"]:Zb.experience})}}else X.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Na.Eg(cb.a.Shc,2,{["experience"]:G})}zAf(){this.Z2b.ORi().continueWith(()=>{try{var G=Ua.a.rn(va.AFrameworkApplication.uiCulture);const Zb=Nb.c(this.y5);if(Zb){var pa={};pa.partnerId=Zb;pa.language=G;pa.sessionId=va.AFrameworkApplication.userSessionId;pa.authHint=va.AFrameworkApplication.da.Ra("UserPrincipalName");
var kb=va.AFrameworkApplication.da.Ra("Puid")||"";""!==kb&&(G={},G.puid=kb,pa.userInfo=G);this.Wyb=new Dime(pa);this.Rhc=!0;X.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else X.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(Zb){X.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+Zb.message)}},3)}WHd(){return this.GJa.WHd()}THd(){return this.GJa.THd()}}Object(Fa.a)(qc,"InProductMessagingUIManager",null,[220]);var Gb=a(125);class hb{constructor(){this.wve=
0;this.P0a=Array(5);this.P0a[0]=10;this.P0a[1]=15;this.P0a[2]=50;this.P0a[3]=100;this.P0a[4]=200}Init(G){this.wve=G}SendTrace(G,pa){X.ULS.sendTraceTag(34182235,this.wve,this.P0a[G],"{0}",pa)}}Object(Fa.a)(hb,"DefaultNetworkingManager",null,[228]);var qb=a(279),ab=a(324),Mb=a(101);class Ib{constructor(G){this.nf=G}U4j(G){G&&(InProductMessaging.Networking.NetworkingMgr=new hb,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(G.$jg,G.CGf,G.eGe,G.n0i,G.locale,Object(Gb.a)(this,
this.c8i,"onDismissFirstRunExperience"),G.Tsg),this.SWa(ya.gkj,!0))}a3j(G){if(G&&G.instance&&G.Jsc){let pa=document.getElementById("wacDimeContainer");pa||(pa=document.createElement("div"),pa.id="wacDimeContainer",document.body.appendChild(pa));va.AFrameworkApplication.da.na("DimeFocusManagerIsEnabled")&&this.SWa("wacDimeContainer",!1);G.Jsc.parentElementId="wacDimeContainer";G.instance.launch(G.Jsc,G.Oog).then(kb=>{this.PPb();document.body.removeChild(pa);G.r9f(kb)}).catch(kb=>{this.PPb();document.body.removeChild(pa);
G.f4f(kb)})}else throw Error.argument("DimeExperienceUISettings");}SWa(G,pa){if(this.nf&&G&&(G=document.getElementById(G),this.Axi(G),G=this.nf.gU("InProductMessagingFocusId"))){const kb=this.nf.Lk;kb&&"InProductMessagingFocusId"===kb.name||this.nf.f4("InProductMessagingFocusId",!1);pa&&this.k2f(G.scope)}}Axi(G){var pa=!1;pa=void 0===pa?!0:pa;const kb=this.nf.om("InProductMessagingFocusId");kb.parent=qb.AFrame.O6;const Zb=new ab.DOMFocusListing(()=>G);Zb.JPb=pa;Zb.Jr(3);Zb.Jr(2);Zb.Jr(4);pa=this.nf.nLa(()=>
G,kb,Zb);pa.mBc();pa.T9=!0;pa.K5a=!0}k2f(G){G.Rv(Mb.FocusManager.instance().q6);G.Rv(Mb.FocusManager.instance().r6);G.bindAction(Mb.FocusManager.instance().q6,cb.a.g6e);G.bindAction(Mb.FocusManager.instance().r6,cb.a.f6e)}PPb(){this.nf&&(this.nf.Qga("InProductMessagingFocusId"),this.nf.xVa("InProductMessagingFocusId"))}c8i(G,pa){this.PPb();G=Object.assign(new Sb,{completed:G,GAj:pa});va.AFrameworkApplication.Vd.Eg(cb.a.vWh,2,G)}WHd(){const G=document.activeElement,pa=this.nf.bU();return G&&pa&&pa.$j&&
G===pa.$j.Bz?(pa.$j.hA(G),pa.VKb()?32:8):4}THd(){const G=document.activeElement,pa=this.nf.bU();return G&&pa&&pa.$j&&G===pa.$j.firstElement?(pa.$j.hA(G),pa.Ndb()?32:8):4}}Object(Fa.a)(Ib,"InProductMessagingUIWrapper",null,[219]);var fb=a(138),Db=a(260),Za=a(30);class sb{constructor(){this.Fd=null}get name(){return"Common.App.InProductMessaging"}nk(G){G.register(fc,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Ve().$e(()=>new fc);G.register(Ib,
"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Ve().$e(()=>new Ib(Mb.FocusManager.instance()));G.register(qc,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Ve().$e(()=>new qc(va.AFrameworkApplication.Vd,G.resolve("Common.IInProductMessagingUIWrapper"),G.resolve("Common.App.InProductMessaging.IDependencyDownloader"),va.AFrameworkApplication.sa.Sa.Hj,va.AFrameworkApplication.sa.Sa.zCa));G.register(Kb,
"Common.App.InProductMessaging.InProductMessagingActor").Ve().$e(()=>new Kb(va.AFrameworkApplication.Vd,va.AFrameworkApplication.sa,G.resolve("Common.IInProductMessagingUIManager")));G.register(ob,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Ve().$e(()=>new ob);G.register(Sb,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Ve().$e(()=>new Sb);this.Fd=G}init(){this.Fd.resolve("Common.App.InProductMessaging.InProductMessagingActor").Oj();
va.AFrameworkApplication.da.Jw(()=>{va.AFrameworkApplication.sa.Sa.zv&&fb.a.get_instance().jk(15,()=>{this.Fd.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(G=>{this.Fd.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Ixi(G)})});va.AFrameworkApplication.da.na("FreemiumUpsellShowDialogIsEnabled")&&Nb.a()&&!Za.a.VAa&&1!==va.AFrameworkApplication.sa.Sa.Hj&&this.Fd.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(G=>{G.isFeatureEnabled("MsoPremiumBadge",
!0).then(pa=>{!pa&&G.isFreemiumUpsellEnabled()&&this.Fd.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").zAf();return null})})})}dispose(){}static main(){Db.a.instance.$k(new sb)}}Object(Fa.a)(sb,"InProductMessagingPackage",null,[3,4]);var sa=a(198),ba=a(41);class ua{constructor(G,pa,kb,Zb,Lc){this.pPa=Bd=>{let he=!1,Ie=null;try{if(0<Bd.data.Fg.length){const ff=Object(db.a)(Object,ba.a(Bd.data.Fg)),qf=ff?ff[this.az.L5c]:null;qf&&(Ie=Object(db.a)(Object,ba.a(qf.toString())))}he=
!0}catch(ff){this.Lna(null)}he&&this.uob&&this.uob(Bd.data,Ie)};this.Lna=Bd=>{this.qob&&this.qob(Bd?Bd.data:null)};this.Qoj=Bd=>{this.Kqe&&this.Kqe(Bd?Bd.data:null)};this.Kqa=Bd=>{this.Gqb&&this.Gqb(Bd?Bd.data:null)};this.az=G;this.uob=pa;this.qob=kb;this.Kqe=void 0===Zb?null:Zb;this.Gqb=void 0===Lc?null:Lc}Tjd(G){const pa=new Sys.StringBuilder(this.az.kRb);pa.append("RoamingServiceHandler.ashx?action=");pa.append("getFirstRunExperienceSettings");pa.append("&");pa.append(this.Mqd(G));pa.append("&");
pa.append(va.AFrameworkApplication.fl);va.AFrameworkApplication.Wf.zp(pa.toString(),1,null,null,!0,2,this.pPa,this.Lna,null)}ggc(G){var pa=new Sys.StringBuilder(this.az.kRb);pa.append("RoamingServiceHandler.ashx?action=");pa.append("saveFirstRunExperienceSettings");pa.append("&");pa.append(va.AFrameworkApplication.fl);pa=pa.toString();G=ba.c(G);va.AFrameworkApplication.Wf.zp(pa,2,G,null,!0,4,this.Qoj,this.Kqa,null)}Mqd(G){const pa=new Sys.StringBuilder("requestedsettings=");for(let kb=0;kb<G.count;kb++)pa.append(G.ka(kb)),
kb<G.count-1&&pa.append(";");return pa.toString()}}Object(Fa.a)(ua,"FirstRunExperienceRequestHandler",null,[]);var R=a(229),Y=a(81);class La{constructor(){this.job=this.B_b=this.az=null;this.pPa=(G,pa)=>{G=G?+G.u1-+G.sI:-1;G>this.az.y$f?X.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",G,this.az.y$f):pa?this.K1j(pa)?(X.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.az.vGf),this.s2d()):(this.cgd(!1),X.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(X.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.s2d())};this.Lna=G=>{this.cgd(!1);X.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",G?G.httpStatus:-1)};this.Kqa=G=>{X.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
G?G.httpStatus:-1)};this.f9i=G=>{if(G){var pa=G.detail;G=G.type;var kb=this.az&&this.az.campaignId?this.az.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===G||kb&&pa&&pa.id&&-1!==pa.id.indexOf(kb)){if("FRELaunchedEvent"===G||pa&&pa.success)X.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.Pag(this.az.currentVersion);window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.job,!0),window.removeEventListener("FRELaunchedEvent",
this.job,!0))}}}}r2d(G){G?(this.az=G,this.iIi()&&(X.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),G=new sa.a,G.add(this.az.L5c),this.B_b=new ua(this.az,this.pPa,this.Lna,null,this.Kqa),this.B_b.Tjd(G)),(this.az.ccb||va.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.s2d()):X.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}iIi(){try{if(this.az.ccb)return!0;
if(!va.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||va.AFrameworkApplication.da.na("IsAnonymousUser"))return!1;if(this.az.yEi||this.az.fcb||va.AFrameworkApplication.da.na("IsO365ConsumerHost"))return!0;const G=va.AFrameworkApplication.da.Ra("FlightId");return-1!==(G?G.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(G){X.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",G?G.toString():null)}return!1}Pag(G){const pa=
{},kb={};kb.FREDisplayedDate=(new Date).toUTCString();kb.VersionDisplayed=G;kb.RemindMeLater=!1;pa[this.az.L5c]=ba.c(kb);X.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.B_b&&this.B_b.ggc(pa)}s2d(){this.cgd(!0);var G=Y.a.instance.Ii("Common.ISystemInitiatedFeedback");G?this.Njg(G):(X.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),va.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((G=Y.a.instance.ie("Common.ISystemInitiatedFeedback"))?G.execute(pa=>{this.Njg(pa)}):X.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}Njg(G){if(G){var pa=this.az.JWh;pa&&va.AFrameworkApplication.CQ(pa);X.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",pa);G.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.job=this.f9i,window.addEventListener("FGWebSurfaceEvent",this.job,!0),
window.addEventListener("FRELaunchedEvent",this.job,!0)):(X.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.Pag(this.az.currentVersion))}else X.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}K1j(G){if("RemindMeLater"in G&&"FREDisplayedDate"in G){if("true"===G.RemindMeLater.toString()&&(+new Date-+new Date(G.FREDisplayedDate.toString()))/36E5>this.az.vGf)return!0}else if(va.AFrameworkApplication.da.na("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in G&&G.VersionDisplayed<this.az.currentVersion)return X.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}cgd(G){va.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&R.a.dispatch("FREDecisionEvent",{["show"]:G})}}Object(Fa.a)(La,"FirstRunExperienceLauncher",null,[392]);class Ma{constructor(){this.Fd=null}get name(){return"Common.App.FirstRunExperienceLauncher"}nk(G){this.Fd=
G;this.Fd.register(392,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Ve().$e(()=>new La)}init(){}dispose(){}static main(){Db.a.instance.$k(new Ma)}}Object(Fa.a)(Ma,"FirstRunExperienceLauncherPackage",null,[3,4]);var lb=a(9),pb=a(233),Vb=a(1);class Wa{constructor(G){this.$=G}get L5c(){return"Excel"}get campaignId(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}get version(){return 1}get currentVersion(){return 0}get yEi(){return this.isEnabled()&&Vb.EwaSettings.Fa(295)}get fcb(){return this.isEnabled()&&
Vb.EwaSettings.Fa(297)}get ccb(){return Vb.EwaSettings.Fa(296)}get JWh(){return null}get vGf(){return 24}get y$f(){return 4E3}get kRb(){return this.$.xa.WebServiceBase||""}isEnabled(){if(va.AFrameworkApplication.da?va.AFrameworkApplication.da.na("IsAnonymousUser"):1)return!1;const G=va.AFrameworkApplication.Ge?Object(db.a)(String,va.AFrameworkApplication.Ge.AudienceGroup):"";return"Unknown"!==G&&"Automation"!==G}}Object(Fa.a)(Wa,"FirstRunExperienceLauncherSettings",null,[423]);class ka{constructor(G,
pa){this.h6e=G;this.xWh=pa}r2d(){this.h6e&&this.h6e.r2d(this.xWh)}}Object(Fa.a)(ka,"FirstRunExperienceManager",null,[421]);var Sa=a(740);class Xb extends pb.a{constructor(G){super();this.$=G;this.Oe()}create(){const G=Object(Sa.a)(this.$.ia,311,()=>this.frh());this.ve(G)}frh(){var G=new Wa(this.$);G=new ka(Y.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),G);G.r2d();return G}static la(G){G.ia.Va(312,new Xb(G))}}Object(Fa.a)(Xb,"FirstRunExperienceManagerFactory",
pb.a,[]);var Mc=a(59);class jc extends pb.a{constructor(G){super();this.Ivd=null;this.$=G;this.Oe()}create(){const G=Object(Sa.a)(this.$.ia,361,()=>this.Trh());this.ve(G)}Trh(){this.Ivd=Y.a.instance.Ii("Common.IInProductMessagingUIManager");Mc.a.Ji.zv?fb.a.get_instance().jk(16,()=>{this.Gof()}):this.Gof();return this.Ivd}Gof(){Y.a.instance.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(G=>{G.isFeatureEnabled("MsoPremiumBadge",!0).then(pa=>{!pa&&G.isFreemiumUpsellEnabled()&&
this.Ivd.zAf();return null})})}static la(G){G.ia.Va(362,new jc(G))}}Object(Fa.a)(jc,"InProductMessagingManagerFactory",pb.a,[]);var $c=a(52),Jd=a(353),fd=a(82),Kd=a(542),Yd=a(20),te=a(590);class ve extends Kd.a{constructor(G){super(1);this.uja=!1;this.aLf=()=>{this.refresh()};this.bLf=()=>{this.refresh()};this.gridView=Yd.h(G);this.gridView.me.Yp(this.bLf);this.gridView.me.yq(this.aLf);this.refresh()}get sL(){return this.Fuc(this.uja)}g0d(G){this.uja!==G&&(this.uja=G,this.SOb())}get name(){return te.a.cellEdit}dispose(){this.gridView.me.Qp(this.bLf);
this.gridView.me.Pp(this.aLf);this.gridView=null;super.dispose()}SOb(){this.pRd(this.uja)}refresh(){this.g0d(!this.gridView.Kd)}}Object(Fa.a)(ve,"CellEditSafeStatePublisher",Kd.a,[]);var qe=a(37),pc=a(133);class nd{constructor(G,pa){this.handler=null;this.QQd=G;this.sL=pa}}Object(Fa.a)(nd,"SafeStatePublisherState",null,[]);var qd=a(629);const tb=G=>G?`${G.Current} / ${G.Pending} @${G.SuspensionStartTimestamp}`:null,Dc=G=>(null===G||void 0===G?void 0:G.SuspensionStartTimestamp)&&G.Pending>G.Current;
class Tc extends qe.a{constructor(G,pa){super();this.mzf=null;this.ksc=!1;this.FMb=(kb,Zb)=>{3===Zb.fGf&&this.ksc&&X.ULS.sendTraceTag(520480204,0,15,"ClientStateMonitor.onMergeDidntOccur: Aborted merge occurred after another aborted merge.");this.ksc=!0;this.VOb()};this.jWa=new sa.a;this.Idb=G;this.Dqa=pa;if(this.pGb=Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1))this.Dqa.Z2a(this.QCa.bind(this)),this.Idb.HAe(this.FMb)}get bjk(){return pc.f(pc.c(this.jWa.toArray(),
G=>0!=G.sL),G=>G.QQd.name)}Q6b(G){this.addHandler(Tc.iWa,G)}lCc(G){this.removeHandler(Tc.iWa,G)}TDa(G,pa){const kb=new nd(G,pa);this.jWa.add(kb);pa=(Zb,Lc)=>{kb.sL=Lc.sL;this.VOb()};G.Q6b(pa);kb.handler=pa;this.VOb()}l8d(G){let pa=null;for(let kb of this.jWa)if(kb.QQd===G){this.Wtg(kb);pa=kb;break}pa&&(this.jWa.remove(pa),this.VOb())}dispose(){for(let G of this.jWa)this.Wtg(G);this.jWa.clear();this.pGb&&(this.Dqa.phb(this.QCa.bind(this)),this.Idb.o6f(this.FMb));super.dispose()}ric(){let G=ge.ric(this.jWa.toArray().map(pa=>
pa.sL));return this.ksc&&1===G?2:G}Wtg(G){G.QQd.lCc(G.handler)}VOb(){const G=this.ric();G!==this.mzf&&(this.raiseEvent(Tc.iWa,new qd.a(G)),this.mzf=G)}QCa(G,pa){G=pa.ega;(pa=!Dc(G))||(pa=this.BPi,pa=(null===G||void 0===G?void 0:G.SuspensionStartTimestamp)!==(null===pa||void 0===pa?void 0:pa.SuspensionStartTimestamp));pa&&(this.ksc=!1);this.BPi=G;this.VOb()}}Tc.iWa="SSC";Object(Fa.a)(Tc,"ClientStateMonitor",qe.a,[]);var ub=a(7),Pb=a(74);class ee extends Kd.a{constructor(G,pa){pa=void 0===pa?null:pa;
super(1);this.uja=!1;this.UQ=()=>{this.refresh()};this.hMf=()=>{this.refresh()};this.$=G;this.yje=pa||Pb.a(G).ZT(ub.a.idle);Pb.a(G).a4c(this.hMf);this.N$a.yt(this.UQ);this.refresh()}get sL(){return this.Fuc(this.uja)}g0d(G){G!==this.uja&&(this.uja=G,this.SOb())}get name(){return te.a.N$a}get N$a(){return this.yje}dispose(){Pb.a(this.$).SBc(this.hMf);this.N$a.Ut(this.UQ);this.yje=null;super.dispose()}SOb(){this.pRd(this.uja)}refresh(){this.g0d(1===this.N$a.Bx||Pb.a(this.$).vk===this.N$a)}}Object(Fa.a)(ee,
"IdleActivitySafeStatePublisher",Kd.a,[]);var Ad=a(326),Ub=a(4),tc=a(22);class yc extends fd.a{constructor(){super()}hf(){return!1}executeCommand(){return Jb.Task.Ua(!0)}Ue(G,pa){return 1905775613===pa.command}mf(){return!1}}Object(Fa.a)(yc,"ToggleMergeSuspensionSafeState",fd.a,[169]);class Sd extends qe.a{constructor(G,pa){super();this.statusBarManager=null;this.WId=!1;this.QCa=(kb,Zb)=>{kb=`${Zb.ega.Current===Zb.ega.Pending?"\u26ad":"\u26ae"}${Zb.ega.Current}`;tc.a.equals(this.mvc,kb,!1)||(this.mvc=
kb,this.LC())};this.NTa=(kb,Zb)=>{kb=0==Zb.sL;this.WId!==kb&&(this.WId=kb,this.LC())};this.mergeSuspensionManager=pa;this.mergeSuspensionManager.Dqa.Z2a(this.QCa);this.mvc="";Ad.a.Dca(1905775613,Ub.a.We,0,1);this.Ga=G.Ga;this.DVb=new yc;G.ia.Od(29,kb=>{this.mergeSuspensionManager&&(this.statusBarManager=kb,kb.BM(this),this.mergeSuspensionManager.Fla.Q6b(this.NTa))});this.Ga.D6(this.DVb)}yt(G){this.addHandler(Sd.zHd,G)}Ut(G){this.removeHandler(Sd.zHd,G)}LC(){this.raiseEvent(Sd.zHd)}mq(G){return G===
Sd.Asj&&!!this.mergeSuspensionManager}ov(G,pa){if(!this.mq(G))return!1;this.mergeSuspensionManager&&(pa.LabelText=this.mvc,pa.On=this.WId);return!0}dispose(){this.DVb&&(this.Ga.ihb(this.DVb),this.DVb.dispose(),this.DVb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.Dqa.phb(this.QCa),this.mergeSuspensionManager.Fla.lCc(this.NTa),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.WI(this),this.statusBarManager=null);this.mvc=null;super.dispose()}}Sd.zHd=
"MSMSC";Sd.Asj="QueryMergeSuspensionStatus";Object(Fa.a)(Sd,"MergeSuspensionIndicatorManager",qe.a,[298,173,5]);var Fd=a(2),se=a(925);class uc extends Sys.EventArgs{constructor(G){super();this.bBa=G}}Object(Fa.a)(uc,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);class Ra{}Object(Fa.a)(Ra,"SuspensionState",null,[]);class vb extends Ra{constructor(G){super();this.vCe=!1;this.vCe=G}}Object(Fa.a)(vb,"ReadyForPendingMergeState",Ra,[]);const Gc=new Ra,cd=new Ra,Cd=new vb(!1),Rd=new vb(!0);
var Be=a(926);class ad extends Be.a{constructor(G,pa,kb){super(G);this.l3g=pa;this.I5j=kb}}Object(Fa.a)(ad,"ReadyForPendingMergesUpdatedEventArgs",Be.a,[]);class Qc extends qe.a{constructor(G,pa,kb){super();this.QCa=(Zb,Lc)=>{Zb=this.getState();const Bd=this.H3;this.H3=Lc.ega;Lc=this.getState();this.LUi(Zb,Lc,Bd);this.raiseEvent(Qc.uHd);this.U5e(Zb,Lc)};this.NTa=(Zb,Lc)=>{Zb=this.getState();this.sL=Lc.sL;Lc=this.getState();this.U5e(Zb,Lc)};this.FMb=(Zb,Lc)=>{4===Lc.fGf&&(X.ULS.sendTraceTag(520480203,
0,50,"MergeSuspensionStateHandler.onMergeDidntOccur: Retry DoPendingMerge after bailout. Current merge counter: {0}, Response merge counter: {1}",tb(this.H3),tb(Lc.H3)),this.R0f(this.getState(),!0))};this.pGb=Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);this.Fla=G;this.Fla.Q6b(this.NTa);this.Dqa=pa;this.Dqa.Z2a(this.QCa);this.Idb=kb;this.Idb.HAe(this.FMb);this.H3=Object(Fd.a)(new se.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});this.sL=this.Rvi()}Rvi(){return Object(Jd.a)(Tc,
this.Fla)?Object(db.a)(Tc,this.Fla).ric():1}T6b(G){this.addHandler(Qc.C6d,G)}oCc(G){this.removeHandler(Qc.C6d,G)}C0g(G){this.addHandler(Qc.YRd,G)}FEj(G){this.removeHandler(Qc.YRd,G)}R_g(G){this.addHandler(Qc.uHd,G)}fEj(G){this.removeHandler(Qc.uHd,G)}zuj(){this.mRd(this.getState()===cd)}dispose(){this.Fla.lCc(this.NTa);this.Fla=null;this.Dqa.phb(this.QCa);this.Dqa=null;this.Idb.o6f(this.FMb);this.Idb=null;super.dispose()}Ypd(){return Object(Fd.a)(new se.a,{Current:this.H3.Current,Pending:this.H3.Pending,
SuspensionStartTimestamp:this.H3.SuspensionStartTimestamp})}getState(){return Dc(this.H3)?0==this.sL?Rd:this.pGb&&1==this.sL?Cd:cd:Gc}U5e(G,pa){G!==pa&&(pa===cd?this.mRd(!0):G===cd&&this.mRd(!1));this.R0f(pa)}R0f(G,pa){G instanceof vb&&this.raiseEvent(Qc.YRd,new ad(this.H3,G.vCe||!this.pGb,void 0===pa?!1:pa))}LUi(G,pa,kb){G===Gc&&pa!==Gc?(G=pa===cd,pa=pa===Cd,X.ULS.sendTraceTag(252760283,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: ${pa} publisher: ${pa||
G?this.Fla.bjk.join(","):""} counter: ${tb(this.H3)} isBlockingAllMerges: ${G}`)):G!==Gc&&pa===Gc&&X.ULS.sendTraceTag(252760284,0,50,`MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: ${tb(kb)}`)}mRd(G){this.raiseEvent(Qc.C6d,new uc(G))}}Qc.C6d="TPMBBC";Qc.YRd="RFPMU";Qc.uHd="MCC";Object(Fa.a)(Qc,"MergeSuspensionStateHandler",qe.a,[]);class Zd extends qe.a{constructor(G){super();this.d6=null;this.jsc=0;this.HKb=(pa,kb)=>{(null===kb||void 0===kb?0:kb.ega)&&this.CTa(kb.ega,
Zd.rae)};this.SEc=()=>{this.d9f();this.G0f(this.d6,Zd.zIj)};this.VKd=(pa,kb)=>{kb.committed&&this.d6.SuspensionStartTimestamp&&X.ULS.sendTraceTag(17318084,0,50,`PendingMergeMonitor.OnEditCellEnded: committed with counter ${tb(this.d6)}`)};this.d9f();this.$=G;this.$.ea.Yl(this.SEc);this.$.ea.dK(this.SEc);Yd.h(this.$).me.yq(this.VKd);this.$.ia.Od(292,pa=>{pa.Z2a(this.HKb);X.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")})}Z2a(G){this.addHandler("MCU",G)}phb(G){this.removeHandler("MCU",
G)}get H3(){return this.d6}CTa(G,pa){pa=void 0===pa?"":pa;const kb=this.d6.Current<G.Current||this.d6.Pending<G.Pending;if(G.SuspensionStartTimestamp&&this.jsc!==G.SuspensionStartTimestamp){if(this.jsc>G.SuspensionStartTimestamp){kb&&X.ULS.sendTraceTag(553736149,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via ${pa}. S: ${Zd.GKb(G)}, C: ${Zd.GKb(this.d6)}`);return}kb||X.ULS.sendTraceTag(553736148,0,50,`PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: ${Zd.GKb(G)}, C: ${Zd.GKb(this.d6)}`)}else if(!kb)return;
this.d6=G;this.G0f(G,pa)}dispose(){this.$.ea.gm(this.SEc);this.$.ea.nO(this.SEc);Yd.h(this.$).me.Pp(this.VKd);const G=this.$.ia.Ja(292);G&&G.phb(this.HKb);super.dispose()}G0f(G,pa){pa=void 0===pa?"":pa;Dc(G)&&G.SuspensionStartTimestamp>this.jsc&&(X.ULS.sendTraceTag(537155416,0,50,`PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: ${tb(G)}, Origin: ${pa}`),this.jsc=G.SuspensionStartTimestamp);this.raiseEvent("MCU",new Be.a(G))}d9f(){X.ULS.sendTraceTag(588276808,
0,50,`PendingMergeMonitor.ResetMergeCounter : Last counter was ${Zd.GKb(this.d6)}`);this.d6=Object(Fd.a)(new se.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})}static GKb(G){return G?`(${G.Current}/${G.Pending} @${G.SuspensionStartTimestamp})`:"null"}}Zd.rae="PMM.RTC";Zd.Eec="PMM.EwaResult";Zd.zIj="PMM.resetMergeCounter";Object(Fa.a)(Zd,"PendingMergeMonitor",qe.a,[]);class Tb{}Object(Fa.a)(Tb,"ClientRevisions",null,[]);var Yc=a(48),Ob=a(58);const kc=(G,pa,kb,Zb,Lc,Bd,he)=>{he=G.Pa(1,void 0===
he?null:he);he.suspensionStartTimestamp=pa;return Ob.g(G,"KeepBlockingPendingMerges",he,kb,Zb,Lc,Bd,0)};class Kc extends qe.a{constructor(G,pa,kb,Zb){super();this.hNa=null;this.BIb=0;this.CIb=this.ucb=null;this.LRf=(Lc,Bd)=>{this.hNa.Y6g(Bd.ega,Bd.l3g,Bd.I5j)};this.gNb=(Lc,Bd)=>{Bd.bBa?this.Z7j():this.hIc()};this.dQf=()=>{this.BIb=0};this.Kcg=()=>{const Lc=this.Z9.Ypd();kc(this.ua,null!=Lc.SuspensionStartTimestamp?Lc.SuspensionStartTimestamp:0,null,()=>{this.Wbj(Lc)},null,null,this.ua.ze())};this.EGa=
(Lc,Bd)=>{if(Bd){Bd.Ntb.MergeCount=this.Z9.Ypd();let he;({min:Lc,max:he}=Yd.h(this.$).VZi());Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Bd.Ntb.ClientRevisions=Object(Fd.a)(new Tb,{Min:Lc,Max:he,MaxFromBlockCache:Yd.h(this.$).ya.DFf}):Bd.Ntb.ClientRevisions=Object(Fd.a)(new Tb,{Min:Lc,Max:he})}};this.$=G;this.P3a=kb;this.Z9=pa;this.Z9.C0g(this.LRf);this.Z9.T6b(this.gNb);this.Z9.R_g(this.dQf);this.$.qa.Uka(this.EGa);this.ua=this.$.qa.ua;this.YVd=this.$.xa.MergeSuspensionRequestThrottlingTimeInMs;
this.WOi=this.$.xa.KeepBlockingPendingMergesRequestIntervalMs;this.hNa=Zb;X.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")}dispose(){this.$.qa.mra(this.EGa);this.hIc();this.Z9.FEj(this.LRf);this.Z9.oCc(this.gNb);this.Z9.fEj(this.dQf);this.Z9=null;super.dispose()}Z7j(){this.hIc();if(this.HVe()){const G=this.Z9.Ypd();X.ULS.sendTraceTag(537155414,0,50,`RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter ${tb(G)} fail count: ${this.BIb}`)}else this.CIb=
this.P3a.create(this.Kcg,this.YVd,Yc.a.CIb),this.ucb=this.P3a.SF(this.Kcg,this.WOi,Yc.a.ucb)}hIc(){this.ucb&&(this.CIb.cancel(),this.ucb.cancel(),this.ucb=this.CIb=null)}Wbj(G){let pa;pa=" fail count: "+this.BIb;this.BIb++;this.HVe()&&this.hIc();X.ULS.sendTraceTag(542229773,0,10,`RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed ${tb(G)}${pa}`)}HVe(){return this.BIb>Kc.HYi}}Kc.HYi=5;Object(Fa.a)(Kc,"RequestController",qe.a,[]);var Wc=a(180),Nd=a(208),Ud=a(32),$d=a(249);class $b extends Sys.EventArgs{constructor(G,
pa){super();this.fGf=G;this.H3=pa}}Object(Fa.a)($b,"MergeDidntOccurEventArgs",Sys.EventArgs,[]);var nc=a(142),Oc=a(13);class Hd extends qe.a{get BQa(){return 0<this.cNd}constructor(G,pa,kb,Zb,Lc){kb=void 0===kb?null:kb;Zb=void 0===Zb?null:Zb;Lc=void 0===Lc?null:Lc;super();this.isc=null;this.cNd=0;this.documentVisibilityObserver=null;this.Byf=!1;this.Duc=null;this.ua=G;this.YVd=pa.xa.MergeSuspensionRequestThrottlingTimeInMs;const Bd=pa.xa.GetRangeContentPrefetchDelayForMergeInMs;this.JB=()=>{pa.wbg(Bd)};
this.ik=kb||Ud.a.Jd;this.gxg=0;this.LO=Zb;this.wEa=Lc;Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void nc.a.resolve(Oc.W).then(he=>{this.documentVisibilityObserver=he}):pa.ia.Od(291,he=>{this.documentVisibilityObserver=he})}HAe(G){this.addHandler(Hd.vHd,G)}o6f(G){this.removeHandler(Hd.vHd,G)}get isDocumentHidden(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Cj}Y6g(G,pa,kb){this.JTb(G,pa,void 0===kb?!1:kb)?
(new Wc.a).setResult(!0):(pa=this.fmj(G,pa),this.isc=G,this.cNd++,pa.continueWith(()=>{this.g8i()},0,Nd.a.none,this.LO))}fmj(G,pa){this.gxg=this.ik.Hia;this.Byf=pa;X.ULS.sendTraceTag(554767493,0,50,`DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge ${G.Current} / ${G.Pending} @${G.SuspensionStartTimestamp}. allowSelectionAdjustment: ${pa}`);this.isDocumentHidden||this.JB();return this.rPj(pa,G)}JTb(G,pa,kb){kb=void 0===kb?!1:kb;if(this.wEa&&!pa&&!this.wEa.cMi())return X.ULS.sendTraceTag(523317956,
0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.isc||G.SuspensionStartTimestamp>this.isc.SuspensionStartTimestamp)return this.BQa&&X.ULS.sendTraceTag(523551556,0,50,`DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: ${G.Current} / ${G.Pending} @${G.SuspensionStartTimestamp}`),!1;if(this.BQa)return!0;if(kb)return!1;kb=this.isc;const Zb=this.ik.Hia-this.gxg<this.YVd;
pa=this.Byf===pa;return(G||kb?G&&kb?G.Current===kb.Current&&G.Pending===kb.Pending&&G.SuspensionStartTimestamp===kb.SuspensionStartTimestamp:!1:!0)&&Zb&&pa}rPj(G,pa){const kb=this.ua.ze(),Zb=()=>{X.ULS.sendTraceTag(588276806,0,10,`DoPendingMergeSender.sendDoPendingMergeRequest: request failed ${pa.Current} / ${pa.Pending} @${pa.SuspensionStartTimestamp}`)};return this.wEa?this.wEa.NLj(this.c7h(G,Zb,kb)):this.YIe(null,!0,void 0,Zb,kb)}c7h(G,pa,kb){return(Zb,Lc,Bd)=>{let he=void 0;X.ULS.shipAssertTag(523317955,
0,null!=Zb||G,"!allowSelectionAdjustment requires a non-null initialViewportState.");he=this.h8i.bind(this);Lc&&(he=$d.b.call(null,Ie=>{const ff=Ie.Result;let qf=null===ff||void 0===ff?void 0:ff.AdjustedViewportState;3===(null===ff||void 0===ff?void 0:ff.MergeResultState)&&(qf=void 0);Lc(qf,Ie.StateId)},he));Bd&&(pa=$d.a.call(null,Bd,pa));return this.YIe(Zb,G,he,pa,kb)}}YIe(G,pa,kb,Zb,Lc){var Bd=this.ua;Lc=Bd.Pa(1,void 0===Lc?null:Lc);Lc.viewportState=G;Lc.allowViewAdjustment=pa;return Ob.g(Bd,"DoPendingMerge",
Lc,kb,Zb,null,null,0)}h8i(G){var pa=G.Result;void 0!=pa&&(pa=pa.MergeResultState,2!==pa&&(this.Duc=[pa,G.MergeCount]))}Xtj(G,pa){this.raiseEvent(Hd.vHd,new $b(G,pa))}g8i(){this.cNd--;if(this.Duc){const G=this.Duc;this.Duc=null;this.Xtj(...G)}}}Hd.vHd="MDO";Object(Fa.a)(Hd,"DoPendingMergeSender",qe.a,[445,446]);class re{constructor(G){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=
this.adjusted=this.adjustedDidntChange=0;this.zui=void 0===G?!1:G}get reportName(){return this.zui?"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}Object(Fa.a)(re,"SelectionAdjustSessionEndsReport",null,[459]);var fe=a(45);class oc{constructor(G,pa,kb,Zb,Lc,Bd){this.Pd=G;this.uJ=pa;this.qca=kb;this.F3b=Zb;this.vce=Lc;this.jP=Bd}get activeCell(){return this.uJ}get selectedRanges(){return this.qca}get Ot(){let G=!1;if(null===this.jP||void 0===this.jP)G=!0;else if(this.jP>=this.selectedRanges.length||
!this.selectedRanges[this.jP].contains(this.activeCell))X.ULS.sendTraceTag(521200010,0,50,`SelectionState.indexOfActiveRange: the index of the adjusted active range has changed. indexOfActiveRange: ${this.jP}, selectedRangesLength: ${this.selectedRanges.length}`),G=!0;G&&(this.jP=this.hdh());return this.jP}get activeRange(){return 0>this.Ot?this.activeCell:this.selectedRanges[this.Ot]}get sheetName(){return this.F3b}get activeItemName(){return this.vce}get hCg(){return 1===this.selectedRanges.length}pyg(G){let pa=
this.selectedRanges.map(kb=>this.sgk(kb,this.vce));for(let kb of pa)if(kb)for(let Zb of kb)if(Zb.Nl&&Zb.Cg.Revision<G)return!1;return!0}Vck(){var G;return{SheetName:this.sheetName,ActiveCell:null===(G=this.activeCell)||void 0===G?void 0:G.toString(),TopLeft:void 0,SelectedRanges:fe.r(this.selectedRanges,this.Pd)}}toString(){var G,pa;return`active cell: ${null!==(pa=null===(G=this.activeCell)||void 0===G?void 0:G.toString())&&void 0!==pa?pa:"null"} selection: ${pc.f(this.selectedRanges,kb=>{var Zb;
return null!==(Zb=null===kb||void 0===kb?void 0:kb.toString())&&void 0!==Zb?Zb:"null"}).join(",")}`}equals(G){return G?this.activeCell.equals(G.activeCell)&&fe.R(this.selectedRanges,G.selectedRanges)&&this.sheetName===G.sheetName:!1}hdh(){for(let G of this.selectedRanges.entries()){let [pa,kb]=G;if(null===kb||void 0===kb?0:kb.contains(this.activeCell))return pa}return-1}sgk(G,pa){var kb;const Zb=Yd.h(this.Pd).ya.EOa(G,pa);Zb||X.ULS.sendTraceTag(522803340,0,50,`SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: ${null!==
(kb=null===G||void 0===G?void 0:G.toString())&&void 0!==kb?kb:"null"} ; activeItemNameIsDefined: ${!!pa}`);return Zb}}Object(Fa.a)(oc,"SelectionState",null,[]);var Xc=a(225),ud=a(771);class Vd{constructor(G){this.aIc=0;this.fK=this.pI=null;this.Lce=new re;this.Mce=new re(!0);this.iL=0;this.cbk=!1;this.$Zi=1E4;this.fg=()=>{this.pSe()};this.Bk=()=>{this.S6c(!0,!1)};this.teb=()=>{this.S6c(!1,!1)};this.$=G;this.gridView=Yd.h(this.$);this.gridView.ya.wt(this.Bk);this.gridView.ya.Zu(this.teb);this.gridView.ya.Rze(this.teb);
this.gridView.ya.Hca(this.teb);this.$.zn(this.fg);this.pSe()}NLj(G){let pa=null,kb=null,Zb=()=>{this.x4i()};this.Zpf()?(this.NS.parallel++,X.ULS.sendTraceTag(526390086,0,15,`SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : ${!!this.fK}`)):(pa=(Lc,Bd)=>{this.y4i(Lc,Bd)},kb=this.uVj());return null===G||void 0===G?void 0:G(kb,pa,Zb)}cMi(){return!this.Zpf()&&this.yea().hCg}uVj(){var G;X.ULS.shipAssertTag(525135961,0,0===this.iL,"SelectionAdjustManager.setPreRequestState: unexpected state");
this.fK&&(this.NS.errors++,X.ULS.sendTraceTag(526960090,0,10,`SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: ${this.fK.toString()}`));this.fK=null;this.pI=this.yea();let pa=null;const kb=null===(G=this.pI)||void 0===G?void 0:G.Vck();kb&&(pa={ActiveSheetName:this.pI.sheetName,SheetViewportStateChanges:[kb]});this.iL=1;return pa}x4i(){X.ULS.shipAssertTag(525135960,0,1===this.iL,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.NS.errors++;
this.iL=2;this.At()}y4i(G,pa){try{X.ULS.shipAssertTag(525135959,0,1===this.iL,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.aIc=pa,pa=2,this.pI?G?(this.fK=this.cZj(G))?(pa=7,this.pI.equals(this.fK)?this.pI.equals(this.yea())?(this.NS.adjustedDidntChange++,pa=4):(this.NS.adjustedDidntChangeWithDivergence++,pa=5):this.pI.sheetName!=this.fK.sheetName?(this.NS.differentSheetAdjust++,pa=10):this.pI.equals(this.yea())||(this.NS.divergenceOnResponse++,pa=6,this.C7f())):this.NS.errors++:
(this.NS.errors++,X.ULS.sendTraceTag(537155412,0,15,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: ${this.pI.toString()}`)):(this.NS.errors++,X.ULS.sendTraceTag(537155413,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: ${null===G||void 0===G?void 0:G.ActiveCell}`)),this.iL=pa}catch(kb){this.iL=12,X.ULS.sendTraceTag(525135958,0,10,`SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception ${kb}`)}finally{7!=
this.iL?this.At():this.S6c(!1,!0)}}dispose(){this.gridView.ya.ds(this.Bk);this.gridView.ya.Tt(this.teb);this.gridView.ya.E5f(this.teb);this.gridView.ya.AVa(this.teb);this.$.uo(this.fg)}Zpf(){return 1===this.iL||7===this.iL}cZj(G){let pa;if(!(()=>{let Bd=fe.ab(G.ActiveCell,this.$.ta);({range:pa}=Bd);return Bd})().returnValue)return X.ULS.sendTraceTag(537155411,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell ${G.ActiveCell}`),null;let kb=[];const Zb=this.$.pa,
Lc=!!Zb&&2===Zb.dJ;if(G.SelectedRanges)kb=fe.g(G.SelectedRanges.Ranges);else if(!Lc)return X.ULS.sendTraceTag(522826913,0,10,`SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null, active sheet exists: ${!!Zb}`),null;return new oc(this.$,pa,kb,G.SheetName,this.pI.activeItemName,this.pI.Ot)}yea(){const G=this.$.pa;if((null===G||void 0===G?0:G.activeCell)&&G.selectedRanges&&G.sheetName)return new oc(this.$,G.activeCell,G.selectedRanges,G.sheetName,this.$.activeItemName,G.Ot);
X.ULS.sendTraceTag(525135957,0,15,`SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: ${!G}, activeCell null: ${!(null===G||void 0===G?0:G.activeCell)}, selectedRanges null: ${!(null===G||void 0===G?0:G.selectedRanges)}, sheetName null: ${!(null===G||void 0===G?0:G.sheetName)}`);return null}pSe(){this.$.ia.Od(276,()=>{const G=Xc.a(this.$);G.YW(this.Lce);G.YW(this.Mce)})}S6c(G,pa){var kb;if(this.dKi(G))if(8===this.iL)X.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");
else{pa&&X.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{X.ULS.shipAssertTag(525135956,0,7===this.iL,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.pI.equals(this.yea())?(null===(kb=this.gridView)||void 0===kb?0:kb.Kd)?(this.NS.editBoxDivergence++,this.iL=11):(G=0,G=this.fK.Ot,-1==G?(this.NS.errors++,X.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange")):
(this.NS.adjusted++,this.iL=8,this.gridView.ga.bJ(this.fK.selectedRanges,G,this.fK.activeCell,0,void 0,"SelectionAdjust"))):(this.NS.divergenceOnViewportReady++,this.C7f(),this.iL=9)}catch(Zb){this.iL=12,X.ULS.sendTraceTag(525135955,0,10,`SelectionAdjustManager.attemptAdjustSelection: caught Exception ${Zb}`)}finally{this.At()}}}dKi(G){if(!this.fK)return!1;if(!this.pI)return X.ULS.sendTraceTag(537155409,0,10,`SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: ${this.fK.toString()}`),
!1;if(Yd.h(this.$).ya.DFf<this.aIc)return!1;if(G||this.cbk)X.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust");else if(!this.pI.pyg(this.aIc)||!this.fK.pyg(this.aIc))return!1;return!0}At(){this.pI=this.fK=null;this.iL=0}C7f(){const G=this.yea();X.ULS.sendTraceTag(537155408,0,50,`SelectionAdjustManager.ReportDivergence: initial: ${this.pI.toString()} current: ${G?G.toString():""} adjusted: ${this.fK.toString()} sheetSameBetweenInitialAndAdjusted: ${this.pI.sheetName===
this.fK.sheetName} sheetSameBetweenInitialAndCurrent: ${this.pI.sheetName===(G?G.sheetName:null)}`)}get NS(){return ud.a.nG(this.$Zi)?this.Mce:this.Lce}}Object(Fa.a)(Vd,"SelectionAdjustManager",null,[443,5]);class ge extends fd.a{constructor(G,pa,kb){kb=void 0===kb?null:kb;super();this.mHa=this.$mc=this.O$a=this.a5a=null;this.$=G;this.h1a=new Zd(G);this.wEa=new Vd(this.$);this.hNa=new Hd(this.$.qa.ua,this.$,void 0,void 0,this.wEa);this.owi(G,kb);this.Fja=new Qc(this.mHa,this.h1a,this.hNa);this.RVd=
new Kc(G,this.Fja,pa,this.hNa);Vb.EwaSettings.Fa(230)&&(this.$mc=new Sd(G,this));X.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created")}T6b(G){this.Fja.T6b(G)}oCc(G){this.Fja&&this.Fja.oCc(G)}get Fla(){return this.mHa}get Dqa(){return this.h1a}get Z9(){return this.Fja}TDa(G,pa){this.mHa.TDa(G,pa)}l8d(G){this.mHa.l8d(G)}CTa(G,pa){this.h1a.CTa(G,void 0===pa?"":pa)}dispose(){this.$mc&&(this.$mc.dispose(),this.$mc=null);this.wEa&&this.wEa.dispose();this.hNa.dispose();this.RVd&&(this.RVd.dispose(),
this.RVd=null);this.Fja&&(this.Fja.dispose(),this.Fja=null);this.h1a.dispose();this.h1a=null;this.mHa.dispose();this.mHa=null;this.a5a&&(this.a5a.dispose(),this.a5a=null);this.O$a&&(this.O$a.dispose(),this.O$a=null);this.$=null;super.dispose()}SOb(){this.Fja.zuj()}static ric(G){let pa=0;for(let kb of G){if(2==kb)return 2;1==kb&&(pa=1)}return pa}owi(G,pa){this.mHa=new Tc(this.hNa,this.h1a);pa?Object(Jd.a)(ee,pa)?this.TDa(pa,Object(db.a)(ee,pa).sL):Object(Jd.a)(ve,pa)?this.TDa(pa,Object(db.a)(ve,pa).sL):
this.TDa(pa,0):(this.a5a=new ve(G),this.O$a=new ee(G),this.TDa(this.a5a,this.a5a.sL),this.TDa(this.O$a,this.O$a.sL))}}Object(Fa.a)(ge,"MergeSuspensionManager",fd.a,[420,5]);class Je extends pb.a{constructor(G){super();this.Kf=G;this.Oe()}create(){X.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.ve(this.Kf.ia.Ja(343)||this.Kf.ia.Va(343,new ge(this.Kf,$c.a.instance)))}static la(G){X.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");G.ia.Va(344,new Je(G))}}Object(Fa.a)(Je,
"MergeSuspensionFactory",pb.a,[]);var Ke=a(734),nf=a(96),uf=a(102),ef=a(60),Ve=a(12);class bd{}bd.wRi=3;bd.connected=0;Object(Fa.a)(bd,"ConnectionStateConstants",null,[]);var be=a(123),jb=a(137),lc=a(46);class Zc{constructor(G,pa,kb){var Zb;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=
this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.HKf=(Lc,Bd)=>{this.blockedOperationsCount++;Lc=`${Bd.componentName}_${Bd.actionName}_${Bd.details})`;this.blockedActions[Lc]=this.blockedActions[Lc]?this.blockedActions[Lc]+1:1;this.isToastShown&&this.blockedUserOperationsWhileToastShown++};this.VMd=Lc=>{this.durationUntilUserInactive=be.getElapsedSeconds(this.startTime,Ud.a.Jd.Re);Lc.KUd(this.VMd)};this.KI=()=>{this.hasTabbedOut=
!0};this.Aga=(Lc,Bd)=>{Bd.EWf!==this.type||this.isToastShown||(this.durationUntilToastShownMs=jb.a(Ud.a.Jd,this.startTime),this.toastRaiser=Bd.toastRaiser,this.isToastShown=!0)};this.startTime=G;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=kb;if(null===(Zb=pa.ea)||void 0===Zb?0:Zb.Uh)this.wasUserActiveOnPIStart=pa.ea.Uh.Ps;this.Zk(pa);this.isDialogShown=0<pa.Rd.dR;G=pa.ia.Ja(183);this.isTaskPaneShown=!!G&&G.isVisible&&!G.isCollapsed;this.isTaskPaneCollapsed=!!G&&G.isVisible&&
G.isCollapsed}Beg(){this.durationMs=jb.a(Ud.a.Jd,this.startTime)}WLd(G){var pa;this.Beg();lc.a(G).iQb(this.HKf);lc.a(G).Pi.jCc(this.Aga);Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void nc.a.resolve(Oc.W).then(kb=>{kb.CVa(this.KI)}):G.ia.Od(291,kb=>{kb.CVa(this.KI)});if(null===(pa=G.ea)||void 0===pa?0:pa.Uh)G.ea.Uh.KUd(this.VMd),this.wasUserActiveOnPIEnd=G.ea.Uh.Ps}Zk(G){lc.a(G).K6b(this.HKf);this.isToastShown?this.toastRaiser="Immediate":
lc.a(G).Pi.z4c(this.Aga);Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void nc.a.resolve(Oc.W).then(pa=>{this.hasTabbedOut=pa.Cj;pa.T0(this.KI)}):G.ia.Od(291,pa=>{this.hasTabbedOut=pa.Cj;pa.T0(this.KI)});this.wasUserActiveOnPIStart&&G.ea.Uh.pBe(this.VMd)}}Object(Fa.a)(Zc,"PartialInteractivityData",null,[]);var dd=a(1114);class Qd extends Zc{constructor(G,pa,kb,Zb,Lc,Bd){super(G,pa,Zb);this.swappedOffline=this.swappedByOffline=!1;this.lastFailedRequestToOnlineTimeGapSec=
this.longestDurationBetweenFailedRequestsSec=this.averageDurationBetweenFailedRequestsSec=0;this.errorDataDuringConnectivityIssuesMode=this.disconnectionSource=null;this.failedRequests=[];this.triggeringRequest=null;this.type=4;this.swappedOffline=kb;this.disconnectionSource=Enum.toString(dd.a,Lc);this.triggeringRequest=Bd}Z6i(G,pa){this.swappedByOffline=pa;this.WLd(G)}$Sj(G){this.errorDataDuringConnectivityIssuesMode=G}Ywj(G){10>this.failedRequests.length&&(G=G+"_"+be.getElapsedSeconds(this.startTime,
Ud.a.Jd.Re).toString(),this.failedRequests.push(G))}}Object(Fa.a)(Qd,"ConnectivityIssuesData",Zc,[]);var ue=a(164),qa=a(136),Xa=a(135);class wb{}wb.gEh="DuringWork";wb.connectivityIssues="ConnectivityIssues";wb.offline="Offline";Object(Fa.a)(wb,"UnavailabilityTypes",null,[]);var Rb=a(55);class vc{constructor(G){this.csc=this.data=null;this.lkd=0;this.IOe=null;this.WLf=(pa,kb)=>{kb.HS?(this.data=new Qd(Ud.a.Jd.Re,this.$,5===kb.Csa,0!==kb.Csa,this.$.xh.disconnectionSource,this.IOe),this.csc=this.$.xh.uzf,
this.lkd=1,this.$.qa.xh.J1g(this.ip),ue.a(this.$).c4c(this.Nag)):(this.data.Z6i(this.$,5===kb.Csa),this.$.qa.xh.L6f(this.ip),this.data.lastFailedRequestToOnlineTimeGapSec=be.getElapsedSeconds(this.csc,Ud.a.Jd.Re),Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?Rb.b().lSb(557682689,0,50,wb.connectivityIssues,this.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",ef.a.ff(this.data)):
X.ULS.sendTraceTag(557682689,0,50,`ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: ${ef.a.ff(this.data)}`),this.data&&this.data.isToastShown&&uf.Health.instance.recordQosError(qa.a.lih,[Xa.a.Ssc],!0,!1,!1,!1,null),ue.a(this.$).aUd(this.Nag),this.data=null)};this.Nag=(pa,kb)=>{this.data.$Sj(kb.ZH)};this.ip=(pa,kb)=>{this.data.Ywj(kb.context.methodName);pa=Ud.a.Jd.Re;kb=be.getElapsedSeconds(this.csc,pa);this.csc=pa;kb>this.data.longestDurationBetweenFailedRequestsSec&&
(this.data.longestDurationBetweenFailedRequestsSec=kb);this.lkd++;this.data.averageDurationBetweenFailedRequestsSec=this.Qch(kb)};this.TLf=(pa,kb)=>{this.IOe=kb.Qfk};this.$=G;lc.a(this.$).Pi.Zze(this.WLf);this.$.xh.Yze(this.TLf)}dispose(){this.$&&(lc.a(this.$).Pi.N5f(this.WLf),this.$.xh&&this.$.xh.M5f(this.TLf));this.data&&this.$.qa.xh.L6f(this.ip);this.$=null}Qch(G){const pa=this.lkd-1;return(this.data.averageDurationBetweenFailedRequestsSec*(pa-1)+G)/pa}}Object(Fa.a)(vc,"ConnectivityIssuesTelemetryManager",
null,[5]);var Nc=a(904),id=a(8),Id=a(1113),me=a(1112);class Wb{constructor(G){this.L$f=null;this.nDd=this.HHd=this.JLb=this.KLb=0;this.F1d=!1;this.sbd=this.MXa=this.yHc=this.Wdb=null;this.Ibd=0;this.lPj=()=>{if(12E4>this.$.ea.Uh.ukb)for(let pa of this.yHc)pa.runTest();else this.u4d("UserInactive")};this.CHj=pa=>{pa=Sys.Serialization.JavaScriptSerializer.serialize(pa);X.ULS.sendTraceTag(388821830,0,50,pa)};this.RGj=pa=>{if(pa){var kb=this.sbd[pa.testIteration.toString()];kb?kb.push(pa):(kb=[pa],this.sbd[pa.testIteration.toString()]=
kb);if(kb.length===this.L$f.length){kb=Sys.Serialization.JavaScriptSerializer.serialize(kb);if(this.$&&this.$.xh){if(pa.EstimatedLatency=this.$.xh.kGe,this.$.xh.kGe>this.$.fC.ExcelRountripThresholdMs){X.ULS.sendTraceTag(570712144,0,50,`Periodic ping tests results when network is slow: ${kb}, consequtive slow ping iteration #: ${this.Ibd++}`);return}}else X.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");X.ULS.sendTraceTag(570712142,
0,50,`Periodic ping tests results: ${kb}`);this.Ibd=1}}};this.Uj=(pa,kb)=>{pa=kb.context.methodName;if(pa===id.a.eDb||pa===id.a.Hza)this.JLb++,pa=Date.now(),this.M_j(pa)&&(this.JLb=0,this.nDd=pa,this.r8j())};this.zga=()=>{this.Z3d("OnThrottledUserActivity")};this.KI=()=>{this.u4d("OnDocumentHidden")};this.QC=()=>{this.Z3d("OnDocumentUnhidden")};this.$=G;if(this.G1d=this.Ggh())this.L$f=[me.a.jNc],this.Ibd=1,this.sbd={},this.$.ea.Uh.kwa(this.zga),Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void nc.a.resolve(Oc.W).then(pa=>{pa.T0(this.KI);pa.$W(this.QC)}):this.$.ia.Od(291,pa=>{pa.T0(this.KI);pa.$W(this.QC)})}dispose(){this.$&&(this.F1d&&this.$.qa&&0<this.Wdb.count&&this.$.qa.Kv(this.Uj),this.G1d&&(this.u4d("Dispose"),this.$.ea.Uh.aEa(this.zga)))}Qvi(){Vb.EwaSettings.Fa(199)&&this.rpj();this.G1d&&this.spj()}pwi(){this.JLb=this.KLb;this.nDd=0;var G={};if(!this.Wdb){this.Wdb=new sa.a;const pa=Id.a.Mmd(this.CHj,"InitSampleMeasurement",this.$);for(const kb of pa)G[kb.Qud]=kb.baseUrl,
this.Wdb.add(kb)}G=Sys.Serialization.JavaScriptSerializer.serialize(G);X.ULS.sendTraceTag(537155210,0,50,`Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: ${this.KLb}, numberOfRequestFromTheLastNetworkMeasurement: ${this.JLb}, testParams: ${G} `);0<this.Wdb.count&&this.$.qa.gu(this.Uj)}r8j(){for(let G of this.Wdb)G.runTest()}Z3d(G){this.MXa&&this.MXa.ep||(X.ULS.sendTraceTag(537155208,0,50,`NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: ${G}`),this.MXa=
$c.a.instance.SF(this.lPj,5E3,Yc.a.m6j),this.MXa.qQ())}u4d(G){this.MXa&&this.MXa.ep&&(X.ULS.sendTraceTag(537155207,0,50,`NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: ${G}`),this.MXa.cancel())}M_j(G){return this.JLb>=this.KLb&&G-this.nDd>this.HHd}Ggh(){return Wb.A$f(this.$.xa.SlowNetworkMeasurementsSamplePercentage)}rpj(){this.KLb=this.$.xa.NumberOfRequestToWaitPerNetworkMeasurement;this.HHd=1E3*this.$.xa.MinTimeBetweenNetworkMeasurementInSec;const G=this.$.xa.NetworkMeasurementsSamplePercentage;
0<this.KLb&&0<this.HHd&&(this.F1d=Wb.A$f(G))&&this.pwi()}spj(){if(!this.yHc){this.yHc=new sa.a;const G=Id.a.Mmd(this.RGj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[me.a.jNc]);for(const pa of G)this.yHc.add(pa);this.$.ea.Uh.Ps&&this.Z3d("PrepareAndInitSlowNetworkTests")}}static A$f(G){return 100*Math.random()<G}}Object(Fa.a)(Wb,"NetworkMeasurement",null,[5]);var Ec=a(40),hd=a(150),je=a(867);class Ee{constructor(G){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=
null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=G}get count(){return this._count}get EX(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}vkk(){this.EX&&this.EX.Beg()}WWg(G){this.allOfflinePartialInteractivitiesDataInSession.push(G);this._count++}}Object(Fa.a)(Ee,"OfflinePartialInteractivitiesDataForLog",null,[]);class Ge extends Zc{constructor(G,pa,kb){super(G,pa,kb);this.timeFromLastOffline=0;this._errorDataDuringOfflineMode=
null;this.timeFromLastOffline=-1;this.type=5}OWj(G){this.timeFromLastOffline=G}aTj(G){this._errorDataDuringOfflineMode=G}}Object(Fa.a)(Ge,"OfflinePartialInteractivityData",Zc,[]);class bf{constructor(G,pa){this.nTa=this.EX=null;this.YPd=-1;this.eBb=null;this.ozf=Jb.Task.delay(0);this.Qeb=(kb,Zb)=>{Zb.HS?this.Cdj(Zb.Csa):this.Ddj()};this.Aga=(kb,Zb)=>{5===Zb.EWf&&this.k8a()};this.Oag=(kb,Zb)=>{this.EX.aTj(Zb.ZH)};this.k8a=()=>{this.nTa.vkk();this.JMj(bf.VNd,Sys.Serialization.JavaScriptSerializer.serialize(this.nTa))};
this.sHj=kb=>{if(kb=kb.result)this.Fyg=!0,X.ULS.sendTraceTag(576811915,0,50,`OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: ${kb}`)};this.cBj=()=>{this.Fyg&&(this.$?Ec.TaskExtensions.Aa(this.indexedDB.zfd(bf.VNd),()=>{X.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},this.$.ma):X.ULS.sendTraceTag(537155203,
0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.qTa=()=>{if(this.nTa&&0<this.nTa.count){const kb=Sys.Serialization.JavaScriptSerializer.serialize(this.nTa);X.ULS.sendTraceTag(560791644,0,50,`OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: ${kb}`)}};this.$=G;this.indexedDB=pa;this.Fyg=!1;this.indexedDB.li()&&(this.indexedDB.initialize(bf.hFb,bf.iFb),this.LGj(),this.nTa=
new Ee(this.$.xa.UserSessionId),lc.a(this.$).Pi.t4c(this.Qeb));this.np=hd.a.instance.WM();this.np.la("beforeunload",this.qTa)}dispose(){this.$&&lc.a(this.$)&&lc.a(this.$).Pi.sUd(this.Qeb);nf.a.Ma(this.eBb);this.$=this.eBb=null}Cdj(G){this.EX=new Ge(Ud.a.Jd.Re,this.$,0!==G);this.EX.OWj(-1!==this.YPd?window.performance.now()-this.YPd:-1);this.nTa.WWg(this.EX);lc.a(this.$).Pi.z4c(this.Aga);this.k8a();this.eBb=$c.a.instance.SF(this.k8a,bf.fXh,Yc.a.k8a);ue.a(this.$).c4c(this.Oag)}Ddj(){this.EX.WLd(this.$);
this.k8a();nf.a.Ma(this.eBb);this.eBb=null;this.YPd=window.performance.now();lc.a(this.$).Pi.jCc(this.Aga);ue.a(this.$).aUd(this.Oag);this.SGj()}JMj(G,pa){this.$?this.ozf=Ec.TaskExtensions.Aa(this.ozf,()=>{this.indexedDB.lib(new je.a(G,pa))},this.$.ma):X.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")}LGj(){const G=this.$.ma;Ec.TaskExtensions.Aa(Ec.TaskExtensions.Aa(this.indexedDB.q9a(bf.VNd),this.sHj,G),
this.cBj,G)}SGj(){if(this.EX){const G=Sys.Serialization.JavaScriptSerializer.serialize(this.EX);Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Rb.b().lSb(560791645,0,50,wb.offline,this.EX.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",G):X.ULS.sendTraceTag(560791645,0,50,`OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: ${G}`)}this.EX&&
this.EX.isToastShown&&uf.Health.instance.recordQosError(qa.a.Aok,[Xa.a.Ssc],!0,!1,!1,!1,null)}}bf.hFb="NetworkAvailability";bf.iFb="NetworkAvailabilityData";bf.VNd="partialInteractivityData";bf.fXh=3E3;Object(Fa.a)(bf,"OfflineModeTelemetryManager",null,[5]);var of=a(1211);const hf=G=>{G.isSuccess||(G=Sys.Serialization.JavaScriptSerializer.serialize(G),X.ULS.sendTraceTag(509669840,0,10,G))};class na{constructor(G,pa){this.Lpa=this.FId=this.AJf=null;this.$=G;Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
Za.a.Zh||(this.AJf=new bf(G,pa));Vb.EwaSettings.Fa(199)&&(this.FId=new Wb(this.$),this.FId.Qvi());Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Za.a.Zh||(this.Lpa=new Nc.NetworkConnectionHealthChecker(this.$));this.bmh=new vc(this.$);Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.1CdnDarkTestEnabled",!1)&&(G=this.$,pa=Vb.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.1CdnDarkTestTargetUrl",""),""!==pa&&(new of.a(G,"1CDN",pa,hf,"runOneCdnNetworkTest")).runTest())}dispose(){nf.a.Ma(this.AJf);
nf.a.Ma(this.FId);nf.a.Ma(this.Lpa);nf.a.Ma(this.bmh);this.$=null}}Object(Fa.a)(na,"NetworkConnectionTelemetryManager",null,[5]);class S extends Zc{constructor(G,pa,kb,Zb){super(G,pa,kb);this.wasInteruptedByOfflineMode=!1;this.type=Zb;this.wasInteruptedByOfflineMode=!1}Qeb(){this.wasInteruptedByOfflineMode=!0}}Object(Fa.a)(S,"SilentReopenData",Zc,[]);class Ja{constructor(G){this.Jaa=null;this.HTf=(pa,kb)=>{this.FTf(kb,3)};this.YPf=(pa,kb)=>{this.FTf(kb,2)};this.$=G;this.Pi=lc.a(this.$).Pi;this.Pi.EAe(this.YPf);
this.Pi.l1g(this.HTf)}dispose(){this.Pi.m6f(this.YPf);this.Pi.pFj(this.HTf);this.Jaa=this.Pi=this.$=null}FTf(G,pa){G.HS?this.Jaa=new S(Ud.a.Jd.Re,this.$,0!==G.Csa,pa):(5===G.Csa&&(this.Jaa.wasInteruptedByOfflineMode=!0),3!==G.Csa&&2!==G.Csa||X.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.Jaa.WLd(this.$),2===pa?Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?
Rb.b().mSb(571289604,0,50,wb.offline,this.Jaa.durationMs,this.Jaa):X.ULS.sendTraceTag(571289604,0,50,ef.a.ff(this.Jaa)):Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Rb.b().mSb(542782150,0,50,wb.gEh,this.Jaa.durationMs,this.Jaa):X.ULS.sendTraceTag(542782150,0,50,ef.a.ff(this.Jaa)),this.Jaa=null)}}Object(Fa.a)(Ja,"SilentReopenPartialInteractivityTelemetryManager",null,[5]);let rb=class extends qe.a{constructor(G,pa,kb){kb=void 0===kb?!0:kb;super();
this.S4=this.Mac=this.oTa=this.psa=this.HXa=null;this.GHf=0;this.hBc=this.dhb=this.ehb=!1;this.IHf=this.documentVisibilityObserver=null;this.Fua=!1;this.Jvd=this.Raa=0;this.GHb=!1;this.hlg=0;this.x1d=!1;this.c5=null;this.HQf=()=>{X.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");this.Ouc(1,!1)};this.QC=()=>{this.Joa||this.XJb?window.setTimeout(()=>{this.B6d()},this.GHf):this.B6d();this.documentVisibilityObserver.ZDa(this.QC);this.GHb=!1};this.rj=
()=>{X.ULS.sendTraceTag(537155218,0,50,`NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:${this.XJb}, IsInDuringWorkSilentReopenMode:${this.Dtc&&!this.Fua}`);this.XJb&&this.fxe();this.Dtc&&!this.Fua&&this.axe();Yd.h(this.$).cellTextEditBox.Pp(this.rj);this.ehb=this.dhb=!1};this.IQf=()=>{X.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");this.Ouc(1,!0);this.dhb&&!this.ehb&&Yd.h(this.$).cellTextEditBox.Pp(this.rj);this.dhb=
!1};this.zga=(Zb,Lc)=>{this.Jvd=this.Raa;this.Raa=Lc.AJc};this.GTf=()=>{this.$&&(this.hBc||(Pb.a(this.$).ZT(ub.a.ZTa).KZg(this.RQf),this.$.zn(this.fg),this.hBc=!0),this.Fua=this.xCi(),this.Ouc(2,!1))};this.RQf=()=>{var Zb=Pb.a(this.$).vk;const Lc=Zb.m5g();Zb=pc.f(Zb.Vv.Pf.errors,Bd=>Bd.MessageIdName);X.ULS.sendTraceTag(545842889,0,50,`NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:${Lc}, IsB2W:${this.Fua}, Errors: ${ef.a.ff(Zb)}`);Lc&&(this.HXa?(this.Fua=
!1,this.STe(),this.GKc()):this.psa&&(this.TTe(),this.GKc()))};this.fg=()=>{this.$?(X.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),this.Fua=!1,this.S4&&this.S4.ep&&(nf.a.Ma(this.S4),this.S4=null),this.c5&&this.c5.ep&&(nf.a.Ma(this.c5),this.c5=null),this.Ouc(2,!0),this.GKc()):X.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};this.ULf=()=>{this.DGf(!0)};this.VLf=()=>{this.DGf(!1)};
this.x3b=bd.wRi;this.Dbd=bd.connected;this.$=G;this.xh=G.qa.xh;kb&&(this.IHf=new na(G,pa));Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void nc.a.resolve(Oc.W).then(Zb=>{this.documentVisibilityObserver=Zb}):this.$.ia.Od(291,Zb=>{this.documentVisibilityObserver=Zb});this.GHf=this.$.xa.ExcelNetworkCheckAfterTabActivationDelayMs;this.xh.KAe(this.HQf);this.xh.ptb(this.IQf);this.xh.Yze(this.ULf);this.xh.rZg(this.VLf);new Ja(this.$,this);this.aDf=
this.$.xa.LongInactivityTimePeriodSeconds;this.$.ea.ztb(this.GTf);this.$.ea.Uh.kwa(this.zga);this.hlg=this.$.xa.SilentReopenDuringWorkDelayMs}get PEi(){return this.Fua}get XJb(){return!(this.x3b&1)}get Dtc(){return!(this.x3b&2)}get Joa(){return!!(this.Dbd&2)}dispose(){this.xh&&(this.xh.r6f(this.HQf),this.xh.hQb(this.IQf),this.xh.M5f(this.ULf),this.xh.OCj(this.VLf));this.GHb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.ZDa(this.QC),this.GHb=!1);this.$&&(this.hBc&&this.GKc(),this.$.ea&&
(this.$.ea.nCc(this.GTf),this.$.ea.Uh&&this.$.ea.Uh.aEa(this.zga)));this.c5&&(this.c5.dispose(),this.c5=null);nf.a.Ma(this.IHf);this.$=null;super.dispose()}ZEf(){this.x1d=!0}axe(){this.psa||(this.psa=lc.a(this.$).Pi.XJa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))}xCi(){if(this.x1d)return this.x1d=!1,!0;const G=this.Raa>this.aDf||this.Jvd>this.aDf&&10>this.Raa;X.ULS.sendTraceTag(537155223,0,50,`NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:${this.Raa}, Time gap between last two activities: ${this.Jvd}. return value:${G}`);
return G}GHj(){this.c5=$c.a.instance.create(()=>{uf.Health.instance.recordQosError(qa.a.r6j,[Xa.a.Ssc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0)}mUg(){this.psa||this.S4?X.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):this.S4=$c.a.instance.create(()=>
{this.$?this.psa?X.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):Yd.h(this.$).Kd?(this.dhb||(Yd.h(this.$).cellTextEditBox.yq(this.rj),X.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),this.ehb=!0,X.ULS.sendTraceTag(537155220,
0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):this.axe():X.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.hlg,Yc.a.j5j,void 0,!0)}DGf(G){this.Dbd=this.GIe(2,G,!0);this.PBe()}Ouc(G,pa){this.x3b=this.GIe(G,pa,!1);this.PBe()}GIe(G,pa,kb){kb=kb?this.Dbd:this.x3b;
return pa?kb|G:kb&~G}B6d(){const G=!!this.oTa,pa=!!this.HXa,kb=!!this.psa,Zb=!!this.Mac;this.XJb&&!G?this.lUg():!this.XJb&&G&&this.rxh();!this.Dtc||pa||kb?this.Dtc||(pa?this.STe():(kb||this.S4&&this.S4.ep)&&this.TTe()):this.Fua?this.kUg():this.S4||this.mUg();this.Joa&&!Zb?this.wqg(!0):!this.Joa&&Zb&&this.wqg(!1)}lUg(){this.$?this.oTa?X.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):
Yd.h(this.$).Kd?(this.ehb||(Yd.h(this.$).cellTextEditBox.yq(this.rj),X.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),this.dhb=!0,X.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.fxe():X.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")}fxe(){this.oTa||
(this.oTa=lc.a(this.$).Pi.XJa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))}rxh(){this.oTa&&(nf.a.Ma(this.oTa),this.oTa=null)}STe(){this.HXa&&(nf.a.Ma(this.HXa),this.HXa=null);this.c5&&this.c5.ep&&this.c5.cancel();this.c5=null}TTe(){this.psa&&(nf.a.Ma(this.psa),this.psa=null);this.S4&&(nf.a.Ma(this.S4),this.S4=null);this.ehb&&!this.dhb&&Yd.h(this.$).cellTextEditBox.Pp(this.rj);this.ehb=!1}kUg(){this.HXa||(this.HXa=lc.a(this.$).Pi.XJa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,Ve.a.instance.ha(2190)));this.GHj()}wqg(G){G?(this.Mac=lc.a(this.$).Pi.XJa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.Csj()):(nf.a.Ma(this.Mac),this.Mac=null)}Csj(){if(this.$&&this.$.qa){const G=this.$.qa.ua.ze();Ob.J(this.$.qa.ua,null,null,null,G)}}GKc(){Pb.a(this.$).ZT(ub.a.ZTa).Ut(this.RQf);this.$.uo(this.fg);this.hBc=!1}PBe(){this.documentVisibilityObserver||X.ULS.sendTraceTag(537155211,0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");
this.documentVisibilityObserver&&this.documentVisibilityObserver.Cj?this.GHb||(this.documentVisibilityObserver.$W(this.QC),this.GHb=!0,X.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.B6d()}};rb=Object(Ke.a)([Object(nc.d)(Oc.ec),Object(Ke.b)(0,Object(Oc.fb)()),Object(Ke.b)(1,Object(Oc.Ob)())],rb);Object(Fa.a)(rb,"NetworkConnectionStateManager",
qe.a,[284,5]);class ma extends pb.a{constructor(G){super();this.$=G;this.Oe()}create(){void nc.a.resolve(Oc.Ob,{Oa:this.$a}).then(G=>{let pa=Object(Sa.a)(this.$.ia,400,()=>new rb(this.$,G));this.ve(pa)})}static la(G){G.ia.Va(401,new ma(G))}}Object(Fa.a)(ma,"NetworkConnectionStateManagerFactory",pb.a,[]);var ib=a(519),Qb=a(94),Fc=a(62);class jd{constructor(G){this.BXa=!0;jd.Dqf()?jd.ICi()?this.BXa=!1:jd.Oqf()?(X.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!G}`),
this.BXa=G):this.BXa=!1:this.BXa=!0}ebb(){return!this.BXa}static Oqf(){return jd.Dqf()&&Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",!1)}static Dqf(){return Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)}static ICi(){return Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)}}Object(Fa.a)(jd,"LineageCatchUpExperimentManager",null,[422]);class ke extends pb.a{constructor(G){super();
this.$=G;this.Oe()}create(){jd.Oqf()?Ec.TaskExtensions.Aa(Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateLineageDiscoverabilityCallout",!1)?Object(Qb.d)(nc.a.resolve(Oc.Wb,{Oa:this.$a})):Fc.GetServiceTaskFactory.je(this.$.ia,456,457,this.$a),G=>{Ec.TaskExtensions.Aa(G.result.F0j(),pa=>{this.TQe(pa.result)},this.$.ma,3)},this.$.ma,3):this.TQe(!0)}TQe(G){this.ve(this.$.ia.Ja(458)||this.$.ia.Va(458,new jd(G)))}static la(G){G.ia.Va(459,new ke(G))}}Object(Fa.a)(ke,"LineageCatchUpExperimentManagerFactory",
pb.a,[]);var ne=a(6),Te=a(76),Hb=a(91);class Cc{constructor(G,pa){this.KAd=!1;this.gi=()=>{this.Arg()};this.$=G;this.$.ea.Vcb&&!Cc.eEb&&(pa&&!pa.BXa||this.xqk(),Cc.nkf?X.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):pa&&!pa.BXa||this.Fqk());X.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.BTd();this.$=null;X.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){Cc.eEb||
(Cc.eEb=!0,X.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.BTd()}Fqk(){this.$.isAnonymousUser()||Ob.i(this.$.qa.ua,G=>{this.$?(G=G.Result,X.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${G}.`),Cc.nkf=!0,G&&this.mrg(0)):X.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},()=>{X.ULS.sendTraceTag(537155457,
0,10,"CheckLineageWywaChanges service call failed.")},null,null)}xqk(){this.Arg()||(this.$.ea.kx(this.gi),this.KAd=!0)}Arg(){return this.$.ea&&this.$.ea.Kp&&this.$.ea.Kp.ShouldTriggerLineageCalloutOnMerge?(X.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.mrg(1),!0):!1}mrg(G){Cc.eEb?X.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):(Cc.eEb=!0,
X.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${G}.`),this.BTd(),Vb.EwaSettings.Fa(418)&&(G=new Hb.a(-847286761,Te.a.Td,this.$.Ie,0,ne.a.i4),this.$.Ga.Sd(G,{["CalloutName"]:4})))}BTd(){this.KAd&&(this.KAd=!1,this.$.ea.Ky(this.gi))}}Cc.eEb=!1;Cc.nkf=!1;Object(Fa.a)(Cc,"LineageTeachingCalloutTriggerManager",null,[419,5]);class vd extends pb.a{constructor(G){super();this.$=G;this.Oe()}create(){Ec.TaskExtensions.Aa(Fc.GetServiceTaskFactory.je(this.$.ia,
458,459,this.$a),G=>{const pa=G.result;G=Object(Sa.a)(this.$.ia,403,()=>new Cc(this.$,pa));this.ve(G)},this.$.ma,3)}static la(G){G.ia.Va(402,new vd(G))}}Object(Fa.a)(vd,"LineageTeachingCalloutTriggerManagerFactory",pb.a,[]);var le=a(801),De=a(429);class Ce extends pb.a{constructor(G){super();this.$=G;this.Oe()}create(){const G=Fc.GetServiceTaskFactory.create(this.$.ia,102,this.$.ma,this.$a),pa=Object(Qb.d)(nc.a.resolve(Oc.p,{Oa:this.$a})),kb=Fc.GetServiceTaskFactory.je(this.$.ia,388,387,this.$a),
Zb=Object(Qb.d)(nc.a.resolve(Oc.Mb,{Oa:this.$a})),Lc=Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateEnrichmentTaskPane",!1)?Object(Qb.d)(nc.a.resolve(Oc.db,{Oa:this.$a})):Fc.GetServiceTaskFactory.je(this.$.ia,257,258,this.$a),Bd=De.a(this.$);Ec.TaskExtensions.Aa(Ec.TaskExtensions.Tg([G,Lc,Bd,pa,kb,Zb],this.ma),()=>{this.ve(Object(Sa.a)(this.$.ia,271,()=>new le.ConvertToLinkedEntityManager(this.$,G.result,kb.result,Lc.result,Bd.result,pa.result,Zb.result)))},this.$.ma,3)}static la(G){G.ia.Va(272,
new Ce(G))}}Object(Fa.a)(Ce,"ConvertToLinkedEntityManagerFactory",pb.a,[]);var af=a(250),Cf=a(277),Jf=a(261),Ff=a(14),ic=a(775),W=a(18),d=a(477);const Na=W.a.POh;let Eb=class extends af.a{constructor(G,pa){let kb=document.getElementById(G.He+ne.a.yZe);kb||(kb=ic.a("div",G.He+ne.a.yZe,"cui-taskpane"));super(kb);this.MV=0;this.zZa=!1;this.Bf=()=>{this.cA(!1)};this.$=G;this.taskPaneManager=pa;Cf.a(G).um(this);this.$.Zl(this.Bf);this.isVisible=!1}K6(G){this.addHandler("EnrichmentTaskPaneVilibilityChanged",
G)}caa(G){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",G)}d0g(G){this.addHandler("EnrichmentTaskPaneOnFocus",G)}nEj(G){this.removeHandler("EnrichmentTaskPaneOnFocus",G)}get isVisible(){return super.isVisible}set isVisible(G){super.isVisible=G;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get uk(){return this.isVisible}get Zg(){return Jf.a.YGh}get oYa(){return 10}get Js(){return Na}get titleText(){return Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")?
CommonUIStrings.l_EnrichmentPaneTitle:"Enrichment"}get FI(){return 300}get isResizable(){return!1}get Df(){return this.domElement}get height(){return this.taskPaneManager.$Ic.offsetHeight}get TG(){return this.taskPaneManager.L8a(this.Df,this.titleText,this.FI,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.FI)}EN(){return this.zZa}KY(){return this.zZa}dispose(){this.$&&this.$.Rp(this.Bf);this.taskPaneManager=this.$=null;super.dispose()}nl(G,
pa){pa||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!pa}Il(G){return Ff.DOMElementExtensions.Sj(this.Df,G)}Vn(){}ap(){}cA(G){(this.isVisible=this.zZa=G)?this.taskPaneManager.yqa("EnrichmentTaskPane",this.TG):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane");G||(Yd.h(this.$).nl(!0,!1),this.$.xj())}};Eb=Object(Ke.a)([Object(nc.d)(Oc.db),Object(Ke.b)(0,Object(Oc.fb)()),Object(Ke.b)(1,Object(d.TaskPaneManagerService)()),Object(Ke.b)(2,Object(d.CommonUIJsServiceService)()),Object(Ke.b)(3,
Object(Oc.E)())],Eb);Object(Fa.a)(Eb,"EnrichmentTaskPane",af.a,[274,5,258,57]);class ac extends pb.a{constructor(G){super();this.yu=this.zS=null;this.$=G;this.Oe()}get HNb(){this.zS||(this.zS=Ec.TaskExtensions.Aa(De.a(this.$),G=>{({result:G}=G);this.yu=this.$.ia.Ja(257)||this.$.ia.Va(257,new Eb(this.$,G))},this.ma,3));return this.zS}create(){const G=Fc.GetServiceTaskFactory.create(this.$.ia,203,this.ma,this.$a),pa=Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",
!1)?Object(Qb.d)(nc.a.resolve(Oc.E,{Oa:this.$a})):Fc.GetServiceTaskFactory.create(this.$.ia,155,this.ma,this.$a);Ec.TaskExtensions.Aa(Ec.TaskExtensions.ts(Ec.TaskExtensions.Tg([G,pa],this.ma),()=>this.HNb,this.ma),()=>{this.ve(this.yu)},this.ma,3)}dispose(){this.yu=this.zS=this.$=null;super.dispose()}static la(G){G.ia.Va(258,new ac(G))}}Object(Fa.a)(ac,"EnrichmentTaskPaneFactory",pb.a,[]);var Jc=a(1239),xd=a(190);class Xd{constructor(){this.onResizeMiddleContainer=this.onTabStripFocus=this.onResizeEnd=
this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(Fa.a)(Xd,"TaskPaneGroupAppProps",null,[]);var xe=a(226);class $e{constructor(){this.type="ExcelLegacyTaskPaneWacInfraProps";this.isSharedRuntime=!1;this.feedbackTaskPaneProps=this.getContent=null}}Object(Fa.a)($e,"ExcelLegacyTaskPaneWacInfraProps",null,[]);var Oe=a(305),Re=a(29),Bf=a(25),Vf=a(21),Tf=a(11);class rg{constructor(G){this.width=
G}}Object(Fa.a)(rg,"ActiveTaskPaneData",null,[]);class bg extends qe.a{constructor(G,pa){super();this.isVisible=!1;this.D5d=this.oia=-1;this.JUe=40;this.jTb=[];this.qTe=this.animationManager=this.QQc=null;this.dLd=()=>{this.X8f()};this.bJc=new Set;this.bJc.add("FieldListTaskPane");this.bJc.add("PivotTableSettingsTaskPane");this.bJc.add("SlicerSettingsTaskPane");this.Pd=pa;Cf.a(this.$).um(this);this.sFa=G;this.Kdb=this.oah();Re.a.Cm()||va.AFrameworkApplication.sa.Sa.qj||(this.sFa.style.bottom=this.$.hg&
4?Tf.HelperMethods.yf(this.$.iFa):"0");this.tgc={};this.hVb={};this.xce={};this.z5d=hd.a.instance.Lg(this.Df);this.z5d.la("focusin",this.dLd);this.Lyi()}get $(){return this.Pd}get $va(){return this.xce}get zT(){return this.QQc}get isCollapsed(){return!this.zT}dispose(){Cf.a(this.$).bD(this);const G=this.tgc;for(let pa in G)({key:pa,value:G[pa]}).value();this.hVb=this.xce=this.tgc=null;this.z5d.VH();this.Kdb=this.sFa=this.z5d=null;super.dispose()}L8a(G,pa,kb,Zb,Lc,Bd,he,Ie,ff,qf,eg,dh,nh,Ug,rh,oj){ff=
void 0===ff?bg.TQi:ff;qf=void 0===qf?bg.SQi:qf;eg=void 0===eg?null:eg;dh=void 0===dh?null:dh;nh=void 0===nh?!1:nh;Ug=void 0===Ug?!1:Ug;rh=void 0===rh?null:rh;oj=void 0===oj?!1:oj;const Vi=Object(Fd.a)(new $e,{getContent:()=>G});Vi.isSharedRuntime=nh;return Object(Fd.a)(new Jc.a,{hideHeader:Ug,contentProps:Vi,title:pa,titleTag:rh,width:kb,location:2,onOpen:Lc,onClose:Bd,onShow:he,onHide:Ie,iconUrl:eg,iconId:dh,enableResize:Zb,minResizeWidth:ff,maxResizeWidth:qf,showResizeChatButton:oj})}yqa(G,pa){Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&
this.jTb.indexOf(G)&&(this.jTb[G]=!0);xd.UISurfaces.Pl().then(kb=>{G in this.$va?kb.setSelectedTaskPane(G):kb.showTaskPane(G,pa);return null})}Wdd(G,pa){this.jTb[G]=!1;xd.UISurfaces.Pl().then(kb=>{kb.initializeHiddenSharedRuntimeTaskPane(G,pa);const Zb=this.$.domElement;Zb.addEventListener("scroll",function Bd(){0!=Zb.scrollLeft&&(Zb.scrollLeft=0,Zb.removeEventListener("scroll",Bd))})})}updateTaskPane(G,pa){Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8098320_SDXPreloadFix")&&this.jTb.indexOf(G)&&
!this.jTb[G]||xd.UISurfaces.Pl().then(kb=>{kb.updateTaskPane(G,pa);return null})}setSelectedTaskPane(G){xd.UISurfaces.Pl().then(pa=>{pa.setSelectedTaskPane(G);return null})}hideTaskPane(G){xd.UISurfaces.Pl().then(pa=>{pa.hideTaskPane(G,bg.Jak);return null})}get Df(){return this.sFa}get uk(){return this.isVisible}get Zg(){return Jf.a.C5d}nl(G,pa){return pa?!1:(this.kcg(),!0)}Il(G){return Ff.DOMElementExtensions.Sj(this.Df,G)}Vn(){this.$.frame.zi.Sp(this.Zg)}ap(){}oah(){const G=document.createElement(xe.a.div);
G.style.height="0px";G.style.width="0px";G.tabIndex=-1;return G}n1h(){var G=Ff.DOMElementExtensions.getElementById(this.sFa,"tabStripFocusZone");if(G){G=G.getElementsByTagName("button");for(let pa=0;pa<G.length;pa++)if(Boolean.parse(G[pa].getAttribute("aria-selected")))return G[pa].getAttribute("aria-controls")}return null}rlh(G){return(G=window.getComputedStyle(G,null).getPropertyValue("transition-duration"))?parseInt(G.endsWith("ms")?parseFloat(G):1E3*parseFloat(G),10):0}Lyj(){const G=document.getElementById("tabbedTaskPaneContainer");
G&&G.addEventListener("transitionend",()=>this.ALa(-1))}Lyi(){xd.UISurfaces.Pl().then(G=>{let pa=new Xd;pa.middleContainer=this.Kdb;pa.onOpen=(kb,Zb)=>{this.isVisible=!0;-1===this.oia&&(this.oia=this.rlh(Zb));Re.a.Cm()||(this.$va[kb]=new rg(Ff.DOMElementExtensions.nT(Ff.DOMElementExtensions.getElementById(Zb,bg.Qog))))};pa.onClose=kb=>{this.isVisible=0<G.selectors.getTabbedTaskPaneCount();X.ULS.sendTraceTag(537014371,0,50,`Closing of ${kb} TaskPane`);if(!this.isVisible)this.T6e(),Re.a.Cm()||va.AFrameworkApplication.sa.Sa.qj||
window.requestAnimationFrame(()=>{this.g7b(this.Kdb)});else if(!Re.a.Cm()&&this.zT&&this.zT!==kb){const Zb=1<G.selectors.getTabbedTaskPaneCount()?this.Ikc():0,Lc=1===G.selectors.getTabbedTaskPaneCount()?-1*this.Ikc():0;this.KBe(kb,this.zT,Zb,Lc)}Re.a.Cm()?this.ALa(this.oia):(va.AFrameworkApplication.sa.Sa.qj&&0>=this.oia&&this.ALa(this.oia),delete this.$va[kb]);delete this.hVb[kb]};pa.onShow=(kb,Zb)=>{null!=this.jj&&(this.jj.stop(),this.jj=null);this.QQc=kb;this.X8f();1!==Zb&&window.requestAnimationFrame(()=>
{window.setTimeout(()=>{this.ELj()},0)});Re.a.Cm()?window.requestAnimationFrame(()=>{this.ALa(this.oia)}):va.AFrameworkApplication.sa.Sa.qj&&0>=this.oia?window.requestAnimationFrame(()=>{this.ALa(this.oia)}):window.requestAnimationFrame(()=>{this.hNj(this.Kdb,this.oia)})};pa.onHide=(kb,Zb,Lc)=>{const Bd=this.n1h();Bd!==kb&&(this.jj=this.$.pe.xf("UserAction","TaskPaneToggle"),X.ULS.sendTraceTag(537014370,0,50,`Toggling Pane from ${kb} to ${Bd}`));Lc?Re.a.Cm()||this.g7b(this.Kdb):!Re.a.Cm()&&Bd&&(kb=
1===Object.keys(this.$va).length?this.Ikc():0,this.KBe(this.zT,Bd,this.Ikc(),kb));this.QQc=null;Lc&&1!==Zb&&this.T6e();Re.a.Cm()&&window.requestAnimationFrame(()=>{this.ALa(this.oia)})};pa.setFocusCallback=(kb,Zb)=>{Zb&&(this.hVb[kb]=Zb)};pa.onResizeStart=()=>{Re.a.Cm()||this.f5c(Tf.HelperMethods.yf(0))};pa.onResizeEnd=()=>{Re.a.Cm()?this.ALa():(this.g7b(this.Kdb),this.$va[this.zT]=this.Qrd(this.zT));X.ULS.sendTraceTag(537014369,0,50,`Resizing of ${this.zT} TaskPane`)};G.renderTaskPaneGroups(null,
this.sFa,pa);va.AFrameworkApplication.sa.Sa.qj&&!Re.a.Cm()&&this.Lyj();return null})}g7b(G){this.f5c(this.$.isChromeRtl?G.style.left:G.style.right)}f5c(G){X.ULS.sendTraceTag(537014368,0,50,`Grid adjust is triggered for taskPane ${this.zT}`);this.$.tIj(G)}ALa(G){G=void 0===G?0:G;-1<G?Jb.Task.delay(G+this.JUe).continueWith(()=>{this.$.Agb(Oe.a.Dea("ResetContentAreaMargin"))}):this.$.Agb(Oe.a.Dea("ResetContentAreaMargin"))}KBe(G,pa,kb,Zb){pa=pa.endsWith(bg.A5d)?pa.substring(0,pa.length-bg.A5d.length):
pa;pa=this.Mhf(pa);Zb=pa+Zb;G=this.Mhf(G);Zb<G&&this.f5c(Tf.HelperMethods.yf(pa+kb))}hNj(G,pa){window.setTimeout(()=>{this.g7b(G)},pa+this.JUe)}Ikc(){return-1!==this.D5d?this.D5d:this.D5d=Ff.DOMElementExtensions.nT(Ff.DOMElementExtensions.getElementById(this.sFa,"tabStripFocusZone"))}Qrd(G){return Ff.DOMElementExtensions.nT(Ff.DOMElementExtensions.getElementById(Ff.DOMElementExtensions.getElementById(this.sFa,G+bg.A5d),bg.Qog))}Mhf(G){if(G in this.$va){const pa=this.$va[G].width;return 0<pa?pa:this.Qrd(G)}return G?
this.Qrd(G):0}T6e(){Yd.h(this.$).setFocus()}ELj(){if(this.hVb[this.zT]){const G=this.hVb[this.zT];G&&G(null,null)}else this.bJc.has(this.zT)||this.kcg()}kcg(){xd.UISurfaces.Pl().then(G=>{if(!Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&1<G.selectors.getTabbedTaskPaneCount())G.focusTabbedTaskPaneArea();else{const pa=Ff.DOMElementExtensions.zy(this.Df.querySelectorAll(Ff.DOMElementExtensions.hE));pa?pa.focus():Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8215527_InconsistentTaskPaneBorderFix")&&
1<G.selectors.getTabbedTaskPaneCount()&&G.focusTabbedTaskPaneArea()}return null})}X8f(){this.$.domElement.scrollLeft=0;Za.a.BRa&&window.requestAnimationFrame(()=>{this.$.domElement.scrollLeft=0;window.setTimeout(()=>{this.$.domElement.scrollLeft=0},0)})}get $Ic(){return this.sFa}Mbc(G,pa,kb,Zb,Lc){let Bd=G.Ja(pa);Bd||(Bd=Vf.a(Bf.a,kb,G,pa),Bd.SetScriptLoadFlavor(Lc));Zb&&Bd.Oze(Zb);const he=""+pa;let Ie=null;const ff=()=>{Bd.create();Ie()};this.tgc[he]=Ie=()=>{Bd.bUd(ff);delete this.tgc[he]};Bd.d4c(ff)}static la(G){const pa=
bg.nbh(G.He,G.isChromeRtl);bg.Q6g(G,pa);return new bg(pa,G)}static nbh(G,pa){const kb=document.createElement("div");kb.id=G+ne.a.Sog;Re.a.Cm()?kb.classList.add(W.a.urk):(kb.classList.add(pa?W.a.wrk:W.a.vrk),va.AFrameworkApplication.sa.Sa.qj&&kb.classList.add(W.a.$gb));return kb}static Q6g(G,pa){G.isMobileMode&&pa.setAttribute("aria-hidden","true");if(va.AFrameworkApplication.sa.Sa.qj){let kb;(kb=document.getElementById("FarPaneRegion"))?kb.appendChild(pa):X.ULS.shipAssertTag(509097620,11,!1,`FarPaneRegion is not found, regionComposerRoot found=${!!document.getElementById("regionComposerRoot")}`)}else document.getElementById(G.He+
ne.a.X$b).insertBefore(pa,G.hFa)}}bg.TQi=300;bg.SQi=950;bg.Jak=2;bg.A5d="-panel";bg.Qog="ExcelTaskPaneContentWrapper";Object(Fa.a)(bg,"ReactTaskPaneManager",qe.a,[417,57,5]);class gh extends pb.a{constructor(G){super();this.$=G;this.Oe()}create(){this.hyj(()=>bg.la(this.$))}static la(G){G.ia.Va(50,new gh(G))}hyj(G){G=Object(Sa.a)(this.$.ia,183,G);this.ve(G)}}Object(Fa.a)(gh,"TaskPaneManagerFactory",pb.a,[]);let xh=class extends qe.a{constructor(){super()}p7d(G,pa){X.ULS.sendTraceTag(537154185,0,50,
`ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: ${G}, TriggerType: ${pa}`);if(Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(pa){case 0:this.raiseEvent("pssort",void 0,G);break;case 1:this.raiseEvent("psfilter",void 0,G);break;case 2:this.raiseEvent("pscrttbl",void 0,G)}}};xh=Object(Ke.a)([Object(nc.d)(Oc.Hc)],xh);Object(Fa.a)(xh,"ProactiveSuggestionManager",qe.a,[287]);class Wg extends pb.a{constructor(G){super();
this.$=G;this.Oe()}create(){let G=Object(Sa.a)(this.$.ia,476,()=>new xh);this.ve(G)}static la(G){G.ia.Va(475,new Wg(G))}}Object(Fa.a)(Wg,"ProactiveSuggestionManagerFactory",pb.a,[]);var Ya=a(566),Cb=a(154);class cc{constructor(G,pa,kb){this.B2d=this.C2d=this.D2d=!1;this.R2d=!G&&!pa;this.S2d=!G&&!kb;this.R2d||this.S2d||(this.D2d=!G,this.C2d=!pa,this.B2d=!kb)}}Object(Fa.a)(cc,"RenameDisabledDialogInfo",null,[]);class Rc extends Cb.StandardDialog{constructor(G,pa,kb,Zb,Lc){super();this.S5d=[];this.Y5=
new cc(G,pa,kb);this.Pva=Zb;this.Iua=Lc;this.Rg="RenameDisabledDialog";this.ke=0;this.Ke(1,CommonUIStrings.l_DialogClose);this.NWj();this.VFj()}NWj(){this.Y5.R2d?this.cUb(this.Pva?this.Iua?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.Y5.S2d?this.cUb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.uWg();this.Eka(this.S5d)}cUb(G){Array.add(this.S5d,G)}uWg(){const G=
[];this.Y5.D2d||Array.add(G,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.Y5.C2d||Array.add(G,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.Y5.B2d||Array.add(G,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<G.length&&Array.add(this.S5d,G)}}Object(Fa.a)(Rc,"ReactRenameDisabledDialogBase",Cb.StandardDialog,[]);class gd extends Rc{constructor(G,pa,kb,Zb,Lc){super(G,pa,kb,Zb,Lc)}VFj(){this.JKb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(Fa.a)(gd,
"ReactRenameDisabledDialog",Rc,[]);var Md=a(153);class td{static get ti(){return Md.a.Gq(td.Rn,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}td.Rn="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(Fa.a)(td,"RenameDisabledDialogHtml",null,[]);class Fe extends Md.a{constructor(G,pa,kb,Zb,Lc){super();this.Y5=new cc(G,pa,kb);this.Pva=Zb;this.Iua=Lc;this.Rg="RenameDisabledDialog";this.ke=0;this.Ke(1,CommonUIStrings.l_DialogClose);this.ti=td.ti;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.h_("RenameRow")}Eeb(){if(this.Y5.R2d){let G;G=this.Pva?this.Iua?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Fe.cUb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),G)}else this.Y5.S2d?Fe.cUb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Ssi()}Ssi(){this.Y5.D2d&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.Y5.C2d&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.Y5.B2d&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static cUb(G,pa,kb){G.style.display="none";pa.innerText=kb}}Object(Fa.a)(Fe,"RenameDisabledDialog",Md.a,[]);class Se{constructor(G,pa){this.FIa=0;this.Sla=(kb,Zb,Lc,Bd,he)=>{if(1===Lc)return this.Na.qh(cb.a.renameFile,1);kb=Ua.a.Ds(this.Fba.$p);he=(0,he.getNewDocumentTitle)();he.length>this.FIa&&(he=he.substr(0,this.FIa));if(32!==this.Na.Eg(cb.a.renameFile,2,he))return this.F_(kb),8;this.F_(he);
return 32};this.Na=G;this.Fba=pa}initialize(G){if(!this.Na||!this.Fba)return!1;this.FIa=G;this.Oj();return!0}Oj(){this.Na.xe(cb.a.Sla,Ia.a.frame,this.Sla)}F_(G){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(G))}static Fpd(){return new Se(va.AFrameworkApplication.Vd,va.AFrameworkApplication.Yo)}}Object(Fa.a)(Se,"ReactRenameUIHandler",null,[461]);var gf=a(104),Hf=a(532),Ef=a(567),Lf=a(15),Wf=a(121),Sg=a(251),Ze=a(95),kh=a(39);class Eg{constructor(G,pa,kb,Zb,Lc,Bd,he,Ie,ff,qf,eg,dh){this._initialized=
!1;this._element=null;this.FIa=0;this.v_c=this.TTc=!1;this.Na=G;this.cPc=pa;this.jh=kb;this.ED=Zb;this.Fba=Lc;this.Kse=Bd;this.p3b=he;this.YPc=Ie;this.Sba=ff;this.gle=qf;this.t0a=eg;this.QUc=dh}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(G,pa,kb){if(!(this.Na&&this.Fba&&this.Kse&&this.p3b&&this.YPc&&pa)||0>=G)return!1;this._element=pa;this._element.title=kb;this._element.setAttribute(Ze.a.pg,Ze.a.xA);this._element.setAttribute("Unselectable","on");this.FIa=
G;this.Sw();return this._initialized=!0}Sw(){this.cPc&&(this.cPc.va(Lf.a.blur,this._element,Object(Gb.a)(this,this.onBlur,"onBlur")),this.cPc.va(Lf.a.paste,this._element,Object(Gb.a)(this,this.onPaste,"onPaste")));this.jh.va(Lf.a.Ne,this._element,Object(Gb.a)(this,this.onKeyDown,"onKeyDown"));this.ED.va(Lf.a.Cf,this._element,Object(Gb.a)(this,this.onPointerDown,"onPointerDown"));this.ED.va(Lf.a.tj,this._element,Object(Gb.a)(this,this.Mj,"onPointerUp"))}onBlur(){this.isActive&&!this.TTc&&(this.gle||
this.YPc(this._element),this.QNe(),this.bfd(!1));return this.TTc=!1}onPaste(){X.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(G){return this.isActive?this.$bj(G):this.acj(G)}$bj(G){let pa=!1;switch(G.Da.keyCode){case Sys.UI.Key.enter:this.QNe();this.bfd(this.t0a||this.QUc);pa=!0;break;case Sys.UI.Key.tab:this.gle&&this.YPc(this._element);break;case Sys.UI.Key.esc:this.SWd(),this.bfd(this.t0a||this.QUc),pa=!0}return pa}acj(G){let pa=!1;switch(G.Da.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Jrg(this.QUc),
this.isActive&&this.p3b(this._element),pa=!0}return pa}onPointerDown(){this.isActive||(this.Jrg(!1),this.isActive&&(this._element.focus(),this.p3b(this._element),this.v_c=!0));return!1}Mj(){return this.v_c?(this.p3b(this._element),this.v_c=!1,!0):!1}Ebb(){return 32===this.Na.qh(cb.a.renameFile,1)}QNe(){const G=Ua.a.Ds(this.Fba.$p);let pa=this._element.innerText.trim();pa.length>this.FIa&&(pa=pa.substr(0,this.FIa));pa!==G&&""!==pa?32!==this.Na.Eg(cb.a.renameFile,2,pa)?this.SWd():this.F_(pa):this.SWd()}SWd(){this.F_(Ua.a.Ds(this.Fba.$p))}F_(G){this._initialized&&
(this._element.innerText=G,this.Kse())}Jrg(G){this.Ebb()?this.isActive||(G&&(this.TTc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(Ze.a.pg,Ze.a.y6c),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,gf.a.$Xe),this.Sba&&this.Sba.execute(pa=>{pa.T0f(!0)}),G&&this._element.focus(),X.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Na.qh(cb.a.Djb,2)}bfd(G){this._element.removeAttribute("contentEditable");
this._element.setAttribute("Unselectable","on");this._element.setAttribute(Ze.a.pg,Ze.a.xA);Sys.UI.DomElement.removeCssClass(this._element,gf.a.$Xe);this.Sba&&this.Sba.execute(pa=>{pa.T0f(!1)});G&&(this._element.blur(),this._element.focus())}static hD(){Hf.a.hD(va.AFrameworkApplication.isRtl)}static Fpd(){return new Eg(va.AFrameworkApplication.Vd,Ef.a.instance,Wf.KeyInputManager.instance,Sg.a.instance,va.AFrameworkApplication.Yo,Eg.hD,kh.a.AOj,kh.a.aih,Y.a.instance.ie("Common.App.Header.HeaderEventSource"),
Za.a.Xoa,Za.a.Dj,Za.a.Zh)}}Object(Fa.a)(Eg,"RenameUIHandler",null,[461]);class th{static get instance(){return va.AFrameworkApplication.sa.Sa.zv?th.La||(th.La=Se.Fpd()):th.La||(th.La=Eg.Fpd())}}th.La=null;Object(Fa.a)(th,"RenameUIHandlerFactory",null,[]);var $h=a(147);class zh{constructor(){this.s1i=this.o1i=this.kwh=null}}Object(Fa.a)(zh,"RenameMruEntryProperties",null,[]);var Pf=a(387),eh=a(157),kg=a(668),bh;(function(G){G[G.unknown=-1]="unknown";G[G.success=0]="success";G[G.Qyk=1]="renameInvalidFileName";
G[G.Pyk=2]="renameInCoauthNotSupported";G[G.Ryk=3]="renameNotSupportedInViewMode";G[G.zyk=4]="permissionDenied";G[G.fzk=5]="serverCommunicationFailure";G[G.Uwk=6]="fileNameTooLong"})(bh||(bh={}));Object(Fa.b)("CommonOperationResult",bh);class jh{constructor(G,pa,kb,Zb,Lc,Bd,he,Ie,ff,qf,eg,dh){this.vFb=()=>th.instance.initialize(va.AFrameworkApplication.Ogc,va.AFrameworkApplication.V6a,va.AFrameworkApplication.RUd||CommonUIStrings.l_RenameFileTooltip)?32:8;this.Djb=()=>{const nh=this.sok(),Ug=this.ZSg();
X.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.zIa,Ug,nh,this.Pva);va.AFrameworkApplication.sa&&va.AFrameworkApplication.sa.Sa.Fy&&va.AFrameworkApplication.da.na("ReactRenameDisabledDialogIsEnabled")?new gd(this.zIa,!Ug,!nh,this.Pva,this.Iua()):new Fe(this.zIa,!Ug,!nh,this.Pva,this.Iua());return 32};this.renameFile=(nh,Ug,rh,oj,Vi)=>{if(1===
rh)return this.Ebb();if(!va.AFrameworkApplication.igc)return 8;if(8===this.Ebb())return this.Hl.qh(cb.a.Djb,2),8;X.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");va.AFrameworkApplication.igc(Vi,Object(Gb.a)(this,this.RMb,"onRenameFileSuccess"),this.Qej);va.AFrameworkApplication.LFj=!0;return 32};this.Qej=nh=>{const Ug=new Cb.StandardDialog;Ug.ke=0;switch(nh){case 1:X.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Ug.osa(CommonUIStrings.l_RenameFileInvalidNameTitle,
CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:X.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Ug.osa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:X.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:nh}),Ug.osa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}va.AFrameworkApplication.xN().execute(rh=>{rh.sendMessage(eh.a.gUh,{["FailureMessage"]:bh[nh]})});
this.J9f()};this.Qxj=(nh,Ug,rh)=>{if(1===rh)return this.Ebb();if(!va.AFrameworkApplication.SNa)return 8;va.AFrameworkApplication.SNa(Object(Gb.a)(this,this.Axc,"onRefreshFilenameSuccess"),Object(Gb.a)(this,this.zxc,"onRefreshFilenameFailure"),!1);return 32};this.Xuc=(nh,Ug,rh,oj,Vi)=>{if(1===rh)return va.AFrameworkApplication.da.na("UiHostSupportsMoveToFolder")?this.Ebb():8;if(2===rh){if(!va.AFrameworkApplication.Icg)return uf.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",
!1,!1,null),8;if(!Vi)return uf.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Vi[Pf.a.lEi])if(Vi[Pf.a.Cwg])if(nh=Vi[Pf.a.Cwg].toLowerCase(),Ug=va.AFrameworkApplication.da.na("UiHostSupportsDocRebootFeatures"),rh=va.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Ug&&va.AFrameworkApplication.Dfa&&rh){const zj={};zj[Pf.a.$Ua]="1";zj[Pf.a.documentUrl]=nh;zj[Pf.a.reason]=kg.a.saveAs;uf.Health.instance.recordKpiSuccess("MoveToFolder",
null);va.AFrameworkApplication.xN().execute(cj=>{cj.sendMessage(eh.a.S1,zj)})}else if(!va.AFrameworkApplication.Dfa&&rh)uf.Health.instance.recordKpiSuccess("MoveToFolder",null),kh.a.rh(nh,kh.a.aW(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return uf.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else uf.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else va.AFrameworkApplication.SNa(Object(Gb.a)(this,this.Axc,"onRefreshFilenameSuccess"),
Object(Gb.a)(this,this.zxc,"onRefreshFilenameFailure"),!1),va.AFrameworkApplication.Icg(),uf.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32};this.ule=G;this.Na=pa;this.hQc=kb;this.Wy=Zb;this.zIa=Lc;this.ZSg=Bd;this.Pva=he;this.Nve=Ie;this.sPg=ff;this.Iua=qf;this.Qa=eg;this.rPg=dh}Oj(){va.AFrameworkApplication.sa&&va.AFrameworkApplication.sa.Sa.zv||this.Hl.xe(cb.a.vFb,Ia.a.frame,this.vFb);this.Hl.xe(cb.a.Djb,Ia.a.frame,this.Djb);this.Hl.xe(cb.a.renameFile,Ia.a.frame,this.renameFile);
this.Hl.uh(cb.a.Pgc,Ia.a.frame,this.Qxj,64);this.Hl.uh(cb.a.Xuc,Ia.a.frame,this.Xuc,64);this.Hl.xe(cb.a.aTa,Ia.a.frame,Object(Gb.a)(this,this.aTa,"moveToFolder"));(va.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||va.AFrameworkApplication.sa&&(va.AFrameworkApplication.da.na("PostMessageEmbedded")||va.AFrameworkApplication.da.na("IsJsApi"))&&va.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&va.AFrameworkApplication.xN().execute(G=>{G.yn(eh.a.RGf);G.tm(eh.a.RGf,jh.Bwj);G.yn(eh.a.Ckd);G.tm(eh.a.Ckd,jh.zwj)})}Ebb(){return 0===this.rPg.eff()?32:8}sok(){return this.iC?this.Pva?this.iC.YWe:this.iC.LBb:!0}RMb(G,pa){G?0!==G.OperationResult?this.gjf(G.OperationResult):(this.PPj(pa,G.NewName),this.Gjk(G,Object(Gb.a)(va.AFrameworkApplication.sa.Sa,va.AFrameworkApplication.sa.Sa.Gvg,"updateOpenInClientDocumentUrl")),va.AFrameworkApplication.da.na("DocumentNameInJewelInfoMenuIsEnabled")&&va.AFrameworkApplication.sa.Sv(),
this.sPg.cug()):this.gjf(5)}PPj(G,pa){const kb={};kb[Pf.a.hUh]=pa;G.sendMessage(eh.a.Ckd,kb)}Gjk(G,pa){this.Tjk(G);va.AFrameworkApplication.Kdc=G.DirectInvokeDavUrl;pa=pa(G.EditDocInClientUrl);const kb=new zh;kb.s1i=this.Wy.$p;kb.kwh=pa;kb.o1i=G.EditDocInClientUrl;this.Hl.Eg(cb.a.renameMostRecentlyUsedFileEntry,2,kb)}gjf(G){switch(G){case 1:G=new Cb.StandardDialog,G.ke=0,G.JV(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.J9f()}}Tjk(G){this.Wy.$p=jh.m4g(this.Wy.$p,
G.NewName);G.BreadcrumbFolderName&&(this.Wy.breadcrumbFolderName=G.BreadcrumbFolderName);G.BreadcrumbFolderUrl&&(this.Wy.breadcrumbFolderUrl=G.BreadcrumbFolderUrl);this.Nve(G.NewName)}aTa(G,pa,kb,Zb,Lc){if(1===kb)return va.AFrameworkApplication.da.na("UiHostSupportsMoveToFolder")?32:8;if(2===kb){const Bd={};G=va.AFrameworkApplication.Dfa;pa=va.AFrameworkApplication.da.na("UiHostSupportsDocRebootFeatures");G=(!G||G&&pa)&&va.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",
!1);Bd[Pf.a.l$j]=G;Lc&&Lc.MoveButtonClickedTime&&(Bd[Pf.a.O_i]=Lc.MoveButtonClickedTime.getTime());va.AFrameworkApplication.xN().execute(he=>{he.sendMessage(eh.a.aTa,Bd)});if(Lc&&Lc.MoveButtonClickedTime){if(G=$h.a.mu())Lc=(new Date).getTime()-Lc.MoveButtonClickedTime.getTime(),G.set("MovePostDuration",Lc.toString());uf.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",G)}return 32}return 8}B1j(G,pa){return G&&pa?G!==this.Wy.breadcrumbFolderName||pa!==this.Wy.breadcrumbFolderUrl:!1}Axc(G,
pa){G&&(G.NewName!==Ua.a.Ds(this.Wy.$p)||this.B1j(G.BreadcrumbFolderName,G.BreadcrumbFolderUrl))&&this.RMb(G,pa)}zxc(){}J9f(){this.Nve(Ua.a.Ds(this.Wy.$p))}get Hl(){return this.Na.value}get iC(){return this.hQc.value}static get instance(){return jh.La||(jh.La=jh.ona())}static ona(){return new jh(va.AFrameworkApplication.Fbb,new Ya.a(()=>va.AFrameworkApplication.Vd),new Ya.a(()=>va.AFrameworkApplication.iC),va.AFrameworkApplication.Yo,va.AFrameworkApplication.limitedEdit,()=>va.AFrameworkApplication.userCanRename,
va.AFrameworkApplication.qCc,Object(Gb.a)(th.instance,th.instance.F_,"updateTitle"),Y.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>va.AFrameworkApplication.isReadOnlyRecommended,va.AFrameworkApplication.da,Y.a.instance.resolve("Common.IRenameProps"))}static m4g(G,pa){G=Ua.a.A8(G);return pa+G}static Bwj(G){const pa=G.Values[Pf.a.uIi];X.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",pa);pa?va.AFrameworkApplication.Vd.Eg(cb.a.Xuc,2,G.Values):uf.Health.instance.recordKpiFailure("MoveToFolder",
"MoveToFolder Server Failure",!1,!1,null)}static zwj(G){va.AFrameworkApplication.Vd.Eg(cb.a.renameFile,2,G.Values.NewName)}}jh.La=null;Object(Fa.a)(jh,"RenameActor",null,[]);a(581);class Ih{}Object(Fa.a)(Ih,"ActivityEventName",null,[]);class Oh{}Oh.compatMode="CompatMode";Object(Fa.a)(Oh,"ActivityEventReason",null,[]);var Rh=a(666);class Jh{constructor(G,pa){this.Na=G;this.C_a=pa}Oj(){this.Na.xe(cb.a.Akg,Ia.a.frame,Object(Gb.a)(this,this.p4j,"showRenameDialogAction"))}p4j(G,pa,kb){G=32;if(1===kb)return Rh.SessionStatusManager.instance.n$a||
va.AFrameworkApplication.q9?8:32;2===kb&&(32!==this.Na.qh(cb.a.renameFile,1)?(this.Na.qh(cb.a.Djb,2),G=8):32===this.Na.qh(cb.a.bUb,1)?this.Na.qh(cb.a.bUb,2):this.C_a.value.create().NGc());return G}}Object(Fa.a)(Jh,"RenameDialogActor",null,[513]);class vg{constructor(G,pa,kb){this.dialog=null;this.Na=G;this.Wy=pa;this.tua=kb}Ofi(){const G={};G.nameInputProps={["type"]:"AppInputProps",["id"]:vg.U6a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:Ua.a.Ds(this.Wy.$p),["maxLength"]:this.tua};return G}NGc(){const G=
{["id"]:"RenameDialog",["bodyControls"]:this.Ofi()};this.dialog=new Md.a(!1,!1,!0);this.dialog.ke=1;this.dialog.Rg="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(Gb.a)(this,this.PUd,"renameDialogHandler"),G)}PUd(G,pa){pa&&1===G&&pa[vg.U6a]&&(G=Ua.a.Ds(this.Wy.$p),pa=(pa[vg.U6a]||"").trim(),pa!==G&&""!==pa&&this.Na.Eg(cb.a.renameFile,2,pa))}}vg.U6a="txtDocumentName";Object(Fa.a)(vg,"ReactRenameDialog",null,[536]);class Og{static get ti(){return Md.a.Gq(Og.Rn,
CommonUIStrings.l_RenameDialogLabel)}}Og.Rn="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(Fa.a)(Og,"RenameDialogHtml",null,[]);class wg extends Md.a{constructor(G,pa,kb){super();this.Na=G;this.Wy=pa;this.tua=kb;this.Rg="RenameDialog";this.ti=Og.ti}NGc(){var G={["txtDocumentName"]:Ua.a.Ds(this.Wy.$p)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,
Object(Gb.a)(this,this.PUd,"renameDialogHandler"),G);G=document.getElementById(wg.U6a);0<this.tua&&(G.maxLength=this.tua);G.focus()}PUd(G,pa){1===G&&(G=Ua.a.Ds(this.Wy.$p),pa=(pa[wg.U6a]||"").trim(),pa!==G&&""!==pa&&this.Na.Eg(cb.a.renameFile,2,pa))}}wg.U6a="txtDocumentName";Object(Fa.a)(wg,"RenameDialog",Md.a,[536]);class cg{constructor(G){this.Fba=null;this.tua=0;this.Na=G;this._initialized=!1}initialize(G,pa){this.Fba=G;this.tua=pa;this._initialized=!0}create(){return this._initialized?va.AFrameworkApplication.sa&&
va.AFrameworkApplication.sa.Sa.Fy&&va.AFrameworkApplication.da.na("ReactRenameDialogIsEnabled")?new vg(this.Na,this.Fba,this.tua):new wg(this.Na,this.Fba,this.tua):null}}Object(Fa.a)(cg,"RenameDialogFactory",null,[512]);var Pg=a(107),sh=a(114),ji=a(110);class $f{constructor(G,pa){this.Na=G;this.nf=pa}Oj(){this.Na.xe(cb.a.bUb,Ia.a.frame,Object(Gb.a)(this,this.q4j,"showRenameFlyoutAction"))}heh(){return yb.d("setDocumentTitleFlyoutOpened")&&va.AFrameworkApplication.sa.Sa.zv}q4j(G,pa,kb){if(1===kb)return this.heh()?
32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}GXg(){$f.GLi&&va.AFrameworkApplication.kRa&&ji.a.instance.Xh(new sh.a(5,1,5E3,()=>{32===this.Na.qh(cb.a.bUb,1)&&this.nf&&this.nf.Lk.name===qb.AFrame.Q7&&(Pg.a("RenameFloatieShownOnNewDocumentLoad",!0),this.Na.qh(cb.a.bUb,2))}))}static get GLi(){$f.K0b&&null!=$f.K0b||(va.AFrameworkApplication.PN("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),$f.K0b=va.AFrameworkApplication.da?va.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",
!1):!1);return $f.K0b}}$f.K0b=null;Object(Fa.a)($f,"RenameFlyoutActor",null,[511]);class Aa{constructor(G,pa,kb,Zb,Lc){this.hQc=Lc;this.vle=kb;this.ule=Zb;this.cTg=G;this.Iua=pa}get iC(){return this.hQc.value}eff(){if(!this.ule())return 5;if(this.Iua())return 1;if(this.iC){if(this.vle&&!this.iC.YWe)return 3;if(!this.vle&&!this.iC.LBb)return 4}return this.cTg()?0:2}}Object(Fa.a)(Aa,"RenameProps",null,[510]);var zb=a(108);class sc{constructor(G,pa,kb,Zb,Lc,Bd){this.$y=!1;this.jWc=new zb.a;this.J_a=
pa;this.dP=kb;this.XGg=Zb;this.Qa=Lc;this.vue=Bd}enable(){this.$y||(this.cug(),this.j4d(),this.$y=!0)}generateKey(G,pa,kb){return String.format("{0}/{1}/{2}",kb,G,pa)}qai(){const G=Ua.a.Ds(this.J_a().$p);return this.generateKey(this.J_a().breadcrumbFolderName,this.J_a().breadcrumbFolderUrl,G)}rai(G,pa,kb){return G&&pa?this.generateKey(G,pa,kb):kb}RAh(G,pa,kb){return G&&G!==this.J_a().breadcrumbFolderName||pa&&pa!==this.J_a().breadcrumbFolderUrl?!0:kb!==Ua.a.Ds(this.J_a().$p)}cug(){const G=this.qai();
this.jWc.fa(G,new Date)}nOd(G){this.U_j(G)&&this.Wwe(G)}U_j(G){const pa=this.XGg();return pa?this.vue&&this.vue.YGb||!pa.isf||!va.AFrameworkApplication.SNa?(this.bng(G),this.$y=!1):!0:!1}LTf(G,pa,kb,Zb){const Lc=this.RAh(G,pa,kb),Bd=this.rai(G,pa,kb);G=(()=>this.jWc.Jf(Bd))().returnValue;Lc&&!G&&(this.hjf(Zb),X.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.hFd));Lc||this.jWc.fa(Bd,this.dP())}}Object(Fa.a)(sc,"ARenamedFileChecker",null,[418]);class Pc extends sc{constructor(G,
pa,kb,Zb,Lc,Bd,he,Ie){super(G,pa,kb,Zb,Lc,Bd);this.Ujf=(ff,qf)=>{qf&&qf.sLb&&qf.h4i&&(qf.Pbb("BreadcrumbDocName")||qf.Pbb("BreadcrumbFolderName")||qf.Pbb("BreadcrumbFolderUrl")||qf.Pbb("DirectInvokeDAVUrl")||qf.Pbb("EditDocInClientUrl"))&&(X.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.hFd),this.nOd(qf))};this.Bre=Lc;this.qPg=he;this.GKg=Ie}get hFd(){return"RenamedFileCheckerUsingSettingsRefresh"}j4d(){this.Bre.y4c(this.Ujf)}bng(){this.Bre.u6f(this.Ujf)}Wwe(G){if(G&&G.sLb){const pa=
G.sLb;this.LTf(pa.Ra("BreadcrumbFolderName"),pa.Ra("BreadcrumbFolderUrl"),pa.Ra("BreadcrumbDocName"),G)}}hjf(G){const pa={OperationResult:0,classId:1};G=G.sLb;pa.BreadcrumbFolderName=G.Ra("BreadcrumbFolderName");pa.BreadcrumbFolderUrl=G.Ra("BreadcrumbFolderUrl");pa.DirectInvokeDavUrl=G.Ra("DirectInvokeDAVUrl");pa.EditDocInClientUrl=G.Ra("EditDocInClientUrl");G=G.Ra("BreadcrumbDocName");pa.NewName=va.AFrameworkApplication.eya?G:Ua.a.Ds(G);this.GKg.execute(kb=>{this.jBi(pa,kb)})}jBi(G,pa){this.qPg().RMb(G,
pa)}}Object(Fa.a)(Pc,"RenamedFileCheckerUsingSettingsRefresh",sc,[]);class kd extends sc{constructor(G,pa,kb,Zb,Lc,Bd,he,Ie,ff,qf){super(G,kb,Zb,Lc,Bd,ff);this.Xqb=this.X4b=null;this.yOg=pa;this.Na=he;this.Bg=Ie;qf&&qf.execute(eg=>{this.qAj(eg)})}get hFd(){return"RenamedFileCheckerUsingTask"}qAj(G){this.X4b=G;this.X4b.XAe(Object(Gb.a)(this,this.SDb,"handleVisibilityChange"))}SDb(G,pa){!this.$y||0!==pa.newState&&1!==pa.newState||this.Xqb||(this.j4d(),this.nOd(this.Xqb))}j4d(){this.Xqb=new sh.a(3,2,
this.yOg(),Object(Gb.a)(this,this.nOd,"performRenameFileCheckTick"),89);this.Bg.Xh(this.Xqb)}bng(G){this.Bg.Rr(G)}Wwe(G){this.X4b&&2===this.X4b.Qvk?this.uBj(G):va.AFrameworkApplication.SNa(Object(Gb.a)(this,this.Axc,"onRefreshFilenameSuccess"),Object(Gb.a)(this,this.zxc,"onRefreshFilenameFailure"),!0)}uBj(G){this.Bg.Rr(G);this.Xqb=null}Axc(G){G&&this.LTf(G.BreadcrumbFolderName,G.BreadcrumbFolderUrl,G.NewName,null)}hjf(){this.Na.qh(cb.a.Pgc,2)}zxc(){}}Object(Fa.a)(kd,"RenamedFileCheckerUsingTask",
sc,[]);class ja{constructor(){this.Qa=this.Fd=null;this.xE=()=>{const G=va.AFrameworkApplication.sa.Sa.zv;va.AFrameworkApplication.Fbb()&&th.instance.initialize(va.AFrameworkApplication.Ogc,G?null:va.AFrameworkApplication.V6a,G?null:va.AFrameworkApplication.RUd||CommonUIStrings.l_RenameFileTooltip)&&(this.Fd.register(Aa,"Common.App.Rename.RenameProps").as("Common.IRenameProps").$e(()=>new Aa(()=>va.AFrameworkApplication.userCanRename,()=>va.AFrameworkApplication.isReadOnlyRecommended,va.AFrameworkApplication.qCc,
va.AFrameworkApplication.Fbb,new Ya.a(()=>va.AFrameworkApplication.iC))).Ve(),jh.instance.Oj(),this.Qa.na("RenameDialogIsEnabled")&&(this.Fd.resolve("Common.App.Rename.RenameDialogFactory").initialize(va.AFrameworkApplication.Yo,va.AFrameworkApplication.Ogc),this.Fd.resolve("Common.App.Rename.IRenameDialogActor").Oj()),this.Fd.resolve("Common.App.Rename.IRenameFlyoutActor").Oj(),va.AFrameworkApplication.qCc&&this.Fd.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Fd.resolve("Common.App.Rename.IRenameFlyoutActor").GXg())}}get name(){return"Common.App.RenameFile"}nk(G){this.Fd=
G;this.Qa=va.AFrameworkApplication.da;this.Fd.register(Jh,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").$e(()=>new Jh(va.AFrameworkApplication.Vd,this.Fd.KWd("Common.App.Rename.IRenameDialogFactory"))).Ve();this.Fd.register(cg,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").$e(()=>new cg(va.AFrameworkApplication.Vd)).Ve();this.Fd.register(418,"Common.App.Rename.IRenamedFileChecker").$e(()=>this.duh()).Ve();this.Fd.register($f,
"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").$e(()=>new $f(va.AFrameworkApplication.Vd,Mb.FocusManager.instance())).Ve()}duh(){if(this.Qa.na("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const G=this.Fd.Ii("Common.IRefreshableAppSettings");if(G&&G.mvf)return new Pc(()=>G.eg("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>va.AFrameworkApplication.Yo,()=>new Date,()=>va.AFrameworkApplication.iC,G,this.Fd.Ii("Common.ISessionStatus"),()=>jh.instance,this.Fd.ie("Postmessage.IHostPostmessenger"))}return new kd(()=>
this.Qa.eg("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.Qa.eg("RenamedFileCheckerPingIntervalInMs",12E4),()=>va.AFrameworkApplication.Yo,()=>new Date,()=>va.AFrameworkApplication.iC,va.AFrameworkApplication.da,va.AFrameworkApplication.Vd,va.AFrameworkApplication.Pj,this.Fd.Ii("Common.ISessionStatus"),this.Fd.ie("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.Qa.Jw(this.xE)}dispose(){}}Object(Fa.a)(ja,"PackageManager",null,[3,4]);var ia=a(239),dc=a(393),od=a(383),ae=a(202),
Pe=a(234);class Xe{constructor(G){this.$=G}get isf(){return this.$.workbookContext.FileCoauthorable}get YGb(){return!1}get LBb(){return this.$.ea.N6}get YWe(){if(this.LBb)return!0;for(const G of this.$.ea.gp)if(!G.SupportsRename)return!1;return!0}}Object(Fa.a)(Xe,"EwaCoauthManager",null,[441]);class vf extends fd.a{constructor(G,pa){super();this.fha=this.QUd=this.O6f=this.jfd=null;this.Pea=()=>{var kb=this.$.ea.Kp;if(kb&&kb.WorkbookFileName){var Zb=Ua.a.Ds(kb.WorkbookFileName),Lc=!!tc.a.compare(this.$.workbookContext.WorkbookFileName,
kb.WorkbookFileName,!1),Bd=Vb.EwaSettings.Fa(465)&&!!kb.BreadcrumbFolderUrl&&!!tc.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,kb.BreadcrumbFolderUrl,!1);if(Lc||Bd)this.fha={},this.fha.NewFileName=Zb,this.fha.EditDocInClientUrl=kb.EditDocInClientUrl,this.fha.DirectInvokeDAVUrl=kb.DirectInvokeDAVUrl,this.fha.DownloadACopyUrl=kb.DownloadACopyUrl,Vb.EwaSettings.Fa(465)&&kb.BreadcrumbFolderUrl&&(this.fha.BreadcrumbFolderName=kb.BreadcrumbFolderName,this.fha.BreadcrumbFolderUrl=
kb.BreadcrumbFolderUrl),kb=va.AFrameworkApplication.Vd.Eg(cb.a.Pgc,2,Zb),this.fha=null,X.ULS.shipAssertTag(537154064,0,32===kb,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};this.N8i=(kb,Zb,Lc)=>{this.O6f=Zb;this.QUd=Lc;this.$.Ga.Sd(new Hb.a(1897077126,Te.a.Td,2,3,null),{["newFileName"]:kb})};this.M8i=kb=>{this.fha&&kb(this.fff(this.fha),this.Kq)};this.RMb=kb=>{Pe.a(kb)||!kb.Result?(kb=vf.s0h(kb),Pb.a(this.$).Pf.wP([-414480287,650565124,-782844485,1223808266,-62451516,
1636785843]),this.QUd(kb)):this.O6f(this.fff(kb.Result),this.Kq)};this.Pej=()=>{this.QUd(5)};this.$=G;this.Kq=pa;this.$.ea.kx(this.Pea)}initialize(){va.AFrameworkApplication.igc=this.N8i;va.AFrameworkApplication.SNa=this.M8i;this.jfd=va.AFrameworkApplication.iC;va.AFrameworkApplication.iC=new Xe(this.$)}dispose(){va.AFrameworkApplication.igc=null;va.AFrameworkApplication.SNa=null;this.$.ea.Ky(this.Pea);va.AFrameworkApplication.iC=this.jfd;this.$=this.jfd=null;super.dispose()}renameFile(G,pa){const kb=
G.newFileName;if(kb&&(G=Ua.a.Ds(this.$.workbookContext.WorkbookFileName),tc.a.compare(G,kb,!1))){const Zb=this.$.qa.ua.ze();od.a(this.$.userOperationManager,(Lc,Bd,he)=>{var Ie=this.$.qa.ua;Lc=$d.b(Lc,this.RMb);Bd=$d.a(Bd,this.Pej);const ff=Ie.Pa(9,Zb);ff.newFileName=kb;return Ob.g(Ie,"RenameFile",ff,Lc,Bd,he,null,0)},Lc=>new ae.a(134,0,Lc),pa)}}RDi(){return 32===va.AFrameworkApplication.Vd.qh(cb.a.Sla,1)}fff(G){var pa=this.$.workbookContext;va.AFrameworkApplication.T1=G.DownloadACopyUrl;const kb=
Vb.EwaSettings.Fa(465)&&!!G.BreadcrumbFolderUrl;kb&&(va.AFrameworkApplication.Yo.breadcrumbFolderName=G.BreadcrumbFolderName,va.AFrameworkApplication.Yo.breadcrumbFolderUrl=G.BreadcrumbFolderUrl,pa.FullDocumentInfo.BreadcrumbFolderUrl=G.BreadcrumbFolderUrl,pa.FullDocumentInfo.BreadcrumbFolderName=G.BreadcrumbFolderName);pa.FullDocumentInfo.BreadcrumbDocName=G.NewFileName;dc.d(pa,G.NewFileName);pa={};pa.NewName=G.NewFileName;pa.DirectInvokeDavUrl=G.DirectInvokeDAVUrl;pa.EditDocInClientUrl=G.EditDocInClientUrl;
kb&&(pa.BreadcrumbFolderName=G.BreadcrumbFolderName,pa.BreadcrumbFolderUrl=G.BreadcrumbFolderUrl);pa.OperationResult=0;return pa}static s0h(G){switch(G.Errors[0].MessageId){case -414480287:G=2;break;case 650565124:G=1;break;case 1636785843:G=6;break;case -782844485:G=4;break;default:G=5}return G}}Object(Fa.a)(vf,"RenameFileManager",fd.a,[416,5]);class Sf extends pb.a{constructor(G){super();this.zxa=this.renameFileManager=null;this.$=G;this.Oe()}create(){if(!this.zxa){const G=ia.a.c6a(Rb.b(),this.ma,
"Task","IRenameFileManager");this.zxa=G.task;const pa=Fc.GetServiceTaskFactory.create(this.$.ia,137,this.ma,this.$a),kb=Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(Qb.d)(nc.a.resolve(Oc.E,{Oa:this.$a})):Fc.GetServiceTaskFactory.create(this.$.ia,155,this.ma,this.$a);Ec.TaskExtensions.Aa(Ec.TaskExtensions.Tg([kb,pa],this.ma),()=>{const Zb=new vf(this.$,pa.result);this.$.ia.Va(120,Zb);G.setResult(Zb)},this.ma,3)}this.zxa.continueWith(G=>{this.ve(G.result)})}dispose(){nf.a.Ma(this.renameFileManager);
this.$=this.renameFileManager=null;super.dispose()}static la(G){G.ia.Va(119,new Sf(G))}}Object(Fa.a)(Sf,"RenameFileManagerServiceFactory",pb.a,[]);var xf=a(43),Jg=a(558),yg=a(51),Xf=a(182),Lg=a(73),lg=a(145),Kf=a(113),Dh=a(319),hh=a(146),Da=a(386);class Lb{constructor(G){this.$$a=this.knc=0;this.k$b=null;this.ssf=!1;this.$=G;this.ssf=G.Frc}AGi(){return Yd.h(this.$).Kd?(X.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.Rd.uB?
(X.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}W9i(G){this.k$b=new Sys.UI.Point(Math.round(G.dza.center.x),Math.round(G.dza.center.y));this.knc=xf.a(this.$).zoom;this.$$a=G.dza.scale;let pa={["InitialZoom"]:this.knc,["Location"]:"canvas",["InputMethod"]:G.de};hh.b(this.$).Lf(lg.a.Imj,pa);X.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.k$b.x},${this.k$b.y}), initial zoom ${this.knc}, initial scale ${this.$$a}`);
this.xdb(G,"onGestureStart");return!0}V9i(G){if(!this.$$a)return X.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.xdb(G,"OnGestureEvent"),!0;if(!isFinite(this.$$a))return X.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.$$a}`),this.xdb(G,"OnGestureEvent"),!0;const pa=G.dza.scale/this.$$a*this.knc;xf.a(this.$).Jzg(pa,this.k$b);X.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${pa}. Current scale ${G.dza.scale}`);this.xdb(G,"OnGestureEvent");return!0}U9i(G){xf.a(this.$).Kzg();X.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.xdb(G,"OnGestureEnd")}T9i(G){X.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.xdb(G,"OnGestureCancel")}xdb(G,pa){var kb,Zb,Lc;this.ssf&&(X.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${pa},        eventArgs non-null: ${isNullOrUndefined(G)}, gestureData non-null: ${isNullOrUndefined(null===
G||void 0===G?void 0:G.dza)},        srcEvent non-null: ${isNullOrUndefined(null===(kb=null===G||void 0===G?void 0:G.dza)||void 0===kb?void 0:kb.srcEvent)}`),null===(Lc=null===(Zb=null===G||void 0===G?void 0:G.dza)||void 0===Zb?void 0:Zb.srcEvent)||void 0===Lc?void 0:Lc.preventDefault())}}Object(Fa.a)(Lb,"PinchToZoomAdapter",null,[301]);class rc extends qe.a{constructor(){super()}sBe(G){this.addHandler("ZCIEK",G)}N6f(G){this.removeHandler("ZCIEK",G)}V4c(G){this.addHandler("ZCUIK",G)}OUd(G){this.removeHandler("ZCUIK",
G)}Juj(){this.raiseEvent("ZCIEK")}Iuj(){this.raiseEvent("ZCUIK")}Kuj(){this.raiseEvent("ZCEK")}}Object(Fa.a)(rc,"ZoomEventManager",qe.a,[299]);var zc=a(90);class zd extends qe.a{constructor(G){super();this.statusBarManager=null;this.K7e=!1;this.$=G;this.$.ia.Od(29,pa=>{this.statusBarManager=pa;pa.BM(this)})}yt(G){this.addHandler("Zoom",G)}Ut(G){this.removeHandler("Zoom",G)}LC(){this.mq("QueryZoomStatus")&&this.raiseEvent("Zoom")}ov(G,pa){return"QueryZoomStatus"!==G?!1:this.vpi(pa)}mq(){return xf.a(this.$).bW()}dispose(){this.statusBarManager&&
(this.statusBarManager.WI(this),this.statusBarManager=null);this.$=null;super.dispose()}Qhf(G){G=this.yli(G);if(!G)return null;G=G.getElementsByClassName("cui-ctl-mediumlabel");return 1!==G.length?(X.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):G[0]}vpi(G){if(!this.$)return!1;const pa=xf.a(this.$).LXb;let kb=!1;if(Re.a.mo())tc.a.equals(appChrome.selectors.getControlLabel(zc.a.zoomStatusBarMenuOpen),pa,!1)||(kb=!0);else{const Zb=this.Qhf("HandleQueryZoomStatusCommand");
Zb?tc.a.equals(G.LabelText.toString(),pa,!1)||(Zb.innerText="",kb=!0):kb=!0}kb&&this.rUj(G,pa);return!0}rUj(G,pa){G.LabelText=pa;Re.a.mo()&&(G.Visible=!0)}yli(G){var pa=Ff.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!pa)return pa=(pa=this.$.ea.Je)?pa.inEmbedView:!1,Za.a.Xr||pa||X.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${G}`),null;this.K7e||(this.K7e=!0,X.ULS.sendTraceTag(537149762,
0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${G}`));return pa}}Object(Fa.a)(zd,"ZoomStatusBarManager",qe.a,[5,298,173]);let Wd=class extends Jg.a{constructor(G){super(G);this.zoomEventManager=this.EBa=this.ZIb=null;this.fJb=-1;this.qsf=!1;this.Qf=()=>{this.fJb=-1};X.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.Wlb=new zd(G);this.Jmj()&&(X.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),this.A6g());
this.uAj()}dispose(){this.Wlb&&(nf.a.Ma(this.Wlb),this.Wlb=null);this.zoomEventManager&&(this.$.ia.K1(419),this.zoomEventManager=null);this.qsf&&this.lAh();super.dispose()}bW(){return!0}Jzg(G,pa){G=this.fOa(G);if(Yd.h(this.$).rtl){const kb=Math.round(Ff.DOMElementExtensions.getBounds(this.$.Yh).width*xf.a(this.$).zoom);this.ZIb=new Sys.UI.Point(kb-pa.x,pa.y)}else this.ZIb=pa;this.WWa(G,!1,"ZoomWithPinch")}eNc(){return!0}dNc(G,pa){var kb=Za.a.isMac?.07:.15;G=this.zoom+(G?kb:-kb);G=this.fOa(G);Yd.h(this.$).rtl?
(kb=Math.round(Ff.DOMElementExtensions.getBounds(this.$.Yh).width*xf.a(this.$).zoom),this.EBa=new Sys.UI.Point(kb-pa.x,pa.y)):this.EBa=pa;pa=this.zoom;this.WWa(G,!0,"ZoomWithMouse");pa={["InitialZoom"]:pa,["FinalZoom"]:G,["Location"]:"canvas"};hh.b(this.$).Lf(lg.a.xtk,pa)}Kzg(){this.ZIb=null}fNc(G,pa){this.WWa(this.fOa(G),!1,pa?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}Lzg(G){isNaN(G)?X.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):
this.WWa(this.fOa(G),!1,"ZoomToLevelInExcelLive")}gNc(G,pa){this.WWa(this.fOa(G),!0,pa?"ZoomWithShortcuts":"ZoomWithButtons")}Hff(G,pa){const kb=Yd.h(this.$).rtl,[Zb,Lc]=this.xqd(kb),[Bd,he]=this.psd(G,Lc);return this.EBa?(G=this.dqd(this.EBa,G,pa,Lc,Zb,"ZoomWithMouse"),this.EBa=null,G):this.ZIb?this.dqd(this.ZIb,G,pa,Lc,Zb,"ZoomWithPinch"):Yd.h(this.$).ga.Ta.isFloatingObjectSelected?this.wtk(G,pa,Lc,Zb,Bd,he,Yd.h(this.$).rtl):this.ytk(G,pa,Lc,Zb,Bd,he,Yd.h(this.$).rtl)}Ubg(G,pa,kb){if(G){X.ULS.sendTraceTag(537149782,
0,50,`Zoom To: (${G.x} ${G.y}) (new top-left) from zoom:${pa} to zoom:${kb}`);G=new yg.a(G.x,G.y);kb=Yd.h(this.$).rtl;[,kb]=this.xqd(kb);const [Zb,Lc]=this.psd(pa,kb);Yd.h(this.$).XBe(G,Zb,Lc,"ApplicationZoom")}else X.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${pa} to zoom:${kb}`)}zoomFitToScreen(){const G=this.zoom;var pa=Yd.h(this.$).rtl;const [kb,Zb]=this.xqd(pa),[Lc,Bd]=this.psd(G,Zb);var he=Yd.h(this.$).ga.Ta.isFloatingObjectSelected;(pa=he?this.mbf(this.jfb,Lc,Bd,!1):this.Pff(this.jfb,
Zb,kb,Lc,Bd,pa,!1))?(pa=Math.min(Lc/(pa.width+100),Bd/(pa.height+100)),pa=this.GWh(pa),this.WWa(pa,!0,"ZoomWithFitToScreen"),he?Yd.h(this.$).ga.Ta.QLa(Yd.h(this.$).ga.Ta.Fe,!1):(he=fe.v(Yd.h(this.$).ga.ra.activeRange,this.$),Yd.h(this.$).Wj(he,null,null,null,3,"ZoomManager.ZoomFitToScreen")),this.fJb=G,this.qsf||this.u6g()):X.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${he}`)}zoomFitToScreenUndo(){this.WWa(this.fJb,!1,"ZoomWithFitToScreen")}S1d(){return-1!==
this.fJb}u6g(){const G=Yd.h(this.$);G&&(G.ga.Kr(this.Qf),G.tH(this.Qf))}lAh(){const G=Yd.h(this.$);G&&(G.ga.es(this.Qf),G.XI(this.Qf))}GWh(G){G=Math.min(G,id.a.kZi);G=Math.max(G,id.a.a_i);return Math.round(100*G)/100}WWa(G,pa,kb){if(this.bNc()){var Zb=Yd.h(this.$).view.visibleArea.toString();G=this.fOa(G);var Lc=Lg.d(this.$.ta.pa);Lc||(Lc=Jg.a.jIf);Yd.h(this.$).Vi.T4(5,Dh.a.aNc,kb);Yd.h(this.$).Vi.bga(Dh.a.aNc,this.$.ea.Mg);X.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${G} to sheet ${Lc} origin ${kb} prevZoom ${this.zoom}`);
this.mXj(Lc,G);this.zoomEventManager.Kuj();this.jfk(kb);this.vfk(pa);this.fJb=-1;Da.b(this.$,kb);G=Yd.h(this.$).view.visibleArea.toString();X.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${Zb}, NewGridVisibleArea: ${G}, IsShyRibbonActive: ${this.$.EU}`)}}n5h(G){return(G=Tf.HelperMethods.fG(this.$.Yh,this.$.domElement,G))?G:new Sys.UI.Point(0,0)}xqd(G){const pa=this.n5h(G);G=this.m$h(pa,G);return[pa,G]}psd(G,pa){const kb=Ff.DOMElementExtensions.getBounds(this.$.Yh);
return[Math.round((kb.width-pa.x)*G),Math.round((kb.height-pa.y)*G)]}m$h(G,pa){pa=Tf.HelperMethods.fG(Yd.h(this.$).domElement,this.$.domElement,pa);return pa?(G=new Sys.UI.Point(Math.round(pa.x-G.x),Math.round(pa.y-G.y)),G):new Sys.UI.Point(0,0)}ytk(G,pa,kb,Zb,Lc,Bd,he){return(he=this.Pff(G,kb,Zb,Lc,Bd,he))?this.xef(he,G,pa,kb,Zb,Lc,Bd):null}Pff(G,pa,kb,Zb,Lc,Bd,he){he=void 0===he?!0:he;var Ie=fe.G(Yd.h(this.$).ga.ra.selectedRanges);if(he&&(Ie=Ie.Sg(fe.G(Yd.h(this.$).Tkc())),!Ie))return X.ULS.sendTraceTag(537149777,
0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const ff=Yd.h(this.$).Zd(Ie.topLeft);Ie=Yd.h(this.$).Zd(Ie.bottomRight);if(!ff||!Ie)return X.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;G=ff.cell.oI===Ie.cell.oI&&ff.cell.nI===Ie.cell.nI?this.f4h(G,Ie,pa,kb,Zb,Bd):this.cki(G,ff,Ie,pa,kb,Zb,Bd);return G?he?this.o6e(G,Zb,Lc):G:(X.ULS.sendTraceTag(537149775,
0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}o6e(G,pa,kb){if(0>G.x||G.x>pa)G.x=0;if(0>G.y||G.y>kb)G.y=0;G.x+G.width>pa&&(G.width=pa-G.x);G.y+G.height>kb&&(G.height=kb-G.y);return G}cki(G,pa,kb,Zb,Lc,Bd,he){pa=Yd.h(this.$).getCellBounds(pa.cell);if(!pa)return null;const Ie=Yd.h(this.$).getCellBounds(kb.cell);if(!Ie)return null;let ff=Lc.x;he&&(ff=0,pa.x=Math.round(Bd/G)-pa.x-Math.round(pa.width),Ie.x=Math.round(Bd/G)-Ie.x-Math.round(Ie.width));G=new Sys.UI.Bounds(Math.round((pa.x-
Zb.x)*G)-ff,Math.round((pa.y-Zb.y)*G-Lc.y),Math.round((Ie.x+Ie.width-pa.x)*G),Math.round((Ie.y+Ie.height-pa.y)*G));kb=kb.cell.getRange();X.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${kb.top}, b:${kb.bottom}, r:${kb.right}, l:${kb.left}) in bounds (${G.x}, ${G.y}, ${G.width}, ${G.height})`);return G}f4h(G,pa,kb,Zb,Lc,Bd){const he=Yd.h(this.$).getCellBounds(pa.cell);if(!he)return null;let Ie=Zb.x;Bd&&(Ie=
0,he.x=Math.round(Lc/G)-he.x-Math.round(he.width));G=new Sys.UI.Bounds(Math.round((he.x-kb.x)*G)-Ie,Math.round((he.y-kb.y)*G-Zb.y),Math.round(he.width*G),Math.round(he.height*G));pa=pa.cell.getRange();X.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${pa.top}, l:${pa.left}) in bounds (${G.x}, ${G.y}, ${G.width}, ${G.height})`);return G}wtk(G,pa,kb,Zb,Lc,Bd){const he=this.mbf(G,Lc,Bd);return he?this.xef(he,G,pa,kb,Zb,Lc,Bd):null}xef(G,
pa,kb,Zb,Lc,Bd,he){G=new Sys.UI.Point(this.dff(Bd,G.x,G.width),this.dff(he,G.y,G.height));return this.dqd(G,pa,kb,Zb,Lc)}dff(G,pa,kb){return G===kb?(X.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),G/2):G*pa/(G-kb)}mbf(G,pa,kb,Zb){Zb=void 0===Zb?!0:Zb;const Lc=Yd.h(this.$).ga.Ta.Fe.domElement;var Bd=Tf.HelperMethods.fG(Lc,Yd.h(this.$).domElement,Yd.h(this.$).rtl);if(!Bd)return X.ULS.sendTraceTag(537149771,
0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const he=Yd.h(this.$).vDb();Bd=new Sys.UI.Point(Math.round((Bd.x-he.topLeft.x)*G),Math.round((Bd.y-he.topLeft.y)*G));G=new Sys.UI.Bounds(Bd.x,Bd.y,Math.round(Lc.offsetWidth*G),Math.round(Lc.offsetHeight*G));return Zb?this.o6e(G,pa,kb):G}IIf(){this.Wlb.LC()}T2i(G){"ZoomToLevelInExcelLive"===G?this.zoomEventManager.Juj():this.zoomEventManager.Iuj()}uAj(){this.zoomEventManager=this.$.ia.Va(419,new rc)}dqd(G,pa,kb,
Zb,Lc,Bd){Bd=void 0===Bd?"":Bd;var he=Yd.h(this.$).rtl?0:Lc.x;Lc="ZoomWithPinch"===Bd||"ZoomWithMouse"===Bd?new Sys.UI.Point(G.x-he-Math.round(Zb.x*pa),G.y-Lc.y-Math.round(Zb.y*pa)):G;Lc=new Sys.UI.Point(Math.round(Lc.x/pa),Math.round(Lc.y/pa));X.ULS.shipAssertTag(537149770,0,!!pa,"Original zoom level must be different than 0");he=kb/pa;Lc=new Sys.UI.Point(Math.round(Lc.x*(1-1/he)),Math.round(Lc.y*(1-1/he)));"ZoomWithMouse"===Bd||"ZoomWithPinch"===Bd?(Lc.x+=Math.round((Zb.x-Yd.h(this.$).Eu)*(he-1)),
Lc.y+=Math.round((Zb.y-Yd.h(this.$).OM)*(he-1))):(he=Math.round(Zb.x*(kb-pa)),0<he&&Lc.x>he&&(Lc.x+=he),pa=Math.round(Zb.y*(kb-pa)),0<pa&&Lc.y>pa&&(Lc.y+=pa));"ZoomWithMouse"===Bd&&(G.x||(Lc.x=0),G.y||(Lc.y=0));G=Yd.h(this.$).vDb();return new Sys.UI.Point(Lc.x+G.topLeft.x,Lc.y+G.topLeft.y)}A6g(){const G=[];Y.a.instance.ie("Common.IGestureInputManager").execute(pa=>{0===pa.H9h()&&pa.Pyj(document.body,new Lb(this.$),G)})}Jmj(){return this.bNc()&&(Za.a.kq&&Za.a.PQa(67)||this.$.Frc)}mXj(G,pa){Da.a(this.$)?
this.setZoomLevel(G,pa,this.Pae,id.a.XYf):this.setZoomLevel(G,pa,this.zoomPerSheetId,this.jfb)}setZoomLevel(G,pa,kb,Zb){kb.remove(G);pa!==Zb&&kb.add(G,pa)}jfk(G){this.egg();this.$.Agb(Oe.a.Dea("TriggerImmediateZoomOperations"));this.Lnk();this.T2i(G)}Lnk(){this.FKi()?this.$.xj():this.Wlb.LC();const G=this.Wlb.Qhf("UpdateZoomStatusBar");G&&(G.innerText=this.LXb)}FKi(){const G=Xf.a(this.$);return G?G.xr.$z===(Re.a.uRa(this.$)?ne.a.dPb:this.$.He+ne.a.q$f):!1}vfk(G){Yd.h(this.$).vtk(G);this.q2g()}q2g(){const G=
Kf.a(this.$);if(G)for(const pa of Yd.h(this.$).ya.yy()){if(!pa){X.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!pa.Nl)continue;const kb=pa.Ek;if(kb)for(let Zb=0;Zb<kb.count;Zb++)if(2===kb.Li(Zb).type){const Lc=G.Mt(kb.Li(Zb).oj());Lc?(Lc.yia(!1),X.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):X.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else X.ULS.sendTraceTag(537149769,
0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}};Wd=Object(Ke.a)([Object(nc.d)(Oc.Dd),Object(Ke.b)(0,Object(Oc.fb)())],Wd);Object(Fa.a)(Wd,"ZoomManager",Jg.a,[]);class we extends pb.a{constructor(G){super();this.$=G;this.Oe()}create(){const G=new Wd(this.$);this.I9d(G);this.$.ia.Va(368,G);this.ve(G)}I9d(G){const pa=xf.a(this.$);if(pa){var kb=pa.Wkc("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");G.TFc(kb);G.FRb(pa.iWb)}else X.ULS.shipAssertTag(537149765,
0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static la(G){G.ia.Va(369,new we(G))}}Object(Fa.a)(we,"ZoomManagerFactory",pb.a,[]);var He=a(927);class jf extends pb.a{constructor(){super();this.Oe()}create(){this.ve(new He.a)}}Object(Fa.a)(jf,"CommonUIJsServiceFactory",pb.a,[]);var yf=a(1002);class pg{}Object(Fa.a)(pg,"LokiTokenResult",null,[]);class gg{constructor(G){this.P1b=
G}Spd(){const G=this.fbi();return G?gg.Zzd?new Promise((pa,kb)=>{this.P1b.continueWith(()=>{this.P1b.Yj||this.P1b.vi?kb(Error.create("Error downloading auth library")):this.P1b.result.pD("Loki",G).then(Zb=>{Zb=va.AFrameworkApplication.da.na("ForceLokiFallbackToACLPTokenIsEnabled")?this.ibi():Zb.IsSuccess&&Zb.Token?Object.assign(new pg,{isSuccess:!0,token:Zb.Token,errorMessage:null}):Object.assign(new pg,{isSuccess:!1,token:null,errorMessage:JSON.stringify(Zb)});pa(Zb);return Zb})})}):Promise.resolve(Object.assign(new pg,
{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new pg,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",yf.a.A9e())}))}ibi(){const G=va.AFrameworkApplication.da.Ra("LokiUserDataSignature")||"";return Object.assign(new pg,{isSuccess:!0,token:G,errorMessage:null})}fbi(){let G=null;const pa=yf.a.wic();2===pa?G=va.AFrameworkApplication.da.Ra("LokiAADAppId"):
1===pa&&(G=va.AFrameworkApplication.da.Ra("LokiMSAAppId"));return G}static get Zzd(){return va.AFrameworkApplication.da.na("IsO365CommercialHost")||va.AFrameworkApplication.da.na("IsO365ConsumerHost")}}Object(Fa.a)(gg,"LokiTokenManager",null,[379]);var Xg=a(528);class aa{get name(){return"Common.App.LivePersonaUtils"}init(){Y.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}nk(G){G.register(gg,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").Ve().$e(()=>new gg(Xg.a.Ar(G.ie("Common.App.OAuth.IOAuthManager"))))}static main(){Db.a.instance.$k(new aa)}}
Object(Fa.a)(aa,"LivePersonaUtilsPackage",null,[3,4]);class Va{constructor(G){this.Zja=this.Sja=this.cka=this.bka=null;this.Tie=this.Bge=this.Uie=this.tme=this.oA=this.kP=!1;this.yZc=this.Lme=null;this.Bme=0;this.Qa=this.Ime=null;this.Q5=G;this.kA=3;this.p0a=!0}initialize(G,pa,kb){this.bka=this.drd(G,pa);this.cka=CommonUIStrings.l_SavingStatus;this.Sja=CommonUIStrings.l_ReadOnlyStatus;this.Zja=CommonUIStrings.l_ReviewModeStatus;this.Q5&&this.Q5.execute(Zb=>{Zb.u4c(Object(Gb.a)(this,this.JWb,"updateToSavingStatus"))});
this.oA=!0;this.Qa=kb;this.Bge=this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisplayHeaderSaveStatusAsIcons",!1);return!0}Dia(G,pa){this.kP=G;this.kA=pa;this.TV(this.p0a)}TV(G){!this.p0a&&G&&(this.Ime=new Date);this.p0a=G;this.Tie=!1;G=null;3===this.kA&&(G=this.p0a?this.bka:this.cka);this.IBh(G)}drd(G,pa){return G?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):pa&&pa.length?String.format(CommonUIStrings.l_SavedToStatus,pa):CommonUIStrings.l_SavedStatus}JWb(){this.TV(!1)}Ebi(){switch(this.kA){case 1:return this.Sja;
case 2:return this.Zja;default:return null}}getMode(){if(3!==this.kA)switch(this.kA){case 1:return"ReadOnly";case 2:return"ReviewOnly";default:return null}return this.Tie?"FailedToSave":this.p0a?"Saved":"Saving"}JEi(G){return this.tme===this.kP&&this.Bme===this.kA&&this.Lme===G}bgd(G){appChrome.getHeaderApi().then(pa=>{pa.updateDocumentTitleStatus(this.kP,G,this.Ebi(),this.Ime,this.p0a,this.Bge?pa.getHeaderSaveStatusIconProps(this.getMode()):null);this.Uie=!0;return null});this.yZc=null}IBh(G){this.oA&&
yb.c()&&!this.JEi(G)&&(!this.Uie&&this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.bgd(G):kh.a.UVd()?(this.yZc&&X.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.yZc=window.requestIdleCallback(()=>{this.bgd(G)})):window.requestAnimationFrame(()=>{this.bgd(G)}),this.tme=this.kP,this.Lme=G,this.Bme=this.kA)}}Object(Fa.a)(Va,"ReactSaveStatusUIHandler",null,[388]);class hc{constructor(G,pa){this.Kq=
null;this.bka=CommonUIStrings.l_SavedStatus;this.cka=CommonUIStrings.l_SavingStatus;this.Sja=CommonUIStrings.l_ReadOnlyStatus;this.Zja=CommonUIStrings.l_ReviewModeStatus;this.Y_b=pa;this.Q5=G;this.kA=3;this.uva=!0}Sw(){this.Q5&&this.Q5.execute(G=>{G.u4c(Object(Gb.a)(this,this.JWb,"updateToSavingStatus"))});this.Y_b.execute(G=>{this.Kq=G})}Dia(G,pa){this.kA=pa;3===pa?this.TV(this.uva):2===pa?this.M7d(this.Zja):this.M7d(this.Sja)}JWb(){this.TV(!1)}TV(G){this.uva=G;this.M7d(this.uva?this.bka:this.cka)}M7d(G){this.Kq&&
this.Kq.sendMessage(eh.a.xhk,this.kmh(G))}kmh(G){const pa={};pa.StatusText=G;return pa}}Object(Fa.a)(hc,"SaveStatusPostMessageHandler",null,[388]);var Bc=a(139),Td=a(61);class V{constructor(G,pa,kb,Zb){this.Zja=this.Sja=this.cka=this.bka=null;this.EIa=0;this.nH=this.k_c=this.XGa=this.HOc=this.DJa=null;this.sg=G;this.Sba=pa;this.Q5=kb;this.km=Zb;this.Hke=!0;this.kP=!1;this.kA=3;this.uva=!0}initialize(G,pa){if(!this.sg)return!1;this.bka=this.drd(G,pa);this.cka=CommonUIStrings.l_SavingStatus;this.Sja=
CommonUIStrings.l_ReadOnlyStatus;this.Zja=CommonUIStrings.l_ReviewModeStatus;this.Sw();return!0}drd(G,pa){return G?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):pa&&pa.length?String.format(CommonUIStrings.l_SavedToStatus,pa):CommonUIStrings.l_SavedStatus}Sw(){this.Sba&&this.Sba.execute(G=>{G.s0g(Object(Gb.a)(this,this.zSe,"createStatusAndModeElements"));G.l0g(Object(Gb.a)(this,this.i3j,"showHideSaveStatusElement"));G.Xdk&&this.zSe(null,null)});this.Q5&&this.Q5.execute(G=>
{G.u4c(Object(Gb.a)(this,this.JWb,"updateToSavingStatus"))})}Ry(){this.nH&&this.sg&&this.sg.rJ(this.nH)}i3j(G,pa){this.Dia("true"===pa,this.kA)}Dia(G,pa){this.kP=G;this.kA=pa;this.HOc&&(this.HOc.style.display=this.kP||3===this.kA||!this.DJa?"none":"");this.XGa&&(this.XGa.style.display=this.kP||3===this.kA?"none":"",this.XGa.innerText=1===this.kA?this.Sja:this.Zja,this.XGa.title=1===this.kA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.k_c&&(this.k_c.style.display=
this.kP||1===this.kA||!this.DJa&&!this.XGa?"none":"");this.nH&&(this.nH.style.display=this.kP||1===this.kA?"none":"",this.TV(this.uva),this.nH.title=CommonUIStrings.l_SaveStatusTooltip)}zSe(G,pa){G=document.getElementById(gf.a.olf);pa&&pa.csk||!G||""===this.bka||""===this.cka||""===this.Sja||""===this.Zja||(this.DJa=document.getElementById(gf.a.X8b),this.HOc=gf.a.rxa(G,"BreadcrumbAppModeDash","-",null,!1),this.XGa=gf.a.rxa(G,"BreadcrumbAppModeStatus",1===this.kA?this.Sja:this.Zja,null,!1),this.Qug(this.XGa),
this.k_c=gf.a.rxa(G,"BreadcrumbSaveStatusDash","-",null,!1),this.nH=gf.a.rxa(G,"BreadcrumbSaveStatus",this.bka,null,!1),this.Qug(this.nH),this.Dia(this.kP,this.kA))}JWb(){this.TV(!1)}TV(G){this.uva=G;this.Omk(this.uva?this.bka:this.cka)}Omk(G){!this.nH||3!==this.kA&&2!==this.kA||(this.Hke&&!this.uva?(this.EIa=this.nH.offsetWidth<this.EIa?this.EIa:this.nH.offsetWidth,this.Fjk(this.cka),this.Hke=!1):this.nH.innerText=G)}Qug(G){G.style.direction=this.km?"rtl":"ltr";G.style.width="auto";G.style.textAlign=
this.km?"right":"left";G.style.display=this.kP?"none":"";G.setAttribute("Unselectable","on")}Fjk(G){this.nH&&(this.nH.style.width="",this.nH.innerText=G,this.EIa=this.nH.offsetWidth<this.EIa?this.EIa:this.nH.offsetWidth,G=Bc.a.gB(this.nH),this.nH.style.width=this.EIa-Td.a.EG(G.paddingLeft)-Td.a.EG(G.paddingRight)+1+"px")}}Object(Fa.a)(V,"SaveStatusUIHandler",null,[388]);var bb=a(99);class gc{constructor(){this.l_c=this.kZc=this.irb=this.Fd=null;this.xE=()=>{const G=va.AFrameworkApplication.da,pa=
!!va.AFrameworkApplication.sa.Sa&&4===va.AFrameworkApplication.sa.Sa.Hj;if(G.na("WordEditorAutoSaveImprovementIsEnabled")||G.na("PptEditorSaveStatusInHeaderEnabled")||pa&&G.na("SimplifiedReactRibbonUxIsEnabled")||G.na("ExcelSaveStatusInHeaderEnabled")||G.na("VisioSaveStatusInHeaderEnabled"))va.AFrameworkApplication.da.na("PostMessageEmbedded")&&va.AFrameworkApplication.hideHeaderEmbedded?(this.l_c=this.Fd.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.l_c.Sw():va.AFrameworkApplication.sa.Sa.Cwf||
va.AFrameworkApplication.hideHeader||(va.AFrameworkApplication.sa.Sa.zv?(this.kZc=this.Fd.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.kZc.initialize(G.na("IsSkyDrive"),G.Ra("HostNameToIncludeInSavedStatus"),va.AFrameworkApplication.da):(this.irb=this.Fd.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.irb.initialize(G.na("IsSkyDrive"),G.Ra("HostNameToIncludeInSavedStatus")))}}get name(){return"Common.App.SaveStatus"}nk(G){this.Fd=G;va.AFrameworkApplication.da.na("PostMessageEmbedded")&&
va.AFrameworkApplication.hideHeaderEmbedded?this.Fd.register(hc,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ve().$e(()=>new hc(this.Fd.ie("Common.App.HostNotification.EditNotificationEventSource"),this.Fd.ie("Postmessage.IHostPostmessenger"))):va.AFrameworkApplication.sa.Sa.Cwf||(va.AFrameworkApplication.sa.Sa.zv?this.Fd.register(Va,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ve().$e(()=>
new Va(this.Fd.ie("Common.App.HostNotification.EditNotificationEventSource"))):this.Fd.register(V,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Ve().$e(()=>new V(bb.EventHandlerManager.instance,this.Fd.ie("Common.App.Header.HeaderEventSource"),this.Fd.ie("Common.App.HostNotification.EditNotificationEventSource"),va.AFrameworkApplication.isRtl)))}init(){va.AFrameworkApplication.da.Jw(this.xE)}dispose(){this.irb&&this.irb.Ry()}}Object(Fa.a)(gc,"PackageManager",
null,[3,4]);var xc=a(236),Gd=a(34);class pe{constructor(G,pa){this.Hse=this.yUc=!1;this.dDa=(kb,Zb)=>{(null===Zb||void 0===Zb?0:Zb.yK)&&Gd.a.C5g([Zb.yK])&&(this.DRb=!0)};this.ro=()=>{this.DRb=!1};this.vf=(kb,Zb)=>{xc.b(Zb)&&this.Dia(!0);this.DRb=!1};this.fg=()=>{this.sU=this.$.sU;this.Dia()};this.rSf=()=>{this.TV()};this.yRf=()=>{this.sU=this.$.sU};this.tKd=()=>{Yd.h(this.$).ya.ds(this.tKd);this.sU=this.$.sU};this.bbg=pa;this.$=G;this.$.userOperationManager.xt(this.yRf);this.$.zn(this.fg);this.$.ea.U0g(this.rSf);
this.$.ea.Yl(this.vf);this.$.I6b(this.dDa);this.$.ea.dK(this.ro);this.Dia()}get FPi(){return this.$.ea?this.$.ea.pzf:!1}get sU(){return this.yUc}set sU(G){G?this.yUc=!0:Yd.h(this.$)&&Yd.h(this.$).ya&&(Yd.h(this.$).ya.a3()?this.yUc=!1:Yd.h(this.$).ya.wt(this.tKd));this.TV()}get DRb(){return this.Hse}set DRb(G){this.Hse=G;this.TV()}dispose(){this.$&&(this.$.uo(this.fg),this.$.hCc(this.dDa),this.$.userOperationManager&&this.$.userOperationManager.ur(this.yRf),this.$.ea&&(this.$.ea.YEj(this.rSf),this.$.ea.gm(this.vf),
this.$.ea.nO(this.ro)),Yd.h(this.$)&&Yd.h(this.$).ya&&Yd.h(this.$).ya.ds(this.tKd))}Dia(G){G=!this.$.isEditMode||(void 0===G?!1:G);this.bbg.Dia(G,this.$.isEditMode?3:1);this.TV()}TV(){this.$.isEditMode&&this.bbg.TV(!this.sU&&!this.FPi&&!this.DRb)}}Object(Fa.a)(pe,"SaveStatusManager",null,[5]);class Ne extends pb.a{constructor(G){super();this.Kf=G;this.Oe()}create(){const G=Y.a.instance;G.ie("Common.App.SaveStatus.ISaveStatusUIHandler").execute(pa=>{const kb=new pe(this.Kf,pa);G.register(pe,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").Ve().$e(()=>
kb);pa=Object(Sa.a)(this.Kf.ia,300,()=>G.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.ve(pa)})}static la(G){G.ia.Va(299,new Ne(G))}}Object(Fa.a)(Ne,"SaveStatusFactory",pb.a,[]);var We=a(948),pf=a(587);class Af extends Sys.EventArgs{constructor(){super()}}Object(Fa.a)(Af,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var xg=a(38),lh=a(632),ng=a(168);class sg{constructor(G){this.data=G}}Object(Fa.a)(sg,"NumberFormatDataHolder",null,[]);var fh=a(213),Ig=a(281);
class Uf extends qe.a{constructor(G,pa){super();this.zDd=id.a.Gg;this.Z8c=null;this.Qlb=this.fsc=!1;this.KJf=(kb,Zb)=>{var Lc;(kb=Yd.h(this.$))&&(Zb=null!==(Lc=Zb.cell)&&void 0!==Lc?Lc:kb.Zd(null))&&this.Ysa(Zb.cell.Lj,!0)};this.c$i=kb=>{this.isActive()&&(Gd.a.xs(kb.Errors)||!kb.Result?(kb=kb.Errors?kb.Errors.map(Zb=>JSON.stringify(Zb)).join(","):"None",X.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${kb}`)):(kb=kb.Result,X.ULS.sendTraceTag(537155725,0,
50,`Updating number format category cache, format index = ${kb.Index}, category = ${kb.Category}`),this.UUj(kb.Index,kb.Category),this.raiseEvent(Uf.N9c,new We.a(kb.Index,kb.Category),this)))};this.refresh=()=>{X.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");this.X9b();this.isActive()&&this.ea.Je.allowEdits&&(this.Qlb||this.mr&&!(this.ea.MU>this.zDd)?this.JMc():(X.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),
this.Gpd=pf.a(this.$.qa.ua,this.mr?this.mr.Digest:"",this.M$i,this.L$i,null,null)),X.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.Fbf())};this.iOf=kb=>{X.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${kb.data.status}, HTTP status = ${kb.data.httpStatus}.`);this.XOa=null};this.S3=()=>{this.Qlb=!1;this.ea.KE(this.S3);this.pWa(this.fsc?Uf.$0d:Uf.gJd)};this.vf=(kb,Zb)=>
{X.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");xc.a(Zb)&&this.pWa(Uf.$0d)};this.gi=()=>{X.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.rJd(0===this.$.workbookContext.CalcMode)};this.fg=()=>{X.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");this.pWa(Uf.$0d);3!==this.$.workbookContext.CalcMode&&
this.rJd(0===this.$.workbookContext.CalcMode)};this.E$i=(kb,Zb,Lc)=>{X.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.XOa=null;this.isActive()?kb.StateId===id.a.Gg?(X.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.JMc()):!kb.Result||this.i0&&this.i0.length?this.pWa(Uf.gJd):this.TRf(kb,Zb,Lc):X.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};
this.TRf=kb=>{this.i0=kb.Result;X.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.i0?this.i0.length:-1} functions.`);kb=!1;if(this.i0){for(const Zb of this.i0)Zb&&(this.Y7e[Zb.NameUI.toLocaleUpperCase()]=Zb.FunctionIndex.toString(),Zb.NameUI!==Zb.NameDataStrings&&(this.Y7e[Zb.NameDataStrings.toLocaleUpperCase()]=Zb.FunctionIndex.toString(),kb=!0),this.wZh.fa(Zb.FunctionIndex,Zb.NameUI));this.raiseEvent(Uf.xmd,
Sys.EventArgs.Empty,this)}kb&&X.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.M$i=kb=>{if(this.isActive())if(X.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.fsc=!1,this.zDd=kb.StateId,this.zDd===id.a.Gg)this.fsc=!0,this.JMc();else{if(kb.Result){var Zb=this.mr;this.mr=kb.Result;X.ULS.sendTraceTag(537155678,0,50,`InstantaneousSupportInformation updated, new result digest: ${this.mr.Digest}.`);
kb=[];if(Zb)kb=Uf.Hbi(Zb.NumberFormats,this.mr.NumberFormats);else for(Zb=0;Zb<this.mr.NumberFormats.length;Zb++)this.Gvc.fa(Zb,this.mr.NumberFormats[Zb].NumberFormatCategory);for(const Lc of kb)this.Gvc.fa(Lc,this.mr.NumberFormats[Lc].NumberFormatCategory);this.raiseEvent(Uf.HJd,new Af(kb),this);this.raiseEvent(Uf.$Af)}this.pWa(Uf.gJd)}};this.L$i=kb=>{this.isActive()&&(10===kb.data.status?X.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(X.ULS.sendTraceTag(21311555,
0,10,`Failed to update instantaneous support information, status = ${kb.data.status}, HTTP status = ${kb.data.httpStatus}.`),this.fsc=!0,this.JMc()))};X.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=G;this.$=pa;this.mr=this.XOa=this.Gpd=this.sPb=null;this.Gvc=new fh.a;this.WBb=new fh.a;this.i0=[];this.wZh=new fh.a;this.Y7e={};this.ea.Yl(this.vf);this.$.zn(this.fg);Yd.h(this.$).ga.gwa(this.KJf);this.ea.kx(this.gi);this.pWa(Uf.rnf);X.ULS.sendTraceTag(537155736,
0,50,"InstantaneousSupportInformationManager ctor end")}LAe(G){this.addHandler(Uf.HJd,G)}rUd(G){this.removeHandler(Uf.HJd,G)}dZg(G){this.addHandler(Uf.N9c,G)}CCj(G){this.removeHandler(Uf.N9c,G)}qAe(G){this.addHandler(Uf.xmd,G)}eUd(G){this.removeHandler(Uf.xmd,G)}M_g(G){this.addHandler(Uf.$Af,G)}get Hh(){return this.mr?this.mr.LocaleInformation:null}get wCa(){return this.mr?this.mr.NumberFormats:[]}get mna(){this.i0&&this.i0.length||this.Fbf();return this.i0}get Szi(){return this.mr&&void 0!==this.mr.InstantaneousCalcWebWorkerPrecisionSamplingRate&&
null!==this.mr.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.mr.InstantaneousCalcWebWorkerPrecisionSamplingRate:Uf.Txh}get Vzi(){return this.mr&&void 0!==this.mr.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.mr.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?this.mr.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:Uf.Xxh}get Uzi(){return this.mr&&void 0!==this.mr.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.mr.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?
this.mr.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:Uf.Wxh}get Tzi(){return this.mr&&void 0!==this.mr.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.mr.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.mr.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:Uf.Vxh}get Kwd(){return this.mr?this.mr.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:Uf.Uxh}get Anc(){return null!==this.Z8c?this.Z8c:!1}zgk(G){let pa;if(!G)return{returnValue:!0,category:"General"};
let kb;pa="";if(!(()=>{let Zb=this.Ysa(G,!1);({category:kb}=Zb);return Zb})().returnValue)return{returnValue:!1,category:pa};pa=this.Bnh(kb);return{returnValue:!0,category:pa}}Bnh(G){let pa="";switch(G){case 0:pa="General";break;case 1:pa="Number";break;case 2:pa="Currency";break;case 3:pa="Accounting";break;case 4:pa="Date";break;case 5:pa="Time";break;case 6:pa="Percentage";break;case 7:pa="Fraction";break;case 8:pa="Scientific";break;case 9:pa="Text";break;case 10:pa="Special";break;case 11:pa=
"Custom"}return pa}Ysa(G,pa){let kb,Zb=(()=>{let Lc=this.Gvc.Jf(G,0);({value:kb}=Lc);return Lc})().returnValue;!Zb&&0<G&&this.$&&(X.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${G}`),this.d4h(G),pa&&(kb=this.c4h(G),Zb=!0),lh.a(G,this.$.VG)&&(kb=6));return{returnValue:Zb,category:kb}}eGi(G){let pa=0;if((()=>{let kb=this.Ysa(G,!0);({category:pa}=kb);return kb})().returnValue)return 6===
pa;X.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${G}`);return!1}YXh(G){X.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.XOa=Ob.o(this.$.qa.ua,{FilterType:0},$d.b(this.TRf,G),this.iOf,null,null,null)}j7e(){this.pWa(Uf.rnf)}Tqh(){return Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LocalizedErrorNames",
!1)?Object(Ig.c)(this.Hh.ErrorNames)?(X.ULS.shipAssertTag(508699781,0,!1,"ErrorNames undefined"),this.qaf()):this.Hh.ErrorNames.map((G,pa)=>excelOnlineCalc.calc.errorTypeName(pa+1,G)):this.qaf()}qaf(){const G=[],pa=Object.keys(id.a.errorNames);for(let kb=0;kb<pa.length;kb++){const Zb=excelOnlineCalc.calc.errorTypeName(kb+1,pa[kb]);Zb&&G.push(Zb)}return G}rJd(G){this.Z8c=G}d4h(G){if(this.WBb&&this.$){var pa;if(!(()=>{let Zb=this.WBb.Jf(G);({value:pa}=Zb);return Zb})().returnValue||pa.isCompleted){X.ULS.sendTraceTag(537155728,
0,50,`Getting number format category for format index: ${G}`);var kb=pf.c(this.$.qa.ua,G,this.c$i,null,null,null);kb&&this.WBb.fa(G,kb)}}else X.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}c4h(G){return 1<=G&&8>=G?1:9<=G&&12>=G?2:13===G||14===G?6:15===G?8:17===G|18===G?7:19===G?4:16===G||20<=G&&29>=G||31===G?11:30===G?9:32<=G&&35>=G?3:0}isActive(){const G=void 0===this.ea||null===this.ea,pa=!G&&this.ea.Ee;
X.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${pa} - sessionStateManager IsNullOrUndefined: ${G}`);return pa}UUj(G,pa){this.Gvc.fa(G,pa)}dispose(){nf.a.Ma(this.sPb);this.sPb=null;this.X9b();for(let G of this.WBb){const pa=G.value;pa&&!pa.isCompleted&&va.AFrameworkApplication.Wf.cy(pa.ox)}this.WBb=null;this.ea&&(this.ea.gm(this.vf),this.Qlb&&this.ea.KE(this.S3),this.Qlb=!1,this.ea.Ky(this.gi));this.ea=null;this.$&&
Yd.h(this.$)&&Yd.h(this.$).ga&&(Yd.h(this.$).ga.hra(this.KJf),this.$.uo(this.fg));this.$=null;super.dispose()}isFeatureEnabled(G){try{switch(G){case "LocaleLongDateFormat":return Vb.EwaSettings.Fa(184);case "GetLocaleDayNames":return Vb.EwaSettings.Fa(185);case "CalculateTextWidthIgnoreLetterSpacing":return Vb.EwaSettings.Fa(255);case "OfficeVSO:3657744_CalcFixForDateFormat":return Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");
case "CalcAutocompleteExperiment":return Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcWebWorker":return!0;case "CalcPreventSpillingHack":return Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:7504597_calcPreventSpillingHack");case "CalcDynamicArrayOperators":return Vb.EwaSettings.Fa(101);default:return G.startsWith("OfficeVSO:")?Vb.EwaSettings.isChangeGateEnabled(G):!1}}catch(pa){return X.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${G}): feature parsing failed, returning false. Exception: ${pa.toString()}.`),
!1}}pWa(G){this.isActive()&&this.ea.Je.allowEdits?(nf.a.Ma(this.sPb),this.sPb=null,this.sPb=$c.a.instance.create(this.refresh,G,Yc.a.Wzi)):X.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.Je&&null!==this.ea.Je?this.ea.Je.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}Fbf(){X.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");
this.XOa?X.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):this.isActive()?this.i0&&this.i0.length||(this.XOa=Ob.o(this.$.qa.ua,{FilterType:0},this.E$i,this.iOf,null,null,null)):X.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}JMc(){this.Qlb||(this.Qlb=!0,this.ea.OD(this.S3))}X9b(){this.cy(this.Gpd);this.cy(this.XOa);this.XOa=this.Gpd=null}cy(G){G&&
!G.isCompleted&&this.$.qa.ua.Wkb(G.ox)}static Hbi(G,pa){if(!G||!G.length)return[];if(!pa||!pa.length){var kb=Array(G.length);for(var Zb=0;Zb<G.length;++Zb)kb[Zb]=G[Zb].IfmtIndex;return kb}kb=new fh.a;for(var Lc of G)kb.fa(Lc.IfmtIndex,new sg(Lc));G=new sa.a;for(Zb of pa)Lc=kb.Jf(Zb.IfmtIndex),{value:pa}=Lc,Lc.returnValue&&pa.data.FormatString===Zb.FormatString||G.add(Zb.IfmtIndex);return G.toArray()}}Uf.HJd="isim0";Uf.N9c="isim1";Uf.xmd="isim2";Uf.$Af="isim3";Uf.rnf=100;Uf.$0d=1E3;Uf.gJd=3E5;Uf.Txh=
.001;Uf.Xxh=.1;Uf.Wxh=.2;Uf.Vxh=.001;Uf.Uxh=50;Object(Fa.a)(Uf,"InstantaneousSupportInformationManager",qe.a,[375,5]);class Di extends pb.a{constructor(G){super();this.$=G;this.Oe()}create(){if(this.$){X.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var G=Object(Sa.a)(this.$.ia,268,()=>new Uf(this.$.ea,this.$));this.ve(G)}}static la(G){if(!G)throw Error.argumentNull("ewaControl");G.ia.Va(246,new Di(G))}}Object(Fa.a)(Di,"InstantaneousSupportInformationManagerFactory",
pb.a,[]);var Ei=a(579),Xi=a(574),Ki=a(570),Pi=a(1051);class lj{Lth(G,pa){if(G&&!(1>G.length)&&pa){var kb=Object.assign(new Ki.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.irh(G,kb.ControlList);pa.push(kb)}}irh(G,pa){const kb=Object.assign(new Ei.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Xi.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(pa,kb);pa=Object.assign(new Ki.a,
{Title:"",ControlList:[]});Array.add(kb.Menu.MenuSectionList,pa);this.qth(G,pa.ControlList)}qth(G,pa){for(let kb=0;kb<G.length;kb++){const Zb=Object.assign(new Pi.a,{ExternalId:String.format("CoauthorPersona_{0}",kb),Command:"336231556",DisplayName:G[kb].userName,LabelText:G[kb].userName,ImageBackColor:G[kb].color,PersonaId:G[kb].email,IsAnonymous:G[kb].isAnonymous});Array.add(pa,Zb)}}}Object(Fa.a)(lj,"PresenceContextMenuSectionBuilder",null,[374]);var uh=a(573);class ej{constructor(G,pa,kb,Zb){this.Sde=
this.D5=this.tl=this.dH=this.rba=null;this.j7g=()=>{this.V3b.QFe()};this.yx=Lc=>{1===Lc?(uh.a.C$(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),va.AFrameworkApplication.Vd.qh(cb.a.TDd,2)):(this.NTb(),va.AFrameworkApplication.Vd.qh(cb.a.UJe,2))};this.Ibh=()=>{this.nBh();va.AFrameworkApplication.Vd.qh(cb.a.TJe,2)};this.V3b=G;this.JQg=Zb;this.V3b.HQa&&(this.tl=new sh.a(3,2,5E3,this.j7g,2),va.AFrameworkApplication.Pj.Xh(this.tl),this.Oj(pa,kb));this.V3b.jtb(()=>{this.pKf()});
this.V3b.S2a(()=>{this.qKf()})}get businessBar(){return this.D5||(this.D5=Y.a.instance.Ii("CommonUI.IBusinessBar"))}get fIe(){return this.Sde||(this.Sde=Y.a.instance.Ii("CommonUI.IBusinessBarEntryFactory"))}Oj(G,pa){const kb=va.AFrameworkApplication.Vd;kb.uh(cb.a.authenticationLost,Ia.a.frame,G,96);kb.uh(cb.a.RFe,Ia.a.frame,pa,96);kb.xe(cb.a.TJe,Ia.a.frame,Ba.ActionManager.qgd);kb.xe(cb.a.UJe,Ia.a.frame,Ba.ActionManager.qgd);kb.xe(cb.a.TDd,Ia.a.frame,Ba.ActionManager.qgd)}pKf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);
va.AFrameworkApplication.Vd.qh(cb.a.authenticationLost,2)}qKf(){this.Oak();va.AFrameworkApplication.Vd.qh(cb.a.RFe,2)}Oak(){this.dH&&(this.dH.hide(),this.dH.dispose(),this.dH=null);this.rba&&this.businessBar&&(va.AFrameworkApplication.ij||this.businessBar.removeEntry(this.rba),this.rba.dispose(),this.rba=null)}showDialog(G){nf.a.Ma(this.dH);this.dH=new Cb.StandardDialog;this.JQg||(this.dH.Gw=!1,this.dH.ke=0);this.dH.Ke(1,CommonUIStrings.l_SignIn);this.dH.JV(CommonUIStrings.l_DefaultDialogTitle,G,
this.yx)}NTb(){this.businessBar&&this.fIe&&(this.rba=this.fIe.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.rba.closeable=!0,this.rba.addButton(CommonUIStrings.l_SignIn,ej.Gbh,""),this.rba.yda=this.Ibh,this.businessBar.MD(this.rba,!1))}nBh(){this.tl&&(va.AFrameworkApplication.Pj.Rr(this.tl),this.tl=null)}dispose(){this.tl=this.dH=this.rba=null}static Gbh(){uh.a.C$();va.AFrameworkApplication.Vd.qh(cb.a.TDd,2)}}Object(Fa.a)(ej,"SignOutResponseUI",
null,[5]);class ki{get name(){return"Common.App.UI"}nk(G){G.register(lj,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Ve()}init(){}dispose(){nf.a.Ma(ki.o6);ki.o6=null}static main(){Db.a.instance.$k(new ki)}}ki.o6=null;Object(Fa.a)(ki,"CommonAppUIPackage",null,[3,4]);var Gi=a(35),ai=a(222),$g=a(24),ei=a(1115),gi=a(175),Vh=a(183),lf=a(235),E=a(67),da=a(97),Ha=a(161);class Fb{constructor(G,pa,kb){this.iSa=1;this.yca=[];this.active=!1;this.De=
null;this.onPointerDown=Zb=>{this.gridView.setLastInputMethod(Zb.Da.rawEvent);return!1};this.Nz=()=>{const Zb=this.gridView.dsd();if(!(0>=Zb||Zb===this.iSa||this.gridView.Xt)){var Lc=!1,Bd=[],he=[];for(var Ie=this.yca.length-1;0<=Ie;Ie--){var ff=this.yca[Ie];if(this.csd(ff)>Zb||ff.bottom<Zb)Bd.push(ff),this.yca.splice(Ie,1),Lc=!0}for(Ie=this.gg.rangeList.length-1;0<=Ie;Ie--){ff=this.gg.rangeList[Ie];const qf=this.csd(ff);qf<=Zb&&ff.bottom>=Zb&&!(qf<=this.iSa&&ff.bottom>=this.iSa)&&ff.doa&&(he.push(ff),
Lc=!0)}if(Lc){ff=this.gridView.Cyc;for(let qf of ff)for(let eg of qf)for(let dh of eg)this.opc?this.Pgh(dh,Bd,he):this.Qgh(dh,Bd,he,Lc)}else X.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.iSa=Zb}};this.NOf=(Zb,Lc)=>{Lc.isRow||Lc.S4c(this.Zlc)};this.OOf=(Zb,Lc)=>{Lc.isRow||(this.gg.rangeList.length||this.deactivate(),Lc.JUd(this.Zlc))};this.Zlc=(Zb,Lc)=>{if(this.og())this.activate();else if(Zb=this.active,this.deactivate(),
!Zb){X.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlock: detected an opportunity for bailing out");return}(Lc=Lc.Ex)&&this.Llg(Lc.S8,Lc)};this.zRf=(Zb,Lc)=>{!this.gridView.Xt&&(this.og()?this.activate():(Zb=this.active,this.deactivate(),Zb||X.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Lc=Lc.Ex)&&(Zb=ei.a(Lc.S8),this.Llg(Zb,Lc)&&Lc.o_d(Zb))};this.Jg=()=>{this.gridView.Gd.iQ?this.deactivate():
this.activate()};this.gg=G;this.gridView=pa;this.$=pa.$;this.De=kb;G.C4c(this.zRf);pa.f_g(this.NOf);pa.g_g(this.OOf);this.$.ta.zj(this.Jg);this.$.ue.zj(this.Jg);this.sEe(Zb=>{Zb.S4c(this.Zlc)});this.og()&&(this.activate(),this.Nz(this,null));this.$.ia.Va(68,this)}dispose(){this.deactivate();this.gridView&&(this.gg.xUd(this.zRf),this.gridView.wDj(this.NOf),this.gridView.xDj(this.OOf),this.$.ta.dk(this.Jg),this.$.ue.dk(this.Jg),this.sEe(G=>{G.JUd(this.Zlc)}));this.gridView=this.gg=this.yca=null}get opc(){return this.gridView.qE}KJc(G,
pa,kb){if(!Lg.b(this.$.pa)||this.$.ea.isNamedObjectViewMode||this.gridView.Gd.KFa)return pa&&X.ULS.sendTraceTag(509166923,0,50,"HeaderSnappingFeature.toggleHeaderSnapping: Header snapping should be disabled in named object view or in top row frozen."),!0;const Zb=kb.rhf();if(Vb.EwaSettings.Syd()&&!Zb)return X.ULS.sendTraceTag(508368917,0,15,`HeaderSnappingFeature.toggleHeaderSnapping: HeaderNumbers should have been initialized, isActivate=${pa}, headerViewBlock.hashCode=${kb.hashCode}`),!1;var Lc=
Zb.length;if(Zb[Lc-1]<G.left)return!1;var Bd=Tf.HelperMethods.zA(new ai.a(Zb),0,Lc,G.left,Tf.HelperMethods.HI);if(0>Bd)return!1;const he=G.q6d,Ie=G.aGe;Lc=Math.min(he.length+Bd,Lc);let ff=0;if(!Ie)return X.ULS.sendTraceTag(509220160,0,10,"HeaderSnappingFeature.toggleHeaderSnapping: autoFilterDatas should be initialized."),!1;for(;Bd<Lc;Bd++){const qf=Zb[Bd],eg=Ie[ff];pa?(kb.updateCellText(Bd,he[ff]),kb.updateCellAlignment(Bd,!0),Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8133326_fixAceRegressionInAutoFilterMenu")?
eg&&(kb.activateCellAutoFilter(Bd,eg),this.x3c(G,ff,qf)):(kb.activateCellAutoFilter(Bd,eg),this.x3c(G,ff,qf)),Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&kb.ovg(Bd,!0)):(kb.updateCellText(Bd,$g.Range.qT(qf)),kb.updateCellAlignment(Bd,!1),kb.deactivateCellAutoFilter(Bd),Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8161977_fixHeaderSnappingAutoFilterNone")&&kb.ovg(Bd,!1),this.FXe(qf));pa&&kb.QTj();ff++}kb.vr("HeaderSnappingFeature::toggleHeaderSnapping");
G.cFa=pa;return!0}LJc(G,pa,kb,Zb){if(!Lg.b(this.$.pa)||this.$.ea.isNamedObjectViewMode||this.gridView.Gd.KFa)return!0;if(!kb.length)return!1;var Lc=Zb.length;if(Zb[Lc-1]<G.left)return!1;var Bd=Tf.HelperMethods.zA(new ai.a(Zb),0,Lc,G.left,Tf.HelperMethods.HI);if(0>Bd)return!1;const he=G.q6d,Ie=!!G.G4a&&0<G.G4a.length,ff=!!G.menuModel&&0<G.menuModel.length;for(let dh=Bd,nh=0,Ug=Math.min(he.length+Bd,Lc);dh<Ug;dh++,nh++)if(Lc=kb[dh]){var qf=null;(Bd=Lc.getElementsByClassName(Gi.a.Gjd))&&(qf=Bd[0]);if(qf&&
qf.innerText){if(Bd=Lc.getElementsByClassName(Gi.a.bCe))for(var eg=Bd.length-1;0<=eg;eg--)Lc.removeChild(Bd[eg]);Bd=Zb[dh];pa?(qf.innerText=he[nh],Lc.classList.add(Gi.a.a3e),Ie&&G.G4a[nh]&&(qf=document.createElement("div"),this.De.dl(qf,G.G4a[nh]),eg=G.G4a[nh].split(E.a.R3g),3===eg.length?(eg=da.a.Lh(eg[1]),this.iye(qf.firstChild,eg),gi.a.instance.va(Lf.a.ji,qf.firstChild,this.onPointerDown),Vh.a.instance.va(Lf.a.$r,qf.firstChild,this.onPointerDown)):(eg=new Ha.a(this.$.ta),(eg.og(2048)||eg.og(4096))&&
X.ULS.sendTraceTag(509678873,0,10,"HeaderSnappingFeature.toggleHeaderSnappingHtml: buttonHtml doesn't contain click/pointer handlers for ShowAutoFilterMenu"),this.iye(qf.firstChild,null)),ff&&G.menuModel[nh]&&this.x3c(G,nh,Bd),Lc.appendChild(qf.firstChild))):(Lc.classList.remove(Gi.a.a3e),qf.textContent=$g.Range.qT(Bd),this.FXe(Bd))}}G.cFa=pa;return!0}iye(G,pa){lf.a.instance.va(Lf.a.click,G,kb=>{if(pa){const {row:Zb,col:Lc}=Tf.HelperMethods.wgi(pa);this.gridView.h$f(kb.Da.rawEvent,966232027,pa,this.$.get_id(),
Zb,Lc)}return!0})}x3c(G,pa,kb){this.$.ia.Od(8,Zb=>{Zb.Tgc.abj(G,pa,kb)})}FXe(G){this.$.ia.Od(8,pa=>{pa.Tgc.bbj(G)})}Qgh(G,pa,kb,Zb){const Lc=G.Dx,Bd=ei.a(G.S8);let he;for(let Ie=pa.length-1;0<=Ie;Ie--)he=pa[Ie],this.LJc(he,!1,Bd,Lc)&&pa.splice(Ie,1);for(pa=kb.length-1;0<=pa;pa--)he=kb[pa],this.LJc(he,!0,Bd,Lc)&&this.yca.push(he);Zb&&G.o_d(Bd)}Pgh(G,pa,kb){if(G.Tdh()){for(var Zb=pa.length-1;0<=Zb;Zb--)this.KJc(pa[Zb],!1,G)&&(X.ULS.sendTraceTag(509166921,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table deactivation succeeded"),
pa.splice(Zb,1));for(pa=kb.length-1;0<=pa;pa--)Zb=kb[pa],this.KJc(Zb,!0,G)&&(X.ULS.sendTraceTag(509166919,0,50,"HeaderSnappingFeature.checkTablesForSnapping: Table activation succeeded"),this.yca.push(Zb))}else X.ULS.sendTraceTag(509166922,0,15,"HeaderSnappingFeature.checkTablesForSnapping: headerViewBlock can't be snapped")}Llg(G,pa){const kb=this.opc?pa.rhf():pa.Dx;if(Vb.EwaSettings.Syd()&&!kb)return X.ULS.sendTraceTag(508368916,0,15,`HeaderSnappingFeature.snapHeadersAfterGetRange: HeaderNumbers should have been initialized, headerViewBlock.hashCode=${pa.hashCode}`),
!1;var Zb=kb[0];const Lc=kb[kb.length-1],Bd=this.mki(Zb,Lc);let he=!1;for(let Ie=this.yca.length-1;0<=Ie;Ie--){const ff=this.yca[Ie];Lc>=ff.left&&Zb<=ff.right&&(this.opc?this.KJc(ff,!1,pa):this.LJc(ff,!1,G,kb),this.yca.splice(Ie,1),he=!0)}for(let Ie=0,ff=Bd.length;Ie<ff;Ie++)if(Zb=Bd[Ie],this.opc?this.KJc(Zb,!0,pa):this.LJc(Zb,!0,G,kb))this.yca.push(Bd[Ie]),he=!0;return he}activate(){this.og()&&!this.active&&(this.gridView.view.fu(this.Nz),this.active=!0)}deactivate(){this.active&&(this.gridView.view.Vs(this.Nz),
this.active=!1)}og(){return Lg.b(this.$.pa)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.Gd.gS&&0<this.gg.rangeList.length}sEe(G){const pa=this.gridView.Cyc;for(let kb of pa)for(let Zb of kb)for(let Lc of Zb)G(Lc)}mki(G,pa){const kb=[];if(!this.active)return kb;this.iSa=this.gridView.dsd();for(let Zb=this.gg.rangeList.length-1;0<=Zb;Zb--){const Lc=this.gg.rangeList[Zb];Lc.bottom>=this.iSa&&this.csd(Lc)<=this.iSa&&Lc.left>=G&&Lc.right<=pa&&Lc.doa&&kb.push(Lc)}return kb}csd(G){const pa=this.gridView.Ud.Di(G);
return pa&&this.gg.Ssf(G,pa.usedRange.topLeft)?G.top+1:G.top}}Object(Fa.a)(Fb,"HeaderSnappingFeature",null,[5]);class bc extends pb.a{constructor(G){super();this.$=G;this.Oe()}create(){const G=Object(Qb.d)(nc.a.resolve(Oc.pd,{Oa:this.$a})),pa=Object(Qb.d)(nc.a.resolve(Oc.Mb,{Oa:this.$a}));Ec.TaskExtensions.Aa(Ec.TaskExtensions.Tg([pa],this.ma),()=>{Ec.TaskExtensions.Aa(Ec.TaskExtensions.Tg([G],this.ma),()=>{this.ve(this.$.ia.Ja(68)||new Fb(G.result,Yd.h(this.$),pa.result))},this.ma,11)},this.ma,3)}static la(G){G.ia.Va(67,
new bc(G))}}Object(Fa.a)(bc,"HeaderSnappingFactory",pb.a,[]);var Vc=a(167),Sc=a(619);class wd extends Sc.a{constructor(){super()}dispose(){Vc.WacAirSpace.lxd()&&Vc.WacAirSpace.IJc()}animate(G,pa,kb,Zb,Lc){pa&&Vc.WacAirSpace.BR(G.element,pa);Vc.WacAirSpace.animate(G,Zb,Lc);kb&&Vc.WacAirSpace.PAj(G.element,kb)}}Object(Fa.a)(wd,"AnimationManager",Sc.a,[5]);var md=a(103);new b(0,0,0,0,0,0);new b(1,1,0,0,0,0);new b(2,2,0,0,0,0);new b(3,3,0,0,0,1);new b(4,3,1,0,1,1);new b(5,3,0,0,.42,1);new b(6,3,.83,0,
1,1);new b(7,3,0,0,.58,1);new b(8,3,.42,0,.58,1);new b(9,3,.1,.25,.75,.9);new b(10,3,.1,.9,.2,1);new b(11,3,.1,.9,.2,1);new b(12,3,.9,.1,.2,1);new b(13,3,.4,0,0,1);new b(14,3,.13,.21,.1,.7);new b(15,3,.02,.33,.38,.77);new b(16,3,.57,.17,.95,.75);new b(17,3,0,.19,.07,.72);new b(18,3,0,0,.95,.37);new b(19,3,.66,0,.34,1);new b(20,3,.8,0,.2,1);new b(21,3,.8,0,.2,1);h.prototype={type:0,startTime:new c(0,null),endTime:new c(0,null),szk:new c(0,null),Owk:new c(0,null),operationType:0};var Ld=Array(1);Ld[0]=
new c(0,0);new f(0,[new h(5,0,0,0,null,1,1,0)]);new f(1,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,50,null,1,1,0)]);new f(2,[new h(1,3,0,167,null,0,1,1),new h(2,3,0,167,null,0,1,1)]);new f(3,[new h(3,3,0,167,null,0,1,1),new h(4,3,0,167,null,0,1,1)]);new f(4,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,167,null,1,1,0)]);new f(5,[new h(5,2,0,167,null,0,1,0)]);new f(6,[new h(1,3,0,100,null,0,1,1),new h(2,3,0,100,null,0,1,1)]);new f(7,[new h(3,3,0,100,null,0,1,1),new h(4,3,0,100,null,0,1,1)]);new f(8,[new h(5,
2,0,100,null,1,1,0)]);new f(9,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,100,null,1,1,0)]);new f(10,[new h(5,2,0,100,null,0,1,0)]);new f(11,[new h(1,3,0,267,null,0,1,1),new h(2,3,0,267,null,0,1,1)]);new f(12,[new h(3,3,0,267,null,0,1,1),new h(4,3,0,267,null,0,1,1)]);new f(13,[new h(5,2,0,267,null,1,1,0)]);new f(14,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,267,null,1,1,0)]);new f(15,[new h(5,2,0,267,null,0,1,0)]);new f(16,[new h(6,3,0,267,null,0,1,1),new h(7,3,0,267,null,0,1,1)]);new f(17,[new h(1,3,0,750,
null,0,1,1),new h(2,3,0,750,null,0,1,1)]);new f(18,[new h(3,3,0,750,null,0,1,1),new h(4,3,0,750,null,0,1,1)]);new f(19,[new h(5,2,0,750,null,1,1,0)]);new f(20,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,750,null,1,1,0)]);new f(21,[new h(6,3,0,1E3,null,0,1,1),new h(7,3,0,1E3,null,0,1,1)]);new f(22,[new h(1,3,0,367,null,0,1,1),new h(2,3,0,367,null,0,1,1)]);new f(23,[new h(3,3,0,367,null,0,1,1),new h(4,3,0,367,null,0,1,1)]);new f(24,[new h(5,2,0,367,null,1,1,0)]);new f(25,[new h(5,2,0,0,null,0,2,0),new h(5,
2,0,367,null,1,1,0)]);new f(26,[new h(5,2,0,367,null,0,1,0)]);new f(27,[new h(6,2,0,Ld[0],null,0,1,1),new h(7,2,0,Ld[0],null,0,1,1)]);new f(28,[new h(5,2,0,0,null,1,1,0),new h(5,2,0,50,null,0,1,0)]);new f(29,[new h(1,3,0,433,null,0,1,1),new h(2,3,0,433,null,0,1,1)]);new f(30,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,50,null,1,1,0),new h(2,3,0,0,null,40,1,1),new h(2,3,0,100,null,0,1,1)]);new f(31,[new h(2,0,0,0,null,32,1,1),new h(2,0,0,100,null,32,1,1),new h(2,3,101,350,null,0,1,1),new h(3,0,0,0,null,
0,2,1),new h(3,0,0,100,null,0,2,1),new h(3,3,101,350,null,0,1,1),new h(5,0,0,0,null,0,2,0),new h(5,0,0,100,null,1,1,0)]);new f(32,[new h(2,3,0,267,null,32,1,1),new h(3,3,0,267,null,0,2,1),new h(5,2,0,0,null,1,0,0),new h(5,2,0,267,null,0,2,0)]);new f(33,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,100,null,0,2,0),new h(5,2,101,267,null,1,1,0)]);new f(34,[new h(1,10,0,300,null,0,1,1),new h(2,10,0,300,null,0,1,1)]);new f(35,[new h(3,10,0,300,null,0,1,1),new h(4,10,0,300,null,0,1,1)]);new f(36,[new h(1,8,0,
750,null,0,1,1),new h(2,8,0,750,null,0,1,1)]);new f(37,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,200,null,0,2,0),new h(5,3,201,500,null,1,1,0)]);new f(38,[new h(1,2,0,0,null,0,2,1),new h(2,2,0,0,null,0,2,1),new h(1,2,0,200,null,0,2,1),new h(2,2,0,200,null,0,2,1),new h(1,3,201,267,null,0,1,1),new h(2,3,201,267,null,0,1,1)]);new f(39,[new h(1,3,0,267,null,0,1,1),new h(2,3,0,267,null,0,1,1)]);new f(40,[new h(5,2,0,0,null,0,2,0),new h(5,2,0,267,null,1,1,0)]);new f(41,[new h(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");
window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(G){window.setTimeout(G,16)}}();e.prototype={Ih:null,G3g:5,Vtb:null,C5c:0,startTime:null,duration:null,Oec:null,q7c:-1,GHd:-1,dHd:-1};e.prototype.Start=function(){this.startTime=new Date;this.Oec={}};e.prototype.GetRecentAnimationStats=function(){for(var G=[],pa=0,kb=oe.C5c;kb<oe.G3g;kb++)null!=
oe.Vtb[kb]&&(G[pa]=oe.Vtb[kb],pa++);for(kb=0;kb<oe.C5c;kb++)null!=oe.Vtb[kb]&&(G[pa]=oe.Vtb[kb],pa++);return G};e.prototype.GetAnimationSqmStats=function(){var G=[];G[0]=0>oe.q7c?0:oe.q7c;G[1]=0>oe.GHd?0:oe.GHd;G[2]=0>oe.dHd?0:oe.dHd;return G};var oe=new e,Qe=a(56),cf=a(200);class sf{constructor(){this.ote=this.B_c=!1;this.OTa=()=>{cf.a.instance.DUd(this.OTa);X.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Vpi()};this.bTf=()=>{cf.a.instance.CUd(this.bTf);this.ote||this.B_c||(X.ULS.sendTraceTag(20492680,
217,50,"SessionExpiringDetected - Showing expiring dialog."),this.ote=!0,this.w4j())};const G=va.AFrameworkApplication.accessTokenTtl;0>=G||(this.accessTokenTtl=G,X.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:va.AFrameworkApplication.g1}),cf.a.instance.K4c(this.OTa),cf.a.instance.I4c(this.bTf))}Vpi(){this.B_c||(va.AFrameworkApplication.Du(Qe.a.NEc),this.B_c=!0,this.v4j())}}Object(Fa.a)(sf,
"ASessionExpirationManager",null,[]);var wf=a(262),Gf=a(88),ld=a(265);class de extends sf{constructor(G){super();this.Xa=new qe.a;this.$H=this.asb=!1;this.$=G}WAe(G){this.Xa.addHandler("SessionExpired",G)}stb(G){this.Xa.addHandler("TokenRefreshed",G)}gCc(G){this.Xa.removeHandler("TokenRefreshed",G)}get accessTokenExpiringMessage(){const G=(new Date(this.accessTokenTtl)).format(this.$.xa.ShortTimeFormat);return String.format(Ve.a.instance.Qd(78),G)}get E6d(){return this.asb}get ljb(){return!1}get Efa(){return!1}get HSd(){return!1}get G9(){return!1}Vlc(){return cf.a.instance.DU(va.AFrameworkApplication.accessTokenTtl)}dispose(){nf.a.Ma(this.Xa);
this.$=null}w4j(){this.$.isEditMode&&this.rlc(!1)}v4j(){this.asb=!0;this.rlc(!0);this.Xa.raiseEvent("SessionExpired")}rlc(G){X.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${G}, GotDeploymentOrTimedOutError ${this.$.ea.D2}`);const pa=this.$.Rd.Qr;G&&pa&&pa.isVisible&&1299163859===pa.error.MessageId&&this.$.Rd.Qr.qy();const kb=this.Mf(G);lc.a(this.$).Ts(new wf.a(ub.a.Cx,5,()=>{const Zb=Pb.a(this.$),Lc=Zb.Pf.activityState;Lc[Gf.a.A6]=
this.$.mvb(this.$.isEditMode);Lc[Gf.a.vP]=Gf.a.Tdb;Lc[ld.a.er]=ub.a.accessTokenExpiringWarning;Zb.Pf.rt([kb])}))}Mf(G){return G?Gd.a.Mdd():this.Cuh()}Cuh(){const G=Gd.a.Mf(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");G.Description=this.accessTokenExpiringMessage;return G}}Object(Fa.a)(de,"EwaAccessTokenExpirationManager",sf,[327,328,5]);var ug=a(181),Zf=a(65),ag=a(665);class Rf{constructor(G,pa){this.tPb=!1;this.correlationID=G;this.aed=pa;this.QJc=!1;this.creationTime=Ud.a.Jd.Re}}Object(Fa.a)(Rf,
"RefreshAccessTokenContext",null,[]);var Cg=a(163),Yg=a(165),Ng=a(36),Zg=a(132);class Zh{}Object(Fa.a)(Zh,"Error",null,[]);class Vg{}Object(Fa.a)(Vg,"NamedResult",null,[]);class di extends Vg{}Object(Fa.a)(di,"ErrorInfo",Vg,[]);class Uh{constructor(G,pa){this.E4b=G;this.EJ=pa}get tokens(){return this.E4b}get errors(){return this.EJ}}Object(Fa.a)(Uh,"TokenRefreshArgs",null,[325]);class Wi{constructor(G,pa){this.documentVisibilityObserver=null;this.Xa=new qe.a;this.FF=null;this.Tjb=this.Uqb=!1;this.WAc=
null;this.BPb=!1;this.GFd=!0;this.rme=this.Ple=this.$H=this.asb=!1;this.jW=null;this.Fjf=()=>{if(this.$.ea.Ee)this.akf(!1);else if(this.GFd){this.GFd=!1;const kb=Pb.a(this.$);X.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${kb.vk?kb.vk.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.fqg()}]`)}};this.vf=(kb,Zb)=>{this.context&&(kb=this.$.ea,Zb.vI&&this.context.tPb&&!this.context.QJc?
(this.context.QJc=!0,Zb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Zb.IsUserActive=kb.Uh.Ps,Zb.RefreshAccessTokenCorrelationID=this.context.correlationID,Zb=ef.a.ff(Zb),X.ULS.sendTraceTag(537170708,0,50,Zb)):!this.Uqb||kb.Ee||this.context.aed||(Zb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.FF&&(this.FF.cancel(),Zb.Aborted=!0,Zb.ResetStopRefreshRetriesUntilTokenExpired=!0,this.Tjb=!1),Zb.TimeUntilTokenExpirationInMin=
this.fqg(),Zb.RefreshAccessTokenCorrelationID=this.context.correlationID,Zb=ef.a.ff(Zb),X.ULS.sendTraceTag(572019856,0,50,Zb)))};this.VCa=()=>{if(this.context&&this.context.tPb&&!this.context.QJc){var kb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};kb.CreatedForExpired=this.context.aed;kb.RefreshAccessTokenCorrelationID=this.context.correlationID;kb.OpenWorkbookErrors=Gd.a.Me(this.$.ea.MI);kb.ExecutionContextErrors=Gd.a.Me(Pb.a(this.$).Pf.errors);kb.accesstokenTTL=va.AFrameworkApplication.accessTokenTtl;
kb=ef.a.ff(kb);X.ULS.sendTraceTag(537170707,0,15,kb)}};this.$jf=()=>{this.Tjb=!1;this.akf(!0)};this.UMd=()=>{this.BPb&&(this.$.ea.Uh.aEa(this.UMd),this.BPb=!1);this.Amg()};this.$=G;this.G6d=pa;this.ESd=G.pe.Fi("WebServiceCall","refreshToken");cf.a.instance.K4c(this.$jf);cf.a.instance.I4c(this.Fjf);pa=this.$.ea;pa.Yl(this.vf);pa.J6b(this.VCa);this.ZZi=this.$.xa.MinTokenLifetimeForRegularExpirationPromptInMin;this.Ghg=this.$.xa.ShortAccessTokenExpirationPromptSeconds;this.X2f=this.$.xa.RefreshAccessTokenDurationLimitInSec;
this.pwg(G.ea.jWf,va.AFrameworkApplication.accessTokenTtl);G=JSON.stringify({["AccessTokenTtl"]:va.AFrameworkApplication.accessTokenTtl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:va.AFrameworkApplication.g1,["WopiTokenExpiresAfterMinutes"]:va.AFrameworkApplication.wae,["WopiTokenTaskItemPriority"]:va.AFrameworkApplication.yae});X.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${G}`);Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void nc.a.resolve(Oc.W).then(kb=>{this.documentVisibilityObserver=kb}):this.$.ia.Od(291,kb=>{this.documentVisibilityObserver=kb})}WAe(G){this.Xa.addHandler("SessionExpired",G)}stb(G){this.Xa.addHandler("TokenRefreshed",G)}gCc(G){this.Xa.removeHandler("TokenRefreshed",G)}get E6d(){return this.asb}get Efa(){return this.Ple}get G9(){return this.rme}get context(){return this.jW}get ljb(){return this.G9?!1:this.$.ea.Uh.Ps?1>Zg.a.d$:6>Zg.a.e$}get HSd(){return this.Uqb}Vlc(){return cf.a.instance.DU(va.AFrameworkApplication.accessTokenTtl)}dispose(){cf.a.instance.DUd(this.$jf);
cf.a.instance.CUd(this.Fjf);const G=this.$.ea;G&&(G.gm(this.vf),G.iCc(this.VCa));nf.a.Ma(this.Xa);this.documentVisibilityObserver=this.$=null}fqg(){return this.Vlc()?0:(va.AFrameworkApplication.accessTokenTtl-(new Date).getTime())/6E4}pwg(G,pa){if(0<pa&&!this.Vlc()){const kb=va.AFrameworkApplication.da.eg("AccessTokenExpirationPromptSeconds",va.AFrameworkApplication.J0),Zb=(pa-G.getTime())/6E4;X.ULS.shipAssertTag(537170713,0,0<=Zb,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${pa}] creationTime [${G.getTime()}] tokenLifetimeInMin [${Zb}]`);
Zb<this.ZZi?(X.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.Ghg}] tokenLifetimeInMin [${Zb}]`),va.AFrameworkApplication.J0=this.Ghg):va.AFrameworkApplication.J0!==kb&&(X.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${kb}] tokenLifetimeInMin [${Zb}]`),va.AFrameworkApplication.J0=kb)}}dph(G){return!this.context||
this.context.tPb||this.context.aed!==G?(G=new Rf(ug.a.create().toString(),G),this.context&&!this.context.QJc&&X.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${G.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.tPb}] `),this.jW=G,!0):!1}wIj(G){G&&this.$H&&!this.Efa&&this.$.ea.Uh.Ps&&!this.G9&&(this.$H=!1)}akf(G){this.wIj(G);if(!(this.Uqb||this.Tjb&&!G||this.$H)&&this.ljb){this.Uqb=
!0;var pa=this.context?this.context.creationTime:null,kb=this.dph(G);this.GFd=!0;var Zb=this.$.ea,Lc={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};Lc.newContextCreated=kb;Lc.IsUserActive=Zb.Uh.Ps;Lc.IsSessionActive=Zb.Ee;Lc.ContainsChangesWorkbookOperations=this.$.userOperationManager.oMa();Lc.isSessionExpired=G;Lc.stopRefreshRetriesUntilTokenExpired=this.Tjb;Lc.FailedToRefreshExpiredToken=this.$H;Lc.numOfFailuresWhileUserIsActive=Zg.a.d$;Lc.numOfFailuresWhileUserIsInActive=Zg.a.e$;
Lc.numOfFailuresWhileOffline=Zg.a.vCa;Lc.RefreshAccessTokenCorrelationID=this.context.correlationID;kb&&pa&&(Lc.TimeInMinFromPreviosContextCreation=Math.round(jb.b(Ud.a.Jd,pa)/60));pa=ef.a.ff(Lc);X.ULS.sendTraceTag(40416199,0,50,pa);this.ESd.start();this.Ple=Zb.Uh.Ps;this.FF=new ag.a;this.hRi(G);var Bd=this.G6d.eyj(!G,this.FF?this.FF.token:null);Bd.continueWith(()=>{this.Fhh();const he=this.G6d.Frj(Bd);this.ESd.stop();const Ie=this.Vlc();if(!he||Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&
Ie){const ff=Bd.result.errors;he&&Ie&&this.TVg(ff);this.ypi(ff,G)}else this.Tjb=!1,this.Epi(Bd.result.tokens,G);this.Uqb=!1},8)}}TVg(G){const pa=[Object(Fd.a)(new Zh,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];G.add(Object(Fd.a)(new di,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:pa}))}hRi(G){G&&(this.$.ea.Uh.Ps?this.Amg():(this.$.ea.Uh.kwa(this.UMd),this.BPb=!0))}Amg(){this.WAc=Cg.AsyncMethodContext.nu(()=>{this.dyj()},1E3*this.X2f,Yc.a.Hxj,this.WAc)}Fhh(){this.WAc&&
this.WAc.cancel();this.BPb&&(this.$.ea.Uh.aEa(this.UMd),this.BPb=!1);this.FF=null}dyj(){X.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.X2f}]`);this.FF.cancel()}ypi(G,pa){this.Tjb=!0;pa&&(this.$H||(this.asb=this.$H=!0),this.G6d.wHb(G)&&(this.rme=!0));const kb=!pa||this.ljb&&!Zg.a.wGc?40380379:39982555;pa=this.MQe(pa);pa.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";pa.FailedToRefreshExpiredToken=
this.$H;pa.LastErrorIsPermanent=this.G9;if(0<G.count){var Zb=G.ka(0);pa.errorName=Zb.Name;0<Zb.Errors.length&&(pa.ErrorId=Zb.Errors[0].Id,Zb=Zb.Errors[0].Details,pa.ErrorDetails=this.nDh(Zb.toString())?"PiiScrubbed":Zb)}pa=ef.a.ff(pa);X.ULS.sendTraceTag(kb,0,15,pa);this.Xa.raiseEvent("TokenRefreshed",new Uh(null,G))}nDh(G){return tc.a.contains(G,"makes the internet safe for businesses",!0)}MQe(G){const pa={},kb=this.$.ea;pa.Name="";pa.IsUserActive=kb.Uh.Ps;pa.IsSessionActive=kb.Ee;pa.GotDeploymentOrTimedOutError=
kb.D2;pa.TimeInSecFromLastStatefulSuccessfulRequest=kb.x_;pa.TimeFromLastUserActivityInMs=kb.Uh.ukb;pa.calledFromSessionExpiredFlow=G;pa.RefreshTokenDurationInMS=this.ESd.pf;pa.numOfFailuresWhileUserIsActive=Zg.a.d$;pa.numOfFailuresWhileUserIsInActive=Zg.a.e$;pa.numOfFailuresWhileOffline=Zg.a.vCa;pa.RefreshAccessTokenCorrelationID=this.context.correlationID;pa.accessTokenTTL=va.AFrameworkApplication.accessTokenTtl;pa.ContainsChangesWorkbookOperations=this.$.userOperationManager.oMa();pa.IsDocumentHidden=
this.documentVisibilityObserver?this.documentVisibilityObserver.Cj.toString():"Unknown";pa.TimeFromFirstOpenInHr=Math.floor(jb.b(Ud.a.Jd,be.toUtc(kb.jWf))/3600);return pa}Epi(G,pa){this.$H=!1;this.ynk();this.pwg(new Date,va.AFrameworkApplication.accessTokenTtl);const kb=this.$.ea,Zb=!pa&&kb.Uh.Ps,Lc=!this.$.isEditMode&&kb.Ogb;pa=this.MQe(pa);pa.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";pa.shouldTriggerSilentReloadAfterExpiring=Zb;pa.WopiTokenTaskItemPriority=va.AFrameworkApplication.yae;
pa.isDirtyViewSession=Lc;pa=ef.a.ff(pa);X.ULS.sendTraceTag(39982556,0,15,pa);this.Xa.raiseEvent("TokenRefreshed",new Uh(G,null));Lc?kb.Uh.Ps&&(X.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),kb.Vld()):kb.Uh.Ps?Zb&&(G=Pb.a(this.$).Pf.activityState,G[Zg.a.Rkb]=!0,G[Yg.a.N0]=!0,G[Ng.a.Wu]=this.$.isEditMode,lc.a(this.$).Ts(new wf.a(ub.a.Rra,2,null))):kb.Ee&&Ob.j(this.$.qa.ua,
!0,!1,!1,null,null,null,null,null)}ynk(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=Zf.a.LS(this.$.ea.workbookContext.WorkbookUri,va.AFrameworkApplication.tP,va.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=Zf.a.LS(this.$.ea.workbookContext.WorkbookUri,va.AFrameworkApplication.GS,va.AFrameworkApplication.accessTokenTtl.toString()),this.$.ea.fyc()):X.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");
this.$.xa.AccessToken=va.AFrameworkApplication.accessToken;this.$.xa.AccessTokenValidTo=va.AFrameworkApplication.accessTokenTtl;void 0!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=Zf.a.LS(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,va.AFrameworkApplication.tP,va.AFrameworkApplication.accessToken),this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion=
Zf.a.LS(this.$.xa.DocumentHostInfo.QuerySignatureWithoutVersion,va.AFrameworkApplication.GS,va.AFrameworkApplication.accessTokenTtl.toString()));void 0!==this.$.xa.EmbedConfiguratorUrl&&null!==this.$.xa.EmbedConfiguratorUrl&&(this.$.xa.EmbedConfiguratorUrl=Zf.a.LS(this.$.xa.EmbedConfiguratorUrl,va.AFrameworkApplication.tP,va.AFrameworkApplication.accessToken),this.$.xa.EmbedConfiguratorUrl=Zf.a.LS(this.$.xa.EmbedConfiguratorUrl,va.AFrameworkApplication.GS,va.AFrameworkApplication.accessTokenTtl.toString()));
this.context.tPb=!0}}Object(Fa.a)(Wi,"EwaAccessTokenExpirationRefreshManager",null,[327,328,5]);class qg{}qg.z5b="ActivityDuration";qg.error="Error";qg.wid="Errors";qg.failed="Failed";qg.kWh="FirstActivity";qg.initialized="Initialized";qg.uPi="LastActivity";qg.W9f="RetryOverride";qg.THj="RequestGroups";qg.requests="Requests";qg.C9f="Responses";qg.OEc="SessionDuration";qg.status="Status";qg.success="Success";qg.successful="Successful";qg.tokens="Tokens";Object(Fa.a)(qg,"SessionExpirationStrings",null,
[]);class wh{constructor(G){this.Er={};this.U_={};this.FOg={};this.SBf=15;this.Ile=!1;this.nQg=new Date;this.V0b=new Date;this.uzg=()=>{X.ULS.sendTraceTag(41964821,217,50,X.ULS.ff({["Aggregate"]:this.U_,["Current"]:this.Er}))};this.Bg=G;this.s4b=new sh.a(2,2,6E4*this.SBf,this.uzg,135,"SL",!1);this.Bg.Xh(this.s4b);this.Yxi()}Yxi(){this.U_[qg.THj]=0;this.U_[qg.requests]=0;this.U_[qg.C9f]=0;this.U_[qg.status]=qg.initialized;this.U_[qg.kWh]=new Date;this.U_[qg.OEc]=0;this.U_[qg.z5b]=0;this.U_[qg.OEc]=
0;this.Er[qg.OEc]=0;this.U_[qg.z5b]=0;this.Er[qg.z5b]=0}Nvd(G,pa){var kb=G[pa];kb=kb?kb:0;kb++;G[pa]=kb;this.s_d(G)}s_d(G){const pa=new Date;G[qg.z5b]=+pa-+this.V0b;this.V0b=pa;G[qg.OEc]=+this.V0b-+this.nQg;G[qg.uPi]=this.V0b}P4(G,pa){this.Er[G]=pa;this.s_d(this.Er)}TZd(G,pa){this.Er[G]=pa;this.s_d(this.Er)}incrementCounter(G){this.Nvd(this.Er,G);this.Nvd(this.U_,G);this.Nvd(this.FOg,G)}flush(){this.Ile||(this.U_[qg.status]=this.Er[qg.status],this.uzg(this.s4b),this.Bg.vra(this.s4b,6E4*this.SBf))}stop(){X.ULS.sendTraceTag(41964822,
217,100,"Stopping logger. Flushing one last time");this.flush();this.Ile=!0;this.Bg.Rr(this.s4b)}}Object(Fa.a)(wh,"SessionLogger",null,[343]);var ii=a(474),vj=a(996),wi=a(177),mh=a(116);class Ri{constructor(G,pa,kb,Zb,Lc,Bd,he,Ie,ff,qf,eg){Zb=void 0===Zb?null:Zb;Lc=void 0===Lc?!1:Lc;Bd=void 0===Bd?null:Bd;he=void 0===he?!1:he;Ie=void 0===Ie?!1:Ie;ff=void 0===ff?!1:ff;qf=void 0===qf?!1:qf;eg=void 0===eg?!1:eg;this.nca=0;this.s6=this.tl=null;this.E4b=new sa.a;this.EJ=new sa.a;this.Ym=null;this.B0a=
!1;this.csb=this.dsb=null;this.dIj=()=>{this.t8f()};this.Bg=G;this.Lqe=pa;this.Lqe.execute(dh=>{dh.tm(eh.a.Wud,Object(Gb.a)(this,this.fbj,"onHostResponseReceived"))});this.TJ=kb;this.rve=new vj.a("WebServiceCall","TokenRefresh");this.Km=Zb||new wh(G);this.iQg=Lc;this.JW=Bd?Bd:Rh.SessionStatusManager.instance;this.nhe=he;this.j_b=Ie;this.uQg=ff;this.vQg=qf;this.Hte=eg}fbj(G){if(G.MessageId!==eh.a.Wud)mh.a(39408099,306,15,"Unexpected message.");else{var pa=new sa.a,kb=new sa.a;this.Km.incrementCounter(qg.C9f);
var Zb=G.Values[Pf.a.odg];if(!Zb||0>=Zb.length)mh.a(40122317,306,15,"Found no tokens in the dictionary"),Zb=G.Values;mh.a(40122318,306,100,"The Tokens array contains {0} tokens",Zb.length);this.Km.P4("Correlation",G.CorrelationId);var Lc="";for(let Ie=0;Ie<Zb.length;Ie++){this.Km.TZd(qg.tokens,Zb.length);var Bd=Zb[Ie],he=Bd;if(!he||!he.Name)continue;this.Km.incrementCounter(he.Name);const ff=Bd;if(ff&&ff.Value)mh.a(39408128,306,100,"Received token with name: {0}",ff.Name),pa.add(ff),this.E4b.add(ff),
this.j_b||this.Km.P4(qg.status,qg.success),this.nhe&&this.JW&&this.JW.TIj();else if(Bd=this.Pgi(Bd),mh.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",he.Name,JSON.stringify(Bd),this.s6),kb.add(Bd),this.j_b||(this.EJ.add(Bd),Lc=JSON.stringify(Bd),this.Km.P4(qg.error,JSON.stringify(Bd)),this.Km.P4(qg.status,qg.failed)),this.nhe)for(const qf of Bd.Errors)he=this.P7h(qf),this.JW&&this.JW.lYg(he)}this.j_b?(0<kb.count?this.csb?this.csb(new Uh(pa,kb)):mh.a(512267295,
306,15,"Received errors but the promise has completed"):this.dsb?this.dsb(new Uh(pa,kb)):mh.a(512267294,306,15,"Received valid tokens but the promise has completed"),mh.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",pa.count,kb.count,G.CorrelationId,this.s6)):(0<kb.count&&""!==Lc?(Zb=Object.assign(new wi.a,{extendedProperties:new Map}),Zb.extendedProperties.set("Errors",Lc),Zb.extendedProperties.set("RetryCount",this.nca.toString()),Zb.extendedProperties.set("NavigatorOnline",
window.navigator.onLine.toString()),Zb.extendedProperties.set("IsTokenExpiring",this.B0a.toString()),this.TAd()&&Zb.extendedProperties.set("IsAppShuttingDown",va.AFrameworkApplication.ij.toString()),uf.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Zb)):uf.Health.instance.recordKpiSuccess("WACTokenRefresh",null),mh.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",pa.count,kb.count,G.CorrelationId,this.s6),0<kb.count&&
!this.wHb(kb)?(G=this.TJ.qff(kb),G!==this.TJ.Vhb&&(this.Km.TZd(qg.W9f,G),this.Bg.vra(this.tl,G))):(this.Km.flush(),this.tl&&(mh.a(39408131,306,100,"Deleting task {0} from task manager",this.tl.name),this.Bg.Rr(this.tl)),this.Ym&&!this.Ym.task.isCompleted?this.Ym.setResult(new Uh(pa,kb)):mh.a(512267293,306,15,"Received results but the task has completed")))}}Pgi(G){if(!G)return null;const pa=Object.assign(new di,{Name:G.Name,Errors:[]});for(const kb of G.Errors)G=new Zh,G.Id=kb.Id,G.Details=ii.a.vPa(kb.Details,
500),pa.Errors.push(G);return pa}t8f(){va.AFrameworkApplication.PN("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.nca>=this.TJ.CFf?(mh.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.s6),this.RQe(this.Ym,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(uf.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Acg())}Acg(){const G={};G[Pf.a.odg]=this.TJ.tokens;
this.uQg&&(G[Pf.a.ZQj]=this.vQg);const pa=ug.a.create().toString();mh.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.TJ.tokens),this.nca+1,pa,this.s6);this.Lqe.execute(kb=>{kb.sendMessage(eh.a.lDe,G,pa)});this.nca++;this.Km.incrementCounter(qg.requests)}RQe(G,pa,kb){const Zb=new sa.a;for(let Lc=0;Lc<this.TJ.tokens.length;Lc++){const Bd=Object.assign(new di,{Name:this.TJ.tokens[Lc],Errors:[Object.assign(new Zh,{Id:pa,Details:kb})]});Zb.add(Bd);
this.EJ.add(Bd)}this.Bg.Rr(this.tl);this.Km.P4(qg.wid,JSON.stringify(this.EJ));this.Km.P4(qg.status,qg.failed);G&&!G.task.isCompleted&&G.setResult(new Uh(new sa.a,this.EJ))}TAd(){return va.AFrameworkApplication.da&&va.AFrameworkApplication.da.isChangeGateEnabled("SkipSessionExpiredVetoForShutdown")}eyj(G,pa){pa=void 0===pa?null:pa;va.AFrameworkApplication.PN("ej4if276;fheca743");va.AFrameworkApplication.PN("5d4fi128;abe10395");this.rve.start();this.TAd()&&this.Bg.TPa&&(mh.a(508351137,306,15,"Restarting taskmanager, is shutting down {0}",
va.AFrameworkApplication.ij),this.Bg.VQb());this.B0a=G;this.s6=ug.a.create().toString();mh.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.s6,this.B0a);this.nca=0;this.EJ.clear();this.E4b.clear();const kb=new Wc.a;this.Ym=kb;pa&&pa.R(()=>{const Zb=!!kb&&!kb.task.isCompleted;mh.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.s6,this.B0a,Zb);Zb&&this.RQe(kb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});
this.j_b?this.u8f(this.TJ.CFf).then(Zb=>{this.Ym&&!this.Ym.task.isCompleted&&this.Ym.setResult(Zb);this.csb=this.dsb=null;this.Km.P4(qg.wid,JSON.stringify(this.EJ));this.Km.P4(qg.status,qg.success);this.Km.flush()}).catch(Zb=>{this.Ym&&!this.Ym.task.isCompleted&&this.Ym.setResult(Object(db.a)(325,Zb));this.csb=this.dsb=null;this.Km.P4(qg.wid,JSON.stringify(this.EJ));this.Km.P4(qg.status,qg.failed);this.Km.flush()}):(this.tl=new sh.a(this.TJ.priority,2,this.TJ.Vhb,this.dIj,98,eh.a.lDe,!0),this.iQg&&
this.t8f(),this.Bg.Xh(this.tl));return this.Ym.task}u8f(G){const pa=this,kb=new Promise((Ie,ff)=>{pa.dsb=Ie;pa.csb=ff;uf.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);pa.Acg()}),Zb=this,Lc=new Promise((Ie,ff)=>{window.setTimeout(()=>{ff(Zb.WQe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},Zb.TJ.Vhb)});let Bd=G;const he=this;return new Promise((Ie,ff)=>{Bd--;Promise.race([kb,Lc]).then(qf=>{uf.Health.instance.recordKpiSuccess("WACTokenRefresh",
null);Ie(qf)}).catch(qf=>{var eg=he.TJ.Vhb;if(Object(Jd.a)(325,qf)&&(qf=Object(db.a)(325,qf),0<qf.errors.count)){he.DTi(qf.errors);he.rt(qf.errors);if(he.wHb(qf.errors)){ff(qf);return}const dh=he.TJ.qff(qf.errors);dh!==he.TJ.Vhb?(he.Km.TZd(qg.W9f,dh),eg=dh):he.TMi(qf.errors)&&(eg=0)}Bd?window.setTimeout(()=>{he.u8f(Bd).then(Ie).catch(ff)},eg):(eg=he.WQe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),he.rt(eg.errors),ff(eg),mh.a(512267292,
306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",he.s6))})})}rt(G){for(const pa of G)this.EJ.add(pa)}TMi(G){if(!G.count)return!1;G=G.ka(G.count-1);return G.Errors.length?"TIMEOUT"==G.Errors[0].Id:!1}WQe(G,pa){const kb=new sa.a;for(let Zb=0;Zb<this.TJ.tokens.length;Zb++){const Lc=this.Rqh(this.TJ.tokens[Zb],G,pa);kb.add(Lc)}return new Uh(new sa.a,kb)}Rqh(G,pa,kb){return Object.assign(new di,{Name:G,Errors:[Object.assign(new Zh,{Id:pa,Details:kb})]})}DTi(G){if(G.count){G=G.ka(G.count-
1);G=JSON.stringify(G);var pa=Object.assign(new wi.a,{extendedProperties:new Map});pa.extendedProperties.set("Errors",G);pa.extendedProperties.set("RetryCount",this.nca.toString());pa.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());pa.extendedProperties.set("IsTokenExpiring",this.B0a.toString());this.TAd()&&pa.extendedProperties.set("IsAppShuttingDown",va.AFrameworkApplication.ij.toString());uf.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,
!1,pa);this.Km.P4(qg.error,G);this.Km.P4(qg.status,qg.failed)}}Frj(G){this.rve.stop();const pa=this.Tqi(G.result.errors);X.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!pa,this.s6,this.B0a,this.nca,this.EJ.count,0<G.result.errors.count?G.result.errors.ka(0).Name:"",0<G.result.errors.count&&0<G.result.errors.ka(0).Errors.length?G.result.errors.ka(0).Errors[0].Id:
"",0<G.result.errors.count&&0<G.result.errors.ka(0).Errors.length?G.result.errors.ka(0).Errors[0].Details:"");return pa?!1:this.Erj(G.result.tokens)}wHb(G){return this.TJ.wHb(G)}Erj(G){for(let pa=0;pa<G.count;pa++){const kb=G.ka(pa);if(kb.Name===Pf.a.accessToken){const Zb=(new Date).getTime();kb.Expiry>va.AFrameworkApplication.accessTokenTtl?(X.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:kb.Expiry,["NowGetTime"]:Zb,["BootTime"]:va.AFrameworkApplication.g1},"PreviousAccessTokenTtl",
va.AFrameworkApplication.accessTokenTtl),va.AFrameworkApplication.accessToken=kb.Value,va.AFrameworkApplication.accessTokenTtl=Math.floor(kb.Expiry),va.AFrameworkApplication.xae=Zb,va.AFrameworkApplication.s2a=Math.floor(kb.Expiry)):X.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:kb.Expiry,["NowGetTime"]:Zb,["BootTime"]:va.AFrameworkApplication.g1},"PreviousAccessTokenTtl",va.AFrameworkApplication.accessTokenTtl)}}return!0}Tqi(G){let pa=
!1;for(let kb=0;kb<G.count;kb++){pa=!0;const Zb=G.ka(kb);X.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Zb.Name,JSON.stringify(Zb.Errors),this.s6)}return pa}axf(G){return G.includes("aadInteractionRequired")||G.includes("sessionRevocation")||G.includes("blockAccessForTenantRestrictions")||G.includes("revoked")||G.includes("Due to organizational policies, you can't access these resources from this network location")?!0:!1}P7h(G){let pa=Qe.a.NEc;const kb=
parseInt(G.Id);G=G.Details.toString();if(isNaN(kb))pa=Qe.a.hsk;else{switch(kb){case 401:pa=Qe.a.ksk;this.Hte&&this.axf(G)&&(pa=Qe.a.hzg);break;case 403:pa=Qe.a.fsk;this.Hte&&this.axf(G)&&(pa=Qe.a.hzg);break;case 500:pa=Qe.a.gsk;break;case 503:pa=Qe.a.jsk}pa===Qe.a.NEc&&(pa=500<kb?Qe.a.isk:Qe.a.esk)}return pa}}Object(Fa.a)(Ri,"TokenRefreshManager",null,[326]);class Kg{constructor(){this.Vhb=va.AFrameworkApplication.nsk;this.CFf=va.AFrameworkApplication.lsk;this.tokens=va.AFrameworkApplication.$li();
this.priority=va.AFrameworkApplication.yae;this.Xre=this.KVj();this.Y1c=va.AFrameworkApplication.Zli()}wHb(G){G=JSON.stringify(G);if(this.Y1c&&0<this.Y1c.length)for(const pa of this.Y1c)if(0<pa.length&&0<=G.indexOf(pa))return!0;return!1}qff(G){try{if(G)for(const pa of G)if(pa.Errors)for(const kb of pa.Errors)if(kb.Id in this.Xre)return Number.parseInvariant(this.Xre[kb.Id].toString())}catch(pa){X.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",pa.toString())}return this.Vhb}KVj(){const G=
{};try{if(!va.AFrameworkApplication.clc()||0>=va.AFrameworkApplication.clc().length||""===va.AFrameworkApplication.clc()[0])return G;for(const pa of va.AFrameworkApplication.clc())0<pa.length&&(G[pa]=va.AFrameworkApplication.msk)}catch(pa){X.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",pa.toString())}return G}}Object(Fa.a)(Kg,"TokenRefreshPolicy",null,[324]);class Ui extends pb.a{constructor(G){super();this.$=G;this.Oe()}create(){va.AFrameworkApplication.da.na("RefreshAccessTokenSilently")?
this.ve(this.Wqh()):this.ve(this.$.ia.Ja(38)||this.$.ia.Va(38,new de(this.$)))}Wqh(){var G=this.$.ia.Ja(38);if(G)return G;G=new Ri(va.AFrameworkApplication.Pj,va.AFrameworkApplication.xN(),new Kg);return this.$.ia.Va(38,new Wi(this.$,G))}static la(G){G.ia.Va(39,new Ui(G))}}Object(Fa.a)(Ui,"AccessTokenExpirationManagerFactory",pb.a,[]);var pi=a(1116),ci;(function(G){G[G.generalException=0]="generalException";G[G.invalidArgument=1]="invalidArgument";G[G.oIf=2]="notAllowed";G[G.G7b=3]="apiNotAvailable";
G[G.$ik=4]="unresolvedPendingRequest";G[G.timeout=5]="timeout";G[G.e3c=6]="adalTimeout";G[G.c$d=7]="userNotSignedIn";G[G.Alb=8]="userAborted";G[G.jlg=9]="silentSignInFailed";G[G.hab=10]="invalidResourceUrl";G[G.Inc=11]="invalidGrant";G[G.EOe=12]="connectionLost";G[G.Y$b=13]="clientError";G[G.serverError=14]="serverError"})(ci||(ci={}));Object(Fa.b)("ErrorCodes",ci);a(1238);class jg{constructor(G,pa){this.requestCallback=this.requestParameters=null;this.requestParameters=G;this.requestCallback=pa}}
Object(Fa.a)(jg,"OutstandingRequest",null,[]);class Fh{}Fh.T1i="AADSTS50058";Fh.hab="AADSTS50001";Fh.M1i="AADSTS65001";Fh.e2i="AADSTS70011";Fh.Alb="13002";Fh.woj="Popup Window is null";Fh.voj="Popup Window closed";Fh.e3c="Token renewal operation failed due to timeout";Fh.Edk="tokenRevoked";Object(Fa.a)(Fh,"WopiHostErrorType",null,[]);var xi=a(527),Sh=a(583),Ai=a(1237);class qi{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(Fa.a)(qi,
"WopiIdentityInfo",null,[336]);class yh{constructor(G,pa,kb){this.expiration=this.authority=this.accessToken=null;this.accessToken=G;this.authority=pa;this.expiration=kb}}Object(Fa.a)(yh,"WopiIdentityToken",null,[335]);var li=a(178),Ph=a(71),mi=a(355);class Yi{constructor(G){this._initialized=!1;this.Jej=pa=>{let kb=null;try{const Lc=pa.Values[Pf.a.T3d],Bd=pa.Values[Pf.a.p7j],he=pa.Values[Pf.a.cmg],Ie=pa.Values[Pf.a.x7j];let ff=null,qf=null;const eg=this.qfb[Lc];if("undefined"!==typeof eg&&eg){var Zb=
[];Array.add(Zb,Object.assign(new Ph.a,{name:Pf.a.S3d,string:eg.requestParameters.correlationId}));li.a.sendTelemetryEvent(Object.assign(new mi.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:Zb}));kb=eg.requestCallback;delete this.qfb[Lc];"undefined"!==typeof Bd&&Bd&&Bd.length?qf=new yh(Bd,he,Ie):ff=ci[this.PXi(pa)];Zb="getAccessToken_"+Lc;Zb in this.mIc&&(this.mIc[Zb].stop(),delete this.mIc[Zb]);kb(qf,ff)}else X.ULS.sendTraceTag(37856066,344,10,ba.c({["error"]:"No matching outstanding request for request ID.",
["requestId"]:Lc}))}catch(Lc){pa=pa.Values[Pf.a.T3d],pa in this.qfb&&delete this.qfb[pa],this.ltc(),X.ULS.sendTraceTag(37856067,344,10,ba.c({["error"]:Lc.message,["stack"]:Lc.stack})),kb&&kb(null,"generalException")}};this.qfb={};this.mIc={};this.JR=va.AFrameworkApplication.sa.XE;this.Uud=G}v7a(G){this._initialized||(G.yn(eh.a.gYf),G.tm(eh.a.gYf,this.Jej),this._initialized=!0)}getAccessToken(G,pa,kb){kb=void 0===kb?null:kb;this.BSa(G,pa);return new Promise((Zb,Lc)=>{if(this.kxd(pa))if(pa in this.qfb)Lc("unresolvedPendingRequest");
else{var Bd=window.setTimeout(()=>{X.ULS.sendTraceTag(37856032,344,10,ba.c({["error"]:"Request timeout.",["callerId"]:pa}));Lc("timeout")},12E4);this.Wmd(G,pa,kb,(he,Ie)=>{window.clearTimeout(Bd);he?Zb(he):(X.ULS.sendTraceTag(37856033,369,15,ba.c({["error"]:ci[Ie]})),Lc(Ie))})}else X.ULS.sendTraceTag(37856034,344,10,ba.c({["error"]:"Caller is not allowed."})),Lc("notAllowed")})}getPrimaryIdentityInfo(G){return new Promise((pa,kb)=>{this.kxd(G)?this.wei((Zb,Lc)=>{Zb?pa(Zb):(X.ULS.sendTraceTag(37856064,
369,10,ba.c({["error"]:Lc.toString()})),kb(Lc))}):(X.ULS.sendTraceTag(37856065,344,10,ba.c({["error"]:"Caller is not allowed."})),kb("notAllowed"))})}getAuthContext(G){return new Promise((pa,kb)=>{const Zb=this.getAuthContextSync(G);Zb?pa(Zb):kb("notAllowed")})}getAuthContextSync(G){if(this.kxd(G)){const pa=new Ai.a;pa.upn=va.AFrameworkApplication.da.Ra("UserPrincipalName");pa.userId=va.AFrameworkApplication.da.Ra("LoggableUserId");pa.authority=va.AFrameworkApplication.da.Ra("HostAuthAuthority");
pa.tenantId=va.AFrameworkApplication.da.Ra("TenantId");pa.isAnonymous=va.AFrameworkApplication.da.na("IsAnonymousUser");pa.supportsAuthToken=this.Ati(G);G=va.AFrameworkApplication.da.Ra("HostAuthType");pa.authorityType="aad"===G.toLowerCase()?2:"msa"===G.toLowerCase()?1:0;return pa}X.ULS.sendTraceTag(40751647,344,10,ba.c({["error"]:"Caller is not allowed."}));return null}Ati(G){const pa=xi.a.GEb;return Za.a.rBa?pa&&xi.a.$og?Array.contains(xi.a.$og,G.toLowerCase()):!1:pa}Wmd(G,pa,kb,Zb){var Lc=[];
Array.add(Lc,Object.assign(new Ph.a,{name:"CallerId",string:pa}));Array.add(Lc,Object.assign(new Ph.a,{name:Pf.a.S3d,string:G.correlationId}));li.a.sendTelemetryEvent(Object.assign(new mi.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Lc}));Lc=Sh.a.create().toString();const Bd="getAccessToken_"+Lc,he=this.JR.xf("ComponentAttach",Bd);this.mIc[Bd]=he;const Ie={};Ie[Pf.a.T3d]=Lc;Ie[Pf.a.u7j]=G.resource;Ie[Pf.a.v7j]=G.scope;Ie[Pf.a.cmg]=va.AFrameworkApplication.da.Ra("HostAuthType");
Ie[Pf.a.y7j]=va.AFrameworkApplication.da.Ra("UserPrincipalName");Ie[Pf.a.w7j]=G.silentLogin;Ie[Pf.a.r7j]=G.options;Ie[Pf.a.S3d]=G.correlationId;Ie[Pf.a.s7j]=pa;kb&&(Ie[Pf.a.addinName]=kb.AddinName,Ie[Pf.a.q7j]=kb.AddinTrustId);this.Uud.execute(ff=>{this.v7a(ff);ff.sendMessage(eh.a.getAuthToken,Ie)});this.qfb[Lc]=new jg(G,Zb)}wei(G){const pa=va.AFrameworkApplication.da.Ra("UserName"),kb=va.AFrameworkApplication.da.Ra("UserPrincipalName"),Zb=va.AFrameworkApplication.da.Ra("LoggableUserIdSpace"),Lc=
new qi;Lc.email=kb;Lc.displayName=pa;switch(Zb){case "OrgIdPuid":Lc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Lc.authority="MicrosoftAccount";break;default:Lc.authority=Zb}G(Lc,null)}kxd(G){var pa=va.AFrameworkApplication.Yli();G=G.toLowerCase();for(const kb of pa)if(G===kb.toLowerCase())return!0;pa=xi.a.K5c;for(const kb in pa)if(G===pa[kb].toLowerCase())return!0;return!1}PXi(G){G=G.Values[Pf.a.t7j];this.ltc();X.ULS.sendTraceTag(39068821,344,15,ba.c({["error"]:G}));
return G?-1<G.indexOf(Fh.T1i)?9:-1<G.indexOf(Fh.woj)||-1<G.indexOf(Fh.voj)?12:-1<G.indexOf(Fh.hab)?10:-1<G.indexOf(Fh.Alb)?8:-1<G.indexOf(Fh.e2i)||-1<G.indexOf(Fh.M1i)||G===Fh.Edk?11:-1<G.indexOf(Fh.e3c)?6:0:13}BSa(G,pa){G=this.Fxj(G.resource);X.ULS.sendTraceTag(39921882,344,50,ba.c({["callerId"]:pa,["resource"]:G}))}ltc(){X.ULS.sendTraceTag(39068822,344,50,ba.c({["userAgent"]:window.navigator.userAgent}))}Fxj(G){return(G?G:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}
Object(Fa.a)(Yi,"WopiIdentityManager",null,[318]);class pj{constructor(){this.Fd=null;this.xE=()=>{try{this.Fd.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(G){X.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+G)}}}get name(){return"Common.App.WopiIdentity"}nk(G){this.Fd=G;G.register(Yi,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Ve().$e(()=>new Yi(G.ie("Postmessage.IHostPostmessenger")))}init(){va.AFrameworkApplication.da&&
va.AFrameworkApplication.da.Jw(this.xE)}dispose(){}static main(){Db.a.instance.$k(new pj)}}Object(Fa.a)(pj,"WopiIdentityPackage",null,[3,4]);var Aj=a(1257),Bj=a(1117);class Cj{constructor(G,pa,kb,Zb,Lc){this.dTc=this.PIa=null;this.f0a=this.WNc=!1;this.H3f=()=>{const Bd=document.getElementById(va.AFrameworkApplication.Q7b);!this.f0a&&this.vS&&Bd&&(this.vS.va(Lf.a.mCa,Bd,this.RHd,null),this.f0a=!0);this.WXc(()=>{this.dispose()})};this.RHd=()=>{this.f0a&&(this.vS.Ca(Lf.a.mCa,document.getElementById(va.AFrameworkApplication.Q7b),
this.RHd),this.f0a=!1);this.zxe();return!1};this.dSb=()=>{this.WNc&&(this.Aua.CWR(()=>this.Aua.result.sendMessage(eh.a.pok,null)),X.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.WNc=!1)};this.Bg=pa;this.L1b=G;this.Aua=kb;this.vS=Zb;this.WXc=Lc;this.H3f(null)}zxe(){this.WNc=!0;this.dTc||(this.dTc=new sh.a(3,2,this.L1b,this.H3f,112),this.Bg.Xh(this.dTc));this.PIa||(this.dSb(null),this.PIa=new sh.a(3,2,this.L1b,this.dSb,111),this.Bg.Xh(this.PIa))}dispose(){this.f0a&&
(this.vS.Ca(Lf.a.mCa,document.getElementById(va.AFrameworkApplication.Q7b),this.RHd),this.f0a=!1)}}Object(Fa.a)(Cj,"UserActivityHostNotificationManager",null,[316,5]);class ih{constructor(){this.Fd=null;this.xE=()=>{ih.editNotificationIsEnabled&&0<ih.jhd&&(this.Fd.register(Aj.a,"Common.App.HostNotification.EditNotificationEventSource").Ve(),this.Fd.register(Cj,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").Ve().$e(()=>
new Cj(6E4,ji.a.instance,Xg.a.Ar(this.Fd.ie("Postmessage.IHostPostmessenger")),Vh.a.instance,va.AFrameworkApplication.Xjb)),this.Fd.register(Bj.a,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").Ve().$e(()=>new Bj.a(ih.jhd,ji.a.instance,Xg.a.Ar(this.Fd.ie("Postmessage.IHostPostmessenger")),this.Fd.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.Fd.Ii("Common.Interface.IUserActivityHostNotificationManager"),ih.editNotificationPostMessageIsEnabled,
ih.wEh)),this.Fd.resolve("Common.Interface.IEditNotificationManager"),X.ULS.shipAssertTag(38086291,209,0<ih.jhd,"EditNotification Interval is less than or equal to 0."))}}get name(){return"Common.App.EditNotification"}init(){va.AFrameworkApplication.da&&va.AFrameworkApplication.da.Jw(this.xE)}nk(G){this.Fd=G}dispose(){}static get jhd(){return va.AFrameworkApplication.da?parseInt(va.AFrameworkApplication.da.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get wEh(){return va.AFrameworkApplication.da?
parseInt(va.AFrameworkApplication.da.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get editNotificationIsEnabled(){return!!va.AFrameworkApplication.da&&va.AFrameworkApplication.da.na("EditNotificationIsEnabled")}static get editNotificationPostMessageIsEnabled(){return!!va.AFrameworkApplication.da&&va.AFrameworkApplication.da.na("EditNotificationPostMessageIsEnabled")}static main(){Db.a.instance.$k(new ih)}}Object(Fa.a)(ih,"CommonHostNotificationPackage",
null,[3,4]);class Mh{constructor(G,pa,kb){this.uJa=null;this.QTb=()=>{this.uJa=null;X.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.eie.display()};this.U2j=(Zb,Lc,Bd,he,Ie)=>Zb!==cb.a.QTb?2:1===Bd?32:2===Bd&&Ie?(X.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",Ie),Ie?this.U3f():(this.uJa?(X.ULS.sendTraceTag(23674914,207,50,"Hide float pane via removing show task!"),this.Bg.Rr(this.uJa)):(X.ULS.sendTraceTag(23674915,
207,50,"Hide float pane immediately!"),this.eie.remove(null)),this.uJa=null),32):8;this.Bg=G;this.Na=pa;this.eie=kb.create()}U3f(){this.uJa?X.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(X.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),this.uJa=new sh.a(2,1,3E4,this.QTb,67),this.Bg.Xh(this.uJa))}iVa(){this.Na.xe(cb.a.QTb,Ia.a.frame,this.U2j)}}Object(Fa.a)(Mh,"FloatPaneActor",null,[320]);var mj=a(173),Bi=a(47);class Gj{constructor(G,
pa,kb,Zb,Lc){this.xWc=this.Cob=this.U2b=this.Uja=this.yS=this.Ty=this.sPc=this.lP=this.tqb=this.Bpb=this.Cpb=this.zSc=null;this.wcj=()=>{const Bd=this.Qa.eg("O365AdPaneShowingDuration",60);this.Gbc();this.lP.style.display="block";this.lP.style.height=this.yS.height+"px";this.Cob=new sh.a(2,1,1E3*Bd,Object(Gb.a)(this,this.hide,"hide"),67);this.Bg.Xh(this.Cob);this.Q4f()};this.vcj=()=>{X.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.Q4f();this.yS=
null};this.ORf=()=>{X.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1};this.onClose=()=>{this.Cob&&this.Bg.Rr(this.Cob);this.hide();return!0};this.Bg=pa;this.Qa=G;this.Qo=kb;this.Fd=Lc;this.y5=Zb}Gbc(){this.lP=document.createElement("div");this.lP.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.lP.style.width=this.yS.width+"px";(this.xWc=this.Nci(this.y5))?(this.Uja=document.createElement("a"),this.Uja.setAttribute(Ze.a.pg,
Ze.a.iu),this.Qo.va(Lf.a.click,this.Uja,this.ORf),this.Uja.href=this.xWc,this.Uja.target="_blank",this.Uja.appendChild(this.yS),this.lP.appendChild(this.Uja)):this.lP.appendChild(this.yS);this.Ty=document.createElement("a");this.Ty.setAttribute(Ze.a.pg,Ze.a.xA);this.Ty.className="StandardButton WACFloatPaneCloseButton";this.Ty.title=CommonUIStrings.l_Close;this.Ty.tabIndex=-1;this.sPc=mj.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",
!0,null);this.sPc.setAttribute(Ze.a.pg,Ze.a.iu);this.Ty.appendChild(this.sPc);this.Qo.va(Lf.a.click,this.Ty,this.onClose);this.lP.appendChild(this.Ty);this.tqb.appendChild(this.lP)}A$h(G){const pa=this.Qa.na("O365PromotionHasStarted");switch(G){case 2:return xa.a.dxa(String.format("adppt{0}.png",pa?"sale":""));case 1:return xa.a.dxa(String.format("adxls{0}.png",pa?"sale":""));case 3:return xa.a.dxa(String.format("addoc{0}.png",pa?"sale":""))}return null}Nci(G){const pa=this.Qa.Ra("O365AdPaneRedirectedURL");
switch(G){case 1:return String.format(pa,"Excel");case 2:return String.format(pa,"PowerPoint");case 3:return String.format(pa,"Word")}return null}hide(G){this.Cob=null;this.lP&&!this.U2b&&((void 0===G?0:G)?X.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):X.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.lP.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.lP.style.height="0px",this.U2b=new sh.a(2,1,1E3,Object(Gb.a)(this,
this.remove,"remove"),67),this.Bg.Xh(this.U2b))}remove(){this.lP&&this.tqb&&(this.Uja&&this.Qo.Ca(Lf.a.click,this.Uja,this.ORf),this.Qo.Ca(Lf.a.click,this.Ty,this.onClose),this.tqb.removeChild(this.lP),this.lP=null);this.U2b=null}display(){if(this.zSc=this.Fd.Ii("Common.IFloatPaneContainer"))if(this.tqb=this.zSc.container){var G=this.A$h(this.y5);G?(X.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",G),this.yS=document.createElement("img"),this.yS.className="WACFloatPaneImage",
this.Cpb=this.wcj,Bi.a.addHandler(this.yS,Lf.a.load,this.Cpb),this.Bpb=this.vcj,Bi.a.addHandler(this.yS,Lf.a.error,this.Bpb),this.yS.src=G):X.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else X.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else X.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}Q4f(){this.Cpb&&this.yS&&Bi.a.removeHandler(this.yS,
Lf.a.load,this.Cpb);this.Cpb=null;this.Bpb&&this.yS&&Bi.a.removeHandler(this.yS,Lf.a.error,this.Bpb);this.Bpb=null}dispose(){this.hide()}}Object(Fa.a)(Gj,"FloatPane",null,[333]);class Ni{constructor(G,pa,kb,Zb,Lc){this.Bg=pa;this.Qa=G;this.Qo=kb;this.Fd=Lc;this.y5=Zb}create(){return new Gj(this.Qa,this.Bg,this.Qo,this.y5,this.Fd)}}Object(Fa.a)(Ni,"FloatPaneFactory",null,[317]);class qj{constructor(){this.Fd=null}get name(){return"Common.App.FloatPane"}get tsf(){return va.AFrameworkApplication.da.na("O365AdvertisementIsEnabled")&&
va.AFrameworkApplication.da.na("IsShowAdvertisementPaneEnabled")}init(){this.tsf&&(X.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.Fd.resolve("Common.App.FloatPane.IFloatPaneActor").U3f(),X.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Fd.resolve("Common.App.FloatPane.IFloatPaneActor").iVa())}nk(G){this.Fd=G;this.tsf&&(this.Fd.register(Ni,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").$e(()=>
new Ni(va.AFrameworkApplication.da,va.AFrameworkApplication.Pj,lf.a.instance,va.AFrameworkApplication.sa.Sa.Hj,this.Fd)).Ve(),this.Fd.register(Mh,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").$e(()=>new Mh(va.AFrameworkApplication.Pj,va.AFrameworkApplication.Vd,this.Fd.resolve("Common.App.FloatPane.IFloatPaneFactory"))).Ve())}dispose(){}static main(){Db.a.instance.$k(new qj)}}Object(Fa.a)(qj,"FloatPanePackage",null,[3,4]);var fj=a(944),Dj=a(757);class gj{constructor(G,
pa){this.Tnb=null;this.Lkk=(kb,Zb,Lc,Bd,he)=>{if(1===Lc)return 32;he[fj.a.Value]=this.Tnb;he[Dj.a.zk]=this.Tnb;he[fj.a.Visible]=!0;return 32};this.Na=G;this.Qa=pa}Oj(){(this.Tnb=this.Qa.Ra("StatusBarEnvironmentNameToUse"))&&""!==this.Tnb&&this.Na.uh(cb.a.R_f,Ia.a.frame,this.Lkk,96)}}Object(Fa.a)(gj,"DisplayEnvironmentName",null,[]);class hj{constructor(){this.Fd=null}get name(){return"Common.App.DisplayEnvironmentName"}nk(G){this.Fd=G;this.Fd.register(gj,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Ve().$e(()=>
new gj(va.AFrameworkApplication.Vd,va.AFrameworkApplication.da))}init(){this.Fd.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").Oj()}dispose(){}static main(){Db.a.instance.$k(new hj)}}Object(Fa.a)(hj,"DisplayEnvironmentNamePackage",null,[3,4]);var ij=a(192),Th=a(170);class nj extends ij.a{constructor(G){super();this.VQ=()=>{this.rwd()};this.pga=()=>{this.rwd()};this.$=G}dispose(){this.$&&Th.a(this.$)&&(Th.a(this.$).FVa(this.pga),this.$.ea.q4(this.VQ));this.$=null;super.dispose()}BDh(){va.AFrameworkApplication.Fbb()&&
!this.rwd()&&(Th.a(this.$).mKa(this.pga),this.$.ea.R0(this.VQ))}rwd(){return this.$.isEditMode&&(va.AFrameworkApplication.V6a||Mc.a.Ji.zv)?(Th.a(this.$).FVa(this.pga),Ec.TaskExtensions.Aa(Fc.GetServiceTaskFactory.create(this.$.ia,119,this.ma,1),G=>{G.result.initialize()},this.ma,3),!0):!1}static main(){lb.a.Ia(G=>{(new nj(G)).BDh()})}}Object(Fa.a)(nj,"FileOpSliceDownloaderBootStraper",ij.a,[]);var ph=a(93),Zi=a(468),Hi=a(119);class Ii{constructor(G){this.lY=null;this.NCf=new Set;this.Fwf=!1;this.C3=
(pa,kb)=>{if(!this.NCf.has(pa)){var Zb=[];if(kb){const Lc=Yd.h(this.$).Ud.Di(kb,!1);if(!Lc){1!==kb.top||1!==kb.left||this.Fwf||(Zb.push(Hi.a.Ci("IsTableOnA1","false",1)),Pg.a("MsFormsTableUsage",void 0,void 0,Zb),this.Fwf=!0);return}if(1!==Lc.usedRange.top||1!==Lc.usedRange.left)return}kb=Rb.b().Tl(pa);Zb.push(Hi.a.Ci("Command",kb,2));Pg.a("MsFormsTableUsage",void 0,void 0,Zb);this.NCf.add(pa)}};this.c9d=(pa,kb)=>{if(!this.$.ea.Qj.get(61)||ph.k(this.$.ih))ph.k(this.$.ih)&&kb&&kb.item.name===this.lY.mN&&
this.dGe();else if(this.$.ta.Qm(this.lY.oBb)){const Zb={};Zb.SheetName=this.lY.oBb;Zb.NamedObjectName=this.lY.oBb;Zb.FirstColumn=0;Zb.FirstRow=0;Zb.LastColumn=0;Zb.LastRow=2;const Lc=he=>{if(!ph.k(this.$.ih)){if(null===he||void 0===he?0:he.Result)this.$.workbookContext.MsFormId=he.Result[0][0],this.lY.mN=he.Result[1][0],he=he.Result[2][0],this.AO(!!this.$.workbookContext.MsFormId&&this.yNi(he),1024),this.dGe();ph.c(this.$.ih)&&(kb?X.ULS.sendTraceTag(537155357,0,50,`Created MsForm successfully, Form Id:${Ua.a.hz(this.$.workbookContext.MsFormId).toString()}`):
X.ULS.sendTraceTag(537155356,0,50,`Reopening workbook that is connected to MsForm, Form Id:${Ua.a.hz(this.$.workbookContext.MsFormId).toString()}`));ph.c(this.$.ih)&&!kb&&X.ULS.sendTraceTag(537155355,0,50,`reopening workbook that is connected to MsForm, Form Id:${Ua.a.hz(this.$.workbookContext.MsFormId).toString()}`);!ph.c(this.$.ih)&&kb||this.AO(!0,2048)}},Bd=this.$.qa.ua.ze();this.$.userOperationManager.YH(new ae.a(159,0,(he,Ie,ff)=>Ob.r(this.$.qa.Gz,Zb,!1,$d.b(he,Lc),Ie,ff,null,Bd),16))}else kb||
this.AO(!0,2048)};this.Wcj=(pa,kb)=>{kb&&kb.item.name===this.lY.oBb&&(this.AO(!1,1024),this.AO(!0,2048))};this.$=G}Igk(){this.lY=Zi.a.current;this.c9d(null,null);this.$.ta.Oka(this.c9d);this.$.ta.V0(this.Wcj)}dispose(){this.$.ta.jra(this.c9d)}yNi(G){if(!G)return!0;const pa=RegExp("-","g"),kb=this.$.workbookContext.MsFormDocUrl.toLowerCase();return kb.includes(G.toLowerCase())||kb.includes(G.toLowerCase().replace(pa,""))?!0:!1}dGe(){ph.c(this.$.ih)&&this.lY.mN&&this.$.ta.pa&&this.$.ta.pa.name!==this.lY.mN&&
this.$.ta.Qm(this.lY.mN)&&this.$.ta.getItemByName(this.lY.mN).activate({scenario:"msForm"})}AO(G,pa){this.$.workbookContext.Options=Tf.HelperMethods.DR(G,this.$.workbookContext.Options,pa)}}Object(Fa.a)(Ii,"MsFormInfoUpdatingService",null,[314,5]);class Oi extends pb.a{constructor(G){super();this.msFormInfoUpdatingService=null;this.$=G;this.Oe()}create(){this.ve(Object(Sa.a)(this.$.ia,237,()=>this.msFormInfoUpdatingService||(this.msFormInfoUpdatingService=new Ii(this.$))));this.msFormInfoUpdatingService.Igk()}static la(G){G.ia.Va(236,
new Oi(G))}}Object(Fa.a)(Oi,"MsFormInfoUpdatingServiceFactory",pb.a,[]);var yi=a(224);class sj extends qe.a{constructor(G,pa,kb){super();this.value=null;this.bDd=G;this.$y=pa;this.WMg=kb}FZg(G){this.addHandler("EnabledStateChanged",G)}get isEnabled(){return this.$y}set isEnabled(G){G!==this.$y&&(this.$y=G,Re.a.mo()&&appChrome.api.dispatch(appChrome.actions.toggleButton("Toggle"+this.bDd.replace(" ","")+"Button",G)),this.raiseEvent("EnabledStateChanged"))}get isVisible(){return this.isEnabled&&!!this.value}get zk(){return this.value?
String.format(Ve.a.instance.Qd(79),this.bDd,this.value):this.bDd}get Btc(){return this.WMg}}Object(Fa.a)(sj,"StatusBarAggregateControl",qe.a,[339]);class Ci extends qe.a{constructor(){super();this.controls=new xg.a(!1);this.Kce=null;this.l0f=()=>{this.raiseEvent("AggregatesChanged")};this.Eca(0,415,"Average",!0);this.Eca(1,416,"Count",!0);this.Eca(2,417,"NumericalCount",!1);this.Eca(3,418,"Minimum",!1);this.Eca(4,419,"Maximum",!1);this.Eca(5,420,"Sum",!0)}KYg(G){this.addHandler("AggregatesChanged",
G)}pCj(G){this.removeHandler("AggregatesChanged",G)}get s3a(){return this.Kce||Ci.PYe}set s3a(G){G=G||Ci.PYe;G!==this.s3a&&(this.EEa(0,G.Average),this.EEa(1,G.Count),this.EEa(2,G.NumericalCount),this.EEa(3,G.Minimum),this.EEa(4,G.Maximum),this.EEa(5,G.Sum),this.Kce=G,this.l0f())}dispose(){nf.a.df(this.controls.values);this.controls.clear();super.dispose()}oza(G){return this.controls.getItem(G)}tVg(G,...pa){G=this.oza(G.toString());for(const kb of pa)this.controls.add(kb,G)}Eca(G,pa,kb,Zb){pa=new sj(Ve.a.instance.za(pa),
Zb,kb);pa.FZg(this.l0f);this.controls.add(G.toString(),pa)}EEa(G,pa){this.oza(G.toString()).value=pa}static get PYe(){Ci.mua||(Ci.mua={},Ci.mua.Average=Ci.mua.Count=Ci.mua.NumericalCount=Ci.mua.Minimum=Ci.mua.Sum=null);return Ci.mua}}Ci.mua=null;Object(Fa.a)(Ci,"StatusBarAggregateControlCollection",qe.a,[]);var $i=a(199),Gh=a(80),Hj=a(57);const Fi=[{t3a:0,name:"Average",AYa:-1015637685,u3a:1,v8a:!0},{t3a:1,name:"Count",AYa:1957769939,u3a:3,v8a:!1},{t3a:2,name:"NumericalCount",AYa:-1292677035,u3a:2,
v8a:!1},{t3a:3,name:"Minimum",AYa:405783320,u3a:5,v8a:!0},{t3a:4,name:"Maximum",AYa:1210824414,u3a:4,v8a:!0},{t3a:5,name:"Sum",AYa:1265371067,u3a:9,v8a:!0}];class Si{constructor(G,pa,kb){pa=void 0===pa?null:pa;kb=void 0===kb?null:kb;this.qic=this.QKc=this.RKc=this.PKc=null;this.nwa=new Ci;this.Mcb=new xg.a(!0);this.opg=0;this.Csg=Zb=>{const Lc=this.ga.ra.activeCell.clone(),Bd=fe.d(this.ga.ra.selectedRanges);var he=this.$.pa;const Ie=null===he||void 0===he?void 0:he.sheetId,ff=null===he||void 0===
he?void 0:he.hash,qf=this.$.ea.Mg,eg=this.$.ea.MU;he=this.$.listSeparator;const dh=fe.i(fe.H(Bd),he,this.$,!1),nh=`=${this.Hg.config.localeInfo.getWorksheetFuncName(485)}({0}${he}5${he}{1})`;Promise.all(Fi.map(Ug=>this.Hg.evalFormula(String.format(nh,Ug.u3a,dh),Lc,void 0,Ug.v8a?excelOnlineCalc.calc.evalFormulaFormatAggregate():excelOnlineCalc.calc.evalFormulaFormatKnown(0)))).then(Ug=>{var rh;const oj=this.ga.ra.selectedRanges,Vi=this.ga.ra.activeCell,zj=null===(rh=this.$.pa)||void 0===rh?void 0:
rh.sheetId;if(fe.R(Bd,oj)&&Lc.equals(Vi)&&Ie===zj){rh=[];for(var cj of Ug.entries()){[,Ug]=cj;if(void 0===(null===Ug||void 0===Ug?void 0:Ug.formatted)||!excelOnlineCalc.util.isSuccess(Ug.formatted)||!excelOnlineCalc.util.isSuccess(Ug.value)){this.cYd();return}Ug=this.Hg.MC.renderValue(Ug.formatted.value,excelOnlineCalc.numfmt.renderInfiniteWidth);if(!excelOnlineCalc.util.isSuccess(Ug)){this.cYd();return}Ug=excelOnlineCalc.numfmt.renderedValueToString(Ug.value);rh.push(Ug)}cj={};for(var Fj of Fi)cj[Fj.name]=
"";Fj=rh[1];Ug=rh[2];if(1<+Fj&&(cj.Count=Fj,0<+Ug))for(const dj of Fi.entries()){const [Lj,ak]=dj;cj[ak.name]=rh[Lj]}this.dTb(cj);this.$ak(cj,Fj,qf,eg,Bd,Lc,Ie,ff,Zb)}}).catch(Ug=>{X.ULS.sendTraceTag(537151266,0,10,`TryToCalculateAggregatesUsingCalc: in catch, reason: ${JSON.stringify(Ug)}`);this.cYd()})};this.Qf=()=>{this.dug()};this.ph=(Zb,Lc)=>{Zb=Lc.Gf.hash;Lc=Lc.Gf.block;const Bd=Lc.cea;if(Lc.state&4&&Bd&&Bd!==this.Mcb.getItem(Zb)){this.Mcb.add(Zb,Bd);var he=(Zb=Lc.Sh)?Yd.g(Zb.getRowNumbers(),
Zb.getColumnNumbers()):null;yi.a.any(this.ga.ra.selectedRanges,Ie=>Ie.If(he))&&this.dug()}};this.Np=(Zb,Lc)=>{this.Mcb.remove(Lc.Gf.hash)};this.fg=()=>{this.$.ia.Od(29,Zb=>{this.statusBarManager=Zb;Zb.BM(this);X.ULS.sendTraceTag(537151265,0,50,"StatusBarAggregateManager.OnWorkbookOpened: after AddFeatureRootUser")})};this.vf=(Zb,Lc)=>{!Zb.Ee&&xc.b(Lc)&&this.statusBarManager&&(this.statusBarManager.WI(this),this.statusBarManager=null,X.ULS.sendTraceTag(537151264,0,50,"StatusBarAggregateManager.OnSessionIdChanged: after RemoveFeatureRootUser"))};
this.Ibk=()=>{let Zb;const Lc=this.ga.ra.selectedRanges;(()=>{let Bd=this.Ggk(Lc);({H9b:Zb}=Bd);return Bd})().returnValue?this.dTb(Zb):this.g8f()};this.g8f=()=>{var Zb;const Lc=fe.d(this.ga.ra.selectedRanges),Bd=this.ga.ra.activeCell.clone(),he=null===(Zb=this.$.pa)||void 0===Zb?void 0:Zb.sheetId;this.PEf(Bd,Lc,Ie=>{var ff;const qf=this.ga.ra.selectedRanges,eg=this.ga.ra.activeCell,dh=null===(ff=this.$.pa)||void 0===ff?void 0:ff.sheetId;fe.R(Lc,qf)&&Bd.equals(eg)&&he===dh&&this.dTb(Ie.Result)})};
this.Sqf=Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5809185_StatusBarAggregatesCSE");this.HCe=Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AlwaysTestCalcResult",!1);this.$=G;this.gridView=Yd.h(this.$);this.p7=pa||va.AFrameworkApplication.Wf;this.ik=kb||Ud.a.Jd;this.$.ea.Yl(this.vf);this.$.zn(this.fg);this.ga.Kr(this.Qf);this.ga.add_activeCellChanged(this.Qf);this.ya.Zu(this.ph);this.ya.bK(this.Np);for(const Zb of Fi)this.VWj(Zb.t3a,Zb.name,Zb.AYa);(this.statusBarManager=this.$.ia.Ja(29))&&
this.statusBarManager.BM(this);this.Sqf&&(void nc.a.resolve(Oc.r,{Oa:1}).then(Zb=>this.Hg=Zb),this.$.ia.Od(268,Zb=>{this.instantaneousSupportInformationManager=Zb}))}yt(G){this.nwa.KYg(G)}Ut(G){this.nwa.pCj(G)}get s3a(){return this.nwa.s3a}dTb(G){this.nwa.s3a=G}get ya(){return this.gridView.ya}get ga(){return this.gridView.ga}dispose(){this.$&&(this.$.ea.gm(this.vf),this.$.uo(this.fg),this.ga.es(this.Qf),this.ga.remove_activeCellChanged(this.Qf),this.ya.Tt(this.ph),this.ya.EL(this.Np),this.LJe());
this.statusBarManager&&(this.statusBarManager.WI(this),this.statusBarManager=null);nf.a.df([this.PKc,this.RKc,this.QKc,this.nwa]);this.$=this.nwa=this.QKc=this.RKc=this.PKc=null;this.Mcb&&(this.Mcb.clear(),this.Mcb=null)}ov(G,pa){return this.oza(G)&&this.Oef(G,pa)?!0:!1}Oef(G,pa){const kb=this.oza(G);if(!kb)return!1;let Zb=kb.zk;if(G.endsWith("Label"))pa.Visible=kb.isVisible,Re.a.mo()?pa.LabelText=Zb:pa.Value=Zb;else if(G.endsWith("Button"))pa.LabelText=Zb,pa.On=kb.isEnabled,Mb.FocusManager.instance().kn(qb.AFrame.k4);
else return!1;return!0}mq(){return!0}hf(){return!1}executeCommand(G,pa){G=this.oza(pa.command);if(!G)return $i.a(pa.command);G.isEnabled=!G.isEnabled;this.rTi(G.Btc,G.isEnabled);return Jb.Task.Ua(!0)}Ue(G,pa){return!!this.oza(pa.command)}mf(){return!1}PEf(G,pa,kb){var Zb=this.$;this.LJe();if(this.$.ea.Ee){var Lc=Zb.qa.ua;G=fe.o(G,Zb);pa=fe.r(pa,Zb);Zb=Lc.Pa(1,null);Zb.activeCell=G;Zb.selectedRanges=pa;this.qic=Ob.g(Lc,"GetStatusBarAggregates",Zb,kb,null,null,null,0)}}Ggk(G){let pa,kb=Si.Bsg(G);({H9b:pa}=
kb);return{returnValue:kb.returnValue||this.j5g(G)&&this.g5g(G),H9b:pa}}$ak(G,pa,kb,Zb,Lc,Bd,he,Ie,ff){const qf=this.HCe?1:.05,eg=this.HCe?1E3:20;if(ff||!(this.opg>eg||Math.random()>qf))this.opg++,this.PEf(Bd,Lc,dh=>{var nh,Ug,rh,oj;if(!Pe.a(dh)){var Vi=this.ga.ra.selectedRanges,zj=this.ga.ra.activeCell,cj=null===(nh=this.$.pa)||void 0===nh?void 0:nh.sheetId;nh=dh.StateId;if(fe.R(Lc,Vi)&&Bd.equals(zj)&&he===cj&&kb===this.$.ea.Mg&&Zb===this.$.ea.MU&&kb===nh){var Fj=dh.Result;nh={};const xk={};cj=!0;
for(var dj of Fi){var Lj=Fj[dj.name],ak=G[dj.name];const yk=Lj===ak;nh[dj.name]=yk;xk[dj.name]=[Lj.length,ak.length];cj&&(cj=yk)}({category:zj}=this.instantaneousSupportInformationManager?this.instantaneousSupportInformationManager.zgk(null!==(oj=null===(rh=null===(Ug=this.gridView.Zd(zj))||void 0===Ug?void 0:Ug.cell)||void 0===rh?void 0:rh.Lj)&&void 0!==oj?oj:0):{category:"uninitialized"});Ug=Vi.length;Vi=fe.b(Vi);rh=this.gridView.Jkf()||this.gridView.Ikf();dj=this.gridView.Gd;oj=dj.INb;Lj=this.gridView.Wk("StatusBarAggregates");
dj=Gh.c(Bd,dj.Vk,dj.Ol,this.gridView.rowsPerBlock,this.gridView.columnsPerBlock,Object(Hj.d)(Lj)?Lj.value:null);dj=dj.X+"_"+dj.Y+"_"+dj.PaneType;Fj=Fj.Count;Lj=G.Count;ak=this.gridView.Ud.Lci(Lc);dh=`StatusBarAggregateManager.testCalcResult: allCorrect: ${cj}, ${JSON.stringify(nh)}, numberFormatCategory: ${zj}, resLength(server,calc): ${JSON.stringify(xk)}, stateId: ${kb}, latestSuccessfulStateId: ${Zb}, prevSheetId: ${he}, prevSheetHash: ${Ie}, numOfRanges: ${Ug}, numOfCells: ${Vi}, prevActiveCell: ${Bd}, prevSelectedRanges: ${Lc.join(";")}, sheetHasHidden: ${rh}, panesState: ${oj}, blockPositionString: ${dj}, ReportCalcState: ${dh.ReportCalcState}, CalcComplete: ${dh.CalcComplete}, serverCount: ${Fj}, calcCount: ${Lj}, calcCountUnfiltered: ${pa}, enumeratorCount: ${ak}, forceTestResult: ${ff}`;
X.ULS.sendTraceTag(520426510,0,50,dh);cj||ff||window.setTimeout(()=>{this.Csg(!0)},100)}}})}j5g(G){const pa=this.gridView.Rl,kb=this.gridView.ps;return!!pa&&yi.a.all(G,Zb=>pa.contains(Zb))&&yi.a.all(G,Zb=>!kb.qbb(Zb))}g5g(G){if(500<fe.b(G))return!1;const pa=this.ik.Og;G=this.gridView.B7("StatusBarAggregateManager.AreAllCellsEmpty",G);try{for(let kb=0;G.$$mn();kb++)if(G.$$cu().eM||!(kb%25)&&100<jb.c(this.ik,pa))return!1}finally{G&&G.dispose()}return!0}oza(G){return this.nwa.oza(G)}VWj(G,pa,kb){this.nwa.tVg(G,
"Query"+pa+"Label","Query"+pa+"Button",kb.toString())}dug(){var G;if(this.$.hg&4&&!this.gridView.Kd&&!this.gridView.Al){var pa;(()=>{let kb=Si.Bsg(this.ga.ra.selectedRanges);({H9b:pa}=kb);return kb})().returnValue?this.dTb(pa):(this.dTb(null),this.Sqf&&(null===(G=this.Hg)||void 0===G?0:G.joc)?this.jNj():this.PKc=Cg.AsyncMethodContext.nu(this.Ibk,500,Yc.a.L8j,this.PKc))}}jNj(){this.QKc=Cg.AsyncMethodContext.nu(()=>this.Csg(!1),10,Yc.a.M8j,this.QKc)}cYd(){this.RKc=Cg.AsyncMethodContext.nu(this.g8f,
500,Yc.a.K8j,this.RKc)}LJe(){this.qic&&(this.p7.cy(this.qic.ox),this.qic=null)}rTi(G,pa){const kb={};kb.a=this.$.xa.UserSessionId;kb.b=G;kb.c=pa;Rb.b().Ih(29,kb)}static initData(){const G=Ad.a.Dca;for(const pa of Fi)G(pa.AYa,Re.a.mo()?Ub.a.Oh|8192:Ub.a.Oh,0,0)}static la(G){Si.initData();const pa=new Si(G);G.Ga.D6(pa);G.ia.Va(27,pa)}static Bsg(G){return{returnValue:1===G.length&&G[0].isSingle,H9b:null}}}Object(Fa.a)(Si,"StatusBarAggregateManager",null,[303,5,298,173,169]);var tj=a(1226),uj=a(915);
class aj{}aj.Ubk=864E5;aj.L1g=3;aj.j4i=144E5;Object(Fa.a)(aj,"AddinConstantsNum",null,[]);var ri=a(756),Nh=a(832),Xh=a(866);class bj{constructor(G,pa,kb,Zb){this.da=(Zb=void 0===Zb?null:Zb)?Zb:va.AFrameworkApplication.da;this.eUc=2;this.sQa=G;this.$Sg=pa;this.pe=kb}get ooa(){return this.eUc}get tok(){return this.$Sg}bXd(G){if(this.da.na("AgaveSupportsLiveIdSpoofing")){var pa=(new Date).getTime();this.sQa(G,this.ooa,{["ak0"]:pa})}else if(Xh.a.r0j(G)){pa=String.format(va.AFrameworkApplication.sa.Sa.nZ+
"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",va.AFrameworkApplication.sa.Sa.Hj,this.tok,va.AFrameworkApplication.fl);const kb=va.AFrameworkApplication.Wf;let Zb=null;this.pe&&(Zb=this.pe.xf("ComponentAttach",Nh.a[G]+uj.a[this.ooa]));kb.zp(pa,1,null,null,!0,4,Lc=>{this.tij(G,Lc.data.Fg);Zb&&Zb.stop()},Lc=>{X.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Lc.data.httpStatus);this.Veb(G,1,"request failed");Zb&&Zb.stop()},null)}else Xh.a.hkf(G)?
(pa=Xh.a.a9e(G),this.sQa(G,this.ooa,{["ak0"]:pa})):this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(this.dG?this.Veb(G,1,"no local timestamp"):this.sQa(G,this.ooa,null))}tij(G,pa){if(pa&&""!==pa)if(pa=Sys.Net.XMLDOM(pa)){Xh.a.WFa(ri.a.zBe,((new Date).getTime()+aj.j4i).toString(),G);let kb=pa.getElementsByTagName("update");kb&&kb.length||(kb=pa.getElementsByTagName("o:update"));kb&&0<kb.length?(pa=Date.parse(kb[0].firstChild.nodeValue),Xh.a.a9e(G)<
pa||Xh.a.hkf(G)?this.sQa(G,this.ooa,{["ak0"]:pa}):this.Veb(G,1,"outdate timestamp in reponse")):this.Veb(G,2,"no timestamp in response")}else this.Veb(G,1,"response data is invalid");else this.Veb(G,1,"no responseData")}Veb(G,pa,kb){this.dG&&this.sQa(G,this.ooa,{["AddinServiceUserState"]:pa,["DiagnosticInfo"]:kb})}get dG(){return this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",
!1)}}Object(Fa.a)(bj,"AddinCommandsAnonymousAPIInitializer",null,[361]);class jj{constructor(G,pa,kb){this.eUc=kb;this.sQa=G;this.hk=pa}get ooa(){return this.eUc}bXd(G){let pa=null;this.hk&&(pa=this.hk.xf("ComponentAttach",Nh.a[G]+uj.a[this.ooa]));if(null==this.N1d(G)?0:this.N1d(G)){const kb=(new Date).getTime()-aj.L1g*aj.Ubk;this.sQa(G,this.ooa,{["ak0"]:kb})}pa&&pa.stop()}}Object(Fa.a)(jj,"AddinCommandsInitializerBase",null,[361]);class C extends jj{constructor(G,pa){super(G,pa,5)}N1d(){return!0}}
Object(Fa.a)(C,"AddinCommandsInitializer",jj,[]);class ea extends jj{constructor(G,pa){super(G,pa,1)}N1d(G){try{const pa=ri.a.ibf()+G;return Boolean.parse(this.J3h(pa)||"false")}catch(pa){X.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",pa.toString())}return null}J3h(G){const pa=localStorage;return void 0!==pa&&null!==pa?pa.getItem(G):null}}Object(Fa.a)(ea,"AddinCommandsLocalCacheInitializer",jj,[]);var Ta=a(569);class Yb{constructor(G,pa){pa=void 0===pa?null:pa;this.pe=G;this.da=
pa?pa:va.AFrameworkApplication.da}get appUILocale(){return Ta.a.sN(va.AFrameworkApplication.lcid).name}Swi(){if(this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var G={};G[ri.a.kEh]=
"TeachingCallout";this.Xzc(cb.a.Mfk,G)}const pa=this.rnd();if(pa)if(this.da.na("OcpsIsEnabled"))Y.a.instance.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(kb=>{kb.isFeatureEnabled("ConnectedServices",!0).then(Zb=>{for(const Lc of pa){if(!Zb&&0===Lc.key){this.dG&&this.wrg(0,Lc.value,{["AddinServiceUserState"]:3,["DiagnosticInfo"]:"connected services is off"});continue}const Bd=this.C8e(Lc.value);Bd&&Bd.bXd(Lc.key)}return null})});else for(const kb of pa)(G=this.C8e(kb.value))&&
G.bXd(kb.key)}cXd(G,pa,kb){kb&&kb[ri.a.tKa]?(kb[ri.a.X0]=G,kb[ri.a.aX]=pa,this.Xzc(cb.a.wra,kb),Xh.a.WFa(ri.a.tKa,kb[ri.a.tKa].toString(),G)):this.dG?this.wrg(G,pa,kb):this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&0===G&&(kb={},kb[ri.a.X0]=G,kb[ri.a.aX]=pa,this.Xzc(cb.a.Sz,kb))}C8e(G){let pa=null;switch(G){case 1:pa=new ea(Object(Gb.a)(this,this.cXd,"retrieveAddinFlagCompleted"),this.pe);break;case 2:pa=new bj(Object(Gb.a)(this,this.cXd,"retrieveAddinFlagCompleted"),
this.appUILocale,this.pe,this.da);break;case 5:pa=new C(Object(Gb.a)(this,this.cXd,"retrieveAddinFlagCompleted"),this.pe)}return pa}wrg(G,pa,kb){0===G&&kb&&kb[ri.a.c7b]&&(kb[ri.a.X0]=G,kb[ri.a.aX]=pa,X.ULS.sendTraceTag(508829835,220,50,"AddinServiceUserState: {0}, addinCommandsInitFlagInfo: {1}",kb[ri.a.c7b].toString(),JSON.stringify(kb)),this.Xzc(cb.a.Sz,kb))}get dG(){return this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&this.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FlyoutInitializerFixEnabled",
!1)}}Object(Fa.a)(Yb,"AddinCommandsInitializerHost",null,[]);var wc=a(278),Hc=a(805),rd=a(267),ce=a(357);let Le;class Ue extends Cb.StandardDialog{constructor(G,pa){super();this.Cee=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.Ahe=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;this.Bhe=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.nqb=!1;this.Sub=()=>{this.hide();this.nqb&&k(this.cja)};this.i6i=()=>{Hc.a.instance.getItem("optedIntoAddinDeveloperMode")?(Hc.a.instance.removeItem("optedIntoAddinDeveloperMode"),
this.nqb=!1):(Hc.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.nqb=!0)};this.cja=G;Le=pa}showDialog(G,pa){try{this.Rg=void 0===this.Rg||null===this.Rg?rd.a.WOb(ce.a.t5).toString():this.Rg,this.show({["type"]:"StandardDialogProps",["id"]:this.Rg,["dialogIcon"]:3,["headerText"]:G,["titleText"]:pa,["resultHandler"]:this.Sub,["messageAreaLink"]:this.$th(),["permanentDismissCheckbox"]:this.Wth(),["renderMicrosoftLogoInHeader"]:!1})}catch(kb){this.uNc(G,pa)}}$th(){return{["type"]:"AppLinkProps",
["id"]:"WACDialogExtraLink",["text"]:this.Ahe,["handler"]:{["href"]:this.Bhe,["target"]:"_blank"},["onExecute"]:null}}Wth(){return{["type"]:"AppCheckboxProps",["id"]:"WACDialogOptInCheckbox",["label"]:this.Cee,["onExecute"]:this.i6i}}uNc(G,pa){const kb=new Md.a(!1,!1,!1);kb.ke=1;kb.Rg=rd.a.WOb(ce.a.t5).toString();kb.ti=String.format(this.rY(),pa,this.Bhe,this.Ahe,this.Cee);kb.initializeAndShow(G,this.FCg,{optInCheckbox:!1})}FCg(G,pa){1==G&&pa.optInCheckbox&&(Hc.a.instance.getItem("optedIntoAddinDeveloperMode")?
(Hc.a.instance.removeItem("optedIntoAddinDeveloperMode"),this.nqb=!1):(Hc.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.nqb=!0,k(this.cja)))}rY(){return Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:7726503_DeveloperModeStyleFix")?"<div style='height:100px;width:400px;border:none;'><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>":"<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>"}}
Object(Fa.a)(Ue,"AppsForOfficeDeveloperModeOptInDialog",Cb.StandardDialog,[]);var mf=a(389);class rf extends Yb{constructor(G){super(G.pe);this.cja=this.MZb=null;this.BIa=new wc.a;this.B3f=pa=>{1===pa&&this.cja&&this.A3f()};this.$=G;tj.a.FEb=tj.a.J3e}get appUILocale(){return this.$.xa.UICultureTag}ksg(){this.Swi();this.$gk()}rnd(){const G=new mf.a;this.$.ea.Qj.get(27)&&(G.fa(0,2),""!==va.AFrameworkApplication.da.Ra("HostInstallAddIns")&&G.fa(16,5));this.$.ea.Qj.get(33)&&G.fa(1,1);Vb.EwaSettings.Fa(52)&&
G.fa(8,1);this.$.Kg.get(35)&&G.fa(10,5);return G}Xzc(G,pa){this.hHh(()=>{const kb=new Hb.a(G,0,this.$.Ie,0,null);this.$.Ga.Sd(kb,pa)})}hHh(G){(pa=>{pa=this.$.ia.Ja(pa);return!!pa&&Vf.d(pa)})(198)?(new Wc.a,this.$.ia.Od(198,pa=>{G(pa)})):G(null)}$gk(){this.cja=va.AFrameworkApplication.da.Ra("DevAddinManifestFileUrl");this.MZb=va.AFrameworkApplication.da.Ra("DevAddinManifestGuid");var G=va.AFrameworkApplication.da.Ra("IsDevAddinTest");if(this.cja&&this.MZb&&G){G="true"===G;var pa=this.BIa.getItem("optedIntoAddinDeveloperMode");
const kb=this.BIa.getItem(this.MZb);pa||G&&va.AFrameworkApplication.da.na("SuppressDeveloperAddinDialogs")?kb||G&&va.AFrameworkApplication.da.na("SuppressDeveloperAddinDialogs")?this.A3f():(G=new Cb.StandardDialog,G.ke=4,pa=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.cja)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl,G.JV(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
pa,this.B3f)):(G=new Ue(this.cja,this.B3f),G.ke=0,G.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage))}}A3f(){const G=Fc.GetServiceTaskFactory.create(this.$.ia,106,this.$.ma,1);Ec.TaskExtensions.Aa(G,()=>{G.result.Qh.validateAndCacheNewDevAddinManifest(this.cja);this.BIa.setItem(this.MZb,"true")},this.$.ma,3)}}Object(Fa.a)(rf,"AddinCommandsInitService",Yb,[315]);class Of extends pb.a{constructor(G){super();
this.addinCommandsInitService=null;this.vf=()=>{X.ULS.sendTraceTag(537170701,0,50,`AddinCommandsInitServiceFactory.OnSessionIdChanged: isSessionActive ${this.$.ea.Ee}, isEditMode ${this.$.isEditMode} , showCommandUI [${!!(this.$.hg&16384)}] `);this.addinCommandsInitService.ksg();this.$.ea.gm(this.vf)};this.$=G;this.Oe()}create(){this.$.ia.Od(53,()=>{this.ve(Object(Sa.a)(this.$.ia,202,()=>this.addinCommandsInitService||(this.addinCommandsInitService=new rf(this.$))));this.$.ea.Ee?(X.ULS.sendTraceTag(537170702,
0,50,`AddinCommandsInitServiceFactory.Create: calling TryInitializeAddinCommands, isEditMode: [${this.$.isEditMode}], showCommandUI [${!!(this.$.hg&16384)}] `),this.addinCommandsInitService.ksg()):this.$.ea.Yl(this.vf)})}static la(G){G.ia.Va(201,new Of(G))}}Object(Fa.a)(Of,"AddinCommandsInitServiceFactory",pb.a,[]);var Ag=a(286);class tg{constructor(G){this.HSa=this.tGd=this.LSa=this.Ptc=0;this.mGd=this.nEf=null;this.yxc=pa=>{"pen"!==pa.pointerType||this.LSa||(this.LSa=Math.floor(this.zyb()/1E3),
this.LSa<=this.Ptc&&(this.LSa=this.Ptc),this.tGd=0)};this.yga=()=>{this.Kjf()};this.SDb=(pa,kb)=>{0!==kb.newState&&this.Kjf()};this.KUi=()=>{0<this.HSa&&this.Qcg(this.HSa);this.HSa=0};G?(this.Ytc=G,this.zyb=Date.now,this.nth(),this.Czj()):X.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}Nfg(){this.nEf="Office.Excel.Online.Data.Activity.PenMinutes"}Czj(){window.document.body.addEventListener("pointerenter",this.yxc);window.document.body.addEventListener("pointerleave",
this.yga);Y.a.instance.ie("Common.App.VisibilityManagement.IVisibilityManager").execute(G=>{G.XAe(this.SDb)})}Kjf(){const G=Math.ceil(this.zyb()/1E3);this.LSa&&G>this.Ptc&&(this.tGd=G,this.HSa+=this.tGd-this.LSa);this.Ptc=G;this.LSa=0}nth(){this.mGd=new sh.a(4,2,6E4,this.KUi);this.Ytc.Xh(this.mGd)}Qcg(G){const pa=new Ag.a;pa.name=this.nEf;const kb=[];(G=Hi.a.Ci("PenInputSec",G.toString(),3))&&Array.add(kb,G);pa.dataFields=kb;li.a.sendActivityEvent(pa)}dispose(){0<this.HSa&&this.Qcg(this.HSa);this.Ytc.Rr(this.mGd)}}
Object(Fa.a)(tg,"PenMinutesManager",null,[312]);class mg{constructor(){this.AYc=this.Fd=null}get name(){return"Common.App.PenMinutesManager"}nk(G){this.Fd=G;const pa=va.AFrameworkApplication.Pj;this.Fd.register(312,"Common.App.PenMinutesManager.IPenMinutesManager").Ve().$e(()=>new tg(pa))}init(){this.AYc=this.Fd.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.AYc&&this.AYc.dispose()}static main(){Db.a.instance.$k(new mg)}}Object(Fa.a)(mg,"PenMinutesManagerPackage",null,[3,
4]);const O=()=>{Type.registerNamespace("Common.App.PenMinutesManager");mg.main()};class Qa extends pb.a{constructor(G){super();this.$=G;this.Oe()}static la(G){G.ia.Va(514,new Qa(G))}create(){this.ve(Object(Sa.a)(this.$.ia,513,()=>{O();const G=Y.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");G.Nfg();return G}))}}Object(Fa.a)(Qa,"PenMinutesFactory",pb.a,[]);var mb=a(128);let mc=class{constructor(G){G.LK(pa=>{void pa.u8(1).then(()=>{const kb=document.createElement("div"),Zb=Object(Yd.h)(G).Qn;
appChrome.renderProactiveSuggestionDebugPane(kb,Zb,mb.a.Ly)})});Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&void(Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateRecognizedTableGridHighlighter",!1)?nc.a.resolve(Oc.Nc,{Oa:1}):Fc.GetServiceTaskFactory.C9a(G.ia,510,511,1))}};mc=Object(Ke.a)([Object(nc.d)(Oc.Gc),Object(Ke.b)(0,Object(Oc.fb)())],mc);Object(Fa.a)(mc,"ProactiveSuggestionDebugToolsManager",null,[]);class Ac extends pb.a{constructor(G){super();
this.$=G;this.Oe()}static la(G){G.ia.Va(509,new Ac(G))}create(){this.ve(Object(Sa.a)(this.$.ia,508,()=>new mc(this.$)))}}Object(Fa.a)(Ac,"ProactiveSuggestionDebugToolsManagerFactory",pb.a,[]);class sd{static H3h(G){try{return caches.open(sd.Yde).then(pa=>pa.match(G))}catch(pa){return Promise.reject(null)}}static lza(G,pa){try{return sd.H3h(G).then(kb=>kb&&Number.parseInvariant(kb.headers.get("cachedTime"))>Date.now()-pa?Promise.resolve(kb.text().toLocaleString()):Promise.reject("Not found")).catch(()=>
Promise.reject("Cache returned undefined"))}catch(kb){return Promise.reject(null)}}static store(G,pa){try{return caches.open(sd.Yde).then(kb=>{kb.put(G,pa).then(()=>!0);return!1}).catch(()=>Promise.resolve(!1))}catch(kb){return Promise.resolve(!0)}}static k9j(G,pa){const kb={};kb.body=pa;const Zb={};Zb.cachedTime=Date.now().toString();kb.headers=Zb;pa=new Response(pa,kb);sd.store(G,pa).then(()=>!0)}}sd.Yde="ConsentState";Object(Fa.a)(sd,"CacheManager",null,[]);class yd{constructor(){this.message=
null;this.Y8=0}}Object(Fa.a)(yd,"HttpRequstToPromiseRejectData",null,[]);class Od{constructor(G){this.x0=G}iZ(G,pa,kb,Zb,Lc,Bd){li.a.sendTelemetryEvent(Object.assign(new mi.a,{name:"Office.Online."+G,dataFields:[Object.assign(new Ph.a,{name:"EventMessage",string:pa}),Object.assign(new Ph.a,{name:"FormFactor",string:this.x0.formFactor}),Object.assign(new Ph.a,{name:"CorrelationId",string:this.x0.correlationId}),Object.assign(new Ph.a,{name:"AccountType",string:this.x0.accountType}),Object.assign(new Ph.a,
{name:"OSVersion",string:this.x0.osVersion}),Object.assign(new Ph.a,{name:"AppId",string:this.x0.appId}),Object.assign(new Ph.a,{name:"ConsentSurface",string:"AppStart"}),Object.assign(new Ph.a,{name:"ConsentLanguage",string:this.x0.consentLanguage}),Object.assign(new Ph.a,{name:"EventCode",string:kb}),Object.assign(new Ph.a,{name:"Region",string:this.x0.region}),Object.assign(new Ph.a,{name:"ModelType",string:Zb}),Object.assign(new Ph.a,{name:"ModelId",string:Lc}),Object.assign(new Ph.a,{name:"Platform",
string:this.x0.os}),Object.assign(new Ph.a,{name:"ReConsentReason",string:""}),Object.assign(new Ph.a,{name:"ConsentType",string:Bd})]}))}}Object(Fa.a)(Od,"TelemetryLogger",null,[]);var Uc=a(220);class Dd{constructor(G,pa,kb){this.uHg="https://consent.config.office.com/consentcheckin/v1.0/consents";this.Qa=G;this.kj=pa;this.Rva=kb;this.ES=new Od(kb)}CMa(G,pa){return new Promise((kb,Zb)=>{const Lc=this.Qa.eg("UCNoticeCheckinCallTimeoutMs",5E3);let Bd=this.Qa.Ra("UCNoticeCheckinStateUrl");Bd&&Bd.length||
(Bd=this.uHg);this.kj.I6(Bd,1,null,this.ECb(G),null,!1,0,he=>{try{if(void 0===he||null===he||void 0===he.data||null===he.data||void 0===he.data.Fg||null===he.data.Fg){this.ES.iZ("UnifiedConsent.ConsentGetFailed","CheckInApi : Invalid response","711",null,null,null);const ff=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");Zb(this.MK(ff,he))}else if(he.data.httpStatus!==
Uc.a.sJ){this.ES.iZ("UnifiedConsent.ConsentGetFailed","CheckInApi : HTTP failure",he.data.httpStatus.toString(),null,null,null);const ff=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",he.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Zb(this.MK(ff,he))}else{var Ie=pa(he.data.Fg);if(Ie)kb(Ie);else{this.ES.iZ("UnifiedConsent.ConsentGetFailed","CheckInApi : Consent values are empty",
"712",null,null,null);const ff=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}","UnifiedConsent.ConsentGetFailed");Zb(this.MK(ff,he))}}}catch(ff){this.ES.iZ("UnifiedConsent.ConsentGetFailed","CheckInApi : Unexpected failure","713",null,null,null),Ie=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",ff,"UnifiedConsent.ConsentGetFailed"),Zb(this.MK(Ie,he))}},he=>{this.ES.iZ("UnifiedConsent.ConsentGetFailed",
"CheckInApi : Error in service call ",he.data.httpStatus.toString(),null,null,null);const Ie=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",he.data.httpStatus,"UnifiedConsent.ConsentGetFailed");Zb(this.MK(Ie,he))},null,void 0,void 0,2500,Lc)})}MK(G,pa){const kb=new yd;kb.message=G;kb.Y8=pa&&pa.data?pa.data.httpStatus:-1;return kb}ECb(G){const pa={};pa["Accept-Language"]=this.Rva.consentLanguage;pa.consentsurface="AppStart";pa.platform=
"Web";pa.formfactor=Za.a.i3?"Mobile":"Desktop";pa["x-Cid"]=this.Rva.correlationId;pa.Authorization="Bearer "+G;return pa}}Object(Fa.a)(Dd,"HttpRequestToPromiseUtility",null,[]);class ye{constructor(){this.accountType="MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.correlationId=this.userId=null;this.isDarkMode=!1}}Object(Fa.a)(ye,
"WebSdkAdapterProps",null,[]);class ie{constructor(G,pa,kb,Zb){this.uje=this.Xia=this.f6=this.r0=null;this.elj=Lc=>{if(void 0===Lc||null===Lc)return this.ES.iZ(ie.vIa,"Checkin response undefined or null","705",this.r0,this.f6,this.Xia),null;try{const {Ft:Bd}=ba.d(Lc);return Bd}catch(Bd){this.ES.iZ(ie.vIa,"Checkin response parse error : "+Bd.message,"706",this.r0,this.f6,this.Xia)}return null};this.XZa=Zb;this.Qa=G;this.UFg=kb;this.kj=pa;this.Rva=this.getDimensions();this.ES=new Od(this.Rva)}yjg(){"MSA"===
(this.Qa.Ra("HostAuthType")||"").toUpperCase()&&sd.lza(this.Rva.userId,this.Qa.eg("UCNoticeCheckinCacheTimeMs",862E5)).then(()=>{this.ES.iZ(ie.vIa,"CacheFound","701",this.r0,this.f6,this.Xia);return{}}).catch(()=>{this.UFg.execute(G=>{G.pD("Consent",ie.NRg).then(pa=>{pa.IsSuccess?(this.ES.iZ(ie.vIa,"CheckInTokenSuccess","702",this.r0,this.f6,this.Xia),this.m5h(pa.Token).then(kb=>{this.Gbi(kb);this.r0&&""!==this.r0&&G.pD("Consent",ie.PRg).then(Zb=>{Zb.IsSuccess?(this.ES.iZ(ie.vIa,"WebTokenSuccess",
"703",this.r0,this.f6,this.Xia),this.J3j(Zb,this.r0)):this.ES.iZ(ie.vIa,"WebTokenFailed : "+Zb.ErrorMessage,Zb.ErrorCode,this.r0,this.f6,this.Xia);return{}});return{}})):this.ES.iZ(ie.vIa,"CheckInTokenFailed : "+pa.ErrorMessage,pa.ErrorCode,this.r0,this.f6,this.Xia);return{}})})})}m5h(G){this.uje=new Dd(this.Qa,this.kj,this.Rva);return this.uje.CMa(G,this.elj).then(pa=>Promise.resolve(pa),pa=>Promise.reject("Error while getting result"+pa))}Gbi(G){for(const pa of G.consentValues)if(pa.needConsent&&
!pa.maxPromptsReached){this.f6=pa.id;this.Xia=pa.consentType;this.r0=pa.modelType;return}sd.k9j(this.Rva.userId,ba.c(G))}J3j(G,pa){if(yb.a("showConsentNotice")){const kb=document.createElement("div");document.body.appendChild(kb);appChrome.api.showConsentNotice(this.T6h(G.Token,pa),kb)}else this.ES.iZ(ie.yMg,"1JS : ShowConsentNotice API not found","704",this.r0,this.f6,this.Xia)}T6h(G,pa){const kb=this.Rva;kb.token=G;kb.modelType=pa;return kb}getDimensions(){const G=this.awd(this.Qa.Ra("SessionStartInfoJson"));
return Object.assign(new ye,{emailId:this.Qa.Ra("UserPrincipalName"),userId:this.Qa.Ra("LoggableUserId"),accountType:"AAD"===(this.Qa.Ra("HostAuthType")||"").toUpperCase()?"AAD":"MSA",appId:this.Qa.Ra("OfficeApplicationId"),appVersion:this.Qa.Ra("appVersion"),appName:"Application"in G?G.Application:"",appEnv:this.XZa,consentLanguage:this.Qa.Ra("UICulture")||"en-US",formFactor:Za.a.i3?"Mobile":"Desktop",os:"Os"in G?G.Os:"",osVersion:"OsVersion"in G?G.OsVersion:"",region:this.Qa.Ra("region"),correlationId:ug.a.create().toString(),
isDarkMode:this.Qa.na("DarkModeIsOn"),useCache:!0})}awd(G){let pa={};try{pa=ba.b(G)}catch(kb){}return pa}}ie.PRg="https://consentservice.microsoft.com/web";ie.NRg="https://consentservice.microsoft.com/checkin";ie.yMg="UnifiedConsent.ConsentGetFailed";ie.vIa="UnifiedConsent.AuthTokenStatus";Object(Fa.a)(ie,"ConsentNoticeManager",null,[334]);class ze{constructor(){this.Fd=null}get name(){return"Common.App.ConsentNoticeDialog"}nk(G){this.Fd=G;G.register(ie,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").Ve().$e(()=>
new ie(va.AFrameworkApplication.da,va.AFrameworkApplication.Wf,G.ie("Common.App.OAuth.IOAuthManager"),va.AFrameworkApplication.ENa))}init(){this.Fd.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){Db.a.instance.$k(new ze)}}Object(Fa.a)(ze,"ConsentNoticeDialogPackage",null,[3,4]);let Ye=class{constructor(){Type.registerNamespace("Common.App.ConsentNoticeDialog");ze.main();Y.a.instance.ie("Common.App.ConsentNoticeDialog.IConsentNoticeManager").execute(G=>G.yjg())}};
Ye=Object(Ke.a)([Object(nc.d)(Oc.ud)],Ye);Object(Fa.a)(Ye,"UnifiedConsentAdapter",null,[]);let tf=class{constructor(G){this.MKf=()=>{this.cZa(this.$.ea.PYa,this.$.ea.Vgb);this.Dlk()};this.$=G;this.shortcutKeyManager=this.$.shortcutKeyManager;this.isMac=Za.a.isMac;this.shortcutKeyManager.WYg(this.MKf)}dispose(){this.shortcutKeyManager.xCj(this.MKf);this.$=null}TTj(){const G=this.Ikh.concat(this.m_i).map(pa=>appChrome.actions.setControlCustomTooltip(pa.commandId,this.S9a(pa)));appChrome.api.dispatch(G)}cZa(G,
pa){this.Xhk&&(this.sP[0].title=this.sP[2].title=this.F9d(G),this.sP[1].title=this.Rvg(pa),this.sP[1].shortcut=this.isMac?this.shortcutKeyManager.Mi(192):this.shortcutKeyManager.Mi(154));G=this.S9a(this.sP[1]);pa=this.S9a(this.sP[2]);G=[appChrome.actions.setControlCustomTooltip(this.sP[0].commandId,this.S9a(this.sP[0])),appChrome.actions.setControlCustomTooltip(this.sP[1].commandId,G),appChrome.actions.setControlCustomTooltip(this.sP[2].commandId,pa)];appChrome.api.dispatch(G)}JTi(G,pa){this.FLi(G)&&
Pg.b(pa)}FLi(G){return-1502853784===G||-111689794===G||-287251124===G||-1925065947===G||1764140053===G||-1590502662===G||-600086683===G||963349338===G||862890474===G||1220954656===G||1891435765===G||1896159024===G||-1554384558===G||-1985798686===G||-911352779===G||237279923===G||996232352===G?!0:!1}get m_i(){this.OJ||(this.OJ=[],this.OJ.push(this.Kk("Paste_MLR",Ve.a.instance.za(513),Ve.a.instance.za(767),this.shortcutKeyManager.Mi(176))),this.OJ.push(this.Kk("Cut",Ve.a.instance.za(511),Ve.a.instance.za(768),
this.shortcutKeyManager.Mi(172))),this.OJ.push(this.Kk("Copy",Ve.a.instance.za(512),Ve.a.instance.za(769),this.shortcutKeyManager.Mi(174))),this.OJ.push(this.Kk("AlignTop_MLR",Ve.a.instance.za(791),Ve.a.instance.za(792))),this.OJ.push(this.Kk("AlignMiddle_MLR",Ve.a.instance.za(793),Ve.a.instance.za(794))),this.OJ.push(this.Kk("AlignBottom_MLR",Ve.a.instance.za(795),Ve.a.instance.za(796))),this.OJ.push(this.Kk("AlignLeft_MLR",Ve.a.instance.za(797),Ve.a.instance.za(799))),this.OJ.push(this.Kk("AlignCenter_MLR",
Ve.a.instance.za(800),Ve.a.instance.za(801))),this.OJ.push(this.Kk("AlignRight_MLR",Ve.a.instance.za(802),Ve.a.instance.za(803))),this.OJ.push(this.Kk("IncreaseIndent",Ve.a.instance.za(804),Ve.a.instance.za(805))),this.OJ.push(this.Kk("DecreaseIndent",Ve.a.instance.za(806),Ve.a.instance.za(807))),this.OJ.push(this.Kk("Wrap",Ve.a.instance.za(808),Ve.a.instance.za(809))),this.OJ.push(this.Kk("Merge",Ve.a.instance.za(810),Ve.a.instance.za(811))),this.OJ.push(this.Kk("NumberFormatPercentage_MLR",Ve.a.instance.ha(453),
Ve.a.instance.za(814),this.shortcutKeyManager.Mi(404))),this.OJ.push(this.Kk("NumberFormatComma_MLR",Ve.a.instance.za(815),Ve.a.instance.za(816))));return this.OJ}get Ikh(){this.Yq||(this.Yq=[],this.Yq.push(this.Kk("UndoRedo",Ve.a.instance.za(83),"",this.isMac?this.shortcutKeyManager.Mi(191):this.shortcutKeyManager.Mi(153))),this.Yq.push(this.Kk("FormatPainter",Ve.a.instance.ha(14),Ve.a.instance.za(770))),this.Yq.push(this.Kk("FontName_New",Ve.a.instance.za(771),Ve.a.instance.za(772))),this.Yq.push(this.Kk("FontSize",
Ve.a.instance.za(773),Ve.a.instance.za(774))),this.Yq.push(this.Kk("Bold",Ve.a.instance.ha(1333),Ve.a.instance.za(775),this.isMac?this.shortcutKeyManager.Mi(180):this.shortcutKeyManager.Mi(179))),this.Yq.push(this.Kk("Italic",Ve.a.instance.ha(1334),Ve.a.instance.za(776),this.isMac?this.shortcutKeyManager.Mi(184):this.shortcutKeyManager.Mi(183))),this.Yq.push(this.Kk("BordersSplitButtonCompactMenu",Ve.a.instance.za(777),Ve.a.instance.za(779),this.isMac?this.shortcutKeyManager.Mi(190):this.shortcutKeyManager.Mi(189))),
this.Yq.push(this.Kk("FillColor",Ve.a.instance.ha(537),Ve.a.instance.za(780))),this.Yq.push(this.Kk("FontColor",Ve.a.instance.za(781),Ve.a.instance.za(782))),this.Yq.push(this.Kk("GrowFontSize",Ve.a.instance.za(783),Ve.a.instance.za(784),this.shortcutKeyManager.Mi(187))),this.Yq.push(this.Kk("ShrinkFontSize",Ve.a.instance.za(785),Ve.a.instance.za(786),this.shortcutKeyManager.Mi(188))),this.Yq.push(this.Kk("Underline",Ve.a.instance.ha(1335),Ve.a.instance.za(787),this.isMac?this.shortcutKeyManager.Mi(182):
this.shortcutKeyManager.Mi(181))),this.Yq.push(this.Kk("Strikethrough",Ve.a.instance.ha(1336),Ve.a.instance.za(788),this.isMac?this.shortcutKeyManager.Mi(186):this.shortcutKeyManager.Mi(185))),this.Yq.push(this.Kk("DoubleUnderline",Ve.a.instance.za(789),Ve.a.instance.za(790))),this.Yq.push(this.Kk("NumberFormatNew",Ve.a.instance.za(812),Ve.a.instance.za(813))),this.Yq.push(this.Kk("NumberFormatAccountingNew",Ve.a.instance.ha(449),Ve.a.instance.za(817))),this.Yq.push(this.Kk("IncreaseDecimal",Ve.a.instance.za(818),
Ve.a.instance.za(819))),this.Yq.push(this.Kk("DecreaseDecimal",Ve.a.instance.za(820),Ve.a.instance.za(821))),this.Yq.push(this.Kk("ConditionalFormatting",Ve.a.instance.za(822),Ve.a.instance.za(823))),this.Yq.push(this.Kk("CellStylesGallery",Ve.a.instance.za(824),Ve.a.instance.za(825))),this.Yq.push(this.Kk("FormatAsTableAlt",Ve.a.instance.za(826),Ve.a.instance.za(827))),this.Yq.push(this.Kk("Format",Ve.a.instance.za(828),Ve.a.instance.za(829))),this.Yq.push(this.Kk("AutoSum",Ve.a.instance.za(830),
Ve.a.instance.za(831),this.shortcutKeyManager.Mi(259))),this.Yq.push(this.Kk("SortAndFilter",Ve.a.instance.za(832),Ve.a.instance.za(833))),this.Yq.push(this.Kk("FindAndSelect",Ve.a.instance.za(834),Ve.a.instance.za(835),this.shortcutKeyManager.Mi(85))),this.Yq.push(this.Kk("AnalyzeData",Ve.a.instance.za(836),Ve.a.instance.za(837))),this.Yq.push(this.Kk("Sensitivity",Ve.a.instance.za(838),Ve.a.instance.za(839))),this.Yq.push(this.Kk("InsertCells",Ve.a.instance.ha(345),Ve.a.instance.za(840),this.shortcutKeyManager.xZ?
this.shortcutKeyManager.Mi(409):"")),this.Yq.push(this.Kk("DeleteCells",Ve.a.instance.ha(409),Ve.a.instance.za(841),this.shortcutKeyManager.xZ?this.shortcutKeyManager.Mi(407):"")),this.Yq.push(this.Kk("ClearCells",Ve.a.instance.za(842),Ve.a.instance.za(843))));return this.Yq}get Xhk(){this.sP||(this.sP=[],this.sP.push(this.Kk("Undo",this.F9d(2),Ve.a.instance.za(765),this.isMac?this.shortcutKeyManager.Mi(191):this.shortcutKeyManager.Mi(153))),this.sP.push(this.Kk("Redo",this.Rvg(2),Ve.a.instance.za(766),
this.isMac?this.shortcutKeyManager.Mi(192):this.shortcutKeyManager.Mi(154))),this.sP.push(this.Kk("UndoRedo",this.F9d(2),"",this.isMac?this.shortcutKeyManager.Mi(191):this.shortcutKeyManager.Mi(153))));return this.sP}Kk(G,pa,kb,Zb){return{commandId:G,title:pa,description:kb,shortcut:Zb,Ari:Zb?!0:!1}}S9a(G){let pa;pa=G.title;G.Ari&&(pa+=" "+G.shortcut);"UndoRedo"!==G.commandId&&(pa+="\n\n"+G.description);return pa}F9d(G){switch(G){case 1:case 0:return G=Ve.a.instance.za(81);case 3:return G=Ve.a.instance.za(84);
case 2:return G=Ve.a.instance.za(83);case 4:return G=Ve.a.instance.za(82);default:return G=Ve.a.instance.za(81)}}Rvg(G){switch(G){case 1:case 0:return G=Ve.a.instance.za(78);case 2:return G=Ve.a.instance.za(80);case 4:return G=Ve.a.instance.za(79);default:return G=Ve.a.instance.za(78)}}Dlk(){var G=this.Kk("InsertCells",Ve.a.instance.ha(345),Ve.a.instance.za(840),this.shortcutKeyManager.xZ?this.shortcutKeyManager.Mi(409):"");const pa=this.Kk("DeleteCells",Ve.a.instance.ha(409),Ve.a.instance.za(841),
this.shortcutKeyManager.xZ?this.shortcutKeyManager.Mi(407):"");G=[appChrome.actions.setControlCustomTooltip(G.commandId,this.S9a(G)),appChrome.actions.setControlCustomTooltip(pa.commandId,this.S9a(pa))];appChrome.api.dispatch(G)}};tf=Object(Ke.a)([Object(nc.d)(Oc.kb),Object(Ke.b)(0,Object(Oc.fb)())],tf);Object(Fa.a)(tf,"ExtendedTooltipsManager",null,[5]);var Qf=a(354);const ig=(G,pa)=>{pa=void 0===pa?!1:pa;G=new $g.Range(G.top,G.left,G.bottom,G.right,!1,pa);if(pa&&(1>G.top||G.top>G.maxRows||1>G.bottom||
G.bottom>G.maxRows||G.top>G.bottom||1>G.left||G.left>G.maxColumns||1>G.right||G.right>G.maxColumns||G.left>G.right))throw X.ULS.sendTraceTag(510247817,0,10,"Range.ValidateRange: range is invalid"),Error.argument("Range.ValidateRange: range is invalid");return G};var df=a(882),Nf=a(819),Mf=a(323),Qg=a(813);const Tg={[0]:[45],[1]:[46]};class Bh{constructor(G){this.$=G;this.sessionStorage=new Map;this.doUndo=()=>{const pa=this;return Ko(function*(){yield Object(df.d)(pa.$)})};this.highlightRangesOnGrid=
(pa,kb,Zb)=>{const Lc=this;return Ko(function*(){Lc.highlightRanges(pa,kb,Tg[Zb])})};this.openCustomNumberFormat=()=>{const pa=this;return Ko(function*(){return new Promise(kb=>{Object(df.a)(pa.$,Zb=>{kb(Zb);X.ULS.sendTraceTag(509617692,0,50,`HostAppCallbacks.openCustomNumberFormat: resolved with "${Zb?"OK":"Cancel"}"`)})})})};this.openFeedback=pa=>{const kb=this;return Ko(function*(){Object(df.e)(kb.$,pa)})};this.sendOtelEvent=pa=>Ko(function*(){Object(Nf.b)(pa)});this.containsHiddenCells=pa=>l(this.$,
pa);this.getSessionStorageItem=(pa,kb)=>{const Zb=this;return Ko(function*(){var Lc;return null===(Lc=Zb.sessionStorage.get(pa))||void 0===Lc?void 0:Lc.get(kb)})};this.setSessionStorageItem=(pa,kb,Zb)=>{const Lc=this;return Ko(function*(){var Bd;Lc.sessionStorage.has(pa)||Lc.sessionStorage.set(pa,new Map);null===(Bd=Lc.sessionStorage.get(pa))||void 0===Bd?void 0:Bd.set(kb,Zb)})};this.replaceMultipleStrings=(pa,kb,Zb,Lc)=>{const Bd=this;return Ko(function*(){const he=pa.map(Ie=>ig(Ie,!1));return v(Bd.$,
he,kb,Zb,{["SheetName"]:Bd.$.pa.sheetName,["MatchCase"]:Lc.matchCase,["MatchEntireCell"]:Lc.matchEntireCell,["SearchAllSheets"]:!1,["ExcludeFormulaResult"]:!1,["SearchUp"]:!1,["SearchStrings"]:kb,["ReplaceWholeWordOnly"]:Lc.replaceWholeWordOnly})})};this.trimWhitespace=(pa,kb)=>{const Zb=this;return Ko(function*(){const Lc=pa.map(Bd=>ig(Bd,!1));return x(Zb.$,Lc,kb.map(r))})};this.formatCells=(pa,kb)=>{const Zb=this;return Ko(function*(){const Lc=pa.map(he=>ig(he,!1)),Bd={NumberFormatOptions:Object(Fd.a)(new Qg.a,
{NumberFormatCategory:-1,CustomFormatString:kb}),ValidMembers:32,NumberFormat:15};return u(Zb.$,Lc,Bd)})}}get grid(){return Yd.h(this.$)}highlightRanges(G,pa,kb){kb=void 0===kb?[45]:kb;const Zb=this.grid.ee;Zb.cn(kb,!1,!0);Zb.Yn(null,kb,!1);if(null===G||void 0===G?0:G.length){const Lc=Qf.a.FFa(Lg.d(this.$.pa),G.map(Bd=>ig(Bd,!1)));Zb.jD(Lc,kb,!0,void 0,!1);pa&&this.Z_i(G)}Zb.update(!1)}Z_i(G){if(null===G||void 0===G?0:G.length){const pa=this.grid;[G]=G.sort((kb,Zb)=>kb.top<Zb.top?-1:kb.top>Zb.top?
1:0);G=$g.Range.ef(G.top,G.left);pa.yI(G)||(X.ULS.sendTraceTag(509617691,0,50,"HostAppCallbacks.moveViewportToRangeIfNeeded moving viewport"),pa.uz(G,0,"DataCleansing"))}else X.ULS.sendTraceTag(509617690,0,10,"HostAppCallbacks.moveViewportToRangeIfNeeded no ranges to move viewport")}}Object(Fa.a)(Bh,"HostAppCallbacks",null,[300]);class bi{constructor(){this.errorState=null;this.isFeedbackAllowed=this.isInCoauthoring=this.isInViewMode=!1}}Object(Fa.a)(bi,"HostState",null,[]);class ni{constructor(){this.sheetName=
this.sheetId=null;this.isProtected=this.isInNamedSheetView=!1}}Object(Fa.a)(ni,"WorksheetState",null,[]);class Kh{constructor(){this.annotations=[];this.hostState=new bi;this.worksheetState=new ni}}Object(Fa.a)(Kh,"DataCleansingHostState",null,[]);class hi{constructor(G){this.$=G;this.KVe=this.JVe=!1}get isEnabled(){return Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)||Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",
!1)}show(G,pa){pa=void 0===pa?!1:pa;const kb=!pa;if(this.isEnabled&&!(pa&&this.KVe||kb&&this.JVe)){if(Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:7813501_CalloutOneSuggestion")){if(1>G){X.ULS.sendTraceTag(508913414,0,50,`DataCleansing.showCallout: suggestion count(${G}).`);return}if(2>G&&kb){X.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${G}) is below threshold to show teaching callout`);return}}else if(2>G){X.ULS.sendTraceTag(509720201,0,50,`DataCleansing.showCallout: suggestion count(${G}) is below threshold to show teaching callout`);
return}X.ULS.sendTraceTag(508887310,0,50,`DataCleansing.showCallout: dispatchShowCalloutCommand. coolDown:(${kb}).`);Object(df.b)(this.$,G,pa);pa?this.KVe=!0:this.JVe=!0}}}Object(Fa.a)(hi,"TeachingCallout",null,[]);class Gg{constructor(G){Gg.assign(Gg,this,G)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static L8(G){return G&&G.H_?G.H_.T_:void 0}static QBb(G){return G&&G.H_&&G.H_.B_?G.H_.B_:[]}static j9e(G){const pa=Gg.L8(G);return pa?[pa,...Gg.QBb(G)]:[]}static vG(G,
pa){if(!Array.isArray(pa)||0===pa.length)return!0;const kb=Gg.L8(G);G=Gg.QBb(G);for(const Zb of pa)if(Zb===kb||0<=G.indexOf(Zb))return!0;return!1}static assign(G,pa,kb){if(kb)for(const Zb of Object.keys(kb))pa[Zb]=kb[Zb];pa.H_=G.H_;return pa}}Gg.H_={T_:Gg.getTypeName(),B_:Gg.getBaseTypes()};class ti{constructor(G){Gg.assign(ti,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_CleanDataResolverAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,
[ti.getTypeName()])}}ti.H_={T_:ti.getTypeName(),B_:ti.getBaseTypes()};class Ah{constructor(G){Gg.assign(Ah,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,[Ah.getTypeName()])}}Ah.H_={T_:Ah.getTypeName(),B_:Ah.getBaseTypes()};class If{constructor(G){Gg.assign(If,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=
G}static getTypeName(){return"AugLoop_ExcelCleanData_ExtraSpacesTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,[If.getTypeName()])}}If.H_={T_:If.getTypeName(),B_:If.getBaseTypes()};class dg{constructor(G){Gg.assign(dg,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotationBase"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,
[dg.getTypeName()])}}dg.H_={T_:dg.getTypeName(),B_:dg.getBaseTypes()};class Dg{constructor(G){Gg.assign(Dg,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_Tablelint_TableLintAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,[Dg.getTypeName()])}}Dg.H_={T_:Dg.getTypeName(),B_:Dg.getBaseTypes()};class Yf{constructor(G){Gg.assign(Yf,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=
G}static getTypeName(){return"AugLoop_Tablelint_TableLintColumnAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,[Yf.getTypeName()])}}Yf.H_={T_:Yf.getTypeName(),B_:Yf.getBaseTypes()};class zg{constructor(G){Gg.assign(zg,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_Tablelint_TableLintErrorAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase",
"AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,[zg.getTypeName()])}}zg.H_={T_:zg.getTypeName(),B_:zg.getBaseTypes()};class hg{constructor(G){Gg.assign(hg,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_Tablelint_TableLintUnsupportedFeatureAnnotation"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintAnnotationBase","AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,[hg.getTypeName()])}}hg.H_={T_:hg.getTypeName(),
B_:hg.getBaseTypes()};class Fg{constructor(G){Gg.assign(Fg,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,[Fg.getTypeName()])}}Fg.H_={T_:Fg.getTypeName(),B_:Fg.getBaseTypes()};class Hh{constructor(G){Gg.assign(Hh,this,G)}static getTypeName(){return"AugLoop_Tablelint_TableLintSuggestion"}static getBaseTypes(){return[]}static typeGuard(G){return Gg.vG(G,
[Hh.getTypeName()])}}Hh.H_={T_:Hh.getTypeName(),B_:Hh.getBaseTypes()};class Wh{constructor(G){Gg.assign(Wh,this,G)}static getTypeName(){return"AugLoop_Tablelint_TableLintTextInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(G){return Gg.vG(G,[Wh.getTypeName()])}}Wh.H_={T_:Wh.getTypeName(),B_:Wh.getBaseTypes()};class Li{constructor(G){Gg.assign(Li,this,G)}static getTypeName(){return"AugLoop_Tablelint_TableLintNumberFormattingInconsistencySuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(G){return Gg.vG(G,
[Li.getTypeName()])}}Li.H_={T_:Li.getTypeName(),B_:Li.getBaseTypes()};class zi{constructor(G){Gg.assign(zi,this,G)}static getTypeName(){return"AugLoop_Tablelint_TableLintExtraSpacesSuggestion"}static getBaseTypes(){return["AugLoop_Tablelint_TableLintSuggestion"]}static typeGuard(G){return Gg.vG(G,[zi.getTypeName()])}}zi.H_={T_:zi.getTypeName(),B_:zi.getBaseTypes()};var Lh=a(881),oi=a(187);class Qi{constructor(G){this.$=G;this.IVe=!1}NTb(G){const pa=this;return Ko(function*(){if(pa.IVe)X.ULS.sendTraceTag(509089825,
0,50,"DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar was already shown.");else{var kb=String.format(Ve.a.instance.Qd(213),G),Zb=oi.a.ha(1952),Lc=oi.a.ha(1954);pa.qLa||(pa.qLa=yield nc.a.resolve(Oc.p,{Oa:1}));pa.qLa.A2j(kb,Lc,Zb,()=>{pa.XPa()});pa.IVe=!0;X.ULS.sendTraceTag(509089824,0,50,`DataCleansingBusinessBar.showBusinessBar: Data cleansing business bar with  ${G} suggestions.`)}})}XPa(){this.qLa&&this.qLa.HH(70)&&this.qLa.removeEntry(70)}}Object(Fa.a)(Qi,"BusinessBar",null,
[]);var oh=a(162),Eh;const Hg=Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingDisableTaskPaneWhenALSessionClose",!1);let Rg=Eh=class extends qe.a{constructor(G,pa){super();this.$=G;this.Ytb=pa;this.Mdc=!1;this.V9=new Kh;this.sTf=(kb,Zb)=>{const Lc=this;return Ko(function*(){Lc.PUi(Zb.sheetId,Zb.annotations);Lc.stateChanged();yield Lc.Xif()})};this.Em=(kb,Zb)=>{const Lc=this;return Ko(function*(){Lc.Utg(Zb.ZC);Lc.Png(Zb.pa);Lc.stateChanged();Lc.businessBar.XPa();yield Lc.Xif()})};
this.mqa=()=>{this.stateChanged()};this.yE=()=>{this.stateChanged()};this.i$=()=>{this.stateChanged()};this.EUf=(kb,Zb)=>{var [Lc,Bd]=Zb;X.ULS.sendTraceTag(509613389,0,50,`DataCleansingHostManager.onUnrecoverableErrorOccurred: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:Lh.a[Lc],["errorCode"]:Bd})}`);Hg&&(this.V9.hostState.errorState=Bd,this.stateChanged())};this.u$=(kb,Zb)=>{Lg.m(Zb.item)&&Zb.item.yk!==this.V9.worksheetState.isProtected&&(X.ULS.sendTraceTag(509613388,
0,50,`DataCleansingHostManager.onSheetOptionsChanged: sheet protection has changed to ${Zb.item.yk}.`),this.stateChanged())};this.rqa=(kb,Zb)=>{T(this.$,Zb)&&this.Odc()};this.S3g=new Bh(this.$);this.Wog=new hi(this.$);this.businessBar=new Qi(this.$);pa.g1g(this.sTf);pa.v1g(this.EUf);void pa.z2c();G.fo.zj(this.Em);G.ea.Jca(this.yE);G.ea.R0(this.i$);this.Png(this.$.pa);this.R6b(this.rqa);Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:7985428_AddingIsFeedbackAllowed")&&this.$.p$c(()=>{this.stateChanged()})}R6b(G){this.addHandler(Eh.n4d,
G)}I6f(G){this.removeHandler(Eh.n4d,G)}dispose(){this.Ytb.mFj(this.sTf);this.Ytb.yFj(this.EUf);this.$.fo.dk(this.Em);this.$.ea.baa(this.yE);this.$.ea.q4(this.i$);this.Utg(this.$.pa);super.dispose()}get state(){this.V9.annotations=this.Ytb.V2g();if(Lg.m(this.$.pa)){const G=this.$.pa.yk,pa=this.$.pa.sheetId,kb=this.$.pa.sheetName;this.V9.worksheetState.isInNamedSheetView=this.$.pa.Ag.yv;this.V9.worksheetState.isProtected=G;this.V9.worksheetState.sheetId=pa;this.V9.worksheetState.sheetName=kb}this.V9.hostState.isInViewMode=
!this.$.ea.isEditMode;this.V9.hostState.isInCoauthoring=this.isInCoauthoring();Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:7985428_AddingIsFeedbackAllowed")&&(this.V9.hostState.isFeedbackAllowed=this.$.isFeedbackEnabled);return this.V9}Odc(){this.businessBar.XPa();this.Mdc=!0}isInCoauthoring(){return!1}stateChanged(){this.raiseEvent(Eh.n4d,this.state)}Png(G){Lg.m(G)&&(G.Ag.$2a(this.mqa),G.c3a(this.u$))}Utg(G){Lg.m(G)&&(G.Ag.qhb(this.mqa),G.mCc(this.u$))}wUg(){if(!Lg.m(this.$.pa))return 0;const G=
this.Ytb.L0d(this.$.pa.sheetId);return D(G)?H(G):0}vUg(){if(!Lg.m(this.$.pa))return new Map;const G=this.Ytb.L0d(this.$.pa.sheetId);return D(G)?N(G):new Map}PUi(G,pa){X.ULS.sendTraceTag(509698241,0,50,`DataCleansingHostManager.logPotentialSuggestionsInfo: ${JSON.stringify({["sheetId"]:G,["suggestionsInfo"]:Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8186077_DataCleansingRefactorSuggestionsCountLogic")?L(I(pa)):K(pa),["numberFormatTypes"]:Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8186077_DataCleansingRefactorSuggestionsCountLogic")?
J(pa.filter(Yf.typeGuard)):z(J(pa.filter(Yf.typeGuard)).entries())},Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8186077_DataCleansingRefactorSuggestionsCountLogic")?F:void 0)}`)}get uBh(){return Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityBusinessBar",!1)}Xif(){const G=this;return Ko(function*(){var pa=Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8222616_RefineDiscoverabilityTriggers");const kb=pa?G.vUg():new Map;if(pa){pa=kb.values();let Lc=
0;for(Zb of pa)Lc+=Zb;var Zb=Lc}else Zb=G.wUg();0===Zb?G.businessBar.XPa():G.v1j(Zb,kb)&&(G.uBh?(yield G.dfk(Zb),G.Mdc=!0):G.afk(Zb))})}afk(G){Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTeachingCallout",!1)&&this.Wog.isEnabled&&this.Wog.show(G,!1)}dfk(G){const pa=this;return Ko(function*(){yield pa.businessBar.NTb(G)})}v1j(G,pa){return Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8222616_RefineDiscoverabilityTriggers")?this.Mdc||T(this.$,this.state)||2>G||!pa.get("TextInconsistency")?
!1:!0:!this.Mdc&&0<G&&!(Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode)}};Rg.n4d="scek";Rg=Eh=Object(Ke.a)([Object(nc.d)(Oc.N),Object(Ke.b)(0,Object(Oc.fb)()),Object(Ke.b)(1,Object(Oc.L)())],Rg);Object(Fa.a)(Rg,"DataCleansingHostManager",qe.a,[]);class fi{constructor(G){Gg.assign(fi,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_RowsIdentityAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,
[fi.getTypeName()])}}fi.H_={T_:fi.getTypeName(),B_:fi.getBaseTypes()};class ui{constructor(G){Gg.assign(ui,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_DuplicatedRowsAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,[ui.getTypeName()])}}ui.H_={T_:ui.getTypeName(),B_:ui.getBaseTypes()};class Mi{constructor(G){Gg.assign(Mi,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=
G}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersColumnAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,[Mi.getTypeName()])}}Mi.H_={T_:Mi.getTypeName(),B_:Mi.getBaseTypes()};class Ti{constructor(G){Gg.assign(Ti,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_UnprintableCharactersTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,
[Ti.getTypeName()])}}Ti.H_={T_:Ti.getTypeName(),B_:Ti.getBaseTypes()};class vi{constructor(G){Gg.assign(vi,this,G)}get metadata(){return this.M_}set metadata(G){this.M_=G}static getTypeName(){return"AugLoop_ExcelCleanData_DataOutlierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(G){return Gg.vG(G,[vi.getTypeName()])}}vi.H_={T_:vi.getTypeName(),B_:vi.getBaseTypes()};class Sj extends qe.a{constructor(G,pa){super();this.ala=!1;this.Zng=(kb,Zb)=>{kb=Zb.annotation;
if(!kb)X.ULS.sendTraceTag(508560025,306,50,"AnnotationsProvider.suggestionsAnnotationHandler suggestionsAnnotation is null.");else if(!If.typeGuard(kb)||Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_UseNewExtraSpacesLinter",!1))switch(Zb.operationType){case 1:case 2:this.raiseEvent("sarek",kb);break;case 3:break;default:X.ULS.sendTraceTag(508560024,306,15,`AnnotationsProvider.suggestionsAnnotationHandler Received unexpected OperationType:${Zb.operationType}`)}};
this.v9f=(kb,Zb)=>{if(Zb.annotation)switch(Zb.operationType){case 1:case 2:this.raiseEvent("rarek",Zb.annotation);break;case 3:break;default:X.ULS.sendTraceTag(508560027,306,15,`AnnotationsProvider.resolverAnnotationHandler Received unexpected OperationType:${Zb.operationType}`)}else X.ULS.sendTraceTag(508560028,306,50,"AnnotationsProvider.resolverAnnotationHandler: resolverAnnotation is null.")};this.nak=(kb,Zb)=>{X.ULS.sendTraceTag(508560023,306,50,`AnnotationsProvider.TableLintColumnAnnotationStateUpdateHandler Received state update: ${kb}->${Zb}`)};
this.mj=G;this.b5i=pa}z2c(){this.ala?X.ULS.sendTraceTag(508560026,0,50,"AnnotationsProvider.ActivateEvents: Events are already registered"):(this.Yzj(),this.ala=!0)}dispose(){this.ala&&(this.Sik(),this.ala=!1)}o1g(G){this.addHandler("sarek",G)}sFj(G){this.removeHandler("sarek",G)}Q0g(G){this.addHandler("rarek",G)}UEj(G){this.removeHandler("rarek",G)}Yzj(){X.ULS.sendTraceTag(574482312,0,50,"AnnotationsProvider.RegisterTableLintEvents: activate annotations");const G=this.mj.p2().L4("DataCleansing").J4(this.b5i).activateAnnotation({annotationType:Yf.getTypeName(),
uu:!0,RCe:this.nak,vGa:this.Zng}).activateAnnotation({annotationType:zg.getTypeName(),uu:!0}).activateAnnotation({annotationType:hg.getTypeName(),uu:!0});Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDuplicatedRowsLinter",!1)&&G.activateAnnotation({annotationType:ui.getTypeName(),uu:!0});Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindUnprintableCharacters",!1)&&G.activateAnnotation({annotationType:Ti.getTypeName(),uu:!0});(Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_CombinedExtraSpacesSuggestions",
!1)||Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_UseNewExtraSpacesLinter",!1))&&G.activateAnnotation({annotationType:If.getTypeName(),uu:!0,vGa:this.Zng});Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FindDataOutliers",!1)&&G.activateAnnotation({annotationType:vi.getTypeName(),uu:!0});Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugmentationLoopTableLint_ActivateResolver",!1)?G.activateAnnotation({annotationType:ti.getTypeName(),
uu:!0,vGa:this.v9f}):G.activateAnnotation({annotationType:Fg.getTypeName(),uu:!0,vGa:this.v9f});this.mj.register(G.build())}Sik(){this.mj.unregister("DataCleansing")}}Object(Fa.a)(Sj,"AnnotationsProvider",qe.a,[5]);var Ej;let wj=Ej=class extends qe.a{constructor(G){super();this.$=G;this.aDc=new Map;this.fOd=new Map;this.U4d=new Map;this.Yvc=(pa,kb)=>{pa=void 0===pa?"Unknown":pa;X.ULS.sendTraceTag(520987272,0,50,`DataCleansingAnnotationsManager.onAugmentationLoopSessionClose: Received augmentation loop session close. ${JSON.stringify({["closeReason"]:Lh.a[pa],
["errorCode"]:kb})}`);this.raiseEvent(Ej.Z7d,[pa,kb])};this.YTf=(pa,kb)=>{this.fOd.set(kb.id,kb);X.ULS.sendTraceTag(512354457,0,100,`DataCleansingAnnotationsManager.onColumnAnnotationReceived: Received ${kb.id}`)};this.aKf=(pa,kb)=>{pa=this.aDc.get(kb.worksheetId);X.ULS.sendTraceTag(512354456,0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received ${JSON.stringify({["id"]:kb.id,["sheetId"]:kb.worksheetId,["previous"]:null===pa||void 0===pa?void 0:pa.id})}`);(null===pa||void 0===
pa?void 0:pa.id)===kb.id&&X.ULS.sendTraceTag(512354455,0,50,`DataCleansingAnnotationsManager.onAggregateAnnotationReceived: Received duplicate ${kb.id}`);this.aDc.set(kb.worksheetId,kb);pa=this.Hfi(kb);pa.forEach(Zb=>{this.fOd.delete(Zb.id)});this.U4d.set(kb.id,pa);this.I3g(kb.worksheetId)}}g1g(G){this.addHandler(Ej.M0d,G)}mFj(G){this.removeHandler(Ej.M0d,G)}v1g(G){this.addHandler(Ej.Z7d,G)}yFj(G){this.removeHandler(Ej.Z7d,G)}dispose(){this.KKa&&(this.KKa.sFj(this.YTf),this.KKa.UEj(this.aKf),this.KKa.dispose());
super.dispose()}z2c(){const G=this;return Ko(function*(){const pa=yield nc.a.resolve(Oc.j,{Oa:1});pa?(G.KKa=new Sj(pa,G.Yvc),G.KKa.o1g(G.YTf),G.KKa.Q0g(G.aKf),G.KKa.z2c(),X.ULS.sendTraceTag(520987274,0,50,"DataCleansingAnnotationsManager.activateEvents: events activated")):X.ULS.sendTraceTag(520987273,0,10,"DataCleansingAnnotationsManager.activateEvents: no augmentationLoopManager")})}L0d(G){var pa;if(G=this.aDc.get(G)){const kb=null!==(pa=this.U4d.get(G.id))&&void 0!==pa?pa:[];return[G,...kb]}return[]}V2g(){const G=
[];this.aDc.forEach(pa=>{var kb;const Zb=null!==(kb=this.U4d.get(pa.id))&&void 0!==kb?kb:[];G.push(pa,...Zb)});return G}I3g(G){G={sheetId:G,annotations:this.L0d(G)};this.raiseEvent(Ej.M0d,G)}Hfi(G){var pa=Array.from(this.fOd.values()).filter(Lc=>Lc.worksheetId===G.worksheetId);if(!pa.length)return X.ULS.sendTraceTag(509682374,0,50,"DataCleansingAnnotationsManager.getRelatedPendingAnnotations: No pending sheet annotations"),[];if(!Array.isArray(G.aggregatedAnnotations))return X.ULS.sendTraceTag(509682373,
0,20,"DataCleansingAnnotationsManager.getRelatedPendingAnnotations: No aggregated annotations IDs"),pa;const kb=new Set(G.aggregatedAnnotations),Zb=pa.filter(Lc=>kb.has(Lc.id));pa=pa.filter(Lc=>!kb.has(Lc.id));pa.length&&X.ULS.sendTraceTag(509682372,0,50,`DataCleansingAnnotationsManager.getRelatedPendingAnnotations: Found ${pa.length} unrelated annotations`);return Zb}};wj.M0d="sacek";wj.Z7d="ueoek";wj=Ej=Object(Ke.a)([Object(nc.d)(Oc.L),Object(Ke.b)(0,Object(Oc.fb)())],wj);Object(Fa.a)(wj,"DataCleansingAnnotationsManager",
qe.a,[]);class kj extends fd.a{constructor(G,pa,kb,Zb,Lc){Lc=void 0===Lc?null:Lc;super();this.Mtb=null;this.suf=!1;this.QC=()=>{this.MFb&&X.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.lKb}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.BQa}, AggregatedActionParams not null: ${this.MFb}`);this.Rwd()};this.YTg=G;this.ZTg=pa;this.documentVisibilityObserver=kb;this.lKb=Zb;this.LO=Lc;kb&&this.documentVisibilityObserver.$W(this.QC)}get BQa(){return this.suf}get MFb(){return!!this.Mtb}fXf(G){X.ULS.sendTraceTag(537153864,
0,50,`ActionAggregator<${this.lKb}>.PerformThrottledAction: Start. IsActionOngoing: ${this.BQa}, AggregatedActionParams not null: ${this.MFb}`);this.Mtb=this.ZTg.fCe(G,this.Mtb);this.Rwd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.ZDa(this.QC);super.dispose()}Ffg(G){this.suf=G}YVh(){X.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.lKb}>.FinishedCallback: Start. IsActionOngoing: ${this.BQa}, AggregatedActionParams not null: ${this.MFb}`);this.Ffg(!1);this.Rwd()}Rwd(){if(!this.JTb()){var G=
this.Mtb;this.Mtb=null;this.Ffg(!0);X.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.lKb}>.InternalPerformAction: Calling PerformAction.`);Ec.TaskExtensions.Aa(this.YTg.bXf(G),()=>{this.YVh()},Nd.a.none,0,this.LO)}}JTb(){return!this.MFb||this.BQa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Cj?(X.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.lKb}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}}Object(Fa.a)(kj,"ActionAggregator",
fd.a,[297,5]);var Tj=a(92);class xj extends qe.a{constructor(G){super();this.Bz=this.firstElement=null;this.YQa=!1;this.Uv=null;this.rZj=Za.a.Zh;this.FPf=pa=>{const kb=pa.Da.keyCode;return kb===Tj.a.tn?this.F8i():kb===Tj.a.XG&&pa.Da.shiftKey?this.uSh(this.firstElement):!1};this.fVf=pa=>{if(!this.YQa||pa.Da.keyCode!==Tj.a.TO)return!1;xj.bmf();Jb.Task.delay(1).hv(()=>{this.Bz.focus();return!0},0,this.ma);return!0};this.Aij=()=>{document.activeElement&&document.activeElement.id===this.Bz.id||(xj.bmf(),
Jb.Task.delay(1).hv(()=>{this.Bz.focus();return!0},0,this.ma))};this.yNf=()=>{this.frg(this.Bz)};this.EPf=pa=>{pa.stopPropagation();pa.preventDefault();this.YQa&&(this.YQa=!1)};this.$=G;(G=this.$.ea.Je)&&X.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${G.fxa}; InWebPart = '${G.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${G.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);G&&(G.inWebPart||G.inEmbedView)?X.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${G.inWebPart?
"Classic":"Non Classic"}', InEmbedView = '${G.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.drh(),this.dsh(),Wf.KeyInputManager.instance.va(Lf.a.Ne,this.$.domElement,this.fVf));this.$.ia.Va(238,this)}D_g(G){this.addHandler("KBIS",G)}SDj(G){this.removeHandler("KBIS",G)}dispose(){this.firstElement&&Bi.a.removeHandler(this.firstElement,Lf.a.focus,this.yNf);this.Uv&&this.Uv.detach("focus");this.Bz&&(Bi.a.removeHandler(this.Bz,Lf.a.focus,this.EPf),Bi.a.removeHandler(this.Bz,Lf.a.blur,xj.onBlur),
Wf.KeyInputManager.instance.Ca(Lf.a.Ne,this.Bz,this.FPf));Wf.KeyInputManager.instance.Ca(Lf.a.Ne,this.$.domElement,this.fVf);this.Uv=this.Bz=this.firstElement=this.$=null;super.dispose()}drh(){this.rZj?(this.firstElement=document.documentElement,this.Uv=hd.a.instance.WM(document.parentWindow),this.Uv.la("focus",this.Aij)):(this.firstElement=xj.ZQe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),Bi.a.addHandler(this.firstElement,Lf.a.focus,this.yNf))}dsh(){this.Bz=xj.ZQe();
this.Bz.id=ne.a.KYe;this.Bz.setAttribute(ne.a.nx,Ve.a.instance.ha(863));document.body.appendChild(this.Bz);Bi.a.addHandler(this.Bz,Lf.a.focus,this.EPf);Bi.a.addHandler(this.Bz,Lf.a.blur,xj.onBlur);Wf.KeyInputManager.instance.va(Lf.a.Ne,this.Bz,this.FPf)}uSh(G){this.frg(G);return!1}F8i(){this.YQa=!0;Yd.h(this.$).focus();Yd.h(this.$).ga.ijf();this.raiseEvent("KBIS");return!0}frg(G){this.YQa?this.YQa=!1:(this.YQa=!0,G&&G.focus())}static ZQe(){const G=document.createElement("div");G.tabIndex=0;return G}static bmf(){document.body.classList.add(W.a.i0e)}static onBlur(){document.body.classList.remove(W.a.i0e)}}
Object(Fa.a)(xj,"EmbedViewFocusControl",qe.a,[296,5]);var bk=a(72),ck=a(533),dk=a(127);class Ij extends qe.a{constructor(G,pa){super();this.$Qb=this.Nod=this.uCb=this.rS=null;this.f1b=!1;this.Hfe=null;this.Ioa=this.eRd=!1;this.t$i=(kb,Zb,Lc)=>{X.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Lc);this.$Qb&&this.$Qb.stop();this.rS=null;this.raiseEvent("GetFieldInfoListContextOperationFailed")};this.u$i=kb=>{Pe.a(kb)||(this.$Qb&&this.$Qb.stop(),this.f1b=!1,(this.rS=
kb.Result)&&0<this.rS.length&&X.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.rS.length} rich value field list context for autocomplete`),this.q0a=!0,this.nAc())};this.q0a=!1;this.Pd=G;this.J_b=-1;this.gg=pa;this.eRd=Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults");this.Ioa=Vb.EwaSettings.Ioa()}e4c(G){this.addHandler("FieldInfoListContextLoaded",G)}cUd(G){this.removeHandler("FieldInfoListContextLoaded",G)}b_g(G){this.addHandler("GetFieldInfoListContextOperationFailed",
G)}uDj(G){this.removeHandler("GetFieldInfoListContextOperationFailed",G)}get Myd(){return this.q0a}get rSi(){return this.f1b}get S7e(){return this.J_b}get ned(){return this.Hfe}get $(){return this.Pd}get Sr(){return this.rS}get l8h(){return!!this.uCb}dispose(){this.Pd=null;this.VCc();super.dispose()}l9a(G,pa,kb,Zb){Zb=void 0===Zb?null:Zb;if(G){this.o9c();this.U9b();var Lc=null,Bd=!1;if(!Zb&&(()=>{let he=this.xgk(G,pa,kb);({Afb:Bd,Sr:Lc}=he);return he})().returnValue)if(this.eRd||this.Geg(Lc),this.f1b=
!0,this.rS=Lc,this.eRd){if(!Bd){this.q0a=!0;this.nAc();return}}else if(this.rS&&0<this.rS.length&&(this.q0a=!0,this.nAc()),!Bd)return;this.mvg(G,Zb,pa,kb,!1)}}mvg(G,pa,kb,Zb,Lc){if(this.$.ea.Ee){this.$.pe&&(this.$Qb=this.$.pe.xf("WebServiceCall","GetRichValueFieldInfoListContext"));this.uCb=null;var Bd=this.$.qa.ua.ze(),he=this.$.qa.ua,Ie=this.u$i,ff=this.t$i;const qf=he.Pa(1,null);qf.selectedRange=G;qf.richValueKeyPath=pa;qf.singleColumn=kb;qf.searchForRange=Zb;qf.calculateMajorityDataType=Lc;this.uCb=
Ob.g(he,"GetRichValueFieldListContextList",qf,Ie,ff,null,Bd,4)}else this.rS=null}VCc(){this.rS=null;this.q0a=!1;this.o9c();this.U9b();this.uCb=null;this.J_b=-1}o9c(){Ij.Wvb(this.uCb)}U9b(){Ij.Wvb(this.Nod)}nAc(){this.raiseEvent("FieldInfoListContextLoaded")}ru(G){G=fe.E(G);--G.left;--G.right;return this.gg.ru(G)}POa(G){G.FirstColumn=G.FirstColumn;G.LastColumn=G.LastColumn;G.FirstRow=G.FirstRow;G.LastRow=G.LastRow;this.U9b();this.Nod=null;return od.a(this.$.userOperationManager,(pa,kb,Zb)=>Mf.k(this.$.qa.ua,
G,$d.b(pa,Lc=>{this.D$i(Lc)}),$d.a(kb,kb,Lc=>{this.C$i(Lc)}),Zb,null),pa=>new ae.a(264,0,pa,80),null)}C$i(G){G=dk.a.kh(G.data);X.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${Gd.a.Me(G)}`)}D$i(G){if(Pe.a(G))-315732528!==G.Errors[0].MessageId&&X.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${Gd.a.Me(G.Errors)}`);else if(G&&G.Result){G=G.Result;var pa=
G.HasHeaderRow;pa=new ck.AutofilterRange(G.TableRange.FirstRow+(pa?1:0)+1,G.TableRange.FirstColumn+1,G.TableRange.LastRow+1,G.TableRange.LastColumn+1,null,null,null,0,pa);this.J_b=G.TableRange.FirstColumn;(G=this.q_f(!1,!0,pa))||X.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.Geg(G)}else X.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}xgk(G,pa,kb){let Zb,Lc;
Lc=null;Zb=!1;if(G.SheetName!==this.$.ea.pa.sheetName)return{returnValue:!1,Afb:Zb,POa:!1,Sr:Lc};let Bd;this.J_b=-1;if(kb){Bd=this.ru(G);if(!Bd||!Bd.doa)return{returnValue:!1,Afb:Zb,POa:!1,Sr:Lc};var he=this.Ioa?(he=Yd.h(this.$).Ud.uff(Bd))&&0<he.size:(he=Yd.h(this.$).Ud.vff(Bd))&&0<he.count;this.Hfe=Bd;if(Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&he)return--G.FirstColumn,--G.LastColumn,this.Nod=this.POa(G),{returnValue:!0,
Afb:Zb,POa:!0,Sr:Lc};Bd.top+=1;Bd.right=fe.E(G).right-1}else Bd=new ck.AutofilterRange(G.FirstRow+1,G.FirstColumn+1,G.LastRow+1,G.LastColumn+1,null,null,null,0,!1);if(Bd.top>Bd.bottom||Bd.left>Bd.right)return{returnValue:!0,Afb:Zb,POa:!1,Sr:Lc};G=Yd.h(this.$);var Ie=G.Gd.width,ff=G.Gd.height;he=G.view.visibleArea;Ie=new bk.a(he.x-Ie,he.y-ff,he.width+Ie,he.height+ff);ff=G.hj(Bd);if(!he||!ff||!G.uqc(Bd))return{returnValue:!1,Afb:Zb,POa:!1,Sr:Lc};Ie.contains(ff)||(Zb=!0);Lc=this.q_f(pa,kb,Bd);return{returnValue:!0,
Afb:Zb,POa:!1,Sr:Lc}}Geg(G){G&&X.ULS.sendTraceTag(25264348,0,50,`Retrieved ${G.length} rich value field contexts from block cache`);this.f1b=!0;(this.rS=G)&&0<this.rS.length&&(this.q0a=!0,this.nAc())}q_f(G,pa,kb){let Zb;Zb=null;const Lc=kb.clone();if(pa)for(let Bd=kb.right,he=0;Bd>=kb.left;--Bd){if(Lc.left=Bd,Lc.right=Bd,pa=this.Zaf(Lc,!0,kb.left)){Zb||(Zb=[]);Zb[he]=pa;if(G)break;++he}}else if(G=this.Zaf(Lc,!1))Zb=[],Zb[0]=G;return Zb}Zaf(G,pa,kb){kb=void 0===kb?0:kb;var Zb=null;let Lc=[];if(this.Ioa){var Bd=
Yd.h(this.$).Ud.uff(G);if(!Bd||0>=Bd.size)return Zb;Lc=Array(Bd.size);let Ie=0;Bd.forEach(ff=>{let qf={};qf.Name=ff.Value;qf.RefersToDotFunction=ff.RefersToDotFunction;Lc[Ie]=qf;++Ie})}else{var he=Yd.h(this.$).Ud.vff(G);if(!he||0>=he.count)return Zb;Lc=Array(he.count);Zb=0;for(Bd of he.values)he={},he.Name=Bd,Lc[Zb]=he,++Zb}Bd="";he=-1;0<G.top&&pa&&(G=new $g.Range(G.top-1,G.left,G.top-1,G.left,!1,!1),null!=Yd.h(this.$).Zd(G)&&null!=Yd.h(this.$).Zd(G).originalText&&(Bd=Yd.h(this.$).Zd(G).originalText),
he=G.left-kb);Zb={};Zb.ColumnName=Bd;Zb.ColumnIndex=he;Zb.FieldInfoDataList=Lc;return Zb}static Wvb(G){G&&va.AFrameworkApplication.Wf.cy(G.ox)}}Object(Fa.a)(Ij,"FieldInfoManager",qe.a,[242,5]);class ik extends Ij{constructor(G,pa,kb,Zb){super(G,pa);this.i7a=null;this.sNf=()=>{this.cUd(this.sNf);if(this.Sr&&this.Sr.length&&this.contextMenuManager){var Lc=this.contextMenuManager.Ynd("autoFilterRichFieldList"),Bd=window.document.getElementById(this.i7a);Lc.Gaa(null,Bd,this,null,!0)}};this.XFg=kb;this.contextMenuManager=
Zb}get iK(){return this.XFg}x8h(G,pa){this.i7a=pa;X.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${G.FirstRow}, ${G.FirstColumn}, ${G.LastRow}, ${G.LastColumn})`);this.mvg(G,null,!0,!1,!0)}}Object(Fa.a)(ik,"FilterInfoManager",Ij,[243,242,5]);var jk=a(960),kk=a(1118);class rj{}rj.HMh="ewa-sharedUi-launchButton";rj.KMh="ewa-sharedUi-launchButtonWithText";rj.IMh="ewa-sharedUi-launchButtonClick";
rj.LMh="ewa-sharedUi-launchButtonWithTextClick";rj.JMh="ewa-sharedUi-launchButtonText";Object(Fa.a)(rj,"CssClassNames",null,[]);a(524);var tk=a(298),ek=a(77),lk=a(264);class Uj extends af.a{constructor(G,pa,kb,Zb,Lc,Bd,he,Ie,ff){super(document.createElement("div"));this.dzf=null;this.d3d=!1;this.De=this.mVb=this.EXa=null;this.XQ=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.WQ=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.f5j=()=>{this.ixe()};this.Of=qf=>{this.raiseEvent(this.bOb,qf);
this.Sfb();return!0};this.k8i=qf=>{100<jb.a(Ud.a.Jd,this.dzf)&&this.ltd(new Sys.UI.Point(Math.round(qf.clientX),Math.round(qf.clientY)))};this.SQ=qf=>{ek.g(qf.Da,!1);return!1};this.R1=this.Vg.AMa();this.set_visible(!1);this.Yqc=Lc;this.bOb=Bd;this.vvc=G;this.T$b=pa;this.De=ff;this.Yqc&&(this.EXa=$c.a.instance.create(this.f5j,3E4,"OnObjectButton.ShyTimerFired",!1,!1));G&&this.domElement.classList.add(G);this.vvb=document.createElement("div");this.domElement.appendChild(this.vvb);kb&&this.vvb.classList.add(kb);
this.B8d(Zb);he&&(this.mVb=document.createElement("div"),this.domElement.appendChild(this.mVb),this.mVb.classList.add(Ie),this.mVb.innerText=he,this.domElement.style.padding="3px",Sg.a.instance.va(Lf.a.Cf,this.domElement,this.SQ));this.u4a=new tk.a(this.domElement,7);lf.a.instance.va(Lf.a.click,this.domElement,this.Of);Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Sg.a.instance.va(Lf.a.Cf,this.domElement,this.SQ);G=qf=>{ek.g(qf)};this.uf.la("mouseup",
G);this.uf.la("click",G);this.uf.la("dblclick",G)}S0(G){this.addHandler(this.bOb,G)}X$(G){this.get_events().removeHandler(this.bOb,G)}V_g(G){this.addHandler("OnObjectButtonMouseOver",G)}iEj(G){this.get_events().removeHandler("OnObjectButtonMouseOver",G)}U_g(G){this.addHandler("OnObjectButtonMouseOut",G)}hEj(G){this.get_events().removeHandler("OnObjectButtonMouseOut",G)}B8d(G){G&&this.De.dl(this.vvb,G)}Vjk(G,pa,kb){var Zb=16,Lc=16;Zb=void 0===Zb?0:Zb;Lc=void 0===Lc?0:Lc;this.De.oK(this.vvb);G?G.ffa(pa,
16,16,this.vvb,Zb,Lc,void 0,kb):X.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}Wjk(G,pa){G&&(this.mVb.innerText=G);this.domElement.title=pa}dispose(){this.get_isInitialized()&&(this.hide(),this.uf.VH(),nf.a.df([this.R1,this.u4a]),lf.a.instance.Ca(Lf.a.click,this.domElement,this.Of),Sg.a.instance.Ca(Lf.a.Cf,this.domElement,this.SQ),this.EXa&&this.EXa.dispose(),super.dispose())}LQb(){this.T$b&&this.domElement.classList.remove(this.T$b);this.vvc&&
this.domElement.classList.add(this.vvc)}Sfb(){this.vvc&&this.domElement.classList.remove(this.vvc);this.T$b&&this.domElement.classList.add(this.T$b);this.x7a()}x7a(){this.Yqc&&(this.EXa.cancel(),this.Zmg(),this.setOpacity(1));this.set_visible(!0)}Po(G,pa,kb,Zb,Lc){Lc=void 0===Lc?!1:Lc;G=xf.a(Zb).mk(G);pa=xf.a(Zb).mk(pa);xf.a(Zb).AFc(this.domElement);this.domElement.style.top=Tf.HelperMethods.yf(pa);this.domElement.style.left=this.domElement.style.right="";pa=G;Lc&&(pa=G-this.domElement.offsetWidth);
lk.c(this.domElement.style,kb,Tf.HelperMethods.yf(pa));this.set_visible(!0);this.setOpacity(1);this.Yqc&&(this.d3d=!1,this.e8j(),this.EXa.Vt())}hide(){this.LQb();this.set_visible(!1);this.Yqc&&(this.Zmg(),this.EXa.cancel())}Bhd(){this.uf.la("mouseover",this.XQ,!0);this.uf.la("mouseout",this.WQ,!0)}e8j(){this.R1.jl("mousemove")||this.R1.la("mousemove",this.k8i)}Zmg(){this.R1.jl("mousemove")&&this.R1.detach("mousemove")}ltd(G){if(this.domElement.parentNode){var pa=Sys.UI.DomElement.getBounds(this.domElement);
const kb=new Sys.UI.Point(Math.round(pa.x+pa.width),Math.round(pa.y+pa.height));pa=Math.abs(kb.x-G.x);G=Math.abs(kb.y-G.y);G=pa>G?pa:G;this.d3d?this.setOpacity(Uj.ldh(G)):100>=G&&this.ixe()}}ixe(){this.d3d=!0;this.EXa.cancel()}setOpacity(G){Za.a.setOpacity(this.domElement,G);this.dzf=Ud.a.Jd.Re}static ldh(G){return 100>=G?1:250<=G?0:.01*(100-(G-100)/150*100)}}Object(Fa.a)(Uj,"OnObjectButton",af.a,[313,210,5]);var Mj=a(809);const uk=rj.JMh;class fk extends fd.a{constructor(G,pa,kb,Zb,Lc,Bd,he,Ie,ff){ff=
void 0===ff?"":ff;super();this.qAa=null;this.Fmf=!1;this.De=this.Suc=this.Tuc=null;this.buttons={};this.z_e={};this.$=G;this.svgIconProvider=pa;this.x6i=kb;this.yvd=Zb;this.xvd=Lc;this.altText=Bd;this.bOb=he;this.De=Ie;this.buttonText=ff}get Dy(){return xf.a(this.$).BKa(id.a.ydj)}get ewb(){return id.a.xdj}get buttonWidth(){return xf.a(this.$).BKa(id.a.zdj)}dispose(){this.iCh();this.$=null;super.dispose()}getButton(G,pa){return this.jza(G,void 0===pa?!0:pa)}jza(G,pa){const kb=G.toString();kb in this.buttons||
this.fsh(G,void 0===pa?!0:pa);return this.buttons[kb]}Po(G,pa,kb,Zb,Lc,Bd){Lc=void 0===Lc?!0:Lc;Bd=void 0===Bd?!1:Bd;this.hide();if(this.$.ea.isNamedObjectViewMode&&Lg.i(this.$.pa)){var he=Yd.h(this.$).yV.domElement;const Ie=G+this.buttonWidth-he.scrollWidth;he=pa+this.buttonWidth-he.scrollHeight;G=0<Ie?G-Ie:G;pa=0<he?pa-he:pa}this.jza(Zb,Lc).Po(G,pa,kb,this.$,Bd)}hide(){const G=this.buttons;for(let pa in G)G[pa].hide()}Bhd(G,pa){!this.Fmf&&(pa=this.buttons[pa.toString()])&&(this.Tuc=(kb,Zb)=>{G(Zb,
!0)},pa.V_g(this.Tuc),this.Suc=(kb,Zb)=>{G(Zb,!1)},pa.U_g(this.Suc),this.Fmf=!0,pa.Bhd())}fsh(G,pa){this.qAa=String.format(this.yvd===W.a.Mfc?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Ua.a.Bm(this.yvd),Ua.a.Bm(this.xvd),"{0}");var kb=String.format(this.qAa,Ua.a.Bm(this.altText));pa=new Uj(""===this.buttonText?rj.HMh:rj.KMh,""===this.buttonText?rj.IMh:rj.LMh,W.a.MM,kb,pa,this.bOb,
this.buttonText,uk,this.De);kb=(Zb,Lc)=>{this.x6i(Lc,G)};pa.S0(kb);this.buttons[G.toString()]=pa;this.z_e[G.toString()]=kb;kb=Yd.h(this.$).mi(G);kb.domElement.insertBefore(pa.domElement,kb.domElement.firstChild)}iCh(){for(const G of Mj.a(this.buttons)){const pa=this.buttons[G];pa.X$(this.z_e[G]);nf.a.Ma(pa);delete this.buttons[G];this.Tuc&&pa.iEj(this.Tuc);this.Suc&&pa.hEj(this.Suc)}}domElement(G){return this.jza(G).domElement}x7a(G){this.jza(G).x7a()}KWb(G,pa,kb){kb=void 0===kb?!0:kb;this.qAa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
Ua.a.Bm(this.yvd),Ua.a.Bm(this.xvd),"{0}");G=String.format(this.qAa,Ua.a.Bm(G));this.jza(pa,kb).B8d(G)}aZa(G,pa,kb){this.jza(kb,!1).Wjk(G,pa)}kvg(){var G=void 0===G?!1:G;this.qAa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",Ua.a.Bm(this.xvd),"{1}");const pa=String.format(this.qAa,void 0,Ua.a.Bm(void 0));this.jza(void 0,G).B8d(pa)}lLc(G,pa,kb){this.jza(kb,!1).Vjk(this.svgIconProvider,G,pa)}}Object(Fa.a)(fk,"OnObjectLaunchButton",
fd.a,[293,5]);var Jj=a(100);class Nj extends Jj.a{constructor(G,pa){super(G);this.EJb=null;this.QBh=()=>{this.display()};this.evi=Math.max(1,pa)}dispose(){nf.a.Ma(this.EJb);this.EJb=null;super.dispose()}SXa(){nf.a.Ma(this.EJb);this.EJb=$c.a.instance.create(this.QBh,this.evi,Yc.a.vSi)}ZXa(){nf.a.Ma(this.EJb);this.hide()}}Object(Fa.a)(Nj,"LoadingIndicatorBehavior",Jj.a,[311,5]);class mk extends Nj{constructor(G,pa,kb,Zb){super(G,pa);this.DJb=null;this.vIg=kb;this.qsi=Zb;this.wWg()}dispose(){this.DJb=
null;super.dispose()}display(){this.vIg(this.DJb)}hide(){this.qsi(this.DJb)}wWg(){this.DJb=document.createElement("div");this.domElement.appendChild(this.DJb)}}Object(Fa.a)(mk,"ShimmerLoadingIndicatorBehavior",Nj,[]);var Vj=a(68),Wj=a(54);class nk extends Nj{constructor(G,pa,kb,Zb,Lc,Bd){Zb=void 0===Zb?null:Zb;Lc=void 0===Lc?null:Lc;Bd=void 0===Bd?0:Bd;super(G,pa);this.J$a=this.uSa=null;this.J$a=kb;this.Tmc=Zb||Wj.a.current.Jq(102);this.YAf=Bd;this.sed=Lc;this.vWg()}dispose(){this.uSa=null;super.dispose()}display(){Ff.DOMElementExtensions.setVisible(this.uSa,
!0)}hide(){Ff.DOMElementExtensions.setVisible(this.uSa,!1)}vWg(){this.uSa=document.createElement("div");this.uSa.classList.add(Vj.a.RLh);const G=document.createElement("div");G.classList.add(Vj.a.SLh);this.sed&&""!=this.sed&&G.classList.add(this.sed);const pa=0===this.YAf?"":Ve.a.instance.ha(this.YAf),kb=String.format('<div class="'+Vj.a.TLh+'">{0}</div>',pa);this.Tmc?this.J$a.dl(G,`<img src="${this.Tmc}" alt="${pa}" title="${pa}"/>`+kb):this.J$a.dl(G,kb);this.uSa.appendChild(G);this.domElement.appendChild(this.uSa)}}
Object(Fa.a)(nk,"SpinnerLoadingIndicatorBehavior",Nj,[]);Object(nc.b)(Oc.Zc)(G=>Ko(function*(){const pa=yield nc.a.resolve(Oc.Mb,{Oa:G.Oa});return new Xj(pa)}));class Xj{constructor(G){this.J$a=G}rdd(G,pa,kb){return new jk.a(G,pa,kb)}Rbc(G,pa,kb,Zb,Lc,Bd,he,Ie,ff,qf){return new kk.a(G,pa,kb,Zb,Lc,Bd,he,Ie,ff,qf)}ayb(G,pa,kb,Zb,Lc){return new nk(G,pa,this.J$a,kb,Zb,void 0===Lc?0:Lc)}tqd(G){return G.ia.Ja(238)||new xj(G)}Rxb(G,pa,kb,Zb,Lc,Bd,he,Ie){return new fk(G,pa,kb,Zb,Lc,Bd,he,this.J$a,void 0===
Ie?"":Ie)}XQe(G,pa){return new Ij(G,pa)}Zqh(G,pa,kb,Zb){return new ik(G,pa,kb,Zb)}aQe(G,pa,kb,Zb){return new kj(G,pa,kb,Zb)}}Object(Fa.a)(Xj,"SharedUIControlsFactory",null,[285]);let Pj=class{constructor(G,pa){this.X6c=this.VFe=this.Y6c=0;this.UFe=!1;this.proactiveSuggestionCard=null;this.G5a=this.zOe=!1;this.sessionCount=this.autoAdjustColumnWidthSettings=0;this.zF=!1;this.vf=(kb,Zb)=>{X.ULS.sendTraceTag(508363741,0,50,"AutoAdjustColumnsManagerService::onSessionIdChanged detected.");Zb.Ee?this.initialize():
X.ULS.sendTraceTag(508360707,0,15,"AutoAdjustColumnsManagerService::onSessionIdChanged but session is still not active.");this.$.ea.gm(this.vf)};this.kMd=kb=>{if(Gd.a.Ph(kb.Errors)){const Zb=kb.Errors[0].MessageId;Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")&&-315732528===Zb||X.ULS.sendTraceTag(508641556,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${Gd.a.Me(kb.Errors)}.`)}else kb.Result&&(this.autoAdjustColumnWidthSettings=
parseInt(kb.Result,10),this.G5a=0!==(this.autoAdjustColumnWidthSettings&3),this.sessionCount=(this.autoAdjustColumnWidthSettings&65280)>>8),this.zF=2!==(this.autoAdjustColumnWidthSettings&2),this.UFe||0!==(this.autoAdjustColumnWidthSettings&2)||(0===this.sessionCount&&(this.G5a=!1),this.Vui())};this.lMd=kb=>{kb=dk.a.kh(kb.data);X.ULS.sendTraceTag(508641555,0,10,`AutoAdjustColumnWidth.onReadWriteRoamingStringFailure: Encountered errors while reading/writing roaming setting. Errors: ${Gd.a.Me(kb)}.`)};
this.bNd=kb=>{Gd.a.Ph(kb.Errors)?X.ULS.sendTraceTag(508641554,0,10,`AutoAdjustColumnWidth.onWriteRoamingStringSuccess: encountered an error. Errors: ${Gd.a.Me(kb.Errors)}`):kb.Result||X.ULS.sendTraceTag(508641553,0,10,"AutoAdjustColumnWidth.onWriteRoamingStringSuccess failed to write to roaming service.")};this.Eej=kb=>{if(Gd.a.Ph(kb.Errors))X.ULS.sendTraceTag(508641552,0,10,`AutoAdjustColumnWidth.onReadRoamingStringSuccess encountered an error. Errors: ${Gd.a.Me(kb.Errors)}.`);else{var Zb=0;kb.Result&&
(Zb=parseInt(kb.Result,10));Zb=Zb&-4|this.autoAdjustColumnWidthSettings&3;this.wzg(Zb)}};this.RLf=()=>{Pg.a("AutoAdjustColumnWidthKeepOn");0===(this.autoAdjustColumnWidthSettings&1)&&(this.autoAdjustColumnWidthSettings|=1,this.V1f());this.G5a=!0;this.proactiveSuggestionCard.hide()};this.V6i=()=>{this.Mlh();this.proactiveSuggestionCard.hide()};this.yjj=()=>{Pg.a("AutoAdjustColumnWidthHelp");let kb=new Hb.a(-859308420,Te.a.Td,this.$.Ie,9,null);this.$.Ga.Sd(kb,{[Te.a.di]:"HelpID=151880",["InputMethod"]:Te.a.Td,
["ShouldCanvasTakeFocus"]:!0,[Te.a.qf]:ne.a.AN,[ne.a.nia]:!0})};this.Qaj=()=>{const kb={};kb[ne.a.aI]="AutoAdjustColumnWidth";this.$.rf(802602464,Te.a.Td,8,kb)};this.Qhj=()=>{Pg.a("AutoAdjustColumnWidthTurnedOff");this.autoAdjustColumnWidthSettings|=2;this.V1f();this.G5a=!0;this.proactiveSuggestionCard.hide();this.zF=!1};this.$=G;this.proactiveSuggestionCard=pa;this.VFe=Vb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmThreshold",5);this.X6c=Vb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.AutoAdjustColumnConfirmSessionCycle",
5);this.UFe=0===this.X6c;!Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:8157898_AutoAdjustColumnCheckIsSessionActive")||this.$.ea.Ee?this.initialize():this.$.ea.Yl(this.vf)}dispose(){this.proactiveSuggestionCard&&this.proactiveSuggestionCard.dispose();this.$=null}initialize(){X.ULS.shipAssertTag(508641557,0,Re.a.Coa(),"AutoAdjustColumnWidth feature is off");Mf.y(this.$.qa.ua,5,this.kMd,this.lMd,null,null)}wzg(G){Mf.F(this.$.qa.ua,5,G.toString(),this.bNd,this.lMd,null,null)}Vui(){if(2!==(this.autoAdjustColumnWidthSettings&
2)){var G=this.sessionCount+1;G>=this.X6c&&(G=0);this.wzg(this.autoAdjustColumnWidthSettings&-65281|G<<8)}}V1f(){Mf.y(this.$.qa.ua,5,this.Eej,this.lMd,null,null)}rKf(G){if(0===this.Y6c){const pa=[];pa.push(Hi.a.Ci("Command",G,2));Pg.a("AutoAdjustedColumnWidth",void 0,void 0,pa)}++this.Y6c;X.ULS.shipAssertTag(508641551,0,0===(this.autoAdjustColumnWidthSettings&2),"AutoAdjustedColumns when AutoAdjustColumnWidthSettings is Off");!this.G5a&&this.Y6c>=this.VFe&&this.Llh()}Llh(){if(null!=this.proactiveSuggestionCard){Pg.a("AutoAdjustColumnWidthDialog");
var G=Ve.a.instance.za(858),pa=Ve.a.instance.za(859),kb=Ve.a.instance.za(860),Zb=Ve.a.instance.za(861),Lc=Ve.a.instance.za(863);this.proactiveSuggestionCard.show(Yd.h(this.$).ga.ra.Ef,G,pa,kb,Zb,this.RLf,this.V6i,this.Ujc(),void 0,void 0,"WrapText",void 0,void 0,void 0,void 0,!1,!1,Lc,this.Qaj);this.zOe?this.G5a=!0:this.zOe=!0}}Ujc(){return[{key:"learnMessage",text:Ve.a.instance.za(862),onClick:this.yjj}]}Mlh(){const G=Ve.a.instance.za(864),pa=Ve.a.instance.za(865),kb=Ve.a.instance.za(866),Zb=Ve.a.instance.za(861);
this.proactiveSuggestionCard.show(Yd.h(this.$).ga.ra.Ef,G,pa,kb,Zb,this.RLf,this.Qhj,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,!1,!1,void 0,void 0)}};Pj=Object(Ke.a)([Object(nc.d)(Oc.k),Object(Ke.b)(0,Object(Oc.fb)()),Object(Ke.b)(1,Object(Oc.Fc)())],Pj);Object(Fa.a)(Pj,"AutoAdjustColumnsManager",null,[5,283]);Object(nc.b)(Oc.tc,{nr:"singleton"})(()=>{O();const G=Y.a.instance.resolve("Common.App.PenMinutesManager.IPenMinutesManager");G.Nfg();return G});var Yj;let Qj=Yj=class{constructor(){this.N3a=
null;this.wMd=pa=>{X.ULS.sendTraceTag(508421248,0,50,`DMS call to get SDX list succeeds with status ${pa.data.httpStatus}.`);this.QDb(pa.data.Fg)};this.vMd=pa=>{200<=pa.data.httpStatus&&300>pa.data.httpStatus?(X.ULS.sendTraceTag(508421219,0,50,`DMS call to get SDX list succeeds with status ${pa.data.httpStatus}.`),this.QDb(pa.data.Fg)):X.ULS.sendTraceTag(508421218,0,15,`DMS call to get SDX list fails with status ${pa.data.httpStatus}.`)};const G=Vb.EwaSettings.getStringFeatureGate("Microsoft.Office.ExcelOnline.SdxManifestPrefetchAssetIds",
"");""!==G&&(this.N3a=G.split(";"),this.mPd())}mPd(){const G=ug.a.create().toString();X.ULS.sendTraceTag(508421250,0,50,`Start calling DMS to retrieve the list of SDXs to prefetch (dmsActivityId = ${G}).`);va.AFrameworkApplication.Wf.zp(Wj.a.current.FB.SdxDmsUrl,2,Yj.Hdd(),Yj.Idd(G),!1,4,this.wMd,this.vMd,null)}QDb(G){try{const pa=ba.b(G).Packages;for(const kb of pa)if(this.N3a.includes(kb.AssetId)){const Zb=String.format(Wj.a.current.FB.SdxCdnUrl,kb.AssetId,kb.FFN,kb.Version,"en-us");Wj.a.nOb(Zb,
!1,null,!0)}window.prefetchedDmsResponse=G}catch(pa){X.ULS.sendTraceTag(508421249,0,15,`Failed to parse DMS response: "${G.substring(0,40)}...".`)}}static Hdd(){const G=Object(db.a)(String,va.AFrameworkApplication.Ge.AudienceGroup)||"";return ba.c({["Context"]:{["Hosts"]:["Workbook"],["ReactNativeVersion"]:"0.0.0.0",["Channel"]:"DevMain",["Capabilities"]:[{["Name"]:"addincommands",["Version"]:"1.1"},{["Name"]:"bindingevents",["Version"]:"1.1"},{["Name"]:"biplatvisualrichapi",["Version"]:"1.8"},{["Name"]:"customfunctions",
["Version"]:"1.9"},{["Name"]:"customfunctionsruntime",["Version"]:"1.2"},{["Name"]:"compressedfile",["Version"]:"1.1"},{["Name"]:"DataFromPicture",["Version"]:"1.1"},{["Name"]:"pivotfilters",["Version"]:"1.2"},{["Name"]:"pdffile",["Version"]:"1.1"},{["Name"]:"dialogapi",["Version"]:"1.2"},{["Name"]:"dialogorigin",["Version"]:"1.2"},{["Name"]:"documentevents",["Version"]:"1.1"},{["Name"]:"excelapi",["Version"]:"1.12"},{["Name"]:"excelapionline",["Version"]:"1.1"},{["Name"]:"excelapiundo",["Version"]:"1.4"},
{["Name"]:"firstpartyauthentication",["Version"]:"1.1"},{["Name"]:"identityapi",["Version"]:"1.3"},{["Name"]:"matrixbindings",["Version"]:"1.1"},{["Name"]:"matrixcoercion",["Version"]:"1.1"},{["Name"]:"numberformatting",["Version"]:"1.2"},{["Name"]:"pivot",["Version"]:"1.5"},{["Name"]:"richapiruntime",["Version"]:"1.2"},{["Name"]:"richapiruntimeflag",["Version"]:"1.2"},{["Name"]:"selection",["Version"]:"1.1"},{["Name"]:"settings",["Version"]:"1.1"},{["Name"]:"sharedruntime",["Version"]:"1.1"},{["Name"]:"tablebindings",
["Version"]:"1.1"},{["Name"]:"tablecoercion",["Version"]:"1.1"},{["Name"]:"tablestyle",["Version"]:"1.1"},{["Name"]:"textbindings",["Version"]:"1.1"},{["Name"]:"textcoercion",["Version"]:"1.1"},{["Name"]:"file",["Version"]:"1.1"},{["Name"]:"webauth",["Version"]:"1.1"}],["Ring"]:"Automation"===G?"Dogfood":G,["Platform"]:"Web",["Locales"]:[va.AFrameworkApplication.uiCulture],["ClientId"]:va.AFrameworkApplication.da.Ra("LoggableUserId")},["SyncId"]:0})}static Idd(G){return{["Content-Type"]:"application/json",
["DMSActivityId"]:G}}};Qj=Yj=Object(Ke.a)([Object(nc.d)(Oc.Uc)],Qj);Object(Fa.a)(Qj,"SdxManifestPrefetcher",null,[]);var ok=a(791),gk=a(221),hk=a(211);class pk{constructor(){this.jSg=new sa.a;this.kSg=new sa.a}get sYa(){return this.jSg}get Epg(){return this.kSg}get fA(){return this.wbk}ZXg(G,pa){this.sYa.add(G);this.Epg.add(pa)}$Xg(G,pa){this.wbk={OHd:G,FGd:pa}}}Object(Fa.a)(pk,"ThemeInfoCache",null,[]);var vk=a(53);let Zj=class{constructor(G){this.sYa=this.OO=null;this.jpc=!1;this.X5d=null;this.Auc=
new Set;this.pkb=this.BVc=!1;this.GAb=0;this.Haj=pa=>{this.jpc=!1;if(!pa||Pe.a(pa))X.ULS.sendTraceTag(556656004,0,15,`ThemesManager: The obtained result has errors, [Error: ${pa?Gd.a.Me(pa.Errors):"(no result)"}]`),this.U9f();else if(this.GAb=0,pa=pa.Result){this.oo&&null!==this.OO&&this.Ykh(pa);this.OO=new pk;if(this.rG){this.sYa=pa.ThemeColors;this.X5d=[];for(var kb=0;10>kb;kb++)this.X5d.push(ok.a.fPa(gk.a.eI(this.sYa[kb])));for(kb=0;6>kb;kb++)for(let Zb=0;10>Zb;Zb++){const Lc=hk.a.yha(hk.a.nJ(this.sYa[10*
kb+Zb])),Bd=ok.a.Ibi(kb,Zb,this.X5d[Zb],this.sYa[Zb]);this.OO.ZXg(Lc,Bd)}}this.oo&&(this.OO.$Xg(pa.MinorFont,pa.MajorFont),this.pkb=!1);Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)&&Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NewOfficeDefaultThemeSurvey",!1)&&"Aptos Narrow"===pa.MinorFont&&(pa=vk.a.instance.Gea(new Date),27E4>pa?window.setTimeout(()=>{this.$.rf(-569754003,-1,0,null)},27E4-pa):this.$.rf(-569754003,-1,0,null));this.BVc=!1;this.hha()}else X.ULS.sendTraceTag(556656003,
0,10,"ThemesManager: The obtained ThemeInfo is null")};this.Gaj=()=>{this.jpc=!1;this.U9f()};this.U9f=()=>{3>this.GAb?(this.GAb++,X.ULS.sendTraceTag(509669709,0,50,`ThemesManager::retryFetchThemeInfo - Retry fetchThemeInfo API count = ${this.GAb}`),this.FAb(null,!0)):(this.GAb=0,X.ULS.sendTraceTag(509669708,0,15,"ThemesManager::retryFetchThemeInfo - Maximum retry count for fetchThemeInfo API has reached."))};this.Bxc=()=>{this.OO&&(X.ULS.sendTraceTag(537150473,0,50,"ThemesManager: OnReloadCache"),
this.oo?this.pkb=!0:this.OO=null,this.FAb(null,!0))};this.vf=(pa,kb)=>{this.OO&&(X.ULS.sendTraceTag(537150472,0,50,"ThemesManager: OnSessionIdChanged"),kb.vI&&(this.BVc=!0))};this.TC=()=>{this.Auc.clear()};this.$=G;this.$.ea.dK(this.Bxc);this.$.ea.Yl(this.vf);this.$.Ga.Y2a(this.TC);this.rG=Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.oo=Vb.EwaSettings.oo()}get qkb(){return!this.OO||this.pkb?null:this.OO.sYa}get Dpg(){return!this.OO||this.pkb?null:this.OO.Epg}get fA(){return!this.OO||
this.pkb?null:this.OO.fA}get Xwf(){return this.BVc}FAb(G,pa){if(this.$.isEditMode||(void 0===pa?0:pa))if(!this.OO||this.Xwf||this.pkb)if(G&&""!==G&&this.Auc.add(G),!this.jpc){this.jpc=!0;G=this.$.qa.ua;pa=this.Haj;var kb=this.Gaj;const Zb=G.Pa(1,null);Ob.g(G,"GetThemeInfo",Zb,pa,kb,null,null,4)}}getThemeColor(G){let pa,kb=-1;pa=-1;if(!this.qkb)return X.ULS.sendTraceTag(537150475,0,10,"ThemesManager: ThemeColorsList is null"),{returnValue:!1,themeIndex:-1,BFa:pa};for(let Zb=0;Zb<this.qkb.count;Zb++)if(G===
this.qkb.ka(Zb)){kb=Zb;break}if(-1!==kb)return pa=Math.floor(kb/10),{returnValue:!0,themeIndex:kb%10,BFa:pa};X.ULS.sendTraceTag(537150474,0,10,"ThemesManager: Couldn't find theme color in cache.");return{returnValue:!1,themeIndex:-1,BFa:pa}}hha(){for(let G of this.Auc)this.$.frame.iA(G);this.Auc.clear()}Ykh(G){const pa=this.OO.fA.FGd;this.OO.fA.OHd===G.MinorFont&&pa===G.MajorFont||X.ULS.sendTraceTag(512230155,0,50,"ThemesManager.compareThemeInfoCache: Theme Fonts are updated")}};Zj=Object(Ke.a)([Object(nc.d)(Oc.sd),
Object(Ke.b)(0,Object(Oc.fb)())],Zj);Object(Fa.a)(Zj,"ThemesManager",null,[282]);var qk=a(1195),rk=a(884),Bg=a(1129),Oj=a(1128);let M=class{constructor(G){this.yLa=G}$ld(G,pa){G=G.units;var kb=pa.units;if(G.length!==kb.length)return X.ULS.sendTraceTag(508367051,0,15,"CalcInterfaceAdapter.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;pa=[];let Zb=-1;for(let Lc=0;Lc<G.length;Lc++)switch(G[Lc].kind){case Oj.a.blank:pa.push(...pc.h(" ",
kb[Lc].str.length));break;case Oj.a.string:pa.push(G[Lc].str);break;case Oj.a.r6e:pa.push("");Zb=Lc;break;case Oj.a.general:pa.push(kb[Lc].str);break;default:X.ULS.sendTraceTag(508367050,0,15,"CalcInterfaceAdapter.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=Zb||""===kb[Zb].str)return null;kb={};kb.Start=pa.slice(0,Zb).join("");kb.Separator=G[Zb].str;kb.End=pa.slice(Zb+1,pa.length).join("");return kb}ecf(G){switch(G.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;
default:return X.ULS.sendTraceTag(508367049,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}sbf(G){if(G=G.color){if("String"===Object.getType(G).getName())return hk.a.Hq(G);if("Number"===Object.getType(G).getName())return null}else return null;X.ULS.sendTraceTag(508367048,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}kDi(G,pa){G=this.yLa.calc.getCellValueKind(G.rangeDelta.data.value);switch(G){case "number":case "string":case "boolean":case "Blank":case "Error":return!0;
case "Rich":return pa.numberOfUnsupportedRichCellTypes++,!1;default:return X.ULS.shipAssertTag(508367047,0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${G}`),!1}}r$e(G){G=this.yLa.calc.getCellValueKind(G.rangeDelta.data.value);let pa=0;switch(G){case "number":pa=1;break;case "string":pa=2;break;case "boolean":pa=3;break;case "Error":pa=4;break;case "Blank":pa=0;break;default:X.ULS.shipAssertTag(508367046,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${G}`)}return pa}Oph(G){const pa=
G.value;switch(G.type){case 2:return void 0===pa||null===pa?"":pa;case 1:return G=parseFloat(pa),isNaN(G)?null:G;case 3:return G=parseFloat(pa),isNaN(G)?null:1===G;case 4:return G=parseFloat(pa),isNaN(G)?null:this.yLa.calc.errorValue(G);default:return this.yLa.calc.blankValue}}s$e(G){"kind"in G&&X.ULS.shipAssertTag(508367045,0,G.kind!==rk.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");G=this.yLa.eyk.getValueEditOperKind(G);let pa=0;switch(G){case 0:case 128:pa=
0;break;case 1:pa=1;break;case 2:pa=2;break;case 4:pa=3;break;case 8:pa=4;break;case 16:case 32:case 64:case 256:X.ULS.sendTraceTag(508367044,0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${G} to a CellValueType`);break;default:X.ULS.shipAssertTag(508367043,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${G}`)}return pa}Yef(G,pa){const kb=this.nkc(pa);var Zb=!(void 0===pa.rangeDelta.data.format||null===pa.rangeDelta.data.format);X.ULS.shipAssertTag(508367042,
0,0===kb||!Zb,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${pa.priorityGroup}`);G=Math.max(G.cell.Lj,0);Zb&&(Zb=this.yLa.calc.getCellFormatKind(pa.rangeDelta.data.format.format),"number"===Zb?G=pa.rangeDelta.data.format.format:"string"===Zb?X.ULS.sendTraceTag(508367041,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===Zb?X.ULS.sendTraceTag(508367040,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):
X.ULS.shipAssertTag(508367011,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return G}nkc(G){if(G.priorityGroup===Bg.a.editCell)return 0;if(G.priorityGroup===Bg.a.dependentCell)return 1;X.ULS.sendTraceTag(508367010,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}S$h(G){G=this.nkc(G);if(0===G)return 1;if(1===G)return 2;X.ULS.sendTraceTag(508367009,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");
return 0}g4h(G){return G.rangeDelta.range.column+1}n4h(G){return G.rangeDelta.range.row+1}p$e(G){return G.rangeDelta.data.value.toString()}getCellValueKind(G){return this.yLa.calc.getCellValueKind(G.rangeDelta.data.value)}};M=Object(Ke.a)([Object(nc.d)(Oc.q),Object(Ke.b)(0,Object(Oc.jb)())],M);Object(Fa.a)(M,"CalcInterfaceAdapter",null,[279]);var za=a(112);class Ab{}Ab.local="Local";Ab.zbk="Thread";Object(Fa.a)(Ab,"RecalcServiceCreateMode",null,[]);var ec=a(191);class Ic{constructor(G){this.Uee=null;
this.init(G)}get zda(){return this.Uee}init(G){this.Uee=new fh.a;if(void 0!==G&&null!==G&&void 0!==G.HeadersList&&null!==G.HeadersList&&0<G.HeadersList.length)for(const pa of G.HeadersList)this.zda.fa(pa.Index,pa.Name)}}Object(Fa.a)(Ic,"ColHeadersListData",null,[]);var ed=a(109);class Ed{constructor(G,pa){this.FIe=G;this.sheetName=pa;this.oSb=!1}}Object(Fa.a)(Ed,"CalcBlockInformation",null,[]);class Pd{constructor(G,pa,kb,Zb,Lc){this.type=G;this.fullName=pa;this.range=kb;this.sheetId=Zb;this.attributes=
Lc;this.JH=null}}Object(Fa.a)(Pd,"CalcNamedObject",null,[]);class Ae{get Hm(){return this.Fte}constructor(G){this.Swg=G;this.Fte=[];this.u8d=[];this.O4a={};this.Q0d=new Map}jgg(G,pa){this.Fte[G]=pa;this.Swg&&pa.Aaa&&this.Q0d.set(pa.Aaa.sheetName,G)}getSheetIndex(G){if(this.Swg){if(this.Q0d.has(G))return this.Q0d.get(G)}else for(let pa=1;pa<this.Hm.length;pa++)if(tc.a.equals(this.Hm[pa].Aaa.sheetName,G,!1))return pa;return-1}}Object(Fa.a)(Ae,"GridCache",null,[]);var Me=a(713),zf=a(382);class Df{constructor(G){this.Aaa=
G;this.a$=new Me.a(zf.a.Ei());this.hvc=!1}}Object(Fa.a)(Df,"SheetInformation",null,[]);var fg=a(995),qh;(function(G){G[G.initialization=0]="initialization";G[G.contentReady=1]="contentReady";G[G.cellEdit=2]="cellEdit"})(qh||(qh={}));Object(Fa.b)("UpdateDataTrigger",qh);class og{constructor(G){this.bSd=null;this.HEd=this.aSd=this.mMd=!1;this.XPd=0;this.QPd=this.SPd=this.TPd=this.RPd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.gs=null;this.Av=this.currentStateId=
-1;this.Gxa="";this.Rda=null;this.getNameLoc=(pa,kb)=>this.Npc()?this.Fh.ka(this.currentStateId).Hm[0].a$.Hd(kb)?(pa=excelOnlineCalc.location.nameLoc(pa,kb),excelOnlineCalc.util.success(pa)):excelOnlineCalc.util.success(null):(pa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(pa));this.getContainingTable=pa=>{if(!this.Npc())return pa=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(pa);const kb=pa.range.col,Zb=pa.range.row;var Lc=this.Fh.ka(this.currentStateId).Hm[0].a$,
Bd=null;for(let he of Lc)if(Lc=he.value,2===Lc.type&&tc.a.equals(pa.sheet.index.toString(),Lc.sheetId,!0)){const Ie=Lc.range;kb>=Ie.left-1&&kb<=Ie.right-1&&Zb<=Ie.bottom-1&&Zb>=Ie.top-1&&(Bd=excelOnlineCalc.location.nameScope(this.documentLoc,Lc.sheetId),Bd=excelOnlineCalc.location.nameLoc(Bd,Lc.fullName))}return Bd?excelOnlineCalc.util.success(Bd):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(pa,kb)=>{if(!this.Npc()){var Zb=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(Zb)}Zb=
pa.name;var Lc=this.Fh.ka(this.currentStateId).Hm[0].a$;if(Lc.Hd(Zb)){Lc=Lc.ka(Zb);const he=Lc.range;if(2!==Lc.type)return excelOnlineCalc.util.failure(this.mdd(5));const Ie=Lc.JH?Lc.JH.zda:null;if(!Ie)return excelOnlineCalc.util.success(null);for(var Bd of Ie)if(tc.a.equals(Bd.value,kb,!0))return pa=excelOnlineCalc.location.documentLoc(pa.scope.document.path,pa.scope.document.name),pa=excelOnlineCalc.location.sheetIndex(pa,Lc.sheetId),Bd=excelOnlineCalc.location.gridRange(he.top-1,Bd.key,he.bottom-
he.top+1,1),Bd=excelOnlineCalc.location.sheetGridRange(pa,Bd),Zb=excelOnlineCalc.location.structRefColumnLoc(Zb,Bd,!!(Lc.attributes&16),!!(Lc.attributes&8)),excelOnlineCalc.util.success(Zb);return he.right-he.left+1!==Ie.count?(Zb=excelOnlineCalc.util.unavailable([17,pa,kb]),excelOnlineCalc.util.failure(Zb)):excelOnlineCalc.util.failure(this.mdd(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(pa,kb)=>{if(!this.Npc())return kb=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(kb);
var Zb=this.Fh.ka(this.currentStateId).Hm[0].a$;if(Zb.Hd(pa.name)){var Lc=Zb.ka(pa.name);if(2!==Lc.type)return excelOnlineCalc.util.failure(this.mdd(5));Zb=!!(Lc.attributes&16);const Bd=!!(Lc.attributes&8),he=Zb?1:0,Ie=Bd?1:0;pa=excelOnlineCalc.location.documentLoc(pa.scope.document.path,pa.scope.document.name);pa=excelOnlineCalc.location.sheetIndex(pa,Lc.sheetId);Lc=Lc.range;let ff={};if(1===kb)ff=excelOnlineCalc.location.gridRange(Lc.top-he-1,Lc.left-1,Lc.bottom+Ie-Lc.top+he+1,Lc.right-Lc.left+
1);else if(2===kb)ff=excelOnlineCalc.location.gridRange(Lc.top-1,Lc.left-1,Lc.bottom-Lc.top+1,Lc.right-Lc.left+1);else if(3===kb)if(Zb)ff=excelOnlineCalc.location.gridRange(Lc.top-2,Lc.left-1,1,Lc.right-Lc.left+1);else return excelOnlineCalc.util.success(null);else if(4===kb)if(Bd)ff=excelOnlineCalc.location.gridRange(Lc.bottom,Lc.left-1,1,Lc.right-Lc.left+1);else return excelOnlineCalc.util.success(null);kb=excelOnlineCalc.location.sheetGridRange(pa,ff);return excelOnlineCalc.util.success(kb)}return excelOnlineCalc.util.success(null)};
this.getDocumentLoc=(pa,kb)=>{if((tc.a.equals(pa,this.documentLoc.path,!0)||!pa)&&tc.a.equals(kb,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);pa=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(pa,kb)]);return excelOnlineCalc.util.failure(pa)};this.getSheetIndex=(pa,kb)=>{if(!this.Fh.Hd(this.currentStateId)||!this.Fh.ka(this.currentStateId).Hm)return kb=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(kb);pa=this.Fh.ka(this.currentStateId).Hm;
for(let Zb=1;Zb<pa.length;Zb++)if(tc.a.equals(pa[Zb].Aaa.sheetName,kb,!0))return excelOnlineCalc.util.success(pa[Zb].Aaa.sheetId);return excelOnlineCalc.util.success(null)};this.getSheetName=(pa,kb)=>{if(!this.Fh.Hd(this.currentStateId)||!this.Fh.ka(this.currentStateId).Hm)return kb=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(kb);pa=this.Fh.ka(this.currentStateId).Hm;for(let Zb=1;Zb<pa.length;Zb++)if(tc.a.equals(pa[Zb].Aaa.sheetId,kb,!0))return excelOnlineCalc.util.success(pa[Zb].Aaa.sheetName);
return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.OQf=()=>{this.setNumberFormats()};this.fg=()=>{X.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Fh=new fh.a;this.currentStateId=this.Av=-1;this.Gxa=
"";this.n6a=null;this.aSd=!1;this.gs&&this.clearCache()};this.Kf=G;this.Fh=new fh.a;this.n6a=null;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.Kf.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Zsa();this.bzd=Re.a.bzd();this.z9=Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1)}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.rUd(this.OQf);this.Kf&&this.Kf.uo(this.fg);this.close()}oWb(G){if(!this.gs)return!1;
if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Kf.ia.Ja(268),!this.instantaneousSupportInformationManager))return X.ULS.sendTraceTag(537170198,0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==G&&(this.currentStateId=this.Kf.ea.MU,this.currentStateId===id.a.Gg&&(this.currentStateId=this.Kf.ea.Mg));if(1===G&&this.currentStateId<this.Av)return X.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.Av} - ignoring update`),
!1;this.ySj();0!==G&&this.aSd||(this.jXj(),this.iUj(),this.ZUj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.LAe(this.OQf),this.Kf.zn(this.fg),this.aSd=!0);this.Kwj();let pa=!1;0===G&&(pa=this.Dxi());if(0!==G||pa)this.uWj()?(this.XWj(G),this.WWj(),this.Av=this.currentStateId,this.phh()):X.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==G&&this.resumeRecalc();return!0}evalFormula(G,pa,kb,
Zb){if(!this.gs)return X.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});pa=excelOnlineCalc.calc.sheetCellLocation(null!==kb&&void 0!==kb?kb:Lg.d(this.Kf.ta.pa),pa.top-1,pa.left-1);G=this.gs.evalFormula(this.Kf.ea.Mg,G,pa,Zb);this.resumeRecalc();return G}adh(G,pa,kb,Zb){Zb=void 0===Zb?null:Zb;const Lc=Lg.d(this.Kf.ta.pa);let Bd=G.cell.oI-1,he=G.cell.nI-1;var Ie=Bd,ff=he;let qf=null;Zb&&(qf=excelOnlineCalc.calc.cellLocation(Bd,he),Bd=Zb.top-
1,he=Zb.left-1,Ie=Zb.bottom-1,ff=Zb.right-1);kb=this.fMc(G,kb,"SetCell");0>kb||(ff=og.C7("CalculateFormula.cell",Lc,Bd,he,Ie,ff),Ie=[],Zb=this.Rkc(Lc),pa=excelOnlineCalc.calc.inferredRangeFormulaEdit(ff,pa,qf,Zb),Ie.push(pa),G=(pa=this.qsd())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",Lc,Bd,he,tc.a.NCe(G.cell.text),kb,pa.top-1,pa.left-1,pa.bottom-1,pa.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",
Lc,Bd,he,tc.a.NCe(G.cell.text),kb,"","","",""),X.ULS.sendTraceTag(537170180,0,50,G),this.gs.editRangeFormulas(kb,Ie),this.resumeRecalc())}bdh(G,pa){const kb=[];var Zb=Lg.d(this.Kf.ta.pa),Lc=this.Rkc(Zb);pa=this.fMc(G[0].Uda,pa,"SetCellBatched");if(0>pa)return!1;for(var Bd of G){var he=Bd.Uda.cell.oI-1,Ie=Bd.Uda.cell.nI-1;he=og.C7("CalculateFormulaBatched.cell",Zb,he,Ie,he,Ie);he=excelOnlineCalc.calc.inferredRangeFormulaEdit(he,Bd.editText,null,Lc);kb.push(he)}Lc=this.qsd();Bd=G[0].Uda.cell.oI-1;he=
G[0].Uda.cell.nI-1;Ie=G[G.length-1].Uda.cell.oI-1;G=G[G.length-1].Uda.cell.nI-1;Zb=Lc?String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",Zb,Bd,he,Ie,G,pa,Lc.top-1,Lc.left-1,Lc.bottom-1,Lc.right-1):String.format("CalcAsyncEngine::CalculateFormulaBatched() for sheet:{0} range:({1},{2},{3},{4}) stateId:{5} viewport:(({6},{7})-({8},{9}))",Zb,Bd,he,Ie,G,pa,"","","","");X.ULS.sendTraceTag(508932947,0,50,Zb);this.gs.editRangeFormulas(pa,
kb);this.resumeRecalc();return!0}a2(G,pa,kb,Zb,Lc){if(!this.gs)return X.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!kb||!pa)return X.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!kb}, outputColumnRange null: ${!pa}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");X.ULS.shipAssertTag(537170178,0,kb.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const Bd=Lg.d(this.Kf.ta.pa),he=this.Rkc(Bd);let Ie=null;if(G){Ie=[];for(const eg of G)if(eg.column!==kb.left){G=eg.row-1;var ff=eg.column-1;G=og.C7("EvalFormulaRangeOnClone.cell",Bd,G,ff,G,ff);ff=Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:7459428_TypedValueInCloneWrite")?ch(eg.Jm,eg.formulaBarText,eg.Lj):excelOnlineCalc.calc.valueCellData(eg.text,eg.text,eg.Lj,null);Ie.push(excelOnlineCalc.calc.rangeWrite(G,ff))}}kb=excelOnlineCalc.calc.cellLocation(kb.top-1,kb.left-1);pa=og.C7("EvalFormulaRangeOnClone.outputColumnRange",
Bd,pa.top-1,pa.left-1,pa.bottom-1,pa.right-1);let qf;Lc?this.z9&&(Zb=[excelOnlineCalc.calc.inferredRangeFormulaEdit(pa,Zb,kb,he)],qf=this.gs.evalOnClonedModel(Ie,Zb,Lc)):(Lc=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(pa,Zb,kb,he)],qf=this.gs.evalOnClonedModel(Ie,Lc));this.resumeRecalc();return qf}NSe(G){let pa=null;try{if(G)if(this.Gxa=Yd.h(this.Kf).ya.pna(G),this.currentStateId=G.mFa,this.currentStateId<this.Av||this.currentStateId===id.a.Gg)X.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.Gxa} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.Av}`);
else{if(this.Jxi(),1===G.ez.PaneType&&this.Enk(G.pa),!this.W8g())if(pa=this.Kf.pe.xf("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.Gxa} StateId:${this.currentStateId}`),this.n6a=this.K8(G.pa.sheetName))if(Yd.h(this.Kf).ya.fs.mzb(G.Vf)){var kb=G.Sh;if(kb){var Zb=kb.getCalcBlockModel();if(Zb)if(this.O8g(Zb)){this.Fh.ka(this.currentStateId).O4a[this.Gxa]=new Ed(Zb,G.pa.sheetName);var Lc=G.qg;Lc?this.GWg(Lc.NamedObjects):X.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}else X.ULS.sendTraceTag(509117971,
0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel block is invalid (might be freeze panes removal)");else X.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block")}else X.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.Gxa}`)}else X.ULS.sendTraceTag(509117972,0,50,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel skipping block update because renderStateInfo doesn't have the block");
else{const Bd=!!(this.Kf.hg&32),he=this.Fh.Hd(this.currentStateId)&&this.Fh.ka(this.currentStateId).Hm?this.Fh.ka(this.currentStateId).Hm.length:0;X.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${he}, scratchPad:${Bd}, sheetNameLength:${G.pa.sheetName?G.pa.sheetName.length:-1} Hash:${G.pa.hash}`)}}else X.ULS.shipAssertTag(537170177,0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{pa&&
pa.stop()}}BPa(G){var pa;if(!this.Fh.Hd(this.currentStateId))return X.ULS.sendTraceTag(509646790,0,15,`CalcAsyncEngine.getTableHeaders: stateId ${this.currentStateId} not found in gridCache`),null;const kb=null===(pa=this.Fh.ka(this.currentStateId))||void 0===pa?void 0:pa.Hm;if(!kb||!kb[0])return null;pa=kb[0].a$;if(!pa||!pa.Hd(G.name))return X.ULS.sendTraceTag(509646789,0,15,`CalcAsyncEngine.getTableHeaders: table key found wasn't found in cached named objects list. cached named objects is null: ${null==
pa}`),null;G=pa.ka(G.name);if(!G||!G.JH)return null;pa=new sa.a;for(let Zb of G.JH.zda)pa.add(Zb.value);return pa}cdh(G,pa,kb){var Zb=Yd.h(this.Kf),Lc=Zb.Zd(pa);Lc=this.fMc(Lc,null,"CopyPaste");kb=this.fMc(Zb.Zd(G),kb,"CopyPaste");if(0>Lc||0>kb||Lc!==kb)X.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${kb}, targetRevision:${Lc}.`);else{kb=[];Zb=Lg.d(this.Kf.ta.pa);var Bd=this.Rkc(Zb);G=og.C7("CalculateFormulaForCopyPaste.srcRange",
Zb,G.top-1,G.left-1,G.bottom-1,G.right-1);pa=og.C7("CalculateFormulaForCopyPaste.targetRange",Zb,pa.top-1,pa.left-1,pa.bottom-1,pa.right-1);pa=excelOnlineCalc.calc.copyPasteRangePasteEdit(pa,G,Bd);kb.push(pa);pa=Bd?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",Zb,Lc,Bd.row,Bd.column,Bd.lastRow,Bd.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",
Zb,Lc,"","","","");X.ULS.sendTraceTag(537170142,0,50,pa);this.gs.editRangePaste(Lc,kb);this.resumeRecalc()}}Rkc(G){const pa=this.qsd();let kb=null;pa?kb=og.C7("GetViewport.viewport",G,pa.top-1,pa.left-1,pa.bottom-1,pa.right-1):X.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return kb}qsd(){const G=Yd.h(this.Kf);let pa=G.Rl;if(Yd.h(this.Kf).Gd.Xk){pa=G.mi(1).Rl;if(Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&
!pa)return X.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;pa.Lha(1,1);pa.Lha(3,1)}return pa}fMc(G,pa,kb){let Zb;if(!this.gs||!G)return X.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.gs}, modifiedCell is null:${!G}, operation:${kb}`),-1;const Lc=G.cell.oI-1,Bd=G.cell.nI-1;if(G.cell.vz){if(Zb=G.cell.vz.M8b,Zb===id.a.Gg)return X.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${G.cell.vz.Vf}, operation:${kb}`),
-1}else return X.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${G.cell.oI},${G.cell.nI}), operation:${kb}`),-1;if(Zb<this.Av)return X.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Lc},${Bd}) - blockRevision:${Zb} < lastUpdatedStateId:${this.Av}, operation:${kb}`),-1;if(Zb<this.currentStateId)return X.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${Lc},${Bd}) - blockRevision:${Zb} < currentStateId:${this.currentStateId}, operation:${kb}`),
-1;pa&&!this.mMd&&(this.gs.setOnRecalcResults(pa),this.mMd=!0);return this.djk()&&!this.oWb(2)?(X.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${kb}`),-1):Zb}getFormulaBarText(G,pa,kb){return pa&&pa.startsWith("'")?pa:G.cell.formulaBarText||kb.toString()}Sth(G,pa,kb){let Zb=null;this.n6a=this.K8(kb);if(this.nJe()&&this.Fh.ka(this.Av).O4a){const Ie=this.Fh.ka(this.Av).O4a[G];if(null===Ie||void 0===Ie?0:Ie.oSb)Zb=Ie.FIe}kb=this.FCi(Zb,pa,
kb);const {w3i:Lc,numberOfNonEmptyCells:Bd,u3i:he}=this.Pkh(Zb,pa,kb);X.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${G} StateId:${this.currentStateId} number of formulas ${Lc}, number of non-empty cells ${Bd}, number of cells ${he}`)}FCi(G,pa,kb){let Zb=!1;const Lc=og.$9e(pa);if(G){const Bd=og.$9e(G);tc.a.equals(Bd,Lc,!1)&&(Zb=!0)}Zb?this.iXg(G,this.Av,kb):this.kXg(pa,kb);return Zb}nJe(){let G=!1;this.gs&&-1!==this.Av&&(G=this.gs.stateIdAvailable(this.Av));
return G&&this.Fh.Hd(this.Av)&&this.Av<this.currentStateId}Pkh(G,pa,kb){let Zb=0,Lc=0,Bd=0,he,Ie;for(pa.reset();he=pa.getNextCell();)Bd++,(he.value||he.formula)&&Lc++,ng.f(he.formula)&&Zb++,(Ie=kb?G.getCell(he.row,he.col):null)?this.Lkh(pa,he,Ie):this.jXg(pa,he);if(kb)for(G.reset();Ie=G.getNextCell();)(he=pa.getCell(Ie.row,Ie.col))||this.$ye(G,Ie);return{w3i:Zb,numberOfNonEmptyCells:Lc,u3i:Bd}}ZUj(){this.gs.setOnUpdateRequest(()=>{})}YUj(){this.gs.setOnUnresponsive((G,pa,kb,Zb)=>{this.Rhj(G,pa,kb,
Zb)})}Rhj(G,pa,kb,Zb){X.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${G}, waitTime:${pa}, timeoutCount:${kb}, hasBeenClosed:${Zb}.`);Zb&&(this.VIj(),this.Zsa())}VIj(){this.fg(null,null);this.HEd=this.mMd=!1;this.XPd=0;this.QPd=this.SPd=this.TPd=this.RPd=-1}close(){this.gs.close()}clearCache(){this.gs.clearCache()}resumeRecalc(){this.gs.resumeRecalc()}iUj(){this.gs.setA1ReferenceStyle(!0)}Kwj(){if(this.instantaneousSupportInformationManager){var G=
this.instantaneousSupportInformationManager.Szi;const kb=this.instantaneousSupportInformationManager.Vzi,Zb=this.instantaneousSupportInformationManager.Uzi,Lc=this.instantaneousSupportInformationManager.Tzi;var pa=!1;G!==this.RPd&&(pa=!0,this.RPd=G);kb!==this.TPd&&(pa=!0,this.TPd=kb);Zb!==this.SPd&&(pa=!0,this.SPd=Zb);Lc!==this.QPd&&(pa=!0,this.QPd=Lc);const Bd=[];Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(pa=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),Bd.push(pa),pa=!0);Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(pa=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),Bd.push(pa),pa=!0);Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(pa=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),Bd.push(pa),pa=!0);pa&&(G=excelOnlineCalc.calc.recalcServiceConfig(null,G,null,kb,null,null,null,Zb,Bd,Lc),this.gs.reconfigure(G))}}XWj(G){let pa=
null;if(this.Fh.Hd(this.currentStateId))try{this.Rda=[],pa=this.Kf.pe.xf("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${qh[G]}`),za.a.forEach(this.Fh.ka(this.currentStateId).O4a,(kb,Zb)=>{Zb.oSb||(this.Sth(kb,Zb.FIe,Zb.sheetName),Zb.oSb=!0)},null),this.gs.updateRanges(this.currentStateId,this.Rda)}finally{pa&&pa.stop()}else X.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}WWj(){const G=
[],pa=this.nJe();var kb=pa&&this.Fh.ka(this.Av).Hm&&this.Fh.ka(this.Av).Hm[0]&&this.Fh.ka(this.Av).Hm[0].hvc?this.Fh.ka(this.Av).Hm[0].a$:null;this.$Ne(kb,this.Fh.ka(this.currentStateId).Hm[0].a$,null,this.Av,G);this.Fh.ka(this.currentStateId).Hm[0].hvc=!0;for(let Zb=1;Zb<this.Fh.ka(this.currentStateId).Hm.length;Zb++)kb=-1,pa&&this.Fh.ka(this.Av).Hm&&(kb=this.urd(this.Fh.ka(this.currentStateId).Hm[Zb].Aaa.sheetName,this.Av)),kb=-1!==kb&&this.Fh.ka(this.Av).Hm[kb].hvc?this.Fh.ka(this.Av).Hm[kb].a$:
null,this.$Ne(kb,this.Fh.ka(this.currentStateId).Hm[Zb].a$,this.Fh.ka(this.currentStateId).Hm[Zb].Aaa.sheetId,this.Av,G),this.Fh.ka(this.currentStateId).Hm[Zb].hvc=!0;this.gs.updateNamedObjects(this.currentStateId,G)}$Ne(G,pa,kb,Zb,Lc){if(void 0!==kb&&null!==kb){var Bd=excelOnlineCalc.calc.undefinedNamesWrite(kb);Lc.push(Bd)}if(G){var he=!1;Bd=[];var Ie=[];if(pa)for(let qf of pa){const eg=qf.value;if(G.Hd(qf.key)){var ff=G.ka(qf.key);og.J1i(ff,eg)?he=!0:(ff=excelOnlineCalc.calc.namedObject(qf.key,
null),Bd.push(ff),og.y3c(qf.key,eg,Ie))}else og.y3c(qf.key,eg,Ie)}for(let qf of G)pa&&pa.Hd(qf.key)||(G=excelOnlineCalc.calc.namedObject(qf.key,null),Bd.push(G));he&&(pa=excelOnlineCalc.calc.namedObjectsPromote(kb,Zb),Lc.push(pa));0<Bd.length&&(pa=excelOnlineCalc.calc.namedObjectsWrite(kb,Bd),Lc.push(pa));0<Ie.length&&(kb=excelOnlineCalc.calc.namedObjectsWrite(kb,Ie),Lc.push(kb))}else if(pa){Zb=[];for(Ie of pa)og.y3c(Ie.key,Ie.value,Zb);0<Zb.length&&(kb=excelOnlineCalc.calc.namedObjectsWrite(kb,Zb),
Lc.push(kb))}}W8g(){const G=this.Fh.ka(this.currentStateId).O4a[this.Gxa];return G?(X.ULS.sendTraceTag(509117004,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.Gxa} StateId:${this.currentStateId} previously handled. LastUpdatedStateId: ${this.Av}. sentToRecalcEngine: ${null===G||void 0===G?void 0:G.oSb}`),!0):!1}O8g(G){return 1===G.getColumnNumbers().length&&G.getColumnNumbers()[0]===og.eHd+1?!1:!0}Dxi(){let G=!1;Yd.h(this.Kf).ya.q8a(pa=>{pa.state&1&&this.Kf.ea.Mg===pa.Cg.Revision&&
(this.NSe(pa),G=!0)});return G}uQe(G,pa){var kb=G.getRowNumbers(),Zb=G.getColumnNumbers();G=kb[0]-1;kb=kb[kb.length-1]-1;const Lc=Zb[0]-1;Zb=Zb[Zb.length-1]-1;pa=this.K8(pa);if(!pa){const Bd=this.Fh.Hd(this.currentStateId)&&this.Fh.ka(this.currentStateId).Hm?this.Fh.ka(this.currentStateId).Hm.length:0;X.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${Bd}`)}return og.C7("CreateBlockRangeLocation",pa,G,Lc,kb,Zb)}iXg(G,pa,kb){if(kb=
this.uQe(G,kb)){var Zb=og.Lbc(G.getRowNumbers());G=og.Lbc(G.getColumnNumbers());pa=excelOnlineCalc.calc.rangePromote(kb,pa,Zb,G);this.Rda[this.Rda.length]=pa}}kXg(G,pa){if(pa=this.uQe(G,pa)){var kb=og.Lbc(G.getRowNumbers());G=og.Lbc(G.getColumnNumbers());G=excelOnlineCalc.calc.rangeWrite(pa,null,kb,G);this.Rda[this.Rda.length]=G}}Lkh(G,pa,kb){let Zb=null,Lc=0,Bd=0;switch(pa.valueType){case 2:Zb=this.lsd(pa);var he=this.lsd(kb);he=tc.a.equals(he,Zb,!1);break;case 1:null===pa.value&&null===kb.value?
he=!0:(Lc=parseFloat(pa.value),he=parseFloat(kb.value)===Lc);break;default:null===pa.value&&null===kb.value?he=!0:(Bd=parseFloat(pa.value),he=Bd===parseFloat(kb.value))}he&&pa.valueType===kb.valueType&&pa.ifmt===kb.ifmt&&pa.formulaType===kb.formulaType&&tc.a.equals(kb.formula,pa.formula,!1)||(void 0!==pa.formula&&null!==pa.formula||void 0!==pa.value&&null!==pa.value||void 0!==pa.text&&null!==pa.text||0!==pa.valueType?this.f6b(G,pa,Zb,Lc,Bd):this.$ye(G,pa))}GWg(G){if(this.Kf.ue&&this.Kf.ue.items)for(let Bd=
0;Bd<this.Kf.ue.count;Bd++){var pa=this.Kf.ue.items[Bd];if(2!==pa.type&&3!==pa.type)continue;var kb=0,Zb=pa.name,Lc=Zb.lastIndexOf("!");if(0<Lc){kb=Zb.substr(0,Lc);"'"===kb.charAt(0)&&(kb=kb.substr(1,kb.length-2));kb=this.urd(kb,this.currentStateId);if(-1===kb){Zb=this.Fh.Hd(this.currentStateId)&&this.Fh.ka(this.currentStateId).Hm?this.Fh.ka(this.currentStateId).Hm.length:0;X.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Zb}`);
continue}Zb=Zb.substr(Lc+1)}Lc=this.Fh.ka(this.currentStateId).Hm[kb].a$;let he=pa.usedRange;2===pa.type&&(he=ec.a(pa));if(Lc.Hd(Zb)){if(kb=Lc.ka(Zb),kb.range=he,kb.attributes=pa.attributes,2===kb.type)if(Zb=pa.Dsa,!kb.JH)kb.JH=new Ic(Zb);else if(Zb)for(const Ie of Zb.HeadersList)kb.JH.zda.fa(Ie.Index,Ie.Name)}else if(kb=this.K8(pa.sheetName)){kb=new Pd(pa.type,pa.name,he,kb,pa.attributes);if(2===kb.type)if(pa.Dsa)kb.JH=new Ic(pa.Dsa);else if(pa=og.zVh(pa.name,G))kb.JH=new Ic(pa.ColHeadersList);Lc.fa(Zb,
kb)}else Zb=this.Fh.Hd(this.currentStateId)&&this.Fh.ka(this.currentStateId).Hm?this.Fh.ka(this.currentStateId).Hm.length:0,X.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${Zb}`)}}f6b(G,pa,kb,Zb,Lc){var Bd=G.getRowNumbers()[pa.row]-1;G=G.getColumnNumbers()[pa.col]-1;Bd=og.C7("AddRangeUpdateCommand",this.n6a,Bd,G,Bd,G);G=null;let he=pa.formula||pa.text;const Ie=excelOnlineCalc.calc.blankValue;let ff=null;void 0!==pa.text&&null!==
pa.text||void 0!==pa.value&&null!==pa.value||(kb="",ff="This cell contains blanks only",0===pa.formulaType&&(he=""));switch(pa.valueType){case 2:null!==kb&&(0===pa.formulaType&&(G=excelOnlineCalc.calc.valueCellData(he,kb,pa.ifmt,ff)),1===pa.formulaType&&(G=excelOnlineCalc.calc.cellFormulaCellData(he,kb,pa.ifmt,ff)),2===pa.formulaType&&(G=excelOnlineCalc.calc.valueCellData("",Ie,0,"This cell is a part of an array")));break;case 1:isNaN(Zb)?X.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${pa.row},${pa.col}) invalid numeric value`):
(0===pa.formulaType&&(G=excelOnlineCalc.calc.valueCellData(he,Zb,pa.ifmt,null)),1===pa.formulaType&&(G=excelOnlineCalc.calc.cellFormulaCellData(he,Zb,pa.ifmt,null)),2===pa.formulaType&&(G=excelOnlineCalc.calc.valueCellData("",Ie,0,"This cell is a part of an array")));break;case 3:isNaN(Lc)?X.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${pa.row},${pa.col}) invalid boolean value`):(kb=1===Lc?!0:!1,0===pa.formulaType&&(G=excelOnlineCalc.calc.valueCellData(he,kb,pa.ifmt,
null)),1===pa.formulaType&&(G=excelOnlineCalc.calc.cellFormulaCellData(he,kb,pa.ifmt,null)),2===pa.formulaType&&(G=excelOnlineCalc.calc.valueCellData("",Ie,0,"This cell is a part of an array")));break;case 4:isNaN(Lc)?X.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${pa.row},${pa.col}) invalid error value`):(kb=excelOnlineCalc.calc.errorValue(Lc),0===pa.formulaType&&(G=excelOnlineCalc.calc.valueCellData(he,kb,pa.ifmt,null)),1===pa.formulaType&&(G=excelOnlineCalc.calc.cellFormulaCellData(he,
kb,pa.ifmt,null)),2===pa.formulaType&&(G=excelOnlineCalc.calc.valueCellData("",Ie,0,"This cell is a part of an array")));break;default:G=excelOnlineCalc.calc.valueCellData("",Ie,pa.ifmt,null)}G&&(pa=excelOnlineCalc.calc.rangeWrite(Bd,G,null,null),this.Rda[this.Rda.length]=pa)}jXg(G,pa){switch(pa.valueType){case 2:this.f6b(G,pa,this.lsd(pa),null,0);break;case 1:this.f6b(G,pa,null,parseFloat(pa.value),0);break;default:this.f6b(G,pa,null,null,parseFloat(pa.value))}}$ye(G,pa){var kb=G.getRowNumbers()[pa.row]-
1;G=G.getColumnNumbers()[pa.col]-1;kb=og.C7("AddRangeUpdateCommandEmptyCell",this.n6a,kb,G,kb,G);pa=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,pa.ifmt,null);pa=excelOnlineCalc.calc.rangeWrite(kb,pa,null,null);this.Rda[this.Rda.length]=pa}K8(G){G=this.urd(G,this.currentStateId);return 0<G?this.Fh.ka(this.currentStateId).Hm[G].Aaa.sheetId:null}urd(G,pa){if(!this.Fh.Hd(pa))return X.ULS.sendTraceTag(537170113,0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${pa} does not exist in GridCache`),
-1;const kb=this.Fh.ka(pa);return kb.Hm?kb.getSheetIndex(G):(X.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${pa}`),-1)}uWj(){if(!this.Fh.Hd(this.currentStateId)||!this.Fh.ka(this.currentStateId).Hm.length)return X.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),!1;const G=[];for(let pa=1;pa<this.Fh.ka(this.currentStateId).Hm.length;pa++){const kb=
this.Fh.ka(this.currentStateId).Hm[pa];kb&&G.push(kb.Aaa)}this.gs.updateSheetNames(this.currentStateId,G);this.gs.updateUnusedCells(this.currentStateId,this.Fh.ka(this.currentStateId).u8d);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var G=[];for(const pa of this.instantaneousSupportInformationManager.wCa){const kb=excelOnlineCalc.calc.numberFormat(pa.IfmtIndex,pa.FormatString,pa.Builtin);G.push(kb)}this.gs.setNumberFormats(G,!0)}}ySj(){if(this.instantaneousSupportInformationManager&&
this.instantaneousSupportInformationManager.Hh){var G=this.Hxi();if(!this.HEd||G)this.instantaneousSupportInformationManager.Hh.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Hh.TrueValueString),this.instantaneousSupportInformationManager.Hh.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Hh.FalseValueString),G=fg.CalcHelper.wRe(this.instantaneousSupportInformationManager,G),this.gs.setLocale(G),this.HEd=!0}}jXj(){var G=null;if(void 0!==this.Kf.workbookContext.TimeZoneInformation&&
null!==this.Kf.workbookContext.TimeZoneInformation){G=null;this.Kf.workbookContext.TimeZoneInformation.StandardDate.Month&&(G=excelOnlineCalc.date.dateTime(this.Kf.workbookContext.TimeZoneInformation.StandardDate.Year,this.Kf.workbookContext.TimeZoneInformation.StandardDate.Month,this.Kf.workbookContext.TimeZoneInformation.StandardDate.Day,this.Kf.workbookContext.TimeZoneInformation.StandardDate.Hour,this.Kf.workbookContext.TimeZoneInformation.StandardDate.Minute,this.Kf.workbookContext.TimeZoneInformation.StandardDate.Second,
this.Kf.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Kf.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let pa=null;this.Kf.workbookContext.TimeZoneInformation.DaylightDate.Month&&(pa=excelOnlineCalc.date.dateTime(this.Kf.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Kf.workbookContext.TimeZoneInformation.DaylightDate.Month,this.Kf.workbookContext.TimeZoneInformation.DaylightDate.Day,this.Kf.workbookContext.TimeZoneInformation.DaylightDate.Hour,
this.Kf.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Kf.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Kf.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Kf.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));G=excelOnlineCalc.date.tzData(this.Kf.workbookContext.TimeZoneInformation.Bias,G,this.Kf.workbookContext.TimeZoneInformation.StandardBias,pa,this.Kf.workbookContext.TimeZoneInformation.DaylightBias)}else X.ULS.sendTraceTag(537170082,
0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");G=excelOnlineCalc.calc.workbookProps(this.Kf.workbookContext.F1904,this.Kf.workbookContext.FDateCompatibility,G);this.gs.setWorkbookProps(G)}Zsa(){const G=Vb.EwaSettings.Fa(570)?Ab.local:Ab.zbk,[pa,kb]=[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()];this.bSd=Qb.d(excelOnlineCalc.calc.createRecalcService(G,pa,kb));this.bSd.continueWith(Zb=>{Zb.exception?X.ULS.sendTraceTag(537170075,
0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${Zb.exception.toString()}`):(X.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.gs=this.bSd.result)?this.oWb(0)?this.YUj():X.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):X.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Hxi(){const G=this.instantaneousSupportInformationManager.mna;
if(!G||this.XPd===G.length)return null;this.XPd=G.length;return fg.CalcHelper.fRe(G)}Jxi(){if(!(this.Fh.Hd(this.currentStateId)&&0<this.Fh.ka(this.currentStateId).Hm.length)){this.Fh.fa(this.currentStateId,new Ae(this.bzd));this.Fh.ka(this.currentStateId).jgg(0,new Df(null));var G=this.Kf.ta;for(let Zb=0;Zb<G.count;Zb++){var pa=Object(db.a)(ed.a,G.getItem(Zb));if(pa){void 0!==pa.sheetId&&null!==pa.sheetId&&void 0!==pa.name&&null!==pa.name&&pa.sheetId.length&&pa.sheetName.length||X.ULS.sendTraceTag(537170074,
0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${Zb} Id:${pa.sheetId} Hash:${pa.hash} NameLength:${pa.name?pa.name.length:-1}`);var kb=void 0;kb=excelOnlineCalc.calc.sheetName(pa.sheetId,pa.name);this.Fh.ka(this.currentStateId).jgg(Zb+1,new Df(kb));kb=pa.usedRange.WR();kb=excelOnlineCalc.calc.rangeLocation(0,0,kb.LastRow,kb.LastColumn);pa=excelOnlineCalc.calc.unusedCellsUpdate(pa.sheetId,kb);this.Fh.ka(this.currentStateId).u8d.push(pa)}else X.ULS.sendTraceTag(537170073,0,
15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${Zb}`)}}}Enk(G){if(G instanceof ed.a){var pa=G.usedRange.WR();pa=excelOnlineCalc.calc.rangeLocation(0,0,pa.LastRow,pa.LastColumn);pa=excelOnlineCalc.calc.unusedCellsUpdate(G.sheetId,pa);this.Fh.ka(this.currentStateId).u8d[G.index]=pa}}phh(){for(let G of this.Fh)G.key<this.Av&&this.Fh.remove(G.key)}lsd(G){G=G.value||G.text;if(void 0===G||null===G)G="";return G}djk(){if(!this.Fh.Hd(this.currentStateId))return!1;
let G=!1;za.a.forEach(this.Fh.ka(this.currentStateId).O4a,(pa,kb)=>{kb.oSb||(G=!0)},null);return G}mdd(G){const pa={};pa.reason=G;pa.kind=1;return pa}Npc(){return this.Fh.Hd(this.currentStateId)&&this.Fh.ka(this.currentStateId).Hm&&this.Fh.ka(this.currentStateId).Hm[0]&&this.Fh.ka(this.currentStateId).Hm[0].a$?!0:!1}static Xph(G){const pa=[];if(null===G||void 0===G?0:G.zda)for(let kb of G.zda)G=excelOnlineCalc.calc.columnData(kb.key,kb.value),pa.push(G);return pa}static J1i(G,pa){if(G.type!==pa.type||
G.attributes!==pa.attributes||!tc.a.equals(G.fullName,pa.fullName,!1)||!G.range.equals(pa.range))return!1;if(!G.JH&&!pa.JH)return!0;if(!G.JH||!pa.JH||G.JH.zda.count!==pa.JH.zda.count)return!1;for(let kb of G.JH.zda){let Zb;if(G=kb.value)G=pa.JH.zda.Jf(kb.key),{value:Zb}=G,G=G.returnValue;if(!(G&&Zb&&tc.a.equals(kb.value,Zb,!1)))return!1}return!0}static y3c(G,pa,kb){var Zb=og.C7("NamedObject",pa.sheetId,pa.range.top-1,pa.range.left-1,pa.range.bottom-1,pa.range.right-1);if(2===pa.type){const Lc=!!(pa.attributes&
16),Bd=!!(pa.attributes&8);pa=og.Xph(pa.JH);Zb=excelOnlineCalc.calc.namedTableData(Zb,Lc,Bd,pa);G=excelOnlineCalc.calc.namedObject(G,Zb)}else Zb=excelOnlineCalc.calc.namedRangeData(Zb),G=excelOnlineCalc.calc.namedObject(G,Zb);kb.push(G)}static $9e(G){const pa=Sys.Serialization.JavaScriptSerializer.serialize(G.getRowNumbers());G=Sys.Serialization.JavaScriptSerializer.serialize(G.getColumnNumbers());return pa+G}static Lbc(G){let pa=null;if(1<G.length)for(let kb=1;kb<G.length;kb++){let Zb=0;for(;G[kb-
1]+1+Zb<G[kb];)pa=pa||[],pa.push(G[kb-1]+Zb),Zb++}return pa}static zVh(G,pa){if(!pa)return null;for(let kb=0,Zb=pa.length;kb<Zb;++kb)if(tc.a.equals(G,pa[kb].Name,!1))return pa[kb];return null}static C7(G,pa,kb,Zb,Lc,Bd){const he=(Ie,ff,qf,eg)=>{(0>qf||qf>=eg)&&X.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${Ie} invalid ${ff}:${qf}`)};void 0!==pa&&null!==pa||X.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${G} sheetId is null`);
he(G,"top",kb,og.GFf);he(G,"left",Zb,og.eHd);he(G,"bottom",Lc,og.GFf);he(G,"right",Bd,og.eHd);return excelOnlineCalc.calc.sheetRangeLocation(pa,kb,Zb,Lc,Bd)}}og.GFf=1048576;og.eHd=16384;Object(Fa.a)(og,"CalcAsyncEngine",null,[5]);const ch=(G,pa,kb)=>{switch(G.type){case 2:return excelOnlineCalc.calc.valueCellData(pa,G.value,kb,null);case 1:return excelOnlineCalc.calc.valueCellData(pa,parseFloat(G.value),kb,null);case 3:return excelOnlineCalc.calc.valueCellData(pa,1===parseFloat(G.value),kb,null);
case 4:return excelOnlineCalc.calc.valueCellData(pa,excelOnlineCalc.calc.errorValue(parseFloat(G.value)),kb,null);default:return excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,kb,null)}};class ah{constructor(){this.CN=this.DN=this.tI=this.uI=this.o3=!1}}Object(Fa.a)(ah,"AbsoluteRelativeReferenceInfo",null,[]);class Ch{}Ch.qYf="#";Object(Fa.a)(Ch,"Operators",null,[]);var Qh=a(1130);class vh{}vh.sheet="Sheet";vh.sheetRange="SheetRange";vh.document="Document";vh.Zti="Ident";Object(Fa.a)(vh,
"TraverseFormulaQualifierTypes",null,[]);var Yh=a(1131),Ji=a(848),Kj=a(78),si=a(296);class wk extends Sys.EventArgs{constructor(G){super();this.Ll=G}}Object(Fa.a)(wk,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);var zk=a(283);class sk{constructor(G,pa){this.aNf=(kb,Zb)=>{kb=this.gridView.ga.ra.activeCell;const Lc=this.gridView.Zd(kb);null!=Lc&&this.epj(kb,Zb.text,Lc.cell.Lj,Lc.cell.vz.M8b,this.gridView.$.activeItemName)};this.aDa=()=>{this.GBa=Object(si.a)({message:"PrefetchNotStarted"})};
this.Hg=G;this.gridView=pa;this.GBa=Object(si.a)({message:"Ctor"});G=Vb.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetchMsDebounce",100);this.epj=zk.a((kb,Zb,Lc,Bd,he)=>this.prefetch({text:Zb,range:kb,ifmt:Lc,stateId:Bd,sheetName:he}),G);this.gridView.me.Yp(this.aDa);this.gridView.il.jAe(this.aNf)}dispose(){this.gridView.il.V5f(this.aNf);this.gridView.me.Qp(this.aDa);this.YLe()}i$e(G){if(Object(si.b)(this.GBa))return Object(si.a)(this.GBa.reason.message);if(sk.y5g(G,
this.GBa.value.key)){for(const pa of this.GBa.value.results.results)if(Object(si.c)(pa)&&sk.zKi(G,pa))return pa;return Object(si.a)("RangeNotFoundInPrefetchResult")}return Object(si.a)("ResultUnavailable")}YLe(){this.GBa=Object(si.a)({message:"PrefetchResultCleared"})}prefetch(G){this.GBa=Object(si.a)({message:"EvalInProgress",key:G});this.Hg.a2([],G.range,G.range,G.text,!0).then(pa=>{this.GBa=Object(si.d)({key:G,results:pa})}).catch(pa=>{X.ULS.sendTraceTag(509219811,0,50,`SetCellEstimationPrefetcher.prefetch: evalFormulaRangeOnClonedModel promise rejected with error ${pa}`)})}static y5g(G,
pa){return G.text===pa.text&&G.range.toString()===pa.range.toString()&&G.ifmt===pa.ifmt&&G.stateId===pa.stateId&&G.sheetName===pa.sheetName}static zKi(G,pa){return G.range.top-1===pa.value.cell.row&&G.range.left-1===pa.value.cell.col}}Object(Fa.a)(sk,"SetCellEstimationPrefetcher",null,[332,5]);var yj;let Rj=yj=class extends qe.a{constructor(G,pa,kb){super();this.zH=kb;this.ev=null;this.Hyg=!1;this.MWd=this.instantaneousSupportInformationManager=this.NNb=null;this.EJd=new Map;this.Yoe=null;this.bxc=
Zb=>{X.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");Zb.rUd(this.bxc);Zb.mna.length?this.Hwc(Zb,Sys.EventArgs.Empty):(X.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),Zb.qAe(this.Hwc))};this.Hwc=Zb=>{X.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");Zb.eUd(this.Hwc);this.Hgk(Zb)};this.onContentReady=()=>{this.ev&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Anc||
Jb.Task.delay(0).continueWith(()=>{this.ev.oWb(1)?this.raiseEvent(yj.dad):X.ULS.sendTraceTag(508368722,0,15,"CalcManager.onContentReady: calc engine failed to update in the calc model")},0,null,Kj.a.current))};this.GKf=(Zb,Lc)=>{this.ev&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Anc||this.ev.NSe(Lc.Gf.block))};X.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.joc=!1;this.Pd=G;this.dw=Yd.h(G);this.HPc=null;this.gridView.$u(this.onContentReady);
this.gridView.ya.X3c(this.GKf);this.$.ia.Od(268,Zb=>{Zb.Hh?(X.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),this.bxc(Zb,Sys.EventArgs.Empty)):(X.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),Zb.LAe(this.bxc))});if(this.z9=Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetCellEstimationPrefetch",!1))this.ste=new sk(this,this.dw)}b4c(G){this.addHandler(yj.aYe,G)}zIf(G){this.raiseEvent(yj.aYe,new wk(G))}DYg(G){this.addHandler(yj.H2c,
G)}iCj(G){this.removeHandler(yj.H2c,G)}Avc(G){this.raiseEvent(yj.H2c,G)}s6b(G){this.addHandler(yj.dad,G)}XTd(G){this.removeHandler(yj.dad,G)}get aFc(){return this.ste}get l1(){return this.HPc}get gridView(){return this.dw}get $(){return this.Pd}get MC(){return this.Yoe}get localeInfo(){return this.l1?this.l1.config.localeInfo:null}get config(){return this.l1.config}dispose(){X.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.ia.Od(268,G=>{G.rUd(this.bxc);G.eUd(this.Hwc)});this.gridView&&
(this.gridView.Vx(this.onContentReady),this.gridView.ya&&this.gridView.ya.D5f(this.GKf),this.dw=null);this.HPc=null;this.joc=!1;this.z9&&(nf.a.Ma(this.aFc),this.ste=null)}ddh(G,pa,kb,Zb){this.ev&&this.ev.adh(G,pa,kb,void 0===Zb?null:Zb)}edh(G,pa){return this.ev?this.ev.bdh(G,pa):!1}evalFormula(G,pa,kb,Zb){return this.ev?this.ev.evalFormula(G,pa,kb,Zb):Promise.reject("calc engine not initialized")}a2(G,pa,kb,Zb,Lc){return this.ev?this.ev.a2(G,pa,kb,Zb,Lc):Promise.reject("CalcEngine is null")}BPa(G){if(!G)return X.ULS.sendTraceTag(509649312,
0,100,"CalcManager.GetTableHeaders: table is null"),null;if(!this.ev)return null;X.ULS.shipAssertTag(537170059,0,2===G.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table");return this.ev.BPa(G)}lCe(G,pa){if(!pa||2!==G.type)return!1;G=ec.a(G);return G.right-G.left+1===pa.count}y4e(G,pa){if(!this.NNb)return this.Hyg||X.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),null;var kb=this.jcd($g.Range.ef(1,1));kb=this.NNb.parseFormula(excelOnlineCalc.parse.parseLocals(1,
kb.range),G);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(kb))return X.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let Zb;const Lc=null!==pa&&void 0!==pa?pa:this.gridView.ga.ra.activeCell,Bd=excelOnlineCalc.location.gridCell(Lc.top-1,Lc.left-1),he=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Ie=excelOnlineCalc.location.sheetIndex(he,this.$.ta.pa.sheetId),ff=this.muh(Bd,Ie);this.MWd||
(this.MWd=excelOnlineCalc.util.createResolver(this.luh()));Zb=excelOnlineCalc.parse.parseResultHelper.extractReferences(kb,this.l1.config.localeInfo,Vb.EwaSettings.Fa(512),ff,this.MWd);Vb.EwaSettings.Fa(101)&&this.zmk(Zb,G);return Zb}catch(Zb){return X.ULS.sendTraceTag(537170055,0,10,`CalcManager.ExtractReferenceWrappers - exception: ${Zb.message}`),null}}extractLetVariables(G,pa){if(!this.NNb)return this.Hyg||X.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),
null;const kb=this.jcd($g.Range.ef(1,1));G=this.NNb.parseFormula(excelOnlineCalc.parse.parseLocals(1,kb.range),G);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(G))return X.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(G,pa,this.l1.config.localeInfo)}catch(Zb){return X.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${Zb.message}`),null}}extractReferences(G,
pa,kb,Zb,Lc){if(!pa)return X.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!kb)return X.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;const Bd=this.y4e(G,Lc);if(!Bd)return X.ULS.sendTraceTag(537170049,0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.kth(Bd,pa,kb,G,Zb,Lc)}catch(he){return X.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${he.message}`),
null}}jcd(G,pa){pa=void 0===pa?!0:pa;return G&&this.l1?this.l1.Euh(this.l1.pwh(),G.top-1,G.left-1,pa):null}dpc(G,pa){G=this.Eea(G);if(!Object(si.c)(G))return null;pa=this.MC.parseEdit(pa,G.value);return excelOnlineCalc.util.isSuccess(pa)?pa.value.kind===rk.a.formula:null}RBd(G){G=this.Eea(G);return Object(si.c)(G)?"Text"===G.value.valueType:null}qrf(G){G=this.Eea(G);return Object(si.c)(G)?"Date"===G.value.valueType&&!G.value.hasTime:null}Eea(G){if(null==this.MC)return Object(si.a)("Number formatter is null");
if(null==this.instantaneousSupportInformationManager)return Object(si.a)("Instantaneous manager is null");if(this.EJd.has(G))return Object(si.d)(this.EJd.get(G));if("number"===typeof G){var pa=this.Qdf(G);if(null==pa)return Object(si.a)(`Invalid ifmt=${G}`);var kb=pa.FormatString;pa=pa.Builtin}else kb=G,pa=!1;kb=this.MC.createFormat(kb,pa);return excelOnlineCalc.util.isSuccess(kb)?(this.EJd.set(G,kb.value),Object(si.d)(kb.value)):Object(si.a)("Could not create number format")}getWorksheetFuncId(G){return this.localeInfo.getWorksheetFuncId(G)}kth(G,
pa,kb,Zb,Lc,Bd){const he={Items:[]};for(let eg=0;eg<G.length;eg++){var Ie=G[eg];const dh={};dh.Start=Ie.span.start;dh.End=Ie.span.end;if(Lc||Ie.kind!==Qh.a.func)if(Lc||Ie.kind!==Qh.a.vRi){if(!this.pDh(Ie,pa,kb))continue;var ff=new ah;const nh=this.jfi(Ie,pa,ff,Zb,Bd);if(Vb.EwaSettings.Fa(512)){var qf=this.Rai(Ie);const Ug=this.Qai(Ie);if(nh||Ug&&0<=qf){let rh={};rh.Span=dh;rh.LetNumber=qf;rh.LetName=Ug;rh.Range=nh;rh.IsRangeRef=ff.o3;rh.IsAbsoluteFirstRow=ff.uI;rh.IsAbsoluteFirstColumn=ff.tI;rh.IsAbsoluteSecondRow=
ff.DN;rh.IsAbsoluteSecondColumn=ff.CN;rh.IsStructRef=Ie.kind===Qh.a.I4d;he.Items.push(rh)}}else nh&&(qf={},qf.Span=dh,qf.Range=nh,qf.IsRangeRef=ff.o3,qf.IsAbsoluteFirstRow=ff.uI,qf.IsAbsoluteFirstColumn=ff.tI,qf.IsAbsoluteSecondRow=ff.DN,qf.IsAbsoluteSecondColumn=ff.CN,qf.IsStructRef=Ie.kind===Qh.a.I4d,he.Items.push(qf))}else Ie=Ie.ref.value.oper.kind,ff={},ff.Span=dh,ff.IsString=2===Ie,ff.IsBoolean=4===Ie,ff.IsNumber=1===Ie,he.Items.push(ff);else dh.End=Ie.span.start+Ie.ref.name.length,Ie={},Ie.Span=
dh,Ie.IsFunction=!0,Ie.FunctionId=this.getWorksheetFuncId(Zb.substring(dh.Start,dh.End)),he.Items.push(Ie)}he.Items.sort((eg,dh)=>eg.Span.Start-dh.Span.Start);return he}Rai(G){return G.kind===Qh.a.Yzf?G.ref.number:-1}Qai(G){return G.kind===Qh.a.Yzf?G.ref.name:null}jfi(G,pa,kb,Zb,Lc){if(G.kind===Qh.a.range)return kb.o3=!0,this.nPe(G,pa,kb,Zb);if(G.kind===Qh.a.namedRange){kb=G.ref;(G=this.$.ue.getItemByName(kb.name))||(G=this.$.ue.getItemByName(pa+"!"+kb.name));if(!(G&&G.sheetName&&G.usedRange&&tc.a.equals(G.sheetName,
pa,!0)))return null;pa=2===G.type?ec.a(G):G.usedRange;return fe.m(pa,G)}if(G.kind===Qh.a.I4d){let Bd=G.ref;Bd.name?(Lc=this.$.ue.getItemByName(Bd.name))||(Lc=this.$.ue.getItemByName(pa+"!"+Bd.name)):Lc=Vb.EwaSettings.isChangeGateEnabled("OfficeVSO:7907929_RecognizeTableRangeFromOriginCell")&&Lc?this.gridView.Ud.Di(Lc):this.gridView.Ud.Di(this.gridView.ga.ra.activeCell);if(!(Lc&&Lc.sheetName&&Lc.usedRange&&tc.a.equals(Lc.sheetName,pa,!0)))return null;kb.o3=!1;return this.nPe(G,pa,kb,Zb)}return null}nPe(G,
pa,kb,Zb){G=G.ref;if(G.type){if(G.type===Yh.a.column){var Lc=G.startIndex;G=G.endIndex;kb.tI=Lc.kind===Ji.a.abs;kb.CN=G.kind===Ji.a.abs;return this.createRange(0,Lc.index,id.a.Bh,G.index,pa)}if(G.type===Yh.a.row)return Lc=G.endIndex,kb.uI=G.startIndex.kind===Ji.a.abs,kb.DN=Lc.kind===Ji.a.abs,this.createRange(G.startIndex.index,0,G.endIndex.index,id.a.Ah,pa);if(G.type===Yh.a.cell){Lc=G.row;var Bd=G.col;kb.uI=kb.DN=Lc.kind===Ji.a.abs;kb.tI=kb.CN=Bd.kind===Ji.a.abs;return this.i$b(G.span.end,Zb)&&(kb=
$g.Range.ef(Lc.index+1,Bd.index+1),kb=this.gridView.Ud.tgf(kb))?fe.n(kb,pa):this.createRange(Lc.index,Bd.index,Lc.index,Bd.index,pa)}if(G.type===Yh.a.range){Lc=G.top;Bd=G.left;Zb=G.bottom;G=G.right;const he=Math.min(Lc.index,Zb.index),Ie=Math.min(Bd.index,G.index),ff=Math.max(Lc.index,Zb.index),qf=Math.max(Bd.index,G.index);kb.uI=Lc.kind===Ji.a.abs;kb.DN=Zb.kind===Ji.a.abs;kb.tI=Bd.kind===Ji.a.abs;kb.CN=G.kind===Ji.a.abs;return this.createRange(he,Ie,ff,qf,pa)}X.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${G.type}'`);
return null}X.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}i$b(G,pa){return pa.length>=G&&0<G&&pa.charAt(G-1)===Ch.qYf}Vch(G,pa,kb){this.ev&&this.ev.cdh(G,pa,kb)}Qdf(G){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.wCa&&this.instantaneousSupportInformationManager.wCa[G]&&this.MC?this.instantaneousSupportInformationManager.wCa[G]:null}Voi(G){var pa;"number"!==typeof G&&"string"!==
typeof G?this.Avc(null):(G=this.Eea(G),Object(si.c)(G)?(G=G.value,Object(Ig.c)(G)||Object(Ig.c)(G.formatString)?this.Avc(null):this.Avc({formatString:G.formatString,builtIn:null!==(pa=G.isBuiltIn)&&void 0!==pa?pa:!1})):this.Avc(null))}toXLNumber(G){if(!this.MC)return null;G=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.MC,G);return excelOnlineCalc.util.isSuccess(G)?G.value:null}ZP(G,pa,kb,Zb,Lc,Bd){if(!G)return Object(si.a)("Null");var he=excelOnlineCalc.numfmt.renderCallback(kb,ff=>
gridRenderer.CanvasRendererGlobals.measureTextWidth(ff,Zb,!0,Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),Bd),Ie=this.MC.renderValue(G,he);if(!excelOnlineCalc.util.isSuccess(Ie))return Object(si.a)("Finalize");kb=null;if(Bd=excelOnlineCalc.numfmt.isHashesValue(Ie.value)){if(Ie=this.MC.renderHashesValue(Ie.value,he),!excelOnlineCalc.util.isSuccess(Ie))return Object(si.a)("Hashes")}else kb=this.zH.$ld(G,Ie.value);Ie=Ie.value;G=excelOnlineCalc.numfmt.renderedValueToString(Ie);
he=this.zH.ecf(Ie);Ie=this.zH.sbf(Ie);return Object(si.d)({text:G,valueType:pa,fontColor:Ie,format:Lc,horizontalAlignment:he,numFmt:kb,isHashesValue:Bd})}zmk(G,pa){if(G)for(const kb of G)kb.ref.type&&kb.ref.type===Yh.a.cell&&(G=kb.ref,yj.Roj(G,pa)&&(G.span.end+=1,kb.span.end+=1))}createRange(G,pa,kb,Zb,Lc){const Bd={};Bd.FirstRow=G;Bd.FirstColumn=pa;Bd.LastRow=kb;Bd.LastColumn=Zb;Bd.SheetName=Lc;return Bd}pDh(G,pa,kb){var Zb=G.ref.qualifier;if(!Zb)return!0;switch(G.ref.qualifier.type){case vh.sheet:return G=
Zb.document,tc.a.equals(Zb.sheet,pa,!0)&&(!G||tc.a.equals(G.document,kb,!0));case vh.sheetRange:return pa=this.$.ta.getItemByName(pa),kb=this.$.ta.getItemByName(Zb.sheet1),Zb=this.$.ta.getItemByName(Zb.sheet2),!!pa&&!!kb&&!!Zb&&(kb.index<=pa.index&&pa.index<=Zb.index||Zb.index<=pa.index&&pa.index<=kb.index);case vh.document:return tc.a.equals(Zb.document,kb,!0);case vh.Zti:return Zb=Zb.name,tc.a.equals(Zb,pa,!0)||tc.a.equals(Zb,kb,!0);default:return X.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${Zb.type}'`),
!1}}Hgk(G){this.instantaneousSupportInformationManager=G;G.wCa.length&&G.mna.length?(this.HPc=new fg.CalcHelper(this.gridView.$),this.NNb=this.l1.createParser(),this.Yoe=this.l1.createNumberFormatter(),this.joc=!0,X.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.ev||(X.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.ev=new og(this.$))):X.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${G.wCa.length}, functions info count = ${G.mna.length}`)}muh(G,
pa){const kb={allowUnqualifiedCell:!0,wrapCellReferences:!0};kb.config=this.l1.config;kb.originGridCell=excelOnlineCalc.util.success(G);kb.originSheet=excelOnlineCalc.util.success(pa);return kb}luh(){const G={};G.config=this.l1.config;G.getNameLoc=this.ev.getNameLoc;G.getContainingTable=this.ev.getContainingTable;G.getStructRefColumn=this.ev.getStructRefColumn;G.getStructRefSpecialRef=this.ev.getStructRefSpecialRef;G.getDocumentLoc=this.ev.getDocumentLoc;G.getSheetIndex=this.ev.getSheetIndex;G.getSheetName=
this.ev.getSheetName;G.getUserDefinedFuncLoc=this.ev.getUserDefinedFuncLoc;G.getSheetRangeIndexes=this.ev.getSheetRangeIndexes;return G}static Roj(G,pa){return pa.length>G.span.end&&pa.charAt(G.span.end)===Ch.qYf}};Rj.aYe="ECRC";Rj.H2c="ActiveCellNumberFormatChanged";Rj.dad="ClientDataFlushedToWorkerKey";Rj=yj=Object(Ke.a)([Object(nc.d)(Oc.r),Object(Ke.b)(0,Object(Oc.fb)()),Object(Ke.b)(1,Object(Oc.jb)()),Object(Ke.b)(2,Object(Oc.q)())],Rj);Object(Fa.a)(Rj,"CalcManager",qe.a,[275,5]);(()=>{lb.a.Ia(G=>
{Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateProactiveSuggestionDebugToolsManager",!1)||Ac.la(G)})})();Type.registerNamespace("Common.App.InProductMessaging");sb.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Ma.main();(()=>{lb.a.Ia(()=>{lb.a.Ia(Xb.la)})})();(()=>{lb.a.Ia(()=>{lb.a.Ia(jc.la)})})();lb.a.Ia(Je.la);(()=>{lb.a.Ia(G=>{Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2NetworkConnectionStateManager",!1)||ma.la(G)})})();(()=>
{lb.a.Ia(G=>{Vb.EwaSettings.hAd()||Qa.la(G)})})();ib.a.Pk(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
(()=>{lb.a.Ia(G=>{ke.la(G);vd.la(G)})})();(()=>{lb.a.Ia(G=>{Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateEnrichmentTaskPane",!1)||ac.la(G);Ce.la(G)})})();(()=>{lb.a.Ia(G=>{gh.la(G)})})();(()=>{lb.a.Ia(G=>{Vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateProactiveSuggestionManager",!1)||Wg.la(G)})})();Type.registerNamespace("Common.App.Rename");Db.a.instance.$k(new ja,7);(()=>{lb.a.Ia(G=>{Sf.la(G)})})();(()=>{lb.a.Ia(G=>{Vb.EwaSettings.tIb()||we.la(G)})})();
ib.a.Pk(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}");
(()=>{lb.a.Ia(G=>{G.ia.Va(203,new jf)})})();Type.registerNamespace("Common.App.LivePersonaUtils");aa.main();Type.registerNamespace("Common.App.SaveStatus");Db.a.instance.$k(new gc);lb.a.Ia(Ne.la);lb.a.Ia(Di.la);ib.a.Pk('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
lb.a.Ia(bc.la);Type.registerNamespace("CAUI");ki.main();md.a.Ip.Va(141,new wd);lb.a.Ia(Ui.la);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=pi.a;Type.registerNamespace("Common.App.WopiIdentity");pj.main();Type.registerNamespace("Common.App.HostNotification");ih.main();Type.registerNamespace("Common.App.FloatPane");qj.main();Type.registerNamespace("Common.App.DisplayEnvironmentName");hj.main();nj.main();lb.a.Ia(Oi.la);(()=>
{lb.a.Ia(G=>{G.ia.Od(29,()=>{Si.la(G)})})})();lb.a.Ia(Of.la);String(ra);String(Ea);String(Z);String(wa);String(ha);String(la);String(ta);String(Ca);String(Ga);String(Q);String(Oa);String(eb);String(nb);String(qk);String($a);String(oa);String(fa);window.___1692616129240_closurehack=ra;window.___1692616129240_closurehack=Ea;window.___1692616129240_closurehack=Z;window.___1692616129240_closurehack=wa;window.___1692616129240_closurehack=ha;window.___1692616129240_closurehack=la;window.___1692616129240_closurehack=
ta;window.___1692616129240_closurehack=Ca;window.___1692616129240_closurehack=Ga;window.___1692616129240_closurehack=Q;window.___1692616129240_closurehack=Oa;window.___1692616129240_closurehack=eb;window.___1692616129240_closurehack=nb;window.___1692616129240_closurehack=qk;window.___1692616129240_closurehack=$a;window.___1692616129240_closurehack=oa;window.___1692616129240_closurehack=fa},748:function(w,B,a){a.d(B,"a",function(){return U});w=a(0);var b=a(2),c=a(16),h=a(96),f=a(235),e=a(15),k=a(121),
l=a(190),r=a(5),v=a(92);B=a(250);var u=a(1120),x=a(18),t=a(6),m=a(332),n=a(54),A=a(14),y=a(77),z=a(12),F=a(20),D=a(97),I=a(961),H=a(1),N=a(155);class U extends B.a{constructor(L,J){super(document.createElement("div"));this.jAf=this.ECe=this.Xwe=this.bac=this.Sfa=this.oba=this.jS=this.hC=null;this.$za=this.BY=this.su=this.hideCloseButton=!1;this.C6i=P=>{this.BG(P)};this.I6i=P=>{13===P.keyCode&&this.BG(P)};this.$Jd=P=>{this.Go(P.de);return!0};this.fKd=P=>{this.oZ(P.de);return!0};this.$wc=P=>{this.lqa(P.de?
P.de:0);return!0};this.D6i=P=>{this.BG(P.Da);return!0};this.PCg=P=>{P=void 0===P?null:P;this.Go(P.inputMethod?P.inputMethod:0);return!0};this.QCg=P=>{P=void 0===P?null:P;this.oZ(P.inputMethod?P.inputMethod:0);return!0};this.D5=L;this.mv=J;this.p7c=J.E4a.toString();this.title=J.title;this.message=J.message;this.set_visibilityMode(1)}get Jbh(){return this.mv.E4a}get businessBar(){return this.D5}get actionButton(){return this.mv?this.mv.actionButton:""}get HKa(){return this.mv?this.mv.HKa:""}get linkText(){return this.mv?
this.mv.link:""}get Js(){return this.mv?this.mv.Js:""}get alt(){return this.mv?this.mv.alt:""}Tra(L){this.mv.businessBarType=L}dispose(){h.a.df([this.bac,this.jS,this.oba]);this.su&&this.jS&&(f.a.instance.Ca(e.a.click,this.jS.domElement,this.$Jd),k.KeyInputManager.instance.ZR(this.domElement,this.Xwe));this.BY&&this.oba&&(f.a.instance.Ca(e.a.click,this.oba.domElement,this.fKd),k.KeyInputManager.instance.ZR(this.domElement,this.ECe));this.$za&&this.Sfa&&(f.a.instance.Ca(e.a.click,this.Sfa,this.$wc),
k.KeyInputManager.instance.ZR(this.domElement,this.jAf));this.Sfa=this.hC=this.D5=this.oba=this.jS=null;super.dispose()}update(){}Ujk(){this.URe(!0)}xQe(){this.URe(!1)}Uth(){const L=this.businessBar.$.pe.Fi("DOMUpdate","ReactBusinessBar");L.start();this.message=D.a.Lh(this.message);this.title=D.a.Lh(this.title);l.UISurfaces.Zpd().then(J=>{J.initializeMessageBarInStore();let P=Object(b.a)(new I.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.mv.businessBarType,dismissButtonAriaLabel:z.a.instance.ha(10)});
this.hideCloseButton||(P.onDismiss=this.D6i);this.$za&&(P.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.$wc});this.su&&(P.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.PCg});this.BY&&(P.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.HKa,["onExecute"]:this.QCg});H.EwaSettings.isChangeGateEnabled("OfficeVSO:7445369_IconFunctionalityReactBizBars")&&this.mv.iconName&&(P.messageBarIconProps={["iconName"]:this.mv.iconName});
J.createNewMessageBarWithCallback(this.domElement,P,()=>{if(r.AFrameworkApplication.da.na("Fluent2StyleIsEnabled"))this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry");else{let K="1px solid ";switch(this.mv.businessBarType){case 1:case 2:case 3:K+="#F1707B";break;case 4:K+="#92C353";break;case 5:K+="#FCE100";break;case 0:K+="#C8C6C4";break;default:K+="#C8C6C4"}this.domElement.style.border=K}H.EwaSettings.isChangeGateEnabled("OfficeVSO:8190523_BizBarHeaderTTVRFix")&&
(this.domElement.classList.add("ReactBusinessBarEntry"),Object(N.b)(()=>{var K,ca;return null===(ca=null===(K=this.businessBar)||void 0===K?void 0:K.domElement)||void 0===ca?void 0:ca.appendChild(this.domElement)}));L.stop();c.ULS.sendTraceTag(509657951,0,50,`React Business Bar created for ${this.mv.yya} in: ${L.pf} milliSeconds.`)});return null},J=>{c.ULS.sendTraceTag(524075914,0,10,`React BusinessBar for ${this.mv.yya} could not be initialized. ${J}`);return null});H.EwaSettings.isChangeGateEnabled("OfficeVSO:8190523_BizBarHeaderTTVRFix")||
(this.domElement.classList.add("ReactBusinessBarEntry"),this.businessBar.domElement.appendChild(this.domElement))}dth(L){const J=this.businessBar.$.pe.Fi("DOMUpdate","LegacyBusinessBar");J.start();L||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var P=this.businessBar.$.He;L=P+"ewaBusinessBarEntryBody"+this.p7c;const K=P+"ewaBusinessBarEntryTitle"+this.p7c;var ca=P+"ewaBusinessBarEntryIcon"+this.p7c;this.domElement.className=u.a.PIh;A.DOMElementExtensions.oK(this.domElement);
P=document.createElement("div");P.className=u.a.QIh;P.id=L;var T=document.createElement("div");T.className=u.a.OIh;var Q=document.createElement("a");Q.className=u.a.WIh;Q.title=this.alt;var fa=document.createElement("span");fa.classList.add(x.a.jad);fa.classList.add(u.a.SIh);fa.id=ca;this.Js.length&&(ca=document.createElement("img"),ca.classList.add(this.Js),ca.src=n.a.Bj(0),fa.appendChild(ca));Q.appendChild(fa);T.appendChild(Q);Q=document.createElement("span");Q.classList.add(u.a.VIh);Q.id=K;Q.innerText=
D.a.Lh(this.title);T.appendChild(Q);Q=document.createElement("span");Q.classList.add(u.a.UIh);Q.id="message";Q.innerText=D.a.Lh(this.message);T.appendChild(Q);Q=document.createElement("a");Q.id="link";Q.href="#";Q.className=u.a.TIh;Q.innerText=D.a.Lh(this.linkText);T.appendChild(Q);Q=document.createElement("span");Q.classList.add(u.a.M_e);fa=document.createElement("button");fa.type="button";fa.id="action";fa.className=u.a.L_e;fa.innerText=D.a.Lh(this.actionButton);Q.appendChild(fa);T.appendChild(Q);
Q=document.createElement("span");Q.classList.add(u.a.M_e);fa=document.createElement("button");fa.type="button";fa.id="altAction";fa.className=u.a.L_e;fa.innerText=D.a.Lh(this.HKa);Q.appendChild(fa);T.appendChild(Q);P.appendChild(T);T=document.createElement("a");T.className=u.a.RIh;T.tabIndex=0;T.setAttribute("role","button");Q=document.createElement("span");Q.id="close";Q.classList.add(x.a.MM);fa=document.createElement("img");fa.classList.add(x.a.rjd);fa.src=n.a.Bj(13);fa.alt=z.a.instance.ha(793);
fa.title=z.a.instance.ha(793);fa.setAttribute("role","button");Q.appendChild(fa);T.appendChild(Q);P.appendChild(T);this.domElement.appendChild(P);A.DOMElementExtensions.KB(this.domElement,t.a.cla,K,L);this.Sfa=$get("link",this.domElement);A.DOMElementExtensions.setVisible(this.Sfa,this.$za);this.$za&&(f.a.instance.va(e.a.click,this.Sfa,this.$wc),this.jAf=k.KeyInputManager.instance.lO(this.Sfa,this.$wc,v.a.tn,v.a.p5));this.jS=new m.a(A.DOMElementExtensions.getElementById(this.domElement,"action"));
this.jS.isVisible=this.su;this.oba=new m.a(A.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.oba.isVisible=this.BY;this.su&&(f.a.instance.va(e.a.click,this.jS.domElement,this.$Jd),this.Xwe=k.KeyInputManager.instance.lO(this.jS.domElement,this.$Jd,v.a.tn,v.a.p5),this.BY&&(f.a.instance.va(e.a.click,this.oba.domElement,this.fKd),this.ECe=k.KeyInputManager.instance.lO(this.jS.domElement,this.fKd,v.a.tn,v.a.p5)));this.hC=$get("close",this.domElement);this.bac=this.Vg.Lg(this.hC);
this.bac.la("click",this.C6i);this.bac.la("keydown",this.I6i);A.DOMElementExtensions.setVisible(this.hC,!this.hideCloseButton);J.stop();c.ULS.sendTraceTag(508387361,0,50,`Legacy Business Bar created for ${this.mv.yya} in: ${J.pf} milliSeconds.`)}URe(L){H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.Uth():this.dth(L)}Go(){c.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.mv.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.mv.yya}`);F.h(this.businessBar.$).Yt(!0)}oZ(){c.ULS.sendTraceTag(537170257,
0,50,`BusinessBar [${this.mv.hash}]: BusinessBarEntry.OnAltActionClick() for EntryName ${this.mv.yya}`);F.h(this.businessBar.$).Yt(!0)}lqa(){c.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.mv.hash}]: BusinessBarEntry.OnLinkClick() for EntryName ${this.mv.yya}`);F.h(this.businessBar.$).Yt(!0)}BG(L){c.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.mv.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.mv.yya}`);this.set_visible(!1);this.businessBar.removeEntry(this.Jbh);y.g(L)}pN(){return H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?this.domElement.getElementsByTagName("button")[0]:this.jS.domElement}}Object(w.a)(U,"BusinessBarEntry",B.a,[])},801:function(w,B,a){a.r(B);w=a(0);var b=a(16),c=a(96),h=a(224),f=a(5),e=a(33),k=a(838),l=a(138),r=a(81),v=a(37),u=a(18),x=a(6),t=a(182),m=a(1193),n=a(1180),A=a(181),y=a(569),z=a(357),F=a(58);const D=(Y,La,Ma,lb,pb,Vb,Wa,ka,Sa,Xb,Mc)=>{Mc=Y.Pa(1,void 0===Mc?null:Mc);Mc.selectedRanges=La;Mc.isChangeObject=Ma;Mc.isFloodgateEnabled=lb;Mc.isStarterData=pb;Mc.starterDataDomainId=Vb;return F.g(Y,
"GetDataSelectorPaneData",Mc,Wa,ka,Sa,Xb,4)};var I=a(125),H=a(775),N=a(927);class U{}U.Nti="EnrichmentContentFrame";U.width=320;Object(w.a)(U,"EnrichmentConstants",null,[]);class L{constructor(Y){this.messageType=0;this.messageType=Y}}Object(w.a)(L,"EnrichmentResponseMessage",null,[]);class J extends L{constructor(Y,La){super(Y);this.messageContent=null;this.messageContent=La}}Object(w.a)(J,"EnrichmentResponseMessageWithContent",L,[]);class P extends J{constructor(Y,La,Ma){super(Y,La);this.telemetryJson=
null;this.telemetryJson=Ma}}Object(w.a)(P,"EnrichmentResponseMessageWithContentAndTelemetryData",J,[]);var K=a(279),ca=a(15),T=a(101),Q=a(47),fa=a(92),ha=a(121),Ea=a(41),ra=a(65),Z=a(30),wa=a(118),la=a(736),ta=a(26);class Ca{constructor(Y,La,Ma,lb,pb){this.Ty=this.Nn=this.Pje=this.Nje=this.Yy=this.gy=null;this.oA=!1;this.xPf=Vb=>{Vb=Vb.Da.keyCode;return Vb===Sys.UI.Key.enter||Vb===Sys.UI.Key.space?(this.dac(),!0):!1};this.WOf=()=>{};this.Qwc=()=>{};this.XOf=Vb=>{Vb=Vb.rawEvent;if(!this.Yy||-1!==this.Yy.src.indexOf(Vb.origin)){try{var Wa=
Ea.a(Vb.data)}catch(ka){return}if(!la.c(Wa.messageType)){Vb=window.g_badCastCallback;window.g_badCastCallback=null;switch(Wa.messageType){case 2:this.vzc(new P(1,Ea.c(this.Nje),this.Pje));break;case 1:this.vzc(new J(0,this.V1h()));break;case 3:this.gy&&this.gy.selectEntity(Wa.messageContent);break;case 5:this.gy&&this.gy.XKb(Wa.messageContent);break;case 8:this.gy&&(Wa=Ea.a(Wa.messageContent),0<Wa.DomainId?this.gy.uYd(Wa.Query,Wa.TelemetryJson,Wa.DomainId,Wa.DomainIdString):this.gy.searchEntity(Wa.Query,
Wa.TelemetryJson));break;case 6:this.gy&&this.gy.cancelSearch();break;case 11:Wa=Ea.a(Wa.messageContent);Wa=Ca.Qbc("keydown","f6",fa.a.XXb,!0,!1,Wa,!0,!1);this.Yy&&this.Yy.dispatchEvent(Wa);break;case 12:if(Ea.a(Wa.messageContent).keyCode===fa.a.TO&&(Wa=Ca.Qbc("keydown","esc",fa.a.TO,!0,!1,!1,!1,!1),this.Yy&&(this.Yy.dispatchEvent(Wa),this.hide(),this.gy)))this.gy.onPaneClosed();break;case 13:this.gy&&this.gy.SRb(Wa.messageContent);break;case 14:this.gy&&this.gy.Bjb(Wa.messageContent);break;case 15:this.gy&&
this.gy.dUb(Wa.messageContent);break;case 16:this.gy&&(Wa=Ea.a(Wa.messageContent),this.gy.wQa(Wa.DomainId,Wa.DomainIdString))}window.g_badCastCallback=Vb}}};this.Qo=Y;this.jh=La;this.Iba=Ma;this.nf=lb;this.Na=pb;this.oua=ha.KeyInputManager.Gs(fa.a.tGa,0)}get mjb(){return!0}get Uzb(){return f.AFrameworkApplication.da.Ra("EnrichmentPaneUrl")}dispose(){this.mjb&&this.Ty&&(this.Qo.Ca(ca.a.click,this.Ty,Object(I.a)(this,this.bqa,"onClosePaneClick")),this.jh.Ca(ca.a.tg,this.Ty,this.xPf));this.Ty=null;this.Yy&&
(this.Gik(),this.Yy.parentNode.removeChild(this.Yy),this.Yy=null);this.nf.om("EnrichmentPaneId").Rv(this.oua)}show(Y,La,Ma){this.gy=Y;this.oA||(this.Nn=this.Gbc(),this.vXd.appendChild(this.Nn),this.czj(),this.Na.xe(ta.a.EMe,wa.a.frame,Object(I.a)(this,this.Sni,"handleEscapeKeyAction")),this.m0d(),this.oA=!0);this.Yy.src=this.Uzb&&this.Uzb.length?this.Uzb+"?culture="+La.market+"&appName="+La.applicationName+"&themeId="+La.themeId+"&featuresBitMask="+La.featuresBitMask:Ca.NIf;this.Nje=La;this.Pje=Ma;
this.Cjb()}iLc(Y,La){Y=new P(2,Y,La);this.vzc(Y)}m0d(){const Y=this.nf.om("EnrichmentPaneId");Y.parent=K.AFrame.udb;this.Qo.W5b("EnrichmentPaneId",this.Nn);Y.bindAction(this.oua,ta.a.EMe)}Oeg(){if(this.Yy){T.FocusManager.Xsa(this.Yy.contentWindow);const Y=new P(4,null,null);this.vzc(Y)}}bqa(){this.dac();return!0}dac(){this.hide();if(this.gy)this.gy.onPaneClosed()}Gbc(){const Y=H.a("div","EnrichmentPaneId","EnrichmentPane");this.mjb&&Y.appendChild(this.Arh());this.Nxi(Y);return Y}Arh(){const Y=H.b("div",
"EnrichmentPaneHeaderId","EnrichmentPaneHeader"),La=H.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");La.innerText=CommonUIStrings.l_EnrichmentPaneTitle;La.title=CommonUIStrings.l_EnrichmentPaneTitle;const Ma=N.a.Ld("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.Qo.va(ca.a.click,Ma,Object(I.a)(this,this.bqa,"onClosePaneClick"));this.jh.va(ca.a.tg,Ma,this.xPf);Y.appendChild(La);Y.appendChild(Ma);this.Ty=Ma;return Y}Nxi(Y){this.Yy=
H.b("iframe","","EnrichmentFrame");Y.appendChild(this.Yy);this.Yy.id=U.Nti;this.Yy.setAttribute("role","presentation")}czj(){Q.a.addHandler(this.Yy,"load",this.WOf);Q.a.addHandler(this.Yy,"error",this.Qwc);$addHandler(window,"message",this.XOf)}Gik(){Q.a.removeHandler(this.Yy,"load",this.WOf);Q.a.removeHandler(this.Yy,"error",this.Qwc);$removeHandler(window,"message",this.XOf)}sxh(){this.Yy.src=Ca.NIf}hide(){this.pmc();this.sxh()}Sni(Y,La,Ma){if(1!==Ma&&(this.hide(),this.gy))this.gy.onPaneClosed();
return 32}V1h(){return Ea.c([2,1,3,5,8,6])}vzc(Y){Y=Ea.c(Y);this.Yy.contentWindow.postMessage(Y,ra.a.vN(this.Uzb))}static Qbc(Y,La,Ma,lb,pb,Vb,Wa,ka){Z.a.qG?(Vb=String.format("{0} {1} {2}",Vb?"Shift":"",Wa?"Control":"",ka?"Alt":""),Vb.trim(),Ma=document.createEvent("KeyboardEvent"),Ma.initKeyboardEvent(Y,lb,pb,window.self,La,0,Vb,!1,"en-US")):(La={},La.keyCode=Ma,La.ctrlKey=Wa,La.shiftKey=Vb,La.altKey=ka,La.bubbles=lb,La.cancelable=pb,Ma=new KeyboardEvent(Y,La));return Ma}}Ca.NIf="about:blank";Object(w.a)(Ca,
"EnrichmentPane",null,[547,5]);var Ga=a(1);class Oa extends Ca{constructor(Y){super(f.AFrameworkApplication.sa.oD,f.AFrameworkApplication.sa.QB,f.AFrameworkApplication.sa.Lsa,f.AFrameworkApplication.sa.zi,f.AFrameworkApplication.Vd);this.taskPane=Y;this.taskPane.d0g(this.Oeg)}get vXd(){return this.taskPane.Df}Cjb(){this.taskPane.isVisible||this.taskPane.cA(!0)}pmc(){this.taskPane.cA(!1)}get mjb(){return!Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:8207038_EnrichmentTaskPaneHeaderFix")}dispose(){this.taskPane&&
(this.taskPane.nEj(this.Oeg),this.taskPane=null);super.dispose()}}Object(w.a)(Oa,"EnrichmentTaskPaneWrapper",Ca,[]);class eb{constructor(Y){this.XB=null;this.ija=Y}$Pi(Y,La){this.XB=Y;this.ija&&this.ija.show(this,La,null)}iLc(Y,La){this.ija&&this.ija.iLc(Y,La)}tud(){this.ija&&this.ija.hide()}dispose(){this.ija&&(this.ija.dispose(),this.ija=null)}selectEntity(Y){return this.XB?this.XB.selectEntity(Y):!1}searchEntity(Y,La){this.XB&&this.XB.searchEntity(Y,La)}uYd(Y,La,Ma,lb){this.XB&&this.XB.uYd(Y,La,
Ma,lb)}XKb(Y){return this.XB?this.XB.XKb(Y):!1}onPaneClosed(){if(this.XB)this.XB.onPaneClosed()}cancelSearch(){this.XB&&this.XB.cancelSearch()}SRb(Y){this.XB&&this.XB.SRb(Y)}Bjb(Y){this.XB&&this.XB.Bjb(Y)}dUb(Y){this.XB&&this.XB.dUb(Y)}wQa(Y,La){this.XB&&this.XB.wQa(Y,La)}}Object(w.a)(eb,"EnrichmentManager",null,[548,5]);class nb extends eb{constructor(Y){super(Y)}dispose(){super.dispose()}}Object(w.a)(nb,"ExcelEnrichmentManager",eb,[]);var $a=a(12);class oa{constructor(Y){this.campaignId=this.commentQuestion=
null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Y;this.commentQuestion=$a.a.instance.Qd(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=$a.a.instance.Qd(195);this.ratingValuesAscending=[$a.a.instance.Qd(196),$a.a.instance.Qd(197),$a.a.instance.Qd(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=
4;this.title=$a.a.instance.Qd(194)}}Object(w.a)(oa,"FloodgateSurvey",null,[]);var Fa=a(24),X=a(76),va=a(431),xa=a(45),Pa=a(383),Ka=a(202),Bb=a(91),xb=a(34),Ua=a(249),Jb=a(20);class fc{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(w.a)(fc,"EnrichmentMessageContentAppProperties",null,[]);class ya{constructor(Y,La,Ma,lb,pb){this.cya=this.dWe=
!1;this.uib=this.Poa=!0;this.sNb=this.CTb=!1;this.Ijb=null;this.Fyc=0;this.Iz=()=>{(this.uib||this.cya)&&2!==this.Fyc&&(this.sNb||this.SDd(!1))};this.vf=()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.s7i=Vb=>{xb.a.Ph(Vb.Errors)?(Vb=xb.a.Me(Vb.Errors),Vb.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Vb}`)):
Vb.Result&&(this.$.ea.gm(this.vf),this.$.ea.Yl(this.vf),Vb=Vb.Result,this.Ijb=Vb.SkydanceFeatureBitmask,this.$Hd(Vb),this.CTb=!0)};this.fi=()=>{(this.uib||this.cya)&&this.SDd(!1)};this.Jwc=(Vb,Wa)=>{xb.a.Ph(Vb.Errors)?b.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${xb.a.Me(Vb.Errors)}`):Vb.Result&&(Vb=Vb.Result,Vb.DisambiguationJson?(this.CTb=!1,this.Lfg(Wa),this.Ijb=Vb.SkydanceFeatureBitmask,Wa=Vb.DisambiguationJson,b.ULS.sendTraceTag(537166940,
0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.sNb=!1,this.Nzf(Wa)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.o$i=(Vb,Wa)=>{xb.a.Ph(Vb.Errors)?(Wa=xb.a.Me(Vb.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${Wa}`)):Vb.Result&&(Vb=Vb.Result,Vb.DisambiguationJson?(this.Lfg(Wa),this.Ijb=
Vb.SkydanceFeatureBitmask,Wa=Vb.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),this.sNb=!0,this.Nzf(Wa)):b.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.Vcj=Vb=>{xb.a.Ph(Vb.Errors)?(Vb=xb.a.Me(Vb.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Vb}`),
this.uib=!0):Vb.Result&&(Vb=Vb.Result,this.Ijb=Vb.SkydanceFeatureBitmask,this.$Hd(Vb),this.CTb=!0)};this.Pfj=Vb=>{if(xb.a.Ph(Vb.Errors)){const Wa=xb.a.Me(Vb.Errors);b.ULS.sendTraceTag(36975691,0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${Wa}`)}Vb.Result?(this.$Hd(Vb.Result),this.CTb=!0):this.bxa()};this.KSf=Vb=>{xb.a.Ph(Vb.Errors)?(Vb=xb.a.Me(Vb.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Vb}`)):
Vb.Result?this.bfc.iLc(Vb.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.bxa())};this.Ebj=Vb=>{xb.a.Ph(Vb.Errors)?(Vb=xb.a.Me(Vb.Errors),b.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${Vb}`)):this.bxa()};this.$=Y;this.gridView=Jb.h(this.$);this.gridView.ga.eK(this.fi);this.gridView.$u(this.Iz);this.a_e=lb;this.convertToLinkedEntityManager=pb;Y=new Oa(La);
this.bfc=new nb(Y);r.a.instance.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Vb=>{Vb.isFeatureEnabled("mso_sendASmile",!0).then(Wa=>{this.Poa=Wa;return null})})}dispose(){this.$&&(this.gridView.ga.YI(this.fi),this.gridView.Vx(this.Iz))}selectEntity(Y){const La=xa.o(this.gridView.ga.ra.activeCell,this.$),Ma=()=>new va.a;Pa.a(this.$.userOperationManager,(lb,pb,Vb)=>{var Wa=this.$.qa.ua;lb=Ua.b(lb,this.Pfj);const ka=Wa.Pa(9,null);ka.activeCell=La;ka.selectionIndex=Y;return F.g(Wa,
"SelectLinkedEntityForDisambiguation",ka,lb,pb,Vb,null,4)},lb=>new Ka.a(109,0,lb,void 0,Ma),null);return!0}searchEntity(Y,La,Ma,lb,pb){Ma=void 0===Ma?!1:Ma;lb=void 0===lb?0:lb;pb=void 0===pb?null:pb;b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${La}`);const Vb=xa.o(this.gridView.ga.ra.activeCell,this.$);Pa.a(this.$.userOperationManager,(Wa,ka,Sa)=>{var Xb=this.$.qa.ua,Mc=this.Poa,jc=Ma,$c=lb,Jd=pb;Wa=Ua.b(Wa,this.KSf);const fd=
Xb.Pa(1,null);fd.searchCell=Vb;fd.searchQuery=Y;fd.isFloodgateEnabled=Mc;fd.isStarterData=jc;fd.starterDataDomainId=$c;fd.starterDataDomainIdString=Jd;return F.g(Xb,"LinkedEntitySearch",fd,Wa,ka,Sa,null,4)},Wa=>new Ka.a(110,0,Wa,16),null)}XKb(Y){const La=xa.o(this.gridView.ga.ra.activeCell,this.$);this.uib=!1;Pa.a(this.$.userOperationManager,(Ma,lb,pb)=>{var Vb=this.$.qa.ua;Ma=Ua.b(Ma,this.Vcj);const Wa=Vb.Pa(1,null);Wa.activeCell=La;Wa.isBackward=Y;return F.g(Vb,"MoveToNextAmbiguousLinkedEntity",
Wa,Ma,lb,pb,null,4)},Ma=>new Ka.a(111,0,Ma,16),null);return!0}onPaneClosed(){this.cya=!1;this.dWe=!0;this.Fyc=0;this.sNb=!1}cancelSearch(){const Y=this.OYd();Y&&Pa.a(this.$.userOperationManager,(La,Ma,lb)=>{var pb=this.$.qa.ua;La=Ua.b(La,this.KSf);const Vb=pb.Pa(9,null);Vb.activeCell=Y;return F.g(pb,"CancelSearchLinkedEntity",Vb,La,Ma,lb,null,4)},La=>new Ka.a(112,0,La,16),null)}SRb(Y){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");
this.bxa();if(Y&&Y.length)if(Y=JSON.parse(Y))if(null==Y.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var La={};La.Id=Y.domainId;La.StringId=Y.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(La)}else b.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}Bjb(Y){const La=
new Bb.a(-859308420,X.a.Td,this.$.Ie,9,null);this.$.Ga.Sd(La,{[X.a.di]:"HelpID="+Y,["InputMethod"]:X.a.Td,["ShouldCanvasTakeFocus"]:!0,[X.a.qf]:x.a.AN})}dUb(Y){n.a.CXa(new oa(Y))}wQa(Y,La){const Ma=this.OYd();Ma&&Pa.a(this.$.userOperationManager,(lb,pb,Vb)=>{var Wa=this.$.qa.ua;lb=Ua.b(lb,this.Ebj);const ka=Wa.Pa(1,null);ka.cell=Ma;ka.starterDataDomainId=Y;ka.starterDataDomainIdString=La;return F.g(Wa,"InsertStarterDataTable",ka,lb,pb,Vb,null,4)},lb=>new Ka.a(259,0,lb,1),null)}SDd(Y){this.launchOrCloseDisambiguationPane(Y)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,
0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const Y=this.ROj();Y&&Pa.a(this.$.userOperationManager,(La,Ma,lb)=>D(this.$.qa.ua,Y,!0,this.Poa,!1,null,Ua.b(La,this.o$i),Ma,lb,1),La=>new Ka.a(114,0,La,16),null)}launchLinkedEntityDataTypeSelectorPane(Y,La){Pa.a(this.$.userOperationManager,(Ma,lb,pb)=>{var Vb=this.$.qa.ua;Ma=Ua.b(Ma,this.Jwc);const Wa=Vb.Pa(1,null);Wa.selectedRanges=Y;Wa.letyDomainId=La;return F.g(Vb,"GetDataTypeSelectorData",
Wa,Ma,lb,pb,2,4)},Ma=>new Ka.a(233,0,Ma,16),null)}UPi(Y,La){Y&&Pa.a(this.$.userOperationManager,(Ma,lb,pb)=>D(this.$.qa.ua,Y,!1,!1,!0,La,Ua.b(Ma,this.Jwc),lb,pb,2),Ma=>new Ka.a(257,0,Ma,16),null)}Lfg(Y){Y&&(this.Fyc=Y)}Nzf(Y){var La=new Bb.a(-90814711,X.a.Td,0,10,null);this.$.Ga.Sd(La,null);this.cya?this.bfc.iLc(Y,null):(La=3,null!=this.Ijb?La=this.Ijb:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(Y=this.M7h(Y,La))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),
this.a_e||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.bfc.$Pi(this.a_e,Y),this.cya=!0)}bxa(){this.cya&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.bfc.tud(),this.cya=!1,this.Fyc=0,this.sNb=!1)}$Hd(Y){var La=Y.Row+1;Y=Y.Column+1;0>La||0>Y?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.bxa(),
this.$.ea.gm(this.vf)):(La=new Fa.Range(La,Y,La,Y,!0,!1),this.gridView.ga.updateSelection(La,La,60),this.uib=!0)}M7h(Y,La){const Ma=new fc;Ma.applicationVersion=f.AFrameworkApplication.buildVersion;Ma.applicationName="ExcelWac";Ma.anid="00000000-0000-0000-0000-000000000000";Ma.sessionId=f.AFrameworkApplication.userSessionId;Ma.appCorrelationId=A.a.create().toString();var lb=y.a.sN(f.AFrameworkApplication.lcid);lb=lb?lb.name:null;Ma.uiLanguage=lb;Ma.market=this.Xic(lb);Ma.themeId=0;Ma.disambiguationJson=
Y;La<=z.a.t5?Ma.featuresBitMask=La:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Ma}Xic(Y){Y=Y.split("-");return Y[Y.length-1]}launchOrCloseDisambiguationPane(Y){const La=this.gridView.ga.ra.activeCell;if(this.OYd()&&La)if(this.gridView.Ud.OFb(La)){if((!this.dWe||Y||this.CTb)&&!this.gridView.Kd){Y&&(this.uib=!0);var Ma=xa.q(La,this.$);Pa.a(this.$.userOperationManager,(lb,pb,Vb)=>D(this.$.qa.ua,Ma,!1,this.Poa,!1,null,Ua.b(lb,
this.Jwc),pb,Vb,1),lb=>new Ka.a(114,0,lb,16),null)}}else this.bxa();else this.bxa()}Nxj(){if(this.cya){var Y=this.gridView.ga.ra.activeCell;if(Y){var La=xa.q(Y,this.$);Pa.a(this.$.userOperationManager,(Ma,lb,pb)=>D(this.$.qa.ua,La,!1,this.Poa,!1,null,Ua.b(Ma,this.Jwc),lb,pb,1),Ma=>new Ka.a(114,0,Ma,16),null)}else this.bxa()}}OYd(){const Y=this.gridView.ga.ra;return Y.Afa()?xa.o(Y.activeCell,this.$):null}ROj(){const Y=this.gridView.ga.ra;return Y.Afa()?xa.q(Y.activeCell,this.$):null}}Object(w.a)(ya,
"ConvertToLinkedEntityDisambiguationPane",null,[5]);var ob=a(2),Sb=a(388),Ba=a(1227),Ia=a(54),cb=a(750);class Kb{constructor(Y,La,Ma){this.mAf=2;this.lAf="Size64by48";this.$=Y;this.Wa=La;this.convertToLinkedEntityManager=Ma}N_h(Y,La){var {ConvertToLinkedEntityManager:Ma}=a(801);this.glk();La=this.Wa.Pr(La).yH();let lb=0,pb=0,Vb=!1;for(var Wa of Y.Categories){const ka=this.u0h(Wa,lb);ka&&(pb===Ma.Wcb&&(Vb=!0),La.MenuSectionList.push(ka),++lb);++pb}Vb&&lb<=Ma.nAf&&La.MenuSectionList.splice(Ma.Wcb,1);
Ma=this.Wa.Ze().e9b();Wa=Ia.a.Bj(11);for(const ka of Y.LongButtons)this.convertToLinkedEntityManager.Y0j(ka)&&this.wXg(Ma,ka,Wa);0<Ma.ControlList.length&&La.MenuSectionList.push(Ma);return La}wXg(Y,La,Ma){if(La){var lb="Data.ConvertToLinkedEntityMenuItem_"+La.Name,pb=this.convertToLinkedEntityManager.RX(La.DomainId);pb&&(La=Object(ob.a)(new Sb.a,{Id:lb,ExternalId:lb,Command:"-1662108744",LabelText:La.Name,Alt:La.SuperTip,Visible:!0,MenuItemId:a(801).ConvertToLinkedEntityManager.Y6a(La.DomainId),Image16by16:Ma,
Image16by16Class:this.mui(pb.FontLocator)}),Y.ControlList.push(La))}}p0h(Y,La){return Object(ob.a)(new Ba.a,{Id:a(801).ConvertToLinkedEntityManager.RXe+Y.toString(),ExternalId:a(801).ConvertToLinkedEntityManager.RXe+Y.toString(),MenuItemId:a(801).ConvertToLinkedEntityManager.Xgd+Y.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.Wmf(La.FontLocator),LabelText:La.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.mod(La)})}p7g(Y){switch(Y){case "Animal":return cb.a.y3g;
case "Apple":return cb.a.E4g;case "Atom":return cb.a.g6g;case "Beaker":return cb.a.g8g;case "Bridge":return cb.a.J9g;case "Cat":return cb.a.Yeh;case "City":return cb.a.hhh;case "Constellation":return cb.a.fmh;case "Dog":return cb.a.tDh;case "Finance":return cb.a.Z7g;case "GradCap":return cb.a.smi;case "HumanAnatomy":return cb.a.Jti;case "LocationPointer":return cb.a.GSi;case "Map":return cb.a.ojj;case "MedicineNeedle":return cb.a.pZi;case "Mountain":return cb.a.I_i;case "Movie":return cb.a.$_i;case "Music":return cb.a.m0i;
case "OuterSpace":return cb.a.Wjj;case "Planet":return cb.a.fnj;case "Satellite":return cb.a.eMj;case "WolframGeneric":return cb.a.TKj;default:return cb.a.Vnh}}mui(Y){if("PowerBIRibbon"!==Y)return u.a.qjd;switch(Y){case "AnimalRibbon":return u.a.iOh;case "AppleRibbon":return u.a.jOh;case "AtomRibbon":return u.a.kOh;case "BeakerRibbon":return u.a.lOh;case "BridgeRibbon":return u.a.mOh;case "CenterMapRibbon":return u.a.nOh;case "CityRibbon":return u.a.oOh;case "CurrencyRibbon":return u.a.pOh;case "ExerciseRibbon":return u.a.qOh;
case "FinanceRibbon":return u.a.I2e;case "FirstAidRibbon":return u.a.rOh;case "GlobeLightningRibbon":return u.a.sOh;case "GradCapRibbon":return u.a.tOh;case "HumanAnatomyRibbon":return u.a.uOh;case "LeafRibbon":return u.a.vOh;case "LocationPointerRibbon":return u.a.xOh;case "MapRibbon":return u.a.G2e;case "MountainRibbon":return u.a.yOh;case "MovieRibbon":return u.a.zOh;case "MusicRibbon":return u.a.AOh;case "NotablePeopleRibbon":return u.a.BOh;case "OuterSpaceRibbon":return u.a.COh;case "PartlySunnyWeatherRibbon":return u.a.DOh;
case "PowerBIRibbon":return u.a.H2e;case "SatelliteRibbon":return u.a.EOh;case "WolframGenericRibbon":return u.a.wOh;case "YogaRibbon":return u.a.GOh;default:return u.a.F2e}}Wmf(Y){switch(Y){case "AnimalRibbon":return"AnimalExcelDataTypes_24";case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";
case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";
case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";
case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}u0h(Y,La){La=this.Wa.TF("ConvertToLinkedEntitySection_"+La,this.mAf,this.lAf);var Ma=!1;for(var lb of Y.DomainIds){const pb=this.convertToLinkedEntityManager.RX(lb);if(!pb||pb.DomainBlocked||!pb.ShowInRibbon)continue;Ma=pb.Name;const Vb=a(801).ConvertToLinkedEntityManager.Y6a(lb);La.jw("Data.ConvertToLinkedEntityMenuItem_"+Vb,-1203788282,"QueryLinkedEntityGalleryIcon",
void 0,Vb,this.Wmf(pb.FontLocator),void 0,void 0,this.mod(pb),Ma);Ma=!0}if(!Ma)return null;lb=La.d9b(!0);La=this.Wa.Ze();La.title=Y.Name;Y=La.e9b();Y.ControlList.push(lb);return Y}glk(){this.mAf=5;this.lAf="Size112by64"}mod(Y){return Y.RibbonTooltipHeader?Y.RibbonTooltipHeader+"\n\n"+Y.RibbonTooltip:Y.RibbonTooltip}}Object(w.a)(Kb,"ConvertToLinkedEntityMenuRenderer",null,[442]);var db=a(60),gb=a(323),yb=a(127),Nb=a(107),qc=a(71);class Gb{constructor(Y,La){this.Wtd=this.Xtd=!1;this.kMd=Ma=>{b.ULS.sendTraceTag(537166680,
0,50,"OnReadRoamingStringSuccess called.");this.Xtd=!0;if(xb.a.Ph(Ma.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${xb.a.Me(Ma.Errors)}`);else{var lb=0,pb=[],Vb=!1;try{if(!Ma.Result)return;const Wa=Ma.Result;if(!Wa){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}pb=this.olj(Wa);if(!pb||!pb.length)return;lb=pb.length;this.EZi(pb);this.oEa.T8f();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.oEa.Tgb.length}`);
if(Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const ka of this.oEa.Tgb)if(1===(ka.Id&1048320)>>8){Vb=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Vb}`)}}finally{b.ULS.sendTraceTag(537166675,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${lb} data types.`),Ma=[],Ma.push(Object(ob.a)(new qc.a,{name:"MruCount",int64:lb})),Ma.push(Object(ob.a)(new qc.a,{name:"MruWolframAvailable",bool:Vb})),Nb.a("ReadRecentlyUsedLinkedDataTypes",
void 0,void 0,Ma)}this.Wtd&&(this.vzg(this.oEa.Tgb),this.Wtd=!1)}};this.bNd=Ma=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");xb.a.Ph(Ma.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${xb.a.Me(Ma.Errors)}`):Ma.Result&&(Ma.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.oSf=(Ma,lb,pb)=>{Ma=yb.a.kh(Ma.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${pb}. Errors: ${xb.a.Me(Ma)}.`)};
this.$=Y;this.oEa=La}Afi(){!this.Xtd&&this.$.ea.Ee&&(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),gb.y(this.$.qa.ua,0,this.kMd,this.oSf,null,null))}vzg(Y){Y&&Y.length?this.Xtd?(Y=this.DQj(Y))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),gb.F(this.$.qa.ua,0,Y,this.bNd,this.oSf,null,null)):b.ULS.sendTraceTag(537166689,
0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Wtd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}DQj(Y){if(!Y||!Y.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var La=[];for(const Ma of Y)Y={},Y.Id=Ma.Id,Ma.StringId&&(Y.StringId=Ma.StringId),La.push(Y);La="<DataTypes>"+db.a.ff(La)+
"</DataTypes>";return 1906<La.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):La}olj(Y){if(!Y)return b.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!Y.startsWith("<DataTypes>")||!Y.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;
Y=Y.substring(11,Y.length-12);if(!Y)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let La=[];try{La=db.a.kl(Y)}catch(Ma){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Ma.message}`),null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${La.length} data types.`);return La}EZi(Y){const La=this.oEa.Tgb,Ma=this.oEa.Gwj;if(La.length!==Ma){for(let lb=
0;lb<Y.length&&La.length<Ma;++lb){const pb=Y[lb];this.oEa.RX(pb)&&!La.includes(pb)&&La.push(pb)}this.oEa.Tgb=La}}}Object(w.a)(Gb,"LinkedDataTypeRoamingHandler",null,[]);var hb=a(59),qb=a(62),ab=a(155),Mb=a(40),Ib=a(52),fb=a(32),Db=a(234),Za=a(22),sb=a(108),sa=a(94),ba=a(142),ua=a(13);a.d(B,"ConvertToLinkedEntityManager",function(){return R});class R extends v.a{constructor(Y,La,Ma,lb,pb,Vb,Wa){super();this.xwf=this.CBd=this.ACd=this.tAd=this.sAd=this.oqc=null;this.ALb=this.ztd=0;this.tpa=null;this.Bxd=
!1;this.pmd=this.Dq=this.sXd=null;this.Cv=0;this.k1=null;this.QPa=8;this.i9c=this.kAf=this.osf=this.mfb=!1;this.pDa=this.T8e=this.v5e=null;this.m7c=0;this.A7g=5;this.x8b=3E4;this.irg=!1;this.Hwa=null;this.lya=Array(5);this.$tg=this.t8d=!1;this.t$f=this.qEd=0;this.De=this.Rne=null;this.Ukg=!0;this.vf=(ka,Sa)=>{Sa.Ee&&!Sa.SHb&&this.showUntrustedImageBusinessBarIfNecessary()};this.oaj=ka=>{if(ka.Result){var Sa=ka.Result;if(Sa&&Sa.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${Sa.length} labels`);
var Xb=qb.GetServiceTaskFactory.je(this.$.ia,274,275,0);Mb.TaskExtensions.Aa(Xb,()=>{Xb.result.Z6c(Sa,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.ma,3)}}else b.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};this.gi=()=>{this.ngk();this.Hoi(this.$.ea.Kp.LinkedEntityAsyncRefreshStateId);this.Rpi(this.$.ea.Kp.RichDataClassificationLabelStateId)};this.C8i=()=>{this.t8d=!0;
this.Dq&&this.Dq.Nxj()};this.H$i=ka=>{if(ka&&!Db.a(ka))try{ka.Result.HasUntrustedImageUrl&&(this.businessBar.ej(59,null),this.$tg=!0)}catch(Sa){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${Sa}.`)}};this.Jzf=()=>{if(!this.kAf&&this.nGb()&&!this.pyd())if(Nb.a("DataTabActive"),hb.a.Ji.zU)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var ka=this.Ebc();if(ka){var Sa=
{};Sa.InputMethod=X.a.Td;Sa.CalloutName=8;Sa.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ga.Sd(ka,Sa);this.kAf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};
this.t7i=ka=>{xb.a.Ph(ka.Errors)||this.raiseEvent("LinkedEntityConverted")};this.Qgj=()=>{Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?void ba.a.Pu(ua.g).then(ka=>{ka.readText($a.a.instance.ha(1813))}):this.$.ia.Od(211,ka=>{ka.readText($a.a.instance.ha(1813))})};this.fg=(ka,Sa)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Sa.VY?b.ULS.sendTraceTag(537166865,0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):
(this.$.isEditMode?this.dLe():this.yIj(),this.t8d&&this.aZe())};this.Q$i=ka=>{this.L$b();if(ka.Result){var Sa=ka.Result;ka=Sa.DomainDataArray;if(this.tpa=Sa.Ribbon){var Xb={};Xb.Name=$a.a.instance.ha(1803);Xb.DomainIds=this.MN;this.tpa.Categories.splice(R.Wcb,0,Xb)}0<Sa.MaximumCellsToConvert&&(this.Rne=Sa.MaximumCellsToConvert);this.Cv=2;Sa=!1;if(ka){b.ULS.sendTraceTag(39949271,0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${ka.length} domains`);this.oSa||(this.oSa=[]);Xb=$a.a.instance.ha(1800);
const Mc=$a.a.instance.ha(1802);for(const jc of ka)jc.DomainId?(this.oSa.push(jc),jc.DomainBlocked?(ka=!!jc.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${ka?jc.DomainId.Id.toString():jc.Name} is telemetry only, do not show in menu (Has String ID: ${ka})`)):(this.QX.fa(R.Y6a(jc.DomainId),jc),jc.Name===Xb||268435456===jc.DomainId.Id?this.v5e=jc.DomainId.Id.toString():jc.Name===Mc||536870912===jc.DomainId.Id?this.T8e=jc.DomainId.Id.toString():268435712===jc.DomainId.Id&&jc.ShowInRibbon&&
(this.i9c=!0),Sa=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}Sa||(this.oSa=null);this.Oug();this.sXd.Afi();this.irg||(this.igk(),this.irg=!0)}else this.oSa=null,this.Cv=3,-1<this.QPa&&window.setTimeout(()=>{this.fOb()},100*(8-this.QPa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.DSd();this.tRe();this.i9c&&this.Ktf&&ab.c(this.Jzf,this.$.ma,500)};this.P$i=ka=>{ka=yb.a.kh(ka.data);b.ULS.sendTraceTag(34415007,
0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${xb.a.Me(ka)}].`);this.oSa=null;this.Cv=3;this.mfb=!0;this.DSd()};this.onContentReady=()=>{this.Dsg()&&this.gridView.Vx(this.onContentReady);this.Ukg&&this.$.workbookContext.Options&1048576&&(this.businessBar.b5j(),this.Ukg=!1)};this.ml=()=>{this.L$b()};this.tcj=ka=>{if(Db.a(ka)){const Sa=Object(sa.d)(ba.a.resolve(ua.p,{Oa:0}));Mb.TaskExtensions.Aa(Sa,()=>{let Mc=null;if(null===ka||void 0===ka?0:ka.Errors)Mc=ka.Errors[0];Sa.result.ykg(Mc,null)},
this.$.ma,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${xb.a.Me(ka.Errors)}].`);const Xb=xb.a.IE(ka.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.pq(Xb)}};this.d9c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.x8b} millisecond interval`);
this.Dpf("Periodic auto-refresh check",this.E5i,this.D5i)};this.E5i=ka=>{Db.a(ka)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${xb.a.Me(ka.Errors)}].`),++this.m7c):this.m7c=0;c.a.Ma(this.pDa);this.m7c>=this.A7g?(b.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),
this.pDa=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.pDa=Ib.a.instance.create(this.d9c,this.x8b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.D5i=ka=>{ka=yb.a.kh(ka.data);h.a.Fj(ka)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${xb.a.Me(ka)}].`);
c.a.Ma(this.pDa);this.pDa=Ib.a.instance.create(this.d9c,this.x8b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.vdj=ka=>{ka=!!ka.Result&&ka.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${ka.toString()}`);ka?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${fb.a.Jd.Og.m-this.ztd} ms, retry count = ${this.ALb}`),this.fOb()):this.UHc()};this.udj=()=>{b.ULS.sendTraceTag(537166788,
0,15,"OnNotifyFeatureLicensingStatusFailed");this.UHc()};this.s$i=ka=>{ka.Result?(ka=ka.Result)?(this.MTd(),this.businessBar.ykg(null,ka)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=Y;this.businessBar=Vb;this.svgIconProvider=Ma;this.De=Wa;this.oSa=[];this.MN=[];this.gridView=Jb.h(this.$);this.Klc=-1;this.XHi=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");
this.Ktf=Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.QX=new sb.a;this.Gdb=new Kb(Y,La,this);lb&&(this.Dq=new ya(Y,lb,pb,this,this));this.$.zn(this.fg);t.a(this.$)&&t.a(this.$).jSj(this);this.dLe();this.$.ea.kx(this.gi);Ga.EwaSettings.Fa(123)&&Ga.EwaSettings.Fa(131)&&(this.Dsg()||this.gridView.$u(this.onContentReady));this.$.cC(this.ml);this.$.ea.Yl(this.vf);this.showUntrustedImageBusinessBarIfNecessary();this.sXd=new Gb(this.$,this)}dispose(){this.$.ea.Ky(this.gi);
this.$.ea.gm(this.vf);!this.Hwa&&Ga.EwaSettings.Fa(123)&&Ga.EwaSettings.Fa(131)&&this.gridView.Vx(this.onContentReady);this.Dq&&this.Dq.dispose();this.$.JE(this.ml);this.$.uo(this.fg);c.a.Ma(this.pDa)}J_g(Y){this.addHandler("LinkedEntityConverted",Y)}ZDj(Y){this.removeHandler("LinkedEntityConverted",Y)}get Gwj(){return 5}get Tgb(){return this.MN}set Tgb(Y){this.MN=Y}selectEntity(Y){return this.Dq?this.Dq.selectEntity(Y):!1}searchEntity(Y,La){this.Dq&&this.Dq.searchEntity(Y,La)}uYd(Y,La,Ma,lb){this.Dq&&
this.Dq.searchEntity(Y,La,!0,Ma,lb)}XKb(Y){return this.Dq?this.Dq.XKb(Y):!1}onPaneClosed(){if(this.Dq)this.Dq.onPaneClosed()}cancelSearch(){this.Dq&&this.Dq.cancelSearch()}SRb(Y){this.Dq&&this.Dq.SRb(Y)}Bjb(Y){this.Dq&&this.Dq.Bjb(Y)}dUb(Y){this.Dq&&this.Dq.dUb(Y)}wQa(Y,La){this.Dq&&this.Dq.wQa(Y,La)}Rpi(Y){if(this.$.isEditMode&&this.t$f!==Y&&f.AFrameworkApplication.da.na("SupportsPolicies")){this.t$f=Y;b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");
Y=this.$.qa.ua;var La=this.oaj;const Ma=Y.Pa(1,null);F.g(Y,"GetRichDataClassificationLabels",Ma,La,null,null,null,4)}}aZe(){this.$.userOperationManager.enqueueOperation(new Ka.a(589,0,(Y,La,Ma)=>{var lb=this.$.qa.ua;Y=Ua.b(Y,this.C8i);const pb=lb.Pa(1,null);return F.g(lb,"LinkedEntitiesEnableUntrustedImages",pb,Y,La,Ma,null,0)},80),null)}showUntrustedImageBusinessBarIfNecessary(){this.t8d||this.$tg||!this.$.ea.Ee||this.DPj()}DPj(){this.$.userOperationManager.enqueueOperation(new Ka.a(588,0,(Y,La,
Ma)=>{var lb=this.$.qa.ua;Y=Ua.b(Y,this.H$i);const pb=lb.Pa(1,null);return F.g(lb,"GetHasUntrustedImageUrls",pb,Y,La,Ma,null,4)},80),null)}get vKb(){return this.lya.length}get mZi(){return this.Rne}Wnh(Y){(Y=this.xDh(Y))?this.convertToLinkedEntity(Y):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(Y){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${Y.Id}].`);if(this.gridView){var La=
this.gridView.ga.ra.Ef,Ma=La.Sg(this.gridView.YT);this.Bxd&&this.hYg(Y);if(Ma){Ma=this.gridView.Ud.fBa(Ma);if(!this.skf(Y)&&this.Nuf(Y.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(hb.a.Ji.zU){La=this.znd();if(!La){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Ma=this.Ebc();if(!Ma){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");
return}var lb={["InputMethod"]:X.a.Td,CalloutName:3};lb.Target=La;lb.RibbonButtonLabel=Ga.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.f$f(Y):this.IIb(Y.Id.toString());lb.ExampleEntities=this.C3e(Y);this.$.Ga.Sd(Ma,lb);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Nuf(Y.Id)&&!Y.StringId)this.launchLinkedEntityDataTypeSelectorPane(R.Y6a(Y));
else{if(Ma){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.u$j(Y)){La=xa.r(this.gridView.ga.ra.selectedRanges,this.$);this.Dq.UPi(La,Y);return}if(hb.a.Ji.zU){La=this.znd();if(!La){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Ma=this.Ebc();if(!Ma){b.ULS.sendTraceTag(537166912,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}lb={["InputMethod"]:X.a.Td,CalloutName:2};lb.Target=La;lb.RibbonButtonLabel=this.f$f(Y);lb.ExampleEntities=this.C3e(Y);lb.BlankCellResourceId=this.F8g(Y);lb.HasBlankCellWalkthrough=this.Jqi(Y);lb.ServiceDomain=Y.Id;this.$.Ga.Sd(Ma,lb);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.gcd(Y,!1,La)}}}else b.ULS.shipAssertTag(537166919,
0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.Hwa&&this.Hwa.vMa()}onAutoDetectUIShown(){Pa.a(this.$.userOperationManager,(Y,La,Ma)=>{var lb=this.$.qa.ua;const pb=lb.Pa(1,null);return F.g(lb,"OnAutoDetectUIShown",pb,Y,La,Ma,null,4)},Y=>new Ka.a(230,0,Y,80),null)}gcd(Y,La,Ma){const lb=xa.q(Ma,this.$),pb=()=>new va.a;Pa.a(this.$.userOperationManager,(Vb,Wa,ka)=>{var Sa=this.$.qa.ua;Vb=Ua.b(Vb,this.t7i,this.Qgj,this.Dq.s7i);const Xb=Sa.Pa(1,null);Xb.selectedRanges=lb;
Xb.domainId=Y;Xb.autodetect=La;return F.g(Sa,"ConvertToLinkedEntity",Xb,Vb,Wa,ka,null,4)},Vb=>new Ka.a(115,0,Vb,void 0,pb),null)}hYg(Y){if(this.Bxd){var La={};La.Id=Y.Id;Y.StringId&&(La.StringId=Y.StringId);if(!(0<this.MN.length&&this.MN[0].Id===La.Id&&this.MN[0].StringId===La.StringId)){Y=!1;this.MN.splice(0,0,La);for(let Ma=1;Ma<this.MN.length;++Ma)if(this.MN[Ma].Id===La.Id&&this.MN[Ma].StringId===La.StringId){this.MN.splice(Ma,1);Y=!0;break}for(;5<this.MN.length;)this.MN.splice(this.MN.length-
1,1);this.tpa.Categories[R.Wcb].DomainIds=this.MN;this.T8f();Y||this.sXd.vzg(this.MN)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var Y=xa.q(this.gridView.ga.ra.Ef,this.$);Pa.a(this.$.userOperationManager,(La,Ma,lb)=>{var pb=this.$.qa.ua;const Vb=pb.Pa(1,null);Vb.selectedRanges=Y;return F.g(pb,"ConvertLinkedEntityToText",Vb,La,Ma,lb,null,4)},La=>new Ka.a(116,0,La),null)}else b.ULS.shipAssertTag(537166879,
0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(Jb.h(this.$)){this.$.isEditMode||b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.MTd();var Y=xa.r(this.gridView.ga.ra.selectedRanges,this.$);Pa.a(this.$.userOperationManager,(La,Ma,lb)=>{var pb=this.$.qa.ua;const Vb=pb.Pa(1,
null);Vb.selectedRanges=Y;return F.g(pb,"RefreshLinkedEntitiesInRange",Vb,La,Ma,lb,null,4)},La=>new Ka.a(248,0,La),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}Y0j(Y){Y=this.RX(Y.DomainId);if(!Y||Y.DomainBlocked||!Y.HasCuratedData)return!1;if(this.XHi){for(let La of this.QX)if(La.value.DomainId.Id===Y.DomainId.Id&&La.value.ShowInRibbon)return!0;return!1}return Y.ShowInRibbon}x_j(Y){return 2!==this.Cv||!this.lya[Y]}launchDisambiguationPaneForSearch(){this.Dq&&this.Dq.launchDisambiguationPaneForSearch()}mf(Y,
La,Ma){if("PopulateConvertToLinkedEntityMenu"!==La)return!1;this.pmd=Ma.MenuId;if(0===this.Cv||3===this.Cv)return this.Onj(),!0;if(!this.tpa)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.QX)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.k1=this.k1||this.Gdb.N_h(this.tpa,Ma.MenuId);Ma.MenuItems=this.k1;return this.Bxd=!0}Onj(){-1===this.Klc&&(this.fOb(),this.Klc=window.setInterval(()=>
{this.fOb()},2E3))}fOb(){if(this.$.ea.Ee&&2!==this.Cv){this.QPa--;b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.Cv=1;var Y=this.$.qa.ua,La=this.Q$i,Ma=this.P$i;const lb=Y.Pa(1,null);F.g(Y,"GetLinkedEntityMetadata",lb,La,Ma,null,null,4)}}pyd(){return this.$.isEditMode&&2!==this.Cv&&(0<=this.QPa||!this.mfb)}k9d(Y){f.AFrameworkApplication.ij?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):
t.a(this.$)?(this.Plk(),Y&&this.$.xj()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}yIj(){this.ALb=0;this.QPa=8;this.mfb=!1;this.Cv=this.Klc=0;this.oSa=this.tpa=null;this.L$b();for(let Y=0;Y<this.vKb;++Y)this.lya[Y]=null;this.nGb()&&this.k9d(!0)}L$b(){this.k1=null}nGb(){const Y=x.a.bPb,La=t.a(this.$);return!!La&&La.xr.$z===Y}Oug(){if(this.tpa){let Ma=0;var Y=-1,La=-1;let lb=0,pb=0,Vb=0,Wa=0;const ka=[null,null,null,null,null];for(const Sa of this.tpa.Categories){let Xb=
!1;for(const Mc of Sa.DomainIds){let jc=this.RX(Mc);jc&&!jc.DomainBlocked&&jc.ShowInRibbon&&(Ma<this.vKb?(this.lya[Ma]=Mc,pb===R.Wcb&&(-1===Y&&(Y=Ma),La=Ma,Wa=La-Y+1),++Ma):Ma===this.vKb&&lb<Wa&&pb!==R.Wcb&&(ka[lb]=Mc,++lb),Xb=!0)}Xb&&++Vb;++pb}if(-1<Y&&Vb<=R.nAf){for(;La>=Y;--La)this.lya.splice(La,1);for(Y=0;Y<Wa;++Y)this.lya.splice(Ma+Y,0,ka[Y])}for(;Ma<this.vKb;)this.lya[Ma]=null,++Ma}}Dsg(){const Y=Jb.h(this.$).ya,La=this.gridView.ga.eh;if(Y&&Y.Ftd&&1===La&&this.gridView.ga.ra.activeCell){const Ma=
Object(sa.d)(ba.a.resolve(ua.Zc,{Oa:1}));Mb.TaskExtensions.Aa(Ma,()=>{this.Hwa=new m.a(this.$,this.svgIconProvider,Ma.result,this,this.De)},this.$.ma,3);return!0}return!1}XPi(){this.Dq&&this.Dq.SDd(!0)}launchLinkedEntityDataTypeSelectorPane(Y){if(this.Dq)if(Y=this.Agd(Y))if(Y.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var La=xa.r(this.gridView.ga.ra.selectedRanges,this.$);this.Dq.launchLinkedEntityDataTypeSelectorPane(La,
Y.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}imh(Y){const La=this.lui(Y),Ma=e.a.Bm(this.IIb(Y));Y=e.a.Bm(this.N6d(Y));return R.r_h(La,Ia.a.Bj(11),Ma,Y)}N6d(Y){try{return this.eXe(parseInt(Y,10)).Description}catch(La){}return $a.a.instance.ha(1797)}IIb(Y){try{return this.eXe(parseInt(Y,10)).Name}catch(La){}return $a.a.instance.ha(1783)}f$f(Y){try{return this.RX(Y).Name}catch(La){}return this.IIb(Y.Id.toString())}F8g(Y){try{return this.RX(Y).BlankCellResourceId}catch(La){}return null}Jqi(Y){try{return this.RX(Y).HasBlankCellWalkthrough}catch(La){}return!1}skf(Y){try{const La=
R.Y6a(Y);if(this.QX.Hd(La))return this.QX.ka(La).HasCuratedData}catch(La){}return!1}u$j(Y){try{return this.RX(Y).SupportsStarterData}catch(La){}return!1}Nuf(Y){return 268435968===Y}znd(){return 2===t.a(this.$).vR?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}Ebc(){return new Bb.a(-847286761,X.a.Td,this.$.Ie,0,x.a.i4)}tRe(){if(this.nGb()&&!this.pyd()&&!this.osf&&Ga.EwaSettings.Fa(387)&&this.skf({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
hb.a.Ji.zU){const Ma=this.znd();if(Ma){var Y=this.Ebc();if(Y){var La={["InputMethod"]:X.a.Td,CalloutName:6};La.Target=Ma;La.ShouldCanvasTakeFocus=!0;this.$.Ga.Sd(Y,La);this.osf=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}Tti(Y){Y=
this.Agd(Y);return Y?this.Gdb.p7g(Y.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}moc(Y){return this.Hwa?this.Hwa.o7g(Y):!1}B2h(){return this.Hwa?this.Hwa.x3h():""}s7h(Y,La){const Ma=this.Cnf(Y);if(0>Ma)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${Y}`);else if(Y=(Y=this.fXe(Y))?this.RX(Y):null)La[k.a.GalleryButtonProps]=this.Gdb.p0h(Ma,
Y),La[k.a.Alt]=this.Gdb.mod(Y)}T8f(){this.Oug();this.nGb()&&this.k9d(!0);this.L$b()}lui(Y){return Y===this.v5e?u.a.I2e:Y===this.T8e?u.a.G2e:u.a.F2e}C3e(Y){try{return this.RX(Y).ExampleEntities}catch(La){}return $a.a.instance.ha(1805)}DSd(){(0>this.QPa||this.mfb)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.Cv||0>this.QPa||this.mfb)&&window.clearInterval(this.Klc);this.pyd()?this.pmd&&this.$.frame.iA(this.pmd):this.k9d(this.nGb())}we(Y){return this.$.He+
Y}Plk(){var Y=!0;const La=Array(this.vKb),Ma=t.a(this.$)?t.a(this.$).xr:null;if(Ma){for(let lb=0;lb<La.length;++lb)this.x_j(lb)?La[lb]=!0:Y=La[lb]=!1;Ma.Zfg(["ConvertToLinkedEntityGallery"],Y);if(!Y)for(Y=0;Y<La.length;++Y)La[Y]&&Ma.Zfg([this.r7h(Y)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}RX(Y){const La=R.Y6a(Y);if(this.QX.Hd(La))return this.QX.ka(La);b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${Y.Id} (Has String ID: ${!!Y.StringId})`);
return null}r7h(Y){return"ConvertToLinkedEntityPreview"+Y.toString()}a9d(){l.a.get_instance().jk(10,()=>{this.tRe();this.i9c&&this.Ktf&&ab.c(this.Jzf,this.$.ma,500)})}ylc(Y,La){switch(Y){case "QueryLinkedEntityGalleryButtons":if(!La[k.a.InnerHTML]){Y=La[X.a.qf].toString();const Ma=Za.a.equals(Y,$a.a.instance.ha(1800),!0)||Za.a.equals(Y,$a.a.instance.ha(1801),!0),lb=Za.a.equals(Y,$a.a.instance.ha(1802),!0);Ma||lb||this.s7h(Y,La)}break;case "QueryLinkedEntityMenuGalleryButtons":La[k.a.InnerHTML]||(La[k.a.InnerHTML]=
this.imh(La[X.a.qf]))}return La}xDh(Y){var La=this.fXe(Y);if(La)return La;if(La=this.Agd(Y))return La.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${Y}`);return null}eXe(Y){const La={};La.Id=Y;return this.RX(La)}Agd(Y){return this.QX.Hd(Y)?this.QX.ka(Y):null}Cnf(Y){if(!Y.startsWith(R.Xgd))return-1;const La=parseInt(Y.substr(R.Xgd.length),10);return isNaN(La)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${Y}`),-1):La}fXe(Y){Y=
this.Cnf(Y);return 0>Y?null:this.lya[Y]}Dpf(Y,La,Ma){if(this.QX&&this.QX.count){b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${Y})`);var lb=this.$.qa.ua.ze();this.$.ea.Ee&&(Y=this.$.qa.ua,La=Ua.b(this.tcj,La),lb=Y.Pa(1,void 0===lb?null:lb),F.g(Y,"LinkedEntityTryAutoRefresh",lb,La,Ma,null,null,0))}}igk(){this.Dpf("Auto-refresh on load",null,null)}ngk(){this.QX&&this.QX.count&&(this.pDa?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):
this.$.ea.Kp.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.pDa=Ib.a.instance.create(this.d9c,this.x8b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}UHc(){if(this.$.ea.Ee&&
null!=this.oqc&&null!=this.sAd&&null!=this.tAd&&null!=this.ACd&&null!=this.CBd)if(++this.ALb,12>=this.ALb){1===this.ALb&&(this.ztd=fb.a.Jd.Og.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const Y=this.$.qa.ua.ze();gb.w(this.$.qa.ua,this.bRi,this.cRi(),this.vdj,this.udj,null,Y)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${fb.a.Jd.Og.m-this.ztd} ms`),this.mfb=!0,this.DSd()}dLe(){if(this.$.isEditMode)if(null!=
this.oqc)this.UHc();else{var Y=fb.a.Jd.Og.m,La=[];r.a.instance.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ma=>{Ma.isFeatureEnabled("ExcelPowerBiPro",!1).then(lb=>{b.ULS.sendTraceTag(537166747,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${fb.a.Jd.Og.m-Y} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${lb}]`);return this.oqc=lb}).then(()=>{La.push(Ma.isFeatureEnabled("ExcelWolframAlpha",
!1).then(lb=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${fb.a.Jd.Og.m-Y} Millisecond.`);b.ULS.sendTraceTag(537166743,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${lb}]`);return this.ACd=lb}))}).then(()=>{La.push(Ma.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(lb=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${fb.a.Jd.Og.m-
Y} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${lb}]`);const pb=[Object(ob.a)(new qc.a,{name:"IsRestrictedByLicense",bool:lb})];Nb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,pb);this.xwf=lb&&Ga.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return lb}))}).then(()=>{La.push(Ma.isFeatureEnabled("StockHistory",!1).then(lb=>{b.ULS.sendTraceTag(537166739,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${fb.a.Jd.Og.m-Y} Millisecond.`);b.ULS.sendTraceTag(537166738,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${lb}]`);return this.CBd=lb}))}).then(()=>{La.push(Ma.isFeatureEnabled("ExcelPowerBiFree",!1).then(lb=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${fb.a.Jd.Og.m-Y} Millisecond.`);b.ULS.sendTraceTag(537166735,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${lb}]`);return this.sAd=lb}))}).then(()=>{La.push(Ma.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(lb=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${fb.a.Jd.Og.m-Y} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${lb}]`);
return this.tAd=lb}))}).then(()=>{Promise.all(La).then(()=>{this.UHc()})})})}}get bRi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}cRi(){return[this.oqc,this.ACd,this.CBd,this.sAd,this.tAd,this.xwf]}MTd(){this.businessBar&&this.businessBar.Moa(58)&&this.businessBar.removeEntry(58)}Hoi(Y){if(this.qEd!==Y&&this.businessBar)if(this.qEd=Y){Y=this.$.qa.ua;var La=this.s$i;const Ma=Y.Pa(1,null);F.g(Y,"GetErrorMessageForLinkedDataTypeRefresh",
Ma,La,null,null,null,4)}else this.MTd()}static r_h(Y,La,Ma,lb){Y=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Y,La,lb);Ma=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',Ma);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',Y,Ma)}static Y6a(Y){return Y.StringId?Y.Id.toString()+"."+Y.StringId:
Y.Id.toString()}}R.RXe="ConvertToLinkedEntityPreview";R.Xgd="PreviewGalleryButtonIndex.";R.Wcb=0;R.nAf=2;Object(w.a)(R,"ConvertToLinkedEntityManager",v.a,[411,412,5,413])},883:function(w,B,a){a.d(B,"a",function(){return c});w=a(0);B=a(748);var b=a(91);class c extends B.a{constructor(h,f,e){super(h,f);this.su=!0;this.command=e}Go(h){super.Go(h);this.businessBar.$.Ga.Sd(new b.a(this.command,h,this.businessBar.$.Ie,10,null))}}Object(w.a)(c,"CommandActionBusinessBarEntry",B.a,[])},904:function(w,B,a){a.r(B);
w=a(0);var b=a(2),c=a(16),h=a(328),f=a(34),e=a(11),k=a(278);class l{constructor(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}}Object(w.a)(l,"ConnectionErrorLogInfo",null,[]);var r=a(1112),v=a(1113);class u{constructor(n){this.Zud=[r.a.sAg,r.a.jNc];this.xo=(A,y)=>{this.tR[y]=A;this.vri()&&this.xHj("OnNetworkDownImmediatePing"===A.caller)};this.Lpa=n;this.$=n.$;this.tR={}}SPi(){const n=v.a.Mmd(this.xo,"OnNetworkDownImmediatePing",this.$,this.Zud);for(const A of n)A.runTest()}vri(){for(const n of this.Zud)if(void 0===
this.tR[n]||null===this.tR[n])return!1;return!0}xHj(n){const A=this.$.xh.u9;n&&this.r9j(A);for(var y of this.Zud)this.tR[y]=Sys.Serialization.JavaScriptSerializer.serialize(this.tR[y]);n=Date.now();y=(()=>this.Lpa.Xrd(a(904).NetworkConnectionHealthChecker.mLb))().returnValue;const z=(()=>this.Lpa.Xrd(a(904).NetworkConnectionHealthChecker.pSb))().returnValue;this.tR.isOfflineMode=A;this.tR.networkDownBBAge=-1===y?y:n-y;this.tR.transientServerCommunicationFailuresBBAge=-1===z?z:n-z;this.Lpa.businessBar?
(this.tR.isNetworkDownBBShown=this.Lpa.businessBar.HH(56).toString(),this.tR.isServerErrorBBShown=this.Lpa.businessBar.HH(21).toString()):(this.tR.isNetworkDownBBShown="unknown",this.tR.isServerErrorBBShown="unknown");c.ULS.sendTraceTag(537155224,0,50,`ConnectionHealthTestsRunner.ReportPingResults: ${Sys.Serialization.JavaScriptSerializer.serialize(this.tR)}`)}r9j(n){const {NetworkConnectionHealthChecker:A}=a(904),y={};for(const z of Object.keys(this.tR)){const F=this.tR[z];y[F.testName]=F.isSuccess}y.isOfflineMode=
n;this.Lpa.B4d(A.Cbd,Sys.Serialization.JavaScriptSerializer.serialize(y))}}Object(w.a)(u,"ConnectionHealthTestsRunner",null,[]);var x=a(142),t=a(13);a.d(B,"NetworkConnectionHealthChecker",function(){return m});class m{constructor(n){this.businessBar=this.Fcb=null;this.t5i=(A,y)=>{y.kgd?this.v5i(y):this.u5i(y)};this.Uj=(A,y)=>{A=y.context.methodName;this.Fcb&&A===this.Fcb&&(c.ULS.sendTraceTag(537155230,0,50,`NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "${this.Fcb}" has now succeeded. Querying local storage for BB showings.`),
this.fdb(m.pSb,!0),this.Fcb=null);this.hCf(!1);this.Kac=!1};this.ip=(A,y)=>{f.a.Jj(y.errors,[-1387426400])&&!this.Kac&&(this.Kac=!0,this.pig()&&window.performance.mark(m.zJf),(new u(this)).SPi())};this.ei=()=>{this.hCf(!0);this.fdb(m.mLb,!1);this.fdb(m.pSb,!1)};this.SCa=()=>{this.fdb(m.mLb,!0)};this.$=n;this.qa=this.$.qa;this.localStorage=new k.a;this.Kac=!1;this.$.ea.el(this.ei);this.qa.xh.ptb(this.SCa);this.qa.gu(this.Uj);void x.a.Pu(t.p).then(A=>{const y=this;return Ko(function*(){y.businessBar=
A;A.XYg(y.t5i)})});this.qa.wA(this.ip)}dispose(){this.$&&(this.$.ea&&this.$.ea.to(this.ei),this.qa&&(this.qa.xh.hQb(this.SCa),this.qa.IB(this.ip),this.qa.Kv(this.Uj)))}v5i(n){const A={};A.Timestamp=Date.now().toString();switch(n.E4a){case 21:this.Fcb=n.data.FailedMethod;A.FailedMethod=this.Fcb;this.B4d(m.pSb,JSON.stringify(A));break;case 56:this.B4d(m.mLb,JSON.stringify(A))}}u5i(n){switch(n.E4a){case 21:this.fdb(m.pSb,!0);break;case 56:this.fdb(m.mLb,!0)}}B4d(n,A){try{this.localStorage.li()&&this.localStorage.setItem(n,
A)}catch(y){c.ULS.sendTraceTag(537155231,0,15,`NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: ${y.message||"Unknown"}`)}}Xrd(n){if(this.localStorage.li()&&(n=this.localStorage.cPa(n))&&"null"!==n){var A=JSON.parse(n);n=parseInt(A.Timestamp,10);A=Sys.Serialization.JavaScriptSerializer.serialize(A);return{returnValue:n,rawData:A}}return{returnValue:-1,rawData:null}}hCf(n){if(this.localStorage.li()){const A=this.localStorage.cPa(m.Cbd);if(A&&"null"!==
A){let y=-1;this.Kac&&(y=this.p7h(m.zJf,m.$3i));c.ULS.sendTraceTag(537155229,0,50,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: ${Sys.Serialization.JavaScriptSerializer.serialize(A)}, Period offline: ${y}, New session: ${n}`);this.localStorage.removeItem(m.Cbd)}}}p7h(n,A){if(!this.pig())return-1;window.performance.measure(A,n);n=window.performance.getEntriesByName(A);return n.length&&n[n.length-1]?n[n.length-1].duration:(c.ULS.sendTraceTag(537155228,0,10,`NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name ${A} returned no measures.`),
-1)}fdb(n,A){try{let y;const z=(()=>{let F=this.Xrd(n);({rawData:y}=F);return F})().returnValue;if(-1!==z){const F=Object(b.a)(new l,{timeElapsed:Date.now()-z,scenario:n,isNewSession:!A,rawData:y});c.ULS.sendTraceTag(537155227,0,50,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: ${JSON.stringify(F)}`)}this.localStorage.removeItem(n)}catch(y){c.ULS.sendTraceTag(537155226,0,15,`NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: ${y.message||
"Unknown"}`)}}pig(){return e.HelperMethods.i8c&&h.a.gvb}}m.mLb="NetworkDownBBShown";m.pSb="ServerCommunicationFailureBBShown";m.Cbd="ConnectionHealthPingRsults";m.zJf="offMoStMa";m.$3i="offMoDuMea";Object(w.a)(m,"NetworkConnectionHealthChecker",null,[5])},962:function(w,B,a){a.d(B,"a",function(){return e});w=a(0);var b=a(16),c=a(5),h=a(39),f=a(30);class e{static u9e(k,l){switch(k){case 3:return e.sli(l);case 2:return e.xdi(l);case 1:return e.a8h(l)}return""}static sli(k){switch(k){case 1:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static xdi(k){switch(k){case 1:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static a8h(k){switch(k){case 1:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return c.AFrameworkApplication.da.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static jNd(k,
l,r){if(f.a.Dj||f.a.jq)window.setTimeout(()=>{e.S2f(r,e.Nhf())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(e.qDe(r),k,0,!1)}static rih(k,l,r,v){l&&v&&v();e.jNd(k,l,r)}static Nhf(){return f.a.Dj?1:f.a.jq?2:f.a.WRa?3:f.a.isMac?4:0}static get $Gb(){return"zh-CN"===window.navigator.language}static S2f(k,l){1===l?(b.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),k=e.u9e(k,l),8<f.a.LEb?h.a.rh(k,void 0,void 0,"RedirectToAppStore"):h.a.m2(k)):document.hidden||(e.$Gb?
(k=c.AFrameworkApplication.da.appSettings.WildFireUrlChinaStoreAndroid.toString())?(b.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),h.a.m2(k)):b.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(b.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(e.u9e(k,l),null,null)))}static qDe(k){switch(k){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get X1d(){return(f.a.WRa||
f.a.isMac)&&f.a.kq}static J9e(k){switch(k){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static THi(k){return(k=e.kai(k))&&""!==k?Boolean.parse(k):!1}static Y_d(k){e.lUj(k)}static kai(k){try{return localStorage.getItem(k)}catch(l){return b.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+l.message),null}}static lUj(k){try{localStorage.setItem(k,"true")}catch(l){b.ULS.sendTraceTag(18416669,
306,50,"WildFire LocalStorage SetItem Failed with exception : "+l.message)}}}e.chh="ChromeExtensionBarDismiss";Object(w.a)(e,"WildFireUtilities",null,[])},995:function(w,B,a){a.r(B);w=a(0);var b=a(16),c=a(224),h;(function(t){t[t.paren=0]="paren";t[t.lead=1]="lead";t[t.intern=2]="intern";t[t.trail=3]="trail";t[t.undefined=4]="undefined"})(h||(h={}));Object(w.b)("CurrencyFormatOption",h);var f;(function(t){t[t.none=-1]="none";t[t.mdy=0]="mdy";t[t.dmy=1]="dmy";t[t.ymd=2]="ymd";t[t.myd=3]="myd";t[t.dym=
4]="dym";t[t.ydm=5]="ydm"})(f||(f={}));Object(w.b)("DateOrderOption",f);class e{constructor(t,m){({CalcHelper:t}=a(995));m&&(m.Hh||b.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.PMg=t.wRe(m,t.fRe(m.mna));this.QMg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.QMg}get localeData(){return this.PMg}}Object(w.a)(e,"LocaleHolder",null,[]);var k=a(1132),l=a(54),r=a(1),v=a(22),u=a(122);a.d(B,"CalcHelper",function(){return x});
class x{constructor(t){this.$=t;(this.Jx=this.$.ia.Ja(268))||b.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let m;m=r.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?l.a.current.Jq(75):l.a.current.Jq(78);this.logger=new k.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.DSi=new e(t,this.Jx);excelOnlineCalc.config.initCalc(this.logger,
this.Jx?n=>this.Jx.isFeatureEnabled(n):()=>!1,m);this.au=excelOnlineCalc.config.calcConfig(this.DSi.localeInfo)}get config(){return this.au}pwh(){if(r.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.ta)return b.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const t=this.$.ta.pa;return t?t.index:(b.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.ta.pa.index}createParser(){const t=
{};t.config=this.config;return excelOnlineCalc.parse.createParser(t)}createNumberFormatter(){const t=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(m,n)=>excelOnlineCalc.calc.getTime(this.config,m,n,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(t)}Euh(t,m,n,A){if(!A)return{range:{row:m,col:n},sheet:{document:this.documentLoc,index:t}};m=excelOnlineCalc.location.gridCell(m,n);t=excelOnlineCalc.location.sheetIndex(this.documentLoc,t);return excelOnlineCalc.location.sheetGridCell(t,
m)}static wRe(t,m){m=void 0===m?null:m;const n=t.Tqh(),A=t.Hh.TrueValueString,y=t.Hh.FalseValueString,z=t.Hh.DecimalSeparator.toString(),F=t.Hh.ListSeparator.toString(),D=t.Hh.ColumnSeparator.toString(),I=t.Hh.RowSeparator.toString(),H=t.Hh.ThousandsDataArray,N=t.Hh.ThousandSeparator.toString(),U=t.Hh.Lcid,L=t.Hh.Country,J=t.Hh.DigitsNumber,P=t.Hh.ExpSeparatedBySpace,K=t.Hh.FractionSeparator.toString(),ca=t.Hh.PercentSeparatedBySpace,T=v.a.Neh(Enum.toString(h,t.Hh.CurrencyFormat)),Q=t.Hh.CurrencySymbolLead,
fa=t.Hh.CurrencySeparatedBySpace,ha=t.Hh.CurrencySymbolString,Ea=t.Hh.DigitsCurrency,ra=-1===t.Hh.DateOrder?"MDY":u.e(Enum.toString(f,t.Hh.DateOrder)),Z=t.Hh.DateSeparator.toString(),wa=t.Hh.DateAlternativeSeparator.toString(),la=t.Hh.Year4Digits,ta=t.Hh.Month2Digits,Ca=t.Hh.Day2Digits,Ga=t.Hh.LongDateFormat,Oa=t.Hh.TimeSeparator.toString(),eb=t.Hh.TimeAltSeparator,nb=t.Hh.Hour2Digits,$a=t.Hh.Use24HourClock,oa=t.Hh.AmPmSeparatedBySpace,Fa=[t.Hh.AmString,t.Hh.PmString],X=t.Hh.DayNameShortArray,va=
t.Hh.DayNameLongArray,xa=t.Hh.MonthNameShortArray,Pa=t.Hh.MonthNameLongArray,Ka=t.Hh.PictureSpecialArray,Bb=c.a.map(("\x00"+t.Hh.PictureSingleString).split(""),cb=>"\x00"===cb?null:cb),xb=t.Hh.PictureColorArray,Ua=t.Hh.PictureDbnumArray,Jb=t.Hh.RowLetter.toString(),fc=t.Hh.ColumnLetter.toString(),ya=t.Hh.LeftBrace.toString(),ob=t.Hh.RightBrace.toString(),Sb=t.Hh.LeftBracket.toString(),Ba=t.Hh.RightBracket.toString(),Ia=x.cii(t.Hh);return excelOnlineCalc.calc.localeData(m,n,A,y,Jb,fc,ya,ob,Sb,Ba,z,
F,D,I,H,N,U,L,J,P,K,ca,T,Q,fa,ha,Ea,ra,Z,wa,la,ta,Ca,Ga,Oa,eb,nb,$a,oa,Fa,X,va,xa,Pa,Ka,Bb,xb,Ua,Ia,t.Hh.SysDateFormatString,t.Hh.SysTimeFormatString)}static fRe(t){const m=[];if(!t)return m;for(const n of t)t=null,n.IsDynamicUdf||(t=excelOnlineCalc.calc.worksheetFunctionName(n.FunctionIndexInServer,n.NameUI)),t&&m.push(t);return m}static cii(t){const m=Array(6);m[1]="#"+t.AllStructRefString;m[3]="#"+t.HeadersStructRefString;m[2]="#"+t.DataStructRefString;m[4]="#"+t.TotalsStructRefString;m[5]="#"+
t.ThisRowStructRefString;return m}}Object(w.a)(x,"CalcHelper",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pi.js.map/0fabd94851e4b1f28af62613b37a1d83/EwaTS.pi.js.map