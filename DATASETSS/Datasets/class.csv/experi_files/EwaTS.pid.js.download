'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[34],{1336:function(w,B,a){a.r(B);var b={};a.r(b);a.d(b,"LineageDiscoverabilityCallout",function(){return ta});var c={};a.r(c);a.d(c,"ShowCalloutCommandHandler",function(){return qd});var h={};a.r(h);a.d(h,"OptimizeWorkbookManager",function(){return yc});var f={};a.r(f);a.d(f,"TableIntelligenceDarkActivationManager",function(){return ge});var e={};a.r(e);a.d(e,"EwaNotificationFocusManager",function(){return Ve});
var k=a(1),l=a(0),r=a(233),v=a(734),u=a(2),x=a(16),t=a(1252),m=a(911),n=a(912),A=a(180),y=a(190);class z{constructor(bd){this.$N=null;this.$=bd}show(){const bd=this.mza();x.ULS.shipAssertTag(537169938,0,!!bd,"EwaReactCallout.Show: Cannot retrieve the Callout Parameters");y.UISurfaces.KK().then(be=>{const jb=be.callout(bd);this.$N=be.addNotification(jb)},be=>{x.ULS.sendTraceTag(537169936,0,15,`EwaReactCallout.Show: Failed to GetNotificationsAPIAsync: ${be}`);return null})}dismiss(){this.$N&&y.UISurfaces.KK().then(bd=>
{bd.removeNotification(this.$N);return this.$N=null})}YYa(bd){y.UISurfaces.KK().then(be=>{be.updateNotification(this.$N,be.callout(Object.assign(new m.a,bd)))},be=>{x.ULS.sendTraceTag(522782336,0,15,`EwaReactCallout.Update: Failed to GetNotificationsAPIAsync: ${be}`);return null})}}Object(l.a)(z,"EwaReactCallout",null,[234]);class F{static LHb(bd){return!!(bd&1)}static UAd(bd){return!!(bd&2)}static Kok(bd){return!!(bd&F.cvi)}}F.cvi=6;Object(l.a)(F,"EwaReactCalloutModeUtil",null,[]);class D{constructor(){this.D1=
0;this.OIb=null;this.CIc=!0}}Object(l.a)(D,"EwaReactShowOrDismissCalloutMetadata",null,[]);var I=a(60),H=a(40),N=a(123),U=a(867),L=a(142),J=a(13);class P{constructor(bd,be,jb){this.indexedDB=null;this.$=bd;this.HP=be;this.DLa=jb}DAf(){const bd=new A.a;let be=new D;H.TaskExtensions.Aa(this.NZe(),jb=>{jb.result?H.TaskExtensions.Aa(this.indexedDB.q9a(this.HP),lc=>{if(lc=lc.result){lc=I.a.kl(lc);if(!lc){this.F4e(bd);return}if(F.LHb(this.DLa)){const Zc=lc.NumberOfDisplays;be.D1=Zc?Number.parseLocale(Zc):
0}F.UAd(this.DLa)&&(lc=lc.LastDisplay,be.OIb=lc?new Date(Number.parseLocale(lc)):null)}bd.setResult(be)},this.$.ma):this.F4e(bd)},this.$.ma,3);return bd.task}Tag(bd){const be=new A.a;H.TaskExtensions.Aa(this.NZe(),jb=>{jb.result||be.setResult(!1);jb={};F.LHb(this.DLa)&&(jb.NumberOfDisplays=bd.D1.toString());F.UAd(this.DLa)&&(jb.LastDisplay=N.toTimestamp(bd.OIb).m.toString());jb=I.a.ff(jb);H.TaskExtensions.Aa(this.indexedDB.lib(new U.a(this.HP,jb)),lc=>{be.setResult(lc.result)},this.$.ma,3)},this.$.ma,
3)}NZe(){const bd=new A.a;this.indexedDB?bd.setResult(!0):void L.a.resolve(J.Ob,{Oa:1}).then(be=>{be.li()?(be.initialize("Callouts","EwaCallouts"),this.indexedDB=be,bd.setResult(!0)):(x.ULS.sendTraceTag(573609248,0,50,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver.EnsureIndexedDB: IndexedDb is not supported."),bd.setResult(!1))});return bd.task}F4e(bd){const be=new D;be.CIc=!1;bd.setResult(be)}}Object(l.a)(P,"EwaReactShowOrDismissCalloutIndexedDBLoaderSaver",null,[255]);class K{constructor(bd,
be,jb,lc,Zc,dd){this.M9b=be;this.O9b=jb;this.DLa=lc;this.HP=Zc;this.localStorage=dd;this.$=bd}DAf(){const bd=new A.a,be=new D;if(F.LHb(this.DLa)){let jb=0;be.CIc=(()=>{let lc=this.wgk();({mga:jb}=lc);return lc})().returnValue&&be.CIc;be.D1=jb}bd.setResult(be);return bd.task}Tag(bd){const be=new A.a;var jb=!0;if(F.LHb(this.DLa)){const lc=this.b$e();lc&&(jb=Number.parseLocale(lc),jb=this.fhk((jb&~this.O9b|bd.D1<<this.M9b).toString()))}be.setResult(jb)}wgk(){var bd;return(bd=this.b$e())?(bd=(Number.parseLocale(bd)&
this.O9b)>>this.M9b,x.ULS.sendTraceTag(537169932,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver - Callout ${this.HP} already appeared. Found the callout in storage.`),{returnValue:!0,mga:bd}):{returnValue:!1,mga:0}}fhk(bd){try{if(!this.localStorage.li())return!1;try{return this.localStorage.setItem("CalloutIds",bd),!0}catch(be){x.ULS.sendTraceTag(537169931,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Failed to set item to cache. reason: ${be.message||
"Unknown"}`)}}catch(be){x.ULS.sendTraceTag(537169930,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.TrySaveCalloutIdsToCache: Got Exception when trying to save calloutIds to cache. e.Message: ${be.message}`)}return!1}b$e(){try{if(!this.localStorage.li())return x.ULS.sendTraceTag(537169929,0,50,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Local storage is not supported and display count (if any) won't be saved for ${this.HP}.`),null;const bd=this.localStorage.getItem("CalloutIds");
return bd?bd:(x.ULS.sendTraceTag(537169928,0,15,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: item doesn't exist in local storage"),"0")}catch(bd){return x.ULS.sendTraceTag(537169927,0,15,`EwaReactShowOrDismissCalloutLocalStorageLoaderSaver.GetCalloutIdsFromCache: Got Exception when trying to get calloutIds. e.Message: ${bd.message}`),null}}}Object(l.a)(K,"EwaReactShowOrDismissCalloutLocalStorageLoaderSaver",null,[255]);var ca=a(76),T=a(145),Q=a(196),fa=a(146),ha=a(586);
class Ea extends z{constructor(bd,be,jb,lc,Zc,dd,Qd,ue,qa,Xa,wb,Rb,vc,Nc,id,Id,me,Wb){Xa=void 0===Xa?!1:Xa;wb=void 0===wb?!1:wb;Rb=void 0===Rb?!1:Rb;vc=void 0===vc?!1:vc;Nc=void 0===Nc?!1:Nc;id=void 0===id?!0:id;Id=void 0===Id?!1:Id;me=void 0===me?null:me;Wb=void 0===Wb?!1:Wb;super(bd);this.D1=0;this.i2d=this.KMc=this.Gyg=!1;this.gMd=()=>{this.Dnc()};this.GGg=be;this.c2j=jb;this.wBh=lc;this.ow=Zc;this.mw=dd;this.localStorage=qa;this.FGg=Qd;this.EGg=ue;this.eRi=Xa;this.zud=wb;this.zBh=Rb;this.setInitialFocus=
vc;this.useCoachmark=Nc;this.SDc=!1;this.eUj=id;this.nGf=this.Abi();this.CLa=me;this.i2d=Wb;this.hasDynamicSizing=Id}get Htb(){return{}}set SAg(bd){this.ow=bd}lbe(){}OOa(){return 1}dod(){return 0}get mga(){return 1}get jZf(){return!0}get HP(){return this.GGg}get O9b(){return this.FGg}get M9b(){return this.EGg}show(){H.TaskExtensions.Aa(this.UEa(),bd=>{bd.result&&this.w2j()},this.$.ma)}zBf(){fa.b(this.$).Lf(T.a.S0e,this.xhf("dismiss"),void 0,!0)}wCf(){fa.b(this.$).Lf(T.a.S0e,this.xhf("show"),void 0,
!0)}mza(){const bd=Object(u.a)(new t.a,{label:this.wBh,onExecute:()=>{this.lbe();this.zBf();this.KMc=!0;this.Dnc()}});let be=null;this.zud||(be=Object(u.a)(new t.a,{label:this.c2j,onExecute:()=>{this.KMc=!0;this.wCf();const jb=Q.c({["InputMethod"]:ca.a.Td},this.Htb);this.$.Ga.Sd(this.ribbonCommandInfo,jb);this.Dnc()}}));return Object(u.a)(new m.a,{target:this.qDb(),content:this.mw,title:this.ow,primaryButtonProps:this.zud?bd:be,secondaryButtonProps:this.zud?null:bd,showCloseIcon:this.i2d,preventLightDismiss:!this.eRi,
hasDynamicSizing:this.hasDynamicSizing,calloutProps:Object(u.a)(new n.a,{onDismiss:()=>{this.Dnc()},directionalHint:this.CLa,preventDismissOnScroll:!0,preventDismissOnResize:!this.zBh,isBeakVisible:this.eUj,setInitialFocus:this.setInitialFocus}),useTeachingStyles:!0,hasFocusableControls:!0,useCoachmark:this.useCoachmark})}Dnc(){this.Gyg=!0;if(k.EwaSettings.ZAa()){var bd=L.a.rg(J.Ec);bd&&bd.w6f(this.gMd)}else(bd=this.$.ia.Ja(418))&&bd.w6f(this.gMd);(this.jZf&&this.KMc||this.i2d)&&this.ysg(!0);this.KMc||
x.ULS.sendTraceTag(537169935,0,50,`EwaReactShowOrDismissCallout - Callout ${this.HP} was dismissed without user interaction`);this.dismiss()}UEa(){const bd=new A.a;this.yoa()?H.TaskExtensions.Aa(this.nGf.DAf(),be=>{var jb=this.OOa();be=be.result;if(be.CIc)if(this.D1=be.D1,F.LHb(jb)&&(this.SDc||be.D1>=this.mga))x.ULS.sendTraceTag(573609250,0,50,`EwaReactShowOrDismissCallout - Callout ${this.HP} already appeared. Found the callout in storage.`),this.SDc=!0,bd.setResult(!1);else{if(F.UAd(jb)&&be.OIb&&
(jb=N.getElapsedSeconds(be.OIb,new Date),(be=this.dod())||x.ULS.shipAssertTag(537169933,0,!1,`GetCooldownPeriodInSeconds returned 0 callout ${this.HP} with mode RestrictedBycooldown`),jb<be)){bd.setResult(!1);return}jb=!this.$N&&!!this.qDb()&&!ha.a(this.$);bd.setResult(jb)}else bd.setResult(!1),x.ULS.sendTraceTag(537169934,0,50,`EwaReactShowOrDismissCallout.ShouldShowCallout: Failed to retrieve metadata for callout ${this.HP}.`)},this.$.ma):bd.setResult(!1);return bd.task}yoa(){return!0}qDb(){if(document.querySelector(this.kV))return this.kV;
if(document.querySelector(this.jV))return this.jV;if(document.querySelector(this.NU))return this.NU;x.ULS.shipAssertTag(592528907,0,!1,`EwaReactShowOrDismissCallout.GetTargetObject: Cannot retrieve the Callout Target Object, Callout: ${this.HP}`);return null}ysg(bd){bd=void 0===bd?!1:bd;this.SDc=!0;this.OOa();const be=new D;be.D1=bd?this.mga:this.D1+1;be.OIb=new Date;this.nGf.Tag(be)}w2j(){this.SDc=!0;this.ysg();x.ULS.sendTraceTag(593494082,0,50,`EwaReactShowOrDismissCallout - Showing ${this.HP} callout, current number of displayes: ${this.D1}`);
this.$.ia.Od(418,bd=>{this.Gyg||bd.B0g(this.gMd)});super.show()}Abi(){const bd=this.OOa();return F.Kok(bd)?new P(this.$,this.HP,bd):new K(this.$,this.M9b,this.O9b,bd,this.HP,this.localStorage)}xhf(bd){return{["selection"]:bd,["callout"]:this.HP,["Location"]:"floatie",["displayCount"]:this.D1}}}Object(l.a)(Ea,"EwaReactShowOrDismissCallout",z,[]);var ra=a(91),Z=a(278),wa=a(12),la;let ta=la=class extends Ea{constructor(bd){super(bd,la.jRi,wa.a.instance.za(650),wa.a.instance.za(652),wa.a.instance.za(648),
wa.a.instance.za(649),3072,10,new Z.a)}F0j(){return this.UEa()}get kV(){return"[data-unique-id=Review]"}get jV(){return"[data-unique-id=pivotOverflowButton]"}get NU(){return'[id="'+this.$.He+'Ribbon.Review-title"]'}get jZf(){return!1}get ribbonCommandInfo(){return new ra.a(1834994092,ca.a.Td,this.$.Ie,9,null)}get mga(){return k.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.LineageDiscoverabilityCalloutDisplayLimit",3)}OOa(){return 3}dod(){return 86400}yoa(){return this.$.ea.Vcb}};ta.jRi="LineageDiscoverabilityCallout";
ta=la=Object(v.a)([Object(L.d)(J.Wb),Object(v.b)(0,Object(J.fb)())],ta);Object(l.a)(ta,"LineageDiscoverabilityCallout",Ea,[235]);class Ca extends r.a{constructor(bd){super();this.$=bd;this.Oe()}create(){const bd=new ta(this.$);this.ve(this.$.ia.Ja(456)||this.$.ia.Va(456,bd))}static la(bd){bd.ia.Va(457,new Ca(bd))}}Object(l.a)(Ca,"LineageDiscoverabilityCalloutFactory",r.a,[]);var Ga=a(737),Oa=a(8);const eb='[id="'+Oa.a.Jmg+'"]';class nb extends Ea{constructor(bd,be,jb,lc,Zc,dd,Qd,ue,qa,Xa){super(bd,
be,null,jb,lc,Zc,dd,Qd,new Z.a,ue,!0,!0,qa,!1,!1,void 0,Xa)}get kV(){return eb}get jV(){return eb}get NU(){return eb}get ribbonCommandInfo(){return new ra.a(-847286761,ca.a.Td,this.$.Ie,0,null)}yoa(){return!(this.$.isMobileMode||this.$.ea.Je.inEmbedView||this.$.ea.Je.inWebPart)}}Object(l.a)(nb,"ZoomTeachingCallout",Ea,[]);class $a extends nb{constructor(bd){super(bd,"AdjustZoomTeachingCallout",wa.a.instance.za(694),null,wa.a.instance.za(693),2,1,!1,!0,2)}}Object(l.a)($a,"AdjustZoomTeachingCallout",
nb,[]);class oa extends Ea{constructor(bd){super(bd,"ConditionalFormattingManageRulesTeachingCallout",wa.a.instance.za(643),wa.a.instance.za(644),wa.a.instance.za(641),wa.a.instance.za(642),2,1,new Z.a)}get kV(){return"[data-unique-id=Ribbon-ConditionalFormatting]"}get jV(){return'[data-unique-id="RibbonOverflowMenu"]'}get NU(){return'[id="m_excelWebRenderer_ewaCtl_Styles.CondFmt-Large"]'}get ribbonCommandInfo(){return new ra.a(-20558303,ca.a.Td,this.$.Ie,0,null)}}Object(l.a)(oa,"ConditionalFormattingManageRulesTeachingCallout",
Ea,[]);var Fa;(function(bd){bd[bd.overrideBrowserShortcuts=0]="overrideBrowserShortcuts";bd[bd.conditionalFormattingManageRules=1]="conditionalFormattingManageRules";bd[bd.linkedEntityBlankCellConvert=2]="linkedEntityBlankCellConvert";bd[bd.linkedEntityNoCuratedData=3]="linkedEntityNoCuratedData";bd[bd.lineageDiscoverability=4]="lineageDiscoverability";bd[bd.lineageTeachingCallout=5]="lineageTeachingCallout";bd[bd.linkedEntityFirstOrganizationData=6]="linkedEntityFirstOrganizationData";bd[bd.adjustZoomTeachingCallout=
7]="adjustZoomTeachingCallout";bd[bd.linkedEntityGallery=8]="linkedEntityGallery";bd[bd.fixedFreezePane=9]="fixedFreezePane";bd[bd.phoneticTeachingCallout=10]="phoneticTeachingCallout";bd[bd.powerQueryCallout=11]="powerQueryCallout";bd[bd.tableAIConvertToTableCallout=12]="tableAIConvertToTableCallout";bd[bd.optimizeWorkbookBusinessBarCallout=13]="optimizeWorkbookBusinessBarCallout";bd[bd.tableInNewWorkbook=14]="tableInNewWorkbook";bd[bd.formulaByExampleCurtainLifterCallout=15]="formulaByExampleCurtainLifterCallout";
bd[bd.dataCleansing=16]="dataCleansing";bd[bd.optimizeWorkbookSlowOperationsCallout=18]="optimizeWorkbookSlowOperationsCallout";bd[bd.excelBetterEntryTeachingCallout=19]="excelBetterEntryTeachingCallout";bd[bd.excelLiveWebEntryPointCallout=20]="excelLiveWebEntryPointCallout";bd[bd.functionDialog=21]="functionDialog";bd[bd.length=22]="length"})(Fa||(Fa={}));Object(l.b)("EwaCalloutName",Fa);var X=a(38);class va extends nb{constructor(bd){super(bd,"FixedFreezePaneTeachingCallout",wa.a.instance.za(647),
wa.a.instance.za(645),wa.a.instance.za(646),65536,16,!0,!1,8)}OOa(){return 0}}Object(l.a)(va,"FixedFreezePaneTeachingCallout",nb,[]);class xa extends Ea{constructor(bd){super(bd,xa.nRi,"",wa.a.instance.za(651),wa.a.instance.za(653),wa.a.instance.za(654),4096,12,new Z.a,void 0,!0);this.CLa=9}get kV(){return xa.nEd}get jV(){return xa.nEd}get NU(){return xa.nEd}get ribbonCommandInfo(){return null}}xa.nRi="LineageTeachingCallout";xa.nEd="#LineagePaneFilterButton";Object(l.a)(xa,"LineageTeachingCallout",
Ea,[]);var Pa=a(102),Ka=a(6),Bb=a(54),xb=a(22),Ua=a(983);class Jb extends Ua.a{constructor(bd){super("TextAboveImage");this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=bd.paragraphs;this.image=bd.image;this.imageWidth=bd.imageWidth;this.imageHeight=bd.imageHeight}}Object(l.a)(Jb,"TextAboveImage",Ua.a,[]);class fc{constructor(bd,be){this.imageHeight=this.imageWidth=this.image=this.paragraphs=null;this.paragraphs=bd;this.image=be}}Object(l.a)(fc,"TextAboveImageCustomProps",
null,[]);var ya=a(892);class ob extends z{constructor(bd){super(bd);this.kdg=0;this.FXa=this.target=null;this.SLc=!1;this.mw=this.ow=null;this.N7c=0}lG(bd,be,jb,lc,Zc,dd){if(!this.Mq()){switch(lc){case "DataTypes_PBI":this.N7c=1;break;default:this.N7c=0}this.target=bd;this.ow=String.format(wa.a.instance.za(676),be);this.mw=String.format(wa.a.instance.za(677),jb);this.kdg=dd;this.iRj(lc,Zc)}}iRj(bd,be){const jb=!!this.$.xa&&xb.a.equals(this.$.xa.UICultureTag,"en-us",!0);this.SLc=be&&jb;be&&!jb?this.FXa=
"BlankCell":bd?this.FXa=bd:(x.ULS.sendTraceTag(537169926,0,15,"LinkedEntityBlankCellConvertTeachingCallout.SetActionButtonAndSidePaneId: Callout BlankCellResourceId was null"),this.FXa="BlankCell")}show(){x.ULS.shipAssertTag(537169925,0,!!this.target&&!!this.mw&&!!this.ow,"LinkedEntityBlankCellConvertTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Mq()||(x.ULS.sendTraceTag(537169924,0,50,"LinkedEntityBlankCellConvertTeachingCallout.Show() - Showing LinkedEntityBlankCellConvertTeachingCallout callout."),
super.show())}Mq(){return!!this.$N}mza(){const bd=Object(u.a)(new t.a,{label:wa.a.instance.za(682),ariaDescription:wa.a.instance.za(683),onExecute:()=>{x.ULS.sendTraceTag(537169923,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "Got it" button');this.dismiss()}}),be=Object(u.a)(new t.a,{label:this.SLc?wa.a.instance.za(680):wa.a.instance.za(678),ariaDescription:this.SLc?wa.a.instance.za(681):wa.a.instance.za(679),onExecute:()=>{x.ULS.sendTraceTag(537169922,0,50,'LinkedEntityBlankCellConvertTeachingCallout - clicked "'+
(this.SLc?"Try sample data":"Learn more")+'" button');var dd=new Map;dd.set("Domain",this.kdg.toString());Pa.Health.instance.recordKpiUsage("LinkedEntityBlankCellCalloutActionUsed",0,"ropari",dd);dd=new ra.a(-859308420,ca.a.Td,this.$.Ie,9,null);this.$.Ga.Sd(dd,{[ca.a.di]:"HelpID="+this.FXa,["InputMethod"]:ca.a.Td,["ShouldCanvasTakeFocus"]:!0,[ca.a.qf]:Ka.a.AN});this.dismiss()}});var jb=!!this.$&&!!this.$.frame&&!!this.$.frame.xC&&this.$.frame.xC.FN;switch(this.N7c){case 1:var lc=jb?126:123;break;
default:lc=jb?125:120}lc=Object(u.a)(new ya.a(Bb.a.current.Jq(lc)),{alt:wa.a.instance.Qd(184)});const Zc=this.mw.split("\n\n");jb=Object(u.a)(new fc(Zc,lc),{imageWidth:280,imageHeight:jb?142:192});jb=new Jb(jb);return Object(u.a)(new m.a,{target:this.target,content:jb,title:this.ow,primaryButtonProps:be,secondaryButtonProps:bd,showCloseIcon:!0,calloutProps:Object(u.a)(new n.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,
isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(l.a)(ob,"LinkedEntityBlankCellConvertTeachingCallout",z,[]);class Sb extends Ea{constructor(bd){super(bd,"LinkedEntityFirstOrganizationDataCallout",wa.a.instance.za(672),wa.a.instance.za(674),wa.a.instance.za(670),wa.a.instance.za(671),8192,13,new Z.a,void 0,void 0,!0,!0);this.target=null;this.FXa="DataTypes_PBI"}get kV(){return this.target.toString()}get jV(){return this.target.toString()}get NU(){return'[id="'+this.$.He+'Ribbon.Data.LinkedEntity"]'}get ribbonCommandInfo(){return new ra.a(-859308420,
ca.a.Td,this.$.Ie,9,null)}get Htb(){return{[ca.a.di]:"HelpID="+this.FXa,["ShouldCanvasTakeFocus"]:!0,[ca.a.qf]:Ka.a.AN}}lG(bd){this.Mq()||(this.target=bd,this.FXa="DataTypes_PBI")}Mq(){return!!this.$N}yoa(){x.ULS.shipAssertTag(537169921,0,!!this.target,"LinkedEntityFirstOrganizationDataTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");return!this.Mq()}}Object(l.a)(Sb,"LinkedEntityFirstOrganizationDataTeachingCallout",
Ea,[]);class Ba extends Ea{constructor(bd){super(bd,"LinkedEntityGalleryTeachingCallout","",wa.a.instance.za(682),wa.a.instance.za(684),wa.a.instance.za(685),49152,14,new Z.a,void 0,!0,!0,!0,!0);this.target=null;this.CLa=5}get mga(){return 2}get kV(){return this.target.toString()}get jV(){this.CLa=7;return"[data-unique-id=Ribbon-ConvertToLinkedEntityGallery]"}get NU(){return""}get ribbonCommandInfo(){return new ra.a(-847286761,ca.a.Td,this.$.Ie,0,Ka.a.bPb)}show(){x.ULS.shipAssertTag(537169920,0,!!this.target,
"LinkedEntityGalleryTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");this.Mq()||(x.ULS.sendTraceTag(558690322,0,50,"LinkedEntityGalleryTeachingCallout.Show() - LinkedEntityGalleryTeachingCallout Coachmark was shown."),super.show())}lG(bd){this.Mq()||(this.target=bd)}Mq(){return!!this.$N}yoa(){x.ULS.shipAssertTag(537168099,0,!!this.target,"LinkedEntityGalleryTeachingCallout.InternalShouldShowCallout(): Cannot retrieve the callout target. InitializeCalloutProperties should be called before InternalShouldShowCallout");
return!this.Mq()}}Object(l.a)(Ba,"LinkedEntityGalleryTeachingCallout",Ea,[]);var Ia=a(11);class cb extends z{constructor(bd){super(bd);this.mw=this.ow=this.target=null}lG(bd,be,jb){this.Mq()||(this.target=bd,this.ow=String.format(wa.a.instance.Qd(186),be),this.mw=String.format(wa.a.instance.Qd(188),jb))}show(){x.ULS.shipAssertTag(537168098,0,!!this.target&&!!this.mw&&!!this.ow,"LinkedEntityNoCuratedDataTeachingCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Mq()||(x.ULS.sendTraceTag(537168097,0,50,"LinkedEntityNoCuratedDataTeachingCallout.Show() - Showing LinkedEntityNoCuratedDataTeachingCallout callout."),super.show())}Mq(){return!!this.$N}mza(){const bd=Object(u.a)(new t.a,{label:wa.a.instance.ha(1806),ariaDescription:wa.a.instance.ha(1807),onExecute:()=>{x.ULS.sendTraceTag(537168096,0,50,'LinkedEntityNoCuratedDataTeachingCallout - clicked "Learn how" button');Pa.Health.instance.recordKpiUsage("LinkedEntityNoCuratedDataCalloutActionUsed",0,"ropari",
null);Ia.HelperMethods.rh("https://go.microsoft.com/fwlink/?linkid=2134990",void 0,void 0,"NoCuratedDataCallout.NoCuratedDataFWLink");this.dismiss()}});var be=Object(u.a)(new ya.a(Bb.a.current.Jq(this.$&&this.$.frame&&this.$.frame.xC&&this.$.frame.xC.FN?127:124)),{alt:wa.a.instance.Qd(189)});be=Object(u.a)(new fc([this.mw],be),{imageWidth:280,imageHeight:142});be=new Jb(be);return Object(u.a)(new m.a,{target:this.target,content:be,title:this.ow,primaryButtonProps:bd,showCloseIcon:!0,calloutProps:Object(u.a)(new n.a,
{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!0})}}Object(l.a)(cb,"LinkedEntityNoCuratedDataTeachingCallout",z,[]);var Kb=a(178),db=a(355);class gb extends z{constructor(bd){super(bd);this.mw=this.ow=null}lG(bd){this.Mq()||(this.target=bd,this.LRj())}show(){x.ULS.shipAssertTag(526234880,0,!!this.target&&!!this.mw&&!!this.ow,"OptimizeWorkbookBusinessBarCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Mq()||(x.ULS.sendTraceTag(526234851,0,50,"OptimizeWorkbookBusinessBarCallout.Show() - Showing OptimizeWorkbookBusinessBarCallout callout."),Kb.a.sendTelemetryEvent(Object(u.a)(new db.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerBusinessBarCalloutShown"})),super.show())}Mq(){return!!this.$N}mza(){return Object(u.a)(new m.a,{target:this.target,title:this.ow,content:this.mw,showCloseIcon:!0,calloutProps:Object(u.a)(new n.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,
preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}LRj(){let bd=-1,be=0;const jb=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)?L.a.rg(J.pc):this.$.ia.Ja(465);jb&&(bd=jb.oqb,be=jb.Znb);switch(be){default:this.ow=wa.a.instance.za(722);this.mw=wa.a.instance.za(725);break;case 1:this.ow=String.format(wa.a.instance.za(723),bd);this.mw=wa.a.instance.za(726);break;case 2:this.ow=String.format(wa.a.instance.za(724),
bd),this.mw=wa.a.instance.za(726)}}}Object(l.a)(gb,"OptimizeWorkbookBusinessBarCallout",z,[]);var yb=a(144);class Nb extends Ea{constructor(bd,be,jb,lc,Zc,dd,Qd,ue,qa){ue=void 0===ue?!1:ue;super(bd,void 0===qa?"OverrideBrowserShortcutsTeachingCallout":qa,be,jb,lc,Zc,dd,Qd,new Z.a,ue)}get kV(){return"[data-unique-id=Help]"}get jV(){return"[data-unique-id=pivotOverflowButton]"}get NU(){return'[id="'+this.$.He+'Ribbon.Help-title"]'}get ribbonCommandInfo(){return new ra.a(-1018439626,ca.a.Td,this.$.Ie,
0,Ka.a.i4)}yoa(){return!yb.a.get(Ka.a.qTb)}}Object(l.a)(Nb,"OverrideBrowserShortcutsTeachingCallout",Ea,[]);class qc extends Nb{constructor(bd,be,jb,lc,Zc,dd,Qd,ue){super(bd,be,jb,lc,Zc,dd,Qd,void 0===ue?!1:ue,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault")}get ribbonCommandInfo(){return new ra.a(-901364793,ca.a.Td,this.$.Ie,0,Ka.a.i4)}get Htb(){return{[Ka.a.FNd]:!1}}}Object(l.a)(qc,"OverrideBrowserShortcutsTeachingCalloutOptInByDefault",Nb,[]);var Gb=a(39);class hb extends Ea{constructor(bd,
be,jb,lc,Zc,dd,Qd,ue,qa,Xa,wb,Rb,vc,Nc,id,Id,me,Wb,Ec){super(bd,be,jb,lc,Zc,dd,ue,qa,Xa,void 0===wb?!1:wb,void 0===Rb?!1:Rb,void 0===vc?!1:vc,void 0===Nc?!1:Nc,void 0===id?!1:id,void 0===Id?!0:Id,void 0===me?!1:me,void 0===Wb?null:Wb,void 0===Ec?!1:Ec);this.learnMoreUrl=null;this.learnMoreUrl=Qd}njj(){try{Gb.a.m2(this.learnMoreUrl)}catch(bd){}}lbe(){null!=this.learnMoreUrl&&this.njj()}}Object(l.a)(hb,"EwaReactShowOrLearnMoreCallout",Ea,[]);const qb='[id="'+Oa.a.Jmg+'"]';class ab extends hb{constructor(bd){super(bd,
"PhoneticTeachingCallout",wa.a.instance.za(695),wa.a.instance.za(698),wa.a.instance.za(697),wa.a.instance.za(696),"https://go.microsoft.com/fwlink/?linkid=2194045",131072,17,new Z.a,void 0,void 0,void 0,void 0,void 0,void 0,!0,3,!0)}get kV(){return qb}get jV(){return qb}get NU(){return qb}get ribbonCommandInfo(){return new ra.a(1455037301,ca.a.Td,this.$.Ie,0,null)}zBf(){x.ULS.sendTraceTag(545837391,1,50,"PhoneticTeachingCallout - click learn more")}wCf(){x.ULS.sendTraceTag(545837390,1,50,"PhoneticTeachingCallout - click show")}}
Object(l.a)(ab,"PhoneticTeachingCallout",hb,[]);var Mb=a(182);class Ib extends Ea{constructor(bd,be,jb,lc,Zc,dd){super(bd,be,wa.a.instance.za(708),wa.a.instance.za(707),wa.a.instance.za(703),jb,lc,Zc,new Z.a,!0,!1,void 0,void 0,void 0,!0,!0);this.CLa=5;this.Mvb=dd}get mga(){return 2}get kV(){return 1===Mb.a(this.$).vR?"[data-unique-id=Ribbon-Refresh]":"[data-unique-id=Ribbon-RefreshAll]"}get jV(){return"[data-unique-id=Connections_MLR"}yoa(){return this.Mvb}get NU(){return'[id="'+this.$.He+'Ribbon.Data.RefreshAll"]'}get ribbonCommandInfo(){return new ra.a(-859308420,
ca.a.Td,this.$.Ie,9,null)}get Htb(){return{[ca.a.di]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[ca.a.qf]:Ka.a.AN}}ETb(){return this.UEa()}show(){this.qDb()?super.show():x.ULS.sendTraceTag(509677597,0,10,"PowerQueryRefreshTeachingCalloutBase.Show: Target object is null.")}}Object(l.a)(Ib,"PowerQueryRefreshTeachingCalloutBase",Ea,[]);class fb extends Ib{constructor(bd){super(bd,"PowerQueryRefreshFromTableTeachingCallout",wa.a.instance.za(705),3145728,20,k.EwaSettings.isChangeGateEnabled("OfficeVSO:7111771_PowerQueryRefreshWeb"))}}
Object(l.a)(fb,"PowerQueryRefreshFromTableTeachingCallout",Ib,[]);class Db extends Ea{constructor(bd){super(bd,"QueriesTaskPaneTeachingCallout",wa.a.instance.za(702),wa.a.instance.za(701),wa.a.instance.za(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?849:699),wa.a.instance.za(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryConnectionsTaskPane",!1)?850:700),12582912,22,new Z.a,!0,void 0,void 0,void 0,void 0,!0,!0);this.CLa=5;this.Mvb=
k.EwaSettings.isChangeGateEnabled("OfficeVSO:7095227_PowerQueryTaskPaneGroupsOperations")}get mga(){return 2}get kV(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get jV(){return"[data-unique-id=Connections_MLR]"}get NU(){return'[id="'+this.$.He+'Ribbon.Data.Queries"]'}ETb(){return this.UEa()}show(){this.qDb()?super.show():x.ULS.sendTraceTag(537168092,0,10,"QueriesTaskPaneTeachingCallout.Show: Target object is null.")}yoa(){return this.Mvb}get ribbonCommandInfo(){return new ra.a(1156885807,
ca.a.Td,this.$.Ie,0,Ka.a.bPb)}}Object(l.a)(Db,"QueriesTaskPaneTeachingCallout",Ea,[]);var Za=a(431),sb=a(202),sa=a(587),ba=a(234),ua=a(249);class R extends Ib{constructor(bd){super(bd,"PowerQueryAuthenticatedRefreshTeachingCallout",wa.a.instance.za(706),805306368,28,k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1))}}Object(l.a)(R,"PowerQueryAuthenticatedRefreshTeachingCallout",Ib,[]);class Y extends Ea{constructor(bd){super(bd,"PowerQueryClearAllPermissionsTeachingCallout",
wa.a.instance.za(708),wa.a.instance.za(701),wa.a.instance.za(852),wa.a.instance.za(853),3,32,new Z.a,!0,!1,void 0,void 0,void 0,!0,!0);this.CLa=5;this.Mvb=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryClearAllCredentialTaskPane",!1)}get mga(){return 2}get kV(){return"[data-unique-id=Ribbon-OpenQueriesTaskPane]"}get jV(){return"[data-unique-id=Connections_MLR]"}get NU(){return'[id="'+this.$.He+'Ribbon.Data.Queries"]'}ETb(){return this.UEa()}show(){this.qDb()?super.show():x.ULS.sendTraceTag(508687132,
0,10,"PowerQueryClearAllPermissionsTeachingCallout.Show: Target object is null.")}yoa(){return this.Mvb}get ribbonCommandInfo(){return new ra.a(-859308420,ca.a.Td,this.$.Ie,9,null)}get Htb(){return{[ca.a.di]:"HelpID=PowerQuery_Refresh",["ShouldCanvasTakeFocus"]:!0,[ca.a.qf]:Ka.a.AN}}}Object(l.a)(Y,"PowerQueryClearAllPermissionsTeachingCallout",Ea,[]);var La=a(94);class Ma{constructor(bd){this.ukf=this.Ukf=!1;this.UEa=!0;this.kaj=be=>{if(be&&!ba.a(be))try{const jb=be.Result,lc=jb.QueryGroups;if(0<
jb.Queries.length||0<lc.length)this.Ukf=!0,this.ukf=jb.PowerQueryDataSources?jb.PowerQueryDataSources.includes("Excel.CurrentWorkbook")||jb.PowerQueryDataSources.includes("OData.Feed"):!1,void this.o3j()}catch(jb){x.ULS.sendTraceTag(537168095,0,10,`PowerQueryCallout.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception ${jb}.`)}};this.Kwc=()=>{x.ULS.sendTraceTag(537168094,0,15,"PowerQueryCallout.OnGetQueriesFailure")};this.$=bd;this.M_f=new Db(bd);this.powerQueryClearAllPermissionsCallout=
new Y(bd);this.hPd=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryAuthenticateRefresh",!1)?new R(bd):new fb(bd)}show(){this.UEa&&this.EPj()}EPj(){this.$.userOperationManager.enqueueOperation(new sb.a(587,0,(bd,be,jb)=>sa.d(this.$.qa.ua,ua.b(bd,this.kaj),ua.a(be,this.Kwc),jb,null),80,()=>new Za.a),null)}o3j(){const bd=this;return Ko(function*(){(yield La.c(bd.M_f.ETb()))&&bd.Ukf?bd.M_f.show():(yield La.c(bd.hPd.ETb()))&&(bd.hPd instanceof R||bd.ukf)?bd.hPd.show():(yield La.c(bd.powerQueryClearAllPermissionsCallout.ETb()))&&
bd.powerQueryClearAllPermissionsCallout.show();bd.UEa=!1})}}Object(l.a)(Ma,"PowerQueryCallout",null,[234]);class lb extends z{constructor(bd){super(bd);this.dJd=this.lcd=this.mw=this.ow=this.target=null}lG(bd,be,jb){this.Mq()||(this.target=bd,this.lcd=be,this.dJd=jb,this.ow=wa.a.instance.za(710),this.mw=wa.a.instance.za(711))}show(){x.ULS.shipAssertTag(537168091,0,!!this.target&&!!this.mw&&!!this.ow&&!!this.lcd&&!!this.dJd,"TableAIConvertToTableCallout.Show() - Cannot retrieve the Callout Parameters, Initialize should be called before show");
this.Mq()||(x.ULS.sendTraceTag(0,0,50,"TableAIConvertToTableCallout.Show() - Showing TableAIConvertToTableCallout callout."),super.show())}Mq(){return!!this.$N}mza(){const bd=Object(u.a)(new t.a,{label:wa.a.instance.za(712),ariaDescription:wa.a.instance.za(714),onExecute:()=>{x.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "Format as table" button');this.lcd();this.dismiss()}}),be=Object(u.a)(new t.a,{label:wa.a.instance.za(713),ariaDescription:wa.a.instance.za(715),onExecute:()=>
{x.ULS.sendTraceTag(0,0,50,'TableAIConvertToTableCallout - clicked "No thanks" button');this.dJd();this.dismiss()}});return Object(u.a)(new m.a,{target:this.target,content:this.mw,title:this.ow,primaryButtonProps:bd,secondaryButtonProps:be,showCloseIcon:!0,calloutProps:Object(u.a)(new n.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!0,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!1,hasFocusableControls:!0})}}Object(l.a)(lb,
"TableAIConvertToTableCallout",z,[]);var pb=a(184),Vb=a(81);class Wa{constructor(bd){this.Xek=bd}show(){Vb.a.instance.ie("Common.ISystemInitiatedFeedback").execute(bd=>{bd.logActivity(this.Xek,null)})}}Object(l.a)(Wa,"EwaLppCallout",null,[234]);var ka=a(45);class Sa extends Wa{constructor(bd){super("ExcelTableInNewWorkbook");this.$xd=this.qBa=!1;this.createTable=()=>{const be=ka.v(new pb.a(1,1,8,3,Oa.a.Bh,Oa.a.Ah),this.$),jb={};jb.TableRange=be;jb.HasHeader=!1;this.$.rf(71074531,ca.a.Td,9,jb)};this.jSe=
()=>{this.createSampleTable("0")};this.kSe=()=>{this.createSampleTable("2")};this.lSe=()=>{this.createSampleTable("1")};this.$=bd;(this.qBa=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableInNewWorkbook",!1))&&window.addEventListener("ExcelCreateSampleTable",this.createTable,!0);if(this.$xd=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateSampleTableCallout",!1))window.addEventListener("ExcelCreateSampleTableBlank",this.jSe,!0),window.addEventListener("ExcelCreateSampleTableContact",
this.kSe,!0),window.addEventListener("ExcelCreateSampleTableToDo",this.lSe,!0)}dispose(){this.qBa&&window.removeEventListener("ExcelCreateSampleTable",this.createTable,!0);this.$xd&&(window.removeEventListener("ExcelCreateSampleTableBlank",this.jSe,!0),window.removeEventListener("ExcelCreateSampleTableContact",this.kSe,!0),window.removeEventListener("ExcelCreateSampleTableToDo",this.lSe,!0))}createSampleTable(bd){const be={};be[ca.a.qf]=bd;this.$.rf(1371713064,ca.a.Td,9,be)}}Object(l.a)(Sa,"TableInNewWorkbookCallout",
Wa,[]);var Xb=a(1150);class Mc extends z{constructor(bd){super(bd);this.jHc=5E3;this.ow=Xb.a.Title;this.currentState=0}xya(bd,be){Xb.c.get(this.currentState).includes(bd)&&(6===bd?window.requestAnimationFrame(()=>this.kfc(bd,be)):this.kfc(bd,be))}HWb(bd){this.target=bd}show(){super.dismiss();this.$8f();super.show()}dismiss(){this.xya(0);window.clearTimeout(this.o4f);super.dismiss()}mza(){return Object(u.a)(new m.a,{target:this.target,title:this.ow,content:this.mw,showCloseIcon:!0,calloutProps:{setInitialFocus:!1,
preventDismissOnResize:!0,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,isBeakVisible:!0,directionalHint:12,onDismiss:void 0},useTeachingStyles:!1,hasFocusableControls:!1})}update(){this.$8f();super.YYa({message:this.mw})}kfc(bd,be){const jb=Xb.b.get(bd);this.Rjk(this.sDh(bd)?`${jb}${be}`:jb);this.currentState=bd;0!=this.currentState?(this.update(),this.show()):this.dismiss()}sDh(bd){switch(bd){case 5:case 6:return!0;default:return!1}}$8f(){window.clearTimeout(this.o4f);this.o4f=window.setTimeout(()=>
this.dismiss(),this.jHc)}Rjk(bd){this.mw=bd}}Object(l.a)(Mc,"FormulaByExampleCurtainLifterCallout",z,[]);var jc=a(187);class $c extends Ea{constructor(bd){super(bd,"DataCleansingTeachingCallout",jc.a.ha(1952),jc.a.ha(1953),"",jc.a.ha(1954),16777216,24,new Z.a,!0,!1,!1,!1,!0,!0,!0,5,!0);this.q4d="[id=DataCleansingTaskPane]";this.czg=!1}lG(bd,be){this.SAg=String.format(wa.a.instance.Qd(213),bd);this.czg=be}OOa(){return k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPaneDiscoverabilityCallout",
!1)&&this.czg?0:2}dod(){return 2592E3}get kV(){return this.q4d}get jV(){return this.q4d}get NU(){return this.q4d}get ribbonCommandInfo(){return new ra.a(-1190551534,ca.a.Td,this.$.Ie,0,null)}}Object(l.a)($c,"DataCleansingTeachingCallout",Ea,[]);var Jd=a(119);class fd extends z{constructor(bd){super(bd);this.mw=this.ow=this.target=null;this.duration=0}lG(bd,be,jb){this.Mq()||(this.target=bd,this.ow=this.Y3h(be),this.mw=wa.a.instance.za(737),this.operation=be,this.duration=jb)}show(){x.ULS.shipAssertTag(512304648,
0,!!this.target&&!!this.mw&&!!this.ow,"OptimizeWorkbookSlowOperationsCallout.Show: Cannot retrieve the Callout Parameters, Initialize should be called before show");if(!this.Mq()){x.ULS.sendTraceTag(512304647,0,50,"OptimizeWorkbookSlowOperationsCallout.Show() - Showing OptimizeWorkbookSlowOperationsCallout callout.");var bd={["Operation"]:this.operation,["Duration"]:this.duration};Kb.a.sendTelemetryEvent(Object(u.a)(new db.a,{name:"Office.Excel.Online.OptimizeWorkbook.BigHammerSlowOperationsCalloutShown",
dataFields:Jd.a.Kl(bd)}));super.show()}}Mq(){return!!this.$N}mza(){return Object(u.a)(new m.a,{target:this.target,title:this.ow,content:this.mw,showCloseIcon:!0,calloutProps:Object(u.a)(new n.a,{onDismiss:()=>{this.dismiss()},setInitialFocus:!1,preventDismissOnResize:!1,preventDismissOnScroll:!0,preventDismissOnLostFocus:!1,isBeakVisible:!0}),useTeachingStyles:!0,hasFocusableControls:!1})}Y3h(bd){switch(bd){case 0:return wa.a.instance.za(727);case 1:return wa.a.instance.za(728);case 2:return wa.a.instance.za(729);
case 3:return wa.a.instance.za(730);case 4:return wa.a.instance.za(731);case 5:return wa.a.instance.za(732);case 6:return wa.a.instance.za(733);case 7:return wa.a.instance.za(734);case 8:return wa.a.instance.za(735);case 9:return wa.a.instance.za(736);default:return""}}}Object(l.a)(fd,"OptimizeWorkbookSlowOperationsCallout",z,[]);class Kd extends z{constructor(){super(...arguments);this.lCg="ClickOnLaunch";this.yBg="ClickOnDismiss";this.lDg="Show";this.PBg="BetterEntryPoint_InsertTab";this.CDg=500;
this.dCg=280;this.cCg=192;this.UCg="[data-unique-id=Ribbon-InsertAddinTransitionEntry]";this.WBg="[data-unique-id=Home]";this.fCg="InsertAddinTransitionEntry";this.XBg="Home";this.eCg="InsertAddInFlyout";this.WCg="RibbonOverflowMenu-overflow"}lG(){}show(){this.oL(this.lDg);x.ULS.sendTraceTag(509367621,0,50,"ExcelBetterEntryTeachingCallout.Show() - Showing ExcelBetterEntryTeachingCallout callout.");super.show()}mza(){let bd=this.UCg;var be=document.getElementById(this.fCg),jb=be?window.getComputedStyle(be,
null):null;if(null==be||jb&&"none"===jb.display)bd=this.WBg;be=CommonUIStrings.l_BetterEntryPointTUI_Title;var lc=CommonUIStrings.l_BetterEntryPointTUI_Content;jb=new ya.a("https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE5elF8");lc=lc.split("\n");jb=Object.assign(new fc(lc,jb),{imageWidth:this.dCg,imageHeight:this.cCg});jb=new Jb(jb);lc=Object.assign(new t.a,{label:CommonUIStrings.l_BetterEntryPointTUI_ButtonText1,ariaDescription:CommonUIStrings.l_BetterEntryPointTUI_ButtonText1,onExecute:()=>
{this.lpi();this.oL(this.lCg);this.dismiss()}});const Zc=Object.assign(new t.a,{label:CommonUIStrings.l_BetterEntryPointTUI_ButtonText2,ariaDescription:CommonUIStrings.l_BetterEntryPointTUI_ButtonText2,onExecute:()=>{this.oL(this.yBg);this.dismiss()}});return Object.assign(new m.a,{target:bd,content:jb,title:be,primaryButtonProps:lc,secondaryButtonProps:Zc,showCloseIcon:!0,hasDynamicSizing:!1,preventLightDismiss:!1,useTeachingStyles:!0,calloutProps:Object.assign(new n.a,{onDismiss:()=>{this.dismiss()},
setInitialFocus:!0})})}lpi(){appChrome.api.dispatch(appChrome.actions.setCurrentTab(this.XBg));window.setTimeout(()=>{this.eQi()},this.CDg)}eQi(){const bd=document.getElementById(this.eCg),be=bd?window.getComputedStyle(bd,null):null;if(null==bd||be&&"none"===be.display){const jb=document.getElementById(this.WCg);null!=jb?(jb.onclick=function(){window.setTimeout(()=>{const lc=document.querySelector("[data-unique-id='Overflow-InsertAddInFlyout']");null!=lc&&(lc.click(),x.ULS.sendTraceTag(509367620,
0,50,"Launch flyout in overflow"))},500);jb.onclick=function(){}},jb.click()):x.ULS.sendTraceTag(509367619,0,10,"Neither ribbon nor overflow can launch flyout")}else bd.click(),x.ULS.sendTraceTag(509367618,0,50,"Launch flyout in ribbon button")}oL(bd){bd={["AppTeachingUICalloutAction"]:bd,["AppTeachingUICalloutGoal"]:this.PBg};Kb.a.sendTelemetryEvent(Object.assign(new db.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Jd.a.Kl(bd)}))}}Object(l.a)(Kd,"ExcelBetterEntryTeachingCallout",
z,[]);class Yd extends Ea{constructor(bd){super(bd,"FunctionDialogTeachingCallout",void 0,wa.a.instance.za(763),wa.a.instance.za(760),wa.a.instance.za(761),1073741824,30,new Z.a,!0,!0,!1,!1,!0,!0,!0,5,!0)}lG(bd){this.y5c=`[id=${"CellEdit"===bd?this.$.He+Ka.a.sBb:"InsertFunction"}]`}OOa(){return 1}get kV(){return this.y5c}get jV(){return this.y5c}get NU(){return this.y5c}get ribbonCommandInfo(){return null}}Object(l.a)(Yd,"FunctionDialogTeachingCallout",Ea,[]);class te extends Wa{constructor(bd){super("ExcelLiveWebEntryPointCallout");
this.LAa=!1;this.emg=()=>{this.$.rf(327119921,ca.a.Td,9,null)};this.$=bd;(this.LAa=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveWebEntryPointCalloutEnabled",!1))&&window.addEventListener("TryCoEditInTeams",this.emg,!0)}dispose(){this.LAa&&window.removeEventListener("TryCoEditInTeams",this.emg,!0)}}Object(l.a)(te,"ExcelLiveWebEntryPointCallout",Wa,[]);class ve{constructor(bd){this.$=bd;this.iz=new X.a(!1)}fdi(bd){if(!this.iz.Hd(Fa[bd]))switch(bd){case 0:this.Xoh(bd);break;case 2:this.iz.add(Fa[bd],
new ob(this.$));break;case 3:this.iz.add(Fa[bd],new cb(this.$));break;case 6:this.iz.add(Fa[bd],new Sb(this.$));break;case 1:this.iz.add(Fa[bd],new oa(this.$));break;case 4:this.iz.add(Fa[bd],new ta(this.$));break;case 5:this.iz.add(Fa[bd],new xa(this.$));break;case 7:this.iz.add(Fa[bd],new $a(this.$));break;case 8:this.iz.add(Fa[bd],new Ba(this.$));break;case 9:this.iz.add(Fa[bd],new va(this.$));break;case 13:this.iz.add(Fa[bd],new gb(this.$));break;case 10:this.iz.add(Fa[bd],new ab(this.$));break;
case 11:this.iz.add(Fa[bd],new Ma(this.$));break;case 12:this.iz.add(Fa[bd],new lb(this.$));break;case 14:this.iz.add(Fa[bd],new Sa(this.$));break;case 15:this.iz.add(Fa[bd],new Mc(this.$));break;case 16:this.iz.add(Fa[bd],new $c(this.$));break;case 18:this.iz.add(Fa[bd],new fd(this.$));break;case 20:this.iz.add(Fa[bd],new te(this.$));break;case 19:this.iz.add(Fa[bd],new Kd(this.$));break;case 21:this.iz.add(Fa[bd],new Yd(this.$));break;default:return null}return this.iz.getItem(Fa[bd])}Xoh(bd){this.iz.add(Fa[bd],
new qc(this.$,wa.a.instance.za(640),wa.a.instance.za(637),wa.a.instance.za(638),wa.a.instance.za(639),16,4,!0))}}Object(l.a)(ve,"EwaCalloutFactory",null,[]);var qe=a(59),pc=a(63),nd=a(162);let qd=class{constructor(bd){this.$=bd;this.oJh=new ve(this.$)}hf(){return!1}mf(){return!1}Ue(bd,be,jb){bd=jb.CalloutName;this.o1j=k.EwaSettings.isChangeGateEnabled("OfficeVSO:6189760_SuppressTeachingCalloutForLiveMeetings")&&Object(nd.c)(this.$)&&!this.ZCi(bd);return!!be&&-847286761===be.command&&qe.a.Ji.zU&&!this.o1j}ZCi(bd){return this.$.Mx&&
9===bd}executeCommand(bd,be,jb){bd=jb.CalloutName;if(be=this.oJh.fdi(bd)){switch(bd){case 2:be.lG(jb.Target,jb.RibbonButtonLabel,jb.ExampleEntities,jb.BlankCellResourceId,jb.HasBlankCellWalkthrough,jb.ServiceDomain);break;case 3:be.lG(jb.Target,jb.RibbonButtonLabel,jb.ExampleEntities);break;case 6:be.lG(jb.Target);break;case 8:be.lG(jb.Target);break;case 13:be.lG(jb.Target);break;case 15:return be.HWb(jb.Target),be.xya(jb.NewState,jb.Reason),pc.Task.Ua(!0);case 12:be.lG(jb.Target,jb.ConvertToTableCallback,
jb.NoThanksCallback);break;case 16:be.lG(jb.SuggestionsCount,jb.WithoutCoolDown);break;case 18:be.lG(jb.Target,jb.Operation,jb.Duration);break;case 19:be.lG();break;case 21:be.lG(jb.Trigger)}be.show();return pc.Task.Ua(!0)}return pc.Task.Ua(!1)}};qd=Object(v.a)([Object(L.d)(J.ed),Object(v.b)(0,Object(J.fb)())],qd);Object(l.a)(qd,"ShowCalloutCommandHandler",null,[169]);class tb extends Ga.a{constructor(bd){super(bd)}dispose(){super.dispose()}yg(){this.vg([new qd(this.$)])}static la(bd){Ga.a.dh(378,
new tb(bd))}}Object(l.a)(tb,"ShowCalloutCommandHandlerFactory",Ga.a,[]);var Dc=a(9),Tc=a(82),ub=a(58);const Pb=(bd,be,jb,lc,Zc,dd,Qd)=>{Qd=bd.Pa(1,void 0===Qd?null:Qd);Qd.sheetName=be;return ub.g(bd,"EvaluateSheetOptimizableContent",Qd,jb,lc,Zc,dd,4)};var ee=a(20),Ad=a(41),Ub=a(143);class tc{constructor(bd,be){this.sessionID=null;this.QVf=jb=>{if(jb){let lc=Ad.d(jb.data);({Ft:jb}=lc);if(lc.returnValue&&(jb=Object(Ub.a)(Object,jb))&&"OptimizeWorkbookTaskPane"===jb.Origin)if(this.sessionID!==jb.SessionId)x.ULS.sendTraceTag(509748062,
0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(jb.Event){case "Error_LoadBookData":this.optimizeWorkbookManager.BUj();x.ULS.sendTraceTag(509673560,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Load book data error Event.");break;case "OptimizeTriggered":this.optimizeWorkbookManager.aVj();x.ULS.sendTraceTag(509688027,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Optimize Event.");
break;case "TriggerFeedback":this.optimizeWorkbookManager.O2j();x.ULS.sendTraceTag(509748061,0,50,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Feedback Event.");break;default:x.ULS.sendTraceTag(509748060,0,10,"OptimizeWorkbookTaskPaneListener.optimizeWorkbookMessageReceivedEventHandler() - Unhandled Event.")}}};this.optimizeWorkbookManager=bd;this.sessionID=be}initialize(){window.addEventListener("message",this.QVf,!1)}dispose(){window.removeEventListener("message",
this.QVf,!1)}}Object(l.a)(tc,"OptimizeWorkbookTaskPaneListener",null,[]);let yc=class extends Tc.a{constructor(bd){super();this.businessBar=null;this.Znb=2;this.oqb=-1;this.TDc=!1;this.uNb=null;this.xAf=this.Rog=this.Buf=this.PVf=!1;this.J8i=be=>{this.$&&((be=be.Result)?be.HasSignificantOptimizableContent?(x.ULS.sendTraceTag(539870352,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed with significant optimizable content"),be.OptimizableRangesOrPercentage&&(this.oqb=be.OptimizableRangesOrPercentage),
0>=this.oqb&&0!==this.Znb&&(x.ULS.sendTraceTag(512349446,0,50,"OptimizeWorkbookManager.OptimizableRangesOrPercentage Range count or percentage must return valid value"),this.Znb=0),this.NTb()):x.ULS.sendTraceTag(537154764,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Operation completed without significant optimizable content"):x.ULS.sendTraceTag(537154763,0,50,"OptimizeWorkbookManager.OnEvaluateSuccess: Null result object"))};this.cfj=(be,jb,lc)=>{(be=be.Result)?be.HasSignificantOptimizableContent?
(x.ULS.sendTraceTag(512304643,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed with significant optimizable content"),this.TDc=!0,this.B4j(jb,lc)):x.ULS.sendTraceTag(512304644,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Operation completed without significant optimizable content"):x.ULS.sendTraceTag(512304645,0,50,"OptimizeWorkbookManager.onRetrieveSuccess: Null result object")};this.$=bd;this.S7j();this.TDc=!1;this.eEh=k.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.SlowOperationDurationThreshold",
2E3);this.uNb=new tc(this,this.$.ea.sessionId)}dispose(){this.XPa();this.$=this.businessBar=null;this.FWe();super.dispose()}Myi(){this.uNb&&this.uNb.initialize()}FWe(){this.uNb&&this.uNb.dispose()}XPa(){this.businessBar&&this.businessBar.Moa(62)&&this.businessBar.removeEntry(62)}S7j(){Vb.a.instance.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(bd=>{bd.isFeatureEnabled("ExcelOptimizeCellTableBigHammer",!1).then(be=>{if(be){var jb=this.$.qa.ua,lc=this.Znb,Zc=this.J8i;const dd=
jb.Pa(1,null);dd.businessBarMessageType=lc;ub.g(jb,"EvaluateOptimizableContentV2",dd,Zc,null,null,null,4)}return be})})}NTb(){const bd=Object(La.d)(L.a.resolve(J.p,{Oa:1}));H.TaskExtensions.Aa(bd,()=>{const be=bd.result;be&&(be.ej(62,null,null,this.w3h()),this.businessBar=be)},this.$.ma,3)}w3h(){switch(this.Znb){default:return wa.a.instance.ha(2239);case 1:return String.format(wa.a.instance.za(720),this.oqb);case 2:return String.format(wa.a.instance.za(721),this.oqb)}}Xyi(){!k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerEnableClosePaneFeedback",
!1)||!this.Buf||this.PVf||this.Rog||this.xAf||(Vb.a.instance.ie("Common.ISystemInitiatedFeedback").execute(bd=>{bd.logActivity("Office_Excel_OptimizeWorkbook_InitializeClosePaneFloodgate",null)}),x.ULS.sendTraceTag(509688028,0,50,"OptimizeWorkbookManager.initiateClosePaneFeedback() - Feedback Triggered."))}kUj(bd){this.Buf=bd}aVj(){this.PVf=!0}BUj(){this.xAf=!0}Xaa(bd,be,jb){if(be&&be.RequestTelemetryData&&!(be.RequestTelemetryData.EcsOperationDuration<this.eEh)&&this.businessBar&&this.businessBar.Moa(62)&&
!this.TDc){var lc=jb?jb:this.$.pa.sheetName;if(6===bd||7===bd||8===bd||9===bd)this.evaluateSheetOptimizableContent(lc,bd,be.RequestTelemetryData.EcsOperationDuration);else{const Zc=()=>{ee.h(this.$).ya.ds(Zc);this.evaluateSheetOptimizableContent(lc,bd,be.RequestTelemetryData.EcsOperationDuration)};ee.h(this.$).ya.wt(Zc)}}}evaluateSheetOptimizableContent(bd,be,jb){Pb(this.$.qa.ua,bd,lc=>{this.cfj(lc,be,jb)},null,null,null)}B4j(bd,be){const jb=new ra.a(-847286761,ca.a.Td,this.$.Ie,0,null),lc={CalloutName:18};
lc.Target=this.businessBar.wnd(62);lc.Operation=bd;lc.Duration=be;this.$.Ga.Sd(jb,lc)}O2j(){this.$.rf(802602464,ca.a.Td,12,{[Ka.a.aI]:"OptimizeWorkbookTaskPane"});this.Rog=!0}};yc=Object(v.a)([Object(L.d)(J.pc),Object(v.b)(0,Object(J.fb)())],yc);Object(l.a)(yc,"OptimizeWorkbookManager",Tc.a,[667]);var Sd=a(740);class Fd extends r.a{constructor(bd){super();this.$=bd;this.Oe()}create(){const bd=Object(Sd.a)(this.$.ia,465,()=>new yc(this.$));this.ve(bd)}static la(bd){bd.ia.Va(466,new Fd(bd))}}Object(l.a)(Fd,
"OptimizeWorkbookManagerFactory",r.a,[]);var se=a(181),uc=a(767),Ra=a(741);class vb extends uc.a{constructor(){super();this.range=null;this.H_=Object.assign(new Ra.a,{T_:vb.getTypeName(),B_:vb.getBaseTypes()})}static getTypeName(){return"AugLoop_Excel_ExcelRangeWrapperAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(l.a)(vb,"ExcelRangeWrapperAnnotation",uc.a,[]);class Gc extends vb{constructor(){super();this.boundaryConfidence=this.hasMergedcells=this.tableName=this.interpretations=
null;this.H_=Object.assign(new Ra.a,{T_:Gc.getTypeName(),B_:Gc.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"}static getBaseTypes(){return["AugLoop_Excel_ExcelRangeWrapperAnnotation","AugLoop_Core_Annotation"]}}Object(l.a)(Gc,"ExcelRecognizedTableNew",vb,[]);class cd extends Gc{constructor(){super();this.requestId=null;this.H_=Object.assign(new Ra.a,{T_:cd.getTypeName(),B_:cd.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"}static getBaseTypes(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew",
"AugLoop_Core_Annotation"]}}Object(l.a)(cd,"ExcelRangeMetadata",Gc,[]);var Cd=a(1216);class Rd extends Cd.a{constructor(){super();this.value=null;this.type=0;this.H_=Object.assign(new Ra.a,{T_:Rd.getTypeName(),B_:Rd.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_ExtendedExcelCell"}static getBaseTypes(){return["AugLoop_Excel_ExcelCell","AugLoop_Core_GridCell"]}}Object(l.a)(Rd,"ExtendedExcelCell",Cd.a,[]);var Be=a(871);class ad extends Be.a{constructor(){super();this.mergeCellAddresses=
this.requestId=this.cells=this.range=null;this.H_=Object.assign(new Ra.a,{T_:ad.getTypeName(),B_:ad.getBaseTypes()})}static getTypeName(){return"AugLoop_ExcelTableai_RangeDataSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(l.a)(ad,"RangeDataSignal",Be.a,[]);var Qc=a(1214),Zd=a(108),Tb=a(37);class Yc extends Sys.EventArgs{constructor(bd){super();this.iPb=bd}}Object(l.a)(Yc,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);var Ob=a(198),kc=a(24),Kc=a(354);class Wc{constructor(bd,
be,jb,lc,Zc){this.PD=bd;this.interpretations=be;this.tableName=jb;this.id=lc;this.Mkf=Zc}}Object(l.a)(Wc,"RecognizedTable",null,[]);class Nd{constructor(bd,be,jb){this.classification=bd;this.aggregations=be;this.headerReferences=jb}}Object(l.a)(Nd,"TableField",null,[]);var Ud=a(1137);const $d=bd=>{var be=new Kc.a($b(bd.range),bd.range.worksheetId);var jb=bd.interpretations;var lc=new Ob.a;if(jb&&jb.length)for(const Id of jb){b:switch(Id.orientation.toLowerCase()){case "columnmajor":jb=2;break b;case "rowmajor":jb=
1;break b;default:x.ULS.sendTraceTag(537151256,0,50,"Invalid value for table orientaion."),jb=0}const me=jb;if(0===me)x.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.");else{jb=Ud.a;var Zc=$b(Id.location),dd=Id.confidence,Qd=Id.headerRowCount,ue=Id.headerColumnCount;var qa=Id.fields;var Xa=new Ob.a;if(qa)for(const Wb of qa){qa=Xa;var wb=qa.add;c:switch(Wb.classification.toLowerCase()){case "dimension":var Rb=1;break c;case "measure":Rb=2;break c;
default:x.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification."),Rb=0}var vc=Wb.aggregations;var Nc=new Ob.a;if(vc)for(const Ec of vc)switch(Ec.toLowerCase()){case "sum":Nc.add(0);break;case "count":Nc.add(1);break;case "average":Nc.add(2);break;case "min":Nc.add(3);break;case "max":Nc.add(4);break;case "distinctcount":Nc.add(5);break;case "stddev":Nc.add(6);break;case "variance":Nc.add(7);break;default:x.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}vc=
Nc;var id=Wb.headerReferences;Nc=new Ob.a;if(id)for(const Ec of id)id=new kc.Range(Ec.top,Ec.left,Ec.top,Ec.left,!1,!1),Nc.add(id);wb.call(qa,new Nd(Rb,vc,Nc))}jb=new jb(Zc,dd,Qd,ue,me,Xa);lc.add(jb)}}return new Wc(be,lc,bd.tableName,bd.id,bd.hasMergedcells)},$b=bd=>new kc.Range(bd.top,bd.left,bd.bottom,bd.right,!1,!1);var nc=a(996);class Oc{constructor(bd,be){this.nMc=0;this.HB=new Map;this.Vwd=!1;this.tableIntelligenceManager=bd;this.mj=be;k.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&
(this.Jec=new nc.a("WebServiceCall","TableIntelligenceQueryManagerE2ELatency"),this.Jec.start(),this.lIc=!0);this.tableIntelligenceManager.M2a("Valid",this.eij.bind(this));this.tableIntelligenceManager.M2a("Invalid",this.Lbj.bind(this));k.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&this.mj.nVg(this.K6i.bind(this))}mPa(bd,be,jb){if(!this.HB)return x.ULS.sendTraceTag(521025344,306,10,"Recognized table is null"),[];let lc=be;k.EwaSettings.isChangeGateEnabled("OfficeVSO:7408706_QueryManagerCoauthVersionChecking")&&
void 0!==jb&&this.nMc>jb&&(x.ULS.sendTraceTag(509681793,306,50,`getRecognizedTables: maxRevisions: ${jb}, versionChanges: ${this.nMc}`),lc=be^4);return this.HB.has(bd.sheetId)?(be=this.HB.get(bd.sheetId).filter(Zc=>Zc.table.PD.range.If(bd.range)&&(lc&Zc.MKb)==Zc.MKb),x.ULS.sendTraceTag(509681792,306,50,`getRecognizedTables: foundRecords: ${be.length}`),be):[]}eij(bd,be){if(this.HB){if(!this.Vwd){k.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&this.lIc&&(this.Jec.stop(),x.ULS.sendTraceTag(509089223,
0,15,"Elapsed time since annotation invalidation: {0}",this.Jec.pf),this.lIc=!1);for(const jb of this.HB){const [lc,Zc]=jb;Zc.every(dd=>4===dd.MKb)?this.HB.delete(lc):this.HB.set(lc,Zc.filter(dd=>4!==dd.MKb))}this.Vwd=!0}bd=be.iPb;this.HB.has(bd.PD.sheetId)||this.HB.set(bd.PD.sheetId,[]);this.HB.get(bd.PD.sheetId).push({table:bd,MKb:2});this.nMc=0}else x.ULS.sendTraceTag(521025315,306,10,"Recognized table is null")}Lbj(bd,be){this.Vwd=!1;k.EwaSettings.isChangeGateEnabled("OfficeVSO:7748219_LogE2ELatency")&&
!this.lIc&&(this.Jec.start(),this.lIc=!0);bd=be.iPb;if(!this.HB)x.ULS.sendTraceTag(521025314,306,10,"Recognized table is null");else if(this.HB.has(bd.PD.sheetId))for(const jb of this.HB.get(bd.PD.sheetId))jb.table.id===be.iPb.id&&(jb.MKb=4)}K6i(){this.nMc++}}Object(l.a)(Oc,"TableIntelligenceQueryManager",null,[822]);class Hd{}Object(l.a)(Hd,"RecognizedTableLog",null,[]);class re{}Object(l.a)(re,"Interpretation",null,[]);class fe{constructor(bd){this.HB=new Map;this.D7b=void 0;this.Wtb=new Set;this.YLb=
void 0;this.tableIntelligenceManager=bd}rCg(){this.YLb?x.ULS.shipAssertTag(522303246,306,!1,"LogXlimRecognizedTables should not be called twice."):(this.YLb=this.XLb.bind(this),this.tableIntelligenceManager.M2a("Valid",this.YLb))}bVi(bd){bd=this.sanitize(bd);x.ULS.sendTraceTag(521233111,306,15,`${JSON.stringify(bd)}`)}XLb(bd,be){bd=be.iPb;k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.Wtb&&this.HB?(this.Wtb.has(bd.id)||(this.jYg(bd),this.Wtb.add(bd.id)),
this.D7b||(this.D7b=window.setTimeout(this.tqa.bind(this),2E3))):x.ULS.sendTraceTag(522303245,306,15,`AnnotationId set or recognized table store is null. annotationIdSet = ${!!this.Wtb}, recognizedTableStore = ${!!this.HB}`))}tqa(){for(const bd of this.HB){const [,be]=bd;x.ULS.sendTraceTag(521233110,306,15,JSON.stringify(be))}window.clearTimeout(this.D7b);this.Wtb=this.D7b=void 0;this.HB.clear();this.HB=void 0;this.tableIntelligenceManager.RBj(this.YLb);this.YLb=void 0}jYg(bd){const be=bd.PD.sheetId;
this.HB.has(be)||this.HB.set(be,[]);this.HB.get(be).push(this.sanitize(bd))}sanitize(bd){const be=[];for(const jb of bd.interpretations){let lc=0,Zc=0;for(const dd of jb.fields)1===dd.classification?lc++:2===dd.classification&&Zc++;be.push({confidence:jb.confidence,headerRowCount:jb.headerRowCount,headerColumnCount:jb.headerColumnCount,orientation:jb.orientation,measureCount:Zc,dimensionCount:lc})}return{interpretations:be,range:{top:bd.PD.range.top,bottom:bd.PD.range.bottom,left:bd.PD.range.left,
right:bd.PD.range.right},isTable:!!bd.tableName,annotationId:bd.id}}}Object(l.a)(fe,"RecognizedTableLogger",null,[]);class oc extends Tb.a{constructor(bd,be){super();this.Roc=this.bsf=!1;this.instantaneousSupportInformationManager=null;this.eSd=void 0;this.VCf=!1;this.JRh=(jb,lc)=>{var Zc;if(1===lc.operationType){const Qd=lc.annotation;if(Qd){x.ULS.sendTraceTag(537151251,306,50,`TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = ${Qd.requestId}`);jb=$d(Qd);k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",
!1)&&(null===(Zc=this.eSd)||void 0===Zc?void 0:Zc.bVi(jb));var dd=null;(()=>{let ue=this.e3d.Jf(Qd.requestId);({value:dd}=ue);return ue})().returnValue?(this.e3d.remove(Qd.requestId),dd(jb)):x.ULS.sendTraceTag(537151250,306,10,`TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = ${Qd.requestId}`)}else x.ULS.sendTraceTag(537151252,306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null.")}};this.OUg=(jb,lc)=>{this.ZZf("RecognizedTableUpdate",
lc)};this.mj=bd;this.$=be;this.e3d=new Zd.a;this.$.ia.Va(20,this);k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.eSd=new fe(this));this.mj.register(this.mj.p2().L4("TableIntelligence").J4(()=>{}).build())}Ona(){this.lYa||(this.lYa=new Oc(this,this.mj));return this.lYa}zbi(bd,be){if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:6648526_LimitCellsInSignal")&&1E4<bd.range.ny)return x.ULS.sendTraceTag(520501002,306,15,`Signal with range size of ${bd.range.ny} exceeds limit of ${1E4}`),
4;this.gUg();if(this.PJi(bd.range))return this.gfi(bd,be);x.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2}E0g(bd){this.hUg();this.addHandler("RecognizedTableUpdate",bd);this.xof()}HEj(bd){this.removeHandler("RecognizedTableUpdate",bd)}Xcd(bd){return(be,jb)=>{this.ZZf(this.KGd(bd),jb)}}M2a(bd,be){var jb,lc;k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",!1)&&(null===(lc=null===(jb=this.$)||void 0===
jb?void 0:jb.ta)||void 0===lc?0:lc.count)&&this.$.ta.count>k.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?x.ULS.sendTraceTag(520720838,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.ta.count}`):(this.Roc||(this.mj.iha("TableIntelligence",{uu:!0,annotationType:Gc.getTypeName(),XU:this.Xcd("New"),vGa:this.Xcd("Valid"),Gnc:this.Xcd("Invalid")}),this.Roc=!0),this.mXg(bd,
be),this.xof())}RBj(bd){this.removeHandler(this.KGd("Valid"),bd)}mXg(bd,be){this.addHandler(this.KGd(bd),be)}Hyj(){k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&this.mj.iha("TableIntelligence",{annotationType:Gc.getTypeName(),uu:!0,XU:this.OUg})}Gyj(){this.mj.iha("TableIntelligence",{annotationType:cd.getTypeName(),uu:!1,XU:this.JRh})}hUg(){var bd,be;k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThreshold",!1)&&(null===
(be=null===(bd=this.$)||void 0===bd?void 0:bd.ta)||void 0===be?0:be.count)&&this.$.ta.count>k.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.TableIntelligenceSheetCountThresholdValue",100)?x.ULS.sendTraceTag(520720837,306,15,`TableIntelligenceManager::addRecognizedTableAnnotationCallback Exceeded max sheet count threshold. SheetCount ${this.$.ta.count}`):this.Roc||(this.Hyj(),this.Roc=!0)}gUg(){this.bsf||(this.bsf=!0,this.Gyj())}ZZf(bd,be){1===be.operationType&&((be=be.annotation)?(be=$d(be),
this.raiseEvent(bd,new Yc(be))):x.ULS.sendTraceTag(523772681,306,10,"TableIntelligenceManager::processAndRaiseExcelRecognizedTableAnnotationReceivedEvent ExcelRecognizedTable is null."))}KGd(bd){return`${"RecognizedTableUpdate"}_${bd}`}gfi(bd,be){x.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");const jb=bd.range,lc=ee.h(this.$).Lm("TableIntelligence",jb,1),Zc=[],dd=[];let Qd=0;const ue=k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1);for(this.instantaneousSupportInformationManager||
this.$.ia.Od(268,qa=>{this.instantaneousSupportInformationManager=qa});lc.$$mn();){const qa=lc.$$cu();if(!qa)continue;if(0===qa.Jm.type&&xb.a.Ns(qa.Jm.value))continue;qa.bL&&qa.range&&dd.push(Object(u.a)(new Qc.a,{worksheetId:bd.sheetId,left:qa.range.left-1,top:qa.range.top-1,right:qa.range.right-1,bottom:qa.range.bottom-1}));const Xa=qa.range.top-1,wb=qa.range.left-1;let Rb=null,vc=null;({category:vc}=this.instantaneousSupportInformationManager.Ysa(qa.cell.Lj,!0));qa.text!=qa.Jm.value&&(Rb=qa.text,
ue&&Qd++);Zc.push(Object.assign(new Rd,{row:Xa,column:wb,value:qa.Jm.value,type:qa.Jm.type,displayText:Rb,dyk:vc}))}ue&&x.ULS.sendTraceTag(526260166,306,50,`TableIntelligenceManager::getRangeDataFromGrid requests non-null displayText: ${Qd}, number of values: ${Zc.length}, range size: ${jb.height} rows by ${jb.width} columns`);if(0<Zc.length)return this.Qth(Zc,bd,dd,be),dd.length?5:0;x.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");return 3}Qth(bd,be,jb,lc){var Zc=be.range;Zc=
Object(u.a)(new Qc.a,{top:Zc.top,left:Zc.left,bottom:Zc.bottom,right:Zc.right,worksheetId:be.sheetId});be=se.a.create().toString();bd=Object(u.a)(new ad,{cells:bd,range:Zc,mergeCellAddresses:jb,requestId:be});this.mj.NUb(bd);this.e3d.add(be,lc)}PJi(bd){const be=ee.h(this.$);if(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)){const jb=be.tna();x.ULS.sendTraceTag(520501001,306,50,`viewportWidth: ${jb.width}, viewportHeight: ${jb.height}`)}return be.ya.AU(4,
this.$.pa)&&!!be.Zd(bd.topLeft)&&!!be.Zd(bd.bottomLeft)&&!!be.Zd(bd.topRight)&&!!be.Zd(bd.bottomRight)}xof(){var bd;!this.VCf&&k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligenceLogging",!1)&&(this.VCf=!0,null===(bd=this.eSd)||void 0===bd?void 0:bd.rCg())}}Object(l.a)(oc,"TableIntelligenceManager",Tb.a,[5,707]);class Xc extends r.a{constructor(bd){super();this.$=bd;this.Oe()}create(){H.TaskExtensions.Aa(Object(La.d)(L.a.resolve(J.j,{Oa:1})),bd=>{if(bd=bd.result){let be=this.$.ia.Ja(20);
be||(be=new oc(bd,this.$),this.$.ia.Va(20,be));this.ve(be)}else x.ULS.sendTraceTag(537151246,306,10,"AugmentationLoopManager instance null. Can not create TableIntelligenceManager instance. Creating null service event."),this.ve(null)},this.$.ma,3)}static la(bd){bd.ia.Va(404,new Xc(bd))}}Object(l.a)(Xc,"TableIntelligenceManagerFactory",r.a,[]);var ud=a(62),Vd=a(477);let ge=class{constructor(bd,be){this.OCe=!1;this.tableIntelligenceManager=bd;k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableGridHighlights",
!1)&&void(k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateRecognizedTableGridHighlighter",!1)?L.a.resolve(J.Nc,{Oa:1}):ud.GetServiceTaskFactory.C9a(be.ia,510,511,1));this.tableIntelligenceManager.M2a("Valid",()=>{this.OCe||(x.ULS.sendTraceTag(526979921,0,15,"Received annotation with interpretations"),this.OCe=!0)})}};ge=Object(v.a)([Object(L.d)(J.od),Object(v.b)(0,Object(Vd.TableIntelligenceManagerService)()),Object(v.b)(1,Object(J.fb)())],ge);Object(l.a)(ge,"TableIntelligenceDarkActivationManager",
null,[177]);class Je extends r.a{constructor(bd){super();this.$=bd;this.Oe()}static la(bd){bd.ia.Va(481,new Je(bd))}create(){const bd=ud.GetServiceTaskFactory.je(this.$.ia,20,404,1);H.TaskExtensions.Aa(bd,()=>{const be=bd.result,jb=Object(Sd.a)(this.$.ia,480,()=>new ge(be,this.$));this.ve(jb)},this.$.ma,3)}}Object(l.a)(Je,"TableIntelligenceDarkActivationManagerFactory",r.a,[]);var Ke=a(277),nf=a(261),uf=a(149),ef=a(1085);let Ve=class{constructor(bd){this.a8c=this.Eld=null;this.JPc=this.isFocused=
!1;this.$=bd}dispose(){}get Df(){return null}get uk(){return this.JPc}get Zg(){return nf.a.qJd}nl(bd,be){be||this.isFocused||!this.Eld||this.Eld();return!be}Il(bd){return bd===document.activeElement&&this.isFocused}Vn(){this.isFocused=!0}ap(){this.isFocused&&this.a8c&&(this.a8c(),this.isFocused=!1)}xxi(){x.ULS.shipAssertTag(537169939,0,uf.b("initializeNotificationFocusManagement"),"EwaNotificationFocusManager.InitializeFocusActions: initializeNotificationFocusManagement Api doesnt exist in AppChrome");
const bd=Object(u.a)(new ef.a,{onFirstActionableAppear:()=>{Ke.a(this.$).um(this);this.JPc=!0},onLastActionableDisappear:()=>{Ke.a(this.$).bD(this);this.JPc=!1},onFocus:()=>{this.isFocused=!0},onBlur:()=>{this.isFocused=!1}});appChrome.initializeNotificationFocusManagement(bd).then(be=>{this.Eld=()=>{be.focus()};this.a8c=()=>{be.blur()};return null})}};Ve=Object(v.a)([Object(L.d)(J.gb),Object(v.b)(0,Object(J.fb)())],Ve);Object(l.a)(Ve,"EwaNotificationFocusManager",null,[666,5,57]);(()=>{Dc.a.Ia(bd=>
{k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateServices1",!1)||tb.la(bd)});Dc.a.Ia(bd=>{k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateLineageDiscoverabilityCallout",!1)||Ca.la(bd)})})();(()=>{Dc.a.Ia(bd=>{k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)||Fd.la(bd)})})();(()=>{Dc.a.Ia(bd=>{Xc.la(bd);k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateTableIntelligenceDarkActivationManager",!1)||
Je.la(bd)})})();String(c);String(e);String(h);String(b);String(f);window.___1692616129248_closurehack=c;window.___1692616129248_closurehack=e;window.___1692616129248_closurehack=h;window.___1692616129248_closurehack=b;window.___1692616129248_closurehack=f}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.pid.js.map/aebba926e128bf3f3f0c0c4152ab4ee6/EwaTS.pid.js.map