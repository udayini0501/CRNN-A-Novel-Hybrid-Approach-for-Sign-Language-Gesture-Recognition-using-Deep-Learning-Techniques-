'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[19],{1335:function(w,B,a){a.r(B);var b={};a.r(b);a.d(b,"SheetTabBarControl",function(){return Sd});var c={};a.r(c);a.d(c,"OAuthManagerWrapper",function(){return Ge});var h={};a.r(h);var f={};a.r(f);a.d(f,"IndexedDB",function(){return na});var e=a(0),k=a(16),l=a(896),r=a(984),v=a(5),u=a(102),x=a(527),t=a(260),m=a(41),n=a(65),A=a(39),y=a(30),z=a(112),F=a(81),D=a(177);class I{get name(){return"Common.App.OAuth.OAuthPackage"}nk(S){S.register(191,
"Common.App.OAuth.IOAuthManager").Ve().$e(()=>new l.OAuthManager)}init(){const S=F.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.phk(S);this.ohk(S)}ohk(S){if(v.AFrameworkApplication.da&&v.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthTokenWithCAEClaimTestEnabled",!1)){var Ja=v.AFrameworkApplication.da.Ra("FileSource");if(v.AFrameworkApplication.da.na("IsO365ConsumerHost")||v.AFrameworkApplication.da.na("IsO365CommercialHost")||"WopiTest"===Ja){var rb=
x.a.txb;if(rb&&rb.IsEnabled){var ma=rb.Application,ib=x.a.authority;if(void 0!==ma&&null!==ma&&ma.length&&void 0!==ib&&null!==ib&&ib.length){var Qb=r.a[S.vJ],Fc=y.a.a7,jd=S.zw(),ke=A.a.lg();S.pD("CAETest",ma).then(ne=>{const Te=Math.floor(A.a.lg()-ke);Qb=r.a[S.vJ];Fc=y.a.a7;jd=S.zw();k.ULS.sendTraceTag(508950355,3E3,50,'OAuthManager attempted to get a CAE test token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Te,
ne.IsSuccess,Qb,ne.ErrorCode,Ja,Fc,jd);if(ne.IsSuccess){ne="Bearer "+ne.Token;v.AFrameworkApplication.Wf.IMc=ne;var Hb=rb.Endpoint;if(Hb){var Cc=A.a.lg();ne={["Authorization"]:ne};Hb=n.a.Zm(Hb,"ReturnRawToken","1");Hb=n.a.Zm(Hb,"EnforceCAE","1");v.AFrameworkApplication.Wf.O2a(Hb,1,null,ne,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(vd=>{var le=Math.floor(A.a.lg()-Cc),De=null;vd.Yj?vd="Canceled":vd.vi?vd="Faulted":(De=vd.result,vd=De.succeeded?"Completed":"Failed");le={["TaskResult"]:vd,
["BrowserTokenDurationMS"]:Te,["BrowserValidationDurationMS"]:le};De&&(le.HttpStatus=De.Aj.data.httpStatus,De.succeeded&&(De=m.a(De.Aj.data.Fg),le.ServerValidationDurationMS=De.ElapsedMilliseconds,le.ServerValidationResult=De.ValidatedToken,le.KMSI=De.KMSI,le.Scopes=De.Scopes,le.TokenExpirationS=Math.floor(parseInt(De.Expiration)-(new Date).getTime()/1E3)));k.ULS.sendTraceTag(508950354,3E3,"Completed"===vd?50:15,z.a.toJSON(le))})}}else k.ULS.sendTraceTag(508950353,3E3,15,"ValidateAccess Failed: ErrorCode: {0}, ErrorMessage: {1}",
ne.ErrorCode,ne.ErrorMessage)}).catch(ne=>{const Te=Math.floor(A.a.lg()-ke);k.ULS.sendTraceTag(508950352,3E3,15,"UNEXPECTED CATCH: {0}, duration: {1}",ne.toString(),Te)})}}}}}phk(S){const Ja=v.AFrameworkApplication.da.Ra("FileSource");if(v.AFrameworkApplication.da.na("IsO365ConsumerHost")||v.AFrameworkApplication.da.na("IsO365CommercialHost")||"WopiTest"===Ja){var rb=x.a.txb;if(rb&&rb.IsEnabled){var ma=rb.Application,ib=x.a.authority;if(void 0!==ma&&null!==ma&&ma.length&&void 0!==ib&&null!==ib&&ib.length){var Qb=
r.a[S.vJ],Fc=y.a.a7,jd=S.zw();try{var ke=new Map;void 0!==ke&&null!==ke?(ke.set("SupportStatus",Qb),ke.set("Browser",Fc),ke.set("AuthStrategy",jd)):ke=null}catch(Te){ke=null}u.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",ke);var ne=A.a.lg();S.pD("Core",ma).then(Te=>{const Hb=Math.floor(A.a.lg()-ne);Qb=r.a[S.vJ];Fc=y.a.a7;jd=S.zw();k.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
Hb,Te.IsSuccess,Qb,Te.ErrorCode,Ja,Fc,jd);ke&&(ke.set("SupportStatus",Qb),ke.set("Browser",Fc),ke.set("AuthStrategy",jd));var Cc=Object.assign(new D.a,{durationMs:Hb,extendedProperties:ke});if(Te.IsSuccess){if(u.Health.instance.recordKpiSuccess("WacCorePFT",Cc),Te="Bearer "+Te.Token,v.AFrameworkApplication.Wf.IMc=Te,Cc=rb.Endpoint){var vd=A.a.lg();v.AFrameworkApplication.Wf.O2a(Cc,1,null,{["Authorization"]:Te},"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(le=>{var De=Math.floor(A.a.lg()-
vd),Ce=null;le.Yj?le="Canceled":le.vi?le="Faulted":(Ce=le.result,le=Ce.succeeded?"Completed":"Failed");De={["TaskResult"]:le,["BrowserTokenDurationMS"]:Hb,["BrowserValidationDurationMS"]:De};Ce&&(De.HttpStatus=Ce.Aj.data.httpStatus,Ce.succeeded&&(Ce=m.a(Ce.Aj.data.Fg),De.ServerValidationDurationMS=Ce.ElapsedMilliseconds,De.ServerValidationResult=Ce.ValidatedToken,De.KMSI=Ce.KMSI,De.Scopes=Ce.Scopes,De.TokenExpirationS=Math.floor(parseInt(Ce.Expiration)-(new Date).getTime()/1E3)));k.ULS.sendTraceTag(520632322,
3E3,"Completed"===le?50:15,z.a.toJSON(De))})}}else u.Health.instance.recordKpiFailure("WacCorePFT",Te.ErrorCode,!1,!1,Cc)}).catch(Te=>{var Hb=Math.floor(A.a.lg()-ne);Hb=Object.assign(new D.a,{durationMs:Hb,extendedProperties:ke});u.Health.instance.recordKpiFailure("WacCorePFT","UNEXPECTED CATCH: "+Te.toString(),!1,!1,Hb)})}}}}dispose(){}static main(){t.a.instance.$k(new I)}}Object(e.a)(I,"OAuthPackage",null,[3,4]);var H=a(519),N=a(9),U=a(233),L=a(40),J=a(1),P=a(299),K=a(226);class ca{}ca.h1e="ewa-svg-icon";
Object(e.a)(ca,"CssClassNames",null,[]);var T=a(14),Q=a(325),fa=a(142),ha=a(13);class Ea{constructor(S,Ja){this.De=null;this.ei=()=>{this.vAf();this.$.ea.to(this.ei)};this.$=S;this.qog={};this.g5d={};this.De=Ja;(Ja=this.lcf("excelInitialAppSprite"))?(this.vze(Ja),this.$.ea.Gh?this.vAf():S.ea.el(this.ei),this.$.ia.Va(388,this)):k.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.g5d=null;this.$.ea.to(this.ei)}APa(S,Ja,rb,ma){rb=void 0===rb?null:rb;
ma=void 0===ma?null:ma;let ib;(ib=this.g5d[S])||(this.g5d[S]=ib=this.vlj(this.qog[S]));if(!ib)return k.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${S} was not found in loaded SVG sprites.`),null;const Qb=ib.cloneNode(!0);if(!Qb.style){const Fc=Q.b(ib),jd=Q.b(Qb),ke={};ke.iconId=S;ke.isOriginalNodeStyleNull=void 0===ib.style||null===ib.style;ke.isOriginalNodeCurrentStyleNull=void 0===ib.currentStyle||null===ib.currentStyle;ke.isClonedNodeCurrentStyleNull=void 0===Qb.currentStyle||
null===Qb.currentStyle;ke.originalNode=Fc.substring(0,Fc.indexOf(">")+1);ke.clonedNode=jd.substring(0,jd.indexOf(">")+1);k.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(ke)}`)}Qb.setAttribute("style",`height: ${Ja}px; width: ${Ja}px;`);ma&&(S=document.createElement("title"),this.De?this.De.dl(S,ma):S.textContent=ma,Qb.insertBefore(S,Qb.childNodes[0]));if(rb)for(const Fc of rb)Sys.UI.DomElement.addCssClass(Qb,Fc);return Qb}ffa(S,
Ja,rb,ma,ib,Qb,Fc,jd){ib=void 0===ib?0:ib;Qb=void 0===Qb?0:Qb;Fc=void 0===Fc?null:Fc;jd=void 0===jd?null:jd;ib&&Qb||(Qb=T.DOMElementExtensions.getBoundingClientRect(ma),ib=Qb.height,Qb=Qb.width);if(Fc=this.APa(S,Ja,Fc,jd))ma.appendChild(Fc),(ma=T.DOMElementExtensions.v8(Fc,"style",null))?Fc.setAttribute("style",ma+` margin: ${(ib-Ja)/2}px ${(Qb-rb)/2}px;`):k.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${S}`);
return Fc}vAf(){void fa.a.resolve(ha.ab,{Oa:0}).then(S=>S("excel-uiSlice20-sprite")).then(()=>this.TXg())}TXg(){const S=this.lcf("excelUiSlice20Sprite");S?this.vze(S):k.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")}vze(S){for(const Ja of S)Ja.type===K.a.e5d&&(this.qog[Ja.id]=Ja)}vlj(S){if(!S)return null;const Ja=S.viewBox;S=S.children;const rb=document.createElementNS(P.a.h5d,K.a.e5d);Sys.UI.DomElement.addCssClass(rb,ca.h1e);rb.setAttribute("focusable","false");
rb.setAttribute("viewBox",Ja);this.UXg(rb,S);return rb}UXg(S,Ja){for(const ma of Ja){const ib=document.createElementNS(P.a.h5d,ma.type);for(let Qb in ma){Ja=Qb;var rb=ma[Qb];"className"===Ja?ib.setAttribute("class",rb):ib.setAttribute(Ja,rb)}S.appendChild(ib)}}lcf(S){return(S=window[S])?S.icons:null}}Object(e.a)(Ea,"SvgIconProvider",null,[716,5]);var ra=a(94);class Z extends U.a{constructor(S){super();this.$=S;this.Oe()}create(){const S=[this.HRi()];let Ja=null;J.EwaSettings.isChangeGateEnabled("OfficeVSO:7982896_TooltipSanitizationImprovementWithSvgIcons")||
(Ja=Object(ra.d)(fa.a.resolve(ha.Mb,{Oa:0})),S.push(Ja));L.TaskExtensions.Aa(L.TaskExtensions.Tg(S,this.$.ma),()=>{window.excelInitialAppSprite?this.ve(this.$.ia.Ja(388)||new Ea(this.$,null===Ja||void 0===Ja?void 0:Ja.result)):k.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.ma,3)}HRi(){return Object(ra.d)(fa.a.resolve(ha.ab,{Oa:this.$a}).then(S=>Ko(function*(){return S("excel-app-intl")})))}static la(S){S.ia.Va(387,new Z(S))}}Object(e.a)(Z,"SvgIconProviderFactory",
U.a,[]);var wa=a(737),la=a(62),ta=a(199),Ca=a(63);class Ga{constructor(S){this.WDh=S}hf(){return!1}executeCommand(S,Ja){S=Ja.command;Ja=null;switch(S){case 1243860697:this.WDh.udk();break;default:Ja=ta.a(S)}return Ja||Ca.Task.Ua(!0)}Ue(S,Ja){return 1243860697===Ja.command}mf(){return!1}}Object(e.a)(Ga,"SheetDropdownMenuCommandHandler",null,[169]);class Oa extends wa.a{constructor(S){super(S)}yg(){void fa.a.resolve(ha.Kc,{Oa:this.$a}).then(()=>{L.TaskExtensions.Aa(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)?Object(ra.d)(fa.a.resolve(ha.dd,{Oa:this.$a})):la.GetServiceTaskFactory.je(this.$.ia,32,33,this.$a),S=>{this.vg([new Ga(S.result.RYj)])},this.$.ma)})}static la(S){wa.a.dh(392,new Oa(S))}}Object(e.a)(Oa,"SheetDropdownMenuCommandHandlerFactory",wa.a,[]);var eb=a(6),nb=a(87),$a=a(183),oa=a(15),Fa=a(96),X=a(47),va=a(251),xa=a(175),Pa=a(121),Ka=a(353),Bb=a(143),xb=a(12),Ua=a(38);class Jb{constructor(){this.cWe=new Ua.a(!0);this.oRc=0}get Ufd(){return this.oRc}get navigationButtonsDisabled(){return!!(this.Ufd&
1)}get operationButtonsDisabled(){return!!(this.Ufd&2)}N4g(S,Ja){this.cWe.add(S,Ja);this.UV()}UV(){this.oRc=0;Ua.a.forEach(this.cWe.Bv,S=>{this.oRc=this.Ufd|S.value})}}Object(e.a)(Jb,"SheetTabBarDisabledStateManager",null,[]);var fc=a(250),ya=a(35);class ob{}ob.nNh="ewa-stb-uir";ob.$Mh="ewa-stb-navarea";ob.aNh="ewa-stb-navarea-dimensions";ob.cNh="ewa-stb-navbutton";ob.C1="cui-disabled";ob.bNh="ewa-stb-navareaextra";ob.Dxa="cui-img-container";ob.UMh="ewa-stb-contentarea";ob.$0e="ewa-stb-left-scrollable";
ob.e1e="ewa-stb-right-scrollable";ob.lNh="ewa-stb-tabarea";ob.kNh="ewa-stb-sheettabmoveindicator";ob.g1e="ewa-stb-tabs";ob.W$j="tab-active";ob.dak="tab-inactive";ob.cak="tab-hover";ob.mNh="ewa-stb-tabs-ghost";ob.Y$j="tab-anchor-text";ob.dark="dark";ob.light="light";ob.X$j="tab-active-text";ob.aak="tab-content-container";ob.fak="tab-text";ob.eNh="ewa-stb-nsv-inactive-svg";ob.dNh="ewa-stb-nsv-active-svg";ob.bMh="ewa_nsv_margin";ob.VMh="ewa-stb-disable-scrollbar";ob.HQi="leave-size-fixed-on-tab-hover-old";
ob.GQi="leave-size-fixed-on-tab-hover";ob.a1e="ewa-stb-locked-sheet-svg-16px";ob.WMh="ewa-stb-dropdown-menu-button";ob.IIh="ewa-active-sheet-menu-item";Object(e.a)(ob,"CssClassNames",null,[]);var Sb=a(820),Ba=a(18),Ia=a(277),cb=a(93),Kb=a(202),db=a(29),gb=a(261),yb=a(48),Nb=a(298),qc=a(54),Gb=a(77),hb=a(283),qb=a(11),ab=a(109),Mb=a(358),Ib=a(20),fb=a(188),Db=a(386),Za=a(379),sb=a(46),sa=a(235),ba=a(92);class ua extends fc.a{constructor(S,Ja,rb){rb=void 0===rb?!1:rb;super(S);this.agb=this.Qwa=null;
this.$=Ja;this.d0=rb}get disabled(){return this.d0}dispose(){this.agb=this.Qwa=this.$=null;super.dispose()}OV(S){this.d0=S;this.domElement.setAttribute(eb.a.TKa,S.toString());T.DOMElementExtensions.toggleCssClass(this.domElement,Sb.a.C1,S)}}Object(e.a)(ua,"SheetBarButton",fc.a,[]);var R=a(750);class Y extends ua{constructor(S,Ja,rb,ma){ma=void 0===ma?!1:ma;super(document.createElement("a"),Ja,ma);this.Of=ib=>{this.disabled||this.$.rf(-1935155518,ib.de,30,null);return!0};this.LLd=ib=>{ib="mouseover"===
ib.type||"focus"===ib.type;const Qb=Db.a(this.$)?this.agb:this.Qwa;qb.HelperMethods.zqg(Qb,Y.wla,Y.wla+eb.a.cvd,ib&&!Ib.h(this.$).inRangePicker)};this.sj=()=>{this.OV(!0)};this.rj=()=>{Ib.h(this.$).cellTextEditBox.Kd||this.OV(!1)};this.Qwa=rb.Ld(this.domElement,xb.a.instance.ha(509),0,Y.wla,xb.a.instance.ha(510),R.a.hbd,ma);S.appendChild(this.domElement);this.uf.la("contextmenu",ib=>{Gb.g(ib)});sa.a.instance.va(oa.a.click,this.domElement,this.Of);this.kpa=Pa.KeyInputManager.instance.lO(this.domElement,
this.Of,ba.a.tn,ba.a.p5);Ib.h(this.$).cellTextEditBox.Yp(this.sj);Ib.h(this.$).cellTextEditBox.Nka(this.rj)}dispose(){sa.a.instance.Ca(oa.a.click,this.domElement,this.Of);Pa.KeyInputManager.instance.ZR(this.domElement,this.kpa);Ib.h(this.$)&&Ib.h(this.$).cellTextEditBox&&(Ib.h(this.$).cellTextEditBox.Qp(this.sj),Ib.h(this.$).cellTextEditBox.DVa(this.rj));super.dispose()}OV(S){const Ja=Y.cig(this.$);super.OV(S||Ja)}static cig(S){return!S.isEditMode||!S.ta.count}}Y.wla=Ba.a.$id;Object(e.a)(Y,"InsertSheetButton",
ua,[]);class La extends ua{constructor(S,Ja,rb){super(document.createElement("a"),Ja);this.Of=ma=>{this.$.rf(-684145703,ma.de,0,null);return!0};this.LLd=ma=>{qb.HelperMethods.zqg(this.lIe,La.wla,La.wla+eb.a.cvd,("mouseover"===ma.type||"focus"===ma.type)&&!Ib.h(this.$).inRangePicker)};this.$=Ja;this.lIe=rb.Ld(this.domElement,xb.a.instance.ha(511),0,La.wla,xb.a.instance.ha(512),R.a.hbd);S.appendChild(this.domElement);this.uf.la("contextmenu",ma=>{Gb.g(ma)});this.uf.la("mouseover",this.LLd);this.uf.la("mouseout",
this.LLd);sa.a.instance.va(oa.a.click,this.domElement,this.Of);this.kpa=Pa.KeyInputManager.instance.lO(this.domElement,this.Of,ba.a.tn,ba.a.p5)}dispose(){sa.a.instance.Ca(oa.a.click,this.domElement,this.Of);Pa.KeyInputManager.instance.ZR(this.domElement,this.kpa);this.lIe=null;super.dispose()}}La.wla=Ba.a.$id;Object(e.a)(La,"InsertTemplateButton",ua,[]);class Ma{constructor(S,Ja){this.sheetName=null;this.newSheetIndex=0;this.sheetName=S;this.newSheetIndex=Ja}getSheetName(){return this.sheetName}}
Object(e.a)(Ma,"MacroRecorderSheetReorderedPayload",null,[129]);var lb=a(91);class pb extends fc.a{constructor(S,Ja){super(document.createElement("div"));this.dV=()=>{k.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.i7f(!1,"OnSheetsChanged")};this.p8i=()=>{this.Zk()};this.o8i=()=>{this.Hk()};this.$=S;this.Fak=Ja;this.dY=!1;this.FVb=0}dispose(){this.Hk();super.dispose()}udk(){this.i7f(!0,"TogglerSheetDropdownMenu")}i7f(S,Ja){k.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${Ja}, toggle: ${S}, toggleStateId: ${this.FVb}`);
S&&(this.FVb+=1);const rb=this.$.pe.xf("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${Ja}, toggle: ${S}, toggleStateId: ${this.FVb}, sheetCount: ${this.$.ta.count}`);S=this.Guh();appChrome.renderSheetDropdownMenu(this.domElement,this.Fak,S,this.FVb,this.p8i,this.o8i,()=>{rb.stop()},Db.a(this.$))}Guh(){const S=this.$.ta,Ja=[];for(let ma=0;ma<S.count;ma++){var rb=Object(Bb.a)(ab.a,S.getItem(ma));0===rb.lD&&(rb=this.Fuh(rb),Ja.push(rb))}return Ja}Fuh(S){const Ja={};Ja.key=S.name;
Ja.text=S.name;Ja.onClick=this.Huh(S);S.active&&(Ja.className=Db.a(this.$)?"ewa-active-sheet-menu-item-present-mode":ob.IIh);return Ja}Huh(S){return()=>{const Ja=new lb.a(-1876836819,0,this.$.Ie,30,null);this.$.Ga.Sd(Ja,{[eb.a.T0d]:S.name})}}Zk(){if(!this.dY){const S=this.$.ta;S.zj(this.dV);S.Z3c(this.dV);S.V0(this.dV);S.Oka(this.dV);S.Pka(this.dV);S.AAe(this.dV);S.X2a(this.dV);this.dY=!0}}Hk(){if(this.dY){const S=this.$.ta;S.dk(this.dV);S.VTd(this.dV);S.Z$(this.dV);S.jra(this.dV);S.kra(this.dV);
S.j6f(this.dV);S.fQb(this.dV);this.dY=!1}}}Object(e.a)(pb,"SheetDropdownMenu",fc.a,[847,5]);var Vb=a(331);class Wa extends ua{constructor(S,Ja,rb){super(document.createElement("a"),S,!0);this.ei=()=>{this.OV(!1);this.$.ea.to(this.ei)};this.Of=ma=>{this.Aqg(ma.de);return!0};this.onKeyDown=ma=>13===ma.Da.keyCode||32===ma.Da.keyCode?(this.Aqg(ma.de),!0):!1;this.Qwa=Ja.Ld(this.domElement,xb.a.instance.ha(513),0,Ba.a.TMh,xb.a.instance.ha(513),R.a.Zmi,this.disabled);this.domElement.classList.add(ob.WMh);
rb.appendChild(this.domElement);this.hGh();this.Cyj()}dispose(){this.Bik();super.dispose()}OV(S){super.OV(S||!this.$.ea.CAa)}hGh(){const S=this.$.ea;S.Gh?this.OV(!1):S.el(this.ei)}Aqg(S){this.disabled||(k.ULS.sendTraceTag(537153793,0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${Vb.a[S]}`),this.$.Ga.Sd(new lb.a(1243860697,S,this.$.Ie,30,null)))}Cyj(){sa.a.instance.va(oa.a.click,this.domElement,this.Of);Pa.KeyInputManager.instance.va(oa.a.Ne,this.domElement,this.onKeyDown)}Bik(){sa.a.instance.Ca(oa.a.click,
this.domElement,this.Of);Pa.KeyInputManager.instance.Ca(oa.a.Ne,this.domElement,this.onKeyDown)}}Object(e.a)(Wa,"SheetDropdownMenuAnchor",ua,[]);var ka=a(58),Sa=a(190),Xb=a(144),Mc=a(198),jc=a(145),$c=a(59),Jd=a(221),fd=a(211),Kd=a(185),Yd=a(146);class te{constructor(S){this.sheet=S;this.altText=xb.a.instance.ha(1994)}IN(){return this.sheet.active}ozd(){return this.sheet.isLockPausedInSession}Bsa(){return this.sheet.yk?R.a.F_f:R.a.nik}f5d(){return 16}Ywa(){return null}Zwa(){return ob.a1e}L6d(){return null}Lu(){return null}N5c(){return!0}}
Object(e.a)(te,"LockPausedSheetIconDataSource",null,[833]);class ve{constructor(S){this.sheet=S;this.altText=xb.a.instance.ha(1993)}IN(){return this.sheet.active}ozd(){return this.sheet.yk}Bsa(){return R.a.F_f}f5d(){return 16}Ywa(){return null}Zwa(){return ob.a1e}L6d(){return null}Lu(){return null}N5c(){return!0}}Object(e.a)(ve,"LockedSheetIconDataSource",null,[833]);class qe{constructor(S,Ja,rb){this.sheet=S;this.altText=xb.a.instance.ha(1908);this.Ldk=Ja;this.H1j=rb}IN(){return this.sheet.active}ozd(){return this.sheet.Ag.yv}Ywa(){return this.IN()?
ob.dNh:ob.eNh}Bsa(){return!this.IN()&&this.H1j()?R.a.bZj:R.a.aZj}f5d(){return 14}Zwa(){return ob.bMh}L6d(){return this.sheet.Ag.Jsb}Lu(){return this.Ldk}N5c(){return!1}}Object(e.a)(qe,"NamedSeetViewSheetIconDataSource",null,[833]);var pc=a(180),nd=a(150);class qd{constructor(S,Ja){this.AWc=this.P5=this.oFa=this.tu=null;this.Tuf=!1;this.j0c=this.Bsa=this.Zwa=this.Ywa=null;this.XQ=()=>{this.dataSource.IN()&&L.TaskExtensions.Aa(this.OAf,()=>{dialogControls.renderToolTip(this.dataSource.Lu(),"SheetIconTooltip",
this.dataSource.L6d(),this.LV,10,!1,!1,1)},this.$.ma,3)};this.WQ=()=>{this.dataSource.IN()&&this.clearToolTip()};this.$=S;this.dataSource=Ja}get uf(){return this.P5||(this.P5=nd.a.instance.Lg(this.LV))}get OAf(){if(this.AWc)return this.AWc;const S=new pc.a;this.$.LK(Ja=>{L.TaskExtensions.Aa(Ja.yAf(),()=>{S.setResult(!0)},this.$.ma,3)});return this.AWc=S.task}get LV(){return this.j0c}kvg(){if(this.LV&&(this.tu||this.oFa)){var S=this.dataSource.Bsa();this.Bsa!==S&&(this.oFa&&this.oFa.parentNode.removeChild(this.oFa),
this.Oof(),this.Bsa=S);S=this.dataSource.Ywa();this.Ywa!==S&&(this.lGj(this.oFa,this.Ywa,S),this.Ywa=S);S=this.dataSource.Zwa();this.Zwa!==S&&(this.kGj(this.LV,this.Zwa,S),this.Zwa=S);this.dataSource.Lu()&&!this.dataSource.IN()&&this.clearToolTip()}}f3j(S,Ja,rb){this.Dyi(S,Ja,rb);T.DOMElementExtensions.setVisible(this.LV,this.dataSource.ozd())}clearToolTip(){L.TaskExtensions.Aa(this.OAf,()=>{dialogControls.clearToolTip(this.dataSource.Lu())},this.$.ma,3)}Dyi(S,Ja,rb){this.LV&&this.Tuf!==S&&(this.LV.parentNode.removeChild(this.LV),
this.Zwa=this.Ywa=this.Bsa=this.j0c=null,this.dataSource.Lu()&&(this.uf.detach("mouseover",!0),this.uf.detach("mouseout",!0)));this.LV||(this.j0c=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.LV,Sb.a.Dxa),Sys.UI.DomElement.addCssClass(this.LV,Ba.a.MM),S===this.dataSource.N5c()?Ja.appendChild(this.LV):Ja.insertBefore(this.LV,rb),this.Oof(),this.dataSource.Lu()&&(this.uf.la("mouseover",this.XQ,!0),this.uf.la("mouseout",this.WQ,!0)),this.Tuf=S)}lGj(S,Ja,rb){S&&(Sys.UI.DomElement.removeCssClass(S,
Ja),Sys.UI.DomElement.addCssClass(S,rb))}kGj(S,Ja,rb){Ja&&Sys.UI.DomElement.removeCssClass(S,Ja);rb&&Sys.UI.DomElement.addCssClass(S,rb)}dispose(){Fa.a.Ma(this.P5)}Oof(){const S=this.$.ia.Ja(388);S?(this.oFa=S.APa(this.dataSource.Bsa(),this.dataSource.f5d()))?this.LV.appendChild(this.oFa):k.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.Bsa()} was not found.`):k.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}
Object(e.a)(qd,"SheetIcon",null,[5]);var tb=a(363),Dc=a(100),Tc=a(186);class ub extends Dc.a{constructor(S,Ja){super(S.domElement);this.onKeyDown=rb=>{121===rb.keyCode&&rb.shiftKey&&!this.fsa.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.fsa.anchor),Gb.g(rb))};this.sga=rb=>{if(!this.$.isEditMode||this.fsa.disabled)return!0;this.rename(!1,rb.de);return!0};this.Ho=rb=>this.fsa.disabled?!0:this.showContextMenu(rb.clientPoint,rb.de,rb.Be);this.Dte=S;this.$=Ja;sa.a.instance.va(oa.a.Pm,S.domElement,
this.sga);tb.a.instance.va(S.domElement,this.Ho);this.uf.la("keydown",this.onKeyDown)}get fsa(){return this.Dte}dispose(){this.fsa&&(sa.a.instance.Ca(oa.a.Pm,this.fsa.domElement,this.sga),tb.a.instance.Ca(this.fsa.domElement,this.Ho),this.Dte=null);this.$=null;super.dispose()}showContextMenu(S,Ja,rb){this.fsa.activate(Ja,db.a.Dwf());Ja=new lb.a(-1075099431,Ja,this.$.Ie,30,null);let ma;return!Tc.a(ma=this.$.Ga.Sd(Ja,{[eb.a.yhg]:S,[ub.SYj]:this.fsa.sheet,[eb.a.zhg]:rb}))&&(6!==ma.status||ma.result)}rename(S,
Ja){this.$.rf(817296323,Ja,S?19:0,null)}}ub.SYj="Sheet";Object(e.a)(ub,"SheetOpsSheetClickHelper",Dc.a,[]);var Pb=a(57);class ee extends ua{constructor(S,Ja,rb,ma,ib){super(document.createElement("li"),S);this.PYj=100;this.QYj=500;this.jNe=this.iNe=0;this.lTe=.5;this.dY=this.R0d=!1;this.color=this.bRc=this.SM=this.hLb=this.QR=null;this.lqc=this.Itf=!1;this.Acc="#BEBBB8";this.xOc=null;this.onKeyDown=Qb=>13!==Qb.Da.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.RC=Qb=>32!==Qb.Da.charCode||
this.disabled?!1:(this.activateSheet(1),!0);this.XQ=()=>{this.disabled||this.cJ.BU||this.Yra(!0,void 0,"OnMouseOver")};this.WQ=()=>{this.disabled||this.Yra(!1,void 0,"OnMouseOut")};this.HMb=()=>{this.cJ.BU||(this.W7j(),Object(Pb.d)(this.sheet.sheetProcessedData)||Ib.h(this.$).rra(this.sheet.sheetName,"sheetTabButton.onMouseEnter"));return!1};this.p$=()=>{this.jZe(!1);return!1};this.Of=Qb=>{if(this.disabled)return!0;const Fc=Ib.h(this.$);this.sheet.active||3!==Qb.de||!db.a.QRa()&&!this.oIb||Fc.Kd||
Fc.Al||Fc.Yyb();this.activateSheet(Qb.de);return 3!==Qb.de};this.onPointerDown=Qb=>{if(this.disabled)return!0;this.jZe(!0);Ib.h(this.$).inRangePicker&&k.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var Fc=3===Qb.de;if(2===Qb.de||Fc&&this.gBa)this.Yra(!0,!Fc,"OnPointerDown"),Fc=Ca.Task.delay(Fc?this.QYj:this.PYj).hv(()=>!0),this.IHb&&(this.lqc=!0,this.cJ.ACc=L.TaskExtensions.Aa(Fc,()=>{this.lqc&&this.cJ.qgj(this,
Qb)},this.ma,11));return!1};this.Mj=Qb=>{if(this.disabled||!this.IHb&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;this.lqc=!1;this.Yra(2===Qb.de,void 0,"OnPointerUp");this.cJ.ACc&&(L.TaskExtensions.Aa(this.cJ.ACc,()=>{this.cJ.pgj()},this.ma,11),this.cJ.ACc=null);return!1};this.bR=()=>{this.lqc=!1;this.R0d||this.Yra(!1,void 0,"OnTouchMove");return!1};this.oMe=new ub(this,S);this.oIb=db.a.oIb();this.iNe=18;this.jNe=20;this.$=S;this.E3b=ma;this.cJ=
ib;this.IHb=ib.uCe();this.Ruh();this.Voh();this.bvd=S.pe.Fi("UserAction",this.name);this.nzd=!1;T.DOMElementExtensions.KB(this.domElement,eb.a.iu,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.SM);this.esa=new Mc.a;S=new ve(this.sheet);this.esa.add(new qd(this.$,S));this.$.ea.nTb&&(S=new te(this.sheet),this.esa.add(new qd(this.$,S)));S=new qe(this.sheet,this.cJ.cGc,()=>this.color?ee.$1d(this.color):!1);this.hLb=new qd(this.$,S);this.esa.add(this.hLb);this.gBa=this.cJ.gBa;
this.xlb();this.aAj();this.sHe=new Nb.a(this.domElement,1);Ja.insertBefore(this.domElement,rb);Db.a(this.$)&&this.dwg(!0)}get lyh(){return this.bRc||(this.bRc=fd.a.Hq("#F5F5F5"))}get name(){return this.QR.innerText}set name(S){this.QR&&(this.QR.innerText=S,this.SKc(),this.ewg())}get sheet(){return this.E3b}get anchor(){return this.xOc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(S){this.anchor.tabIndex=S}$8h(){return T.DOMElementExtensions.uk(this.anchor)?this.anchor:null}dispose(){if(this.dY){va.a.instance.Ca(oa.a.Cf,
this.domElement,this.onPointerDown);Pa.KeyInputManager.instance.Ca(oa.a.Ne,this.domElement,this.onKeyDown);Pa.KeyInputManager.instance.Ca(oa.a.lr,this.domElement,this.RC);sa.a.instance.Ca(oa.a.click,this.domElement,this.Of);va.a.instance.Ca(oa.a.FZ,this.domElement,this.HMb);va.a.instance.Ca(oa.a.CE,this.domElement,this.p$);if(this.IHb||J.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))va.a.instance.Ca(oa.a.tj,this.domElement,this.Mj),this.gBa&&(xa.a.instance.Ca(oa.a.Wg,
this.domElement,this.Mj),xa.a.instance.Ca(oa.a.wj,this.domElement,this.bR));this.dY=!1;this.Acc="#BEBBB8"}Fa.a.df([this.oMe,this.sHe]);this.QR=this.SM=this.xOc=this.cJ=this.sHe=this.oMe=null;if(this.esa){for(let S of this.esa)S.dispose();this.esa=null}this.color=this.E3b=null;super.dispose()}OV(S){S&&this.Yra(!1,!1);super.OV(S)}gkg(S){$c.a.Ji.zU&&(this.jWe(),void fa.a.resolve(ha.dc,{Oa:1}).then(Ja=>{Sa.UISurfaces.KK().then(rb=>{Ja.SUj(rb);Ja.show(S);return null},rb=>{k.ULS.sendTraceTag(537153688,
0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${rb}`);return null})}))}qXg(){if(this.sheet.active&&this.$.vs){var S=this.$.vs,Ja=Ib.h(this.$),rb=Ja.Fk;if(this.sheet.Ag.yv){if(!this.hLb){const ma=new qe(this.sheet,this.cJ.cGc,()=>this.color?ee.$1d(this.color):!1);this.hLb=new qd(this.$,ma);this.esa.add(this.hLb)}rb&&Ja.mlb(1);S.classList.add(Ba.a.k3e);S=ee.tdf(eb.a.sHf);Ja=ee.tdf(eb.a.oId);"true"===S&&"true"===Ja?this.$.ea.Q1d&&this.$.ea.HTb&&(this.sheet.Ag.fL?
(S=1,Xb.a.Yx(eb.a.oId,"false",Xb.a.lZ),this.$.ea.HTb=!1):S=0,Xb.a.Yx(eb.a.sHf,"false",Xb.a.lZ),this.$.ea.Q1d=!1,this.gkg(S)):this.sheet.Ag.fL&&"true"===Ja&&this.$.ea.HTb&&(Xb.a.Yx(eb.a.oId,"false",Xb.a.lZ),this.$.ea.HTb=!1,this.gkg(2))}else this.jWe(),rb&&Ja.mlb(0),S.classList.remove(Ba.a.k3e)}}jWe(){const S=fa.a.rg(ha.dc);S&&S.dismiss()}xlb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.pbb()?ob.W$j:ob.dak;J.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?
this.QR.parentNode.classList.add(ob.GQi):this.QR.parentNode.classList.add(ob.HQi);this.ewg();this.g3j();this.kwg();this.SKc();this.qXg()}ogj(){this.R0d=!0;this.Yra(!0,!0,"OnSheetReorderStarted")}ngj(){this.R0d=!1;this.Yra(!1,void 0,"OnSheetReorderEnded")}activate(S,Ja){S=void 0===S?0:S;Ja=void 0===Ja?!1:Ja;this.w$b()||(this.sheet.activate({scenario:"switchSheet"}),Ja&&Ib.h(this.$).focus(),S={["InputMethod"]:Vb.a[S],["AppMode"]:this.$.Ie,["Location"]:"canvas"},Yd.b(this.$).Lf(jc.a.MYj,S))}dwg(S){this.Acc=
S?"#797775":"#BEBBB8";this.lTe=S?-.5:.5;this.bRc=S?fd.a.Hq("#3B3A39"):fd.a.Hq("#F5F5F5");this.kwg()}pRj(S){this.IHb=S}JKd(S){S.ybd();this.BKe(S)}BKe(S){S.D5a();this.sheet.activate({scenario:"switchSheet"})}pUg(S){S=new lb.a(-1876836819,S,this.$.Ie,30,null);return this.$.Ga.Sd(S,{[eb.a.T0d]:this.sheet.name})}ewg(){this.QR.parentNode.setAttribute("sheet-title",this.QR.innerText)}SKc(){const S=this.p2h();this.anchor.setAttribute(eb.a.nx,S);this.anchor.setAttribute(eb.a.$ca,this.sheet.active.toString())}p2h(){const S=
this.sheet.Ag.yv,Ja=this.sheet.Ag.Jsb,rb=this.sheet.yk,ma=this.sheet.isLockPausedInSession;return S&&rb?String.format(xb.a.instance.Qd(20),this.name,Ja):S&&ma?String.format(xb.a.instance.Qd(22),this.name,Ja):S?String.format(xb.a.instance.Qd(19),this.name,Ja):rb?String.format(xb.a.instance.Qd(18),this.name):ma?String.format(xb.a.instance.Qd(21),this.name):this.name}activateSheet(S){S=void 0===S?0:S;if(db.a.Dwf()){if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.w$b())return Ca.Task.Ua(!1);Kd.a.current.xR="ActivateSheet";Ib.h(this.$).Nlb.navigationStart("SwitchSheet");this.sheet.activate({scenario:"switchSheet"});return Ca.Task.Ua(!0)}return this.pUg(S)}kwg(){const S=this.sheet.tabColor;this.color=S?fd.a.Hq(S):this.lyh;this.Itf=ee.$1d(this.color);this.Yra(!1,void 0,"UpdateTabColor")}Yra(S,Ja,rb){Ja=void 0===Ja?!1:Ja;rb=void 0===rb?null:rb;if(this.sheet){rb=this.sheet.active;var ma=this.pbb(),ib=!!this.sheet.tabColor,Qb=fd.a.$L(rb||ma?Jd.a.Rlb:this.color);
this.SM.style.background="";rb||ma?(ib&&(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.aQa?this.KWj():this.JWj()),this.SM.style.height=this.iNe.toString()+"px"):(this.SM.style.filter="",this.SM.style.backgroundColor=Qb,this.SM.style.height=this.jNe.toString()+"px");this.QR.className=rb?ob.X$j:ma?ob.dark:this.Itf?ob.light:ob.dark;for(let Fc of this.esa)Fc.kvg();S&&!ib&&(this.SM.style.backgroundColor="#E1DFDD");T.DOMElementExtensions.toggleCssClass(this.domElement,
ob.cak,S);Ja?(ib||(this.SM.style.backgroundColor=this.Acc),this.domElement.style.backgroundColor=this.Acc):(ib||(this.SM.style.backgroundColor=""),this.domElement.style.backgroundColor="");this.QR.style.fontWeight=rb||ma?"600":""}else k.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${rb}`)}JWj(){const S=this.SM.style,Ja=fd.a.$L(ee.Ifh(this.color,this.lTe));S.background=Ja}KWj(){this.SM.style.background=
"transparent"}Voh(){this.xOc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=ob.Y$j;T.DOMElementExtensions.KB(this.anchor,eb.a.wub,null,null);this.tabIndex=-1}Ruh(){this.SM=document.createElement("span");this.SM.className=ob.aak;this.QR=document.createElement("span");this.QR.className=ob.fak;this.QR.dir=this.sheet.rtlName?"rtl":"ltr";this.SM.appendChild(this.QR)}g3j(){const S=this.$.uP;for(let Ja of this.esa)Ja.f3j(S,this.SM,this.QR)}pbb(){return Ib.h(this.$).pbb(this.sheet)}W7j(){this.bvd.start();
this.nzd=!0}jZe(S){this.nzd&&(this.bvd.stop(),k.ULS.sendTraceTag(537153686,0,50,m.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.bvd.pf,["Has been clicked"]:S})),this.nzd=!1)}aAj(){va.a.instance.va(oa.a.Cf,this.domElement,this.onPointerDown);Pa.KeyInputManager.instance.va(oa.a.Ne,this.domElement,this.onKeyDown);Pa.KeyInputManager.instance.va(oa.a.lr,this.domElement,this.RC);this.uf.la("mouseover",this.XQ);this.uf.la("mouseout",this.WQ);va.a.instance.va(oa.a.FZ,
this.domElement,this.HMb);va.a.instance.va(oa.a.CE,this.domElement,this.p$);if(this.IHb||J.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))va.a.instance.va(oa.a.tj,this.domElement,this.Mj),this.gBa&&(xa.a.instance.va(oa.a.Wg,this.domElement,this.Mj),xa.a.instance.va(oa.a.wj,this.domElement,this.bR));sa.a.instance.va(oa.a.click,this.domElement,this.Of);this.dY=!0}w$b(){const S=this.$.ia.Ja(65);return S&&S.Hoa()?(S.ODc(),this.BKe(S),!0):!1}static tdf(S){let Ja=Xb.a.get(S);
Ja||(Xb.a.Yx(S,"true",Xb.a.lZ),Ja=Xb.a.get(S));return Ja}static Ifh(S,Ja){if(1<Ja||-1>Ja)return S;let rb=S.r,ma=S.g;S=S.b;0<Ja?(rb=rb*(1-Ja)+255*Ja,ma=ma*(1-Ja)+255*Ja,S=S*(1-Ja)+255*Ja):(rb*=1+Ja,ma*=1+Ja,S*=1+Ja);return Jd.a.xBb(Math.round(rb),Math.round(ma),Math.round(S))}static $1d(S){return 128>=(222*S.r+707*S.g+71*S.b)/1E3}}Object(e.a)(ee,"SheetTabButton",ua,[]);class Ad extends ua{constructor(S,Ja,rb){super(document.createElement("a"),Ja);this.wla=Ba.a.$id;rb.Ld(this.domElement,xb.a.instance.ha(713),
0,this.wla,xb.a.instance.ha(713),R.a.hbd,!0);S.appendChild(this.domElement);this.uf.la("contextmenu",ma=>{Gb.g(ma)})}}Object(e.a)(Ad,"WorkbookProtectionButton",ua,[]);var Ub=a(55),tc=a(53),yc=a(66);class Sd extends fc.a{constructor(S,Ja,rb){rb=void 0===rb?null:rb;super(Ja);this.sheetTabActivatePreviousHidden=xb.a.instance.ha(722);this.sheetTabActivateNextHidden=xb.a.instance.ha(724);this.svgIconProvider=null;this.fk=[];this.HQ=Array(6);this.wId=Array(6);this.fXa=this.yFb=this.oU=this.gjb=this.Z0d=
this.Y0d=this.kp=null;this.isRtl=!1;this.cZ=this.tC=0;this.rec=this.zCc=!1;this.lzc=this.Fra=0;this.SP=this.T7=this.$da=this.Aec=null;this.dlc=this.iG=0;this.$Ub=null;this.NIb=-1;this.H7=null;this.qyc=0;this.WHc=-1;this.Tqa=0;this.bya=new Jb;this.pVc=!1;this.ACc=this.ijb=this.hjb=this.Bte=this.K3=null;this.wle=!1;this.Ate=null;this.Nnf=()=>{this.Tvd();this.$.uo(this.Nnf)};this.DG=(ma,ib)=>{this.tTf(ib.item)};this.cV=(ma,ib)=>{ma=this.$.ta.pa.index;for(let Qb=0,Fc=this.fk.length;Qb<Fc;Qb++){const jd=
this.wY(Qb);if(jd.name===ib.oldName){jd.name=ib.newName;this.m4();Qb===ma&&this.Dha(6);break}}};this.xTf=(ma,ib)=>{(ma=this.LAb(ib.item))&&ma.xlb()};this.yTf=(ma,ib)=>{ib.visible?(this.aXa(!1),this.uTf(ib.item)):this.tTf(ib.item)};this.cqa=ma=>{this.BU?(this.H7=ma,this.pWb()):(this.H7&&(this.lzc+=this.H7.clientPoint.x-ma.clientPoint.x),this.H7=ma,Math.abs(this.lzc)>=this.PDh&&this.pWb());return!0};this.bR=ma=>{ma.Da.preventDefault();return!1};this.Wbg=ma=>{this.Tbg(ma,!0)};this.Vbg=ma=>{this.Tbg(ma,
!1)};this.dqa=ma=>{if(this.BU){this.rec=this.rFi(ma);let ib;ma=(ib=this.wY(this.iG+1))?ib.sheet:null;this.reorderSheets(ma,this.iG+1===this.W0d,!0)}this.YX();return!0};this.Em=(ma,ib)=>{ib.ZC&&this.E9d(ib.ZC);this.iFc(!1);this.m4();ib.pa&&(this.E9d(ib.pa),this.Dha(6),this.ea.wqa())};this.NJf=(ma,ib)=>{this.ILc(ib.item)};this.OJf=(ma,ib)=>{this.ILc(ib.item)};this.PJf=(ma,ib)=>{this.ILc(ib.item)};this.zTa=(ma,ib)=>{this.ILc(ib.item)};this.GCa=()=>{this.V$c()};this.fg=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;
this.V$c();this.Qdd();if(yc.d(this.$)||yc.e(this.$))tc.a.instance.eaa(eb.a.Baa,["sheetTabBar"]),tc.a.instance.daa(eb.a.Baa,["sheetTabBar"]);this.vdd();this.m4();this.aXa(!0);this.Dha(6)};this.ml=()=>{this.isVisible&&(this.m4(),this.Dha(6))};this.gi=()=>{Object(Ka.a)(Y,this.oU)===cb.m(this.$.ih)&&this.vdd();for(const ma of this.fk)ma.pRj(!cb.m(this.$.ih))};this.wTf=(ma,ib)=>{this.bGj(ib.item,ib.isUserOperation)};this.WMb=(ma,ib)=>{this.uTf(ib.item)};this.onKeyDown=ma=>{switch(ma.keyCode){case 9:var ib=
this.domElement.querySelectorAll(T.DOMElementExtensions.hE);const Qb=T.DOMElementExtensions.zy(ib);ib=T.DOMElementExtensions.v2(ib);T.DOMElementExtensions.QWa(ma,Qb,ib);break;case 39:case 37:T.DOMElementExtensions.Seg(ma,this.domElement.querySelectorAll(T.DOMElementExtensions.hE),39===ma.keyCode?!this.isRtl:this.isRtl)}k.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${ma.keyCode}`)};this.rZ=()=>{this.kp.scrollLeft!==this.Fra&&this.Gbk()};this.ZQ=ma=>{if(ma.ctrlKey||ma.t7)return!1;
this.kp.scrollLeft+=Math.floor(30*ma.ota);if(this.BU){const ib=this.Hbf("OnMouseWheel");ib&&this.i5d(0<ma.ota,ib.x+ib.width/2)}return!0};this.$Q=(ma,ib)=>{if(this.bya)this.Ojf("PartialInteractivity",ib.HS?3:0);else{this.YX(!1);this.B_d(ib.HS);for(const Qb of this.qGe)Qb&&Qb.OV(ib.HS);for(const Qb of this.fk)Qb&&Qb.OV(ib.HS)}};this.iMb=(ma,ib)=>{ma=0;ib.vxe&&(ma=2|(ib.TYj?1:0));this.Ojf("ComponentRangePicker",ma)};this.$=S;this.svgIconProvider=rb;J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetTabBarEarlyLoad",
!1)?null!==this.$.ta?this.Tvd():this.$.zn(this.Nnf):this.Tvd()}Tvd(){this.ea=this.$.ea;this.Hec=!J.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.jwf=!this.$.Mx;this.wle=!y.a.qG;this.lHi=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InSheetTemplates",!1);this.N0i=this.$.xa.SheetTabNavigateButtonLongKeyPressPeriodMS;this.M0i=this.$.xa.SheetTabNavigateButtonIntervalPeriodMS;this.PDh=this.$.xa.SheetTabDragStartPixelThreshold;
this.sUa=this.tUa=-1;this.Ybd=!1;this.CF=new Nb.a(this.domElement,3);this.domElement.classList.add(ob.nNh);this.Gsh();this.hqh();this.Hsh();document.getElementById(eb.a.Rea)||this.Kth();this.iFc(!0);this.fg(null,null);const S=this.$.ta;S.zj(this.Em);S.Z3c(this.GCa);S.V0(this.DG);S.Oka(this.WMb);S.Pka(this.cV);S.AAe(this.wTf);S.X2a(this.yTf);S.v_g(this.xTf);S.n4c(this.NJf);S.xAe(this.OJf);S.yAe(this.PJf);S.zAe(this.zTa);this.$.zn(this.fg);this.$.cC(this.ml);Ia.a(this.$).um(this);J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",
!1)||this.$.ia.Va(32,this);J.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.kx(this.gi);this.eGc=this.Vg.Lg(this.domElement);this.eGc.la("keydown",this.onKeyDown);sb.a(this.$).Wr()&&this.$Q(null,new Za.a(!0));sb.a(this.$).Pi.Rka(this.$Q);Ib.h(this.$).Wze(this.iMb);this.eGc.la("mousedown",Ja=>{Ja.preventDefault()});$a.a.instance.va(oa.a.yG,this.domElement,this.ZQ);this.X0d=this.Vg.Lg(this.kp);this.X0d.la("scroll",this.rZ);this.Gbk=hb.b(()=>{this.m4()},
200,this.$.ma,yb.a.ZYj,!0);this.$.kI(eb.a.x5j);this.jwf&&(this.Ate=new pb(this.$,this.fXa.domElement));tc.a.instance.rha(eb.a.Baa,["sheetTabBar"])}get Df(){return this.domElement}get uk(){return this.isVisible}get Zg(){return gb.a.V0d}get BU(){return this.pVc}get W0d(){return this.fk.length}get cGc(){return this.Bte}get gBa(){return this.wle}get navigationButtonsDisabled(){return!!this.bya&&this.bya.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.bya&&this.bya.operationButtonsDisabled}get Z0i(){return this.$.uP?
[Ba.a.Z0e,Ba.a.c1e,Ba.a.d1e,Ba.a.Y0e,Ba.a.Jfc,Ba.a.Jfc]:[Ba.a.Y0e,Ba.a.d1e,Ba.a.c1e,Ba.a.Z0e,Ba.a.Jfc,Ba.a.Jfc]}get xId(){return this.$.uP?[null,R.a.UNe,R.a.SNe]:[null,R.a.SNe,R.a.UNe]}get YYf(){return this.$.uP?[null,R.a.VNe,R.a.TNe]:[null,R.a.TNe,R.a.VNe]}get pJb(){if(this.isRtl){if(y.a.DC)return 0;if(y.a.Zh)return-1*(this.kp.scrollWidth-this.kp.clientWidth);if(y.a.qG)return this.kp.scrollWidth-this.kp.clientWidth;k.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get iRb(){if(this.isRtl){if(y.a.DC)return this.kp.scrollWidth-
this.kp.clientWidth;if(y.a.Zh||y.a.qG)return 0;k.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.kp.scrollWidth-this.kp.clientWidth}get qGe(){return this.bya?[this.oU,this.yFb]:[this.oU,this.yFb,this.fXa]}get eak(){return this.fk.concat(this.fXa)}get RYj(){return this.Ate}Ld(S,Ja,rb,ma,ib,Qb,Fc){Fc=void 0===Fc?!1:Fc;S.removeAttribute("Href");S.setAttribute(eb.a.pg,eb.a.xA);S.className=ob.cNh;S.title=Ja;S.tabIndex=0;Qb?rb=this.svgIconProvider.ffa(Qb,
12,12,S,24,24):(Ja=document.createElement("span"),Ja.className=Ba.a.xih,Ja.classList.add(Sb.a.Dxa),Ja.tabIndex=-1,S.appendChild(Ja),Qb=document.createElement("img"),Qb.src=qc.a.Bj(rb),Qb.className=ma,Qb.alt=ib,Qb.tabIndex=-1,Ja.appendChild(Qb),rb=Qb);Fc&&S.classList.add(Sb.a.C1);return rb}dispose(){if(this.$){var S=this.$.ta;S.dk(this.Em);S.VTd(this.GCa);S.Z$(this.DG);S.jra(this.WMb);S.kra(this.cV);S.j6f(this.wTf);S.fQb(this.yTf);S.KDj(this.xTf);S.kUd(this.NJf);S.g6f(this.OJf);S.h6f(this.PJf);S.i6f(this.zTa);
this.$.uo(this.fg);this.$.JE(this.ml);sb.a(this.$)&&sb.a(this.$).Pi.lra(this.$Q);this.bya&&Ib.h(this.$).K5f(this.iMb);$a.a.instance.Ca(oa.a.yG,this.domElement,this.ZQ)}Fa.a.df(this.wId);this.wId=null;if(this.HQ)for(S=0;S<this.HQ.length;S++){const Ja=T.DOMElementExtensions.gI(this.HQ[S],this.domElement,!1,"a");Ja&&X.a.VDa(Ja)}Fa.a.Ma(this.CF);Fa.a.Ma(this.eGc);Fa.a.Ma(this.X0d);this.X0d=this.eGc=this.yFb=this.oU=this.CF=null;this.$&&this.YX(!1);this.$da=null;this.ZZd(null,"Dispose");this.$Ub=this.SP=
this.Aec=null;this.V$c();this.gjb=this.Z0d=this.Y0d=this.kp=this.HQ=this.$=this.ea=null;super.dispose()}nl(S,Ja){if(!Ja){k.ULS.shipAssertTag(537153760,0,0<this.fk.length,"There is no sheet tab button.");if(!this.fk.length)return!1;S=null;for(const rb of this.fk)if(S=rb.$8h())break;if(!S)return k.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;T.DOMElementExtensions.setFocus(S)}return!Ja}Il(S){return T.DOMElementExtensions.Sj(this.Df,S)}Vn(){}ap(){}reorderSheets(S,Ja,rb){if(this.K3&&
this.K3!==S){const ma=this.K3.index;this.aGj(this.K3,S,Ja);S=S?S.index-1:Ja?this.$.ta.count-1:0;ma!==S&&(this.gVi(ma,S,rb),this.TGh(this.K3.name,S))}}ili(S){S=this.Vma(S);return-1!==S&&this.tC<=S&&S<=this.cZ?this.fk[S].domElement:null}cwg(S){for(var Ja=0;Ja<this.HQ.length;Ja++){const rb=this.HQ[Ja];if(rb&&this.svgIconProvider){const ma=rb.parentNode;this.o5f(rb);ma&&(this.HQ[Ja]=this.svgIconProvider.ffa(S?this.YYf[Ja]:this.xId[Ja],12,12,ma,24,24))}}for(Ja=0;Ja<this.fk.length;Ja++)this.fk[Ja].dwg(S);
this.fXa&&this.fXa.Qwa&&this.bwg(R.a.$mi,this.fXa,S);this.oU&&this.oU.Qwa&&this.bwg(R.a.Hkh,this.oU,S)}bwg(S,Ja,rb){Ja.agb||(Ja.agb=this.svgIconProvider.ffa(S,12,12,Ja.Qwa.parentNode,24,24));Ja.agb&&(T.DOMElementExtensions.setVisible(Ja.Qwa,!rb),T.DOMElementExtensions.setVisible(Ja.agb,rb))}qgj(S,Ja){var rb=Ib.h(this.$);const ma=rb.inRangePicker,ib=qb.HelperMethods.qu(Ja);if(rb.Kd&&!ma){const Qb=rb.Ls?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let Fc;Fc=[Object(fb.a)(rb.cellTextEditBox.Ha.xFa)];
fb.b(this.$).OFa(ib.rawEvent,Qb,Fc);rb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}rb=this.gBa&&3===Ja.de;!(2===Ja.de&&ib.button===Sys.UI.MouseButton.leftButton||rb)||ma||this.BU||sb.a(this.$).Wr()||(rb&&S.ogj(),this.NIb=Ja.clientPoint.x,this.H7=Ja,this.s8g(S))}pgj(){this.m4()}uCe(){return this.$.isEditMode&&!cb.m(this.$.ih)}m4(){const S=qb.HelperMethods.VN(()=>{this.Rkk();this.kWj();this.B_d()});k.ULS.sendTraceTag(537153757,0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${S}`)}kWj(){const S=
this.cZ===this.fk.length-1;T.DOMElementExtensions.toggleCssClass(this.gjb,this.$.uP?ob.e1e:ob.$0e,!!this.tC);T.DOMElementExtensions.toggleCssClass(this.gjb,this.$.uP?ob.$0e:ob.e1e,!S)}B_d(S){S=void 0===S?!1:S;const Ja=!this.tC,rb=this.cZ===this.fk.length-1;this.wfg(4,this.sheetTabActivatePreviousHidden,!Ja);this.wfg(5,this.sheetTabActivateNextHidden,!rb);this.yFc(0,Ja||S);this.yFc(1,Ja||S);this.yFc(2,rb||S);this.yFc(3,rb||S)}wfg(S,Ja,rb){if(S=this.HQ[S]){T.DOMElementExtensions.setVisible(S,rb);var ma=
this.xdf(S);ma.title="img"===S.nodeName?S.alt=0<this.fk.length&&rb?Ja:"":S.title=0<this.fk.length&&rb?Ja:"";ma.tabIndex=rb?0:-1}}xdf(S){return S.parentNode}yFc(S,Ja){if(S=this.HQ[S])S=this.xdf(S),void 0!==S&&null!==S&&(!this.fk.length||Ja?(S.classList.add(Sb.a.C1),S.setAttribute(eb.a.TKa,"true")):(S.classList.remove(Sb.a.C1),S.setAttribute(eb.a.TKa,"false")))}aXa(S){const Ja=this.$.uP?this.fk.length-1:0;let rb=this.ggf(this.$.uP?0:this.fk.length-1);rb&&(rb.borderRightWidth=S?"1px":"0");this.tC!==
this.cZ&&(rb=this.ggf(Ja))&&(rb.borderRightWidth="0")}rze(S,Ja){this.fk||(this.fk=[]);-1===Ja?this.fk.push(S):this.fk.splice(Ja,0,S)}Ybc(S,Ja){let rb=-1,ma=null;Ja||(rb=this.vci(S.index),-1!==rb&&(ma=this.yPa(rb)));S=new ee(this.$,this.kp,ma,S,this);this.rze(S,rb);T.DOMElementExtensions.setVisible(S.domElement,!0)}Dha(S){const Ja=qb.HelperMethods.VN(()=>{switch(S){case 0:this.dEc(0);break;case 1:this.dEc(this.tC-1);break;case 2:this.dEc(this.tC+1);break;case 3:this.scrollIntoView(this.fk.length-1);
break;case 4:this.tC&&1<=this.fk.length&&(this.hxe(this.tC-1),this.pYd());break;case 5:this.cZ!==this.fk.length-1&&1<=this.fk.length&&(this.hxe(this.cZ+1),this.pYd());break;case 6:this.pYd()}});this.Hec&&this.BU&&this.pWb();k.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${S}, duration = ${Ja}`)}hxe(S){(S=this.wY(S))&&S.activate()}UVh(S){if(0===S.lD){const Ja=this.$.ta;let rb=0;for(let ma=0,ib=Ja.count;ma<ib;ma++){const Qb=Object(Bb.a)(ab.a,Ja.getItem(ma));if(Qb===
S)return rb;0===Qb.lD&&rb++}}return-1}FVh(S){const Ja=this.$.ta;for(let rb=S.index+1,ma=Ja.count;rb<ma;rb++)if(S=Object(Bb.a)(ab.a,Ja.getItem(rb)),0===S.lD)return S;return null}Vma(S){for(let Ja=0;Ja<this.fk.length;Ja++){const rb=this.wY(Ja);if(!rb)k.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${Ja}] is null even though index is not out of bounds!`);else if(rb.sheet===S)return Ja}return-1}LAb(S){S=this.Vma(S);return this.wY(S)}gVi(S,Ja,rb){const ma=
{};ma.a=this.$.xa.UserSessionId;ma.b=rb;ma.c=this.rec;ma.d=S;ma.e=Ja;ma.f=this.$.ta.count;Ub.b().Ih(2,ma,rb)}aGj(S,Ja,rb){const ma=Object(Bb.a)(Mb.a,this.$.ta);Ja?(Ja=Ja.index,Ja=S.index<Ja?Ja-1:Ja):Ja=rb?ma.count-1:0;ma.reorderSheet(S,Ja,!0)}KTj(S){Ib.h(this.$).Xj.Fu(S)}s8g(S){if(!this.zCc){const Ja=this.domElement.ownerDocument.body;va.a.instance.va(oa.a.Io,document.documentElement,this.cqa);this.gBa&&(xa.a.instance.va(oa.a.wj,document.documentElement,this.cqa),xa.a.instance.va(oa.a.wj,this.domElement,
this.bR));va.a.instance.va(oa.a.tj,document.documentElement,this.dqa);xa.a.instance.va(oa.a.Wg,Ja,this.dqa);this.zCc=!0}this.K3=S.sheet;this.rec=!1;this.SP=null;this.Aec=S;this.$da=S.domElement;this.ZZd(T.DOMElementExtensions.getBoundingClientRect(this.$da),"BeginSheetTabButtonDrag")}YX(S){S=void 0===S?!0:S;if(this.zCc){this.KTj(eb.a.H2);const Ja=this.domElement.ownerDocument.body;va.a.instance.Ca(oa.a.Io,document.documentElement,this.cqa);this.gBa&&(xa.a.instance.Ca(oa.a.wj,document.documentElement,
this.cqa),xa.a.instance.Ca(oa.a.wj,this.domElement,this.bR));va.a.instance.Ca(oa.a.tj,document.documentElement,this.dqa);xa.a.instance.Ca(oa.a.Wg,Ja,this.dqa);this.pVc=this.zCc=!1}this.lzc=0;this.rec=!1;this.K3=null;this.$da&&(this.$da.style.visibility="visible",this.$da=null);this.Aec=null;this.ZZd(null,"EndSheetTabButtonDrag");this.SP&&(this.SP.parentNode&&this.SP.parentNode.removeChild(this.SP),this.SP=null);this.vIj(S)}vIj(S){this.x4d(S);this.iG=this.NIb=-1}TGh(S,Ja){const rb=this.$.qa,ma=rb?
rb.ua:null;this.$.userOperationManager.enqueueOperation(new Kb.a(557,0,(ib,Qb,Fc)=>{const jd=ma.Pa(9,null);jd.sheetName=S;jd.newSheetIndex=Ja;return ka.g(ma,"ReorderSheets",jd,ib,Qb,Fc,null,0)},64,()=>new Ma(S,Ja)),null)}wY(S){return 0<=S&&S<this.fk.length?this.fk[S]:null}Ghi(S){return(S=this.wY(S))?S.sheet:null}yPa(S){return(S=this.wY(S))?S.domElement:null}ggf(S){return(S=this.yPa(S))?S.style:null}vci(S){const Ja=this.$.ta;S+=1;let rb=-1;const ma=this.fk?this.fk.length:0;for(;S<Ja.count;){const ib=
Object(Bb.a)(ab.a,Ja.getItem(S));if(0===ib.lD){for(rb=0;rb<ma&&this.Ghi(rb)!==ib;rb++);break}S++}return-1===rb||rb===ma?-1:rb}tTf(S){var Ja=this.LAb(S);Ja&&(this.BU&&(k.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),J.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.YX()),this.kp.removeChild(Ja.domElement),Ja=Array.indexOf(this.fk,Ja),this.fk.splice(Ja,
1),this.m4(),(!this.isRtl&&Ja===this.fk.length||this.isRtl&&!Ja)&&this.aXa(!0),this.Hec&&this.BU?S===this.K3?(this.YX(),this.Dha(6)):this.pWb():this.Dha(6))}uTf(S){const Ja=Object(Bb.a)(ab.a,S);this.BU&&(k.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),J.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.YX());if(0===Ja.lD){this.aXa(!1);
var rb=this.Vma(S);-1===rb&&(k.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.Ybc(Ja,!1),rb=this.Vma(S));this.Vjf(rb,!0)}}bGj(S,Ja){const rb=this.LAb(S);rb&&(this.BU&&!Ja&&(k.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),J.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.YX()),S=this.R$j(S,rb),!J.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&S&&Ja&&S.ngj())}R$j(S,Ja){var rb=Array.indexOf(this.fk,Ja);const ma=this.UVh(Object(Bb.a)(ab.a,S));if(-1===ma||-1===rb)return null;this.aXa(!1);({zWh:this.tC,HPi:this.cZ}=Sd.YFj(rb,ma,this.tC,this.cZ));Ja&&Ja.domElement.parentNode===this.kp&&(this.kp.removeChild(Ja.domElement),this.fk.splice(rb,1));Ja=this.FVh(S);rb=this.Vma(Ja);Ja=new ee(this.$,this.kp,this.yPa(rb),Object(Bb.a)(ab.a,
S),this);this.rze(Ja,rb);rb=this.Vma(S);this.Vjf(rb,!1);return Ja}HHh(){const S=this.fk?this.fk.length:0,Ja=this.tC,rb=this.cZ;for(let ma=0;ma<S;ma++){const ib=this.wY(ma),Qb=ma>=Ja;ib&&(ib.tabIndex=Qb&&ma<=rb?0:-1)}}Djk(){const S=this.fk?this.fk.length:0;for(let Ja=0;Ja<S;Ja++){const rb=this.wY(Ja);rb&&rb.xlb()}}Vjf(S,Ja){Ja&&S<=this.tC&&this.tC++;this.HHh();this.aXa(!0);this.m4();this.Hec&&this.BU&&this.pWb()}iFc(S){const Ja=this.$.uP;if(S||this.isRtl!==Ja)this.isRtl=Ja,this.domElement.classList.remove(this.isRtl?
Ba.a.b1e:Ba.a.f1e),this.domElement.classList.add(this.isRtl?Ba.a.f1e:Ba.a.b1e),this.domElement.dir=this.isRtl?"rtl":"ltr",this.Djk();S||this.aXa(!0);for(S=0;S<this.HQ.length;S++)0!==S&&3!==S&&4!==S&&5!==S&&this.xfg(S)}Gsh(){const S=this.Y0d=document.createElement("div");S.className=ob.$Mh;S.classList.add(ob.aNh);this.domElement.appendChild(S);this.CRe(S,1,717,716);this.CRe(S,2,719,718);this.jwf&&(this.fXa=new Wa(this.$,this,S))}Hsh(){const S=this.Z0d=document.createElement("div");S.className=ob.bNh;
this.domElement.appendChild(S);this.vdd()}Kth(){const S=document.getElementById(eb.a.NYj),Ja=document.getElementById(eb.a.OYj);S&&!Ja&&k.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${S.parentNode.id}. progressBar div has child: ${!!S.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(eb.a.O0d)}`);const rb=db.a.pwf(this.$);if(rb&&S&&Ja)this.domElement.appendChild(S),this.hjb=S.firstChild,
this.ijb=document.getElementById(eb.a.O0d),Ja.style.visibility="visible";else{const ma=document.createElement("div"),ib=document.createElement("div");ma.className=Ba.a.iNh;ib.className=Ba.a.gNh;ib.id=eb.a.N0d;ib.style.display="none";const Qb=document.createElement("div");Qb.className=Ba.a.jNh;const Fc=document.createElement("div");Fc.className=Ba.a.hNh;const jd=document.createElement("div");jd.className=Ba.a.fNh;ib.appendChild(Qb);ib.appendChild(Fc);ib.appendChild(jd);ma.appendChild(ib);this.domElement.appendChild(ma);
this.hjb=ib;this.ijb=Fc;k.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",rb,S,Ja)}}xfg(S){var Ja=this.HQ[S];if(Ja){const rb=Ja.parentNode;this.o5f(Ja);Ja=Db.a(this.$)?this.YYf[S]:this.xId[S];this.HQ[S]=this.svgIconProvider.ffa(Ja,12,12,rb,24,24)}}o5f(S){(null===S||void 0===S?0:S.parentNode)&&S.parentNode.removeChild(S)}hqh(){const S=
this.gjb=document.createElement("div");S.className=ob.UMh;this.domElement.appendChild(S);this.Iuh(S)}Iuh(S){const Ja=document.createElement("div");Ja.className=ob.lNh;Ja.classList.add(ob.VMh);this.$.printingEnabled||Ja.classList.add(ya.a.d3e);S.appendChild(Ja);this.kp=document.createElement("ul");T.DOMElementExtensions.KB(this.kp,eb.a.x6c,null,null);this.kp.className=ya.a.g1e;Ja.appendChild(this.kp);this.Ash();this.Bte=document.createElement("div");this.cGc.id="SheetIconTooltipContainer";Ja.appendChild(this.cGc)}Ash(){const S=
document.createElement("div"),Ja=document.createElement("div"),rb=qc.a.G$e(Ba.a.cOh);Ja.className=Ba.a.Bih;Ja.appendChild(rb);S.appendChild(Ja);S.className=ob.kNh;T.DOMElementExtensions.setVisible(S,!1);this.kp.appendChild(S)}Qdd(){const S=this.$.ta;for(let Ja=0,rb=S.count;Ja<rb;Ja++){const ma=Object(Bb.a)(ab.a,S.getItem(Ja));0===ma.lD&&(this.Ybc(ma,!0),ma.active&&ma.activate({scenario:"createSheetTabs"}))}}V$c(){Fa.a.df(this.fk);this.fk=[];this.cZ=this.tC=0}CRe(S,Ja,rb,ma){const ib=document.createElement("a");
S.appendChild(ib);S=this.xId[Ja];this.HQ[Ja]=this.Ld(ib,xb.a.instance.ha(ma),0,this.Z0i[Ja],xb.a.instance.ha(rb),S);if(5===Ja||4===Ja)T.DOMElementExtensions.gI(this.HQ[Ja],ib,!1,"span").style.marginTop="10px";this.xfg(Ja);rb=this.wId[Ja]=this.Vg.Lg(ib);va.a.instance.va(oa.a.Cf,ib,Fc=>Fc.ctrlKey&&this.E7i(Ja)?!0:this.DQf(Ja));va.a.instance.va(oa.a.tj,ib,()=>this.EQf());xa.a.instance.va(oa.a.Wg,ib,()=>this.EQf());va.a.instance.va(oa.a.Hv,ib,()=>this.N$c());Pa.KeyInputManager.instance.va(oa.a.Ne,ib,
Fc=>13!==Fc.Da.keyCode&&32!==Fc.Da.keyCode||this.Ybd?!1:(this.Ybd=!0,this.DQf(Ja)));Pa.KeyInputManager.instance.va(oa.a.tg,ib,Fc=>13===Fc.Da.keyCode||32===Fc.Da.keyCode?(this.Ybd=!1,this.N$c()):!1);const Qb=this.uCe();ma=Fc=>{"mouseup"===Fc.type&&this.BU||Gb.g(Fc);!ib.classList.contains(Sb.a.C1)&&Qb&&this.$cj(Fc,Ja)};rb.la("mouseover",ma);rb.la("mouseout",ma);rb.la("focus",ma);rb.la("blur",ma);Qb&&rb.la("mouseup",ma)}rFi(S){let Ja=!1;const rb=this.$.Yh;rb&&(Ja=A.a.RY(T.DOMElementExtensions.getBoundingClientRect(rb),
S.clientPoint));return Ja}pWb(){if(!this.SP){k.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.SP=this.$da.cloneNode(!0);if(!this.uag(this.SP,this.$da,!0,"UpdateDragAndDropState"))return;this.$da.style.visibility="hidden";this.SP.classList.add(ob.mNh);this.SP.style.borderRightWidth="";this.dlc=this.H7.clientPoint.x-this.T7.width/2;this.SP.style.left=this.dlc+"px";this.iG=this.Vma(this.K3);0>this.iG&&k.ULS.sendTraceTag(537153742,
0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.Hec&&(this.iG=this.Vma(this.K3));var S=T.DOMElementExtensions.getBoundingClientRect(this.kp);const Ja=S.x;S=S.x+S.width;let rb=this.H7.clientPoint.x-this.T7.width/2;rb=Math.min(rb,S-this.T7.width);rb=Math.max(rb,Ja);this.SP.style.transform="translateX("+Math.abs(rb-this.dlc)*(this.dlc<rb?1:-1)+"px)";const ma=this.H7.clientPoint.x>this.NIb;let ib=this.H7.clientPoint.x;rb>=S-this.T7.width?(ib=S-this.T7.width/2,this.lYd()||this.Tqa||
(k.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.qyc=this.kp.scrollLeft,this.Tqa=window.requestAnimationFrame(this.Wbg))):rb<=Ja?(ib=Ja+this.T7.width/2,this.kYd()||this.Tqa||(k.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.qyc=this.kp.scrollLeft,this.Tqa=window.requestAnimationFrame(this.Vbg))):
this.Tqa&&(k.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.x4d());this.H7.clientPoint.x!==this.NIb&&(this.i5d(ma,ib),this.NIb=this.H7.clientPoint.x);this.pVc=!0}i5d(S,Ja){let rb;for(;(()=>{let ma=this.QDh(Ja,S);({Z9b:rb}=ma);return ma})().returnValue;)this.$Ub=rb,this.C3g(S)}C3g(S){if(this.$Ub){var Ja=(S?1:-1)*this.T7.width;if(S&&!this.$.uP||!S&&this.$.uP){var rb=this.$da;var ma=this.iG+1;var ib=!0}else rb=
(ma=this.wY(this.iG+1))?ma.domElement:null,ma=this.iG-1,ib=!1;if(this.uag(this.$Ub,rb,ib,"AnimateSheetSwap")){k.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.iG} and other sheet-index ${ma}. amount of sheets in the bar: ${this.W0d} isMovingRight: ${S}`);0<=this.iG&&this.iG<this.fk.length&&0<=ma&&ma<this.fk.length?(S=this.fk[ma],this.fk[ma]=this.fk[this.iG],this.fk[this.iG]=S):(k.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.fk.length}, ghostIndex: ${this.iG}, swappedSheetIndex: ${ma}`),
this.YX());this.iG=ma;var Qb=this.$Ub;Qb.style.transform="translateX("+Ja+"px)";window.requestAnimationFrame(()=>{Qb.style.transform="translateX(0px)"})}}}uag(S,Ja,rb,ma){const ib=Qb=>Qb?`Node ID: ${Qb.id} , Node class: ${Qb.className}, Node name: ${Qb.nodeName},`:null;try{return this.kp.insertBefore(S,Ja),!0}catch(Qb){return S=this.LAb(this.K3),k.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
S?S!==this.Aec?"Changed":"NoChange":"Removed",ma,ib(Ja),ib(Ja.parentNode),ib(this.kp),rb,this.iG,this.W0d,Qb),this.YX(),!1}}QDh(S,Ja){var rb=this.$.uP===Ja?this.wY(this.iG-1):this.wY(this.iG+1);if(!rb)return{returnValue:!1,Z9b:null};rb=rb.domElement;const ma=T.DOMElementExtensions.getBoundingClientRect(rb);return this.T7?Ja?{returnValue:S+this.T7.width/2>=ma.x+.5*ma.width,Z9b:rb}:{returnValue:S-this.T7.width/2<=ma.x+.5*ma.width,Z9b:rb}:(k.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.YX(),{returnValue:!1,Z9b:rb})}Tbg(S,Ja){let rb;rb=Ja?this.Wbg:this.Vbg;if(-1===this.WHc)this.WHc=S,this.Tqa=window.requestAnimationFrame(rb);else{S=Math.floor((S-this.WHc)/1E3*300);var ma=this.iRb>this.pJb?1:-1;this.scrollLeft(Math.abs(this.kp.scrollLeft-(Ja?this.qyc+S*ma:this.qyc-S*ma))*(Ja?-1:1));if(S=this.Hbf("ScrollStep"))this.i5d(Ja,S.x+S.width/2),Ja&&!this.lYd()||!Ja&&!this.kYd()?this.Tqa=window.requestAnimationFrame(rb):(k.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.x4d())}}lYd(){const S=this.iRb>this.pJb;return S&&this.Fra>=this.iRb||!S&&this.Fra<=this.iRb}kYd(){const S=this.iRb>this.pJb;return S&&this.Fra<=this.pJb||!S&&this.Fra>=this.pJb}x4d(S){S=void 0===S?!0:S;this.kp&&(this.Fra=this.kp.scrollLeft);window.cancelAnimationFrame(this.Tqa);this.Tqa=0;this.WHc=-1;S&&this.m4()}ZZd(S,Ja){S||k.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${Ja}`);this.T7=S}E7i(S){return 2===S?(this.Dha(3),
!0):1===S?(this.Dha(0),!0):!1}DQf(S){k.ULS.shipAssertTag(537153732,0,-1===this.tUa&&-1===this.sUa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.tUa&&(window.clearTimeout(this.tUa),this.tUa=-1);-1!==this.sUa&&(window.clearInterval(this.sUa),this.sUa=-1);this.Dha(S);this.tUa=window.setTimeout(()=>{this.l8j(S)},this.N0i);return!0}l8j(S){this.sUa=window.setInterval(()=>{this.Dha(S)},this.M0i)}EQf(){this.N$c();
return!this.BU}N$c(){window.clearTimeout(this.tUa);window.clearInterval(this.sUa);this.sUa=this.tUa=-1;return!0}$cj(S,Ja){const rb=this.ppc(Ja),ma=5===Ja;"mouseup"!==S.type||!ma&&4!==Ja||(rb||this.reorderSheets(null,ma,!1),this.YX())}ppc(S){return!!T.DOMElementExtensions.ebf(this.HQ[S],"a").title}ILc(S){this.E9d(S);this.m4()}E9d(S){(S=this.LAb(S))&&S.xlb()}pYd(){var S=this.$.ta;if(S.pa&&(!yc.e(this.$)||S.count))if(S=this.Vma(S.pa),-1===S)k.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");
else{var Ja=this.yPa(S);S<this.tC?this.dEc(S):S>this.tC&&!this.LBd(Ja)&&this.scrollIntoView(S)}}Rkk(){this.tC=0;this.cZ=this.fk.length-1;let S=!1;for(let Ja=0;Ja<this.fk.length;Ja++){const rb=this.wY(Ja);if(!rb)break;const ma=this.LBd(rb.domElement);rb.tabIndex=ma?0:-1;if(!S&&ma)this.tC=Ja,S=!0;else if(S&&!ma){this.cZ=Ja-1;break}}}dEc(S){this.$.ta.count&&(this.fk.length||this.Qdd(),this.Kdg(this.yPa(Math.max(0,Math.min(S,this.fk.length-1)))),this.m4())}scrollIntoView(S){k.ULS.shipAssertTag(537153697,
0,S>=this.tC,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visible sheet tab index!");if(this.$.ta.count){this.fk.length||this.Qdd();var Ja=this.yPa(Math.max(0,Math.min(S,this.fk.length-1))),rb=this.yPa(this.tC);if(!this.LBd(Ja)){Ja=T.DOMElementExtensions.getBoundingClientRect(Ja);var ma=T.DOMElementExtensions.getBoundingClientRect(this.gjb);Ja=this.isRtl?ma.x-Ja.x:Ja.x+Ja.width-(ma.x+ma.width);for(ma=0;rb&&ma<Ja;){const ib=T.DOMElementExtensions.getBoundingClientRect(rb);
ma+=ib.width;rb=rb.nextSibling}rb?this.Kdg(rb):k.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.tC}, lastVisibleSheetTabIndex = ${this.cZ}, scroll to index: ${S}`)}this.m4()}}Kdg(S){const Ja=T.DOMElementExtensions.getBoundingClientRect(this.kp);S=T.DOMElementExtensions.getBoundingClientRect(S);this.isRtl?this.scrollLeft(Math.floor(Ja.x+Ja.width-(S.x+S.width+.5))):this.scrollLeft(Math.ceil(Ja.x-S.x-.5))}scrollLeft(S){(0>
S&&this.lYd()||0<S&&this.kYd())&&k.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const Ja=this.kp.scrollLeft;if(this.isRtl){if(y.a.DC||y.a.Zh){this.kp.scrollLeft=this.Fra=Ja-S;return}if(y.a.pG){this.kp.scrollLeft=this.Fra=Ja+S;return}k.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.kp.scrollLeft=this.Fra=Ja-S}LBd(S){S=T.DOMElementExtensions.getBoundingClientRect(S);const Ja=T.DOMElementExtensions.getBoundingClientRect(this.gjb);
return S&&Ja?S.x>=Ja.x-1&&S.x+S.width<=Ja.x+Ja.width+1:(k.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}ath(){const S=this.Z0d;Y.cig(this.$)?(Fa.a.Ma(this.oU),this.oU=new Y(S,this.$,this,!0)):(Fa.a.Ma(this.oU),cb.m(this.$.ih)?this.oU=new Ad(S,this.$,this):this.oU=new Y(S,this.$,this))}NRe(S,Ja){var rb=this.$.ta;if(!this.$.isEditMode||!rb.count)Fa.a.Ma(Ja),Ja=null;else if(!Ja)if(rb=this.Y0d,cb.m(this.$.ih))Ja=new Ad(rb,
this.$,this);else switch(S){case 0:Ja=new Y(rb,this.$,this);break;case 1:Ja=new La(rb,this.$,this);break;default:k.ULS.sendTraceTag(537153692,0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return Ja}vdd(){this.lHi?(this.oU=this.NRe(0,this.oU),this.yFb=this.NRe(1,this.yFb)):this.ath()}Hbf(S){const Ja=T.DOMElementExtensions.getBoundingClientRect(this.SP);
Ja||(k.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${S}: GetBoundingClientRect returned null for the dragged sheet.`),this.YX());return Ja}Ojf(S,Ja){this.bya.N4g(S,Ja);this.YX(!1);this.B_d(this.navigationButtonsDisabled);for(const rb of this.eak)rb&&rb.OV(this.navigationButtonsDisabled);for(const rb of this.qGe)rb&&rb.OV(this.operationButtonsDisabled)}static YFj(S,Ja,rb,ma){S<rb?(Ja>rb&&rb--,Ja>ma&&ma--):S>ma?(Ja<rb&&rb++,Ja<ma&&ma++):Ja<rb&&rb++;return{zWh:rb,HPi:ma}}}Object(e.a)(Sd,"SheetTabBarControl",
fc.a,[674,5,57]);var Fd=a(477);Object(fa.b)(ha.dd,{nr:"singleton"})(S=>Ko(function*(){const Ja=yield fa.a.resolve(ha.fb,S);var rb=Ja.He;if(nb.a(Ja.xa,1))return tc.a.instance.NVa(eb.a.Baa,["sheetTabBar"]),null;rb=document.getElementById(rb+eb.a.Scc);if(!rb)return tc.a.instance.NVa(eb.a.Baa,["sheetTabBar"]),null;tc.a.instance.Kha(eb.a.Baa);const ma=yield fa.a.resolve(Fd.SvgIconProviderService,S);return new Sd(Ja,rb,ma)}));class se extends U.a{constructor(S){super();this.$=S;this.Oe()}create(){const S=
this.$.He;if(nb.a(this.$.xa,1))tc.a.instance.NVa(eb.a.Baa,["sheetTabBar"]);else{var Ja=document.getElementById(S+eb.a.Scc);if(Ja){tc.a.instance.Kha(eb.a.Baa);var rb=la.GetServiceTaskFactory.je(this.$.ia,388,387,this.$a);L.TaskExtensions.Aa(L.TaskExtensions.Tg([rb],this.$.ma),()=>{this.ve(this.$.ia.Ja(32)||new Sd(this.$,Ja,rb.result))},this.$.ma,3)}else tc.a.instance.NVa(eb.a.Baa,["sheetTabBar"])}}static la(S){S.ia.Va(33,new se(S))}}Object(e.a)(se,"SheetTabBarFactory",U.a,[]);var uc=a(33),Ra=a(330),
vb=a(357),Gc=a(383),cd=a(34),Cd=a(234),Rd=a(249);class Be{constructor(S,Ja,rb,ma){this.red=S;this.green=Ja;this.blue=rb;this.alpha=ma}toString(){return this.red.toString()+this.green.toString()+this.blue.toString()+this.alpha.toString()}}Object(e.a)(Be,"ColorObject",null,[]);class ad{constructor(S){this.F0=this.KJ=null;this.x9c=S}get head(){return this.KJ}get x5d(){return this.F0}NUe(S){this.head&&(S.pre?S.next?(S.pre.next=S.next,S.next.pre=S.pre):(this.F0=S.pre,this.x5d.next=null):S.next?(this.KJ=
S.next,this.head.pre=null):this.F0=this.KJ=null,S.next=null,S.pre=null)}fYg(S){this.head?(S.next=this.head,this.KJ=S,S.next.pre=this.head):this.F0=this.KJ=S}Jpd(){if(!this.head)return null;const S=new Mc.a;let Ja=this.head;for(;Ja;)if(S.add(Ja.value),Ja=Ja.next,S.count>this.x9c){k.ULS.sendTraceTag(537155399,0,10,"CustomLinkedList.GetItems - Size of Linked List exceeded max capacity.");break}return S}}Object(e.a)(ad,"CustomLinkedList",null,[]);class Qc{constructor(S){this.pre=this.next=null;this.value=
S}}Object(e.a)(Qc,"CustomLinkedListNode",null,[]);class Zd{constructor(S){this.x9c=S;this.Yuc={};this.Xcb=new ad(S);this.count=0}add(S,Ja){S&&Ja?(Ja=new Qc(Ja),this.contains(S)?this.Xcb.NUe(this.Yuc[S]):this.count<this.x9c?this.count++:(delete this.Yuc[this.Xcb.x5d.value.toString()],this.Xcb.NUe(this.Xcb.x5d)),this.Xcb.fYg(Ja),this.Yuc[S]=Ja):k.ULS.sendTraceTag(537155358,0,15,`MRUCache.Add: Key ${S} or Value ${Ja} is null.`)}Jpd(){return this.Xcb.Jpd()}contains(S){return S?S in this.Yuc:!1}}Object(e.a)(Zd,
"MRUCache",null,[]);var Tb=a(153);class Yc extends Tb.a{constructor(S,Ja,rb,ma){ma=void 0===ma?null:ma;super(!1,!1,!0);this.moreColorsHelper=null;this.Gjh=(ib,Qb)=>{this.mNe(ib,Qb)};this.$=S;this.tvi=Ja;this.Jnf=rb;this.nNe=ma}Ni(){const S=xb.a.instance.ha(1346),Ja={};Ja[Yc.aCg]=this.tvi;Ja[Yc.$zg]=Yc.RXb;Ja[Yc.UBg]=Yc.RXb;Ja[Yc.vDg]=Yc.RXb;Ja[Yc.jDg]=Yc.RXb;Ja[Yc.OCg]=xb.a.instance.ha(2105);Ja[Yc.LBg]=xb.a.instance.ha(2089);Ja[Yc.oAg]=xb.a.instance.ha(2076);Ja[Yc.SBg]=xb.a.instance.ha(1347);Ja[Yc.aAg]=
xb.a.instance.ha(1348);this.Jnf!==Yc.bAg&&(Ja[Yc.cAg]=Yc.ALPHA,Ja[Yc.ALPHA]=this.Jnf);this.initializeAndShow(S,this.Gjh,{[Yc.sBg]:Yc.PAg,[Yc.pAg]:Ja})}mNe(S,Ja){Ja=Ja[Yc.yNc];1===S&&this.DIf(fd.a.yha(Ja));this.nNe&&this.nNe(1===S,1===S?Ja:null)}DIf(S){this.moreColorsHelper||(this.moreColorsHelper=this.$.ia.Ja(398));S=Jd.a.eI(fd.a.CK(S,!1));this.moreColorsHelper.WXd(S.r,S.g,S.b,vb.a.lNc)}}Yc.aCg="initColor";Yc.sBg="id";Yc.PAg="ColorPickerDialog";Yc.pAg="bodyControls";Yc.yNc="selectedColorText";Yc.UBg=
"hueAriaLabel";Yc.vDg="transparencyAriaLabel";Yc.jDg="svAriaLabel";Yc.RXb="Use left & right arrows keys to change values in color picker & hue slider";Yc.ALPHA="alpha";Yc.kNc="alphaValue";Yc.$zg="alphaAriaLabel";Yc.cAg="alphaSliderType";Yc.bAg=-1;Yc.wCg=100;Yc.OCg="redLabel";Yc.oAg="blueLabel";Yc.LBg="greenLabel";Yc.SBg="hexLabel";Yc.aAg="alphaLabel";Object(e.a)(Yc,"MoreColorsDialog",Tb.a,[]);var Ob=a(531);class kc extends Yc{constructor(S,Ja,rb,ma,ib){super(S,ma,ib);this.commandName=null;this.aqf=
!1;this.command=Ja;this.Yf=rb;this.jvi=ib}Ni(){super.Ni();this.commandName=Ub.b().Tl(this.Yf.command);k.ULS.sendTraceTag(545051016,0,50,`More Colors:: Dialog Opened From Entry Point: ${this.commandName}, Command SourceUILocation: ${this.Yf.hh}`)}mNe(S,Ja){if(1===S)if(S=this.$.pe.Fi("UserAction",this.commandName),S.start(),Ob.a(S),Ja)if(Yc.yNc in Ja){var rb=Ja[Yc.yNc];if(S=fd.a.yha(rb)){rb=new lb.a(this.command,this.Yf.method,this.Yf.mode,this.Yf.hh,this.Yf.tabName?this.Yf.tabName:1378078823===this.command||
-400966242===this.command?eb.a.LDa:eb.a.nR);var ma={};ma.Color=S;ma.UILocation=this.Yf.hh;Yc.kNc in Ja&&(this.jvi!==Ja[Yc.kNc]&&(this.aqf=!0),ma.Alpha=(Ja[Yc.kNc]/Yc.wCg).toString(),k.ULS.sendTraceTag(508822752,0,50,"Alpha Value selected from the MoreColors Dialog."));this.$.Ga.Sd(rb,ma);this.$.xj();this.DIf(S);Ja={["Command"]:this.commandName,["Location"]:this.Yf.hh};Ja.AlphaApplied=this.aqf.toString();Yd.b(this.$).Lf(jc.a.F_i,Ja,null,!0)}else this.hide(),k.ULS.sendTraceTag(537155360,0,10,`Color picker dialog did not return the color in expected format RRGGBB. Color returned: ${rb}, Command: ${this.commandName}`)}else this.hide(),
k.ULS.sendTraceTag(537155361,0,10,`Dictionary does not contain color, Command: ${this.commandName}`);else this.hide(),k.ULS.sendTraceTag(537155362,0,10,`Dictionary is null Command: ${this.commandName}`)}}Object(e.a)(kc,"MoreColorsRibbonDialog",Yc,[]);class Kc{constructor(S,Ja){this.yre="00FFFF";this.zre="0000FF";this.q2f="00FFFF";this.r2f="BF7000";this.aVa=null;this.$cf=!1;this.fne=null;this.S$i=rb=>{if(!Cd.a(rb)){rb=rb.Result;this.aVa=new Zd(10);for(let ib=rb.length-1;0<=ib;ib--){var ma=rb[ib];ma=
new Be(ma.Red,ma.Green,ma.Blue,ma.Alpha);this.aVa.add(ma.toString(),ma)}this.OXf();k.ULS.sendTraceTag(537155395,0,50,"MoreColorsHelper.OnGetMRUColorsSuccessCallback : Successfully fetched Recent colors ")}};this.R$i=()=>{k.ULS.sendTraceTag(537155394,0,50,"MoreColorsHelper.OnGetMRUColorsFailureCallback - Webservice call failed")};this.NC=()=>{this.ykd()};this.$=S;this.AJb=Ja;this.$.ia.Va(398,this);this.$.ea.Gh?this.ykd():this.$.ea.el(this.NC)}get wJb(){return this.fne}get bVa(){return this.yre}set bVa(S){this.yre=
S}get Sgb(){return this.zre}set Sgb(S){this.zre=S}get JAc(){return this.q2f}set JAc(S){this.q2f=S}get KAc(){return this.r2f}set KAc(S){this.r2f=S}mJb(S,Ja,rb,ma){ma=void 0===ma?-1:ma;return this.AJb?L.TaskExtensions.Aa(this.AJb,()=>{(new kc(this.$,S,Ja,rb,ma)).Ni()},this.$.ma):null}oQi(S,Ja){var rb=void 0;rb=void 0===rb?-1:rb;Ja=void 0===Ja?null:Ja;this.AJb&&L.TaskExtensions.Aa(this.AJb,()=>{(new Yc(this.$,S,rb,Ja)).Ni()},this.$.ma)}yfi(S){let Ja=null;switch(S){case "QueryRecentFillColor":Ja=this.bVa;
break;case "QueryRecentFontColor":Ja=this.Sgb;break;case "QueryRecentShapesFillColor":Ja=this.JAc;break;case "QueryRecentShapesOutlineColor":Ja=this.KAc}return Ja?uc.a.J9a(Ja):null}dispose(){this.AJb=null;this.$&&this.$.ea.to(this.NC)}ykd(){if(this.$.isEditMode)if(this.aVa)this.OXf();else{this.$cf&&k.ULS.sendTraceTag(575939106,0,15,"MoreColorsHelper.FetchMRUColors : Recent Colors not shown since data not available from GetMRUColors operation");var S=this.$.qa.ua;this.$.userOperationManager.enqueueOperation(new Kb.a(1009,
0,(Ja,rb,ma)=>{Ja=Rd.b.call(null,Ja,this.S$i);rb=Rd.a.call(null,rb,this.R$i);const ib=S.Pa(1,null);return ka.g(S,"GetMRUColors",ib,Ja,rb,ma,null,4)},80),null);this.$cf=!0}}OXf(){var S=this.aVa.Jpd();if(S){this.fne=new Mc.a;for(let Ja of S)S=Ja,S=new Jd.a(S.red,S.green,S.blue),this.wJb.add(fd.a.$L(S))}}WXd(S,Ja,rb,ma){this.aVa||(this.aVa=new Zd(10));const ib=new Be(S,Ja,rb,ma);this.aVa.add(ib.toString(),ib);this.saveMRUColor(null,S,Ja,rb,ma)}cha(S,Ja,rb){(S||this.$.isEditMode)&&this.Lig(S.SqmControlId)&&
(S=Jd.a.eI(fd.a.CK(Ja,!1)))&&(this.WXd(S.r,S.g,S.b,vb.a.lNc),rb={["Command"]:Ub.b().Tl(rb.command),["Location"]:Ra.a[rb.hh],["InputMethod"]:Vb.a[rb.method]},Yd.b(this.$).Lf(jc.a.cha,rb,null,!0))}Lig(S){return!!S&&S.startsWith("RecentColorPicker")}saveMRUColor(S,Ja,rb,ma,ib){return Gc.a(this.$.userOperationManager,(Qb,Fc,jd)=>{var ke=this.$.qa.ua;Qb=Rd.b(Qb,Kc.tfj());Fc=Rd.a(Fc,Kc.sfj());const ne=ke.Pa(9,null);ne.bRed=Ja;ne.bGreen=rb;ne.bBlue=ma;ne.bAlpha=ib;return ka.g(ke,"SaveMRUColor",ne,Qb,Fc,
jd,null,0)},Qb=>new Kb.a(1008,0,Qb),S)}static tfj(){return S=>{cd.a.Ph(S.Errors)?k.ULS.sendTraceTag(537155393,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed with errors"):k.ULS.sendTraceTag(537155392,0,50,"MoreColorsHelper.OnSaveMRUColorSuccess - Successfully saved color to workbook")}}static sfj(){return()=>{k.ULS.sendTraceTag(537155363,0,10,"MoreColorsHelper.OnSaveMRUColorFailure - Webservice call failed.")}}}Object(e.a)(Kc,"MoreColorsHelper",null,[715,5]);class Wc extends U.a{constructor(S){super();
this.$=S;this.Oe()}create(){const S=new pc.a;this.$.LK(rb=>{rb=rb.yAf();L.TaskExtensions.Aa(rb,()=>{S.setResult(!0)},this.$.ma)});const Ja=S.task;this.ve(this.$.ia.Ja(398)||new Kc(this.$,Ja))}static la(S){S.ia.Va(397,new Wc(S))}}Object(e.a)(Wc,"MoreColorsHelperFactory",U.a,[]);var Nd=a(2),Ud=a(574),$d=a(570),$b=a(388),nc=a(624);class Oc{constructor(){this.Alt=this.DisplayColor=this.Color=null;this.Disabled=!1}}Object(e.a)(Oc,"ColorCellProps",null,[]);var Hd=a(224),re=a(222),fe=a(274),oc=a(22);class Xc{constructor(S){this.jPc=
null;this.$=S;this.grid=Ib.h(this.$)}get borderFormatManager(){this.jPc||(this.jPc=this.$.ia.Ja(296));return this.jPc}q$h(S){let Ja=null;switch(S){case 467002767:S={};this.$.Am(S);Ja=Object(Bb.a)(Mb.a,this.$.ta).hgf(S.SheetName,!0);break;case -236759591:Ja=this.e3h();break;case 1970784898:Ja=this.vbf(0);break;case 1650812936:case 1378078823:Ja=this.vbf(1);break;case -400966242:Ja=this.getShapeOutlineColor();break;default:k.ULS.sendTraceTag(537154460,0,50,`ColorHighlighterHelper.GetHighlightColorBasedOnCommand: HighlightColor is not supported for ribbon command '${S}'`)}return Ja}e3h(){let S=
null;this.borderFormatManager&&(S=this.borderFormatManager.D7);(S="black"===S?"000000":S)&&(S=uc.a.J9a(S));return S}getShapeOutlineColor(){let S=null;if(this.grid.ga.Ta&&this.grid.ga.Ta.Fe){const Ja=this.grid.ga.Ta.Fe.floatingObject;5===Ja.type&&Ja.$d&&-1!==Ja.$d.ShapeOutlineColor&&(S=fd.a.nJ(Ja.$d.ShapeOutlineColor),S=S.toUpperCase())}return S}vbf(S){let Ja=null;if(this.grid.ga.Ta&&this.grid.ga.Ta.Fe){var rb=this.grid.ga.Ta.Fe.floatingObject;5===rb.type&&rb.$d?1===S&&-1!==rb.$d.ShapeFillColor?(Ja=
fd.a.nJ(rb.$d.ShapeFillColor),Ja=Ja.toUpperCase()):k.ULS.sendTraceTag(537154459,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font ColorPicker is not supported for Shapes."):k.ULS.sendTraceTag(537154458,0,50,"ColorHighlighterHelper.GetFontOrFillColor: HighlightColor for Font or Fill ColorPicker is not supported for Floating Object other than Shapes.");return Ja}rb=this.grid.B7("ColorHighlighterHelper.GetFontOrFillColor",this.grid.ga.ra.selectedRanges,1,!0);try{for(rb.$$rst();rb.$$mn();){const ma=
rb.$$cu().cell;if(!ma)continue;let ib="#000000";if(0===S){ib=ma.color;if(J.EwaSettings.Xd()&&this.grid.Kd)return this.c9h();ma.hasRichText&&(ib=this.d9h(ma))}else if(1===S){const Qb=ma.backgroundColor;ib=oc.a.compare(Qb,"transparent",!0)&&Qb?ma.backgroundColor:null}if(!Ja)Ja=ib;else if(Ja!==ib){Ja=null;break}}}finally{rb&&rb.dispose()}return Ja}c9h(){var S=null,Ja=this.grid.me,rb=this.grid.cellTextEditBox.formattedText;if(rb){S=rb.TextRuns;const ma=Hd.a.map(S,ib=>ib.StartIndex);rb=rb.Fonts;Ja=Ja.Ha.caretPosition;
Ja=qb.HelperMethods.C5e(new re.a(ma),ma.length,Ja,qb.HelperMethods.HI);S=rb[S[Ja].FontID].Color}return S?S.toUpperCase():null}d9h(S){S=fe.a(S.formattedText.Fonts);if(fe.e(S,32))(S=fd.a.yha(fd.a.nJ(S.FontColor)))&&(S="#"+S.toUpperCase());else return null;return S}}Object(e.a)(Xc,"ColorHighlighterHelper",null,[755]);var ud=a(280);class Vd{constructor(S,Ja,rb){this.IAc=this.EUb=this.AFa=null;this.rcg="-1";this.$=S;this.moreColorsHelper=Ja;this.Vq=rb;this.kNe=new Xc(S);this.rG=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)}edf(S,Ja,rb,ma,ib,Qb,Fc,jd,ke){Ja=void 0===Ja?null:Ja;rb=void 0===rb?null:rb;ma=void 0===ma?null:ma;jd=void 0===jd?null:jd;return this.uT(null!=Ja,null!=rb,null!=ma,null!=jd,!0,S,Ja,rb,ma,void 0===ib?null:ib,void 0===Qb?null:Qb,void 0===Fc?null:Fc,jd,void 0===ke?null:ke)}hii(S,Ja,rb,ma){return this.uT(S,Ja,rb,ma,!1)}fdf(S,Ja,rb,ma,ib,Qb){const Fc=[];S=this.edf(S,void 0===Ja?null:Ja,void 0===rb?null:rb,void 0===ma?null:ma,void 0,void 0,void 0,void 0===ib?null:ib,void 0===Qb?null:Qb);for(let jd=
0,ke=S.length;jd<ke;jd++)Fc.push(ud.r(S[jd]));return Fc}uT(S,Ja,rb,ma,ib,Qb,Fc,jd,ke,ne,Te,Hb,Cc,vd){Qb=void 0===Qb?null:Qb;Fc=void 0===Fc?null:Fc;jd=void 0===jd?null:jd;ke=void 0===ke?null:ke;ne=void 0===ne?null:ne;Te=void 0===Te?null:Te;Hb=void 0===Hb?null:Hb;Cc=void 0===Cc?null:Cc;vd=void 0===vd?null:vd;k.ULS.shipAssertTag(537154456,0,!ib||null!=Qb,"ColorPickerBuilder: must provide value for applyColorCommand if created for ribbon.");const le=[];let De=null,Ce=3,af=null,Cf=null,Jf=null;this.IHh();
if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.$&&this.$.isEditMode&&!this.loj(vd))return k.ULS.sendTraceTag(537154455,0,50,`Theme Info not present at the time of ${vd} menu opening`),le;S&&(ib&&null==Fc?k.ULS.shipAssertTag(537154454,0,!1,"ColorPickerBuilder: must provide automaticColorCommand when addAutomaticSection is true."):le.push(this.wPa(Vd.H7g,this.TZh(Vd.hGe,Fc,Hb,Te))));ib&&null!=Qb&&this.kNe&&(Cf=af="-1",De=this.kNe.q$h(Qb))&&(k.ULS.sendTraceTag(537154453,
0,50,`ColorPickerBuilder: Highlighter color for the command ${Qb} is not null .`),De=fd.a.yha(De),Ce=this.ccf(De),af=this.ird(De,Ce,0,!0),Cf=this.ird(De,Ce,1,!1));le.push(this.wPa(Vd.vbk,this.Emd(Vd.Cpg,af,this.AFa,Qb,ne,Te),1341));le.push(this.wPa(Vd.F7j,this.Emd(Vd.E7j,Cf,this.EUb,Qb,ne,Te),1342));this.$&&this.$.isEditMode&&this.moreColorsHelper&&(this.joj(),ib&&(Jf="-1",De&&(Jf=this.ird(De,Ce,2,!0))),this.moreColorsHelper&&this.moreColorsHelper.wJb&&0<this.moreColorsHelper.wJb.count&&le.push(this.wPa(Vd.Fwj,
this.Emd(Vd.Ewj,Jf,this.IAc,Qb,ne,Te),1349)));Ja&&(ib&&null==jd?k.ULS.shipAssertTag(537154452,0,!1,"ColorPickerBuilder: must provide clearColorCommand when addClearColorSection is true."):le.push(this.wPa(Vd.K1i,this.UZh(Vd.OLe,jd,this.D4h(jd),Hb,Te))));!rb||J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInEditMode",!1)&&this.$.isMobileMode&&this.$.isEditMode||(v.AFrameworkApplication.CQ("XLS-HighlightWhenCFExperiment-Treatment;XLS-HighlightWhenCFExperiment-Control"),J.EwaSettings.isChangeGateEnabled("OfficeVSO:8219921_HighlightWhenCG")&&
v.AFrameworkApplication.da.na("IsO365ConsumerHost")&&(ib&&!ke?k.ULS.shipAssertTag(520668946,0,!1,"ColorPickerBuilder: must provide highlightWhenCommand when addHighlightWhenSection is true."):le.push(this.wPa(Vd.hti,this.x_h(Vd.gmf,ke)))));ma&&(ib&&null==Cc?k.ULS.shipAssertTag(537154451,0,!1,"ColorPickerBuilder: must provide moreColorsCommand when addMoreColorsSection is true."):le.push(this.wPa(Vd.G_i,this.W_h(Vd.IGf,Cc,this.Nbi(Cc)))));return le}ird(S,Ja,rb,ma){3===Ja&&(Ja=this.ccf(S));return this.rG&&
0===rb&&Ja===rb?this.rcg.toLowerCase():Ja===rb?ma?S.toLowerCase():S:"-1"}ccf(S){if(!S)return 3;const Ja=S.toLowerCase();if(this.rG){if(this.AFa&&this.NMi(Ja,this.AFa))return 0}else if(this.AFa&&this.Pxd(Ja,this.AFa))return 0;return this.EUb&&this.Pxd(S,this.EUb)?1:this.IAc&&this.Pxd(Ja,this.IAc)?2:3}wPa(S,Ja,rb){rb=void 0===rb?null:rb;S=Object(Nd.a)(new $d.a,{Id:S,Title:null!=rb?xb.a.instance.ha(rb):"",ControlList:[],ControlsId:S+".Controls"});S.ControlList.push(Ja);return S}UZh(S,Ja,rb,ma,ib){return this.p8e(S,
Ja,rb,Ba.a.l1e,"transparent",void 0===ma?null:ma,void 0===ib?null:ib)}x_h(S,Ja){return Object(Nd.a)(new $b.a,{Command:null!=Ja?Ja.toString():null,LabelText:xb.a.instance.ha(1433),Id:S,ExternalId:this.k9a(S,Ja),ExternalImageId:"JotNotebookColor2_20"})}TZh(S,Ja,rb,ma){return this.p8e(S,Ja,542,Ba.a.k1e,"000000",void 0===rb?null:rb,void 0===ma?null:ma)}p8e(S,Ja,rb,ma,ib,Qb,Fc){Qb=void 0===Qb?null:Qb;Fc=void 0===Fc?null:Fc;return Object(Nd.a)(new $b.a,{Command:null!=Ja?Ja.toString():null,CommandPreviewId:null!=
Qb?Qb.toString():null,CommandRevertId:null!=Fc?Fc.toString():null,MenuItemsStatefulData:this.vbi(S,Ja,ib),LabelText:xb.a.instance.ha(rb),Id:S,ExternalId:this.k9a(S,Ja),Image16by16:qc.a.Bj(1),Image16by16Class:ma})}vbi(S,Ja,rb){const ma={};S=this.k9a(S,Ja);ma[S]={};ma[S].iconColor=rb;return ma}Pxd(S,Ja){for(let rb=0;rb<Ja.length;rb++)if(S===Ja[rb].Color)return!0;return!1}aLi(S,Ja){S=fd.a.Hq(S);Ja=fd.a.Hq(Ja);return 1>=Math.abs(S.r-Ja.r)&&1>=Math.abs(S.g-Ja.g)&&1>=Math.abs(S.b-Ja.b)?!0:!1}NMi(S,Ja){for(let rb=
0;rb<Ja.length;rb++){const ma=Ja[rb].Color;if(this.aLi(S,ma))return this.rcg=ma.toLowerCase(),!0}return!1}Emd(S,Ja,rb,ma,ib,Qb){ib=void 0===ib?null:ib;Qb=void 0===Qb?null:Qb;return Object(Nd.a)(new nc.a,{McuLayout:!0,Command:null!=ma?ma.toString():null,CommandPreviewId:null!=ib?ib.toString():null,CommandRevertId:null!=Qb?Qb.toString():null,Width:10,Id:`${S}.ColorPicker`,SelectedColorId:Ja,Colors:rb,Stateful:!0,ExternalId:this.k9a(S,ma),McuExternalId:`${this.k9a(S,ma)}.MCU`})}k9a(S,Ja){return`${S}.${null!=
Ja?Ja.toString():""}`}Zhc(...S){const Ja=[];for(let rb=0,ma=S.length;rb<ma;rb+=2)Ja.push(Object(Nd.a)(new Oc,{Color:S[rb],DisplayColor:fd.a.$L(Jd.a.eI(parseInt(String("0x"+S[rb]),16))),Alt:Object(Ka.a)(String,S[rb+1])&&this.$?S[rb+1]:xb.a.instance.ha(S[rb+1])}));return Ja}W_h(S,Ja,rb){const ma=Ba.a.C1e;S=Object(Nd.a)(new $b.a,{Command:null!=Ja?Ja.toString():null,LabelText:xb.a.instance.ha(rb),Id:S,ExternalId:this.k9a(S,Ja),Image16by16:qc.a.Bj(1),Image16by16Class:ma});S.ShouldTakeFocus=!1;return S}IHh(){this.AFa||
(this.AFa=this.Zhc("ffffff",1360,"000000",1361,"e6e6e7",1362,"6a5444",1363,"c47244",1364,"317ded",1365,"a5a5a5",1366,"00c0ff",1367,"d59b5b",1368,"47ad70",1369,"f2f2f2",1370,"808080",1371,"ceced0",1372,"e4dcd6",1373,"f2e1d9",1374,"d6e4fc",1375,"ededed",1376,"ccf2ff",1377,"f7ebdd",1378,"daefe2",1379,"d9d9d9",1380,"595959",1381,"aaaaae",1382,"cab9ac",1383,"e7c6b4",1384,"adcbf8",1385,"dbdbdb",1386,"99e6ff",1387,"eed7bd",1388,"b4e0c6",1389,"bfbfbf",1390,"404040",1391,"717175",1392,"b09784",1393,"dba98e",
1394,"84b0f4",1395,"c9c9c9",1396,"66d9ff",1397,"e6c29b",1398,"8ed0a9",1399,"a6a6a6",1400,"262626",1401,"38383a",1402,"4f3f33",1403,"965430",1404,"1159c6",1405,"7b7b7b",1406,"008fbf",1407,"b5752f",1408,"358254",1409,"808080",1410,"0d0d0d",1411,"161616",1412,"352b22",1413,"643720",1414,"0c3c83",1415,"525252",1416,"006080",1417,"784e1f",1418,"235637",1419));this.EUb||(this.EUb=this.Zhc("0000C0",1355,"0000FF",1352,"00C0FF",1354,"00FFFF",1356,"50D092",1357,"50B000",1358,"F0B000",1359,"C07000",1351,"602000",
1350,"A03070",1353))}joj(){this.moreColorsHelper.ykd();if(this.moreColorsHelper.wJb){var S=this.moreColorsHelper.wJb;const Ja=[];for(let rb of S)S=fd.a.yha(rb.substr(1)),Ja.push(S,rb);this.IAc=this.Zhc(...Ja)}}loj(S){this.Vq.FAb(S);if(this.Vq.qkb&&this.Vq.Dpg&&!this.Vq.Xwf){S=this.Vq.qkb;const Ja=this.Vq.Dpg,rb=[];for(let ma=0;ma<S.count;ma++)rb.push(S.ka(ma),Ja.ka(ma));this.AFa=this.Zhc(...rb);return!0}return!1}Nbi(S){switch(S){case -458147525:S=1344;break;case 1610379174:S=1345;break;default:S=
1343}return S}D4h(S){switch(S){case 1549407384:S=541;break;case -1744769642:S=539;break;default:S=540}return S}}Vd.K1i="NoColor";Vd.H7g="Automatic";Vd.vbk="ThemeColors";Vd.F7j="StandardColors";Vd.Fwj="RecentColors";Vd.OLe="ClearColor";Vd.hti="HighlightWhen";Vd.gmf="HighlightWhen";Vd.hGe="AutomaticColor";Vd.Cpg="ThemeColorPicker";Vd.E7j="StandardColorPicker";Vd.G_i="MoreColors";Vd.IGf="MoreColors";Vd.Ewj="RecentColorPicker";Object(e.a)(Vd,"ColorPickerBuilder",null,[]);class ge{constructor(){this.sections=
null}}Object(e.a)(ge,"ColorPickerButtonMenuProps",null,[]);class Je{constructor(){this.title=null;this.type=0;this.buttonProps=this.colorSwatchProps=null}}Object(e.a)(Je,"ColorPickerButtonMenuSection",null,[]);class Ke{constructor(){this.id=this.label=this.color=null;this.index=0}}Object(e.a)(Ke,"ColorPickerColorProps",null,[]);class nf{constructor(){this.type=0;this.label=null}}Object(e.a)(nf,"ColorPickerSectionButtonProps",null,[]);class uf{constructor(){this.colors=null;this.isThemeColorSection=
this.notifyOnColorUsed=!1}}Object(e.a)(uf,"ColorPickerSectionColorSwatchProps",null,[]);class ef{constructor(){this.row=this.index=0}}Object(e.a)(ef,"ThemeColorInfo",null,[]);class Ve{constructor(S,Ja,rb,ma){this.$=S;this.DE=Ja;this.moreColorsHelper=rb;this.Vq=ma;this.MMi=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}getColorPickerButtonMenuProps(S){S=this.DE.vgf(S.automaticColor,S.clearColor,S.highlightWhen,S.moreColors);const Ja=new ge;Ja.sections=this.rfi(S);return Ja}showMoreColorsDialog(S,
Ja){this.moreColorsHelper.oQi(S,Ja)}onColorUsed(S){S=Jd.a.eI(fd.a.CK(fd.a.yha(S),!1));this.moreColorsHelper.WXd(S.r,S.g,S.b,vb.a.lNc)}getThemeColor(S){const Ja=fd.a.yha(S);let rb,ma;if(!(()=>{let ib=this.Vq.getThemeColor(Ja);({themeIndex:rb,BFa:ma}=ib);return ib})().returnValue)return k.ULS.shipAssertTag(538514630,0,!1,"ColorPickerButtonController: invalid theme color in GetThemeColor."),null;S=new ef;S.index=rb;S.row=ma;return S}rfi(S){const Ja=[];for(let ma=0;ma<S.length;ma++){var rb=Object(Bb.a)($d.a,
S[ma]);const ib=new Je;ib.title=rb.Title;const Qb=Object(Bb.a)(nc.a,rb.ControlList[0]);Qb?(ib.type=1,ib.colorSwatchProps=this.R4h(Qb),Ja.push(ib)):(rb=Object(Bb.a)($b.a,rb.ControlList[0]))&&null!=this.H$e(rb.Id)?(ib.type=2,ib.buttonProps=new nf,ib.buttonProps.type=this.H$e(rb.Id),ib.buttonProps.label=rb.LabelText,Ja.push(ib)):k.ULS.shipAssertTag(542200588,0,!1,"ColorPickerButtonController: Unknown color menu control type")}return Ja}R4h(S){const Ja=new uf,rb=S.Colors;Ja.colors=Array(rb.length);Ja.notifyOnColorUsed=
this.moreColorsHelper.Lig(S.ExternalId);Ja.isThemeColorSection=this.MMi&&!!S.ExternalId&&S.ExternalId.includes(Vd.Cpg);for(S=0;S<rb.length;S++)Ja.colors[S]=new Ke,Ja.colors[S].id=rb[S].DisplayColor,Ja.colors[S].color=rb[S].DisplayColor,Ja.colors[S].label=rb[S].Alt,Ja.colors[S].index=S;return Ja}H$e(S){switch(S){case Vd.IGf:return 1;case Vd.OLe:return 2;case Vd.hGe:return 3;case Vd.gmf:return 4}return null}}Object(e.a)(Ve,"ColorPickerButtonController",null,[726]);class bd{constructor(S,Ja,rb){this.Qs=
this.vm=null;this.$=S;this.moreColorsHelper=Ja;this.zbh();this.ybh();this.Vq=rb;this.nac=new Vd(S,Ja,rb)}zbh(){this.vm={};this.vm.style0=1535;this.vm.style1=1536;this.vm.style2=1537;this.vm.style3=1538;this.vm.style4=1539;this.vm.style5=1540;this.vm.style6=1541;this.vm.style7=1542;this.vm.style8=1543;this.vm.style9=1544;this.vm.style10=1545;this.vm.style11=1546;this.vm.style12=1547;this.vm.style13=1548;this.vm.style14=1549;this.vm.style15=1550;this.vm.style16=1551;this.vm.style17=1552;this.vm.style18=
1553;this.vm.style19=1554;this.vm.style20=1555;this.vm.style21=1556;this.vm.style22=1557;this.vm.style23=1558;this.vm.style24=1559;this.vm.style25=1560;this.vm.style26=1561;this.vm.style27=1562;this.vm.style28=1563;this.vm.style29=1564;this.vm.style30=1565;this.vm.style31=1566;this.vm.style32=1567;this.vm.style33=1568;this.vm.style34=1569;this.vm.style35=1570;this.vm.style36=1571;this.vm.style37=1572;this.vm.style38=1573;this.vm.style39=1574;this.vm.style40=1575;this.vm.style41=1576}ybh(){this.Qs=
{};this.Qs.style0=1507;this.Qs.style1=1508;this.Qs.style2=1509;this.Qs.style3=1510;this.Qs.style4=1511;this.Qs.style5=1512;this.Qs.style6=1513;this.Qs.style7=1514;this.Qs.style8=1515;this.Qs.style9=1516;this.Qs.style10=1517;this.Qs.style11=1518;this.Qs.style12=1519;this.Qs.style13=1520;this.Qs.style14=1521;this.Qs.style15=1522;this.Qs.style16=1523;this.Qs.style17=1524;this.Qs.style18=1525;this.Qs.style19=1526;this.Qs.style20=1527;this.Qs.style21=1528;this.Qs.style22=1529;this.Qs.style23=1530;this.Qs.style24=
1531;this.Qs.style25=1532;this.Qs.style26=1533;this.Qs.style27=1534}I$e(S){return ud.i(this.nac.fdf(S,null,null,null,null,null))}Oic(S,Ja,rb,ma,ib,Qb,Fc,jd,ke){Ja=void 0===Ja?null:Ja;rb=void 0===rb?null:rb;ma=void 0===ma?null:ma;ib=void 0===ib?null:ib;Qb=void 0===Qb?null:Qb;Fc=void 0===Fc?null:Fc;jd=void 0===jd?null:jd;ke=void 0===ke?null:ke;return Object(Nd.a)(new Ud.a,{MenuSectionList:this.nac.edf(S,Ja,rb,ma,ib,Qb,Fc,jd,ke),UpdateDynamically:!0})}vgf(S,Ja,rb,ma){return this.nac.hii(S,Ja,rb,ma)}S4h(S,
Ja,rb,ma,ib,Qb){return this.nac.fdf(S,void 0===Ja?null:Ja,void 0===rb?null:rb,void 0===ma?null:ma,void 0===ib?null:ib,void 0===Qb?null:Qb)}Gkc(S,Ja){return(void 0===Ja?0:Ja)?this.Qs[S]:this.vm[S]}Wph(){return new Ve(this.$,this,this.moreColorsHelper,this.Vq)}}Object(e.a)(bd,"PopulateDynamicHelper",null,[712]);class be extends U.a{constructor(S,Ja){super();this.DE=null;this.$=Ja;S.Va(111,this);this.Oe()}create(){if(J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)||J.EwaSettings.oo()){const S=
la.GetServiceTaskFactory.je(this.$.ia,398,397,this.$a),Ja=Object(ra.d)(fa.a.resolve(ha.sd,{Oa:this.$a}));L.TaskExtensions.Aa(L.TaskExtensions.Tg([S,Ja],this.ma),()=>{this.ve(this.DE||(this.DE=new bd(this.$,S.result,Ja.result)))},this.ma,3)}else L.TaskExtensions.Aa(la.GetServiceTaskFactory.je(this.$.ia,398,397,this.$a),S=>{this.ve(this.DE||(this.DE=new bd(this.$,S.result,null)))},this.ma,3)}}Object(e.a)(be,"PopulateDynamicHelperFactory",U.a,[]);var jb=a(929);class lc{constructor(S,Ja,rb,ma,ib,Qb,Fc,
jd,ke){this.nEe=Ja;this.gGe=void 0===rb?null:rb;this.NLe=void 0===ib?null:ib;this.fmf=void 0===Qb?null:Qb;this.HGf=void 0===jd?null:jd;this.DE=S;this.menuId=void 0===ke?null:ke}i1(){let S="";const Ja=this.DE.S4h(this.nEe,this.gGe,this.NLe,this.fmf,this.HGf,this.menuId);for(const rb of Ja)S+=rb;return S}yH(){return this.DE.Oic(this.nEe,this.gGe,this.NLe,this.fmf,void 0,void 0,void 0,this.HGf,this.menuId)}}Object(e.a)(lc,"RibbonColorPicker",null,[730]);var Zc=a(589);class dd{constructor(S,Ja){this._id=
S;this.wF=void 0===Ja?"":Ja}get id(){return this._id}get text(){return this.wF}get label(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Label property");}set label(S){throw Error.notImplemented("RibbonLabel doesn't have set implementation for the Label property");}get alt(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Alt property");}get disabled(){throw Error.notImplemented("RibbonLabel doesn't have get implementation for the Disabled property");
}i1(){return`<Label id="${this._id}" LabelText="${this.wF}" />`}EV(){throw Error.notImplemented("RibbonLabel doesn't have SetImage implementation ");}HSb(){throw Error.notImplemented("RibbonLabel doesn't have SetCustomizedImage implementation ");}g_(){throw Error.notImplemented("RibbonLabel doesn't have SetAlt implementation ");}M$b(){throw Error.notImplemented("RibbonLabel doesn't have ClearImage implementation ");}ula(){return Object(Nd.a)(new Zc.a,{Id:this.id,LabelText:this.text})}}Object(e.a)(dd,
"RibbonLabel",null,[818,729,730]);class Qd{constructor(S){this.lNg=[];this.id=S}get Le(){return this.lNg}i1(){return ud.q(this.yH())}yH(){const S=Object(Nd.a)(new Ud.a,{Id:this.id,UpdateDynamically:!0,MenuSectionList:[]});for(const Ja of this.Le)Object(Ka.a)(lc,Ja)?S.MenuSectionList.push(...Object(Bb.a)(lc,Ja).yH().MenuSectionList):S.MenuSectionList.push(Ja.e9b());return S}}Object(e.a)(Qd,"RibbonMenu",null,[817,730]);class ue{constructor(){this.title=null;this.W_=[];this.Ht="Menu16";this.lqg=this.Qkg=
this.Rkg=!0}get buttons(){return this.W_}i1(){return ud.r(this.e9b())}e9b(){const S=Object(Nd.a)(new $d.a,{ControlList:[]});if(1===this.buttons.length&&Object(Ka.a)(728,this.buttons[0]))S.ControlList.push(this.buttons[0].d9b());else{let rb="";for(let ma=0;ma<this.buttons.length;ma++){var Ja=Object(Bb.a)(729,this.buttons[ma]);Ja&&(Ja=Ja.ula(),S.ControlList.push(Ja),rb+=Ja.Id)}S.ControlsId=rb+".Controls"}S.Title=this.title;S.DisplayMode=this.Ht;S.ShowMenuSectionTitleIcon=this.Rkg;S.ShowMenuSectionTitleBackground=
this.Qkg;S.MenuSectionTitleFocusable=this.lqg;return S}}Object(e.a)(ue,"RibbonMenuSection",null,[250,730]);class qa{constructor(S,Ja,rb,ma,ib,Qb,Fc,jd,ke,ne,Te,Hb,Cc){Cc=void 0===Cc?null:Cc;this.id=S;this.command=rb;this.RXf=ma;this.populateOnlyOnce=ib;this.OUa=Qb;this.goj=Fc;this.alt=jd;this.v7b=ke;this.width=ne;this.f3g=Te;this.VS=Hb;this.Xua=new Qd(Ja);this.dFe=Cc;ma&&Fc&&(S=new ue,S.Ht="MenuLoading",Ja=new dd(Ja+"LoadingLabel"),S.buttons.push(Ja),this.menu.Le.push(S))}i1(){return this.F$g()}get menu(){return this.Xua}F$g(){let S=
ud.d(this.id,this.command,this.RXf,this.populateOnlyOnce,this.OUa,this.goj,this.alt,this.v7b,this.width);const Ja=S.indexOf(" />");S=S.substring(0,Ja);S+=` ${"AllowDefaultContent"}="${this.f3g.toString()}"`;S+=` ${"AutoComplete"}="${this.VS?"true":"false"}"`;this.dFe&&(S+=` ${"ArrowImgId"}="${this.dFe}"`);S=S+">"+this.menu.i1();return S+"</ComboBox>"}}Object(e.a)(qa,"RibbonComboBox",null,[820,730]);var Xa=a(1056),wb=a(930);class Rb extends wb.a{constructor(S,Ja,rb,ma,ib,Qb,Fc,jd,ke,ne,Te,Hb,Cc){Hb=
void 0===Hb?null:Hb;Cc=void 0===Cc?null:Cc;super(S,Ja,rb,ib,Qb,Fc,jd,Te,0);this.pob=null;this.O5=0===ke?null:xb.a.instance.ha(ke);this.hXc=ne;this.cZc=ma;this.ARg=Hb;this.qp=Cc}get description(){return this.O5}get IBb(){return this.pob}get menuItemId(){return this.hXc}get OUa(){return this.cZc}get styles(){return this.ARg}get data(){return this.qp}i1(){return ud.n(this.ula())}YZd(S){this.O5=S}toString(){this.IBb||(this.pob=this.i1());return this.IBb}ula(){const S=new Xa.a;this.Rgc(S);S.MenuItemId=
this.menuItemId;S.QueryCommand=this.OUa;S.Description=this.description;S.Styles=this.styles;S.Data=this.data;return S}}Object(e.a)(Rb,"RibbonComboBoxItem",wb.a,[251,729,730]);var vc=a(579);class Nc extends wb.a{constructor(S,Ja,rb,ma,ib,Qb,Fc,jd,ke){super(S,rb,ma,ib,Qb,Fc,jd,!1,0);this.populateOnlyOnce=!1;this.DIb=this.menuCloseCommand=this.menuOpenCommand=this.Qz=null;this.Xua=new Qd(Ja);this.onf=!0;this.G0c=ke}get menu(){return this.Xua}i1(){return ud.o(this.ula())}ula(){const S=new vc.a;this.Rgc(S);
S.PopulateOnlyOnce=this.populateOnlyOnce;S.MenuCloseCommand=null==this.menuCloseCommand?null:this.menuCloseCommand.toString();S.MenuOpenCommand=null==this.menuOpenCommand?null:this.menuOpenCommand.toString();S.PopulateQueryCommand=this.Qz;S.KeyTip=this.DIb;S.Menu=this.menu.yH();S.ImageIsVisible=this.onf;S.ExternalImageId=this.G0c;return S}}Object(e.a)(Nc,"RibbonFlyoutAnchor",wb.a,[252,729,730]);var id=a(1227),Id=a(599);class me{constructor(){this.E8a=[];this.id=null;this.width=0;this.title=this.Dma=
null}i1(){return ud.p(this.d9b())}jw(S,Ja,rb,ma,ib,Qb,Fc,jd,ke,ne){ma=void 0===ma?0:ma;ib=void 0===ib?null:ib;Qb=void 0===Qb?null:Qb;Fc=void 0===Fc?null:Fc;jd=void 0===jd?null:jd;ne=void 0===ne?null:ne;this.Qof(this.E8a.length,S,Ja,rb,0===ma?void 0===ke?null:ke:xb.a.instance.ha(ma),ib,Qb,Fc,jd,ne)}Qof(S,Ja,rb,ma,ib,Qb,Fc,jd,ke,ne){Qb=void 0===Qb?null:Qb;Fc=void 0===Fc?null:Fc;jd=void 0===jd?null:jd;ke=void 0===ke?null:ke;ne=void 0===ne?null:ne;(S>this.E8a.length||0>S)&&Error.argumentOutOfRange("Invalid Index");
this.E8a.splice(S,0,Object(Nd.a)(new id.a,{Id:Ja,Command:rb.toString(),QueryCommand:null!==ma&&void 0!==ma?ma:null,Alt:ib,MenuItemId:Qb,Icon:Fc,Image:jd?qc.a.Bj(jd):null,ImageClass:ke,LabelText:ne}))}d9b(S){S=void 0===S?!1:S;let Ja=null,rb=null;switch(this.Dma){case "Size120by20":Ja=this.nvb(120,20,S);rb=this.lvb(130,30,S);break;case "Size90by21":Ja=this.nvb(90,21,S);rb=this.lvb(100,33,S);break;case "Size24by24With7Options":Ja=this.nvb(24,24,S);rb=this.lvb(34,34,S);break;case "Size24by24":Ja=this.nvb(28,
28,S);rb=this.lvb(38,38,S);break;case "Size112by64":Ja=this.nvb(24,24,S),rb=this.lvb(112,64,S)}for(S=0;S<this.E8a.length;S++)this.E8a[S].FullIconStyle=Ja;return Object(Nd.a)(new Id.a,{Id:this.id,ExternalId:this.id,Type:4,Title:this.title,Width:this.width,ElementDimensions:this.Dma,GalleryItems:this.E8a,GalleryStyle:rb})}nvb(S,Ja,rb){const ma={},ib={};ib.width=S;ib.height=Ja;rb&&(ib.alignSelf="center",ib.marginBottom="4px");ma.root=ib;return ma}lvb(S,Ja,rb){const ma={},ib={},Qb={},Fc={};Qb.width=S;
Qb.height=Ja;ib.root=Qb;ib.rootFocused=Fc;rb&&(ib.flexContainer={display:"flex",flexDirection:"column",alignItems:"stretch"});J.EwaSettings.isChangeGateEnabled("OfficeVSO:8157094_AppGalleryButtonFocusChange")&&(Fc.selectors={".ms-Fabric--isFocusVisible &:focus, &:focus":{border:"none",background:"#EDEBE9"}});ma.galleryButtonInExpanded=ib;return ma}}Object(e.a)(me,"RibbonGallery",null,[728,730]);var Wb=a(1047);class Ec{constructor(S){this.DE=void 0===S?null:S}Pr(S){return new Qd(void 0===S?null:S)}Ze(){return new ue}Ld(S){var Ja=
Ua.a.Jf(Ec.F4a,S.toString());if(Ja)return Ja;switch(S){case 236:return this.Bp(S,"ContextMenu.Show.IdeasNLPane",-1336341324,743);case 237:return this.Bp(S,"ContextMenu.Show.IdeasNLPane",-1336341324,744);case 238:return this.Bp(S,"ContextMenu.Show.IdeasNLPane",-1336341324,745);case 249:return this.Ye(S,"ContextMenu.Show.ChartTaskPane",1221897806,Ba.a.E2e,4,983);case 287:return this.Ye(S,"ContextMenu.Show.ChartTaskPaneData",1930653487,null,4,890,void 0,void 0,"ChartSourceData_20");case 141:return this.Jk(S,
"DataLabels.None.BoxWhisker",374300079,Ba.a.m2e,929,930,1600);case 0:return this.Jk(S,"DataLabels.None.Column",374300079,Ba.a.l2e,929,930,1600);case 1:return this.Jk(S,"DataLabels.None.Line",374300079,Ba.a.n2e,929,930,1600);case 2:return this.Jk(S,"DataLabels.None.Pie",374300079,Ba.a.o2e,929,930,1600);case 3:return this.Jk(S,"DataLabels.Show.Column",-1809877936,Ba.a.Sfc,931,932,1601);case 143:return this.Jk(S,"DataLabels.Show.Funnel",-1809877936,Ba.a.Sfc,931,934,1601);case 144:return this.Jk(S,"DataLabels.Show.Treemap",
-1809877936,Ba.a.pjd,931,938,1601);case 145:return this.Jk(S,"DataLabels.Show.Sunburst",-1809877936,Ba.a.ojd,931,934,1601);case 4:return this.Jk(S,"DataLabels.Center.Column",-1996266048,Ba.a.Sfc,933,934,1602);case 5:return this.Jk(S,"DataLabels.Center.Line",-1996266048,Ba.a.g2e,933,934,1602);case 6:return this.Jk(S,"DataLabels.Center.Pie",-1996266048,Ba.a.ojd,933,934,1602);case 7:return this.Jk(S,"DataLabels.InsideEnd.Column",493396546,Ba.a.h2e,935,936,1603);case 8:return this.Jk(S,"DataLabels.InsideEnd.Pie",
493396546,Ba.a.i2e,935,936,1603);case 9:return this.Jk(S,"DataLabels.InsideBase.Column",1599247052,Ba.a.pjd,937,938,1604);case 10:return this.Jk(S,"DataLabels.OutsideEnd.Column",342855531,Ba.a.p2e,939,940,1605);case 11:return this.Jk(S,"DataLabels.OutsideEnd.Pie",342855531,Ba.a.q2e,939,940,1605);case 140:return this.Jk(S,"DataLabels.Left.BoxWhisker",-472675112,Ba.a.k2e,941,942,1606);case 12:return this.Jk(S,"DataLabels.Left.Line",-472675112,Ba.a.j2e,941,942,1606);case 142:return this.Jk(S,"DataLabels.Right.BoxWhisker",
-1774499423,Ba.a.s2e,943,944,1607);case 13:return this.Jk(S,"DataLabels.Right.Line",-1774499423,Ba.a.r2e,943,944,1607);case 138:return this.Jk(S,"DataLabels.Above.BoxWhisker",-204160914,Ba.a.c2e,945,946,1608);case 14:return this.Jk(S,"DataLabels.Above.Line",-204160914,Ba.a.t2e,945,946,1608);case 139:return this.Jk(S,"DataLabels.Below.BoxWhisker",-87783054,Ba.a.d2e,947,948,1609);case 15:return this.Jk(S,"DataLabels.Below.Line",-87783054,Ba.a.f2e,947,948,1609);case 16:return this.Jk(S,"DataLabels.BestFit.Pie",
1650379138,Ba.a.e2e,949,950,1610);case 17:return this.Jk(S,"Axes.Horizontal.None",895828731,Ba.a.S1e,929,951,1613);case 18:return this.Jk(S,"Axes.Horizontal.ShowLTR",683614408,Ba.a.mjd,952,953,1614);case 19:return this.Jk(S,"Axes.Horizontal.NoLabels",-1612014670,Ba.a.R1e,956,957,1615);case 20:return this.Jk(S,"Axes.Horizontal.ShowRTL",1259259728,Ba.a.T1e,958,959,1616);case 21:return this.Jk(S,"Axes.Horizontal.Default",683614408,Ba.a.mjd,954,955,1617);case 22:return this.Jk(S,"Axes.Horizontal.Thousands",
-220179662,Ba.a.U1e,960,961,1618);case 23:return this.Jk(S,"Axes.Horizontal.Millions",1534680966,Ba.a.Q1e,962,963,1619);case 24:return this.Jk(S,"Axes.Horizontal.Billions",-238895611,Ba.a.O1e,964,965,1620);case 25:return this.Jk(S,"Axes.Horizontal.LogScale",-892714755,Ba.a.P1e,966,967,1621);case 26:return this.Jk(S,"Axes.Vertical.None",2006508979,Ba.a.Z1e,929,951,1613);case 27:return this.Jk(S,"Axes.Vertical.Default",252405382,Ba.a.a2e,954,955,1617);case 28:return this.Jk(S,"Axes.Vertical.Thousands",
670842692,Ba.a.b2e,960,961,1618);case 29:return this.Jk(S,"Axes.Vertical.Millions",-572426128,Ba.a.X1e,962,963,1619);case 30:return this.Jk(S,"Axes.Vertical.Billions",-806496391,Ba.a.V1e,964,965,1620);case 31:return this.Jk(S,"Axes.Vertical.LogScale",-1700998151,Ba.a.W1e,966,967,1621);case 32:return this.Jk(S,"Axes.Vertical.NoLabels",2104548628,Ba.a.Y1e,956,957,1615);case 33:return this.Jk(S,"Axes.Vertical.ShowRTL",1717508862,Ba.a.$1e,958,959,1616);case 34:return this.Jk(S,"Gridlines.Horizontal.None",
80515665,Ba.a.y2e,929,970,1624);case 35:return this.Jk(S,"Gridlines.Horizontal.Major",-306129902,Ba.a.v2e,972,973,1625);case 36:return this.Jk(S,"Gridlines.Horizontal.Minor",2147076534,Ba.a.w2e,975,976,1626);case 37:return this.Jk(S,"Gridlines.Horizontal.MajorMinor",-1253752845,Ba.a.x2e,978,979,1627);case 38:return this.Jk(S,"Gridlines.Vertical.None",1711257557,Ba.a.D2e,929,971,1624);case 39:return this.Jk(S,"Gridlines.Vertical.Major",-1772953364,Ba.a.A2e,972,974,1625);case 40:return this.Jk(S,"Gridlines.Vertical.Minor",
680253336,Ba.a.B2e,975,977,1626);case 41:return this.Jk(S,"Gridlines.Vertical.MajorMinor",-215161981,Ba.a.C2e,978,980,1627);case 135:return this.Ye(S,"ContextMenu.NumberFormating",2105621672,Ba.a.djd,1,476,135!==S);case 300:return this.Ye(S,"ContextMenu.FormatCells",2055979337,null,1,477,300!==S,void 0,"PaintBrushandBucket_20");case 136:return this.Ye(S,"ContextMenu.NumberFormatingApplyToPivotField",-168056295,Ba.a.djd,1,476,136!==S);case 42:return this.Ye(S,"ContextMenu.Cut",-1985798686,Ba.a.p1e,
1,12);case 43:return this.Ye(S,"ContextMenu.Copy",-911352779,Ba.a.o1e,1,11);case 212:return this.Ye(S,"ContextMenu.InsertCopiedCells",-160032004,Ba.a.Fjd,3,15);case 213:return this.Ye(S,"ContextMenu.InsertCutCells",-1065525230,Ba.a.Fjd,3,21);case 44:case 57:return this.Ye(S,"ContextMenu.Paste",237279923,Ba.a.hjd,1,13,44!==S,"Paste");case 248:return this.Ye(S,"PasteAdvancedOptionsGallery",237279923,Ba.a.hjd,1,13,44!==S,"Paste");case 45:case 120:return this.Ye(S,"ContextMenu.EditHyperlink",-1583422759,
Ba.a.ujd,8,1140,45!==S,"EditHyperlink");case 46:case 121:return this.Ye(S,"ContextMenu.InsertHyperlink",-1583422759,Ba.a.ujd,8,1141,46!==S,"InsertHyperlink");case 47:case 122:return this.Ye(S,"ContextMenu.RemoveHyperlink",-1253126584,Ba.a.xjd,8,1142,47!==S,"RemoveHyperlink");case 48:case 123:return this.Ye(S,"ContextMenu.RemoveHyperlinks",-1253126584,Ba.a.xjd,8,1143,48!==S,"RemoveHyperlinks");case 250:return this.Bp(S,"ContextMenu.ContextMenuSmartLookup",-983891024,1810);case 187:case 188:case 165:case 173:return this.Ye(S,
"ContextMenu.InsertCellsShiftRight",1035996630,Ba.a.y1e,1,165===S||173===S?341:342,173===S||188===S,"InsertCellsShiftRight");case 166:case 174:return this.Ye(S,"ContextMenu.InsertCellsShiftDown",1035996630,Ba.a.x1e,1,344,166!==S,"InsertCellsShiftDown");case 189:case 190:case 167:case 175:return this.Ye(S,"ContextMenu.DeleteCellsShiftLeft",1035996630,Ba.a.s1e,1,167===S||175===S?342:341,175===S||190===S,"DeleteCellsShiftLeft");case 168:case 176:return this.Ye(S,"ContextMenu.DeleteCellsShiftUp",1035996630,
Ba.a.t1e,1,343,168!==S,"DeleteCellsShiftUp");case 177:case 181:return this.Ye(S,"ContextMenu.InsertRowsSheet",-1113896058,Ba.a.ejd,1,429,177!==S,"InsertRows");case 49:case 116:return this.Ye(S,"ContextMenu.InsertRows",-1113896058,Ba.a.ejd,1,346,49!==S,"InsertRows");case 161:case 169:return this.Ye(S,"ContextMenu.InsertRowsTable",942362098,Ba.a.A1e,1,421,161!==S,"InsertRowsTable");case 50:case 117:return this.Ye(S,"ContextMenu.InsertColumns",1415868706,Ba.a.mAb,1,406,50!==S,"InsertColumns");case 288:case 289:return this.Ye(S,
"ContextMenu.InsertColumns",1415868706,Ba.a.mAb,1,408,288!==S,"InsertColumns");case 178:case 182:return this.Ye(S,"ContextMenu.InsertColumnsSheet",1415868706,Ba.a.mAb,1,426,178!==S,"InsertColumns");case 290:case 291:return this.Ye(S,"ContextMenu.InsertColumnsSheet",1415868706,Ba.a.mAb,1,428,290!==S,"InsertColumns");case 191:case 192:case 162:case 170:return this.Ye(S,"ContextMenu.InsertColumnsTable",622604322,Ba.a.z1e,1,162===S||170===S?419:420,170===S||192===S,"InsertColumnsTable");case 179:case 183:return this.Ye(S,
"ContextMenu.DeleteRowsSheet",1554436520,Ba.a.Pfc,1,429,179!==S,"DeleteRows");case 51:case 118:return this.Ye(S,"ContextMenu.DeleteRows",1554436520,Ba.a.Pfc,1,410,51!==S,"DeleteRows");case 163:case 171:return this.Ye(S,"ContextMenu.DeleteRowsTable",1405456548,Ba.a.Pfc,1,418,163!==S,"DeleteRowsTable");case 180:case 184:return this.Ye(S,"ContextMenu.DeleteColumnsSheet",674605324,Ba.a.Ofc,1,426,180!==S,"DeleteColumns");case 52:case 119:return this.Ye(S,"ContextMenu.DeleteColumns",674605324,Ba.a.Ofc,
1,411,52!==S,"DeleteColumns");case 164:case 172:return this.Ye(S,"ContextMenu.DeleteColumnsTable",284490184,Ba.a.Ofc,1,417,164!==S,"DeleteColumnsTable");case 53:case 124:return this.Bp(S,"ContextMenu.OpenHyperlink",-1396319072,1144,53!==S,"OpenHyperlink");case 263:return this.Ye(S,"SheetOpsContextMenu.ShowChanges",1834994092,Ba.a.yjd,8,443,void 0,eb.a.n2j);case 264:return this.Ye(S,"GridContextMenu.ZoomFitToScreen",1409187195,null,8,1154,void 0,void 0,"FitToScreen_16");case 265:return this.Ye(S,"GridContextMenu.ZoomFitToScreenUndo",
-1836771825,null,8,1155,void 0,void 0,"RevertZoom_16");case 262:return this.Ye(S,"GridContextMenu.ShowChanges",1834994092,Ba.a.yjd,8,443,void 0,eb.a.sjg);case 54:return this.Ye(S,"ContextMenu.InsertSheet",-1935155518,Ba.a.B1e,1,514);case 56:case 127:return this.Ye(S,"ContextMenu.DeleteSheet",1880294140,Ba.a.v1e,1,515,56!==S,"DeleteSheet");case 55:return this.Bp(S,"ContextMenu.RenameSheet",817296323,516);case 125:case 126:return this.Bp(S,"ContextMenu.ReorderSheet",-383100692,517,125!==S,"ReorderSheet");
case 158:return this.Bp(S,"ContextMenu.DuplicateSheet",-1254662242,441);case 112:case 114:return this.Bp(S,"ContextMenu.HideSheet",1458540255,519,112!==S,"HideSheet");case 113:case 115:return this.Bp(S,"ContextMenu.UnhideSheet",1129633328,520,113!==S,"UnhideSheet");case 277:return this.Ye(S,"ContextMenu.ManageProtection",1723441034,null,8,1995,void 0,void 0,"ProtectSheet_20");case 278:return this.Ye(S,"ContextMenu.PauseProtection",-278145964,null,8,1996,void 0,void 0,"UnlockVariant_20");case 279:return this.Ye(S,
"ContextMenu.ResumeProtection",-278145964,null,8,1998,void 0,void 0,"ProtectForm_20");case 242:return this.Bp(S,"ContextMenu.PivotExpandCollapse",589118293,1167);case 243:return this.Ye(S,"ContextMenu.PivotExpand",-1687560254,Ba.a.jjd,9,1168);case 244:return this.Ye(S,"ContextMenu.PivotCollapse",1176256599,Ba.a.ijd,9,1169);case 245:return this.Ye(S,"ContextMenu.PivotExpandEntireField",-1751201991,Ba.a.jjd,9,1170);case 246:return this.Ye(S,"ContextMenu.PivotCollapseEntireField",-232434744,Ba.a.ijd,
9,1171);case 247:return this.Ye(S,"ContextMenu.PivotShowDetails",1771091375,null,17,1172,void 0,void 0,"PivotShowDetails_20");case 301:return this.Ye(S,"ContextMenu.DeletePivotTable",1885005049,null,17,2292,void 0,void 0,R.a.Pmj);case 306:return this.Ye(S,"ContextMenu.ManualUngroup",-1683649734,null,17,2347,void 0,void 0);case 307:return this.Ye(S,"ContextMenu.ManualGroup",660506187,null,17,2346,void 0,void 0);case 59:return this.Ye(S,"ContextMenu.PivotFieldListShow",2140436015,Ba.a.kjd,9,1173);case 58:return this.Ye(S,
"ContextMenu.PivotFieldListHide",-1006032470,Ba.a.kjd,9,1174);case 258:return this.Ye(S,"ContextMenu.PivotSettingsPaneShow",1529441790,Ba.a.oAb,17,636);case 257:return this.Ye(S,"ContextMenu.PivotSettingsPaneHide",1529441790,Ba.a.oAb,17,637);case 259:return this.Bp(S,"ContextMenu.PivotTableNoSubtotal",-2016405815,638);case 260:return this.Bp(S,"ContextMenu.PivotTableSubtotalOnTop",671485366,639);case 261:return this.Bp(S,"ContextMenu.PivotTableSubtotalOnBottom",772221736,640);case 60:case 64:return Ja=
60!==S,this.Bp(S,Ja?"ContextMenu.FieldWellMoveUpDisabled":"ContextMenu.FieldWellMoveUp",-1170196828,1089,Ja,null);case 61:case 65:return Ja=61!==S,this.Bp(S,Ja?"ContextMenu.FieldWellMoveDownDisabled":"ContextMenu.FieldWellMoveDown",-889576107,1090,Ja,null);case 62:case 66:return Ja=62!==S,this.Bp(S,Ja?"ContextMenu.FieldWellMoveToBeginningDisabled":"ContextMenu.FieldWellMoveToBeginning",389774337,1091,Ja,null);case 63:case 67:return Ja=63!==S,this.Bp(S,Ja?"ContextMenu.FieldWellMoveToEndDisabled":"ContextMenu.FieldWellMoveToEnd",
2033235475,1092,Ja,null);case 68:case 72:return Ja=68!==S,this.Ye(S,Ja?"ContextMenu.FieldWellMoveToReportFilterDisabled":"ContextMenu.FieldWellMoveToReportFilter",-96230454,Ba.a.Kfc,9,1093,Ja,null);case 69:case 73:return Ja=69!==S,this.Ye(S,Ja?"ContextMenu.FieldWellMoveToRowLabelsDisabled":"ContextMenu.FieldWellMoveToRowLabels",74086617,Ba.a.N7a,9,1094,Ja,null);case 70:case 74:return Ja=70!==S,this.Ye(S,Ja?"ContextMenu.FieldWellMoveToColumnLabelsDisabled":"ContextMenu.FieldWellMoveToColumnLabels",
1529312473,Ba.a.M7a,9,1095,Ja,null);case 71:case 75:return Ja=71!==S,this.Ye(S,Ja?"ContextMenu.FieldWellMoveToValuesDisabled":"ContextMenu.FieldWellMoveToValues",563292088,Ba.a.Lfc,9,1098,Ja,null);case 76:return this.Ye(S,"ContextMenu.FieldWellRemoveField",-1092351914,Ba.a.q1e,9,1099);case 77:return this.Ye(S,"ContextMenu.FieldWellValueFieldSettings",-2141589616,Ba.a.N1e,9,1100);case 79:case 83:return this.Ye(S,"ContextMenu.FieldListMoveToReportFilter",359279088,Ba.a.Kfc,9,1082,79!==S,null);case 80:case 84:return this.Ye(S,
"ContextMenu.FieldListMoveToRowLabels",-67292059,Ba.a.N7a,9,1083,80!==S,null);case 81:case 85:return this.Ye(S,"ContextMenu.FieldListMoveToColumnsLabels",745182485,Ba.a.M7a,9,1084,81!==S,null);case 82:case 86:return this.Ye(S,"ContextMenu.FieldListMoveToValues",926905850,Ba.a.Lfc,9,1087,82!==S,null);case 95:case 97:return Ja=95!==S,this.Ye(S,Ja?"ContextMenu.FieldWellMoveToRowChartLabelsDisabled":"ContextMenu.FieldWellMoveToRowChartLabels",74086617,Ba.a.N7a,9,1096,Ja,null);case 96:case 98:return Ja=
96!==S,this.Ye(S,Ja?"ContextMenu.FieldWellMoveToColumnChartLabelsDisabled":"ContextMenu.FieldWellMoveToColumnChartLabels",1529312473,Ba.a.M7a,9,1097,Ja,null);case 78:return this.Ye(S,"ContextMenu.FieldListAddAsSlicer",547535945,Ba.a.ajd,9,1088);case 91:case 93:return this.Ye(S,"ContextMenu.FieldListMoveToRowChartLabels",-67292059,Ba.a.N7a,9,1085,91!==S,null);case 92:case 94:return this.Ye(S,"ContextMenu.FieldListMoveToColumnChartLabels",745182485,Ba.a.M7a,9,1086,92!==S,null);case 99:return this.Ye(S,
"ContextMenu.BIExploreShowCallout",1529658657,Ba.a.Mfc,9,1193);case 100:return this.Ye(S,"ContextMenu.ContextMenuRefresh",2054778433,Ba.a.I1e,9,1181);case 102:return this.Ye(S,"ContextMenu.EditCell",324156914,Ba.a.wjd,8,579);case 101:return this.Ye(S,"Contextenu.DeleteChart",2045211913,Ba.a.Tfc,8,578);case 308:return this.Ye(S,"Contextmenu.DeleteChartElement",2045211913,Ba.a.Tfc,8,2358);case 146:return this.Ye(S,"Contextenu.AltText",1804967129,Ba.a.tjd,8,817);case 302:return this.Ye(S,"ContextMenu.CellImageAltText",
1516436924,Ba.a.tjd,8,817);case 147:return this.Ye(S,"ContextMenu.EditShapeText",-445658892,Ba.a.N2e,8,818);case 186:return this.Ye(S,"ContextMenu.ExitEditShapeText",1166778132,null,8,819);case 281:return this.Ye(S,"ContextMenu.BringForward",-1024854261,null,8,820,!1,"ContextMenu.BringForward",R.a.bringForward);case 282:return this.Ye(S,"ContextMenu.BringToFront",-1480025782,null,8,822,!1,"ContextMenu.BringToFront",R.a.bringToFront);case 283:return this.Ye(S,"ContextMenu.SendBackWard",565697619,null,
8,821,!1,"ContextMenu.SendBackWard",R.a.sendBackward);case 284:return this.Ye(S,"ContextMenu.SendToBack",-884976206,null,8,823,!1,"ContextMenu.SendToBack",R.a.sendToBack);case 273:return this.Ye(S,"ContextMenu.OfficeScriptsViewScript",-585097204,Ba.a.j1e,8,2151);case 160:return this.Ye(S,"ContextMenu.InsertComment",-1667294294,Ba.a.O2e,8,1146);case 221:return this.Ye(S,"ContextMenu.DeleteComment",467845448,Ba.a.M2e,8,1162);case 159:return this.Ye(S,"ContextMenu.InsertReply",-1667294294,Ba.a.P2e,8,
1145);case 226:return this.Ye(S,"ContextMenu.NewNote",2041505397,null,8,1156,void 0,void 0,"AddNoteboardNote_20");case 227:return this.Ye(S,"ContextMenu.EditNote",2041505397,null,8,1157,void 0,void 0,"EditNote_20");case 228:return this.Ye(S,"ContextMenu.DeleteNote",-865270283,null,8,1158,void 0,void 0,"DeleteNote_20");case 229:return this.Ye(S,"ContextMenu.ShowOrHideNote",1627476102,null,8,1159,void 0,void 0,"OLNoteYellow_20");case 230:return this.Bp(S,"ContextMenu.ConvertNote",-1565161385,1161);
case 103:return this.yX(S,"Form.InsertForm",1305810481,Ba.a.gjd,1,"Image16by16",1267,0,null,!1,1595);case 107:return this.yX(S,"Form.ViewForm",330035228,Ba.a.gjd,1,"Image16by16",1269,0,null,!1,1596);case 104:return this.yX(S,"Form.EditForm",1305810481,Ba.a.w1e,1,"Image16by16",1268,0,null,!1,1597);case 105:return this.yX(S,"Form.DeleteForm",-509039657,Ba.a.r1e,1,"Image16by16",1270,0,null,!1,1598);case 106:return this.yX(S,"Form.ShareForm",1334518759,Ba.a.J1e,1,"Image16by16",1271,0,null,!1,1599);case 148:case 149:return this.Bp(S,
"ContextMenu.ClearContent",-848953656,445,148!==S);case 150:case 151:return this.Ye(S,"ContextMenu.RowHeight",2040891415,Ba.a.Q2e,8,434,151===S);case 152:case 153:return this.Ye(S,"ContextMenu.ColumnWidth",957527587,Ba.a.L2e,8,433,153===S);case 108:case 154:return this.Bp(S,"ContextMenu.HideRows",1051390410,432,154===S);case 110:case 156:return this.Bp(S,"ContextMenu.UnhideRows",1542466017,439,156===S);case 109:case 155:return this.Bp(S,"ContextMenu.HideColumns",-706918724,438,155===S);case 111:case 157:return this.Bp(S,
"ContextMenu.UnhideColumns",369708605,440,157===S);case 216:return this.Bp(S,"ContextMenu.ShowCard",-843616717,1786,216!==S);case 217:return this.Bp(S,"ContextMenu.ShowImageDetails",-843616717,1787);case 303:return this.Ye(S,"ContextMenu.PlaceInCell",-700002548,null,8,2300,void 0,void 0,"PictureInCell_20");case 304:return this.Ye(S,"ContextMenu.PlaceOverCell",2000316912,null,8,2301,void 0,void 0,"InsertPictureSimple_20");case 305:return this.Ye(S,"ContextMenu.CreateReference",1983877126,null,8,2302,
void 0,void 0,"PictureLinked_20");case 215:case 268:return this.Bp(S,"ContextMenu.ConvertLinkedEntityToText",311599363,1784,268===S);case 218:case 269:return this.Bp(S,"ContextMenu.RefreshLinkedEntities",439914789,1788,269===S);case 220:case 271:return this.Bp(S,"ContextMenu.ShowLinkedEntityRefreshPane",-1753056834,1785,271===S);case 219:case 270:return this.Bp(S,"ContextMenu.ChangeLinkedEntityObject",2127195269,1796,270===S);case 234:return this.Ye(S,"ContextMenu.FilterClear",-1977666927,null,1,
220,void 0,void 0,"DeleteFilter_20");case 235:return this.Ye(S,"ContextMenu.FilterReapply",1549396389,null,1,221,void 0,void 0,"XLReapplyFilter_20");case 233:return this.Ye(S,"ContextMenu.FilterByValue",1803952894,null,1,222);case 313:return this.Ye(S,"ContextMenu.FilterByCellColor",486423932,null,1,2375);case 314:return this.Ye(S,"ContextMenu.FilterByCellFontColor",-652157481,null,1,2376);case 315:return this.Ye(S,"ContextMenu.FilterByCellIcon",-1656122924,null,1,2377);case 223:return this.Ye(S,
"ContextMenu.SortAscending",-1010737776,Ba.a.L1e,1,228);case 292:return this.Bp(S,"ContextMenu.PutSelectedCellColorOnTop",-1032691499,230);case 293:return this.Bp(S,"ContextMenu.PutSelectedFontColorOnTop",-764711886,231);case 294:return this.Bp(S,"ContextMenu.PutSelectedFormattingIconOnTop",-2016161444,232);case 224:return this.Ye(S,"ContextMenu.SortDescending",2123420468,Ba.a.M1e,1,229);case 225:return this.Ye(S,"ContextMenu.SortCustom",-207540907,Ba.a.Rfc,1,233);case 232:return this.Ye(S,"ContextMenu.ConvertToRange",
323142015,Ba.a.n1e,1,740);case 272:return this.Ye(S,"ContextMenu.ShowOpenInAppDialogOnMobile",213236505,Ba.a.wjd,8,661);case 239:return this.Ye(S,"ContextMenu.IgnoreError",886009118,Ba.a.vjd,8,2112,239!==S);case 240:return this.Ye(S,"ContextMenu.IgnoreErrors",886009118,Ba.a.vjd,8,2113,240!==S);case 241:return this.Bp(S,"ContextMenu.ShowError",-1779556985,2114,241!==S);case 251:return this.Ye(S,"ContextMenu.SlicerRefresh",-231711729,Ba.a.H1e,0,2177,251!==S);case 252:return this.Ye(S,"ContextMenu.SlicerClearFilter",
-1909381757,Ba.a.u1e,0,2178,252!==S);case 254:return this.Bp(S,"ContextMenu.SlicerDelete",2045211913,2181,254!==S);case 253:return this.Ye(S,"ContextMenu.SlicerMultiSelect",2108047455,Ba.a.fjd,0,2180,253!==S);case 255:return this.Ye(S,"ContextMenu.SlicerSortAscending",-923375148,Ba.a.Vfc,8,2183,255!==S);case 256:return this.Ye(S,"ContextMenu.SlicerSortDescending",1164937340,Ba.a.Wfc,8,2182,256!==S);case 267:return this.Ye(S,"ContextMenu.SlicerSettingsPaneShow",522377926,Ba.a.oAb,17,636);case 266:return this.Ye(S,
"ContextMenu.SlicerSettingsPaneHide",522377926,Ba.a.oAb,17,637);case 128:return this.qxa(S,-619033944,1,1438);case 129:return this.qxa(S,-619033944,2,1440);case 130:return this.qxa(S,-619033944,3,1442);case 131:return this.qxa(S,-619033944,4,1443);case 132:return this.z7(S,-1736601456,7,1447);case 133:return this.z7(S,-1736601456,8,1449);case 134:return this.z7(S,-1736601456,0,1450);case 196:return this.qxa(S,-2136556471,1,1438);case 198:return this.qxa(S,-2136556471,2,1440);case 200:return this.qxa(S,
-2136556471,3,1442);case 201:return this.qxa(S,-2136556471,4,1443);case 204:return this.z7(S,1201641489,0,1447);case 205:return this.z7(S,1201641489,1,1448);case 206:return this.z7(S,1201641489,7,1449);case 207:return this.z7(S,1201641489,2,1450);case 208:return this.z7(S,1201641489,4,1451);case 209:return this.z7(S,1201641489,3,1452);case 210:return this.z7(S,1201641489,5,1453);case 211:return this.z7(S,1201641489,6,1454);case 274:return this.Ye(S,"ContextMenu.ShareChart",353606613,null,1,2261,void 0,
void 0,"ShareSectionEntry_20");case 275:return this.Ye(S,"ContextMenu.ShareRange",-1099009678,null,1,2262,void 0,void 0,"ShareSectionEntry_20");case 276:return this.Ye(S,"ContextMenu.ShareTable",192430811,null,1,2263,void 0,void 0,"ShareSectionEntry_20");case 317:case 318:return this.Ye(S,"ContextMenu.ShareNamedSheetView",-1592351768,null,1,2382,318===S,void 0,"ShareSectionEntry_20");case 320:return this.Ye(S,"ContextMenu.SaveNamedSheetView",621685370,null,3,2383,void 0,void 0,"WdLegoCreateTable_20");
case 319:return this.Ye(S,"ContextMenu.ExitNamedSheetView",1690118309,null,3,2381,void 0,void 0,"ExitSheetView_20");case 299:return this.Ye(S,"ContextMenu.ShareSheet",783415632,null,1,2264,void 0,void 0,"ShareSectionEntry_20");case 312:return this.Ye(S,"ContextMenu.ShareSheet",783415632,null,1,2374,void 0,void 0,"ShareSectionEntry_20");case 309:return this.Ye(S,"ContextMenu.FlyoutShareSheet",783415632,null,1,2355,void 0,void 0);case 310:return this.Ye(S,"ContextMenu.FlyoutShareRange",-1099009678,
null,1,2356,void 0,void 0);case 311:return this.Ye(S,"ContextMenu.FlyoutShareTable",192430811,null,1,2357,void 0,void 0);case 285:return this.Ye(S,"ContextMenu.ToggleTotalRow",2128797448,null,1,741,void 0,void 0,"ToggleTotalRow_20");case 286:return this.Ye(S,"ContextMenu.TableAltText",-723113214,null,1,817,void 0,void 0,"ShowTableAltTextDlg_20")}return null}yX(S,Ja,rb,ma,ib,Qb,Fc,jd,ke,ne,Te,Hb){Ja=new jb.a(Ja,Fc,rb,null,ib,ma,Qb,Fc,jd,ke,ne,Te,!0,void 0===Hb?null:Hb);return Ec.F4a[S.toString()]=
Ja}Ye(S,Ja,rb,ma,ib,Qb,Fc,jd,ke){ke=void 0===ke?null:ke;return this.yX(S,Ja,rb,ke?null:ma,ib,"Image16by16",Qb,0,void 0===jd?null:jd,void 0===Fc?!1:Fc,0,ke)}Edd(S,Ja,rb,ma,ib,Qb){return new Rb(S,0,-1006427574,null,rb,Ja,ma,0,0,ib,!1,null,void 0===Qb?null:Qb)}sRe(S,Ja){return new dd(S,void 0===Ja?"":Ja)}aph(S,Ja,rb,ma){return new Wb.a(S,0,Ja,null,8,null,"None",0,0,null,!1,0,rb,ma)}yMa(S,Ja,rb,ma,ib,Qb,Fc,jd,ke){jd=void 0===jd?null:jd;ke=void 0===ke?!1:ke;let ne=Ua.a.Jf(Ec.F4a,S);if(ne)return ne;ne=
new jb.a(S,0,rb,null,3,null,"None",0,0,Qb,Fc,0);ne.g_(Ja);ne.label=Ja;ne.YZd(ke?null:Ja);ne.HSb(ib,ma,jd);return Ec.F4a[S]=ne}pTd(S){this.Cxd(S)&&delete Ec.F4a[S]}Cxd(S){return S in Ec.F4a}sy(S,Ja,rb,ma){S=new Nc(S,Ja,0,ma,3,null,"None",0);S.g_(rb);S.label=rb;return S}X5a(S,Ja,rb,ma,ib,Qb,Fc){S=new Nc(S,Ja,0,ma,ib,Fc?null:Qb,"Image16by16",0,Fc);S.g_(rb);S.label=rb;return S}Exb(S,Ja,rb,ma,ib){return new lc(this.DE,S,null,null,void 0===Ja?null:Ja,null,void 0===rb?null:rb,void 0===ma?null:ma,void 0===
ib?null:ib)}TF(S,Ja,rb,ma){rb=void 0===rb?null:rb;ma=void 0===ma?null:ma;return Object(Nd.a)(new me,{id:S,width:Ja,Dma:rb,title:ma})}Jk(S,Ja,rb,ma,ib,Qb,Fc){return this.yX(S,Ja,rb,ma,4,"Image32by32",ib,Qb,null,!1,Fc)}Bp(S,Ja,rb,ma,ib,Qb){return this.yX(S,Ja,rb,null,1,"None",ma,0,void 0===Qb?null:Qb,void 0===ib?!1:ib,0)}jQe(S,Ja,rb,ma,ib,Qb){return this.yX(S,Ja,rb,ma,4,"Image16by16",ib,0,Qb.toString(),!1,0)}z7(S,Ja,rb,ma){return this.jQe(S,"OutlineDashStylePresent,"+rb,Ja,Ba.a.Nfc,ma,rb)}qxa(S,Ja,
rb,ma){return this.jQe(S,"OutlineWidthPresent,"+rb,Ja,Ba.a.Qfc,ma,rb)}}Ec.F4a={};Object(e.a)(Ec,"RibbonControlsManager",null,[714]);class hd extends U.a{constructor(S){super();this.Wa=null;this.$=S;this.Oe()}create(){var S=this.$;const Ja=la.GetServiceTaskFactory.create(S.ia,111,this.ma,this.$a);S=J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(ra.d)(fa.a.resolve(ha.E,{Oa:this.$a})):la.GetServiceTaskFactory.create(S.ia,155,this.ma,this.$a);L.TaskExtensions.Aa(L.TaskExtensions.Tg([Ja,
S],this.ma),()=>{this.ve(this.Wa||(this.Wa=new Ec(Ja.result)))},this.ma,3)}static la(S){S.ia.Va(102,new hd(S))}}Object(e.a)(hd,"RibbonControlsFactory",U.a,[]);var je=a(734),Ee=a(893);let Ge=class{constructor(S){this.yCa=S}pD(S,Ja){return this.yCa?this.yCa.pD(S,Ja).then(rb=>{rb.IsSuccess||k.ULS.sendTraceTag(51401292,0,15,"Error retrieving auth token. Message: "+rb.ErrorMessage+" Error code: "+rb.ErrorCode+" App name: "+S);return Object(Nd.a)(new Ee.a,{IsSuccess:rb.IsSuccess,Token:rb.Token,ErrorCode:rb.ErrorCode,
ErrorMessage:rb.ErrorMessage})}):(k.ULS.sendTraceTag(537154971,0,10,"Oauth manager is null"),Promise.resolve(Object(Nd.a)(new Ee.a,{IsSuccess:!1,Token:null,ErrorCode:"FailedToResolve",ErrorMessage:"Failed to resolve IOAuthManager from the container."})))}qab(){return this.yCa?this.yCa.qab():null}};Ge=Object(je.a)([Object(fa.d)(ha.jc),Object(je.b)(0,Object(ha.ic)())],Ge);Object(e.a)(Ge,"OAuthManagerWrapper",null,[673]);Object(fa.b)(ha.ic)(()=>F.a.instance.resolve("Common.App.OAuth.IOAuthManager"));
var bf=a(192),of=a(32);class hf{constructor(S){this.keyPath=S}}Object(e.a)(hf,"KeyPathClass",null,[]);let na=class extends bf.a{constructor(S){super();this.Vjb=this.Ped=null;this.KTe=1;this.l0a=null;this.$=S}get indexedDBFactory(){this.l0a||(window.indexedDB?this.l0a=window.indexedDB:window.webkitIndexedDB?this.l0a=window.webkitIndexedDB:window.mozIndexedDB?this.l0a=window.mozIndexedDB:window.msIndexedDB&&(this.l0a=window.msIndexedDB));return this.l0a}get initialized(){return!!this.Ped&&!!this.Vjb}initialize(S,
Ja,rb){this.Ped=S;this.Vjb=Ja;this.KTe=rb}li(){try{return J.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&y.a.BRa||y.a.Zh&&91===y.a.QAb?!1:!!this.indexedDBFactory&&"undefined"!==typeof this.indexedDBFactory.open}catch(S){return k.ULS.sendTraceTag(537157640,0,15,`IndexedDB.IsSupported() failed. Exception: ${S.message}`),!1}}lib(S){return this.li()&&this.initialized?L.TaskExtensions.Xla(this.kNd(),Ja=>{if(void 0===Ja.result&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;
Ja=Ja.result;this.Hbc(Ja);const rb=of.a.Jd.Og.m;this.Erd(Ja,!1).put(S);k.ULS.sendTraceTag(537157638,0,50,`IndexedDB.SaveToIndexedDB takes ${of.a.Jd.Og.m-rb} Millisecond.`);return!0},this.ma):(k.ULS.sendTraceTag(537157639,0,15,"IndexedDB.SaveToIndexedDB: not supported or wasn't initilized."),Ca.Task.Ua(!1))}zfd(S){return this.li()&&this.initialized?L.TaskExtensions.Xla(this.kNd(),Ja=>{if(void 0===Ja.result&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash"))return!1;
Ja=Ja.result;this.Hbc(Ja);const rb=of.a.Jd.Og.m;this.Erd(Ja,!1)["delete"](S);k.ULS.sendTraceTag(537157636,0,50,`IndexedDB.DeleteFromIndexedDB takes ${of.a.Jd.Og.m-rb} Millisecond.`);return!0},this.ma):(k.ULS.sendTraceTag(537157637,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),Ca.Task.Ua(!1))}q9a(S){return this.li()&&this.initialized?L.TaskExtensions.gnh(this.kNd(),Ja=>void 0===Ja.result&&J.EwaSettings.isChangeGateEnabled("OfficeVSO:6476652_SuppressCouldntOpenIndexedDbJsCrash")?
Ca.Task.Ua(""):this.w9h(Ja.result,S),this.ma):(k.ULS.sendTraceTag(537157635,0,15,"IndexedDB.DeleteFromIndexedDB: not supported or wasn't initilized."),Ca.Task.Ua(""))}Hbc(S){S.objectStoreNames.contains(this.Vjb)||S.createObjectStore(this.Vjb,new hf("key"))}kNd(){const S=new pc.a;let Ja;Ja=this.indexedDBFactory.open(this.Ped,this.KTe);Ja.onsuccess=()=>{const rb=Ja.result;k.ULS.sendTraceTag(537157634,0,50,`OpenIndexedDB ${rb.name} success`);S.setResult(rb)};Ja.onupgradeneeded=()=>{const rb=Ja.result;
k.ULS.sendTraceTag(520902218,0,50,`OpenIndexedDB ${rb.name} upgrade needed`);try{this.Hbc(rb),k.ULS.sendTraceTag(520902217,0,50,`OpenIndexedDB ${rb.name} upgrade done`)}catch(ma){k.ULS.sendTraceTag(520902216,0,10,`OpenIndexedDB upgrade failed: ${ma}`),J.EwaSettings.isChangeGateEnabled("OfficeVSO:6463223_Bug6241905")?S.setResult(void 0):S.setException(Error.create("Failed to upgrade IndexedDB"))}};Ja.onerror=rb=>{k.ULS.sendTraceTag(588288084,0,50,`OpenIndexedDB ${rb} failed`);S.setResult(void 0)};
return S.task}Erd(S,Ja){return S.transaction([this.Vjb],Ja?"readonly":"readwrite").objectStore(this.Vjb)}w9h(S,Ja){const rb=new pc.a;this.Hbc(S);const ma=of.a.Jd.Og.m,ib=this.Erd(S,!0).get(Ja);ib.onsuccess=Qb=>{(Qb=Qb.target.result)?(rb.setResult(Qb.value),k.ULS.sendTraceTag(537157633,0,50,`IndexedDB.GetFromIndexedDB takes ${of.a.Jd.Og.m-ma} Millisecond.`)):rb.setResult("")};ib.onerror=()=>{rb.setException(Error.create(ib.error?ib.error.message:"DB error"))};return rb.task}};na=Object(je.a)([Object(fa.d)(ha.Ob,
{nr:"transient"}),Object(je.b)(0,Object(ha.fb)())],na);Object(e.a)(na,"IndexedDB",bf.a,[672]);Type.registerNamespace("Common.App.OAuth");I.main();H.a.Pk(".ewa-svg-icon{height:100%;width:100%}");N.a.Ia(Z.la);H.a.Pk('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
(()=>{N.a.Ia(S=>{J.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSheetTabBar",!1)||se.la(S);Oa.la(S)})})();(()=>{N.a.Ia(S=>{Wc.la(S)})})();(()=>{N.a.Ia(S=>{new be(S.ia,S)})})();N.a.Ia(hd.la);String(c);String(h);String(f);String(b);window.___1692616129324_closurehack=c;window.___1692616129324_closurehack=h;window.___1692616129324_closurehack=f;window.___1692616129324_closurehack=b},896:function(w,B,a){a.r(B);w=a(0);var b=a(16),c=a(1324),h=a(984),f;(function(Z){Z[Z.external=0]="external";
Z[Z.Sxk=1]="msa";Z[Z.Bvk=2]="aad"})(f||(f={}));Object(w.b)("AuthorityType",f);var e=a(807);class k{constructor(Z){this.oNg=Z}initialize(){return Promise.resolve(0)}btc(){return Promise.resolve(0)}pD(){b.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new e.a,{IsSuccess:!0,Token:this.oNg}))}lKc(){return Promise.resolve(Object.assign(new e.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}JIc(){return!1}oDb(){return"MockAuthTokenStrategy"}}
Object(w.a)(k,"MockAuthTokenStrategy",null,[225]);var l=a(1002);class r{static get(Z,wa,la){if(!la)return Z;let ta=0;return Promise.race([Z,new Promise(Ca=>{ta=window.setTimeout(()=>{Ca(wa)},la)})]).then(Ca=>{window.clearTimeout(ta);return Promise.resolve(Ca)}).catch(()=>{window.clearTimeout(ta);return Promise.resolve(wa)})}}Object(w.a)(r,"PromiseWithTimeout",null,[]);var v=a(5),u=a(527);class x{constructor(Z,wa,la,ta,Ca){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=Z;this.scope=wa;this.silentLogin=la;this.options=ta;this.correlationId=Ca}}Object(w.a)(x,"TokenRequestParameters",null,[232]);var t=a(30),m=a(81);class n{constructor(){this.Bwe=null;let Z=v.AFrameworkApplication.da.Ra(v.AFrameworkApplication.$aa),wa=v.AFrameworkApplication.da.Ra(v.AFrameworkApplication.Ssg);this.U1a=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",Z&&""!==Z?Z:"Unspecified",wa&&""!==wa?wa:"Unspecified")}initialize(){return new Promise(Z=>
{m.a.instance.ie("Common.App.WopiIdentity.IWopiIdentity").execute(wa=>{this.Bwe=wa;Z(0)})})}om(Z){const wa=["HTTPS:","API:"];let la=!1;const ta=Z.toLocaleUpperCase();for(const Ca of wa)if(ta.startsWith(Ca)){la=!0;break}return la||this.MGi(Z)?Z+"/.default":Z}MGi(Z){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(Z)}btc(){return Promise.resolve(0)}pD(Z,wa,la,ta,Ca,Ga,Oa){if(t.a.rBa){Ca=u.a.xrk;if(!Ca)return wa=Object.assign(new e.a,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",
ErrorMessage:"No app list was found."}),Promise.resolve(wa);if(!Array.contains(Ca,Z))return wa=Object.assign(new e.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+Z}),Promise.resolve(wa)}Z=this.om(la);la=new x(la,Z,!ta,null,v.AFrameworkApplication.userSessionId);return this.Bwe.getAccessToken(la,wa,Oa).then(eb=>Object.assign(new e.a,{IsSuccess:!0,Token:eb.accessToken}),eb=>Object.assign(new e.a,{IsSuccess:!1,ErrorCode:eb}))}lKc(){return Promise.resolve(Object.assign(new e.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}JIc(){return!1}oDb(){return this.U1a}}Object(w.a)(n,"ParentFrameTokenStrategy",null,[225]);var A=a(903),y=a(198);class z{constructor(){this.reject=this.resolve=null;this.startTime=0;this.B_f=this.sGe=null}}Object(w.a)(z,"PromiseWrapper",null,[]);class F{constructor(Z){Z=void 0===Z?0:Z;this.jF=0;this.zqb=!1;this.wq=new y.a;this._timeout=Z}enqueue(Z){return new Promise((wa,
la)=>{this.wq.add(Object.assign(new z,{B_f:Z,resolve:wa,reject:la}));this.process()})}process(){if(this.zqb||this.jF===this.wq.count)return!1;const Z=this.wq.ka(this.jF++);try{this.zqb=!0,Z.B_f().then(wa=>{this.zqb=!1;this.pbd(Z,wa,null,!0)}).catch(wa=>{this.zqb=!1;this.pbd(Z,null,wa,!1)})}catch(wa){this.zqb=!1,this.pbd(Z,null,wa,!1)}return!0}pbd(Z,wa,la,ta){if(ta){const Ca=()=>{Z.resolve(wa);this.process()};0<this._timeout?window.setTimeout(()=>{Ca()},this._timeout):Ca()}else{const Ca=()=>{Z.reject(la);
this.process()};0<this._timeout?window.setTimeout(()=>{Ca()},this._timeout):Ca()}}}Object(w.a)(F,"PromiseQueue",null,[]);class D{constructor(){this.correlationId=this.resolve=null}}Object(w.a)(D,"ResolveWithCorrelation",null,[]);var I=a(143),H=a(153),N=a(780),U=a(157);class L extends H.a{constructor(Z,wa,la,ta,Ca,Ga){super(!1,!1,!0);this.sge=this.J5=null;this.lgj=()=>{this.k7e()};this.prh=()=>this.fw;this.DYj=Oa=>{0===Oa&&(this.ISg.reject(Object.assign(new e.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),
this.mIa(null))};this.C0=Z;this.TOg=la;this.Vy=ta;this.ISg=Ca;this.mIa=Ga;this.fw=document.createElement("iframe");this.fw.id="SharedAuthInteractiveFrame";this.fw.setAttribute("name","SharedAuthInteractiveFrame");this.fw.setAttribute("title","SharedAuthInteractiveFrame");this.fw.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.fw.style.border="0";this.fw.style.height="48px";this.fw.style.width="190px";$addHandler(this.fw,"error",this.lgj);Z=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",
this.C0,wa,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",v.AFrameworkApplication.userType);this.fw.src=Z;this.sIg=new Promise(Oa=>{this.sge=Oa});this.tge=!1}NGc(){this.J5={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.TOg,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:v.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:this.prh,["resolveDialogStyles"]:this.sge}};this.ke=5;this.initializeAndShow(CommonUIStrings.l_SignIn,
this.DYj,this.J5)}YYa(Z,wa,la){Z=void 0===Z?!1:Z;wa=void 0===wa?!1:wa;la=void 0===la?5:la;this.J5&&this.J5.bodyControls&&(Z!==Object(I.a)(Object,this.J5.bodyControls).frameLoaded&&(Object(I.a)(Object,this.J5.bodyControls).frameLoaded=Z),wa!==Object(I.a)(Object,this.J5.bodyControls).frameLoadSuccess&&(Object(I.a)(Object,this.J5.bodyControls).frameLoadSuccess=wa),la!==this.J5.dialogButtonsOption&&(this.J5.dialogButtonsOption=null,this.ke=la),this.update(this.J5))}y4j(Z,wa){const la=new N.a(U.a.HYj);
la.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:v.AFrameworkApplication.isRtl,["messageCorrelationId"]:Z,["dialogStyles"]:wa};this.Vy.taa(la,this.fw.contentWindow,this.C0)}k7e(){this.YYa(!0,!1,6)}get mhg(){return this.fw}get MAh(){return this.sIg.then(Z=>{this.tge=!0;return Z})}get NAh(){return this.tge}}Object(w.a)(L,"SharedAuthConsentDialog",H.a,[230]);var J=a(901),P=a(102),K=a(147),ca=a(39),T=a(181),Q=a(177);class fa{constructor(){this.fw=
null;this.$_b=0;this.Mpb=this.j2a=this.POc=this.mIa=this.rP=this.xve=null;this.jbj=()=>{const Z=ca.a.lg()-this.$_b;b.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",Z)};this.Qwc=Z=>{const {OAuthManager:wa}=a(896),la=ca.a.lg()-this.$_b,ta=Object.assign(new Q.a,{durationMs:la});P.Health.instance.recordKpiFailure(wa.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,ta);b.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",la,
this.mhe?JSON.stringify(Z):"")};this.Efj=Z=>{const {OAuthManager:wa}=a(896),la=this.mva.loadFrame;var ta=ca.a.lg()-la.startTime,Ca=Z.Values.AuthLibrary.toString();Z=Z.Values.Success.toString();b.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",Z,Ca,ta);Ca&&(this.U1a="SharedAuthTokenStrategy "+Ca);Ca=Boolean.parse(Z);Ca||(Z=K.a.mu(),void 0!==Z&&null!==Z&&(Z.set("AuthLibrary",this.oDb()),ta=Object.assign(new Q.a,{durationMs:ta,extendedProperties:Z}),
P.Health.instance.recordKpiFailure(wa.kpiName,"SharedAuthStrategyInitFailed",!1,!0,ta)));la.resolve(Ca?0:1)};this.Dfj=Z=>{if(Z.Values.interactive&&this.j2a&&this.j2a.Values.messageCorrelationId){const la=this.j2a.Values.messageCorrelationId.toString();if(Z.Values.interactive&&this.rP){this.rP.MAh.then(ta=>{this.Vy.taa(this.j2a,this.rP.mhg.contentWindow,this.C0);this.rP.y4j(la,ta);this.rP.YYa(!0,!0);this.j2a=null});return}}Z=this.mva.initFrame;const wa=ca.a.lg()-Z.startTime;b.ULS.sendTraceTag(573112903,
3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",wa);Z.resolve(0)};this.Jaj=Z=>{if(Z.Values.messageCorrelationId&&Z.Values.messageCorrelationId.toString()){var wa=Z.Values.messageCorrelationId.toString(),la=this.mva[wa];if(la){var ta=ca.a.lg()-la.startTime;b.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",ta);Z.Values.isSuccess&&Z.Values.isSuccess?la.resolve(Z.Values.response):la.reject(Z.Values.response);this.wsg(wa)}else b.ULS.sendTraceTag(573112905,
3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else b.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")};this.Gbj=()=>{if(this.rP.NAh)this.rP.k7e();else if(this.POc&&this.rP){const Z=new N.a(U.a.phg);Z.Values=this.OFe(this.POc,!0);this.Vy.taa(Z,this.rP.mhg.contentWindow,this.C0)}};this.dbj=()=>{this.rP&&this.rP.z$a()};this.E6i=Z=>{Z.Values.cancelled&&Z.Values.cancelled&&Z.Values.messageCorrelationId&&
this.wsg(Z.Values.messageCorrelationId.toString());this.rP&&this.rP.hide()};this.Bcj=Z=>{if(Z.Values.messageCorrelationId&&Z.Values.messageCorrelationId.toString()){var wa=this.mva[Z.Values.messageCorrelationId.toString()];if(wa){var la=ca.a.lg()-wa.startTime;b.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",la);Z.Values.isSuccess&&Z.Values.isSuccess?wa.resolve(Z.Values.response):wa.reject(Z.Values.response)}else b.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else b.ULS.sendTraceTag(555049439,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")};this.Vy=new J.a(null,null);this.U1a="SharedAuthTokenStrategy Unloaded";this.C0=u.a.FYj;this.xte=u.a.EYj;this.mhe=u.a.enableConsoleLogging;this.MIg=v.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.dRg=v.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.XSg=v.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedWebWorkerEnabled",
!1);this.mva={};this.gLg=new F(1500)}oDb(){return this.U1a}initialize(){var {OAuthManager:Z}=a(896);if("loadFrame"in this.mva)return this.mva.loadFrame.sGe;if(!this.C0)return P.Health.instance.recordKpiFailure(Z.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),b.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);Z=this.nIc("loadFrame");this.$_b=ca.a.lg();var wa=this.C0+this.xte+"?replyUrl="+window.location.protocol+"//"+window.location.host+
"&usid="+v.AFrameworkApplication.userSessionId+"&WacUserType="+v.AFrameworkApplication.userType;this.XSg&&(wa+="&webworker=1");this.fw=document.createElement("iframe");this.uQa(this.fw);this.fw.style.cssText="height:0;width:0;display:none;";this.fw.id="SharedAuthFrame";this.fw.setAttribute("name","SharedAuthFrame");this.fw.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.fw.setAttribute("title","SharedAuthFrame");this.fw.src=wa;document.body.appendChild(this.fw);
wa=ca.a.lg()-this.$_b;b.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",wa,this.fw.src);return Z}btc(Z){this.POc=Z;const wa=new N.a(U.a.phg);wa.Values=this.OFe(Z);Z=this.nIc("initFrame");this.Vy.taa(wa,this.fw.contentWindow,this.C0);b.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return Z}pD(Z,wa,la,ta,Ca,Ga){const Oa=new N.a(U.a.IYj),eb=this.kff();Oa.Values=this.gsg(Z,
wa,la,ta,Ca,Ga,eb);Z=this.nIc(eb);ta&&v.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.gLg.enqueue(()=>new Promise(nb=>{this.Fgk(Ga,Oa,nb,eb)})):(this.Vy.taa(Oa,this.fw.contentWindow,this.C0),b.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",wa));return Z}Fgk(Z,wa,la,ta){const Ca=this.mva[ta];Ca&&(this.j2a=wa,this.mIa=Object.assign(new D,{resolve:la,correlationId:ta}),this.rP=
new L(this.C0,this.xte,Z,this.Vy,Ca,la),this.rP.NGc())}kff(){return T.a.create().toString()}gsg(Z,wa,la,ta,Ca,Ga,Oa){const eb={};eb.appName=Z;eb.appId=wa;eb.target=la;eb.withPopup=ta;eb.claims=Ca;eb.promptMessage=Ga;eb.messageCorrelationId=Oa;return eb}uQa(Z){$addHandler(Z,"load",this.jbj);$addHandler(Z,"error",this.Qwc);this.Vy.KS(this.C0);this.Vy.yn(U.a.shg);this.Vy.tm(U.a.shg,this.Efj);this.Vy.yn(U.a.rhg);this.Vy.tm(U.a.rhg,this.Dfj);this.Vy.yn(U.a.nhg);this.Vy.tm(U.a.nhg,this.Jaj);this.Vy.yn(U.a.thg);
this.Vy.tm(U.a.thg,this.Bcj);this.Vy.yn(U.a.qhg);this.Vy.tm(U.a.qhg,this.Gbj);this.Vy.yn(U.a.ohg);this.Vy.tm(U.a.ohg,this.dbj);this.Vy.yn(U.a.lhg);this.Vy.tm(U.a.lhg,this.E6i)}nIc(Z){const wa=new z;wa.startTime=ca.a.lg();const la=new Promise((ta,Ca)=>{wa.resolve=ta;wa.reject=Ca});wa.sGe=la;this.mva[Z]=wa;return la}OFe(Z,wa){wa=void 0===wa?!1:wa;const la={};la.appIds=this.g2h();la.upn=Z.loginHint;la.authority=Z.authority;la.authorityType=Object(c.a)(f,Z.authorityType);la.tenantId=Z.tenantId;la.correlationId=
v.AFrameworkApplication.userSessionId;la.enableConsoleLogging=this.mhe;la.enablePopupFlash=this.MIg;la.skipUpnCheck=this.dRg;la.interactive=wa;return la}g2h(){const Z=[],wa=u.a.K5c;for(const ta in wa){var la=wa[ta];Array.contains(Z,la)||Array.add(Z,la)}return Z}lKc(Z,wa,la,ta,Ca,Ga){const Oa=new N.a(U.a.GYj),eb=this.kff();Oa.Values=this.gsg(Z,wa,la,ta,Ca,Ga,eb);this.xve=Oa;Z=this.nIc(eb);b.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",wa);this.b2j();
return Z}JIc(){return!0}b2j(){this.Mpb||(this.Mpb=new A.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.Mpb.id=16,this.Mpb.Rzd=!1,this.Mpb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{b.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.Vy.taa(this.xve,this.fw.contentWindow,this.C0)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),b.ULS.sendTraceTag(555049438,3E3,10,
"Failed to add entry to business bar. Login message could not be shown to user."))}wsg(Z){this.mIa&&this.mIa.correlationId===Z&&(this.mIa.resolve(null),this.mIa=null)}}Object(w.a)(fa,"SharedAuthTokenStrategy",null,[225]);class ha{constructor(Z){this.pZc=Z;this.U1a="UnsupportedAuthTokenStrategy Reason="+h.a[this.pZc]}initialize(){return Promise.resolve(0)}btc(){return Promise.resolve(0)}pD(){return Promise.resolve(Object.assign(new e.a,{IsSuccess:!1,ErrorCode:h.a[this.pZc],ErrorMessage:"Unable to get a token. Reason: ["+
h.a[this.pZc]+"]"}))}lKc(){return Promise.resolve(Object.assign(new e.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}JIc(){return!1}oDb(){return this.U1a}}Object(w.a)(ha,"UnsupportedAuthTokenStrategy",null,[225]);var Ea=a(756);a.d(B,"OAuthManager",function(){return ra});class ra{constructor(Z){Z=void 0===Z?null:Z;this.vJ=0;this.ZO=null;this.APg=0;this.mle=!!window.location.search.match(RegExp("wdpa=1",
"gi"));const wa=ca.a.lg();this.WKg=this.Xzh(Z).then(la=>la?this.pvi():(b.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.zw(),Math.floor(ca.a.lg()-wa)),la=K.a.mu(),void 0!==la&&null!==la&&(la.set("AuthLibrary",this.zw()),la=Object.assign(new Q.a,{durationMs:Math.floor(ca.a.lg()-wa),extendedProperties:la}),P.Health.instance.recordKpiFailure(ra.kpiName,"StrategyPickFailed",!1,!0,la)),Promise.resolve(1))).then(la=>
0!==la?Promise.resolve(la):this.ARi())}Yzh(){if(this.mle)this.vJ=5,this.ZO=new ha(this.vJ);else{var Z=u.a.r_i;Z&&0<Z.length?(this.vJ=1,this.ZO=new k(Z)):v.AFrameworkApplication.da.na("IsO365ConsumerHost")||v.AFrameworkApplication.da.na("IsO365CommercialHost")?v.AFrameworkApplication.da.na("IsAnonymousUser")?(this.vJ=2,this.ZO=new ha(this.vJ)):(Z=l.a.getAuthContext().loginHint)&&Z.length?u.a.GEb?(this.vJ=1,this.ZO=new n):(this.vJ=1,this.ZO=new fa):(this.vJ=3,this.ZO=new ha(this.vJ)):(this.vJ=4,this.ZO=
new ha(this.vJ))}}zw(){return this.ZO?this.ZO.oDb()||"Unknown":"None"}Xzh(Z){Z=void 0===Z?null:Z;b.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const wa=ca.a.lg();return v.AFrameworkApplication.da.gpd().then(la=>{la?(this.Yzh(),Z&&(this.ZO=Z),b.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",u.a.clientVersion,u.a.appVersion,u.a.dDh,this.zw(),Math.floor(ca.a.lg()-wa))):b.ULS.sendTraceTag(562128579,
3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ca.a.lg()-wa));return Promise.resolve(la)},()=>{b.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(ca.a.lg()-wa));return Promise.resolve(!1)})}pvi(){b.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.zw());const Z=ca.a.lg();return r.get(this.ZO.initialize(),
2,u.a.FQd).then(wa=>{if(0===wa)b.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.zw(),Math.floor(ca.a.lg()-Z));else if(1===wa){b.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.zw(),Math.floor(ca.a.lg()-Z));var la=K.a.mu();void 0!==la&&null!==la&&(la.set("AuthLibrary",this.zw()),la=Object.assign(new Q.a,{durationMs:Math.floor(ca.a.lg()-Z),extendedProperties:la}),P.Health.instance.recordKpiFailure(ra.kpiName,
"StrategyInitFailed",!1,!0,la))}else 2===wa&&(b.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.zw(),Math.floor(ca.a.lg()-Z)),la=K.a.mu(),void 0!==la&&null!==la&&(la.set("AuthLibrary",this.zw()),la=Object.assign(new Q.a,{durationMs:Math.floor(ca.a.lg()-Z),extendedProperties:la}),P.Health.instance.recordKpiFailure(ra.kpiName,"StrategyInitTimedOut",!1,!0,la)));return Promise.resolve(wa)},()=>{b.ULS.sendTraceTag(574239256,
3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.zw(),Math.floor(ca.a.lg()-Z));return Promise.resolve(1)})}ARi(){b.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.zw());const Z=ca.a.lg();return r.get(this.ZO.btc(l.a.getAuthContext()),2,u.a.FQd).then(wa=>{if(0===wa)b.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.zw(),Math.floor(ca.a.lg()-Z));else if(1===wa){b.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",
this.zw(),Math.floor(ca.a.lg()-Z));var la=K.a.mu();void 0!==la&&null!==la&&(la.set("AuthLibrary",this.zw()),la=Object.assign(new Q.a,{durationMs:Math.floor(ca.a.lg()-Z),extendedProperties:la}),P.Health.instance.recordKpiFailure(ra.kpiName,"StrategyLoadFailed",!1,!0,la))}else 2===wa&&(b.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.zw(),Math.floor(ca.a.lg()-Z)),la=K.a.mu(),void 0!==la&&null!==la&&(la.set("AuthLibrary",this.zw()),
la=Object.assign(new Q.a,{durationMs:Math.floor(ca.a.lg()-Z),extendedProperties:la}),P.Health.instance.recordKpiFailure(ra.kpiName,"StrategyLoadTimedOut",!1,!0,la)));return Promise.resolve(wa)},()=>{b.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.zw(),Math.floor(ca.a.lg()-Z));return Promise.resolve(1)})}pD(Z,wa,la){return this.jKc(Z,wa,!1,null,"",void 0===la?null:la)}hsg(Z,wa,la,ta,Ca){return this.jKc(Z,wa,!0,la,ta,void 0===Ca?
null:Ca)}jKc(Z,wa,la,ta,Ca,Ga,Oa){Oa=void 0===Oa?0:Oa;Oa+=1;b.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",Z,this.lWa(Z,wa),this.zw(),Oa);var eb=K.a.mu();void 0!==eb&&null!==eb&&(eb.set("AuthLibrary",this.zw()),eb.set("AppName",Z),eb.set("Target",this.lWa(Z,wa)),P.Health.instance.recordKpiUsage(ra.kpiName,0,"WacOAuthFC",eb));if(!u.a.isEnabled||this.mle){var nb;return this.WEd((nb=new e.a,nb.IsSuccess=!1,nb.Token=null,
nb.ErrorCode="NotEnabled",nb.ErrorMessage="OAuthManager is disabled.",nb),Z)}const $a=u.a.K5c[Z];if(void 0===$a||null===$a){b.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",Z);var oa;return this.WEd((oa=new e.a,oa.IsSuccess=!1,oa.Token=null,oa.ErrorCode="DisallowedApp",oa.ErrorMessage="Disallowed appName: "+Z,oa),Z)}const Fa=ca.a.lg();let X=Fa;const va=this;eb=this.WKg.then(Bb=>{X=ca.a.lg();return va.uBi(Z,$a,
wa,la,ta,Ca,Ga,Bb)});nb=la?0:u.a.FQd;let xa;oa=(xa=new e.a,xa.IsSuccess=!1,xa.Token=null,xa.ErrorCode="authTokenStrategy_timeout",xa.ErrorMessage="Auth Strategy timed out after ["+nb+"] ms when fetching token",xa);const Pa=this,Ka=this;return r.get(eb,oa,nb).then(Bb=>Oa<=ra.$Yi&&(Bb.ErrorCode===ra.iqg||Bb.ErrorCode===ra.u9j)?(b.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Oa,Math.floor(ca.a.lg()-Fa)),Pa.jKc(Z,wa,la,ta,Ca,Ga,Oa)):Bb.ErrorCode===ra.Lxf&&
!la&&(b.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Oa,ra.XYe),ra.pGh&&Pa.ZO.JIc()&&Pa.ZO.lKc(Z,$a,wa,la,ta,Ca).then(xb=>Promise.resolve(Pa.vtc(xb,Z,wa,$a,Fa,X))).catch(()=>{let xb;const Ua=(xb=new e.a,xb.IsSuccess=!1,xb.Token=null,xb.ErrorCode="authTokenStrategy_failure",xb.ErrorMessage="LoginPopup failed, GetToken could not be called",xb);return Promise.resolve(Pa.vtc(Ua,Z,wa,$a,Fa,X))}),ra.XYe)?Pa.jKc(Z,wa,!0,ta,Ca,Ga,
Oa):Promise.resolve(Pa.vtc(Bb,Z,wa,$a,Fa,X))).catch(()=>{let Bb;const xb=(Bb=new e.a,Bb.IsSuccess=!1,Bb.Token=null,Bb.ErrorCode="authTokenStrategy_failure",Bb.ErrorMessage="Auth Strategy failed with an unknown error",Bb);return Promise.resolve(Ka.vtc(xb,Z,wa,$a,Fa,X))})}uBi(Z,wa,la,ta,Ca,Ga,Oa,eb){return 1===eb||2===eb?this.WEd(Object.assign(new e.a,{IsSuccess:!1,Token:null,ErrorCode:1===eb?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),Z):this.ZO.pD(Z,wa,la,ta,
Ca,Ga,Oa).then(nb=>Promise.resolve(this.mIf(nb,!0,Z))).catch(nb=>Promise.resolve(this.mIf(nb,!1,Z)))}vtc(Z,wa,la,ta,Ca,Ga){const Oa={},eb=ca.a.lg()-Ga;Oa.IsSuccess=Z.IsSuccess;Oa.ErrorCode=Z.IsSuccess?"Success":Z.ErrorCode||"";Oa.ErrorMessage=Z.IsSuccess?"Success":this.lWa(wa,Z.ErrorMessage||"");Oa.Target=this.lWa(wa,la||"");Oa.TimeInMS=Math.floor(eb);Oa.LoadTimeInMS=Math.floor(Ga-Ca);Oa.AuthLibrary=this.zw();Oa.AppName=wa;Oa.AuthorityType=Object(c.a)(f,l.a.wic());Oa.UserType=this.Lki(l.a.getAuthContext());
Oa.IsAuthSupportedInSession=h.a[this.vJ];Oa.RequestCount=++this.APg;Oa.AppId=ta;b.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(Oa));Z.IsSuccess||(la=K.a.mu(),void 0!==la&&null!==la&&(la.set("AppName",wa),la.set("AuthLibrary",this.zw()),la.set("ErrorCode",Z.ErrorCode),la.set("ErrorMessage",this.lWa(wa,Z.ErrorMessage)),wa=Object.assign(new Q.a,{durationMs:eb,extendedProperties:la}),P.Health.instance.recordKpiFailure(ra.kpiName,"TryGetTokenFailure",!1,!0,wa)));return Z}WEd(Z,wa){b.ULS.sendTraceTag(578435090,
3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",wa,this.lWa(wa,Z.ErrorMessage));const la=K.a.mu();void 0!==la&&null!==la&&(la.set("AppName",wa),la.set("AuthLibrary",this.zw()),la.set("ErrorCode",Z.ErrorCode),la.set("ErrorMessage",this.lWa(wa,Z.ErrorMessage)),wa=Object.assign(new Q.a,{extendedProperties:la}),P.Health.instance.recordKpiFailure(ra.kpiName,"FailureBeforeGetToken",!1,!0,wa));return Promise.resolve(Z)}Dsf(Z){return Z===Ea.a.wJc}lWa(Z,wa){return this.Dsf(Z)&&
wa?"REDACTED":wa}Lki(Z){return v.AFrameworkApplication.da.na("IsAnonymousUser")?"anonymous":!Z.loginHint||1>Z.loginHint.length?"empty":-1<Z.loginHint.indexOf("guest#")?"guest":-1<Z.loginHint.indexOf("ext#")?"external":0>Z.upn.indexOf("@")?"no-at":"supported"}qab(){return 1===this.vJ}mIf(Z,wa,la){let ta=null,Ca=null,Ga=null,Oa=null;Z?Z.ErrorCode||Z.ErrorMessage?(Ca=Z.ErrorCode?Z.ErrorCode:ra.K3e,Ga=Z.ErrorMessage?Z.ErrorMessage:"No message"):Z.Token?wa?ta=Z.Token:(Ca=ra.xAj,Ga="A rejected promise returned a token."):
(Ca=ra.K3e,Ga=JSON.stringify(Z)):(Ca=ra.N1i,Ga="No result came from Auth Token Strategy");Z&&Z.Telemetry&&!this.Dsf(la)&&(Oa=Z.Telemetry,b.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Oa)));if(Ca===ra.B_i||Ca===ra.Cdk)Ca=ra.iqg,Ga="Auth Library Timed Out";Ca===ra.i7g&&-1<Ga.indexOf(ra.BTg)&&(Ca=ra.Lxf);if(Ca||Ga)ta=null;return Object.assign(new e.a,{IsSuccess:!!ta,Token:ta,ErrorCode:Ca,ErrorMessage:Ga,Telemetry:Oa})}static get XYe(){return v.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",
!1)}static get pGh(){return v.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}ra.Cdk="token_renewal_error";ra.K3e="Exception";ra.N1i="NoResult";ra.xAj="RejectToken";ra.B_i="monitor_window_timeout";ra.iqg="Timeout";ra.u9j="authTokenStrategy_timeout";ra.i7g="login_required";ra.BTg="AADSTS50058";ra.Lxf="Cookies Disabled";ra.kpiName="OAuthManager";ra.$Yi=2;Object(w.a)(ra,"OAuthManager",null,[191])},984:function(w,B,a){a.d(B,"a",function(){return b});
w=a(0);var b;(function(c){c[c.unknown=0]="unknown";c[c.supported=1]="supported";c[c.Szk=2]="userUnsupportedAnonymous";c[c.Tzk=3]="userUnsupportedNoLoginHint";c[c.kxk=4]="hostUnsupported";c[c.xyk=5]="perfAutomation"})(b||(b={}));Object(w.b)("SupportStatus",b)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.vrs.js.map/cff91799e93e15db12a6594e0ee8234a/EwaTS.vrs.js.map