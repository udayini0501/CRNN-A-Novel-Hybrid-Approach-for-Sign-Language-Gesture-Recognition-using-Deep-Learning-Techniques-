/*! For license information please see odcwachostwebpack.js.LICENSE.txt */
!function(e){function t(t){for(var a,i,r=t[0],o=t[1],s=t[2],c=0,d=[];c<r.length;c++)i=r[c],Object.prototype.hasOwnProperty.call(u,i)&&u[i]&&d.push(u[i][0]),u[i]=0;for(a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a]);for(v&&v(t);d.length;)d.shift()();return f.push.apply(f,s||[]),n()}function n(){for(var e,t=0;t<f.length;t++){for(var n=f[t],a=!0,i=1;i<n.length;i++){var r=n[i];0!==u[r]&&(a=!1)}a&&(f.splice(t--,1),e=p(p.s=n[0]))}return e}var a=window,i=a.require;function r(e){var t=e&&e.indexOf("/",e.indexOf("://")+3)+1;return t?e.slice(0,t):e}var o=document.currentScript,s=r(o&&o.src||i&&i.toUrl("")),c=r(a.__backupBaseUrl),d=i&&i.s.contexts._,l={},u={odcwachostwebpack:0},f=[];function p(t){if(l[t])return l[t].exports;var n=l[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,p),n.l=!0,n.exports}var m=[[],[140],[74],[119,"ondemand.resx-ondemand"],[188,"ondemand.resx-ondemand"],[63,"ondemand.resx-ondemand"],[80,"ondemand.resx-ondemand"],[118],[123],[134],[138],[145]];p.ee=function(e,t,n){return Promise.all((Array.isArray(e)?e:m[e]).map(function(e){return p.e(e)})).then(n?p.t.bind(0,t,n):p.bind(0,t))},p.e=function(e){var t=e.toString(),n=d&&d.config.paths[t]&&d.nameToUrl(t)||function(e){return p.p+""+e+".js"}(e);function i(e){var t=[],i=u[e];if(0!==i)if(i)t.push(i[2]);else{var r=new Promise(function(t,n){i=u[e]=[t,n]});t.push(i[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,p.nc&&s.setAttribute("nonce",p.nc),s.src=n,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=u[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",c.name="ChunkLoadError",c.type=a,c.request=i,n[1](c)}u[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o;var l=a.__odspSriHashes;if(l){var f=l[a.__odsp_culture+"/"+e]||l[e];f&&(s.integrity=f)}document.head.appendChild(s)}return Promise.all(t)}return i(e).catch(function(t){var r=a.__integrityViolationCallBack;r&&r(t.request);var o=c&&n.replace(s,c);return o&&o!==n?(n=o,i(e)):Promise.reject(t)})},p.m=e,p.c=l,p.d=function(e,t,n){p.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},p.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},p.t=function(e,t){if(1&t&&(e=p(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(p.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)p.d(n,a,function(t){return e[t]}.bind(null,a));return n},p.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return p.d(t,"a",t),t},p.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},p.p="/",p.oe=function(e){throw console.error(e),e};var _=p.p;Object.defineProperty(p,"p",{get:function(){if(window.require&&window.require.toUrl){var e=window.require.toUrl("");_=("/"!==e.slice(-1)?e+"/":e)+"odcwachostwebpack.manifest/"}return _}});var h=window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[],b=h.push.bind(h);h.push=t,h=h.slice();for(var g=0;g<h.length;g++)t(h[g]);var v=b;f.push([618,"plt.resx-plt","plt.react","plt.office-ui-fabric-react","plt.odsp-common","plt.items-view"]),n()}([function(e,t,n){"use strict";n.r(t),n.d(t,"__extends",function(){return i}),n.d(t,"__assign",function(){return r}),n.d(t,"__rest",function(){return o}),n.d(t,"__decorate",function(){return s}),n.d(t,"__param",function(){return c}),n.d(t,"__metadata",function(){return d}),n.d(t,"__awaiter",function(){return l}),n.d(t,"__generator",function(){return u}),n.d(t,"__createBinding",function(){return f}),n.d(t,"__exportStar",function(){return p}),n.d(t,"__values",function(){return m}),n.d(t,"__read",function(){return _}),n.d(t,"__spread",function(){return h}),n.d(t,"__spreadArrays",function(){return b}),n.d(t,"__spreadArray",function(){return g}),n.d(t,"__await",function(){return v}),n.d(t,"__asyncGenerator",function(){return y}),n.d(t,"__asyncDelegator",function(){return S}),n.d(t,"__asyncValues",function(){return D}),n.d(t,"__makeTemplateObject",function(){return I}),n.d(t,"__importStar",function(){return C}),n.d(t,"__importDefault",function(){return O}),n.d(t,"__classPrivateFieldGet",function(){return w}),n.d(t,"__classPrivateFieldSet",function(){return E});var a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};function o(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}function s(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function c(e,t){return function(n,a){t(n,a,e)}}function d(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})}function u(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}var f=Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]};function p(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||f(t,e,n)}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,i,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=r.next()).done;)o.push(a.value)}catch(e){i={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return o}function h(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}function b(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var a=Array(e),i=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)a[i]=r[o];return a}function g(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}function v(e){return this instanceof v?(this.v=e,this):new v(e)}function y(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var a,i=n.apply(e,t||[]),r=[];return a={},o("next"),o("throw"),o("return"),a[Symbol.asyncIterator]=function(){return this},a;function o(e){i[e]&&(a[e]=function(t){return new Promise(function(n,a){r.push([e,t,n,a])>1||s(e,t)})})}function s(e,t){try{(n=i[e](t)).value instanceof v?Promise.resolve(n.value.v).then(c,d):l(r[0][2],n)}catch(e){l(r[0][3],e)}var n}function c(e){s("next",e)}function d(e){s("throw",e)}function l(e,t){e(t),r.shift(),r.length&&s(r[0][0],r[0][1])}}function S(e){var t,n;return t={},a("next"),a("throw",function(e){throw e}),a("return"),t[Symbol.iterator]=function(){return this},t;function a(a,i){t[a]=e[a]?function(t){return(n=!n)?{value:v(e[a](t)),done:"return"===a}:i?i(t):t}:i}}function D(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=m(e),t={},a("next"),a("throw"),a("return"),t[Symbol.asyncIterator]=function(){return this},t);function a(n){t[n]=e[n]&&function(t){return new Promise(function(a,i){!function(e,t,n,a){Promise.resolve(a).then(function(t){e({value:t,done:n})},t)}(a,i,(t=e[n](t)).done,t.value)})}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function C(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&f(t,e,n);return x(t,e),t}function O(e){return e&&e.__esModule?e:{default:e}}function w(e,t,n,a){if("a"===n&&!a)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?a:"a"===n?a.call(e):a?a.value:t.get(e)}function E(e,t,n,a,i){if("m"===a)throw new TypeError("Private method is not writable");if("a"===a&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===a?i.call(e,n):i?i.value=n:t.set(e,n),n}},,function(e,t,n){"use strict";n.r(t),n.d(t,"On",function(){return s}),n.d(t,"Off",function(){return c}),n.d(t,"SendForSignatureEnabled",function(){return d}),n.d(t,"GetSignaturesEnabled",function(){return l}),n.d(t,"SendForSignatureAdobeEnabled",function(){return u}),n.d(t,"SendForSignatureDocusignEnabled",function(){return f}),n.d(t,"EnableSearchInRecycleBinFreemium",function(){return p}),n.d(t,"DisableCommandsWhenOffline",function(){return m}),n.d(t,"SPListsHomeSubstrateAPI",function(){return _}),n.d(t,"ODCRequestAccess",function(){return h}),n.d(t,"HolidayPositioningFRE",function(){return b}),n.d(t,"Onboarding50GBStandAlonePlanRamp",function(){return g}),n.d(t,"OneHunderedGBFreDimeEnabled",function(){return v}),n.d(t,"OneHunderedGBFreDimeExp",function(){return y}),n.d(t,"OneHunderedGBFreFreeTrialEnabled",function(){return S}),n.d(t,"OneHunderedGBFreFreeTrialExp",function(){return D}),n.d(t,"FreeTrialOnSecondLogin",function(){return I}),n.d(t,"FreeTrialOnSecondLoginExperiment",function(){return x}),n.d(t,"SinglePlanOptionOnQuotaLevelUpsell",function(){return C}),n.d(t,"SinglePlanOptionOnQuotaLevelUpsellExp",function(){return O}),n.d(t,"OneHunderedGBFre100DefaultDimeEnabled",function(){return w}),n.d(t,"OneHunderedGBFre100DefaultDimeExp",function(){return E}),n.d(t,"EnableHundredGBDIME",function(){return A}),n.d(t,"HundredGBDIMEExperiment",function(){return L}),n.d(t,"UploadQuotaWarningDialogExp",function(){return k}),n.d(t,"UploadQuotaWarningDialogEnabled",function(){return M}),n.d(t,"GB100FreeTrialDialogExp",function(){return P}),n.d(t,"Enable100GBFreeTrialDialog",function(){return T}),n.d(t,"EnableM365BasicV2",function(){return U}),n.d(t,"InfoPaneActivityFeed",function(){return F}),n.d(t,"EnableMsJs",function(){return H}),n.d(t,"ShowEmailInPeoplePicker",function(){return R}),n.d(t,"ModernSharePointStore",function(){return N}),n.d(t,"EnableTeachingBubbles",function(){return B}),n.d(t,"EnableCoachmarks",function(){return j}),n.d(t,"AddToOneDriveBubble",function(){return V}),n.d(t,"PhotosSearchBubble",function(){return z}),n.d(t,"SharingDialogRedux",function(){return G}),n.d(t,"RUMOne",function(){return K}),n.d(t,"EnableNotificationSubscriptions",function(){return W}),n.d(t,"ShowTagCountInPhotos",function(){return q}),n.d(t,"UseVroomGetPermissions",function(){return Q}),n.d(t,"RenderListDataAsStreamLeftNavOpt",function(){return Y}),n.d(t,"MillionsofTagsControl",function(){return J}),n.d(t,"RemoveFromSharedList",function(){return X}),n.d(t,"PromotedPhotosContentEnabled",function(){return Z}),n.d(t,"OneRmO365UpsellEnabled",function(){return $}),n.d(t,"EnableDimeVaultUpsell",function(){return ee}),n.d(t,"EnableDimeVaultDialog",function(){return te}),n.d(t,"EnableDimeHolidayPositioning",function(){return ne}),n.d(t,"ODBSyncButtonDefaultNGSC",function(){return ae}),n.d(t,"HideSyncButton",function(){return ie}),n.d(t,"OneDriveAspxRedirect",function(){return re}),n.d(t,"RecycleBinImmersive",function(){return oe}),n.d(t,"SiteAnalyticsV3",function(){return se}),n.d(t,"SiteTraffic2",function(){return ce}),n.d(t,"EnableAllNewsAndSiteAnalyticsInGovClouds",function(){return de}),n.d(t,"EnablePasswordProtectedLinks",function(){return le}),n.d(t,"EnablePremiumCheckWebPasswordLinks",function(){return ue}),n.d(t,"EnableResponsiveFilesListView",function(){return fe}),n.d(t,"EnableIconographyExperiment",function(){return pe}),n.d(t,"EnableEXPExperimentAATest",function(){return me}),n.d(t,"EnableNewSharedFolder",function(){return _e}),n.d(t,"DwellTimeTopItemsEnabled",function(){return he}),n.d(t,"SitePagesTimeSpent",function(){return be}),n.d(t,"UsePrimeApiMoveCopy",function(){return ge}),n.d(t,"CreateDwellDataInExcel",function(){return ve}),n.d(t,"CreateDocLibWithSensLabel",function(){return ye}),n.d(t,"DocumentSettingPanel",function(){return Se}),n.d(t,"DisplayAggregatedSitesCountMessage",function(){return De}),n.d(t,"HideHubChartsIfYggdrassilsUnavailable",function(){return Ie}),n.d(t,"EnableGeoLocationDEU",function(){return xe}),n.d(t,"MentionTeachingUIAA",function(){return Ce}),n.d(t,"MentionTeachingUIAB",function(){return Oe}),n.d(t,"MentionTeachingUI",function(){return we}),n.d(t,"LogPeoplePickerMounting",function(){return Ee}),n.d(t,"EnableNewHasAccessControl",function(){return Ae}),n.d(t,"AttachGroupIdToSharedByKey",function(){return Le}),n.d(t,"UseFluidDevPreview",function(){return ke}),n.d(t,"CustomActionPreFetch",function(){return Me}),n.d(t,"TipsNTricksForCommSite",function(){return Pe}),n.d(t,"VivaAmplify",function(){return Te}),n.d(t,"PermUpdateForChannelSIte",function(){return Ue}),n.d(t,"VivaConnectionsGA",function(){return Fe}),n.d(t,"VivaConnectionsPreviewTagRemoval",function(){return He}),n.d(t,"EnableRedeemSamsungBonusDialog",function(){return Re}),n.d(t,"RepositionUpsellFREExperiment",function(){return Ne}),n.d(t,"FamilySharing",function(){return Be}),n.d(t,"FamilySharingWacKS",function(){return je}),n.d(t,"ManageAccessRevampConsumer",function(){return Ve}),n.d(t,"ODCSharePrefetchInline",function(){return ze}),n.d(t,"ODCHideNonPremiumLinkFeatures",function(){return Ge}),n.d(t,"SharingTooltipCalloutKS",function(){return Ke}),n.d(t,"OneHundredGBSKUExperiment",function(){return We}),n.d(t,"OneHundredGBSKUEnabled",function(){return qe}),n.d(t,"FiftyGBSKUExperiment",function(){return Qe}),n.d(t,"FiftyGBSKUEnabled",function(){return Ye}),n.d(t,"Enable3SonWacWord",function(){return Je}),n.d(t,"ODCFacepileFeature",function(){return Xe}),n.d(t,"DownloadAsZip",function(){return Ze}),n.d(t,"PolicyTipPanel",function(){return $e}),n.d(t,"FileHandlersV2",function(){return et}),n.d(t,"AuthZenUserActivityInSight",function(){return tt}),n.d(t,"EnableExcelSurveyV2",function(){return nt}),n.d(t,"EnableExcelSurveyV2LicenseCheck",function(){return at}),n.d(t,"UseOLSQueryForSearch",function(){return it}),n.d(t,"DisableExcelSurveyV2TeamSite",function(){return rt}),n.d(t,"DragAndDropRobotAnimation",function(){return ot}),n.d(t,"SpListInPageSearch",function(){return st}),n.d(t,"SpListNextTheming",function(){return ct}),n.d(t,"SuiteNavPrefersTenantTheme",function(){return dt}),n.d(t,"OversharingMitigations",function(){return lt}),n.d(t,"ODBNextUserFeedbackViaYammer",function(){return ut}),n.d(t,"RecursiveUnsharing",function(){return ft}),n.d(t,"MoveCopyFolderSelectionUX",function(){return pt}),n.d(t,"CopyCrossSiteFromTeamSite",function(){return mt}),n.d(t,"MoveCrossSite",function(){return _t}),n.d(t,"MoveCopyCrossLibraryUsePrime",function(){return ht}),n.d(t,"ItemAnalytics",function(){return bt}),n.d(t,"ItemAnalyticsChart",function(){return gt}),n.d(t,"FileMoveSharingHint",function(){return vt}),n.d(t,"SensitivityLabelEditor",function(){return yt}),n.d(t,"ShowInfoPaneByDefault",function(){return St}),n.d(t,"UseReactGridListGroup",function(){return Dt}),n.d(t,"EmbeddedPowerApps",function(){return It}),n.d(t,"PowerAppsAndAndProcessSimpleTestEnvironment",function(){return xt}),n.d(t,"PowerAppsAndAndProcessSimpleDevEnvironment",function(){return Ct}),n.d(t,"PowerAppsPlayerPackageUpdates",function(){return Ot}),n.d(t,"UseReactSPOHeader",function(){return wt}),n.d(t,"EnablePushChannelAutoRefresh",function(){return Et}),n.d(t,"AllowPushChannelLongPolling",function(){return At}),n.d(t,"AllowPushChannelDnsUrls",function(){return Lt}),n.d(t,"EnablePushChannel",function(){return kt}),n.d(t,"ShowFirstRunInLibraries",function(){return Mt}),n.d(t,"ShowFirstRunInLists",function(){return Pt}),n.d(t,"AutoAlbumBannerV2Enabled",function(){return Tt}),n.d(t,"SPOAppPrecludeIE9",function(){return Ut}),n.d(t,"EnableGetItemsPrefetch",function(){return Ft}),n.d(t,"PeopleCards",function(){return Ht}),n.d(t,"PeopleCardsLinkedInIntegration",function(){return Rt}),n.d(t,"MessageBorder",function(){return Nt}),n.d(t,"SubjectLine",function(){return Bt}),n.d(t,"PeopleCardsLokiDogfood",function(){return jt}),n.d(t,"GrooveNewProtocol",function(){return Vt}),n.d(t,"UseNewSharingDialog",function(){return zt}),n.d(t,"UseNewReportAbuseDialog",function(){return Gt}),n.d(t,"UserVroomApiForRemoveFromShareWithMeListAndReportAbuse",function(){return Kt}),n.d(t,"UseVroomApiForReportAbuse",function(){return Wt}),n.d(t,"UseVroomApiForRequestReview",function(){return qt}),n.d(t,"UseVroomUpdateCaption",function(){return Qt}),n.d(t,"EnableAnonReportConcernCommand",function(){return Yt}),n.d(t,"EnableEnhancedMobileUpsell",function(){return Jt}),n.d(t,"RecycleBinListFooter",function(){return Xt}),n.d(t,"EnableViewInFolder",function(){return Zt}),n.d(t,"PhotosLayoutViewDisabled",function(){return $t}),n.d(t,"VisioDrawingCreation",function(){return en}),n.d(t,"UseVroomUpload",function(){return tn}),n.d(t,"SyncButtonStringChange",function(){return nn}),n.d(t,"EnableSecurityMomentLightbox",function(){return an}),n.d(t,"ShareV3",function(){return rn}),n.d(t,"EnableManageAccessInReact",function(){return on}),n.d(t,"EnableWideCenteredManageAccess",function(){return sn}),n.d(t,"ODCInlineShare",function(){return cn}),n.d(t,"PreferGraphV1API",function(){return dn}),n.d(t,"ODCManageAccessCommandBarContextMenu",function(){return ln}),n.d(t,"EnableLinkSettingsEditPanel",function(){return un}),n.d(t,"PreventDownloadLink",function(){return fn}),n.d(t,"CoachMarkInLinkSettingsExperiment",function(){return pn}),n.d(t,"UseActivitiesApi",function(){return mn}),n.d(t,"DownloadNotifications",function(){return _n}),n.d(t,"VersionAllFiles",function(){return hn}),n.d(t,"Groupify",function(){return bn}),n.d(t,"DocAspxCreateNewWord",function(){return gn}),n.d(t,"EnableEvokeAlignments",function(){return vn}),n.d(t,"EvokeDev",function(){return yn}),n.d(t,"SuiteNavPerfListThreshold",function(){return Sn}),n.d(t,"EnableInfoPaneStickyHeader",function(){return Dn}),n.d(t,"SaveListSortAndGroupBy",function(){return In}),n.d(t,"SaveListFilterUpdates",function(){return xn}),n.d(t,"SaveListFieldUpdates",function(){return Cn}),n.d(t,"EnableTrendingSignalInListView",function(){return On}),n.d(t,"CreateSharedLibraryInODB",function(){return wn}),n.d(t,"UseTilesList",function(){return En}),n.d(t,"ShowLeftNavOnRestorePage",function(){return An}),n.d(t,"BypassPremiumCheckForRestore",function(){return Ln}),n.d(t,"SharedLeftNav",function(){return kn}),n.d(t,"PeoplePickerGraph",function(){return Mn}),n.d(t,"PeoplePicker3S",function(){return Pn}),n.d(t,"DisablePeoplePicker3SExperiment",function(){return Tn}),n.d(t,"ImplicitShareNotify",function(){return Un}),n.d(t,"isForceImplicitSharingExperimentEnabled",function(){return Fn}),n.d(t,"EnableLinkLevelManageAccess",function(){return Rn}),n.d(t,"UseVroomDownload",function(){return Nn}),n.d(t,"MediaTAUseVroomV21",function(){return Bn}),n.d(t,"EnableAnonymousSigninDialog",function(){return jn}),n.d(t,"UnauthenticatedBannerUseSigninDialog",function(){return Vn}),n.d(t,"ProjectVWeb",function(){return zn}),n.d(t,"ProjectVKeyboardShortcut",function(){return Gn}),n.d(t,"EnableOrderPrints",function(){return Kn}),n.d(t,"SigninDialogSupportBusinessAccounts",function(){return Wn}),n.d(t,"SamsungGalleryFilter",function(){return qn}),n.d(t,"UseODBRestoreArticle",function(){return Qn}),n.d(t,"FlowRemindMeCoachmark",function(){return Yn}),n.d(t,"FlowOdbCommandBarCoachmark",function(){return Jn}),n.d(t,"FlowSignOffCoachmark",function(){return Xn}),n.d(t,"ReviewPermissionUI",function(){return Zn}),n.d(t,"OfficeReviewPermission",function(){return $n}),n.d(t,"ReviewPermissionExp",function(){return ea}),n.d(t,"EnableManageStorageSettings",function(){return ta}),n.d(t,"EnableVroomDocFormatSettings",function(){return na}),n.d(t,"DisableDeviceBackupsPage",function(){return aa}),n.d(t,"UseItemsScopeInPicker",function(){return ia}),n.d(t,"UseItemsScopeInAllPhotosEnableGrid",function(){return ra}),n.d(t,"UseItemsScopeInAllPhotosForwardPaging",function(){return oa}),n.d(t,"UseItemsScopeInExplorePhotos",function(){return sa}),n.d(t,"UsePhysicalPixelSizeThumbsInAllPhotosView",function(){return ca}),n.d(t,"RequestCacheSizeThumbnails",function(){return da}),n.d(t,"EnableMultiplePhotoStories",function(){return la}),n.d(t,"EnablePhotoStream",function(){return ua}),n.d(t,"EnablePhotoStreamInviteExpOne",function(){return fa}),n.d(t,"EnablePhotoStreamInviteExpOneOn",function(){return pa}),n.d(t,"EnablePhotoStreamInLeftNav",function(){return ma}),n.d(t,"EnableNewCarouselDesign",function(){return _a}),n.d(t,"EnableNewCarouselDesignExp",function(){return ha}),n.d(t,"EnableOnThisMonth",function(){return ba}),n.d(t,"EnableRecommendationApi",function(){return ga}),n.d(t,"EnableLastWeekPreviousYears",function(){return va}),n.d(t,"EnableMojFeedback",function(){return ya}),n.d(t,"EnableNewPhotosExperience",function(){return Sa}),n.d(t,"EnableNewPhotosExperienceForCOB",function(){return Da}),n.d(t,"EnableMOJNotificationBanner",function(){return Ia}),n.d(t,"EnableSeeAllSeeFeaturedButton",function(){return xa}),n.d(t,"UseLegacyDataManagerToFirePLT",function(){return Ca}),n.d(t,"PasteToUploadFromClipboard",function(){return Oa}),n.d(t,"MoveAndCopyWithClipboard",function(){return wa}),n.d(t,"AddPeopleReact",function(){return Ea}),n.d(t,"SubscribeToItemPerRowInDetailsList",function(){return Aa}),n.d(t,"SyntexBrandingEnabled",function(){return La}),n.d(t,"SyntexCopilotConversationContext",function(){return ka}),n.d(t,"SyntexCopilotChunking",function(){return Ma}),n.d(t,"SyntexCopilotExperienceUpdate",function(){return Pa}),n.d(t,"SyntexCopilotAugloop",function(){return Ta}),n.d(t,"SyntexCopilotODSLActions",function(){return Ua}),n.d(t,"ReadOnlyItemsStore",function(){return Fa}),n.d(t,"InAppMessagingMLUpsellPositioning",function(){return Ha}),n.d(t,"LeftNavTeamSiteLibraries",function(){return Ra}),n.d(t,"EnableDocLibServiceWorker",function(){return Na}),n.d(t,"DisableDocLibServiceWorker",function(){return Ba}),n.d(t,"EnableServiceWorkerDataCachingWeb",function(){return ja}),n.d(t,"EnableServiceWorkerHomePageCachingWeb",function(){return Va}),n.d(t,"EnableServiceWorkerRecentCachingWeb",function(){return za}),n.d(t,"EnableServiceWorkerEncryptionWeb",function(){return Ga}),n.d(t,"EnableServiceWorkerDebuggingWeb",function(){return Ka}),n.d(t,"EnableServiceWorkerJsCachingPWA",function(){return Wa}),n.d(t,"NavigationPreloadForOdbServiceWorker",function(){return qa}),n.d(t,"UseMsPdfWebWorkerManifest",function(){return Qa}),n.d(t,"IPRecordVersioningClient",function(){return Ya}),n.d(t,"DeleteConfirmDialogODC",function(){return Ja}),n.d(t,"RestoreDSTAdjustment",function(){return Xa}),n.d(t,"ReactEditItemPanel",function(){return Za}),n.d(t,"Image360Viewer",function(){return $a}),n.d(t,"GroupifyFromModernPages",function(){return ei}),n.d(t,"MruToMruPlusPlusSkyApi",function(){return ti}),n.d(t,"ShowSharepointRestoreLink",function(){return ni}),n.d(t,"UseReactConsumerShell",function(){return ai}),n.d(t,"LivePersonaPickerEnabled",function(){return ii}),n.d(t,"UseLegacyCoachmarkExperiment",function(){return ri}),n.d(t,"StoreViewSettings",function(){return oi}),n.d(t,"OneDriveSettings",function(){return si}),n.d(t,"SPListLightSpeed",function(){return ci}),n.d(t,"EnableFraudTenantBannerNotification",function(){return di}),n.d(t,"EnableRecentForMediaTypeFilters",function(){return li}),n.d(t,"EnableItemsScopeInPickerRecent72",function(){return ui}),n.d(t,"ODBSearchTenantScope",function(){return fi}),n.d(t,"Use3SEventsAPI",function(){return pi}),n.d(t,"DisableShareInvalidateItemInSearchView",function(){return mi}),n.d(t,"WriteMruSignalWhenMediaPicked",function(){return _i}),n.d(t,"WriteMruSignalWhenMediaDownloaded",function(){return hi}),n.d(t,"LanguageRedirect",function(){return bi}),n.d(t,"LanguageProfileChange",function(){return gi}),n.d(t,"OldSiteSettingsPage",function(){return vi}),n.d(t,"CreateDocumentPromptSameTab",function(){return yi}),n.d(t,"CreateDocumentToVroom",function(){return Si}),n.d(t,"CreateDocumentToVroomOdf",function(){return Di}),n.d(t,"HideAccessRequestLink",function(){return Ii}),n.d(t,"ShareableAddressBarLink",function(){return xi}),n.d(t,"RedirectExcelSurveysToFormsV2",function(){return Ci}),n.d(t,"SkipSettingMicroserviceBaseInfo",function(){return Oi}),n.d(t,"DisablePremiumUserFactUpdate",function(){return wi}),n.d(t,"DisableSingleFileDownloadFallback",function(){return Ei}),n.d(t,"UseVroomInVaultSingleFileDownload",function(){return Ai}),n.d(t,"UsePagingTokenForSearch",function(){return Li}),n.d(t,"EnableServiceM365Links",function(){return ki}),n.d(t,"OrgListTemplatesPivot",function(){return Mi}),n.d(t,"OrgListTemplatesUseApplyListDesign",function(){return Pi}),n.d(t,"OrgListTemplatesPivotDocLib",function(){return Ti}),n.d(t,"OOTBListTemplatesFromCDN",function(){return Ui}),n.d(t,"UseSpartanForListTemplatePreview",function(){return Fi}),n.d(t,"ListTemplatePreviewV2",function(){return Hi}),n.d(t,"SPListWebPack",function(){return Ri}),n.d(t,"ContentCenterUIGAFeatures",function(){return Ni}),n.d(t,"ModelDiscoveryPanelFlight",function(){return Bi}),n.d(t,"FormProcessingModelRetentionLabelSupport",function(){return ji}),n.d(t,"SyntexFormProcessingModelTableSupport",function(){return Vi}),n.d(t,"SyntexFlowTemplates",function(){return zi}),n.d(t,"SyntexEmailClassifyAndExtractFlowTemplate",function(){return Gi}),n.d(t,"SyntexFormProcessingModelClassifyAndExtract",function(){return Ki}),n.d(t,"RunModelFlatFileStructureSupport",function(){return Wi}),n.d(t,"RunModelFolderClassificationSupportEnabled",function(){return qi}),n.d(t,"RunModelCustomizationSupportEnabled",function(){return Qi}),n.d(t,"HighPrioritySchedulingFeature",function(){return Yi}),n.d(t,"EnableWebTemplatesGallery",function(){return Ji}),n.d(t,"ThirdPartySiteTemplateProgressUX",function(){return Xi}),n.d(t,"TeamsAppMobileSubEntityChat",function(){return Zi}),n.d(t,"RetrieveFlowsFromGroupEnvironment",function(){return $i}),n.d(t,"BizAppsForListTemplates",function(){return er}),n.d(t,"BizAppsForDocLibTemplates",function(){return tr}),n.d(t,"ThirdPartyBizAppsForListTemplates",function(){return nr}),n.d(t,"BizAppsSolutionManagementLinks",function(){return ar}),n.d(t,"BuiltInDocLibAnalyzerFlow",function(){return ir}),n.d(t,"UsePowerAutomateMakerPortal",function(){return rr}),n.d(t,"WEXMultipleVivaConnectionsGlobalNav",function(){return or}),n.d(t,"UseSdk80FilePickerForRunSharingReport",function(){return sr}),n.d(t,"SyntexContentAssemblyCopilot",function(){return cr}),n.d(t,"EnableOneUpVisioPreview",function(){return dr}),n.d(t,"EnableWrsPreviewOutsideODB",function(){return lr}),n.d(t,"EnableZipFilePreviewing",function(){return ur}),n.d(t,"UseSandboxHtmlViewer",function(){return fr}),n.d(t,"UseWebPdfViewer",function(){return pr}),n.d(t,"EnableNewOneUpCommandBar",function(){return mr}),n.d(t,"EnableNewOneUpCommandBarODCExperiment",function(){return _r}),n.d(t,"EnableNewOneUpCommandBarODCExperiment_ABTrigger",function(){return hr}),n.d(t,"EnableDarkThemeForOneUpMediaViewer",function(){return br}),n.d(t,"EnableDarkThemeForOneUpMediaViewerODCExperiment",function(){return gr}),n.d(t,"EnableDarkThemeForOneUpMediaViewerODCExperiment_ABTrigger",function(){return vr}),n.d(t,"DisableOneUpUpdateViewCount",function(){return yr}),n.d(t,"EnableOneUpAZNBViewer",function(){return Sr}),n.d(t,"EnableOneUpAZNBViewerForEmbed",function(){return Dr}),n.d(t,"EnableNewOneUpWithNoKO",function(){return Ir}),n.d(t,"EnableMobileWebOfficeAppUpsell",function(){return xr}),n.d(t,"EnableOneUpNotifyHostAccessibilityKeySequence",function(){return Cr}),n.d(t,"OneUpEmbedWacPassClientId",function(){return Or}),n.d(t,"OneUpEmbedWacPassDocClickTime",function(){return wr}),n.d(t,"OneUpEmbedWacPassUih",function(){return Er}),n.d(t,"OneUpEmbedWacPassEmbeddingPageParam",function(){return Ar}),n.d(t,"EnablePdfCoversionForAllTypes",function(){return Lr}),n.d(t,"DefaultPdfToNative",function(){return kr}),n.d(t,"UsePdfViewerToPreviewTif",function(){return Mr}),n.d(t,"AllowVideoDiagnostics",function(){return Pr}),n.d(t,"EnableHlsPretranscode",function(){return Tr}),n.d(t,"UseAltTranscodeForDashManifests",function(){return Ur}),n.d(t,"UseFlashVideoPlayerFromManifest",function(){return Fr}),n.d(t,"VideoEndOfStream",function(){return Hr}),n.d(t,"VideoModeCascadeTimeout",function(){return Rr}),n.d(t,"VideoModePreferStreamError",function(){return Nr}),n.d(t,"VideoAttemptFfmpegToMediaFoundationFallback",function(){return Br}),n.d(t,"VideoMoreAgressiveTokenRefresh",function(){return jr}),n.d(t,"VideoForcedTokenRefresh",function(){return Vr}),n.d(t,"VideoTokenFromGraph",function(){return zr}),n.d(t,"VideoSetQueryParamForNative",function(){return Gr}),n.d(t,"VideoSetCorrelationIdAsQSP",function(){return Kr}),n.d(t,"VideoSetPsiAndCcatQspToManifestKillSwitch",function(){return Wr}),n.d(t,"VideoCorsErrorTest",function(){return qr}),n.d(t,"VideoEnableReducedMaxRequestCount2",function(){return Qr}),n.d(t,"VideoEnableReducedMaxRequestCount4",function(){return Yr}),n.d(t,"VideoLimitDefaultStartingQuality480p",function(){return Jr}),n.d(t,"UseOnePlayer",function(){return Xr}),n.d(t,"UseOnePlayerForEmbedMicroservice",function(){return Zr}),n.d(t,"EnableOnePlayerForGovCloud",function(){return $r}),n.d(t,"EnableOnePlayerForGovCloudForEmbedMicroservice",function(){return eo}),n.d(t,"EnableFluentMtcPreloadNativeKillswitch",function(){return to}),n.d(t,"EnableOnePlayerVideoDataSourceVROOMTokenKillswitch",function(){return no}),n.d(t,"EnableOnePlayerReturnVideoElementToHostKillswitch",function(){return ao}),n.d(t,"EnableHostPageContextForOnePlayerEmbed",function(){return io}),n.d(t,"EnableOnePlayerDeveloperToolsPanel",function(){return ro}),n.d(t,"EnableOnePlayerFluentMtcOptimization",function(){return oo}),n.d(t,"EnableRenderListDataAsStreamCallForTeams",function(){return so}),n.d(t,"VideoABRQualityThrottle240",function(){return co}),n.d(t,"VideoABRQualityThrottle360",function(){return lo}),n.d(t,"VideoABRQualityThrottle480",function(){return uo}),n.d(t,"VideoABRQualityThrottle720",function(){return fo}),n.d(t,"VideoUseCdn",function(){return po}),n.d(t,"VideoEnableEncryption",function(){return mo}),n.d(t,"VideoUseCdnForHls",function(){return _o}),n.d(t,"VideoEnableEncryptionForHls",function(){return ho}),n.d(t,"VideoDecryptionErrorsInvestigation",function(){return bo}),n.d(t,"VideoSessionHeartbeat",function(){return go}),n.d(t,"VideoEnableMaxRetryCheckOnRequestManagerKillSwitch",function(){return vo}),n.d(t,"VideoParseResolutionFromAdaptationSetHeight",function(){return yo}),n.d(t,"VideoEnableDashlingTelemetry",function(){return So}),n.d(t,"VideoEnableDashlingDecryptorV2",function(){return Do}),n.d(t,"VideoEnableDashlingParallelKeyCall",function(){return Io}),n.d(t,"VideoEnableDashlingCdnRefIdsTelemetry",function(){return xo}),n.d(t,"VideoEnableDashlingTelemetryInfo",function(){return Co}),n.d(t,"VideoEnableRefreshToken",function(){return Oo}),n.d(t,"VideoEnableForceMeta",function(){return wo}),n.d(t,"VideoEnableDashlingHybridPlayback",function(){return Eo}),n.d(t,"VideoDashlingMaxBuffer30Seconds",function(){return Ao}),n.d(t,"VideoDashlingMaxBuffer60Seconds",function(){return Lo}),n.d(t,"VideoDashlingMaxBuffer90Seconds",function(){return ko}),n.d(t,"TeamsMeetingRecordingPlayerCaptionSupport",function(){return Mo}),n.d(t,"VideoEnableDashlingOptimizations",function(){return Po}),n.d(t,"VideoRetryMetadataCallWithPlaybackAccessToken",function(){return To}),n.d(t,"TeamsMeetingRecordingPrecheckForCaptionsFromMeta",function(){return Uo}),n.d(t,"TMRMetaRedirect",function(){return Fo}),n.d(t,"ForceTMRToMediaFoundation",function(){return Ho}),n.d(t,"TMRFallbackToFFMPEG",function(){return Ro}),n.d(t,"StreamOnlineClientIdForShare",function(){return No}),n.d(t,"VideoIdentifyOneUpPlayerToMetaKillswitch",function(){return Bo}),n.d(t,"DisableSKCompliance",function(){return jo}),n.d(t,"CallstackQueryStringParameter",function(){return Vo}),n.d(t,"HlsV6Playback",function(){return zo}),n.d(t,"MeTAVideoManifestQspPassthrough",function(){return Go}),n.d(t,"DashlingRequestTimeout15s",function(){return Ko}),n.d(t,"VideoRequestStaggerMultiple1",function(){return Wo}),n.d(t,"EnableDASHOnSafari",function(){return qo}),n.d(t,"EnableRobustLoggingForManifestRequests",function(){return Qo}),n.d(t,"ForceProgressivePlaybackOnDownloadAspx",function(){return Yo}),n.d(t,"EnablePretranscodeSupport",function(){return Jo}),n.d(t,"EmbedAccessOnEmbedAspx",function(){return Xo}),n.d(t,"EmbedLinkSupportOnEmbedAspx",function(){return Zo}),n.d(t,"ReportOneUpFileAccess",function(){return $o}),n.d(t,"RemoveOneUpSlideNavigation",function(){return es}),n.d(t,"ShowRequestAccessButton",function(){return ts}),n.d(t,"DarkBackgroundForPhotosOneUp",function(){return ns}),n.d(t,"DarkBackgroundForPhotosOneUpExperiment",function(){return as}),n.d(t,"DarkBackgroundForPhotosOneUpExperiment_ABTrigger",function(){return is}),n.d(t,"EnableLivePhotoVideos",function(){return rs}),n.d(t,"EnableLivePhotoVideos_NativePlayback",function(){return os}),n.d(t,"EnableLivePhotoVideosForCobUser",function(){return ss}),n.d(t,"EnableSamsungMotionPhotoVideos",function(){return cs}),n.d(t,"EngagementTelemetryEnhancement",function(){return ds}),n.d(t,"IncludeAudioEnhancementInVideoManifestFile",function(){return ls}),n.d(t,"VideoAutoplayBehaviorUpdate",function(){return us}),n.d(t,"OnePlayerVideoAutoplayBehaviorUpdate",function(){return fs}),n.d(t,"OnePlayerVideoDeferAllowedUpdate",function(){return ps}),n.d(t,"EnableEditUtilityControlIE",function(){return ms}),n.d(t,"EnableEditUtilityControlSafari",function(){return _s}),n.d(t,"EnableEditUtilityControlMobile",function(){return hs}),n.d(t,"EnableEditUtilityControl",function(){return bs}),n.d(t,"EnableEditControlTeachingBubble",function(){return gs}),n.d(t,"EnableEditControlExperimentAA",function(){return vs}),n.d(t,"EnableEditControlExperimentAB",function(){return ys}),n.d(t,"EnableEditControlAdjustments",function(){return Ss}),n.d(t,"EnableEditControlFilters",function(){return Ds}),n.d(t,"EnableEditAllImageFormats",function(){return Is}),n.d(t,"EnableEditControlMarkup",function(){return xs}),n.d(t,"EnableEditControlArrowHead",function(){return Cs}),n.d(t,"EnableEditPNG",function(){return Os}),n.d(t,"EnableEditHEIC",function(){return ws}),n.d(t,"FlushBufferredDataDuringStreamReset",function(){return Es}),n.d(t,"UseMsPdfViewer",function(){return As}),n.d(t,"EnableEditPDF",function(){return Ls}),n.d(t,"EnableEmbedMsPdfViewer",function(){return ks}),n.d(t,"UseMsPdfViewerForEmbedMicroservice",function(){return Ms}),n.d(t,"EnableEditPdfTeachingBubble",function(){return Ps}),n.d(t,"EnableExtractAndMergeTeachingBubble",function(){return Ts}),n.d(t,"EnableGetESignaturesTeachingBubble",function(){return Us}),n.d(t,"UseUniversalAnnotation",function(){return Fs}),n.d(t,"ERBugFixesEnabledForUniversalAnnotation",function(){return Hs}),n.d(t,"EnablePdfDownloadByRange",function(){return Rs}),n.d(t,"EnablePdfFormFilling",function(){return Ns}),n.d(t,"PWAListsInstallPrompt",function(){return Bs}),n.d(t,"PWAODInstallPrompt",function(){return js}),n.d(t,"EnableEditSmartTemplateItemscopeAction",function(){return Vs}),n.d(t,"EnableCopyLinkInContentAssemblyTemplates",function(){return zs}),n.d(t,"OptimizelyEnabled",function(){return Gs}),n.d(t,"DisplayGuestPermittedInfoInModernHeader",function(){return Ks}),n.d(t,"EnterExitTeamsFullscreen",function(){return Ws}),n.d(t,"ListFormMultiColumns",function(){return qs}),n.d(t,"EnableRecommendList",function(){return Qs}),n.d(t,"OnePlayerEnableHlsFFMPEGKillSwitch",function(){return Ys}),n.d(t,"ForceHlsForSafariOnePlayerKillswitch",function(){return Js}),n.d(t,"AddCrossOriginAnonymousForProgressiveVideoKillswitch",function(){return Xs}),n.d(t,"OnePlayerEmbedCrossWindowSupport",function(){return Zs}),n.d(t,"OnePlayerDisableCdn",function(){return $s}),n.d(t,"OnePlayerPrefetchFluentMtc",function(){return ec}),n.d(t,"OnePlayerFavorAdaptiveForLongerTMRVideo",function(){return tc}),n.d(t,"OnePlayerFavorAdaptiveForLongerNonTMRVideo",function(){return nc}),n.d(t,"OnePlayerFastNextGenEngineEnabled",function(){return ac}),n.d(t,"OnePlayerFastNextGenEngineGovEnabled",function(){return ic}),n.d(t,"OnePlayerRefactoredSourceProviderEnabled",function(){return rc}),n.d(t,"OnePlayerAlwaysUseFFMPEG",function(){return oc}),n.d(t,"OnePlayerOneDsEndpointOverride",function(){return sc}),n.d(t,"OnePlayerOneDSEndpointOverrideGovClouds",function(){return cc}),n.d(t,"ODSPSidePanelRetentionChartEnabledForGCCandITAR",function(){return dc}),n.d(t,"StreamEmbedRemoveGetItemDependencyEnabled",function(){return lc}),n.d(t,"CreateFromListUseSiteScriptAPI",function(){return uc}),n.d(t,"LeftNavOpenInNewWindow",function(){return fc}),n.d(t,"EnableExpirationSectionForTMR",function(){return pc}),n.d(t,"EnableCheckExpirationDateForTMR",function(){return mc}),n.d(t,"CreateListFromCSV",function(){return _c}),n.d(t,"CreateListFromCSVathena",function(){return hc}),n.d(t,"IncludeSchemaInExportImportCSV",function(){return bc}),n.d(t,"IncludeSchemaInExportImportCSVSpartanLists",function(){return gc}),n.d(t,"shouldTargetWindow",function(){return vc}),n.d(t,"EnableCameraHvcInStreamAspx",function(){return yc}),n.d(t,"EnableOneCameraInSwa",function(){return Sc}),n.d(t,"EnableSwaNewRecordingCommandButton",function(){return Dc}),n.d(t,"EnableSwaScreenRecordingCommandButton",function(){return Ic}),n.d(t,"EnableSwaCreateUploadDestinationPicker",function(){return xc}),n.d(t,"EnableSwaFileManagement",function(){return Cc}),n.d(t,"EnableSWAUploadWithDestinationPicker",function(){return Oc}),n.d(t,"EnableClipchampFileABug",function(){return wc}),n.d(t,"EnableItemsScopeHierarchyFix",function(){return Ec}),n.d(t,"EnablePostRollShareHandler",function(){return Ac}),n.d(t,"EnablePostRollShareUseActionHook",function(){return Lc}),n.d(t,"EnableOpenButtonAfterSWAUpload",function(){return kc}),n.d(t,"EnableOpenButtonAfterSWAMoveCopy",function(){return Mc}),n.d(t,"EnableTextInsteadOfFolderLinksForSwaUpload",function(){return Pc}),n.d(t,"EnableOpenButtonAfterSWAMoveCopyRefactor",function(){return Tc}),n.d(t,"EnableVideoSettingsAfterSWAUpload",function(){return Uc}),n.d(t,"EnableSingleItemInNewMenuDropDown",function(){return Fc}),n.d(t,"SuppressSharedRootInMoveCopyPanel",function(){return Hc}),n.d(t,"OnePlayerBugfixAriaDeferredLoadKillswitch",function(){return Rc}),n.d(t,"AuthZenBlockDownloadPolicyBanner",function(){return Nc}),n.d(t,"ReadOnlyAccessPolicyBanner",function(){return Bc}),n.d(t,"AuthContextLimitedAccessBanner",function(){return jc}),n.d(t,"DownloadDebugLogs",function(){return Vc}),n.d(t,"ProgressiveUrlQspStreamClient",function(){return zc}),n.d(t,"VCAnalyticsMSITTestingOSDPWeb",function(){return Gc}),n.d(t,"CreateConvergenceEnabled",function(){return Kc}),n.d(t,"CreateConvergenceViaVroom",function(){return Wc}),n.d(t,"CreateODFDocumentViaVroom",function(){return qc}),n.d(t,"EnableCreateODFDocument",function(){return Qc}),n.d(t,"EnableItemCacheCreateDocument",function(){return Yc}),n.d(t,"EnableStableFREforTMR",function(){return Jc}),n.d(t,"UseUTCTimeZoneForTMR",function(){return Xc}),n.d(t,"CheckIfCodecCanBePlayedNativelyKillswitch",function(){return Zc}),n.d(t,"EnableEmbedDialog",function(){return $c}),n.d(t,"EnableGraphApiGetEmbedInfo",function(){return ed}),n.d(t,"SPAppBarBlockHubJoin",function(){return td}),n.d(t,"ShareEmbedCodeInSWAEnabled",function(){return nd}),n.d(t,"OnePlayerAccurateLoadSignal",function(){return ad}),n.d(t,"NeutralStreamWebAppTheme",function(){return id}),n.d(t,"SWAAddToFavorites",function(){return rd}),n.d(t,"SWAViewEditMode",function(){return od}),n.d(t,"HideTaggingFeatures",function(){return sd}),n.d(t,"EnableATOForCOBtoODC",function(){return cd}),n.d(t,"EnableATOForODCtoCOB",function(){return dd}),n.d(t,"EnableATOForCOBtoCOB",function(){return ld}),n.d(t,"HideShareButton",function(){return ud}),n.d(t,"HideEditPhoto",function(){return fd}),n.d(t,"HideEmbedButton",function(){return pd}),n.d(t,"HideAlbumPivot",function(){return md}),n.d(t,"ShowAlertIcon",function(){return _d}),n.d(t,"EnableDocumentDigestEmail",function(){return hd}),n.d(t,"FixODCOneUpPreview",function(){return bd}),n.d(t,"MinVideoBandwithKillswitch",function(){return gd}),n.d(t,"GetRequestParametersErrorForPrefetchKillswitch",function(){return vd}),n.d(t,"FetchOperationErrorLogKillswitch",function(){return yd}),n.d(t,"isOneplayerPlaygroundEnabled",function(){return Sd}),n.d(t,"isWebRecorderPlaygroundEnabled",function(){return Dd}),n.d(t,"isStreamWebAppMigrationToOnePlayerV2Enabled",function(){return Id}),n.d(t,"isUsingServerUrlForSWADriveAccessTokens",function(){return xd}),n.d(t,"isAudioFilesEnabled",function(){return Cd}),n.d(t,"isRemoveCommandBarNewTooltipEnabled",function(){return Od}),n.d(t,"enableAlbumForConvergence",function(){return wd}),n.d(t,"EnableCreateAlbumFromFolder",function(){return Ed}),n.d(t,"EnableAddToAlbum",function(){return Ad}),n.d(t,"enableMojForConvergence",function(){return Ld}),n.d(t,"isAudioFilesGovEnabled",function(){return kd}),n.d(t,"SpartanByDefaultWithFallback",function(){return Md}),n.d(t,"VideoPage_Conf",function(){return Pd}),n.d(t,"VideoPage",function(){return Td}),n.d(t,"EnablePreAuthEmbedLinkForImage",function(){return Ud}),n.d(t,"StreamScopedSearchRedirectionFromSWA",function(){return Fd}),n.d(t,"EnableRestServiceNetworkCallExperiment",function(){return Hd}),n.d(t,"EnableRestServiceNetworkCallFlight",function(){return Rd}),n.d(t,"CreateSiteNewFlow",function(){return Nd}),n.d(t,"EnableMojNavigateToNpe",function(){return Bd}),n.d(t,"StreamCoWatchEntryPoint",function(){return jd}),n.d(t,"EnableExternalLinkSWA",function(){return Vd}),n.d(t,"EditVideoInClipchampFromSWA",function(){return zd}),n.d(t,"EnableIconOnlyCommandForSmallWindowsSWA",function(){return Gd}),n.d(t,"CreateNewClipchampProjectInSWA",function(){return Kd}),n.d(t,"EnableAddPeopleWithShareDialog",function(){return Wd}),n.d(t,"EnableSearchHistorySettingInCob",function(){return qd}),n.d(t,"EnableBulkFileDownloadInCob",function(){return Qd}),n.d(t,"PlayerEngineProgressiveServiceWorker",function(){return Yd}),n.d(t,"EnableRotatePhotoInCob",function(){return Jd}),n.d(t,"OnePlayerCdnOnlyEnabled",function(){return Xd}),n.d(t,"RemoveKoViewParamKillswitch",function(){return Zd}),n.d(t,"FixCustomizationOptionInEmbedDialog",function(){return $d}),n.d(t,"EnableSetAsCoverForFolderInCob",function(){return el});var a=n(9),i=n(4);n.d(t,"pageContext",function(){return i.fs}),n.d(t,"isOneDriveWinApp",function(){return i.os}),n.d(t,"isSPListWebpack",function(){return i.ss}),n.d(t,"isOneDrive",function(){return i.rs}),n.d(t,"isSPOFilePickerWebPack",function(){return i.cs}),n.d(t,"isODBFileBrowserWebPack",function(){return i.ns}),n.d(t,"isODBLightSpeedWebPack",function(){return i.as}),n.d(t,"isTeamsODBFileBrowserV2",function(){return i.ls}),n.d(t,"isMetaOSODBFileBrowserV2",function(){return i.ts}),n.d(t,"FluentVNextStyling",function(){return i.mn}),n.d(t,"PowerApps",function(){return i.ai}),n.d(t,"AthenaPlaceholdersUX",function(){return i.h}),n.d(t,"Enable1DSTelemetryForOneDrive",function(){return i.be}),n.d(t,"EnableCustomerPromiseWebWorker",function(){return i.we}),n.d(t,"UseODBInitForMainThread",function(){return i.Lo}),n.d(t,"DisableDataScrubbing1DS",function(){return i.te}),n.d(t,"AadTokenProviderPopupFlow",function(){return i.e}),n.d(t,"ODBTelemetryWebWorker",function(){return i.Ra}),n.d(t,"EnableFavoritesV2",function(){return i.Le}),n.d(t,"EnableColoredFolders",function(){return i.De}),n.d(t,"UseSpartanSWM",function(){return i.No}),n.d(t,"EnableSpartanMeetingsView",function(){return i.Ut}),n.d(t,"EnableSpartanPeopleView",function(){return i.Ft}),n.d(t,"EnableOneDrivePhotosView",function(){return i.st}),n.d(t,"EnableNonFileInODB",function(){return i.Je}),n.d(t,"RecommendedInOdb",function(){return i.hi}),n.d(t,"ExecuteOnRenderedCallBackInSpartan",function(){return i.nn}),n.d(t,"UseItemsScopeDefaultClickForSpartanList",function(){return i.no}),n.d(t,"isWinAppVersionCompatible",function(){return i.us}),n.d(t,"isODCLightspeedManifest",function(){return i.is}),n.d(t,"IsODBWebApp",function(){return i.Rn}),n.d(t,"AddTelemetryHeaders",function(){return i.i}),n.d(t,"ApprovalFlows",function(){return i._}),n.d(t,"BypassOAuthForCrossGeoCallsInFilePicker",function(){return i.g}),n.d(t,"CSIOdbScopedSearch",function(){return i.w}),n.d(t,"CSIOdbScopeControl",function(){return i.O}),n.d(t,"CSISpoScopeControl",function(){return i.P}),n.d(t,"CSISPODisableUpscopeSearch",function(){return i.L}),n.d(t,"CSIOdbNotMyFiles3S",function(){return i.C}),n.d(t,"CSISearchQueryAlteration",function(){return i.k}),n.d(t,"CSISearchResultUnifiedModifiedTime",function(){return i.M}),n.d(t,"CSIMetadataSearchInSPLists",function(){return i.I}),n.d(t,"CSIMetadataSearchNPS",function(){return i.x}),n.d(t,"CSIContentQueryDiscoveryFRE",function(){return i.y}),n.d(t,"CSIQueryableMultiLineTextField",function(){return i.A}),n.d(t,"CSIQueryableListColumnsForSyntex",function(){return i.E}),n.d(t,"CSIContentQueryLicenseCheckUpdate",function(){return i.S}),n.d(t,"ChangeFlowToAutomate",function(){return i.T}),n.d(t,"ClientCustomActions",function(){return i.H}),n.d(t,"PropertiesFormConnector",function(){return i.fi}),n.d(t,"CreateMMDColumnField",function(){return i.J}),n.d(t,"CreateLookupColumnField",function(){return i.Y}),n.d(t,"CreateColumnNewOrder",function(){return i.q}),n.d(t,"ContentCenterEnabled",function(){return i.G}),n.d(t,"ConsumeExposedDefaultClickControl",function(){return i.B}),n.d(t,"DeferredPageContextInfo",function(){return i.ee}),n.d(t,"DisableDomainLowering",function(){return i.ne}),n.d(t,"DisablePopularAroundYou",function(){return i.ie}),n.d(t,"DisableServiceWorkerPWA",function(){return i.oe}),n.d(t,"DocumentSetsModernView",function(){return i.fe}),n.d(t,"DynamicFlowDates",function(){return i.me}),n.d(t,"EnableActionMemoization",function(){return i.Se}),n.d(t,"EnableAccountSwitching",function(){return i.ye}),n.d(t,"EnableCommonServiceWorker",function(){return i.Ie}),n.d(t,"EnableFoldersDocumentsGroupings",function(){return i.He}),n.d(t,"EnableODBServiceWorker",function(){return i.$e}),n.d(t,"EnableOdbServiceWorkerExperiment",function(){return i.nt}),n.d(t,"EnableOneUpDataManager",function(){return i.ct}),n.d(t,"EnableODCServiceWorker",function(){return i.et}),n.d(t,"EnableServiceWorkerPrefetch",function(){return i.At}),n.d(t,"EnableLastWeekPreviousYearsExp",function(){return i.Ve}),n.d(t,"EnableMonthRecapGroupHeaderExp",function(){return i.Ke}),n.d(t,"EnableOneUpInSwmPwa",function(){return i.dt}),n.d(t,"EnablePowerPointWrsPreview",function(){return i.bt}),n.d(t,"DebugWindow",function(){return i.$}),n.d(t,"EnableOpenInImmersiveReader",function(){return i.lt}),n.d(t,"EnableItemsScopeOpenInStream",function(){return i.je}),n.d(t,"EnableReferrerLoggingOnPageViewEvents",function(){return i.xt}),n.d(t,"EnableQuickAccess",function(){return i.vt}),n.d(t,"EnablePinToQuickAccess",function(){return i._t}),n.d(t,"EnableQuickAccessDragAndDrop",function(){return i.yt}),n.d(t,"EnableInLineFolderSVGs",function(){return i.Be}),n.d(t,"EnableRandomDefaultFolderColor",function(){return i.St}),n.d(t,"EnableFolderColorPrefetch",function(){return i.Fe}),n.d(t,"EnableRecentWithGraphAddon",function(){return i.It}),n.d(t,"EnableRecentForMigratedUsers",function(){return i.Dt}),n.d(t,"DisableWinAppPhotosPivot",function(){return i.de}),n.d(t,"ExecuteFREAfterFCI",function(){return i.tn}),n.d(t,"ShimSpartanOneUpInFavorites",function(){return i.Zi}),n.d(t,"ShimSpartanOneUpInSWM",function(){return i.$i}),n.d(t,"EnablingSpartanInFileBrowser",function(){return i.en}),n.d(t,"EnableSpartanInWebViewList",function(){return i.Tt}),n.d(t,"enableRenderListDataServedFromCacheFirst",function(){return i.Zo}),n.d(t,"SpartanListInNewTab",function(){return i.fr}),n.d(t,"SpartanExperiment",function(){return i.ur}),n.d(t,"SpartanDocLibInNewTab",function(){return i.lr}),n.d(t,"UseFileBrowserForSitesInODB",function(){return i.Jr}),n.d(t,"UseFileBrowserLayerProjectionForSitesInODB",function(){return i.Xr}),n.d(t,"UseCrossSiteFileBrowserForSitesInODB",function(){return i.Qr}),n.d(t,"UseODBLightSpeedInFileBrowser",function(){return i.ko}),n.d(t,"AlwaysUseOneDriveNavForUser",function(){return i.u}),n.d(t,"LoadFilesViewAddonsAsync",function(){return i.oa}),n.d(t,"EnableSiteRootBreadcrumbIcons",function(){return i.Mt}),n.d(t,"EnablePhoneLinkInFilePicker",function(){return i.ut}),n.d(t,"EnableSpartanRecentFilePicker",function(){return i.Ht}),n.d(t,"EnableTilesListMediaGroupings",function(){return i.zt}),n.d(t,"ScenarioHeaderInPushChannelAndFRE",function(){return i.Ni}),n.d(t,"EnableTitleInImmersiveReader",function(){return i.Kt}),n.d(t,"EnableTimeToFileItemEngagement",function(){return i.Gt}),n.d(t,"AddColumnsToView",function(){return i.n}),n.d(t,"ForceEnableCrossOriginCommands",function(){return i.bn}),n.d(t,"ForceSwitchToDogFoodForPhoneLink",function(){return i.Sn}),n.d(t,"ForceSwitchToBetaForPhoneLink",function(){return i.yn}),n.d(t,"ForceSwitchToProductionForPhoneLink",function(){return i.Dn}),n.d(t,"ForceUseMockAPIForPhoneLink",function(){return i.In}),n.d(t,"ForceUseV2HVCForPhoneLink",function(){return i.xn}),n.d(t,"EnableFeedbackForPhoneLink",function(){return i.ke}),n.d(t,"EnableTrendingSignalInItemsScope",function(){return i.Wt}),n.d(t,"EnableWordWrsPreview",function(){return i.Jt}),n.d(t,"EnableWiderShareDialog",function(){return i.Yt}),n.d(t,"UsePerManifestPrefetchForTeamChannelFilter",function(){return i.To}),n.d(t,"FileRequestUI",function(){return i.ln}),n.d(t,"FileRequestInSharePoint",function(){return i.dn}),n.d(t,"FlowForLibraries",function(){return i.pn}),n.d(t,"ForceEnableAria",function(){return i.hn}),n.d(t,"HideExploreYourPhotosCarousel",function(){return i.kn}),n.d(t,"HideLanguagePickerForAnonymous",function(){return i.Mn}),n.d(t,"IntegrateCommandOnLists",function(){return i.Hn}),n.d(t,"ItemActivityColumn",function(){return i.Nn}),n.d(t,"ItemCachePerformanceTimings",function(){return i.Bn}),n.d(t,"EnableFixCurrentItemUrlAutoAction",function(){return i.Te}),n.d(t,"LightspeedListViewDataPrefetch",function(){return i.qn}),n.d(t,"LightspeedQuotaPrefetch",function(){return i.Qn}),n.d(t,"PreferIsMySiteOwner",function(){return i.oi}),n.d(t,"ListDataRenderOptionChange",function(){return i.Zn}),n.d(t,"LocationHoverCard",function(){return i.ca}),n.d(t,"LoadFloodgateOnDemand",function(){return i.sa}),n.d(t,"ModernizeAddColumn",function(){return i.ha}),n.d(t,"O365ShellModuleJSClient",function(){return i.Ma}),n.d(t,"ODBLeftNavPins",function(){return i.Fa}),n.d(t,"OD3Fluent2TokenSupport",function(){return i.Ta}),n.d(t,"OD3DragAndDropToFavoritesStyling",function(){return i.Pa}),n.d(t,"OdbLightspeed",function(){return i.ja}),n.d(t,"OdbLightSpeedBasic",function(){return i.Ba}),n.d(t,"OdcLightspeed",function(){return i.Va}),n.d(t,"SPPagesSuiteSearchBox",function(){return i.Ri}),n.d(t,"CSIGuestSuiteNavSearchBox",function(){return i.D}),n.d(t,"OneDriveLightSpeedPltBlock",function(){return i.Ga}),n.d(t,"ShowPerfButton",function(){return i.or}),n.d(t,"ODBFeedbackPanel",function(){return i.Ua}),n.d(t,"InitializeLoggingWithOAuthSupport",function(){return i.Un}),n.d(t,"UseGetDriveQuotaKey",function(){return i.eo}),n.d(t,"PrefetchItemForConvergence",function(){return i.si}),n.d(t,"RenderSuiteNavPostFCI",function(){return i.Ei}),n.d(t,"RefreshOnPreviewClose",function(){return i.bi}),n.d(t,"PeopleCardsOnLoki",function(){return i.Wa}),n.d(t,"PeopleCardsReactComponent",function(){return i.qa}),n.d(t,"PowerAppListForms",function(){return i.ni}),n.d(t,"PreviewAIBuilder",function(){return i.ci}),n.d(t,"PreviewUnknownFileTypes",function(){return i.di}),n.d(t,"ProcessSimple",function(){return i.li}),n.d(t,"EnableLightspeedManifestForODBNonPages",function(){return i.ze}),n.d(t,"RenderBypassDefaultClickAction",function(){return i.yi}),n.d(t,"EnableSubstrateSearchResults",function(){return i.Bt}),n.d(t,"RecentFileHoverCard",function(){return i.pi}),n.d(t,"RenderBypassHeroCommands",function(){return i.Di}),n.d(t,"RenderBypassSignals",function(){return i.xi}),n.d(t,"RenderBypassDragDrop",function(){return i.Si}),n.d(t,"RenderBypassPersonaCard",function(){return i.Ii}),n.d(t,"RenderBypassStickyHeaders",function(){return i.Ci}),n.d(t,"RenderBypassSuiteNavFull",function(){return i.wi}),n.d(t,"RenderBypassSuiteNavDeferred",function(){return i.Oi}),n.d(t,"StopAtAppStart",function(){return i._r}),n.d(t,"RequestDatesInUtc",function(){return i.Li}),n.d(t,"RequestSignOffSwitch",function(){return i.Mi}),n.d(t,"RulesPanel",function(){return i.Ti}),n.d(t,"RulesOnLibrary",function(){return i.Pi}),n.d(t,"SPOFlowIntegration",function(){return i.Fi}),n.d(t,"SearchWithShortcutSupport",function(){return i.Gi}),n.d(t,"SearchItemsScope",function(){return i.Vi}),n.d(t,"SearchItemsScopeInPicker",function(){return i.zi}),n.d(t,"SetDetailsLayoutAsDefault",function(){return i.Ki}),n.d(t,"SetDetailsLayoutAsDefaultExpV3",function(){return i.Wi}),n.d(t,"ShareToTeams",function(){return i.Yi}),n.d(t,"SharedWithMeFileHoverCard",function(){return i.Xi}),n.d(t,"UseItemsScopeUpload",function(){return i.Do}),n.d(t,"ShareDropdownCommand",function(){return i.Qi}),n.d(t,"ShowItemsScopeODBMoreSitesPage",function(){return i.rr}),n.d(t,"Spotlight",function(){return i.mr}),n.d(t,"UnifiedAutomateIntegrateMenu",function(){return i.Ur}),n.d(t,"UnifiedSuiteNavBootstrapperLoadingFlow",function(){return i.Fr}),n.d(t,"UnifiedSuiteNavComponent",function(){return i.Hr}),n.d(t,"Use3SFileSuggestion",function(){return i.Wr}),n.d(t,"UseSelfIssuedTokenForSPOWebAuth",function(){return i.Uo}),n.d(t,"UseSelfIssuedTokenInZipDownload",function(){return i.Fo}),n.d(t,"UseIdentityAuthForVroom",function(){return i.to}),n.d(t,"UseItemsScopeDefaultClickHandlers",function(){return i.ao}),n.d(t,"DisableSilentAuthFrameForUnauthUsers",function(){return i.se}),n.d(t,"UseItemsScopeInAlbums",function(){return i.io}),n.d(t,"UseFilePicker80ForSPOMoveCopy",function(){return i.Zr}),n.d(t,"UseItemsScopeVroomMoveCopy",function(){return i.Io}),n.d(t,"UseItemsScopeInAllPhotosEnableIE",function(){return i.oo}),n.d(t,"UseItemsScopeInAllPhotosEnableMobile",function(){return i.co}),n.d(t,"UseItemsScopeInAllPhotosEnableSafari",function(){return i.lo}),n.d(t,"UseItemsScopeInAllPhotos",function(){return i.ro}),n.d(t,"UseItemsScopeInAllTags",function(){return i.uo}),n.d(t,"UseItemsScopeInOneDrive",function(){return i.po}),n.d(t,"UseItemsScopeInPlaces",function(){return i.mo}),n.d(t,"UseItemsScopeInShared",function(){return i._o}),n.d(t,"UseItemsScopeInSingleAlbum",function(){return i.ho}),n.d(t,"UseItemsScopeInSingleTag",function(){return i.go}),n.d(t,"UseItemsScopeInSinglePlace",function(){return i.bo}),n.d(t,"UseItemsScopeInOnThisDay",function(){return i.fo}),n.d(t,"UseItemsScopeInAllPhotosEnableInFilePicker",function(){return i.so}),n.d(t,"UseItemsScopeInSitesForODB",function(){return i.vo}),n.d(t,"UseItemsScopeInTeamSites",function(){return i.So}),n.d(t,"UseItemsScopeInSuiteNav",function(){return i.yo}),n.d(t,"UseLargeDriveItemSetPageSize",function(){return i.xo}),n.d(t,"UseNewShareDialogForWinApp",function(){return i.Eo}),n.d(t,"WACHostMoveToFolder",function(){return i.Xo}),n.d(t,"WACHostCommonFilePicker",function(){return i.Jo}),n.d(t,"EnableFreeTrialForUSQRollout",function(){return i.Re}),n.d(t,"DisableManageStorageForUSQ",function(){return i.ae}),n.d(t,"EnableLoginTakeoverForUSQ",function(){return i.Ge}),n.d(t,"ShowPwaInstallDialogInUwpApp",function(){return i.sr}),n.d(t,"ReplaceSourcedocPathToGuid",function(){return i.Ai}),n.d(t,"UpdateUIConvergenceEnbaled",function(){return i.Kr}),n.d(t,"ShouldShimShareCommand",function(){return i.tr}),n.d(t,"ShouldShimVaultSideCommand",function(){return i.nr}),n.d(t,"LeanItemsViewWave1",function(){return i.Wn}),n.d(t,"LeanItemsViewDnd2Lists",function(){return i.Kn}),n.d(t,"UserExpirationStrings",function(){return i.Qo}),n.d(t,"ODBSubstrateSearchQueryV2",function(){return i.Ha}),n.d(t,"EnableODCWebWorker",function(){return i.tt}),n.d(t,"SPOODBWebUploadChecksumFrontEnd",function(){return i.Hi}),n.d(t,"EnableStreamUploadHashing",function(){return i.Nt}),n.d(t,"UseVroomInItemsScopeAllPhotosOtdExp",function(){return i.Go}),n.d(t,"UseVroomInItemsScopeAllPhotos",function(){return i.zo}),n.d(t,"AllowTestPhotoNotification",function(){return i.d}),n.d(t,"UseSkipTokenForVroom",function(){return i.Ro}),n.d(t,"UseVroomInItemsScopeSingleTag",function(){return i.Wo}),n.d(t,"UseVroomInItemsScopeSinglePlace",function(){return i.Ko}),n.d(t,"EnablePhotosCarouselOnFile",function(){return i.pt}),n.d(t,"EnablePhotosCarouselOnFileExp",function(){return i.mt}),n.d(t,"EnablePhotoStreamProvisionCheck",function(){return i.ft}),n.d(t,"EnableOdcSyncCommand",function(){return i.at}),n.d(t,"EnableOdcSyncCommandExp",function(){return i.it}),n.d(t,"LargestFilesImprovement",function(){return i.zn}),n.d(t,"LargestFilesImprovementExp",function(){return i.Gn}),n.d(t,"EnableOdcSyncInLeftNav",function(){return i.rt}),n.d(t,"AddToOneDriveMountPointRenderOption",function(){return i.r}),n.d(t,"SearchAppClientFlight",function(){return i.Bi}),n.d(t,"EnableSharePointItemMapping",function(){return i.Lt}),n.d(t,"PowerBIPanel",function(){return i.ri}),n.d(t,"ODCWebAppManifest",function(){return i.Na}),n.d(t,"PersistedFilterPill",function(){return i.Qa}),n.d(t,"UpdateOdcUpgradeOptionApiForConvergence",function(){return i.Vr}),n.d(t,"UpdateOdcStorageInfoApiForConvergence",function(){return i.jr}),n.d(t,"UpdateOdcPhotoApiForConvergence",function(){return i.Br}),n.d(t,"UpdateOdcVaultApiForConvergence",function(){return i.zr}),n.d(t,"ApplyItemsScopeToRecycleBin",function(){return i.m}),n.d(t,"NoFreeUpSpaceSoftLockedBannerExp",function(){return i.wa}),n.d(t,"EnableNoFreeUpSpaceSoftLockedBanner",function(){return i.Ye}),n.d(t,"NewOverquotaExperienceExp",function(){return i.Ca}),n.d(t,"EnabledNewOverquotaExperience",function(){return i.$t}),n.d(t,"NewHighquotaExperienceExp",function(){return i.xa}),n.d(t,"EnabledFreeTrialBanner",function(){return i.Xt}),n.d(t,"FreeTrialBannerExp",function(){return i.On}),n.d(t,"EnabledNewHighquotaExperience",function(){return i.Zt}),n.d(t,"EnableWXPOverQuotaUpsellExp",function(){return i.Qt}),n.d(t,"EnableWXPOverQuotaUpsell",function(){return i.qt}),n.d(t,"EnableFloodgate",function(){return i.Ue}),n.d(t,"NPSCampaignProd",function(){return i.Sa}),n.d(t,"NPSCampaignDogfood",function(){return i.va}),n.d(t,"NPSCampaignForceNomination",function(){return i.ya}),n.d(t,"NPSSuiteSurvey",function(){return i.Da}),n.d(t,"AllPhotosFpsCampaign",function(){return i.c}),n.d(t,"FPSMoveCopy",function(){return i.an}),n.d(t,"NLQSSurvey",function(){return i.ga}),n.d(t,"AlwaysUseMondoPrefetch",function(){return i.l}),n.d(t,"UseWebAbsoluteUrlInSPSitesListsData",function(){return i.qo}),n.d(t,"ListThumbnailThrottling",function(){return i.ea}),n.d(t,"ListThumbnailVideoThrottling",function(){return i.ta}),n.d(t,"FormatCalendarView",function(){return i.Cn}),n.d(t,"UnscheduledPaneInModernCalendar",function(){return i.Nr}),n.d(t,"NewSharedLibrariesPage",function(){return i.Oa}),n.d(t,"FiltersInODB",function(){return i.un}),n.d(t,"UseMicroServiceForSitesLists",function(){return i.Oo}),n.d(t,"OdcSuiteNavSearchBox",function(){return i.za}),n.d(t,"SearchInFilePicker",function(){return i.ji}),n.d(t,"EnableSearchInFilePickerHosts",function(){return i.Et}),n.d(t,"HideCreateSite",function(){return i.Ln}),n.d(t,"ListsHomeGoMobile",function(){return i.aa}),n.d(t,"ListsHomeFirstRun",function(){return i.na}),n.d(t,"ListsHomeSpartanListView",function(){return i.ra}),n.d(t,"FreemiumListsBanner",function(){return i.wn}),n.d(t,"AthenaTryPreviewDialog",function(){return i.b}),n.d(t,"ListsHomeOnboardingExperience",function(){return i.ia}),n.d(t,"UseDialogForDocLibCreate",function(){return i.Yr}),n.d(t,"UseSensitivityLabelChanges",function(){return i.Ho}),n.d(t,"RemoveMobileUpsellBanner",function(){return i.gi}),n.d(t,"UseOnDemandKnockoutItems",function(){return i.Po}),n.d(t,"MoveTransitionResourcesToKOResourceScope",function(){return i.ba}),n.d(t,"ClipchampAppEnabled",function(){return i.R}),n.d(t,"ClipchampDeepLinkEnabled",function(){return i.N}),n.d(t,"EnablePresenceHeaderItemScope",function(){return i.gt}),n.d(t,"TeamsIAInSharepoint",function(){return i.Mr}),n.d(t,"RecentUsesSPO",function(){return i.mi}),n.d(t,"ChannelListLite",function(){return i.U}),n.d(t,"RemoveSharedWithUs",function(){return i.vi}),n.d(t,"SharedChannelAwareTeamsApis",function(){return i.Ji}),n.d(t,"ListCommandBarCustomizationFeature",function(){return i.Xn}),n.d(t,"NucleusDataSyncListsFeature",function(){return i.Ea}),n.d(t,"SyntexAIBHybridModelFlight",function(){return i.br}),n.d(t,"SyntexModelSiteScopeEnabled",function(){return i.Sr}),n.d(t,"NucleusPreviewAvailable",function(){return i.La}),n.d(t,"NucleusMySiteDiscoveryFeature",function(){return i.Aa}),n.d(t,"NucleusSyncIssuesUX",function(){return i.ka}),n.d(t,"UniversalPrintEnabled",function(){return i.Rr}),n.d(t,"FileBrowserAppCachingInTeams",function(){return i.on}),n.d(t,"CreateListFromTemplateFPS",function(){return i.Q}),n.d(t,"EnableTeamsFileHandlerOpenDefaultClick",function(){return i.jt}),n.d(t,"EditSchemaInTeamsFileBrowser",function(){return i.he}),n.d(t,"SyntexFileInspectorPanel",function(){return i.yr}),n.d(t,"SyntexCopilotODB",function(){return i.gr}),n.d(t,"SyntexCopilotPane",function(){return i.vr}),n.d(t,"EditMetadataInTeamsFileBrowser",function(){return i._e}),n.d(t,"AnnouncementsLibrary",function(){return i.f}),n.d(t,"AdvanceCommandsInTeamsFileBrowser",function(){return i.s}),n.d(t,"EnableSpfxInTeamsFileBrowser",function(){return i.Rt}),n.d(t,"RequestSPFXFrameworkInfoInListPrefetch",function(){return i.ki}),n.d(t,"ShadowGraphQLRequest",function(){return i.qi}),n.d(t,"GraphQLMismatchLogging",function(){return i.En}),n.d(t,"ShowExportToPowerBI",function(){return i.ir}),n.d(t,"EnableFilePickerPhotosPivot",function(){return i.Me}),n.d(t,"EnableFilePickerSharedPivot",function(){return i.Pe}),n.d(t,"ItemsScopePureReactDragDrop",function(){return i.jn}),n.d(t,"ForceEnableFilePickerYammerPivot",function(){return i.gn}),n.d(t,"EnableMoveCopyToCloudStorageProviders",function(){return i.We}),n.d(t,"Enable3PFeatureInODBFileBrowser",function(){return i.ge}),n.d(t,"Enable3PSubFeaturesInODBFileBrowser",function(){return i.ve}),n.d(t,"EnableSWMViewsInTeams",function(){return i.wt}),n.d(t,"EnableFromALinkInFilePicker",function(){return i.Ne}),n.d(t,"MergeBrowserOptionsFromPostBody",function(){return i.ua}),n.d(t,"MergePickerOptionsFromPostBody",function(){return i.fa}),n.d(t,"DsapiMemberGroupsInFilesIA",function(){return i.pe}),n.d(t,"EnableSpartanDataPrefetchInTeams",function(){return i.Pt}),n.d(t,"ShowAddCloudStorageCommand",function(){return i.ar}),n.d(t,"ShowTeamsAddCloudStorageCommand",function(){return i.cr}),n.d(t,"TeamsDeeplinkGetChannels",function(){return i.Ir}),n.d(t,"ListFiltersHeader",function(){return i.$n}),n.d(t,"SpartanPersistedFilterPills",function(){return i.pr}),n.d(t,"OverridePBIHost",function(){return i.Ka}),n.d(t,"UseUpdatedPBIApiUrl",function(){return i.Vo}),n.d(t,"ForceEnableSubstrateInFileBrowser",function(){return i.vn}),n.d(t,"LogErrorInPrefetchListData",function(){return i.da}),n.d(t,"SuiteNavNotFixedHeight",function(){return i.hr}),n.d(t,"TemplatizationCustomerPromiseKSActivated",function(){return i.Tr}),n.d(t,"DocumentGenerationCPKSActivated",function(){return i.ue}),n.d(t,"FileHandlerProxyManifest",function(){return i.sn}),n.d(t,"FileHandlerProxyOnWeb",function(){return i.cn}),n.d(t,"CAAEAllowDotxFormat",function(){return i.v}),n.d(t,"ContentAssemblyInTeamsFileBrowser",function(){return i.V}),n.d(t,"PlaceholdersToColumns",function(){return i.Ya}),n.d(t,"ContentAssemblyCoPilot",function(){return i.j}),n.d(t,"ContentAssemblyPayG",function(){return i.z}),n.d(t,"ContractLibForCC",function(){return i.W}),n.d(t,"UseTokenCacheForOAuth",function(){return i.Bo}),n.d(t,"EnableCooldownAfterAuthFlow",function(){return i.Oe}),n.d(t,"UseNewShareDialog",function(){return i.wo}),n.d(t,"EnableMsaOauthErrorRedirect",function(){return i.qe}),n.d(t,"MissingMetadataMessageBar",function(){return i.pa}),n.d(t,"TeamsFileBrowserEnableCookieRefresh",function(){return i.xr}),n.d(t,"TeamsFileBrowserUseTokenFetcherInTokenProvider",function(){return i.wr}),n.d(t,"TeamsFileBrowserUseTokensForCrossDomainCalls",function(){return i.kr}),n.d(t,"TeamsFileBrowserUseTokensForAllCalls",function(){return i.Lr}),n.d(t,"TeamsFileBrowserUseTokenForSubstrateFromTeams",function(){return i.Ar}),n.d(t,"TeamsFileBrowserUseTokenForGraphFromTeams",function(){return i.Er}),n.d(t,"TeamsFileBrowserUseOBOTokens",function(){return i.Or}),n.d(t,"TeamsFileBrowserPrefetchPageOnCookieSet",function(){return i.Cr}),n.d(t,"UseBaseOneDriveNavInTeamsFileBrowser",function(){return i.qr}),n.d(t,"FlushLoggingBeforeCrossWindowMessaging",function(){return i._n}),n.d(t,"EnableDragDropHoverOpen",function(){return i.Ae}),n.d(t,"RecentVroom21Takeover",function(){return i._i}),n.d(t,"EnableDragDropCopy",function(){return i.Ee}),n.d(t,"EnableSPListLightspeedForRestore",function(){return i.Ot}),n.d(t,"SPListLightspeedSpartanListView",function(){return i.Ui}),n.d(t,"ChannelSiteHeaderUpdate",function(){return i.F}),n.d(t,"EnableCookiesForGraphAnalyticsRequests",function(){return i.xe}),n.d(t,"EnableCookiesForGraphSameDomain",function(){return i.Ce}),n.d(t,"DisableSourceInvalidationOnCopy",function(){return i.ce}),n.d(t,"PlaylistPreview",function(){return i.Xa}),n.d(t,"PlaylistPreviewV2",function(){return i.Za}),n.d(t,"PlaylistPreviewV3",function(){return i.$a}),n.d(t,"PlaylistPreviewV4",function(){return i.ei}),n.d(t,"PlaylistPreviewV5",function(){return i.ti}),n.d(t,"AddToPlaylist_ODSP",function(){return i.o}),n.d(t,"VideoFilePickerSearch",function(){return i.Yo}),n.d(t,"PlaylistFilePickerSearch",function(){return i.Ja}),n.d(t,"AddBookListTemplateFlight",function(){return i.t}),n.d(t,"ApartmentHuntingTemplateFlight",function(){return i.p}),n.d(t,"JobApplicationTrackerTemplateFlight",function(){return i.Vn}),n.d(t,"ProductSupportTemplateFlight",function(){return i.ui}),n.d(t,"UpdateTemplateThumbnailsFlight",function(){return i.Gr}),n.d(t,"EnablePowerBIIngegration",function(){return i.ht}),n.d(t,"TeamChannelFolder",function(){return i.Dr}),n.d(t,"UseNewShortcutTagIcon",function(){return i.Ao}),n.d(t,"ShortcutLink",function(){return i.er}),n.d(t,"EnableShortcutSourceInfoSection",function(){return i.kt}),n.d(t,"ContentCenterModelRename",function(){return i.K}),n.d(t,"UseTsQuery",function(){return i.jo}),n.d(t,"SpListNext",function(){return i.dr}),n.d(t,"PowerAppsCustomizeFormsCommandListsAllItems",function(){return i.ii}),n.d(t,"ListAllItemsSpartanListView",function(){return i.Jn}),n.d(t,"UseLocalHostForPhotosView",function(){return i.Co}),n.d(t,"FixRumOneScenarioIdForOneUp",function(){return i.fn}),n.d(t,"DisableScrollInLightspeedPhotoViews",function(){return i.re}),n.d(t,"CurrentItemUsingItemSelectionHelper",function(){return i.Z}),n.d(t,"CurrentItemInAddToAlbumExecutor",function(){return i.X}),n.d(t,"EnableNotificationBannerInLightspeed",function(){return i.Xe}),n.d(t,"LightspeedUpsellPrefetch",function(){return i.Yn}),n.d(t,"UseFilePicker80ForSPOMoveCopyExp",function(){return i.$r}),n.d(t,"DisplayActivitiesInODBUIPlt",function(){return i.le}),n.d(t,"isServiceConfigSettingEnabled",function(){return i.ds}),n.d(t,"EnableTelemetryForEnhancedImageTaggingLibraryToggleActions",function(){return i.Vt}),n.d(t,"getServiceConfigSetting",function(){return i.$o}),n.d(t,"isFeatureEnabled",function(){return i.es}),n.d(t,"NavigationSwitcher",function(){return i.Ia}),n.d(t,"HoverCardInTeamsFileBrowser",function(){return i.Pn}),n.d(t,"IntegrateCommandInTeamsFileBrowser",function(){return i.Fn}),n.d(t,"EnableOfflineAriaTelemetryCache",function(){return i.ot}),n.d(t,"EnableNewStreamWebAppInStreamAspx",function(){return i.Qe}),n.d(t,"AddDeleteListToSettingsFlight",function(){return i.a}),n.d(t,"EnableRequestFilesLink",function(){return i.Ct}),n.d(t,"TeamsLPC",function(){return i.Pr}),n.d(t,"EnableNucleusForItemScopeListPrefetch",function(){return i.Ze}),n.d(t,"ModernTemplateLibraryNewComandEnabled",function(){return i._a}),n.d(t,"ImageTaggerLibraryToggle",function(){return i.Tn}),n.d(t,"MockSyntexPayGLicenseCheck",function(){return i.ma}),n.d(t,"MACByPassEnhancedImageTagging",function(){return i.la}),n.d(t,"GroupListV2",function(){return i.An}),n.d(t,"UseODCInitFor1DS",function(){return i.Mo});var r=n(505);n.d(t,"UseADALForSPOWebAuth",function(){return r.n}),n.d(t,"ShareDialogTestEndpoint",function(){return r.t}),n.d(t,"ListShareMode",function(){return r.e});var o=window._spPageContextInfo,s={Fallback:!0},c={},d={ODB:1616},l={ODB:61066},u={ODB:60165},f={ODB:60192},p={ODB:60640},m={ODB:60362},_={ODB:473},h={ODC:"ODCRequestAccess"},b={ODC:"HolidayPositioningFRE"},g={ODC:"Onboarding50GBStandAlonePlanRamp"},v={ODC:"OneHunderedGBFreDimeEnabled"},y={ODC:"OneHunderedGBFreDimeExp"},S={ODC:"OneHunderedGBFreFreeTrialEnabled"},D={ODC:"OneHunderedGBFreFreeTrialExp"},I={ODC:"FreeTrialOnSecondLogin"},x={ODC:"FreeTrialOnSecondLoginExperiment"},C={ODC:"SinglePlanOptionOnQuotaLevelUpsell"},O={ODC:"SinglePlanOptionOnQuotaLevelUpsellExp"},w={ODC:"OneHunderedGBFre100DefaultDimeEnabled"},E={ODC:"OneHunderedGBFre100DefaultDimeExp"},A={ODC:"EnableHundredGBDIME"},L={ODC:"HundredGBDIMEExperiment"},k={ODC:"UploadQuotaWarningDialogExp"},M={ODC:"UploadQuotaWarningDialogEnabled"},P={ODC:"100GBFreeTrialDialogExp"},T={ODC:"Enable100GBFreeTrialDialog"},U={ODC:"EnableM365BasicV2"},F={ODB:!0},H={ODC:"EnableMsJs"},R={ODC:!0},N={ODB:608},B={ODB:833,ODC:"EnableTeachingBubbles"},j={ODC:"EnableCoachmarks"},V={ODC:"isAddToOneDriveBubbleEnabled"},z={ODC:"PhotosSearchBubble"},G={ODB:539,ODC:!0},K={ODB:499},W={ODC:"EnableNotificationSubscriptions"},q={ODC:"ShowTagCountInPhotos"},Q={ODC:"UseVroomGetPermissions"},Y={ODB:561},J={ODB:1171},X={ODB:564},Z={ODC:"PromotedPhotosContentEnabled"},$={ODC:"OneRmO365UpsellEnabled"},ee={ODC:"EnableDimeVaultUpsell"},te={ODC:"EnableDimeVaultDialog"},ne={ODC:"EnableDimeHolidayPositioning"},ae={ODB:569},ie={ODB:586},re={ODB:571},oe={ODB:572},se={ODB:391},ce={ODB:1253},de={ODB:60575},le={ODC:"EnablePasswordProtectedLinks"},ue={ODC:"EnablePremiumCheckWebPasswordLinks"},fe={ODB:i.rs?721:-721,ODC:"EnableResponsiveFilesListView"},pe={ODC:"EnableIconographyExperiment"},me={ODC:"EnableExpExperimentAATest"},_e={ODB:1296},he={ODB:1701},be={ODB:1861},ge={ODB:60948},ve={ODB:1640},ye={ODB:60740},Se={ODB:60863},De={ODB:640},Ie={ODB:646},xe={ODB:1390},Ce={ODC:"EnableAtMentionTeachingUIAA"},Oe={ODC:"EnableAtMentionTeachingUIAB"},we={ODC:"EnableAtMentionTeachingUI"},Ee={ODC:"LogPeoplePickerMounting"},Ae={ODC:!0,ODB:!1},Le={ODC:"AttachGroupIdToSharedByKey"},ke={ODC:"UseFluidDevPreview"},Me={ODB:688},Pe={ODB:60035},Te={ODB:60795},Ue={ODB:60350},Fe={ODB:60208},He={ODB:60498},Re={ODC:"EnableRedeemSamsungBonusDialog"},Ne={ODC:"RepositionUpsellFREExperiment"},Be={ODC:"FamilySharing"},je={ODC:"FamilySharingWacKS"},Ve={ODC:"ManageAccessRevampConsumer"},ze={ODC:"ODCSharePrefetchInline"},Ge={ODC:"ODCHideNonPremiumLinkFeatures"},Ke={ODC:"SharingTooltipCalloutKS"},We={ODC:"OneHundredGBSKUExperiment"},qe={ODC:"OneHundredGBSKUEnabled"},Qe={ODC:"FiftyGBSKUExperimentv2"},Ye={ODC:"FiftyGBSKUEnabled"},Je={ODC:"Enable3SonWacWord"},Xe={ODC:"ODCFacepileFeature"},Ze={ODC:"UseDownloadMicroservice"},$e={ODB:836},et={ODB:!0},tt={ODB:14162},nt={ODB:964},at={ODB:968},it={ODB:890},rt={ODB:928},ot={ODC:"DragAndDropRobotAnimation",ODB:899},st={Fallback:!0},ct={ODB:761},dt={ODB:516},lt={ODB:722},ut={ODB:591},ft={ODB:725},pt={ODB:727},mt={ODB:730},_t={ODB:731},ht={ODB:783},bt={ODB:308,ODC:"ItemAnalytics"},gt={ODB:!!(i.rs||o.listBaseTemplate>=0)||-1063},vt={ODB:734},yt={ODB:60925},St=c,Dt={ODB:-500},It={ODB:83},xt={ODB:751},Ct={ODB:752},Ot={ODB:60977},wt={ODB:706},Et={ODB:818,ODC:"EnablePushChannelAutoRefresh"},At={ODB:859},Lt={ODB:857},kt={ODB:860,ODC:"EnablePushChannel"},Mt={ODB:756},Pt={ODB:902},Tt={ODC:"AutoAlbumBannerV2Enabled"},Ut={ODB:757},Ft={ODC:"EnableGetItemsPrefetch"},Ht={ODB:804},Rt={ODB:811},Nt={ODB:812},Bt={ODB:1193},jt={ODB:813},Vt={ODB:35},zt={ODB:821},Gt={ODC:"UseNewReportAbuseDialog"},Kt={ODC:"UserVroomApiForRemoveFromSharedListAndReportAbuse"},Wt={ODC:"UseVroomApiForReportAbuse"},qt={ODC:"UseVroomApiForRequestReview"},Qt={ODC:"UseVroomUpdateCaption"},Yt={ODC:!a.e.isActivated("63D3DE85-2D59-4622-8BD4-CEEC395F89D6","10/21/2021","Enable anonymous report concern command")},Jt={ODC:"EnableEnhancedMobileUpsell"},Xt={ODB:842,ODC:"RecycleBinListFooter"},Zt={ODB:854,ODC:"EnableViewInFolder"},$t={ODC:"PhotosLayoutViewDisabled"},en={ODB:973},tn={ODB:-873},nn={ODB:712},an={ODC:"EnableSecurityMomentLightbox"},rn={ODB:884},on={ODB:777},sn={ODB:60783},cn={ODC:"ODCInlineShare"},dn={ODC:"PreferGraphV1API",ODB:!1,ECS:1081438},ln={ODC:"ODCManageAccessCommandBar"},un={ODB:778},fn={ODB:780},pn={ODB:1176},mn={ODB:887},_n={ODB:885,ODC:"EnableDownloadPushChannelNotifications"},hn={ODC:"VersionAllFiles"},bn={ODB:118},gn={ODB:202},vn={ODC:"EnableEvokeAlignments"},yn={ODC:"EvokeDev"},Sn={ODB:285},Dn={ODC:"EnableInfoPaneStickyHeader"},In={ODB:1144},xn={ODB:1162},Cn={ODB:1154},On={ODB:1065},wn={ODB:!a.e.isActivated("b8c885e0-1292-4bba-a624-d365f85bf140","05/27/2021","Show the new create shared library UI in ODB")},En={ODB:!0,ODC:"UseTilesList"},An={ODB:!1,ODC:!0},Ln={ODC:"BypassPremiumCheckForRestore"},kn={ODB:351},Mn={ODB:387},Pn={ODB:1286},Tn={ODB:1287},Un={ODB:852},Fn={ODB:903},Hn=a.e.isActivated("5b1beb70-aac8-4da3-a4e2-151c7e55cd53","Fallback to global canManageLinks logic"),Rn={ODC:!1,ODB:!Hn},Nn={ODB:!1,ODC:!0,OneDrive:!0},Bn={ODB:620},jn={ODC:"EnableAnonymousSigninDialog"},Vn={ODC:"UnauthenticatedBannerUseSigninDialog"},zn={ODC:"ProjectV_WebCreate"},Gn={ODC:!0},Kn={ODC:"EnableOrderPrintsWeb"},Wn={ODC:"SigninDialogSupportBusinessAccounts"},qn={ODC:"SamsungGalleryFilter"},Qn={ODB:!0,ODC:!1},Yn={ODB:1142},Jn={ODB:1052},Xn={ODB:1227},Zn={ODB:772},$n={ODB:1765},ea={ODB:1363},ta={ODC:"EnableManageStorageSettings"},na={ODC:"EnableVroomDocFormatSettings"},aa={ODC:"DisableDeviceBackupsPage"},ia={ODB:!0,ODC:!1},ra={ODC:"UseItemsScopeInAllPhotosEnableGrid"},oa={ODC:"UseItemsScopeInAllPhotosForwardPaging"},sa={ODC:"UseItemsScopeInExplorePhotos"},ca={ODC:"UsePhysicalPixelSizeThumbsInAllPhotosView"},da={ODC:"RequestCacheSizeThumbnails"},la={ODC:"EnableMultiplePhotoStories"},ua={ODC:"EnablePhotoStream"},fa={ODC:"EnablePhotoStreamInviteExpOne"},pa={ODC:"EnablePhotoStreamInviteExpOneOn"},ma={ODC:"EnablePhotoStreamInLeftNav"},_a={ODC:"EnableNewCarouselDesign"},ha={ODC:"EnableNewCarouselDesignExp"},ba={ODC:"EnableOnThisMonth"},ga={ODC:"EnableRecommendationApi"},va={ODC:"EnableLastWeekPreviousYears"},ya={ODC:"EnableMojFeedback"},Sa={ODC:"EnableNewPhotosExperience"},Da={ODC:"EnableNewPhotosExperienceForCOB"},Ia={ODC:"EnableMOJNotificationBanner"},xa={ODC:"EnableSeeAllButton"},Ca={ODC:"UseLegacyDataManagerToFirePLT"},Oa={ODC:!0,ODB:!0},wa={ODC:"MoveAndCopyWithClipboard",ODB:-776},Ea={ODB:!0,ODC:"AddPeopeReact"},Aa={ODB:!0},La={ODB:1552},ka={ODB:60990},Ma={ODB:61024},Pa={ODB:60268},Ta={ODB:61042},Ua={ODB:61116},Fa={ODC:"ReadOnlyItemsStore",ODB:-17},Ha={ODC:"InAppMessagingWebTargetedUpsells"},Ra={ODB:-1197},Na={ODB:1578},Ba={ODB:1610},ja={ODB:1221},Va={ODB:1223},za={ODB:1384},Ga={ODB:1262},Ka={ODB:1367},Wa={ODB:1453},qa={ODB:1257},Qa={ODB:60930},Ya={ODB:1261},Ja={ODC:"DeleteConfirmDialog"},Xa={ODC:"RestoreDayLightSavingTimeAdjustment"},Za={ODB:1999},$a={ODC:"UseImage360Viewer",ODB:!0},ei={ODB:1134},ti={ODC:"MruToMruPlusPlusSkyApi"},ni={ODB:!0},ai={ODC:!0,OneDrive:!1},ii={ODB:1415},ri={ODB:1417},oi={ODB:1352},si={ODB:!0},ci={ODB:1484},di={ODB:60299},li={ODB:1169},ui={ODB:60572},fi={ODB:1650},pi={ODB:1796},mi={ODB:!a.e.isActivated("61c45046-bce1-4f47-a4dc-477520ba1895","11/16/2021","Do not invalidate item after sharing when in search view")},_i={ODB:1054},hi={ODB:1606},bi={ODC:"LanguageSettingsRedirect"},gi={ODC:"LanguageProfileChange"},vi={ODB:1393},yi={ODC:"CreateDocumentPromptSameTab"},Si={ODC:"CreateDocumentToVroom"},Di={ODC:"CreateDocumentToVroomOdf"},Ii={ODB:!0},xi={ODB:1466},Ci={ODC:"RedirectExcelSurveysToFormsV2"},Oi={ODB:!0},wi={ODC:"DisablePremiumUserFactUpdate"},Ei={ODC:"DisableSingleFileDownloadFallback"},Ai={ODC:"UseVroomInVaultSingleFileDownload"},Li={ODC:"UsePagingTokenForSearch"},ki={ODC:"EnableServiceM365Links"},Mi={ODB:60011},Pi={ODB:1745},Ti={ODB:60960},Ui={ODB:60312},Fi={ODB:60968},Hi={ODB:60507},Ri={ODB:1667},Ni={ODB:1884},Bi={ODB:60162},ji={ODB:1060},Vi={ODB:60103},zi={ODB:60422},Gi={ODB:60519},Ki={ODB:60380},Wi={ODB:677},qi={ODB:60145},Qi={ODB:1956},Yi={ODB:1934},Ji={ODB:1047},Xi={ODB:1621},Zi={ODB:1180},$i={ODB:60120},er={ODB:60121},tr={ODB:61027},nr={ODB:1767},ar={ODB:60659},ir={ODB:1244},rr={ODB:1697},or={ODB:60334},sr={ODB:60706},cr={ODB:61003},dr={ODB:-123,OneDrive:!0},lr={ODB:872,OneDrive:!0},ur={ODB:!0,ODC:"EnableZipFilePreviewing",OneDrive:!0},fr={ODB:!0,OneDrive:!0},pr={ODB:817,ODC:!0,OneDrive:!0},mr={ODB:60099,ODC:"EnableNewOneUpCommandBar"},_r={ODB:!1,ODC:"EnableNewOneUpCommandBarODCExperiment"},hr={ODC:"EnableNewOneUpCommandBarODCExperiment_ABTrigger"},br={ODB:60005,ODC:"EnableDarkThemeForOneUpMediaViewer",OneDrive:!1},gr={ODB:!1,ODC:"EnableDarkThemeForOneUpMediaViewerODCExperiment"},vr={ODC:"EnableDarkThemeForOneUpMediaViewerODCExperiment_ABTrigger"},yr={ODC:"DisableOneUpUpdateViewCount"},Sr={ODB:1709,ODC:!1,OneDrive:!1},Dr={ODB:!1,ODC:!1,ECS:1069610},Ir={ODB:1816},xr={ODB:1115},Cr={ODB:1040,ODC:!1,OneDrive:!0},Or={ODB:!a.e.isActivated("cce0d731-4a47-460e-b5d5-c31fdf4d347a","9/11/2020","Pass through clientId to hosted OneUp WAC app"),ODC:!1,OneDrive:!0},wr={ODB:!a.e.isActivated("53c310fe-1add-42fe-9e42-26b35764ed1a","12/14/2020","Pass through docClickTime to hosted OneUp WAC app"),ODC:!1,OneDrive:!0},Er={ODB:!a.e.isActivated("bcc0651f-a0de-430b-8435-1afc9875b682","08/03/2021","Pass through uih to hosted OneUp WAC app"),ODC:!1},Ar={ODB:!a.e.isActivated("731D9A2D-7DDD-4DE8-98D1-D454F59246E7","05/30/2022","Pass through EmbeddingPageSessionInfo and EmbeddingPageOrigin to hosted OneUp WAC app"),ODC:!1},Lr={ODB:826,OneDrive:!0},kr={ODB:1639},Mr={ODB:!a.e.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},Pr={ODB:336,ODC:"AllowVideoDiagnostics"},Tr={ODB:!0,ODC:!1,OneDrive:!1,Fallback:!1},Ur={ODB:!0,OneDrive:!0},Fr={ODB:!0,ODC:!1,Fallback:!0},Hr={ODB:!0},Rr={ODB:!0},Nr={ODB:!0},Br={ODB:!0,ODC:"VideoFallback"},jr={ODB:!0,ODC:!1},Vr={ODB:!a.e.isActivated("f50a33e2-f57e-4b97-a36d-d6a3be9e5240","02/09/2021","Add forced new token while trying to get token"),ODC:!1},zr={ODB:!a.e.isActivated("97048ac2-781a-4ee8-8f5d-46995f622c82","05/24/2021","Use GraphDatasource to get and refresh driveAccessToken"),ODC:!1},Gr={ODB:!0,ODC:!1},Kr={ODB:!a.e.isActivated("d6cee8cb-7162-4dee-a43b-63adeeb1971d","01/27/2021","Sets a query param (correlationId) which can help debug client errors using service logs"),ODC:!1},Wr={ODB:!a.e.isActivated("eae1b7c5-a0b3-43b0-839c-30cfbc2e5a9d","4/12/2021","Add sending of playbackSessionId and content category as qsp"),ODC:!1},qr={ODC:!1,ODB:!a.e.isActivated("276f3e59-6a18-4296-b221-d9fbe60eca97","2/9/2021","Use a window.fetch  request to check for cors errors")},Qr={ODB:1440,ODC:!1,OneDrive:!1},Yr={ODB:1591,ODC:!1,OneDrive:!1},Jr={ODB:60202,ODC:!1,OneDrive:!1},Xr={ODB:1995},Zr={ODB:!1,ECS:79947},$r={ODB:60436},eo={ECS:89865},to={ECS:1009715},no={ECS:1003081},ao={ECS:1008378},io={ODB:!1,ODC:!1,ECS:94436},ro={ODB:60213},oo={ODB:60912,ODC:!1},so={ODB:!1,ODC:!1,ECS:83884},co={ODB:!1,ODC:!1},lo={ODB:!1,ODC:!1},uo={ODB:!1,ODC:!1},fo={ODB:!1,ODC:!1},po={ODB:643,ODC:!1},mo={ODB:644,ODC:!1},_o={ODB:1160,ODC:!1},ho={ODB:644,ODC:!1},bo={ODB:60424,ODC:!1},go={ODB:!a.e.isActivated("71913f76-47d4-4293-a492-2205b7c1e655","3/18/2021","Enable sending of heartbeat telemetry"),ODC:!1,OneDrive:!0},vo={ODB:a.e.isActivated("bdfc077e-7152-4772-874e-1936725cde1f","3/24/2021","Enable max retries check on RequestManager in Dashling."),ODC:!1,ECS:77954},yo={ODB:!a.e.isActivated("9d46a6f9-9676-41ed-a4b5-3c01c1080993","3/1/2021","Use the height specified in the adaptation set as the resolution, rather than parsing it from the resolutionId"),ODC:!1,OneDrive:!0},So={ODB:!a.e.isActivated("d4be6831-a0f7-40f7-b77b-5ad215b528c9","8/19/2020","Control if video dashling telemetry is enabled"),ODC:!1},Do={ODB:!a.e.isActivated("20f62141-0df7-4eb3-943c-ff45219c1ee1","8/19/2020","Control if video dashling decryptor v2 is disabled"),ODC:!1},Io={ODB:!a.e.isActivated("f6b9287b-5835-460b-8651-ae3b92ec34ce","9/14/2020","Control if video dashling supports parallel key call"),ODC:!1},xo={ODB:!a.e.isActivated("336583dd-00a6-40dd-beea-2f2068fb2f0c","8/19/2020","Control if video dashling cdn ref ids telemetry is enabled"),ODC:!1},Co={ODB:!a.e.isActivated("c56be611-10e0-4cde-8a46-1244a42f47b3","9/28/2020","Control if video dashling telemetry info is enabled"),ODC:!1},Oo={ODB:!a.e.isActivated("b8133a0d-36a6-4a4d-ba26-fb4563484d41","11/11/2020","Control if video refresh token is enabled"),ODC:!1},wo={ODB:!a.e.isActivated("22f8bf4b-d19c-4c1f-a5a7-cb2fd36c8d6c","10/05/2020","Control if force Meta params are enabled"),ODC:!1},Eo={ODB:!a.e.isActivated("351ee0af-7950-49cf-a8f7-2fa77e44fb97","11/05/2020","Control if smart playback is enabled"),ODC:!1},Ao={ODB:60108,ODC:!1,Fallback:!1},Lo={ODB:60109,ODC:!1,Fallback:!1},ko={ODB:60110,ODC:!1,Fallback:!1},Mo={ODB:1886,ODC:!1,Fallback:!1,OneDrive:!0},Po={ODB:!a.e.isActivated("45a43ec1-f520-41e6-9f94-4d14af7ccf6d","9/30/2020","Control if video dashling optimizations are enabled"),ODC:!1},To={ODB:!a.e.isActivated("411555f8-233c-4f56-97f4-586835b5e130","04/03/2021","Retry video metadata call with the access token provided in the playback URLs"),ODC:!1,OneDrive:!0},Uo={ODB:!a.e.isActivated("cc74fd4e-2d38-4443-a603-78c3c5024447","09/01/2020","Call MeTa to verify captions exist before showing UI toggle"),ODC:!1},Fo={ODB:1661,ODC:!1,Fallback:!1,OneDrive:!0},Ho={ODB:60003,ODC:!1,Fallback:!1,OneDrive:!0},Ro={ODB:!a.e.isActivated("c1063c7b-5a82-4f68-84ca-3920d6541988","2/11/2021","Controls teams meeting recordings fallback to ffmpeg when media foundation unsuccessful"),ODC:!1,Fallback:!1},No={ODB:!a.e.isActivated("bf4f93e0-a68d-4655-aafa-234b12eeceef","5/12/2023","Change client id for share in Stream view experience")},Bo={ODB:a.e.isActivated("0f853474-6c72-4456-ac06-ed2da32c4d44","3/9/2021","Identify OneUpPlayer to MeTA transcode service"),ODC:!0,ECS:76545},jo={ODB:!1,ODC:!a.e.isActivated("174C413E-7F06-49B2-AFBE-D1C3E6972EBA","11/24/2021","Disable SK compliance video block for ODC")},Vo={ODB:!1,ODC:!1,OneDrive:!0},zo={ODB:!0,ODC:!1},Go={ODB:60048,ODC:!1,Fallback:!1},Ko={ODB:60305,ODC:!1,ECS:82729},Wo={ODB:60313,ODC:!1,ECS:83394},qo={ODB:!a.e.isActivated("dbecc8cc-2bf6-4a33-bedf-9f71faa71fdf","1/5/2021","Controls DASH playback on Safari"),ODC:!1,Fallback:!1,OneDrive:!0},Qo={ODB:60085,ODC:!1,Fallback:!1},Yo={ODB:60255,ODC:!1,ECS:79919},Jo={ODB:!a.e.isActivated("ce53700c-4498-49ef-b738-21131fdc2551","5/30/2021","Enable pretranscode support"),ODC:!1},Xo={ODB:!a.e.isActivated("398DDB43-D6A8-4060-8F69-378A0AEF845A","03/25/2022","Display request access button when no permission (403)"),ODC:!1},Zo={ODB:60838,ODC:!1},$o={ODB:!0},es={ODB:834,ODC:"RemoveOneUpSlideNavigation",OneDrive:!0},ts={ODB:!a.e.isActivated("d047b4a4-477a-4da6-b18c-1eb7daf19cc8","11/03/2021","Add request access button to OneUp curtain"),ODC:!1},ns={ODC:"DarkBackgroundForPhotosOneUp"},as={ODC:"DarkBackgroundForPhotosOneUpExperiment"},is={ODC:"DarkBackgroundForPhotosOneUpExperiment_ABTrigger"},rs={ODC:"EnableLivePhotoVideos"},os={ODC:"EnableLivePhotoVideos_NativePlayback"},ss={ODC:"EnableLivePhotoVideosForCobUser"},cs={ODC:"EnableSamsungMotionPhotoVideos"},ds={ODB:!a.e.isActivated("0b6f3eb5-90ef-4e77-81d9-2286c06c3257","07/20/2021","Engagement Telemetry Enhancement for 1up according to ask from OnePlayer"),ODC:!1},ls={ODB:60081,ODC:!1,OneDrive:!1,Fallback:!1},us={ODB:!a.e.isActivated("ca5833b4-d7d9-406d-8e36-fc28548b52a2","10/21/2020","Update video autoplay behavior"),ODC:"1upVideoAutoplayUpdate",OneDrive:!0},fs={ODB:1181,OneDrive:!0},ps={ODB:60636},ms={ODC:"EnableEditUtilityControlIE"},_s={ODC:"EnableEditUtilityControlSafari"},hs={ODC:"EnableEditUtilityControlMobile"},bs={ODC:"EnableEditUtilityControl",ODB:60204},gs={ODC:"EnableEditControlTeachingBubble"},vs={ODC:"EnableEditControlExperimentAA"},ys={ODC:"EnableEditControlExperimentAB"},Ss={ODC:"EnableEditControlAdjustments",ODB:60478},Ds={ODC:"EnableEditControlFilters",ODB:60545},Is={ODC:"EnableEditAllImageFormats"},xs={ODC:"EnableEditControlMarkup",ODB:60139},Cs={ODC:"EnableEditControlArrowHead",ODB:60739},Os={ODC:"EnableEditPNG",ODB:60593},ws={ODC:"EnableEditHEIC",ODB:60664},Es={ODB:634,ODC:!1,OneDrive:!1,Fallback:!1},As={ODB:60124,ODC:!1,OneDrive:!1,Fallback:!1},Ls={ODB:1614,ODC:!1,OneDrive:!1,Fallback:!1},ks={ODB:1655,ODC:!1,OneDrive:!1,Fallback:!1},Ms={ECS:1071224},Ps={ODB:!a.e.isActivated("9ffb3b8b-fbfe-4c66-bd3a-34f3451d6037","02/06/2023","Killswitch to enable teaching bubble for PDF editing")},Ts={ODB:!a.e.isActivated("ecae7a95-d6a0-4940-a5dc-236ef7ab6f55","02/06/2023","Killswitch to enable teaching bubble for PDF extract and merge")},Us={ODB:!a.e.isActivated("66097d38-1f87-4a2d-983d-89a2ed26b2d8","12/06/2023","Killswitch to enable teaching bubble for PDF get eSignatures")},Fs={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},Hs={ODB:!a.e.isActivated("260364a3-3855-4555-95ad-fc012bfe8d0c","01/06/2022","Enable ER Bug fixes for Universal Annotations"),ODC:!1,OneDrive:!1,Fallback:!1},Rs={ODB:1811,ODC:!1,OneDrive:!1,Fallback:!1},Ns={ODB:1063,ODC:!1,OneDrive:!1,Fallback:!1},Bs={ODB:60347},js={ODB:60349,ODC:"PWACustomInstallPrompt"},Vs={ODB:1866},zs={ODB:1880},Gs={ODB:803,ODC:"OptimizelyEnabled"},Ks={ODB:363},Ws={ODB:464},qs={ODB:8},Qs={ODB:1970},Ys={ODB:a.e.isActivated("bd34a99e-6762-42ac-9795-c2123340281b","11/17/2021","Enable FFMPEG transcoding for all HLS sessions"),ECS:110016},Js={ODB:a.e.isActivated("ac5fc96a-ba27-41c2-8211-39a2d12bd2b0","2/17/2022","When the browser is Safari, force the video files to play using native player"),ECS:1003067},Xs={ODB:a.e.isActivated("1ba50e39-1615-4340-82c7-765408f11243","4/27/2022","When progressive playback is used, add cross origin anonymous to the video element"),ECS:1013575},Zs={ODB:60388,ECS:87743},$s={ODB:60325},ec={ODB:1691},tc={ODB:60847},nc={ODB:60846},ac={ODB:1295},ic={ODB:1959},rc={ODB:1363},oc={ODB:1264},sc={ODB:1083},cc={ODB:1152},dc={ODB:60089},lc={ODB:61023},uc={ODB:60279},fc={ODB:60322},pc={ODB:60087,ODC:!1,OneDrive:!1,Fallback:!1},mc={ODB:!a.e.isActivated("F6679A55-17E3-4F3B-BECF-7B969EB307C2","02/08/2022","Check if the teams meeting recording has an expiration date."),ODC:!1,OneDrive:!1,Fallback:!1},_c={ODB:60317},hc={ODB:60391},bc={ODB:60637},gc={ODB:1204},vc={ODB:!a.e.isActivated("0c7f0abb-bacf-45f2-814d-61bb1e84f2f5","8/1/2021","move target up to solve keybinding issues")},yc={ODB:60543},Sc={ODB:1318},Dc={ODB:1312},Ic={ODB:60958},xc={ODB:1090},Cc={ODB:1402},Oc={ODB:1418},wc={ODB:60287},Ec={ODB:!a.e.isActivated("884acaf3-037b-4c3a-b169-eddffd004e69","06/20/2023","Enables fix for items scope hierarchy to be able to use the useAction hook properly")},Ac={ODB:61079},Lc={ODB:!a.e.isActivated("67251f0f-3b6f-405f-95ca-603e3c00a0e1","06/14/2023","Enable share handler creation via useAction hook for post-roll share button")},kc={ODB:!a.e.isActivated("2a642dc2-93e1-41f8-b6e1-d7c4c9acecd2","09/08/2022","View button for opening uploaded video in SWA in new tab")},Mc={ODB:!a.e.isActivated("3cf3efe2-3050-4c01-8597-317ed1e0acc2","28/08/2022","Open button for opening moved/copied video in SWA in new tab")},Pc={ODB:!a.e.isActivated("b2895e2b-5ca4-448b-955c-38d728d7e7b2","23/12/2022","Do not show links in SWA upload popup and panel for destination directories")},Tc={ODB:!a.e.isActivated("4678edfd-5753-410d-a418-5ce8e9368075","10/03/2022","Refactoring code for open button showing after moved/copied video in SWA")},Uc={ODB:!a.e.isActivated("f2e15bcb-b2af-40ee-90fa-4d0e27ac3b99","09/13/2022","Opening Video Settings automatically after opening uploaded video")},Fc={ODB:!a.e.isActivated("461e4739-e857-4d71-88da-805c7c90b75e","10/06/2022","Having only one item in new menu dropdown if other is turned off")},Hc={ODC:!a.e.isActivated("D095D1B3-A17F-441B-8855-D465ED3CA91F","12/15/2021","")},Rc={ECS:114542},Nc={ODB:60703},Bc={ODB:60752},jc={ODB:60921},Vc={ODC:"DownloadDebugLogs",ODB:60798},zc={ODB:60800},Gc={ODB:1197},Kc={ODC:"CreateConvergenceEnabled"},Wc={ODC:"CreateConvergenceViaVroom"},qc={ODC:!a.e.isActivated("25B37479-0FDE-4A4C-B58F-3FD5F9A152BA","05/10/2023","Create ODF document with VROOM FOR COB users")},Qc={ODC:"EnableCreateODFDocument"},Yc={ODC:"EnableItemCacheCreateDocument"},Jc={ODB:!a.e.isActivated("483a92b4-201c-4b8c-b657-3fe2ce288672","4/22/2022","Show teaching bubble for TMR files consistently before user closes it."),ODC:!1,OneDrive:!1,Fallback:!1},Xc={ODB:!a.e.isActivated("a6183b15-1c4c-4fe0-b52c-b263235d6c3d","5/11/2022","Use UTC time zone for TMR"),ODC:!1,OneDrive:!1,Fallback:!1},Zc={ODB:!a.e.isActivated("744d1129-5df2-4930-b056-7bc0fb82151b","5/11/2022","Feature to check if video codec is in the list of unsupported by browser")},$c={ODB:1108,ODC:!1,OneDrive:!1,Fallback:!1},ed={ODB:!1,ODC:"EnableGraphApiGetEmbedInfo",OneDrive:!1,Fallback:!1},td={ODB:1306},nd={ODB:1159},ad={ODB:1451},id={ODB:1713},rd={ODB:60666},od={ODB:60980},sd={ODC:"HideTaggingFeatures"},cd={ODC:"EnableATOForCOBtoODC"},dd={ODC:"EnableATOForODCtoCOB"},ld={ODC:"EnableATOForCOBtoCOB"},ud={ODC:"HideShareButton"},fd={ODC:"HideEditPhoto"},pd={ODC:"HideEmbedButton"},md={ODC:"HideAlbumPivot"},_d={ODC:"ShowAlertIcon"},hd={ODC:"EnableDocumentDigestEmail"},bd={ODB:!1,ODC:!a.e.isActivated("DE2FA0D9-D704-4B85-916B-9DB19121E9A1","3/21/2023","Fix COB OneUp cannot open thumbnail correctly.")},gd={ODB:a.e.isActivated("b2ac1c0f-d8e1-4f24-9d57-41afa45a5f66","10/11/2022","Killswitch to enable prefetching video with low bitrate")},vd={ODB:!a.e.isActivated("25c1f6db-47d7-4e6b-b85e-80d4815265b1","9/29/2022","Killswitch to add error handling for getrequestparametersasync call in prefetch")},yd={ODB:!a.e.isActivated("60fdf489-9918-46ee-8151-5a98bc049a81","10/26/2022","Killswitch to add logging for error in fetch operation")},Sd={ODB:1209},Dd={ODB:1290},Id={ODB:61114},xd={ODB:1347},Cd={ODB:1199},Od={ODB:a.e.isActivated("51ee2bb9-9d53-45e8-a198-02a1d377f01d","1/23/2023","Remove tooltip from new button on command bar")},wd={ODC:"EnableAlbumForConvergence"},Ed={ODC:"EnableCreateAlbumFromFolder"},Ad={ODC:"EnableAddToAlbum"},Ld={ODC:"EnableMojForConvergence"},kd={ODB:1887},Md={ODB:60007},Pd={ODB:60323},Td={ODB:60331},Ud={ODC:"EnablePreAuthEmbedLinkForImage"},Fd={ODB:60971},Hd={ODB:90019},Rd={ODB:1162},Nd={ODB:1450},Bd={ODC:"EnableMojNavigateToNpe"},jd={ODB:61071},Vd={ODB:61086},zd={ODB:61082},Gd={ODB:61092},Kd={ODB:60774},Wd={ODC:"EnableAddPeopleWithShareDialog"},qd={ODC:"EnableSearchHistorySettingInCob"},Qd={ODC:"EnableBulkFileDownloadInCob"},Yd={ODB:61078},Jd={ODC:"EnableRotatePhotoInCob"},Xd={ODB:60974},Zd={ODB:a.e.isActivated("225bb3b7-fb85-492b-811e-acac02eddce9","7/19/2023","Remove KO view param from PlayBackHelper as it can be obtained from navigation directly"),ECS:1112103},$d={ODC:!a.e.isActivated("821989C8-65C4-4430-8FD9-6B1F23BBCBBE","07/19/2023","Fix the issue that missing customization option for Excel files in embed dialog.")},el={ODC:"EnableSetAsCoverForFolderInCob"}},,function(e,t,n){"use strict";n.d(t,"is",function(){return l}),n.d(t,"Rn",function(){return u}),n.d(t,"i",function(){return f}),n.d(t,"_",function(){return p}),n.d(t,"g",function(){return m}),n.d(t,"w",function(){return _}),n.d(t,"O",function(){return h}),n.d(t,"P",function(){return b}),n.d(t,"L",function(){return g}),n.d(t,"C",function(){return v}),n.d(t,"k",function(){return y}),n.d(t,"M",function(){return S}),n.d(t,"I",function(){return D}),n.d(t,"x",function(){return I}),n.d(t,"y",function(){return x}),n.d(t,"A",function(){return C}),n.d(t,"E",function(){return O}),n.d(t,"S",function(){return w}),n.d(t,"T",function(){return E}),n.d(t,"H",function(){return A}),n.d(t,"fi",function(){return L}),n.d(t,"J",function(){return k}),n.d(t,"Y",function(){return M}),n.d(t,"q",function(){return P}),n.d(t,"G",function(){return T}),n.d(t,"B",function(){return U}),n.d(t,"ee",function(){return F}),n.d(t,"ne",function(){return H}),n.d(t,"ie",function(){return R}),n.d(t,"oe",function(){return N}),n.d(t,"fe",function(){return B}),n.d(t,"me",function(){return j}),n.d(t,"Se",function(){return V}),n.d(t,"ye",function(){return z}),n.d(t,"Ie",function(){return G}),n.d(t,"He",function(){return K}),n.d(t,"$e",function(){return W}),n.d(t,"nt",function(){return q}),n.d(t,"ct",function(){return Q}),n.d(t,"et",function(){return Y}),n.d(t,"At",function(){return J}),n.d(t,"Ve",function(){return X}),n.d(t,"Ke",function(){return Z}),n.d(t,"dt",function(){return $}),n.d(t,"bt",function(){return ee}),n.d(t,"$",function(){return te}),n.d(t,"lt",function(){return ne}),n.d(t,"je",function(){return ae}),n.d(t,"xt",function(){return ie}),n.d(t,"vt",function(){return re}),n.d(t,"_t",function(){return oe}),n.d(t,"yt",function(){return se}),n.d(t,"Be",function(){return ce}),n.d(t,"St",function(){return de}),n.d(t,"Fe",function(){return le}),n.d(t,"It",function(){return ue}),n.d(t,"Dt",function(){return fe}),n.d(t,"de",function(){return pe}),n.d(t,"tn",function(){return me}),n.d(t,"Zi",function(){return _e}),n.d(t,"$i",function(){return he}),n.d(t,"en",function(){return be}),n.d(t,"Tt",function(){return ge}),n.d(t,"Zo",function(){return ve}),n.d(t,"fr",function(){return ye}),n.d(t,"ur",function(){return Se}),n.d(t,"lr",function(){return De}),n.d(t,"Jr",function(){return Ie}),n.d(t,"Xr",function(){return xe}),n.d(t,"Qr",function(){return Ce}),n.d(t,"ko",function(){return Oe}),n.d(t,"u",function(){return we}),n.d(t,"oa",function(){return Ee}),n.d(t,"Mt",function(){return Ae}),n.d(t,"ut",function(){return Le}),n.d(t,"Ht",function(){return ke}),n.d(t,"zt",function(){return Me}),n.d(t,"Ni",function(){return Pe}),n.d(t,"Kt",function(){return Te}),n.d(t,"Gt",function(){return Ue}),n.d(t,"n",function(){return Fe}),n.d(t,"bn",function(){return He}),n.d(t,"Sn",function(){return Re}),n.d(t,"yn",function(){return Ne}),n.d(t,"Dn",function(){return Be}),n.d(t,"In",function(){return je}),n.d(t,"xn",function(){return Ve}),n.d(t,"ke",function(){return ze}),n.d(t,"Wt",function(){return Ge}),n.d(t,"Jt",function(){return Ke}),n.d(t,"Yt",function(){return We}),n.d(t,"To",function(){return qe}),n.d(t,"ln",function(){return Qe}),n.d(t,"dn",function(){return Ye}),n.d(t,"pn",function(){return Je}),n.d(t,"hn",function(){return Xe}),n.d(t,"kn",function(){return Ze}),n.d(t,"Mn",function(){return $e}),n.d(t,"Hn",function(){return et}),n.d(t,"Nn",function(){return tt}),n.d(t,"Bn",function(){return nt}),n.d(t,"Te",function(){return at}),n.d(t,"qn",function(){return it}),n.d(t,"Qn",function(){return rt}),n.d(t,"oi",function(){return ot}),n.d(t,"Zn",function(){return st}),n.d(t,"ca",function(){return ct}),n.d(t,"sa",function(){return dt}),n.d(t,"ha",function(){return lt}),n.d(t,"Ma",function(){return ut}),n.d(t,"Fa",function(){return ft}),n.d(t,"Ta",function(){return pt}),n.d(t,"Pa",function(){return mt}),n.d(t,"ja",function(){return _t}),n.d(t,"Ba",function(){return ht}),n.d(t,"Va",function(){return bt}),n.d(t,"Ri",function(){return gt}),n.d(t,"D",function(){return vt}),n.d(t,"Ga",function(){return yt}),n.d(t,"or",function(){return St}),n.d(t,"Ua",function(){return Dt}),n.d(t,"Un",function(){return Ct}),n.d(t,"eo",function(){return Ot}),n.d(t,"si",function(){return wt}),n.d(t,"Ei",function(){return Et}),n.d(t,"bi",function(){return At}),n.d(t,"Wa",function(){return Lt}),n.d(t,"qa",function(){return kt}),n.d(t,"ni",function(){return Mt}),n.d(t,"ci",function(){return Pt}),n.d(t,"di",function(){return Tt}),n.d(t,"li",function(){return Ut}),n.d(t,"ze",function(){return Ft}),n.d(t,"yi",function(){return Ht}),n.d(t,"Bt",function(){return Rt}),n.d(t,"pi",function(){return Nt}),n.d(t,"Di",function(){return Bt}),n.d(t,"xi",function(){return jt}),n.d(t,"Si",function(){return Vt}),n.d(t,"Ii",function(){return zt}),n.d(t,"Ci",function(){return Gt}),n.d(t,"wi",function(){return Kt}),n.d(t,"Oi",function(){return Wt}),n.d(t,"_r",function(){return qt}),n.d(t,"Li",function(){return Qt}),n.d(t,"Mi",function(){return Yt}),n.d(t,"Ti",function(){return Jt}),n.d(t,"Pi",function(){return Xt}),n.d(t,"Fi",function(){return Zt}),n.d(t,"Gi",function(){return $t}),n.d(t,"Vi",function(){return en}),n.d(t,"zi",function(){return tn}),n.d(t,"Ki",function(){return nn}),n.d(t,"Wi",function(){return an}),n.d(t,"Yi",function(){return rn}),n.d(t,"Xi",function(){return on}),n.d(t,"Do",function(){return sn}),n.d(t,"Qi",function(){return cn}),n.d(t,"rr",function(){return dn}),n.d(t,"mr",function(){return ln}),n.d(t,"Ur",function(){return un}),n.d(t,"Fr",function(){return fn}),n.d(t,"Hr",function(){return pn}),n.d(t,"Wr",function(){return mn}),n.d(t,"Uo",function(){return _n}),n.d(t,"Fo",function(){return hn}),n.d(t,"to",function(){return bn}),n.d(t,"ao",function(){return gn}),n.d(t,"se",function(){return vn}),n.d(t,"io",function(){return yn}),n.d(t,"Zr",function(){return Sn}),n.d(t,"Io",function(){return Dn}),n.d(t,"oo",function(){return In}),n.d(t,"co",function(){return xn}),n.d(t,"lo",function(){return Cn}),n.d(t,"ro",function(){return On}),n.d(t,"uo",function(){return wn}),n.d(t,"po",function(){return En}),n.d(t,"mo",function(){return An}),n.d(t,"_o",function(){return Ln}),n.d(t,"ho",function(){return kn}),n.d(t,"go",function(){return Mn}),n.d(t,"bo",function(){return Pn}),n.d(t,"fo",function(){return Tn}),n.d(t,"so",function(){return Un}),n.d(t,"vo",function(){return Fn}),n.d(t,"So",function(){return Hn}),n.d(t,"yo",function(){return Rn}),n.d(t,"xo",function(){return Nn}),n.d(t,"Eo",function(){return Bn}),n.d(t,"Xo",function(){return jn}),n.d(t,"Jo",function(){return Vn}),n.d(t,"Re",function(){return zn}),n.d(t,"ae",function(){return Gn}),n.d(t,"Ge",function(){return Kn}),n.d(t,"sr",function(){return Wn}),n.d(t,"Ai",function(){return qn}),n.d(t,"Kr",function(){return Qn}),n.d(t,"tr",function(){return Yn}),n.d(t,"nr",function(){return Jn}),n.d(t,"Wn",function(){return Xn}),n.d(t,"Kn",function(){return Zn}),n.d(t,"Qo",function(){return $n}),n.d(t,"Ha",function(){return ea}),n.d(t,"tt",function(){return ta}),n.d(t,"Hi",function(){return na}),n.d(t,"Nt",function(){return aa}),n.d(t,"Go",function(){return ia}),n.d(t,"zo",function(){return ra}),n.d(t,"d",function(){return oa}),n.d(t,"Ro",function(){return sa}),n.d(t,"Wo",function(){return ca}),n.d(t,"Ko",function(){return da}),n.d(t,"pt",function(){return la}),n.d(t,"mt",function(){return ua}),n.d(t,"ft",function(){return fa}),n.d(t,"at",function(){return pa}),n.d(t,"it",function(){return ma}),n.d(t,"zn",function(){return _a}),n.d(t,"Gn",function(){return ha}),n.d(t,"rt",function(){return ba}),n.d(t,"r",function(){return ga}),n.d(t,"Bi",function(){return va}),n.d(t,"Lt",function(){return ya}),n.d(t,"ri",function(){return Sa}),n.d(t,"Na",function(){return Da}),n.d(t,"Qa",function(){return Ia}),n.d(t,"Vr",function(){return xa}),n.d(t,"jr",function(){return Ca}),n.d(t,"Br",function(){return Oa}),n.d(t,"zr",function(){return wa}),n.d(t,"m",function(){return Ea}),n.d(t,"wa",function(){return Aa}),n.d(t,"Ye",function(){return La}),n.d(t,"Ca",function(){return ka}),n.d(t,"$t",function(){return Ma}),n.d(t,"xa",function(){return Pa}),n.d(t,"Xt",function(){return Ta}),n.d(t,"On",function(){return Ua}),n.d(t,"Zt",function(){return Fa}),n.d(t,"Qt",function(){return Ha}),n.d(t,"qt",function(){return Ra}),n.d(t,"Ue",function(){return Na}),n.d(t,"Sa",function(){return Ba}),n.d(t,"va",function(){return ja}),n.d(t,"ya",function(){return Va}),n.d(t,"Da",function(){return za}),n.d(t,"c",function(){return Ga}),n.d(t,"an",function(){return Ka}),n.d(t,"ga",function(){return Wa}),n.d(t,"l",function(){return qa}),n.d(t,"qo",function(){return Qa}),n.d(t,"ea",function(){return Ya}),n.d(t,"ta",function(){return Ja}),n.d(t,"Cn",function(){return Xa}),n.d(t,"Nr",function(){return Za}),n.d(t,"Oa",function(){return $a}),n.d(t,"un",function(){return ei}),n.d(t,"Oo",function(){return ti}),n.d(t,"za",function(){return ni}),n.d(t,"ji",function(){return ai}),n.d(t,"Et",function(){return ii}),n.d(t,"Ln",function(){return ri}),n.d(t,"aa",function(){return oi}),n.d(t,"na",function(){return si}),n.d(t,"ra",function(){return ci}),n.d(t,"wn",function(){return di}),n.d(t,"b",function(){return li}),n.d(t,"ia",function(){return ui}),n.d(t,"Yr",function(){return fi}),n.d(t,"Ho",function(){return pi}),n.d(t,"gi",function(){return mi}),n.d(t,"Po",function(){return bi}),n.d(t,"ba",function(){return gi}),n.d(t,"R",function(){return vi}),n.d(t,"N",function(){return yi}),n.d(t,"gt",function(){return Si}),n.d(t,"Mr",function(){return Di}),n.d(t,"mi",function(){return Ii}),n.d(t,"U",function(){return xi}),n.d(t,"vi",function(){return Ci}),n.d(t,"Ji",function(){return Oi}),n.d(t,"Xn",function(){return wi}),n.d(t,"Ea",function(){return Ei}),n.d(t,"br",function(){return Ai}),n.d(t,"Sr",function(){return Li}),n.d(t,"La",function(){return ki}),n.d(t,"Aa",function(){return Mi}),n.d(t,"ka",function(){return Pi}),n.d(t,"Rr",function(){return Ti}),n.d(t,"on",function(){return Ui}),n.d(t,"Q",function(){return Fi}),n.d(t,"jt",function(){return Hi}),n.d(t,"he",function(){return Ri}),n.d(t,"yr",function(){return Ni}),n.d(t,"gr",function(){return Bi}),n.d(t,"vr",function(){return ji}),n.d(t,"_e",function(){return Vi}),n.d(t,"f",function(){return zi}),n.d(t,"s",function(){return Gi}),n.d(t,"Rt",function(){return Ki}),n.d(t,"ki",function(){return Wi}),n.d(t,"qi",function(){return qi}),n.d(t,"En",function(){return Qi}),n.d(t,"ir",function(){return Yi}),n.d(t,"Me",function(){return Ji}),n.d(t,"Pe",function(){return Xi}),n.d(t,"jn",function(){return Zi}),n.d(t,"gn",function(){return $i}),n.d(t,"We",function(){return er}),n.d(t,"ge",function(){return tr}),n.d(t,"ve",function(){return nr}),n.d(t,"wt",function(){return ar}),n.d(t,"Ne",function(){return ir}),n.d(t,"ua",function(){return rr}),n.d(t,"fa",function(){return or}),n.d(t,"pe",function(){return sr}),n.d(t,"Pt",function(){return cr}),n.d(t,"ar",function(){return dr}),n.d(t,"cr",function(){return lr}),n.d(t,"Ir",function(){return ur}),n.d(t,"$n",function(){return fr}),n.d(t,"pr",function(){return pr}),n.d(t,"Ka",function(){return mr}),n.d(t,"Vo",function(){return _r}),n.d(t,"vn",function(){return hr}),n.d(t,"da",function(){return br}),n.d(t,"hr",function(){return gr}),n.d(t,"Tr",function(){return vr}),n.d(t,"ue",function(){return yr}),n.d(t,"sn",function(){return Sr}),n.d(t,"cn",function(){return Dr}),n.d(t,"v",function(){return Ir}),n.d(t,"V",function(){return xr}),n.d(t,"Ya",function(){return Cr}),n.d(t,"j",function(){return Or}),n.d(t,"z",function(){return wr}),n.d(t,"W",function(){return Er}),n.d(t,"Bo",function(){return Ar}),n.d(t,"Oe",function(){return Lr}),n.d(t,"wo",function(){return kr}),n.d(t,"qe",function(){return Mr}),n.d(t,"rn",function(){return Pr}),n.d(t,"pa",function(){return Tr}),n.d(t,"xr",function(){return Ur}),n.d(t,"wr",function(){return Fr}),n.d(t,"kr",function(){return Hr}),n.d(t,"Lr",function(){return Rr}),n.d(t,"Ar",function(){return Nr}),n.d(t,"Er",function(){return Br}),n.d(t,"Or",function(){return jr}),n.d(t,"Cr",function(){return Vr}),n.d(t,"qr",function(){return zr}),n.d(t,"_n",function(){return Gr}),n.d(t,"Ae",function(){return Kr}),n.d(t,"_i",function(){return Wr}),n.d(t,"Ee",function(){return qr}),n.d(t,"Ot",function(){return Qr}),n.d(t,"Ui",function(){return Yr}),n.d(t,"F",function(){return Jr}),n.d(t,"xe",function(){return Xr}),n.d(t,"Ce",function(){return Zr}),n.d(t,"ce",function(){return $r}),n.d(t,"Xa",function(){return eo}),n.d(t,"Za",function(){return to}),n.d(t,"$a",function(){return no}),n.d(t,"ei",function(){return ao}),n.d(t,"ti",function(){return io}),n.d(t,"o",function(){return ro}),n.d(t,"Yo",function(){return oo}),n.d(t,"Ja",function(){return so}),n.d(t,"t",function(){return co}),n.d(t,"p",function(){return lo}),n.d(t,"Vn",function(){return uo}),n.d(t,"ui",function(){return fo}),n.d(t,"Gr",function(){return po}),n.d(t,"ht",function(){return mo}),n.d(t,"Dr",function(){return _o}),n.d(t,"Ao",function(){return ho}),n.d(t,"er",function(){return bo}),n.d(t,"kt",function(){return go}),n.d(t,"K",function(){return vo}),n.d(t,"jo",function(){return yo}),n.d(t,"dr",function(){return So}),n.d(t,"ii",function(){return Do}),n.d(t,"Jn",function(){return Io}),n.d(t,"Co",function(){return xo}),n.d(t,"fn",function(){return Co}),n.d(t,"re",function(){return Oo}),n.d(t,"Z",function(){return wo}),n.d(t,"X",function(){return Eo}),n.d(t,"Xe",function(){return Ao}),n.d(t,"Yn",function(){return Lo}),n.d(t,"$r",function(){return ko}),n.d(t,"le",function(){return Mo}),n.d(t,"ds",function(){return Po}),n.d(t,"Vt",function(){return To}),n.d(t,"$o",function(){return Uo}),n.d(t,"es",function(){return Ho}),n.d(t,"Ia",function(){return Ro}),n.d(t,"Pn",function(){return No}),n.d(t,"Fn",function(){return Bo}),n.d(t,"ot",function(){return jo}),n.d(t,"Qe",function(){return Vo}),n.d(t,"a",function(){return zo}),n.d(t,"Ct",function(){return Go}),n.d(t,"Pr",function(){return Ko}),n.d(t,"Ze",function(){return Wo}),n.d(t,"_a",function(){return qo}),n.d(t,"Tn",function(){return Qo}),n.d(t,"ma",function(){return Yo}),n.d(t,"la",function(){return Jo}),n.d(t,"An",function(){return Xo}),n.d(t,"Mo",function(){return Zo});var a=n(526),i=n(9),r=n(374),o=n(48);n.d(t,"e",function(){return o.e}),n.d(t,"h",function(){return o.t}),n.d(t,"te",function(){return o.a}),n.d(t,"be",function(){return o.i}),n.d(t,"De",function(){return o.r}),n.d(t,"we",function(){return o.o}),n.d(t,"Le",function(){return o.s}),n.d(t,"Je",function(){return o.c}),n.d(t,"st",function(){return o.d}),n.d(t,"Ut",function(){return o.l}),n.d(t,"Ft",function(){return o.u}),n.d(t,"nn",function(){return o.f}),n.d(t,"mn",function(){return o.p}),n.d(t,"Ra",function(){return o.m}),n.d(t,"ai",function(){return o._}),n.d(t,"hi",function(){return o.h}),n.d(t,"no",function(){return o.b}),n.d(t,"Lo",function(){return o.g}),n.d(t,"No",function(){return o.v}),n.d(t,"ts",function(){return o.y}),n.d(t,"ns",function(){return o.S}),n.d(t,"as",function(){return o.D}),n.d(t,"rs",function(){return o.I}),n.d(t,"os",function(){return o.x}),n.d(t,"ss",function(){return o.C}),n.d(t,"cs",function(){return o.O}),n.d(t,"ls",function(){return o.w}),n.d(t,"us",function(){return o.E}),n.d(t,"fs",function(){return o.A});var s=window._spModuleLink&&"ODBLightSpeedWebPack"===window._spModuleLink.manifestName,c=window._spModuleLink&&"ModernFrame"===window._spModuleLink.manifestName,d=!i.e.isActivated("66d9aa90-5307-40d7-b693-543ae8d4d9ff","06/13/2023","Use service config for SWA routing enabled value"),l=window.Flight&&"odclightspeedwebpack"===window.Flight.manifest,u=r.e,f={ODC:"AddTelemetryHeaders"},p={serviceSetting:"ExternalService_bizappsapprovalflowsenabled"},m={ODB:!i.e.isActivated("BF7BE655-7F9F-40C8-920B-C4088F784512","05/05/2022","Prefer cookie API calls using proxy in File Picker")},_={ODB:1189},h={ODB:1419},b={ODB:1534},g={ODB:60138},v={ODB:1876},y={ODB:60210},S={ODB:60065},D={ODB:60942},I={ODB:1371},x={ODB:1854},C={ODB:1855},O={ODB:60981},w={ODB:61063},E={ODB:1441},A={ODB:688},L={ODB:!o.I},k={ODB:1786},M={ODB:60119},P={ODB:60053},T={ODB:1132},U={ODB:!i.e.isActivated("95195f4e-8936-409f-bc5e-d98fad1cef73","08/18/2021","KillSwitch for consuming exposed Default click control handler in OneDriveItemsScopeApp"),ODC:!0},F={ODB:610},H={ODC:"DisableDomainLowering"},R={ODB:1654},N={ODB:1366},B={ODB:1114},j={serviceSetting:"ExternalService_bizappsremindmeflowenabled"},V={ODB:!0},z={ODC:"EnableAccountSwitching"},G={ODB:1620},K={ODB:!0},W={ODB:1135},q={ODB:1623},Q={ODC:"EnableOneUpDataManager"},Y={ODC:"EnableODCServiceWorker"},J={ODC:"EnableServiceWorkerPrefetch"},X={ODC:"EnableLastWeekPreviousYearsExp"},Z={ODC:"EnableMonthRecapGroupHeaderExp"},$={ODB:1080},ee={ODB:268,OneDrive:!0},te={ODB:336,ODC:"DebugWindowEnabled"},ne={ODB:!(!s&&!o.C)&&60154},ae={ODB:60036},ie={ODB:!i.e.isActivated("7B7FA902-74E1-41A3-B7FA-5E99A7C60744","10/25/2021","Enables the CallerId and CallerScenarioId query provided on inbound links to be logged in extra data of Page.View engagement event.")},re={ODB:60348},oe={ODB:60482},se={ODB:60805},ce={ODB:-60765},de={ODB:-607650},le={ODB:!o.x&&60709},ue={ODC:!o.x&&"UseItemsScopeInRecent",ODB:1191},fe={ODC:!o.x&&!i.e.isActivated("3EFEFBD7-0AA5-4041-AAC2-EE0308AC532D","07/27/2023","shows the Recent pivot for migrated users")},pe={ODC:!!o.x&&!i.e.isActivated("70C000B4-CC40-4BC4-99BF-77B1C9D91115","08/01/2022","Disable photos pivot in winApp")},me={ODC:"ExecuteFREAfterFCI"},_e={ODB:-1434},he={ODB:1903},be={ODB:60230},ge={ODB:60865},ve={ODB:60978},ye={ODB:1919},Se=90173,De={ODB:60961},Ie={ODB:60676},xe={ODB:!i.e.isActivated("728AC795-2069-44D4-B387-4B82D9E1D930","06/29/2022","Use layer projection for Sites in ODB")},Ce={ODB:!i.e.isActivated("C7DDA4BE-D28B-4151-A22F-0BD7727B012D","1/26/2022","Use cross-site File Browser for Sites in ODB")},Oe={Fallback:!i.e.isActivated("8EC3A32A-7C43-4A5F-9AE1-74CBF2762A13","05/22/2023","Enable ODB LightSpeed in File Browser")},we={ODB:-8765},Ee={ODB:61004},Ae={ODB:60684},Le={ODB:60832,ODC:"EnablePhoneLinkInFilePicker"},ke={ODB:60212},Me={ODB:-1504},Pe={ODC:!i.e.isActivated("480B5399-553E-44D1-890F-217A65B602DD","06/06/2023","Add scenario header in push channel , FRE and prefetch API calls")},Te={ODB:-1893},Ue={ODB:!0,ODC:!1},Fe={ODB:1445},He={ODB:-7930},Re={ODB:60929,ODC:"ForceSwitchToDogFoodForPhoneLink"},Ne={ODB:1292,ODC:"ForceSwitchToBetaForPhoneLink"},Be={ODB:1294,ODC:"ForceSwitchToProductionForPhoneLink"},je={ODB:1077,ODC:"ForceUseMockAPIForPhoneLink"},Ve={ODB:1577,ODC:"ForceUseV2HVCForPhoneLink"},ze={ODB:60025,ODC:"EnableFeedbackForPhoneLink"},Ge={ODB:-1065},Ke={ODB:270,OneDrive:!0},We={ODB:!!o.I&&60267},qe={ODB:60502},Qe={ODB:!o.x},Ye={ODB:!o.x&&1668},Je={serviceSetting:"ExternalService_bizappsflowenabled"},Xe={ODB:-990,ODC:"ForceEnableAria"},Ze={ODC:"HideExploreYourPhotosCarousel"},$e={ODC:"HideLanguagePickerForAnonymous"},et={ODB:719},tt={ODB:!!o.I&&491,ODC:!1,OneDrive:!1},nt={ODB:-101},at={ODB:!1,ODC:!0},it={ODC:!o.x&&!i.e.isActivated("5F12686F-52A2-4E49-A1D8-A2AE7969622E","10/29/2021","Use multiPart getItem api(ODC vroom) to avoid CORS if KS is not activated.")&&"LightspeedListViewDataPrefetch"},rt={ODC:!o.x&&"LightspeedQuotaPrefetch"},ot={ODB:!i.e.isActivated("DC975CAD-8F3C-4979-97E2-DA9970A68919","03/25/2022","Prefer isMySiteOwner check for ODB"),Fallback:!0},st={ODB:788,OneDrive:!0},ct={ODB:1220},dt={ODC:"LoadFloodgateOnDemand"},lt={ODB:60644},ut={ODB:!0},ft={ODB:!!s&&-1520},pt={ODB:!o.x&&60799},mt={ODB:60523},_t={ODB:s},ht={ODB:-299},bt={ODC:o.x?"EnableLightspeedInOneDriveWinApp":"WebLightspeed"},gt={ODB:1240,ODC:!0},vt={ODB:60242},yt={ODB:-298,ODC:"UseLightSpeedPltBlock"},St={ODB:1653,ODC:"ShowPerfButton"},Dt={ODB:60887},It=void 0===n.p,xt=o.I&&!s&&!o.x||!o.I&&It&&!i.e.isActivated("608E1D31-70F0-4B48-9EC3-CDCC41EA17E2","8/30/2021","Refresh the page in a SPList when closing previewer when the user is using AMD."),Ct={Fallback:!i.e.isActivated("9ACCAC8B-D74D-43A2-98AA-457EADAF074D","11/5/2021","Initialze logging with OAuth support")},Ot={ODC:!i.e.isActivated("F7A1F6FE-3272-4B0E-AD26-70E8322C5D8F","09/15/2022","Ensure components use getDriveQuotaKey method to get the key")},wt={ODC:"PrefetchItemForConvergence"},Et={ODB:1904},At={ODB:xt,ODC:!1},Lt={ODB:805},kt={ODB:809},Mt={ODB:115},Pt={ODB:1156},Tt={ODB:1064},Ut={serviceSetting:"ExternalService_bizappsflowenabled"},Ft={ODB:1821},Ht={ODB:!i.e.isActivated("72B58EAF-775A-4B01-BFF4-A083818DDF86","05/05/2022","Use on-demand implementation for DefaultClickAction")},Rt={ODB:1010},Nt={ODB:1871},Bt={ODB:-403},jt={ODB:-404},Vt={ODB:-406},zt={ODB:-407},Gt={ODB:-408},Kt={ODB:-409},Wt={ODB:-410},qt={ODB:-500},Qt={ODB:865,OneDrive:!0},Yt={serviceSetting:"ExternalService_bizappsrequestsignoffenabled"},Jt={serviceSetting:"ExternalService_listrulesenabled"},Xt={ODB:60463},Zt={serviceSetting:"ExternalService_bizappsflowenabled"},$t={ODB:60943},en={ODB:60477,ODC:"UseItemsScopeInSearch"},tn={ODB:-1315},nn={ODC:"SetDetailsLayoutAsDefault"},an={ODC:"SetDetailsLayoutAsDefaultExpV3"},rn={ODB:60393},on={ODB:1427},sn={ODB:!o.x},cn={ODB:90007},dn={ODB:!0},ln={ODB:573},un={ODB:60515},fn={ODB:1302},pn={ODB:!0},mn={ODC:"Use3SFileSuggestion"},_n={ODB:u.ODB?1651:60021},hn={ODB:o.I?1954:1955},bn={ODB:-671},gn={ODB:!0,ODC:!0},vn={ODC:!i.e.isActivated("0DEAC9E8-4230-49B1-869A-55EE7D4256FC","10/22/2021","Disable silent auth frame in ODC itemsscope for anonymous users")},yn={ODC:"UseItemsScopeInAlbums"},Sn={ODB:1143,ODC:"UseFilePicker80ForMoveCopy"},Dn={ODC:"UseItemsScopeVroomMoveCopy"},In={ODC:"UseItemsScopeInAllPhotosEnableIE"},xn={ODC:"UseItemsScopeInAllPhotosEnableMobile"},Cn={ODC:"UseItemsScopeInAllPhotosEnableSafari"},On={ODC:"UseItemsScopeInAllPhotos"},wn={ODC:"UseItemsScopeInAllTags"},En={ODC:!o.x||"EnableLightspeedInOneDriveWinApp",ODB:!o.x||1413},An={ODC:"UseItemsScopeInPlaces"},Ln={ODB:!0,ODC:!o.x&&"UseItemsScopeInShared"},kn={ODC:"UseItemsScopeInSingleAlbum"},Mn={ODC:"UseItemsScopeInSingleTag"},Pn={ODC:"UseItemsScopeInSinglePlace"},Tn={ODC:"UseItemsScopeInOnThisDay"},Un={ODC:"UseItemsScopeInAllPhotosEnableInFilePicker"},Fn={ODB:!o.x},Hn={ODB:851},Rn={ODC:l},Nn={ODC:"UseLargeDriveItemSetPageSize"},Bn={ODC:"UseNewShareDialogForWinApp"},jn={ODB:!0,ODC:"WACHostMoveToFolder"},Vn={ODB:!0,ODC:"WACHostCommonFilePicker"},zn={ODC:"EnableFreeTrialForUSQRollout"},Gn={ODC:"DisableManageStorageForUSQ"},Kn={ODC:"EnableLoginTakeoverForUSQ"},Wn={ODC:o.x},qn={ODB:60820},Qn={ODB:60850},Yn={ODC:!0,ODB:!1},Jn={ODC:!0,ODB:!1},Xn={ODB:!!o.I||60522,ODC:!0},Zn={ODB:60626,ODC:!1},$n={ODB:60801,Fallback:!1},ea={ODB:1642},ta={ODC:"EnableODCWebWorker"},na={ODB:1460},aa={ODB:1870},ia={ODC:"UseVroomInItemsScopeAllPhotosOtdExp"},ra={ODC:"UseVroomInItemsScopeAllPhotos"},oa={ODC:"AllowTestPhotoNotification"},sa={ODC:"UseSkipTokenForVroom"},ca={ODC:"UseVroomInItemsScopeSingleTag"},da={ODC:"UseVroomInItemsScopeSinglePlace"},la={ODC:"EnablePhotosCarouselOnFile"},ua={ODC:"EnablePhotosCarouselOnFileExp"},fa={ODC:"EnablePhotoStreamProvisionCheck"},pa={ODC:"EnableOdcSyncCommand"},ma={ODC:"EnableOdcSyncCommandExp"},_a={ODC:"LargestFilesImprovement"},ha={ODC:"LargestFilesImprovementExp"},ba={ODC:"EnableOdcSyncInLeftNav"},ga={ODB:1912},va={ODB:1228},ya={ODB:1881},Sa={ODB:1905},Da={ODC:"WebAppManifest"},Ia={ODB:60428},xa={ODC:"UpdateOdcUpgradeOptionApiForConvergence"},Ca={ODC:"UpdateOdcStorageInfoApiForConvergence"},Oa={ODC:"UpdateOdcPhotoApiForConvergence"},wa={ODC:"UpdateOdcVaultApiForConvergence"},Ea={ODC:"ApplyItemsScopeToRecycleBin"},Aa={ODC:"NoFreeUpSpaceSoftLockedBannerExp"},La={ODC:"EnableNoFreeUpSpaceSoftLockedBanner"},ka={ODC:"NewOverquotaExperienceExp"},Ma={ODC:"EnabledNewOverquotaExperience"},Pa={ODC:"NewHighquotaExperienceExp"},Ta={ODC:"EnabledFreeTrialBanner"},Ua={ODC:"FreeTrialBannerExp"},Fa={ODC:"EnabledNewHighquotaExperience"},Ha={ODC:"EnableWXPOverQuotaUpsellExp"},Ra={ODC:"EnableWXPOverQuotaUpsell"},Na={ODB:o.I?453:-453,ODC:"EnableFloodgate"},Ba={ODC:"NPSCampaignProd"},ja={ODC:"NPSCampaignDogfood"},Va={ODC:"NPSCampaignForceNomination"},za={ODC:"NPSSuiteSurvey"},Ga={ODC:"AllPhotosFpsCampaign"},Ka={ODB:60101,ODC:"FPSMoveCopy"},Wa={ODC:"NLQSSurvey"},qa={Fallback:!i.e.isActivated("1936978B-BA4D-4E26-A8A5-525026B67382","05/26/2023","Always use MondoPrefetch for SDK 8.0")},Qa={ODB:!0},Ya={ODB:1927,ODC:"ListThumbnailThrottling"},Ja={ODB:-1927},Xa={ODB:60335},Za={ODB:60719},$a={ODB:!i.e.isActivated("a22e84e5-8586-40bd-8095-9c90ab3fad2b","12/08/2020","Use the new tile design in the more shared libraries page")},ei={ODB:876,ODC:!1},ti={ODB:577},ni={ODC:"OdcSuiteNavSearchBox"},ai={ODC:"EnableSearchInFilePicker",ODB:683},ii={ODC:"EnableSearchInFilePickerHosts",ODB:1128},ri={ODB:1212},oi={ODB:651},si={ODB:650},ci={ODB:61029},di={ODB:60421},li={ODB:1328},ui={ODB:60882},fi={ODB:60201},pi={ODB:!i.e.isActivated("a393b488-dba6-431f-b6f9-383f65f2340b","4/10/2023","Protection for sensitivity label changes that are not blocked by doclib flight.")},mi={ODB:1917},_i=i.e.isActivated("a66557cf-0022-43dd-b951-e1b1fa3fcad4","04/07/2023","allow OneUpLightSpeed to override selection"),hi=window.location.href.toString().indexOf("detailsPane")>-1,bi={ODB:s?60491:!_i&&c&&hi,ODC:!1},gi={ODB:!i.e.isActivated("74355188-3458-42A4-9DB6-5666BA79B5EB","03/02/2022","Moves transition resources to the KnockoutResourceScope as a preparation for OnDemand Knockout")},vi={ODB:1344},yi={ODB:1774},Si={ODB:1877},Di={ODB:1931},Ii={ODB:60010},xi={ODB:60947},Ci={ODB:1396},Oi={ODB:60713},wi={ODB:60561},Ei={ODB:1669},Ai={ODB:60753},Li={ODB:60291},ki={ODB:1620},Mi={ODB:60046},Pi={ODB:60063},Ti={ODB:1805},Ui={ODB:1622},Fi={ODB:60472},Hi={ODB:1320},Ri={ODB:60029},Ni={ODB:1960},Bi={ODB:1319},ji={ODB:1489},Vi={ODB:606},zi={ODB:1731},Gi={ODB:1317},Ki={ODB:60591},Wi={ODB:60199},qi={ODB:o.I?-60005:-60032},Qi={ODB:-1249},Yi={ODB:60744},Ji={ODB:-2006,ODC:"EnableFilePickerPhotosPivot"},Xi={ODB:61046,ODC:"EnableFilePickerSharedPivot"},Zi={ODB:1741,ODC:"ItemsScopePureReactDragDrop"},$i={ODB:-2008},er={ODB:60730},tr={ODB:60126},nr={ODB:1424},ar={ODB:17206},ir={ODB:1825},rr={ODB:!1},or={ODB:!1},sr={ODB:60160},cr={ODB:60714},dr={ODB:-2021},lr={ODB:1280},ur={ODB:60390},fr={ODB:60100},pr={ODB:60738},mr={ODB:-999999},_r={ODB:1101},hr={ODB:-2567},br={ODB:!i.e.isActivated("f8821413-7078-41bf-b2f4-f23a04fb160a","05/11/2021","Log error in PrefetchListData method")},gr={ODB:!0,ODC:!1};function vr(){return i.e.isActivated("74ca0a28-3aba-41fc-a2b7-18ceea743839","10/19/2022","Customer Promise events for ASHA")}function yr(){return i.e.isActivated("1c086a60-15dd-4b07-a770-9c68f0573722","04/03/2023","Document generation customer Promise events for ASHA")}var Sr={ODB:1207},Dr={ODB:-1207},Ir={ODB:60667},xr={ODB:1326},Cr={ODB:1070},Or={ODB:60061},wr={ODB:60905},Er={ODB:60583},Ar={ODB:!1,ODC:"UseTokenCacheForOAuth",OneDrive:!1},Lr={ODC:"EnableCooldownAfterAuthFlow"},kr={ODC:"UseNewShareDialog"},Mr={ODC:"EnableMsaOauthErrorRedirect"},Pr={ODC:"FamilySharing"},Tr={ODB:60868},Ur={ODB:!i.e.isActivated("4149C961-3AC9-4275-B8FD-F9FD97843F5A","01/06/2023","Enable cookie refresh in Teams File Browser")},Fr={ODB:1435},Hr={ODB:-5432},Rr={ODB:60965},Nr={ODB:1987},Br={ODB:60297},jr={ODB:1501},Vr={ODB:60241},zr={Fallback:!i.e.isActivated("FF1B4420-96EA-4BE2-9DD2-250D0CAFB79E","04/10/2023","Use base OneDrive nav in File Browser")},Gr={Fallback:!i.e.isActivated("CC7D2937-5E6E-4604-AAC5-E5A8DD34BFFB","11/08/2022","Flush telemetry before notifying Picker host")},Kr={Fallback:!i.e.isActivated("2A89B57A-0069-4F50-AAD5-3B931C8EF512","03/08/2023","Enable open on drag-hover")},Wr={ODB:60944},qr={Fallback:!i.e.isActivated("00783027-B2E9-4B88-82FB-C2921BF253B2","03/18/2023","Enable Drag/Drop copy")},Qr={ODB:1279},Yr={ODB:61030},Jr={ODB:60118},Xr={ODB:60047},Zr={ODB:61051},$r={ODB:!i.e.isActivated("63B21C89-2740-44A9-980B-DDA8E2689DAA","07/21/2021","Do not invalidate source location when performing a copy"),ODC:!i.e.isActivated("63B21C89-2740-44A9-980B-DDA8E2689DAA","07/21/2021","Do not invalidate source location when performing a copy")},eo={ODB:60243,ODC:!0},to={ODB:60880,ODC:!0},no={ODB:1146,ODC:!0},ao={ODB:1759,ODC:!0},io={ODB:60221,ODC:!0},ro={ODB:60908},oo={ODB:61031},so={ODB:61098},co={ODB:60889},lo={ODB:1799},uo={ODB:1793},fo={ODB:1800},po={ODB:60928},mo={ODB:405},_o={ODB:149},ho={ODB:1170},bo={ODB:563},go={ODB:1066},vo={ODB:1517},yo={serviceSetting:"ExternalService_isodbsubstratesearchenabled"},So={ODB:556,Fallback:!0},Do={ODB:60227},Io={ODB:1789},xo={ODB:-61035},Co={ODC:"FixRumOneScenarioIdForOneUp"},Oo={ODC:"DisableScrollInLightspeedPhotoViews"},wo={ODC:!i.e.isActivated("60FAB98B-2A5D-4153-B69A-46A9C7C4B6D7","11/17/2021","Use SelectionHelper to get the current item")},Eo={ODC:!i.e.isActivated("CCA9C934-1E36-4308-B93D-0025EAAECC37","11/17/2021","Use SelectionHelper to get the current item in AddToAlbumExecutor")},Ao={ODC:!i.e.isActivated("EB5778E9-2AB1-4A93-AED8-64615D06F8D6","03/01/2022","Show notification banner in Lightspeed")},Lo={ODC:!i.e.isActivated("71881921-E770-4A04-A8CD-CA451918151D","12/14/2022","Make upsell related API calls in prefetch")},ko=90084,Mo={ODB:60674},Po=function(e){return i.e.isActivated("ff60da5f-a9ea-432e-9d7b-d58b8f7519ba","2/19/2021","ServiceConfigSettingKillSwitch")?1===Number(Uo(e)):1===Number(Uo(e))||"true"===Uo(e)},To={ODB:!i.e.isActivated("74216f8a-f424-4b58-9d69-5fcbd587c0d2","05/30/2023","Enable telemetry for enhanced image tagging library toggle actions")},Uo=function(e){if(o.A&&o.A.farmSettings)return o.A.farmSettings[e]},Fo=function(e){return e.serviceSetting?Po(e.serviceSetting):a.n.isFeatureEnabled(e)},Ho=o.x?function(e){return!!Object(o.E)()&&Fo(e===Bn?e={ODC:"UseNewShareDialogForWinApp"}:e)}:Fo,Ro={ODB:60340},No={ODB:60269},Bo={ODB:60613},jo={ODB:60902},Vo={ODB:60658,serviceSetting:d?"ExternalService_swasharelinkroutingenabled":void 0},zo={ODB:1299},Go={ODB:1282},Ko={ODB:1399},Wo={ODB:1757},qo={ODB:60964},Qo={ODB:1801},Yo={ODB:60997},Jo={ODB:61012},Xo={ODB:1652},Zo={ODC:!i.e.isActivated("3B74ED7B-F809-4BB0-9679-6542982D256C","06/23/2023","Switch to use of ODCInit for 1DS")}},function(e,t,n){"use strict";var a=n(215);n.d(t,"e",function(){return a.e})},function(e,t,n){"use strict";n.d(t,"A",function(){return s}),n.d(t,"u",function(){return c}),n.d(t,"b",function(){return d}),n.d(t,"j",function(){return l}),n.d(t,"B",function(){return u}),n.d(t,"p",function(){return f}),n.d(t,"g",function(){return p}),n.d(t,"w",function(){return m}),n.d(t,"L",function(){return _}),n.d(t,"k",function(){return h}),n.d(t,"U",function(){return b}),n.d(t,"H",function(){return g}),n.d(t,"r",function(){return v}),n.d(t,"i",function(){return y}),n.d(t,"y",function(){return S}),n.d(t,"N",function(){return D}),n.d(t,"T",function(){return I}),n.d(t,"e",function(){return x}),n.d(t,"l",function(){return C}),n.d(t,"E",function(){return O}),n.d(t,"o",function(){return w}),n.d(t,"v",function(){return r}),n.d(t,"D",function(){return E}),n.d(t,"d",function(){return A}),n.d(t,"M",function(){return L}),n.d(t,"x",function(){return k}),n.d(t,"P",function(){return M}),n.d(t,"n",function(){return P}),n.d(t,"_",function(){return T}),n.d(t,"I",function(){return U}),n.d(t,"S",function(){return F}),n.d(t,"s",function(){return H}),n.d(t,"c",function(){return R}),n.d(t,"a",function(){return N}),n.d(t,"m",function(){return B}),n.d(t,"f",function(){return j}),n.d(t,"t",function(){return V}),n.d(t,"O",function(){return z}),n.d(t,"h",function(){return G}),n.d(t,"V",function(){return K}),n.d(t,"z",function(){return W}),n.d(t,"R",function(){return o.e}),n.d(t,"F",function(){return q}),n.d(t,"C",function(){return Q});var a=n(3),i=(n(296),new a.t("itemComment"),n(254)),r=new a.t("list"),o=(new a.t("oAuthTokenDataSource"),new a.t("siteScripts"),n(477),n(357)),s=(new a.t("recentList"),new a.t("folder"),new a.t("appsItem"),new a.t("externallySharedItem"),new a.t("popularItem"),new a.t("subsiteItem"),new a.t("mostViewsItem"),new a.t("mostViewersItem"),new a.t("settings")),c=new a.t("getItem"),d=new a.t("items"),l=(new a.t("versionControl"),new a.t("versionHistory")),u=new a.t("vault"),f=i.e,p=(new a.t("peopleCardFactory"),new a.t("peopleCard"),new a.t("language"),new a.t("languagePicker")),m=(new a.t("leftNav"),new a.t("search")),_=new a.t("sharing"),h=(new a.t("sharingLightSpeed"),new a.t("sharingData")),b=(new a.t("groups"),new a.t("suiteNav")),g=(new a.t("iosMobileAppPath"),new a.t("url")),v=(new a.t("universalAnnotation"),new a.t("download")),y=new a.t("docFormat"),S=(new a.t("footer"),new a.t("manifests")),D=(new a.t("itemActivityFeed"),new a.t("itemActivityFeedHelper"),new a.t("itemActivityFeedSharingHelper"),new a.t("userInfo")),I=(new a.t("storageInfo"),new a.t("storageOptions")),x=new a.t("album"),C=(new a.t("tag"),new a.t("shareByLink"),new a.t("folderItemCount")),O=(new a.t("photo"),new a.t("subscriptions"),new a.t("analytics"),new a.t("sendFeedback")),w=new a.t("embed"),E=(new a.t("application"),new a.t("policyTip")),A=(new a.t("policyTipLightSpeed"),new a.t("customAction"),new a.t("taxonomy"),new a.t("web"),new a.t("floodgate")),L=new a.t("shortcutsDS"),k=(new a.t("encoding"),new a.t("rating")),M=(new a.t("publish"),new a.t("videoItem"),new a.t("sites")),P=new a.t("copy"),T=(new a.t("upsell"),new a.t("notifications"),new a.t("command")),U=(new a.t("processFilters"),new a.t("quota"),new a.t("itemColumn"),new a.t("bundle"),new a.t("itemPicker"),new a.t("site"),new a.t("pushChannel")),F=(new a.t("itemAutoRefresh"),new a.t("loginApp"),new a.t("mruRecent")),H=(new a.t("pdf"),new a.t("zip"),new a.t("url2"),new a.t("attachments"),new a.t("spotlight"),new a.t("error"),new a.t("promotedPhotos"),new a.t("fileHandler")),R=new a.t("fileHandlerFromCache"),N=(new a.t("recycleBin"),new a.t("deleteRestore")),B=new a.t("instrumentation"),j=(new a.t("shadowCall"),new a.t("graph")),V=(new a.t("formula"),new a.t("appUrl"),new a.t("graphUrl"),new a.t("batchUploaderType")),z=(new a.t("vroomItemIdentityProcessor"),new a.t("preAuth"),new a.t("peopleService"),new a.t("schema")),G=(new a.t("restore"),new a.t("restore"),new a.t("restoreActivities"),new a.t("inAppMessaging"),new a.t("notificationSettings"),new a.t("itemInvalidator")),K=(new a.t("itemUpdator"),new a.t("wopiFrame"),new a.t("wrs"),new a.t("excel"),new a.t("winAppCommunicator")),W=new a.t("wip"),q=(new a.t("worker"),new a.t("checkUserAccessDataSource"),new a.t("userExpiration"),new a.t("itemMuteNotificationDataSource"),new a.t("ticketRedeemer")),Q=(new a.t("recommendList"),new a.t("reportAbuse"));new a.t("requestReview"),new a.t("removeFromShareWithMeList")},,,function(e,t,n){"use strict";var a=n(14);t.e=a.e},function(e,t,n){"use strict";var a=n(0),i=n(324),r=n(166),o=n(7),s=n(6),c=n(31),d=n(49),l=n(16),u=n(5),f=n(19),p=n(50),m=n(158),_=n(77),h=n(14),b=n(390),g=n(470),v=n(228),y=h.t.isActivated("2f42fb7d-6b1f-4e1e-b447-33d94f689c0d","3/15/2023","Killswitch for logging asha related props in the customerpromise."),S=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="BaseAction";var i=a,r=i.resources,o=i.observables,c=n.urlDataSource,d=void 0===c?r.consume(s.H.optional):c,l=n.instrumentationProvider,u=void 0===l?r.consume(p.a.optional):l;a._BaseAction_urlDataSource=d,a._BaseAction_instrumentationProvider=u,a.isQosLogged=!0,a.logStartEnd=!1,a.enableCustomerPromiseLogging=!1,a._executingInstanceCount=o.create(0);var f={deferEvaluation:!0};return a.isAvailable=o.pureCompute(a._computeIsAvailable,f),a.isToggled=o.pureCompute(a._computeIsToggled,f),a.isExecuting=o.pureCompute(a._computeIsExecuting,f),a}return Object(a.__extends)(t,e),t.prototype.execute=function(e){var t,n,a,i=this,r=this.isQosLogged?this.onCreateQosEvent(e):void 0,o=r?this.getEngagement():void 0;try{if(r&&(!y&&this.customerPromiseStartSchema&&(n=new b.e(this.customerPromiseStartSchema)),this._logEngagementEvent(r.data.extraData,o),this.trackUserAction(this.name)),!(t=this.instrumentOnExecutionWithCustomerPromise(this.onExecute(e,r))))throw new Error("Action did not return a promise")}catch(e){d.e.log(e),a=e}return t?(this._executingInstanceCount(this._executingInstanceCount.peek()+1),t.then(function(e){i._executingInstanceCount(i._executingInstanceCount.peek()-1),r&&(r.end(e),n&&n.end({resultType:f.t.Success}))},function(t){i._executingInstanceCount(i._executingInstanceCount.peek()-1),t&&!c.n.isCanceled(t)&&(d.e.log(t),i._logCustomerPromiseEndWithError(n,t)),r&&(r.end(i.onCreateErrorEventArg(e,t,!1)),i._logCustomerPromiseEndWithError(n,t))})):(r&&(r.end(this.onCreateErrorEventArg(e,a,!0)),this._logCustomerPromiseEndWithError(n,a)),t=c.n.reject(a)),t},t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.e({name:this.name,pageType:t&&l.e[t.getPageType()]||"",queryType:t&&u.e[t.getQueryType()]||"",logStartEnd:this.logStartEnd})},t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&c.n.isCanceled(t)?{resultType:f.t.ExpectedFailure,resultCode:"Canceled"}:t instanceof _.e?{resultType:t.isExpected?f.t.ExpectedFailure:f.t.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:f.t.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?"".concat(t.message||""):void 0}},t.prototype.onExecute=function(e,t){var n={resultType:f.t.Failure};return c.n.resolve(n)},t.prototype.instrumentOnExecutionWithCustomerPromise=function(e){var t=e;if(this.enableCustomerPromiseLogging){var n=this._BaseAction_urlDataSource,i=new b.e({scenario:this.name,extraData:{pageType:n&&l.e[n.getPageType()]||"",queryType:n&&u.e[n.getQueryType()]||""}});t=e.then(function(e){var t=e.resultCode,n=e.resultType,r=e.error,o=e.extraData;return i.end({resultType:n,errorCode:t,extraData:Object(a.__assign)(Object(a.__assign)({},o),{error:r})}),e}).catch(function(e){var t;if(c.n.isCanceled(e))t={resultType:f.t.ExpectedFailure,errorCode:"Canceled"};else{var n=Object(v.e)(e),r=n.resultType,o=n.resultCode,s=n.error,d=n.extraData;t={resultType:r,errorCode:o,extraData:Object(a.__assign)(Object(a.__assign)({},d),{error:s})}}throw i.end(t),e})}return t},t.prototype.onIsAvailable=function(){return!0},t.prototype.onIsToggled=function(){return!1},t.prototype.getEngagement=function(){return this.resources.consume(m.e)},t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}},t.prototype._logCustomerPromiseEndWithError=function(e,t){e&&e.end(Object(g.e)(t))},t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()},t.prototype._computeIsToggled=function(){return!!this.onIsToggled()},t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0},t.prototype._logEngagementEvent=function(e,t){if(void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0),t){var n=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:r.e[r.e.Click],currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA",extraData:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},e||{}),n&&n.getEngagementData()||{}),{isAction:!0})})}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},o.n.dependencies),{urlDataSource:s.H,instrumentationProvider:p.a.optional}),t}(o.n);t.e=S},,function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"r",function(){return r}),n.d(t,"l",function(){return o}),n.d(t,"D",function(){return s}),n.d(t,"b",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"v",function(){return u}),n.d(t,"u",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"g",function(){return m}),n.d(t,"y",function(){return _}),n.d(t,"s",function(){return h}),n.d(t,"c",function(){return b}),n.d(t,"S",function(){return g}),n.d(t,"o",function(){return v}),n.d(t,"p",function(){return y}),n.d(t,"m",function(){return S}),n.d(t,"f",function(){return D}),n.d(t,"h",function(){return I}),n.d(t,"n",function(){return x}),n.d(t,"d",function(){return C}),n.d(t,"_",function(){return O});var a=n(3),i=new a.t("currentItem"),r=new a.t("currentItemSet"),o=new a.t("groupThrottle"),s=(new a.t("focusItem"),new a.t("focusItemSet"),new a.t("dataManagerMapper"),new a.t("viewParams")),c=(new a.t("originalViewParams"),new a.t("itemsSelection")),d=(new a.t("selectionIndexResolver"),new a.t("autoFillParams")),l=new a.t("actionMap"),u=new a.t("slideshowState"),f=new a.t("isDebugWindowVisible"),p=new a.t("canUserSelect"),m=new a.t("promiseTracker"),_=(new a.t("currentPage"),new a.t("currentSelectionModelGroup"),new a.t("useMobileList")),h=new a.t("disableDotDotDotHeroCommand"),b=new a.t("disableShareHeroCommand"),g=(new a.t("uploadActionHandler"),new a.t("vaultTeachingBubble")),v=new a.t("currentView"),y=(new a.t("currentLayout"),new a.t("backToClassicUrl"),new a.t("isItemSetRendered")),S=new a.t("isPremiumUpsellVisible"),D=new a.t("isFamiliesOrGroupsFreVisible"),I=new a.t("isVaultFreVisible"),x=(new a.t("hasUpsellBeenShownAlready"),new a.t("canModifySchema")),C=new a.t("displayImageTileNames"),O=new a.t("isSharingSectionExpanded");new a.t("hasSeenPositioningThisSession"),new a.t("mobileUpsellDismissedThisSession"),new a.t("mobileOfficeAppUpsellDismissedThisSession"),new a.t("didUserEnterPasswordForFile")},,,function(e,t,n){"use strict";n.d(t,"t",function(){return f}),n.d(t,"H",function(){return m.D}),n.d(t,"e",function(){return A}),n.d(t,"_",function(){return L}),n.d(t,"h",function(){return k}),n.d(t,"o",function(){return M}),n.d(t,"S",function(){return P}),n.d(t,"C",function(){return T}),n.d(t,"I",function(){return U}),n.d(t,"E",function(){return F}),n.d(t,"w",function(){return H}),n.d(t,"a",function(){return R}),n.d(t,"k",function(){return N}),n.d(t,"n",function(){return B}),n.d(t,"M",function(){return j}),n.d(t,"L",function(){return V}),n.d(t,"P",function(){return z}),n.d(t,"l",function(){return G}),n.d(t,"r",function(){return K}),n.d(t,"s",function(){return W}),n.d(t,"p",function(){return q}),n.d(t,"c",function(){return Q}),n.d(t,"x",function(){return Y}),n.d(t,"U",function(){return J}),n.d(t,"v",function(){return X}),n.d(t,"u",function(){return Z}),n.d(t,"b",function(){return $}),n.d(t,"y",function(){return ee}),n.d(t,"d",function(){return te}),n.d(t,"i",function(){return ne}),n.d(t,"T",function(){return ae}),n.d(t,"m",function(){return ie}),n.d(t,"g",function(){return re}),n.d(t,"A",function(){return oe}),n.d(t,"O",function(){return se}),n.d(t,"f",function(){return ce}),n.d(t,"D",function(){return le}),n.d(t,"F",function(){return ue});var a,i=n(0),r=(n(192),n(20)),o=n(46),s=n(111),c=n(5),d=n(76),l=n(16),u=n(97);!function(e){e[e.Feed=0]="Feed",e[e.Story=1]="Story"}(a||(a={}));var f,p=a,m=n(33),_=n(2),h=n(27),b=n(142),g=n(185),v=n(56),y=n(154),S=n(72),D=n(120),I=n(14),x=n(359),C=(n(552),n(95));!function(e){e[e.all=31]="all",e[e.folders=2]="folders",e[e.photos=8]="photos",e[e.documents=16]="documents",e[e.music=32]="music"}(f||(f={}));var O={ch:"https://www.microsoft.com/de-ch/microsoft-schweiz/unternehmen/impressum.aspx",at:"https://www.microsoft.com/de-at/unternehmen/rechtliches/impressum-corp.aspx",de:"https://www.microsoft.com/germany/siteservices/impressum/default.mspx"},w=I.e.isActivated("B658585F-0A1A-4AAD-A6C8-5C88474A1FA7","11/08/2021","Restrict OneUp page type assignment to the default scenario in the switch statement"),E=!I.e.isActivated("04490DD5-293D-4466-9D41-2C7345A66BC3","02/17/2022","Default doesCidMatchViewerId to false in case of unauth shared scenarios with no CID in URL"),A=I.e.isActivated("E29AAB51-52AB-4E89-8A66-5BCC6CA3B5F4","02/06/2023","Preserve view params start with wd and pass it to wac");function L(e){var t;void 0===e&&(e={});var n=((t={}).id=e.id||"root",t.cid=e.cid||m.D,t.driveId=e.driveId||"",t.groupId=e.groupId||"",t.qt="".concat(e.qt||"").toLowerCase(),t.did=e.did||"",t.q=e.q||"",t.sft=e.sft||"",t.beginDate=e.beginDate||"",t.endDate=e.endDate||"",t.ft=e.ft||"",t.ext=e.ext||"",t.df=e.df||"",t.sp=e.sp||"",t.ocid=e.ocid||"",t["WT.mc_id"]=e["WT.mc_id"]||"",t.locationFilter=e.locationFilter||"",t.tagFilter=e.tagFilter||"",t.onThisDay=e.onThisDay||"",t.onThisMonth=e.onThisMonth||"",t.lastWeekPreviousYears=e.lastWeekPreviousYears||"",t.scope=e.scope||"",t.useUtilityFiltering=void 0===e.useUtilityFiltering?"":e.useUtilityFiltering,t.startDate=e.startDate||"",t.internalPath=e.internalPath||"",t.psId=e.psId||"",t.u=e.u||"",t.searchsessionid=e.searchsessionid||"",t.mojDate=e.mojDate||"",t.moj=e.moj||"",t.acType=e.acType||"",t.psId=e.psId,t.psPostId=e.psPostId,t.psRIds=e.psRIds||"",t.pssc=e.pssc||"",t);return r.n(n,void 0,!0)}function k(e){return r.e(e)}function M(e){var t=Object(i.__assign)({},e);return(t.parId||t.parQt||t.parCid)&&(delete t.id,delete t.qt,delete t.internalPath,t.parId&&(t.id=t.parId,delete t.parId),t.parQt&&(t.qt=t.parQt,delete t.parQt),t.parCid&&(t.cid=t.parCid,delete t.parCid)),delete t.u,L(t)}function P(e,t){var n;switch(e.v){case"1":case"FolderPickerView":case"2":case"FilePickerView":case"pickerconsent":n=l.e.FilePicker;break;case"3":n=l.e.Files;break;case"photos":n=l.e.Photos;break;case"photoStream":n=l.e.PhotoStream;break;case"managestorage":n=l.e.StorageInfo;break;case"photopreferences":n=l.e.PhotoPreferences;break;case"tagpreferences":n=l.e.TagPreferences;break;case"error":n=l.e.Error;break;case"RansomwareDetection":n=l.e.RansomwareDetection;break;case"syncplaceholders":n=l.e.SyncPlaceholders;break;case"upgrade":n=l.e.StorageOptions;break;case"restore":n=l.e.Restore;break;case"TextFileEditor":n=l.e.TextFileEditor;break;case"syncpremiumupsell":n=l.e.SyncOnboarding;break;case"validatepermission":n=l.e.ValidatePermission;break;case"requestaccess":n=l.e.RequestAccess;break;case"unlock":n=l.e.Unlock;break;case"ManageVault":n=l.e.ManageVault;break;case"traceme":n=l.e.TraceMe;break;case"convergence":n=l.e.Convergence;break;case"documentoptions":n=l.e.DocumentOptions;break;case"devicebackups":n=l.e.DeviceBackups;break;case"search":n=l.e.Search;break;case"NotificationOptions":n=l.e.NotificationOptions;break;default:if(Object(m.c)())n=l.e.AccountChooser;else{if(!w&&G(e)&&t)return l.e.OneUp;n=l.e.Files}}return w&&G(e)&&t?l.e.OneUp:n}function T(e){var t;switch(k(M(e)).qt){case"mru":t=c.e.Recent;break;case"recyclebin":t=c.e.RecycleBin;break;case"sharedby":t=c.e.SharedWithMe;break;case"sharedbyme":t=c.e.SharedByMe;break;case"search":t=c.e.Search;break;case"allmyphotos":t=c.e.AllMyPhotos;break;case"photostream":t=c.e.PhotoStream;break;case"selection":t=c.e.Selection;break;default:t=Object(m.u)(e)||Object(m.f)(e)||!I.e.isActivated("4D0BEE0C-FCE7-4D8F-B6C7-3BC94830A252")&&(Object(m.d)(e)||Object(m.v)(e)||Object(m.y)(e)||Object(m.S)(e))?c.e.AllMyPhotos:Object(m.c)()?"false"===e.load_login?c.e.AccountChooserMobileSDK:c.e.AccountChooserPicker:c.e.Files}return t}function U(e){return"photos"===e.v&&Object(d.e)(T(e))?u.e.AllMyPhotos:Object(m.f)(e)?u.e.allTags:Object(m.S)(e)?u.e.singleTag:Object(m.u)(e)?u.e.allPlaces:Object(m.y)(e)?u.e.singlePlace:Object(m._)(e)?u.e.onThisDay:Object(m.h)(e)?u.e.onThisMonth:Object(m.m)(e)?u.e.lastWeekPreviousYears:Object(m.l)(e)?u.e.AllMyPhotos:Object(m.d)(e)?u.e.Albums:Object(m.v)(e)?u.e.singleAlbum:"photos"===e.v?u.e.AllMyPhotos:null}function F(e,t){return t===l.e.Photos?"".concat(u.e[U(e)]):t===l.e.PhotoStream?"".concat(p[function(e){return e.psId?p.Story:p.Feed}(e)]):""}function H(e){var t,n;void 0===e&&(e=c.e.Files);var a=((t={})[c.e.Files]="",t[c.e.Recent]="mru",t[c.e.SharedWithMe]="sharedby",t[c.e.SharedByMe]="sharedbyme",t[c.e.RecycleBin]="recyclebin",t[c.e.AllMyPhotos]="allmyphotos",t[c.e.PhotoStream]="photostream",t[c.e.Selection]="selection",t);return L(((n={}).qt=a[e],n))}function R(e){return e.authkey}function N(e){return!(e.mid||e.mcid||"sharedby"!==e.qt&&B(e)||V(e))}function B(e){var t=e.cid;return!(E&&!t&&m.p)&&j(t)}function j(e){var t=m.D;return!e||Object(x.e)(e,t)}function V(e){return Object(m.l)(e)||Object(m.d)(e)||Object(m.v)(e)||Object(m.f)(e)||Object(m.u)(e)||Object(m._)(e)||Object(m.h)(e)||Object(m.m)(e)}function z(e){return!(!e.mid||!e.mcid)}function G(e){var t=null;return(e.parId||e.parQt||e.parCid)&&((t={}).id=e.id,t.qt=e.qt,t.cid=e.cid,t.internalPath=e.internalPath,Object(_.isFeatureEnabled)(_.UpdateOdcPhotoApiForConvergence)&&(t.driveId=e.driveId),delete t.u),t&&L(t)||null}function K(e){var t=e.action||"";return h.e[t.toLowerCase()]||h.t.none}function W(){return window.location.protocol+"//"+window.location.host}function q(e){var t=e.itemKey,n=e.itemInfo,a=e.page,r=e.action,o=e.preserveAction,s=void 0!==o&&o,u=e.viewParams,p=n||{},_=p.itemIsPlaceholder,g=p.itemVirtualItemType,y=p.itemExtension,S=p.itemType,D=k(t),I=Object(i.__assign)({},D),x=Y(u);void 0!==a&&(x.v=function(e,t){var n,a=t.v;switch(e){case l.e.FilePicker:n=de(a)?a:"FilePickerView";break;case l.e.TextFileEditor:n="TextFileEditor";break;case l.e.Photos:n="photos";break;case l.e.RansomwareDetection:n="RansomwareDetection";default:case l.e.Files:}return n}(a,u));var C=!1,O=!!y&&Object(b.n)(y,S);if(_)switch(I.id){case"tags":case"places":case"albums":x.v="photos",C=!0}else switch("TextFileEditor"===x.v&&(O||(x.v="")),g){case v.e.Album:case v.e.AlbumRoot:case v.e.Tag:case v.e.TagsRoot:x.v="photos",C=!0}"allmyphotos"===D.qt&&(I.v="photos",C=!0,"true"!==D.onThisDay&&"true"!==D.onThisMonth&&"true"!==D.lastWeekPreviousYears||(u&&u.startDate&&(I.startDate=u.startDate),u&&u.cid&&(I.cid=u.cid))),"photostream"===D.qt&&(I.v="photoStream",I.psShareId=u.psShareId);var w=T(D);O||!n||C||w===c.e.Search||w===c.e.AllMyPhotos||w===c.e.PhotoStream||(I.v=""),!O&&Object(d.e)(w)&&("photos"!==x.v&&"photoStream"!==x.v||Object(m.n)(D)!==f.photos.toString())&&(I.v=""),de(x.v)&&(I.v=x.v),delete x.scope,delete I.u;var E=K(u);return r?I.action=r&&h.t[r]&&h.t[r].toLowerCase()||"":s&&E&&(E===h.t.showProperties&&I.o||(I.action=h.t[E].toLowerCase())),Object(i.__assign)(x,I),x}function Q(e,t){var n=[];switch(n.push(W()),e){case 0:n.push("/");break;case 1:n.push(s.i);break;default:n.push(te())}return n.push("?"),n.push(t),n.join("")}function Y(e){var t,n=((t={}).iam=e.iam,t.ticket=e.ticket,t.authkey=e.authkey,t.redeem=e.redeem,t.v=e.v,t.invref=e.invref,t.invsrc=e.invsrc,t.client_id=e.client_id,t.scope=e.scope,t.domain=e.domain,t.referrer=e.referrer,t.crid=e.crid,t.auth=e.auth,t.picker=e.picker,t.filePicker=e.filePicker,t.fileBrowser=e.fileBrowser,t.app=e.app,t.scenario=e.scenario,t.expectsBusiness=e.expectsBusiness,t.sc=e.sc,t.simulateunauth=e.simulateunauth,t);for(var a in e)0===a.indexOf("EXPExperimentTest_e")&&(n[a]=e[a]);var i=e["WT.mc_id"],r=e.ocid;if(i&&(n["WT.mc_id"]=i,n.ocid=r||i),!A)for(var o in e)o.startsWith("wd")&&(n[o]=e[o]);return n}function J(e,t){return void 0===t&&(t=!1),t||o.t.si?ne(ae(e)):e}function X(e,t){var n,a=((n={}).ocid=t||e.ocid||e["WT.mc_id"],n.v="managestorage",n);return J("#"+r.n(a,null,!0))}function Z(){var e=C.e.getMarket(),t=e&&e.split("-")[1];return t&&O[t.toLowerCase()]}function $(){return"https://go.microsoft.com/fwlink/?linkid=2100224"}function ee(e){var t,n=e.wtcParam,a=e.viewParams,i=e.hideLeftNav,o=((t={}).ocid=a.ocid||a["WT.mc_id"]||n,t.v="upgrade",t.hideLeftNav=i,t),s="/"===window.location.pathname;return J("".concat(s?"#":"/?").concat(r.n(o,null,!0)))}function te(){return window.location.pathname}function ne(e){var t=o.t.signInUrl;return window.location.href.indexOf("iam=")>-1?(t+="&redirect_uri={0}",e=W()+"/business"):t+="&ru={0}&wreply={0}",S.s(t,g.e.encodeURIComponent(e||window.location.href))}function ae(e){return 0===e.indexOf("#")&&(e=Q(2,e.substring(1))),e}function ie(e){var t=e.additionalViewParams,n=q(Object(i.__assign)({},e));return t&&Object(D.e)(n,t),t&&t.sc||delete n.sc,"#"+r.n(n,null,!0)}function re(){return W()+"/marketblockerror.aspx"}function oe(e){var t={};return t.id=e.id,t.challengeToken=e.authkey,t.v="validatepermission",W()+"?"+r.n(t,null,!0)}function se(e){var t={};return t.id=e.id,t.challengeToken=e.authkey,t.v="requestaccess",W()+"?"+r.n(t,null,!0)}function ce(e){void 0===e&&(e={});var t=Object(i.__assign)({},e),n=e.ithint;switch(n&&("album"===n.split(",")[0]&&(t.v="photos"),delete t.ithint),c.e.AllMyPhotos===T(e)&&(t.v="photos"),e.v){case"pickerconsent":t.v="pickerconsent";break;case"FolderPickerView":case"1":t.v="FolderPickerView";break;case"FilePickerView":case"2":t.v="FilePickerView";break;case"RansomwareDetection":t.v="RansomwareDetection";break;case"3":delete t.v}return t}function de(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t}function le(){return W()+"?"+r.n({qt:"photostream",v:"photoStream"},null,!0)}function ue(e){void 0===e&&(e={filters:[]});for(var t=[],n=[],a=0,i=0,r=e.filters;i<r.length;i++)"string"==typeof(c=r[i])?t.push(c):n.push(c);if(!t.length)for(var o=0,s=n;o<s.length;o++){var c;switch(c=s[o]){case y.e.folder:a|=7;break;case y.e.audio:a|=32;break;case y.e.media:a|=8;break;case y.e.document:a|=16;break;case y.e.any:a|=f.all}}var d=t.join(";"),l="".concat(a||""),u={};return d&&(u.ext=d),l&&(u.ft=l),u}I.e.isActivated("DFFB77B6-8059-4C5F-B2B3-8E96E04C4B1F","01/30/2023","Add check for the largest files view")},function(e,t,n){"use strict";var a=n(528);t.e=a.e},function(e,t,n){var a,i,r;!function(o){var s=this||(0,eval)("this"),c=s.document,d=s.navigator,l=s.jQuery,u=s.JSON;!function(o){i=[t,n],void 0===(r="function"==typeof(a=o)?a.apply(t,i):a)||(e.exports=r)}(function(e,t){function n(e,t){return(null===e||typeof e in D)&&e===t}function a(e,t){var n;return function(){n||(n=S.a.setTimeout(function(){n=o,e()},t))}}function i(e,t){var n;return function(){clearTimeout(n),n=S.a.setTimeout(e,t)}}function r(e,t){t&&t!==I?"beforeChange"===t?this.Lb(e):this.Ha(e,t):this.Mb(e)}function f(e,t){null!==t&&t.k&&t.k()}function p(e,t){var n=this.Ic,a=n[E];a.S||(this.lb&&this.Na[t]?(n.Qb(t,e,this.Na[t]),this.Na[t]=null,--this.lb):a.r[t]||n.Qb(t,e,a.s?{ia:e}:n.wc(e)))}function m(e,t,n,a){S.d[e]={init:function(e,i,r,o,s){var c,d;return S.m(function(){var r=i(),o=S.a.c(r),l=(o=!n!=!o,!d);(l||t||o!==c)&&(l&&S.va.Aa()&&(d=S.a.ua(S.e.childNodes(e),!0)),o?(l||S.e.da(e,S.a.ua(d)),S.Ka(a?a(s,r):s,e)):S.e.xa(e),c=o)},null,{i:e}),{controlsDescendantBindings:!0}}},S.h.ta[e]=!1,S.e.V[e]=!0}var _,h,b,g,v,y,S=void 0!==e?e:{};S.b=function(e,t){for(var n=e.split("."),a=S,i=0;i<n.length-1;i++)a=a[n[i]];a[n[n.length-1]]=t},S.G=function(e,t,n){e[t]=n},S.version="3.5.0-pre",S.b("version",S.version),S.options={deferUpdates:!1,useOnlyNativeEvents:!1},S.a=function(){function e(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function t(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function n(e,t){return e.__proto__=t,e}function a(e,t,n,a){var i=e[t].match(h)||[];S.a.q(n.match(h),function(e){S.a.pa(i,e,a)}),e[t]=i.join(" ")}var i={__proto__:[]}instanceof Array,r="function"==typeof Symbol,f={},p={};f[d&&/Firefox\/2/i.test(d.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],f.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),e(f,function(e,t){if(t.length)for(var n=0,a=t.length;n<a;n++)p[t[n]]=e});var m={propertychange:!0},_=c&&function(){for(var e=3,t=c.createElement("div"),n=t.getElementsByTagName("i");t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",n[0];);return 4<e?e:o}(),h=/\S+/g;return{ec:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(e,t){for(var n=0,a=e.length;n<a;n++)t(e[n],n)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var n=0,a=e.length;n<a;n++)if(e[n]===t)return n;return-1},Tb:function(e,t,n){for(var a=0,i=e.length;a<i;a++)if(t.call(n,e[a],a))return e[a];return null},Ma:function(e,t){var n=S.a.o(e,t);0<n?e.splice(n,1):0===n&&e.shift()},Ub:function(e){for(var t=[],n=0,a=(e=e||[]).length;n<a;n++)0>S.a.o(t,e[n])&&t.push(e[n]);return t},fb:function(e,t){for(var n=[],a=0,i=(e=e||[]).length;a<i;a++)n.push(t(e[a],a));return n},La:function(e,t){for(var n=[],a=0,i=(e=e||[]).length;a<i;a++)t(e[a],a)&&n.push(e[a]);return n},ra:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var n=0,a=t.length;n<a;n++)e.push(t[n]);return e},pa:function(e,t,n){var a=S.a.o(S.a.zb(e),t);0>a?n&&e.push(t):n||e.splice(a,1)},ka:i,extend:t,Ya:n,Za:i?n:t,D:e,Ca:function(e,t){if(!e)return e;var n,a={};for(n in e)e.hasOwnProperty(n)&&(a[n]=t(e[n],n,e));return a},ob:function(e){for(;e.firstChild;)S.removeNode(e.firstChild)},lc:function(e){for(var t=((e=S.a.W(e))[0]&&e[0].ownerDocument||c).createElement("div"),n=0,a=e.length;n<a;n++)t.appendChild(S.$(e[n]));return t},ua:function(e,t){for(var n=0,a=e.length,i=[];n<a;n++){var r=e[n].cloneNode(!0);i.push(t?S.$(r):r)}return i},da:function(e,t){if(S.a.ob(e),t)for(var n=0,a=t.length;n<a;n++)e.appendChild(t[n])},sc:function(e,t){var n=e.nodeType?[e]:e;if(0<n.length){for(var a=n[0],i=a.parentNode,r=0,o=t.length;r<o;r++)i.insertBefore(t[r],a);for(r=0,o=n.length;r<o;r++)S.removeNode(n[r])}},za:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var n=e[0],a=e[e.length-1];for(e.length=0;n!==a;)e.push(n),n=n.nextSibling;e.push(a)}}return e},uc:function(e,t){7>_?e.setAttribute("selected",t):e.selected=t},ab:function(e){return null===e||e===o?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},od:function(e,t){return e=e||"",!(t.length>e.length)&&e.substring(0,t.length)===t},Nc:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},nb:function(e){return S.a.Nc(e,e.ownerDocument.documentElement)},Rb:function(e){return!!S.a.Tb(e,S.a.nb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Xb:function(e){return S.onError?function(){try{return e.apply(this,arguments)}catch(e){throw S.onError&&S.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(S.a.Xb(e),t)},bc:function(e){setTimeout(function(){throw S.onError&&S.onError(e),e},0)},p:function(e,t,n){var a=S.a.Xb(n);if(n=_&&m[t],S.options.useOnlyNativeEvents||n||!l)if(n||"function"!=typeof e.addEventListener){if(void 0===e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var i=function(t){a.call(e,t)},r="on"+t;e.attachEvent(r,i),S.a.F.oa(e,function(){e.detachEvent(r,i)})}else e.addEventListener(t,a,!1);else l(e).bind(t,a)},Da:function(e,t){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var n;if(n=!("input"!==S.a.A(e)||!e.type||"click"!=t.toLowerCase()||"checkbox"!=(n=e.type)&&"radio"!=n),S.options.useOnlyNativeEvents||!l||n)if("function"==typeof c.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(n=c.createEvent(p[t]||"HTMLEvents")).initEvent(t,!0,!0,s,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(n)}else if(n&&e.click)e.click();else{if(void 0===e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+t)}else l(e).trigger(t)},c:function(e){return S.H(e)?e():e},zb:function(e){return S.H(e)?e.t():e},cb:function(e,t,n){var i;t&&("object"==typeof e.classList?(i=e.classList[n?"add":"remove"],S.a.q(t.match(h),function(t){i.call(e.classList,t)})):"string"==typeof e.className.baseVal?a(e.className,"baseVal",t,n):a(e,"className",t,n))},$a:function(e,t){var n=S.a.c(t);null!==n&&n!==o||(n="");var a=S.e.firstChild(e);!a||3!=a.nodeType||S.e.nextSibling(a)?S.e.da(e,[e.ownerDocument.createTextNode(n)]):a.data=n,S.a.Sc(e)},tc:function(e,t){if(e.name=t,7>=_)try{e.mergeAttributes(c.createElement("<input name='"+e.name+"'/>"),!1)}catch(e){}},Sc:function(e){9<=_&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},Oc:function(e){if(_){var t=e.style.width;e.style.width=0,e.style.width=t}},jd:function(e,t){e=S.a.c(e),t=S.a.c(t);for(var n=[],a=e;a<=t;a++)n.push(a);return n},W:function(e){for(var t=[],n=0,a=e.length;n<a;n++)t.push(e[n]);return t},$b:function(e){return r?Symbol(e):e},sd:6===_,ud:7===_,C:_,gc:function(e,t){for(var n=S.a.W(e.getElementsByTagName("input")).concat(S.a.W(e.getElementsByTagName("textarea"))),a="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},i=[],r=n.length-1;0<=r;r--)a(n[r])&&i.push(n[r]);return i},fd:function(e){return"string"==typeof e&&(e=S.a.ab(e))?u&&u.parse?u.parse(e):new Function("return "+e)():null},Eb:function(e,t,n){if(!u||!u.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return u.stringify(S.a.c(e),t,n)},gd:function(t,n,a){var i=(a=a||{}).params||{},r=a.includeFields||this.ec,o=t;if("object"==typeof t&&"form"===S.a.A(t)){o=t.action;for(var s=r.length-1;0<=s;s--)for(var d=S.a.gc(t,r[s]),l=d.length-1;0<=l;l--)i[d[l].name]=d[l].value}n=S.a.c(n);var u=c.createElement("form");for(var f in u.style.display="none",u.action=o,u.method="post",n)(t=c.createElement("input")).type="hidden",t.name=f,t.value=S.a.Eb(S.a.c(n[f])),u.appendChild(t);e(i,function(e,t){var n=c.createElement("input");n.type="hidden",n.name=e,n.value=t,u.appendChild(n)}),c.body.appendChild(u),a.submitter?a.submitter(u):u.submit(),setTimeout(function(){u.parentNode.removeChild(u)},0)}}}(),S.b("utils",S.a),S.b("utils.arrayForEach",S.a.q),S.b("utils.arrayFirst",S.a.Tb),S.b("utils.arrayFilter",S.a.La),S.b("utils.arrayGetDistinctValues",S.a.Ub),S.b("utils.arrayIndexOf",S.a.o),S.b("utils.arrayMap",S.a.fb),S.b("utils.arrayPushAll",S.a.ra),S.b("utils.arrayRemoveItem",S.a.Ma),S.b("utils.extend",S.a.extend),S.b("utils.fieldsIncludedWithJsonPost",S.a.ec),S.b("utils.getFormFields",S.a.gc),S.b("utils.peekObservable",S.a.zb),S.b("utils.postJson",S.a.gd),S.b("utils.parseJson",S.a.fd),S.b("utils.registerEventHandler",S.a.p),S.b("utils.stringifyJson",S.a.Eb),S.b("utils.range",S.a.jd),S.b("utils.toggleDomNodeCssClass",S.a.cb),S.b("utils.triggerEvent",S.a.Da),S.b("utils.unwrapObservable",S.a.c),S.b("utils.objectForEach",S.a.D),S.b("utils.addOrRemoveItem",S.a.pa),S.b("utils.setTextContent",S.a.$a),S.b("unwrap",S.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var n=Array.prototype.slice.call(arguments,1);return function(){var a=n.slice(0);return a.push.apply(a,arguments),t.apply(e,a)}}),S.a.f=new function(){function e(e,i){var r=e[n];if(!r||"null"===r||!a[r]){if(!i)return o;r=e[n]="ko"+t++,a[r]={}}return a[r]}var t=0,n="__ko__"+(new Date).getTime(),a={};return{get:function(t,n){var a=e(t,!1);return a===o?o:a[n]},set:function(t,n,a){a===o&&e(t,!1)===o||(e(t,!0)[n]=a)},clear:function(e){var t=e[n];return!!t&&(delete a[t],e[n]=null,!0)},I:function(){return t+++n}}},S.b("utils.domData",S.a.f),S.b("utils.domData.clear",S.a.f.clear),S.a.F=new function(){function e(e,t){var a=S.a.f.get(e,n);return a===o&&t&&(a=[],S.a.f.set(e,n,a)),a}function t(n){if(a=e(n,!1))for(var a=a.slice(0),r=0;r<a.length;r++)a[r](n);if(S.a.f.clear(n),S.a.F.cleanExternalData(n),i[n.nodeType])for(a=n.firstChild;n=a;)a=n.nextSibling,8===n.nodeType&&t(n)}var n=S.a.f.I(),a={1:!0,8:!0,9:!0},i={1:!0,9:!0};return{oa:function(t,n){if("function"!=typeof n)throw Error("Callback must be a function");e(t,!0).push(n)},rc:function(t,a){var i=e(t,!1);i&&(S.a.Ma(i,a),0==i.length&&S.a.f.set(t,n,o))},$:function(e){if(a[e.nodeType]&&(t(e),i[e.nodeType])){var n=[];S.a.ra(n,e.getElementsByTagName("*"));for(var r=0,o=n.length;r<o;r++)t(n[r])}return e},removeNode:function(e){S.$(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){l&&"function"==typeof l.cleanData&&l.cleanData([e])}}},S.$=S.a.F.$,S.removeNode=S.a.F.removeNode,S.b("cleanNode",S.$),S.b("removeNode",S.removeNode),S.b("utils.domNodeDisposal",S.a.F),S.b("utils.domNodeDisposal.addDisposeCallback",S.a.F.oa),S.b("utils.domNodeDisposal.removeDisposeCallback",S.a.F.rc),_=[0,"",""],v={thead:h=[1,"<table>","</table>"],tbody:h,tfoot:h,tr:[2,"<table><tbody>","</tbody></table>"],td:b=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:b,option:g=[1,"<select multiple='multiple'>","</select>"],optgroup:g},y=8>=S.a.C,S.a.ma=function(e,t){var n;if(l){if(l.parseHTML)n=l.parseHTML(e,t)||[];else if((n=l.clean([e],t))&&n[0]){for(var a=n[0];a.parentNode&&11!==a.parentNode.nodeType;)a=a.parentNode;a.parentNode&&a.parentNode.removeChild(a)}}else{(n=t)||(n=c),a=n.parentWindow||n.defaultView||s;var i,r=S.a.ab(e).toLowerCase(),o=n.createElement("div");for(i=(r=r.match(/^<([a-z]+)[ >]/))&&v[r[1]]||_,r=i[0],i="ignored<div>"+i[1]+e+i[2]+"</div>","function"==typeof a.innerShiv?o.appendChild(a.innerShiv(i)):(y&&n.appendChild(o),o.innerHTML=i,y&&o.parentNode.removeChild(o));r--;)o=o.lastChild;n=S.a.W(o.lastChild.childNodes)}return n},S.a.Cb=function(e,t){if(S.a.ob(e),null!==(t=S.a.c(t))&&t!==o)if("string"!=typeof t&&(t=t.toString()),l)l(e).html(t);else for(var n=S.a.ma(t,e.ownerDocument),a=0;a<n.length;a++)e.appendChild(n[a])},S.b("utils.parseHtmlFragment",S.a.ma),S.b("utils.setHtml",S.a.Cb),S.M=function(){function e(t,n){if(t)if(8==t.nodeType)null!=(a=S.M.nc(t.nodeValue))&&n.push({Mc:t,dd:a});else if(1==t.nodeType)for(var a=0,i=t.childNodes,r=i.length;a<r;a++)e(i[a],n)}var t={};return{wb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var n=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return t[n]=e,"\x3c!--[ko_memo:"+n+"]--\x3e"},zc:function(e,n){var a=t[e];if(a===o)throw Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return a.apply(null,n||[]),!0}finally{delete t[e]}},Ac:function(t,n){var a=[];e(t,a);for(var i=0,r=a.length;i<r;i++){var o=a[i].Mc,s=[o];n&&S.a.ra(s,n),S.M.zc(a[i].dd,s),o.nodeValue="",o.parentNode&&o.parentNode.removeChild(o)}},nc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),S.b("memoization",S.M),S.b("memoization.memoize",S.M.wb),S.b("memoization.unmemoize",S.M.zc),S.b("memoization.parseMemoText",S.M.nc),S.b("memoization.unmemoizeDomNodeAndDescendants",S.M.Ac),S.Z=function(){function e(){if(a)for(var e,t=a,i=0;r<a;)if(e=n[r++]){if(r>t){if(5e3<=++i){r=a,S.a.bc(Error("'Too much recursion' after processing "+i+" task groups."));break}t=a}try{e()}catch(e){S.a.bc(e)}}}function t(){e(),r=a=n.length=0}var n=[],a=0,i=1,r=0;return{scheduler:s.MutationObserver?function(e){var t=c.createElement("div");return new MutationObserver(e).observe(t,{attributes:!0}),function(){t.classList.toggle("foo")}}(t):c&&"onreadystatechange"in c.createElement("script")?function(e){var t=c.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,c.documentElement.removeChild(t),t=null,e()},c.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Xa:function(e){return a||S.Z.scheduler(t),n[a++]=e,i++},cancel:function(e){(e-=i-a)>=r&&e<a&&(n[e]=null)},resetForTesting:function(){var e=a-r;return r=a=n.length=0,e},nd:e}}(),S.b("tasks",S.Z),S.b("tasks.schedule",S.Z.Xa),S.b("tasks.runEarly",S.Z.nd),S.ya={throttle:function(e,t){e.throttleEvaluation=t;var n=null;return S.B({read:e,write:function(a){clearTimeout(n),n=S.a.setTimeout(function(){e(a)},t)}})},rateLimit:function(e,t){var n,r,o;"number"==typeof t?n=t:(n=t.timeout,r=t.method),e.eb=!1,o="notifyWhenChangesStop"==r?i:a,e.Ua(function(e){return o(e,n)})},deferred:function(e,t){if(!0!==t)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.eb||(e.eb=!0,e.Ua(function(t){var n;return function(){S.Z.cancel(n),n=S.Z.Xa(t),e.notifySubscribers(o,"dirty")}}))},notify:function(e,t){e.equalityComparer="always"==t?null:n}};var D={undefined:1,boolean:1,number:1,string:1};S.b("extenders",S.ya),S.xc=function(e,t,n){this.ia=e,this.gb=t,this.Lc=n,this.S=!1,S.G(this,"dispose",this.k)},S.xc.prototype.k=function(){this.S=!0,this.Lc()},S.J=function(){S.a.Za(this,x),x.rb(this)};var I="change",x={rb:function(e){e.K={},e.Ob=1},Y:function(e,t,n){var a=this;n=n||I;var i=new S.xc(a,t?e.bind(t):e,function(){S.a.Ma(a.K[n],i),a.Ia&&a.Ia(n)});return a.sa&&a.sa(n),a.K[n]||(a.K[n]=[]),a.K[n].push(i),i},notifySubscribers:function(e,t){if((t=t||I)===I&&this.Ib(),this.Qa(t))try{S.l.Vb();for(var n,a=this.K[t].slice(0),i=0;n=a[i];++i)n.S||n.gb(e)}finally{S.l.end()}},Oa:function(){return this.Ob},Vc:function(e){return this.Oa()!==e},Ib:function(){++this.Ob},Ua:function(e){var t,n,a,i=this,o=S.H(i);i.Ha||(i.Ha=i.notifySubscribers,i.notifySubscribers=r);var s=e(function(){i.Nb=!1,o&&a===i&&(a=i()),t=!1,i.tb(n,a)&&i.Ha(n=a)});i.Mb=function(e){i.Nb=t=!0,a=e,s()},i.Lb=function(e){t||(n=e,i.Ha(e,"beforeChange"))}},Qa:function(e){return this.K[e]&&this.K[e].length},Tc:function(e){if(e)return this.K[e]&&this.K[e].length||0;var t=0;return S.a.D(this.K,function(e,n){"dirty"!==e&&(t+=n.length)}),t},tb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this;return e&&S.a.D(e,function(e,n){var a=S.ya[e];"function"==typeof a&&(t=a(t,n)||t)}),t}};S.G(x,"subscribe",x.Y),S.G(x,"extend",x.extend),S.G(x,"getSubscriptionsCount",x.Tc),S.a.ka&&S.a.Ya(x,Function.prototype),S.J.fn=x,S.jc=function(e){return null!=e&&"function"==typeof e.Y&&"function"==typeof e.notifySubscribers},S.b("subscribable",S.J),S.b("isSubscribable",S.jc),S.va=S.l=function(){function e(e){a.push(n),n=e}function t(){n=a.pop()}var n,a=[],i=0;return{Vb:e,end:t,qc:function(e){if(n){if(!S.jc(e))throw Error("Only subscribable things can act as dependencies");n.gb.call(n.Hc,e,e.Dc||(e.Dc=++i))}},w:function(n,a,i){try{return e(),n.apply(a,i||[])}finally{t()}},Aa:function(){if(n)return n.m.Aa()},Ta:function(){if(n)return n.Ta}}}(),S.b("computedContext",S.va),S.b("computedContext.getDependenciesCount",S.va.Aa),S.b("computedContext.isInitial",S.va.Ta),S.b("ignoreDependencies",S.rd=S.l.w);var C=S.a.$b("_latestValue");S.N=function(e){function t(){return 0<arguments.length?(t.tb(t[C],arguments[0])&&(t.ga(),t[C]=arguments[0],t.fa()),this):(S.l.qc(t),t[C])}return t[C]=e,S.a.ka||S.a.extend(t,S.J.fn),S.J.fn.rb(t),S.a.Za(t,O),S.options.deferUpdates&&S.ya.deferred(t,!0),t};var O={equalityComparer:n,t:function(){return this[C]},fa:function(){this.notifySubscribers(this[C])},ga:function(){this.notifySubscribers(this[C],"beforeChange")}};S.a.ka&&S.a.Ya(O,S.J.fn);var w=S.N.hd="__ko_proto__";O[w]=S.N,S.Pa=function(e,t){return null!==e&&e!==o&&e[w]!==o&&(e[w]===t||S.Pa(e[w],t))},S.H=function(e){return S.Pa(e,S.N)},S.Ba=function(e){return!!("function"==typeof e&&e[w]===S.N||"function"==typeof e&&e[w]===S.B&&e.Wc)},S.b("observable",S.N),S.b("isObservable",S.H),S.b("isWriteableObservable",S.Ba),S.b("isWritableObservable",S.Ba),S.b("observable.fn",O),S.G(O,"peek",O.t),S.G(O,"valueHasMutated",O.fa),S.G(O,"valueWillMutate",O.ga),S.la=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=S.N(e),S.a.Za(e,S.la.fn),e.extend({trackArrayChanges:!0})},S.la.fn={remove:function(e){for(var t=this.t(),n=[],a="function"!=typeof e||S.H(e)?function(t){return t===e}:e,i=0;i<t.length;i++){var r=t[i];a(r)&&(0===n.length&&this.ga(),n.push(r),t.splice(i,1),i--)}return n.length&&this.fa(),n},removeAll:function(e){if(e===o){var t=this.t(),n=t.slice(0);return this.ga(),t.splice(0,t.length),this.fa(),n}return e?this.remove(function(t){return 0<=S.a.o(e,t)}):[]},destroy:function(e){var t=this.t(),n="function"!=typeof e||S.H(e)?function(t){return t===e}:e;this.ga();for(var a=t.length-1;0<=a;a--)n(t[a])&&(t[a]._destroy=!0);this.fa()},destroyAll:function(e){return e===o?this.destroy(function(){return!0}):e?this.destroy(function(t){return 0<=S.a.o(e,t)}):[]},indexOf:function(e){var t=this();return S.a.o(t,e)},replace:function(e,t){var n=this.indexOf(e);0<=n&&(this.ga(),this.t()[n]=t,this.fa())}},S.a.ka&&S.a.Ya(S.la.fn,S.N.fn),S.a.q("pop push reverse shift sort splice unshift".split(" "),function(e){S.la.fn[e]=function(){var t=this.t();this.ga(),this.Wb(t,e,arguments);var n=t[e].apply(t,arguments);return this.fa(),n===t?this:n}}),S.a.q(["slice"],function(e){S.la.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}}),S.b("observableArray",S.la),S.ya.trackArrayChanges=function(e,t){function n(){if(!r){r=!0,i=e.notifySubscribers,e.notifySubscribers=function(e,t){return t&&t!==I||++c,i.apply(this,arguments)};var t=[].concat(e.t()||[]);s=null,a=e.Y(function(n){var a;n=[].concat(n||[]),e.Qa("arrayChange")&&((!s||1<c)&&(s=S.a.ib(t,n,e.hb)),a=s),t=n,s=null,c=0,a&&a.length&&e.notifySubscribers(a,"arrayChange")})}}if(e.hb={},t&&"object"==typeof t&&S.a.extend(e.hb,t),e.hb.sparse=!0,!e.Wb){var a,i,r=!1,s=null,c=0,d=e.sa,l=e.Ia;e.sa=function(t){d&&d.call(e,t),"arrayChange"===t&&n()},e.Ia=function(t){l&&l.call(e,t),"arrayChange"!==t||e.Qa("arrayChange")||(i&&(e.notifySubscribers=i,i=o),a.k(),r=!1)},e.Wb=function(e,t,n){function a(e,t,n){return i[i.length]={status:e,value:t,index:n}}if(r&&!c){var i=[],o=e.length,d=n.length,l=0;switch(t){case"push":l=o;case"unshift":for(t=0;t<d;t++)a("added",n[t],l+t);break;case"pop":l=o-1;case"shift":o&&a("deleted",e[l],l);break;case"splice":t=Math.min(Math.max(0,0>n[0]?o+n[0]:n[0]),o),o=1===d?o:Math.min(t+(n[1]||0),o),d=t+d-2,l=Math.max(o,d);for(var u=[],f=[],p=2;t<l;++t,++p)t<o&&f.push(a("deleted",e[t],t)),t<d&&u.push(a("added",n[p],t));S.a.fc(f,u);break;default:return}s=i}}}};var E=S.a.$b("_state");S.m=S.B=function(e,t,n){function a(){if(0<arguments.length){if("function"!=typeof i)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return i.apply(r.pb,arguments),this}return S.l.qc(a),(r.T||r.s&&a.Ra())&&a.aa(),r.U}if("object"==typeof e?n=e:(n=n||{},e&&(n.read=e)),"function"!=typeof n.read)throw Error("Pass a function that returns the value of the ko.computed");var i=n.write,r={U:o,T:!0,Sa:!1,Fb:!1,S:!1,Wa:!1,s:!1,kd:n.read,pb:t||n.owner,i:n.disposeWhenNodeIsRemoved||n.i||null,wa:n.disposeWhen||n.wa,mb:null,r:{},L:0,dc:null};return a[E]=r,a.Wc="function"==typeof i,S.a.ka||S.a.extend(a,S.J.fn),S.J.fn.rb(a),S.a.Za(a,A),n.pure?(r.Wa=!0,r.s=!0,S.a.extend(a,L)):n.deferEvaluation&&S.a.extend(a,k),S.options.deferUpdates&&S.ya.deferred(a,!0),r.i&&(r.Fb=!0,r.i.nodeType||(r.i=null)),r.s||n.deferEvaluation||a.aa(),r.i&&a.ba()&&S.a.F.oa(r.i,r.mb=function(){a.k()}),a};var A={equalityComparer:n,Aa:function(){return this[E].L},Qb:function(e,t,n){if(this[E].Wa&&t===this)throw Error("A 'pure' computed must not be called recursively");this[E].r[e]=n,n.Ga=this[E].L++,n.na=t.Oa()},Ra:function(){var e,t,n=this[E].r;for(e in n)if(n.hasOwnProperty(e)&&(t=n[e]).ia.Vc(t.na))return!0},cd:function(){this.Fa&&!this[E].Sa&&this.Fa()},ba:function(){return this[E].T||0<this[E].L},md:function(){this.Nb||this.cc()},wc:function(e){if(e.eb&&!this[E].i){var t=e.Y(this.cd,this,"dirty"),n=e.Y(this.md,this);return{ia:e,k:function(){t.k(),n.k()}}}return e.Y(this.cc,this)},cc:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[E].dc),this[E].dc=S.a.setTimeout(function(){e.aa(!0)},t)):e.Fa?e.Fa():e.aa(!0)},aa:function(e){var t=this[E],n=t.wa;if(!t.Sa&&!t.S){if(t.i&&!S.a.nb(t.i)||n&&n()){if(!t.Fb)return void this.k()}else t.Fb=!1;t.Sa=!0;try{this.Rc(e)}finally{t.Sa=!1}t.L||this.k()}},Rc:function(e){var t=this[E],n=t.Wa?o:!t.L,a={Ic:this,Na:t.r,lb:t.L};S.l.Vb({Hc:a,gb:p,m:this,Ta:n}),t.r={},t.L=0,a=this.Qc(t,a),this.tb(t.U,a)&&(t.s||this.notifySubscribers(t.U,"beforeChange"),t.U=a,t.s?this.Ib():e&&this.notifySubscribers(t.U)),n&&this.notifySubscribers(t.U,"awake")},Qc:function(e,t){try{var n=e.kd;return e.pb?n.call(e.pb):n()}finally{S.l.end(),t.lb&&!e.s&&S.a.D(t.Na,f),e.T=!1}},t:function(){var e=this[E];return(e.T&&!e.L||e.s&&this.Ra())&&this.aa(),e.U},Ua:function(e){S.J.fn.Ua.call(this,e),this.Fa=function(){this.Lb(this[E].U),this[E].T=!0,this.Mb(this)}},k:function(){var e=this[E];!e.s&&e.r&&S.a.D(e.r,function(e,t){t.k&&t.k()}),e.i&&e.mb&&S.a.F.rc(e.i,e.mb),e.r=null,e.L=0,e.S=!0,e.T=!1,e.s=!1,e.i=null}},L={sa:function(e){var t=this,n=t[E];if(!n.S&&n.s&&"change"==e){if(n.s=!1,n.T||t.Ra())n.r=null,n.L=0,n.T=!0,t.aa(),t.Ib();else{var a=[];S.a.D(n.r,function(e,t){a[t.Ga]=e}),S.a.q(a,function(e,a){var i=n.r[e],r=t.wc(i.ia);r.Ga=a,r.na=i.na,n.r[e]=r})}n.S||t.notifySubscribers(n.U,"awake")}},Ia:function(e){var t=this[E];t.S||"change"!=e||this.Qa("change")||(S.a.D(t.r,function(e,n){n.k&&(t.r[e]={ia:n.ia,Ga:n.Ga,na:n.na},n.k())}),t.s=!0,this.notifySubscribers(o,"asleep"))},Oa:function(){var e=this[E];return e.s&&(e.T||this.Ra())&&this.aa(),S.J.fn.Oa.call(this)}},k={sa:function(e){"change"!=e&&"beforeChange"!=e||this.t()}};S.a.ka&&S.a.Ya(A,S.J.fn);var M=S.N.hd;S.m[M]=S.N,A[M]=S.m,S.Yc=function(e){return S.Pa(e,S.m)},S.Zc=function(e){return S.Pa(e,S.m)&&e[E]&&e[E].Wa},S.b("computed",S.m),S.b("dependentObservable",S.m),S.b("isComputed",S.Yc),S.b("isPureComputed",S.Zc),S.b("computed.fn",A),S.G(A,"peek",A.t),S.G(A,"dispose",A.k),S.G(A,"isActive",A.ba),S.G(A,"getDependenciesCount",A.Aa),S.pc=function(e,t){return"function"==typeof e?S.m(e,t,{pure:!0}):((e=S.a.extend({},e)).pure=!0,S.m(e,t))},S.b("pureComputed",S.pc),function(){function e(n,a,i){if(i=i||new t,"object"!=typeof(n=a(n))||null===n||n===o||n instanceof RegExp||n instanceof Date||n instanceof String||n instanceof Number||n instanceof Boolean)return n;var r=n instanceof Array?[]:{};return i.save(n,r),function(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n);"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)}(n,function(t){var s=a(n[t]);switch(typeof s){case"boolean":case"number":case"string":case"function":r[t]=s;break;case"object":case"undefined":var c=i.get(s);r[t]=c!==o?c:e(s,a,i)}}),r}function t(){this.keys=[],this.Jb=[]}S.yc=function(t){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(t,function(e){for(var t=0;S.H(e)&&10>t;t++)e=e();return e})},S.toJSON=function(e,t,n){return e=S.yc(e),S.a.Eb(e,t,n)},t.prototype={save:function(e,t){var n=S.a.o(this.keys,e);0<=n?this.Jb[n]=t:(this.keys.push(e),this.Jb.push(t))},get:function(e){return 0<=(e=S.a.o(this.keys,e))?this.Jb[e]:o}}}(),S.b("toJS",S.yc),S.b("toJSON",S.toJSON),S.j={u:function(e){switch(S.a.A(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?S.a.f.get(e,S.d.options.xb):7>=S.a.C?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?S.j.u(e.options[e.selectedIndex]):o;default:return e.value}},ha:function(e,t,n){switch(S.a.A(e)){case"option":"string"==typeof t?(S.a.f.set(e,S.d.options.xb,o),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=t):(S.a.f.set(e,S.d.options.xb,t),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof t?t:"");break;case"select":""!==t&&null!==t||(t=o);for(var a,i=-1,r=0,s=e.options.length;r<s;++r)if((a=S.j.u(e.options[r]))==t||""==a&&t===o){i=r;break}(n||0<=i||t===o&&1<e.size)&&(e.selectedIndex=i);break;default:null!==t&&t!==o||(t=""),e.value=t}}},S.b("selectExtensions",S.j),S.b("selectExtensions.readValue",S.j.u),S.b("selectExtensions.writeValue",S.j.ha),S.h=function(){function e(e){123===(e=S.a.ab(e)).charCodeAt(0)&&(e=e.slice(1,-1));var t,n=[],o=e.match(a),s=[],c=0;if(o){o.push(",");for(var d,l=0;d=o[l];++l){var u=d.charCodeAt(0);if(44===u){if(0>=c){n.push(t&&s.length?{key:t,value:s.join("")}:{unknown:t||s.join("")}),t=c=0,s=[];continue}}else if(58===u){if(!c&&!t&&1===s.length){t=s.pop();continue}}else 47===u&&l&&1<d.length?(u=o[l-1].match(i))&&!r[u[0]]&&((o=(e=e.substr(e.indexOf(d)+1)).match(a)).push(","),l=-1,d="/"):40===u||123===u||91===u?++c:41===u||125===u||93===u?--c:t||s.length||34!==u&&39!==u||(d=d.slice(1,-1));s.push(d)}}return n}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,a=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),i=/[\])"'A-Za-z0-9_$]+$/,r={in:1,return:1,typeof:1},o={};return{ta:[],ea:o,yb:e,Va:function(a,i){function r(e,a){var i;if(!l){var u=S.getBindingHandler(e);if(u&&u.preprocess&&!(a=u.preprocess(a,e,r)))return;(u=o[e])&&(i=a,0<=S.a.o(t,i)?i=!1:(u=i.match(n),i=null!==u&&(u[1]?"Object("+u[1]+")"+u[2]:i)),u=i),u&&c.push("'"+e+"':function(_z){"+i+"=_z}")}d&&(a="function(){return "+a+" }"),s.push("'"+e+"':"+a)}var s=[],c=[],d=(i=i||{}).valueAccessors,l=i.bindingParams,u="string"==typeof a?e(a):a;return S.a.q(u,function(e){r(e.key||e.unknown,e.value)}),c.length&&r("_ko_property_writers","{"+c.join(",")+" }"),s.join(",")},bd:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0;return!1},Ea:function(e,t,n,a,i){e&&S.H(e)?!S.Ba(e)||i&&e.t()===a||e(a):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](a)}}}(),S.b("expressionRewriting",S.h),S.b("expressionRewriting.bindingRewriteValidators",S.h.ta),S.b("expressionRewriting.parseObjectLiteral",S.h.yb),S.b("expressionRewriting.preProcessBindings",S.h.Va),S.b("expressionRewriting._twoWayBindings",S.h.ea),S.b("jsonExpressionRewriting",S.h),S.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",S.h.Va),function(){function e(e){return 8==e.nodeType&&r.test(i?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&o.test(i?e.text:e.nodeValue)}function n(n,a){for(var i=n,r=1,o=[];i=i.nextSibling;){if(t(i)&&0==--r)return o;o.push(i),e(i)&&r++}if(!a)throw Error("Cannot find closing comment tag to match: "+n.nodeValue);return null}function a(e,t){var a=n(e,t);return a?0<a.length?a[a.length-1].nextSibling:e.nextSibling:null}var i=c&&"\x3c!--test--\x3e"===c.createComment("test").text,r=i?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,o=i?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,s={ul:!0,ol:!0};S.e={V:{},childNodes:function(t){return e(t)?n(t):t.childNodes},xa:function(t){if(e(t))for(var n=0,a=(t=S.e.childNodes(t)).length;n<a;n++)S.removeNode(t[n]);else S.a.ob(t)},da:function(t,n){if(e(t)){S.e.xa(t);for(var a=t.nextSibling,i=0,r=n.length;i<r;i++)a.parentNode.insertBefore(n[i],a)}else S.a.da(t,n)},oc:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},ic:function(t,n,a){a?e(t)?t.parentNode.insertBefore(n,a.nextSibling):a.nextSibling?t.insertBefore(n,a.nextSibling):t.appendChild(n):S.e.oc(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=a(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},Uc:e,qd:function(e){return(e=(i?e.text:e.nodeValue).match(r))?e[1]:null},mc:function(n){if(s[S.a.A(n)]){var i=n.firstChild;if(i)do{if(1===i.nodeType){var r,o=null;if(r=i.firstChild)do{if(o)o.push(r);else if(e(r)){var c=a(r,!0);c?r=c:o=[r]}else t(r)&&(o=[r])}while(r=r.nextSibling);if(r=o)for(o=i.nextSibling,c=0;c<r.length;c++)o?n.insertBefore(r[c],o):n.appendChild(r[c])}}while(i=i.nextSibling)}}}}(),S.b("virtualElements",S.e),S.b("virtualElements.allowedBindings",S.e.V),S.b("virtualElements.emptyNode",S.e.xa),S.b("virtualElements.insertAfter",S.e.ic),S.b("virtualElements.prepend",S.e.oc),S.b("virtualElements.setDomNodeChildren",S.e.da),S.R=function(){this.Gc={}},S.a.extend(S.R.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||S.g.getComponentNameForNode(e);case 8:return S.e.Uc(e);default:return!1}},getBindings:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e):null;return S.g.Pb(n,e,t,!1)},getBindingAccessors:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null;return S.g.Pb(n,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return S.e.qd(e);default:return null}},parseBindingsString:function(e,t,n,a){try{var i,r=this.Gc,o=e+(a&&a.valueAccessors||"");if(!(i=r[o])){var s,c="with($context){with($data||{}){return{"+S.h.Va(e,a)+"}}}";s=new Function("$context","$element",c),i=r[o]=s}return i(t,n)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}}),S.R.instance=new S.R,S.b("bindingProvider",S.R),function(){function e(e){return function(){return e}}function t(e){return e()}function n(e){return S.a.Ca(S.l.w(e),function(t,n){return function(){return e()[n]}})}function a(t,a,i){return"function"==typeof t?n(t.bind(null,a,i)):S.a.Ca(t,e)}function i(e,t){return n(this.getBindings.bind(this,e,t))}function r(e,t,n){var a,i=S.e.firstChild(t),r=S.R.instance,o=r.preprocessNode;if(o){for(;a=i;)i=S.e.nextSibling(a),o.call(r,a);i=S.e.firstChild(t)}for(;a=i;)i=S.e.nextSibling(a),c(e,a,n)}function c(e,t,n){var a=!0,i=1===t.nodeType;i&&S.e.mc(t),(i&&n||S.R.instance.nodeHasBindings(t))&&(a=d(t,null,e,n).shouldBindDescendants),a&&!f[S.a.A(t)]&&r(e,t,!i)}function d(e,n,a,r){var s,c,d=S.a.f.get(e,p);if(!n){if(d)throw Error("You cannot apply bindings multiple times to the same element.");S.a.f.set(e,p,!0)}if(!d&&r&&S.vc(e,a),n&&"function"!=typeof n)s=n;else{var l=S.R.instance,u=l.getBindingAccessors||i,f=S.B(function(){return(s=n?n(a,e):u.call(l,e,a))&&a.P&&a.P(),s},null,{i:e});s&&f.ba()||(f=null)}if(s){var m=f?function(e){return function(){return t(f()[e])}}:function(e){return s[e]},_=function(){return S.a.Ca(f?f():s,t)};_.get=function(e){return s[e]&&t(m(e))},_.has=function(e){return e in s},r=function(e){var t=[],n={},a=[];return S.a.D(e,function i(r){if(!n[r]){var o=S.getBindingHandler(r);o&&(o.after&&(a.push(r),S.a.q(o.after,function(t){if(e[t]){if(-1!==S.a.o(a,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+a.join(", "));i(t)}}),a.length--),t.push({key:r,hc:o})),n[r]=!0}}),t}(s),S.a.q(r,function(t){var n=t.hc.init,i=t.hc.update,r=t.key;if(8===e.nodeType&&!S.e.V[r])throw Error("The binding '"+r+"' cannot be used with virtual elements");try{"function"==typeof n&&S.l.w(function(){var t=n(e,m(r),_,a.$data,a);if(t&&t.controlsDescendantBindings){if(c!==o)throw Error("Multiple bindings ("+c+" and "+r+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");c=r}}),"function"==typeof i&&S.B(function(){i(e,m(r),_,a.$data,a)},null,{i:e})}catch(e){throw e.message='Unable to process binding "'+r+": "+s[r]+'"\nMessage: '+e.message,e}})}return{shouldBindDescendants:c===o}}function u(e){return e&&e instanceof S.Q?e:new S.Q(e)}S.d={};var f={script:!0,textarea:!0,template:!0};S.getBindingHandler=function(e){return S.d[e]},S.Q=function(e,t,n,a,i){function r(){var i=l?e():e,r=S.a.c(i);return t?(t.P&&t.P(),S.a.extend(d,t),d.P=c):(d.$parents=[],d.$root=r,d.ko=S),d.$rawData=i,d.$data=r,n&&(d[n]=r),a&&a(d,t,r),d.$data}var s,c,d=this,l="function"==typeof e&&!S.H(e);i&&i.exportDependencies?r():(c=S.B(r,null,{wa:function(){return s&&!S.a.Rb(s)},i:!0})).ba()&&(d.P=c,c.equalityComparer=null,s=[],c.Bc=function(e){s.push(e),S.a.F.oa(e,function(e){S.a.Ma(s,e),s.length||(c.k(),d.P=c=o)})})},S.Q.prototype.createChildContext=function(e,t,n,a){return new S.Q(e,this,t,function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)},a)},S.Q.prototype.extend=function(e){return new S.Q(this.P||this.$data,this,null,function(t,n){t.$rawData=n.$rawData,S.a.extend(t,"function"==typeof e?e():e)})},S.Q.prototype.Zb=function(e,t){return this.createChildContext(e,t,null,{exportDependencies:!0})};var p=S.a.f.I(),m=S.a.f.I();S.vc=function(e,t){if(2!=arguments.length)return S.a.f.get(e,m);S.a.f.set(e,m,t),t.P&&t.P.Bc(e)},S.Ja=function(e,t,n){return 1===e.nodeType&&S.e.mc(e),d(e,t,u(n),!0)},S.Ec=function(e,t,n){return n=u(n),S.Ja(e,a(t,n,e),n)},S.Ka=function(e,t){1!==t.nodeType&&8!==t.nodeType||r(u(e),t,!0)},S.Sb=function(e,t){if(!l&&s.jQuery&&(l=s.jQuery),t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||s.document.body,c(u(e),t,!0)},S.kb=function(e){switch(e.nodeType){case 1:case 8:var t=S.vc(e);if(t)return t;if(e.parentNode)return S.kb(e.parentNode)}return o},S.Kc=function(e){return(e=S.kb(e))?e.$data:o},S.b("bindingHandlers",S.d),S.b("applyBindings",S.Sb),S.b("applyBindingsToDescendants",S.Ka),S.b("applyBindingAccessorsToNode",S.Ja),S.b("applyBindingsToNode",S.Ec),S.b("contextFor",S.kb),S.b("dataFor",S.Kc)}(),function(e){function t(t,a){var o,s=i.hasOwnProperty(t)?i[t]:e;s?s.Y(a):((s=i[t]=new S.J).Y(a),n(t,function(e,n){var a=!(!n||!n.synchronous);r[t]={definition:e,$c:a},delete i[t],o||a?s.notifySubscribers(e):S.Z.Xa(function(){s.notifySubscribers(e)})}),o=!0)}function n(e,t){a("getConfig",[e],function(n){n?a("loadComponent",[e,n],function(e){t(e,n)}):t(null,null)})}function a(t,n,i,r){r||(r=S.g.loaders.slice(0));var o=r.shift();if(o){var s=o[t];if(s){var c=!1;if(s.apply(o,n.concat(function(e){c?i(null):null!==e?i(e):a(t,n,i,r)}))!==e&&(c=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else a(t,n,i,r)}else i(null)}var i={},r={};S.g={get:function(n,a){var i=r.hasOwnProperty(n)?r[n]:e;i?i.$c?S.l.w(function(){a(i.definition)}):S.Z.Xa(function(){a(i.definition)}):t(n,a)},Yb:function(e){delete r[e]},Kb:a},S.g.loaders=[],S.b("components",S.g),S.b("components.get",S.g.get),S.b("components.clearCachedDefinition",S.g.Yb)}(),function(){function e(e,t,n,a){function i(){0==--s&&a(o)}var o={},s=2,c=n.template;n=n.viewModel,c?r(t,c,function(t){S.g.Kb("loadTemplate",[e,t],function(e){o.template=e,i()})}):i(),n?r(t,n,function(t){S.g.Kb("loadViewModel",[e,t],function(e){o[l]=e,i()})}):i()}function n(e,t,a){if("function"==typeof t)a(function(e){return new t(e)});else if("function"==typeof t[l])a(t[l]);else if("instance"in t){var i=t.instance;a(function(){return i})}else"viewModel"in t?n(e,t.viewModel,a):e("Unknown viewModel value: "+t)}function a(e){switch(S.a.A(e)){case"script":return S.a.ma(e.text);case"textarea":return S.a.ma(e.value);case"template":if(i(e.content))return S.a.ua(e.content.childNodes)}return S.a.ua(e.childNodes)}function i(e){return s.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function r(e,n,a){"string"==typeof n.require?t||s.require?(t||s.require)([n.require],a):e("Uses require, but no AMD loader is present"):a(n)}function o(e){return function(t){throw Error("Component '"+e+"': "+t)}}var d={};S.g.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(S.g.ub(e))throw Error("Component "+e+" is already registered");d[e]=t},S.g.ub=function(e){return d.hasOwnProperty(e)},S.g.pd=function(e){delete d[e],S.g.Yb(e)},S.g.ac={getConfig:function(e,t){t(d.hasOwnProperty(e)?d[e]:null)},loadComponent:function(t,n,a){var i=o(t);r(i,n,function(n){e(t,i,n,a)})},loadTemplate:function(e,t,n){if(e=o(e),"string"==typeof t)n(S.a.ma(t));else if(t instanceof Array)n(t);else if(i(t))n(S.a.W(t.childNodes));else if(t.element)if(t=t.element,s.HTMLElement?t instanceof HTMLElement:t&&t.tagName&&1===t.nodeType)n(a(t));else if("string"==typeof t){var r=c.getElementById(t);r?n(a(r)):e("Cannot find element with ID "+t)}else e("Unknown element type: "+t);else e("Unknown template value: "+t)},loadViewModel:function(e,t,a){n(o(e),t,a)}};var l="createViewModel";S.b("components.register",S.g.register),S.b("components.isRegistered",S.g.ub),S.b("components.unregister",S.g.pd),S.b("components.defaultLoader",S.g.ac),S.g.loaders.push(S.g.ac),S.g.Cc=d}(),function(){function e(e,n){if(a=e.getAttribute("params")){var a=t.parseBindingsString(a,n,e,{valueAccessors:!0,bindingParams:!0}),i=(a=S.a.Ca(a,function(t){return S.m(t,null,{i:e})}),S.a.Ca(a,function(t){var n=t.t();return t.ba()?S.m({read:function(){return S.a.c(t())},write:S.Ba(n)&&function(e){t()(e)},i:e}):n}));return i.hasOwnProperty("$raw")||(i.$raw=a),i}return{$raw:{}}}S.g.getComponentNameForNode=function(e){var t=S.a.A(e);if(S.g.ub(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=S.a.C&&e.tagName===t))return t},S.g.Pb=function(t,n,a,i){if(1===n.nodeType){var r=S.g.getComponentNameForNode(n);if(r){if((t=t||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:r,params:e(n,a)};t.component=i?function(){return o}:o}}return t};var t=new S.R;9>S.a.C&&(S.g.register=function(e){return function(t){return c.createElement(t),e.apply(this,arguments)}}(S.g.register),c.createDocumentFragment=function(e){return function(){var t,n=e(),a=S.g.Cc;for(t in a)a.hasOwnProperty(t)&&n.createElement(t);return n}}(c.createDocumentFragment))}(),function(e){var t=0;S.d.component={init:function(e,n,a,i,r){function o(){var e=s&&s.dispose;"function"==typeof e&&e.call(s),c=s=null}var s,c,d=S.a.W(S.e.childNodes(e));return S.a.F.oa(e,o),S.m(function(){var a,i,l=S.a.c(n());if("string"==typeof l?a=l:(a=S.a.c(l.name),i=S.a.c(l.params)),!a)throw Error("No component name specified");var u=c=++t;S.g.get(a,function(t){if(c===u){if(o(),!t)throw Error("Unknown component '"+a+"'");!function(e,t,n){if(!(t=t.template))throw Error("Component '"+e+"' has no template");e=S.a.ua(t),S.e.da(n,e)}(a,t,e);var n=function(e,t,n,a){var i=e.createViewModel;return i?i.call(e,a,{element:t,templateNodes:n}):a}(t,e,d,i);t=r.createChildContext(n,void 0,function(e){e.$component=n,e.$componentTemplateNodes=d}),s=n,S.Ka(t,e)}})},null,{i:e}),{controlsDescendantBindings:!0}}},S.e.V.component=!0}();var P={class:"className",for:"htmlFor"};S.d.attr={update:function(e,t){var n=S.a.c(t())||{};S.a.D(n,function(t,n){var a=!1===(n=S.a.c(n))||null===n||n===o;a&&e.removeAttribute(t),8>=S.a.C&&t in P?(t=P[t],a?e.removeAttribute(t):e[t]=n):a||e.setAttribute(t,n.toString()),"name"===t&&S.a.tc(e,a?"":n.toString())})}},S.d.checked={after:["value","attr"],init:function(e,t,n){function a(){var a=e.checked,r=f?i():a;if(!S.va.Ta()&&(!s||a)){var o=S.l.w(t);if(d){var c=l?o.t():o;u!==r?(a&&(S.a.pa(c,r,!0),S.a.pa(c,u,!1)),u=r):S.a.pa(c,r,a),l&&S.Ba(o)&&o(c)}else S.h.Ea(o,n,"checked",r,!0)}}var i=S.pc(function(){return n.has("checkedValue")?S.a.c(n.get("checkedValue")):n.has("value")?S.a.c(n.get("value")):e.value}),r="checkbox"==e.type,s="radio"==e.type;if(r||s){var c=t(),d=r&&S.a.c(c)instanceof Array,l=!(d&&c.push&&c.splice),u=d?i():o,f=s||d;s&&!e.name&&S.d.uniqueName.init(e,function(){return!0}),S.m(a,null,{i:e}),S.a.p(e,"click",a),S.m(function(){var n=S.a.c(t());e.checked=d?0<=S.a.o(n,i()):r?n:i()===n},null,{i:e}),c=o}}},S.h.ea.checked=!0,S.d.checkedValue={update:function(e,t){e.value=S.a.c(t())}},S.d.class={update:function(e,t){var n=S.a.ab(S.a.c(t()));S.a.cb(e,e.__ko__cssValue,!1),e.__ko__cssValue=n,S.a.cb(e,n,!0)}},S.d.css={update:function(e,t){var n=S.a.c(t());null!==n&&"object"==typeof n?S.a.D(n,function(t,n){n=S.a.c(n),S.a.cb(e,t,n)}):S.d.class.update(e,t)}},S.d.enable={update:function(e,t){var n=S.a.c(t());n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},S.d.disable={update:function(e,t){S.d.enable.update(e,function(){return!S.a.c(t())})}},S.d.event={init:function(e,t,n,a,i){var r=t()||{};S.a.D(r,function(r){"string"==typeof r&&S.a.p(e,r,function(e){var o,s=t()[r];if(s){try{var c=S.a.W(arguments);a=i.$data,c.unshift(a),o=s.apply(a,c)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(r+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}})})}},S.d.foreach={kc:function(e){return function(){var t=e(),n=S.a.zb(t);return n&&"number"!=typeof n.length?(S.a.c(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:S.X.sb}):{foreach:t,templateEngine:S.X.sb}}},init:function(e,t){return S.d.template.init(e,S.d.foreach.kc(t))},update:function(e,t,n,a,i){return S.d.template.update(e,S.d.foreach.kc(t),n,a,i)}},S.h.ta.foreach=!1,S.e.V.foreach=!0,S.d.hasfocus={init:function(e,t,n){function a(a){e.__ko_hasfocusUpdating=!0;var i=e.ownerDocument;if("activeElement"in i){var r;try{r=i.activeElement}catch(e){r=i.body}a=r===e}i=t(),S.h.Ea(i,n,"hasfocus",a,!0),e.__ko_hasfocusLastValue=a,e.__ko_hasfocusUpdating=!1}var i=a.bind(null,!0),r=a.bind(null,!1);S.a.p(e,"focus",i),S.a.p(e,"focusin",i),S.a.p(e,"blur",r),S.a.p(e,"focusout",r)},update:function(e,t){var n=!!S.a.c(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),!n&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),S.l.w(S.a.Da,null,[e,n?"focusin":"focusout"]))}},S.h.ea.hasfocus=!0,S.d.hasFocus=S.d.hasfocus,S.h.ea.hasFocus=!0,S.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){S.a.Cb(e,t())}},m("if"),m("ifnot",!1,!0),m("with",!0,!1,function(e,t){return e.Zb(t)}),S.d.let={init:function(e,t,n,a,i){return t=i.extend(t),S.Ka(t,e),{controlsDescendantBindings:!0}}},S.e.V.let=!0;var T={};S.d.options={init:function(e){if("select"!==S.a.A(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(e,t,n){function a(){return S.a.La(e.options,function(e){return e.selected})}function i(e,t,n){var a=typeof t;return"function"==a?t(e):"string"==a?e[t]:n}function r(t,a){if(m&&l)S.j.ha(e,S.a.c(n.get("value")),!0);else if(p.length){var i=0<=S.a.o(p,S.j.u(a[0]));S.a.uc(a[0],i),m&&!i&&S.l.w(S.a.Da,null,[e,"change"])}}var s=e.multiple,c=0!=e.length&&s?e.scrollTop:null,d=S.a.c(t()),l=n.get("valueAllowUnset")&&n.has("value"),u=n.get("optionsIncludeDestroyed");t={};var f,p=[];l||(s?p=S.a.fb(a(),S.j.u):0<=e.selectedIndex&&p.push(S.j.u(e.options[e.selectedIndex]))),d&&(void 0===d.length&&(d=[d]),f=S.a.La(d,function(e){return u||e===o||null===e||!S.a.c(e._destroy)}),n.has("optionsCaption")&&null!==(d=S.a.c(n.get("optionsCaption")))&&d!==o&&f.unshift(T));var m=!1;t.beforeRemove=function(t){e.removeChild(t)},d=r,n.has("optionsAfterRender")&&"function"==typeof n.get("optionsAfterRender")&&(d=function(e,t){r(0,t),S.l.w(n.get("optionsAfterRender"),null,[t[0],e!==T?e:o])}),S.a.Bb(e,f,function(t,a,r){return r.length&&(p=!l&&r[0].selected?[S.j.u(r[0])]:[],m=!0),a=e.ownerDocument.createElement("option"),t===T?(S.a.$a(a,n.get("optionsCaption")),S.j.ha(a,o)):(r=i(t,n.get("optionsValue"),t),S.j.ha(a,S.a.c(r)),t=i(t,n.get("optionsText"),r),S.a.$a(a,t)),[a]},t,d),S.l.w(function(){l?S.j.ha(e,S.a.c(n.get("value")),!0):(s?p.length&&a().length<p.length:p.length&&0<=e.selectedIndex?S.j.u(e.options[e.selectedIndex])!==p[0]:p.length||0<=e.selectedIndex)&&S.a.Da(e,"change")}),S.a.Oc(e),c&&20<Math.abs(c-e.scrollTop)&&(e.scrollTop=c)}},S.d.options.xb=S.a.f.I(),S.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){S.a.p(e,"change",function(){var a=t(),i=[];S.a.q(e.getElementsByTagName("option"),function(e){e.selected&&i.push(S.j.u(e))}),S.h.Ea(a,n,"selectedOptions",i)})},update:function(e,t){if("select"!=S.a.A(e))throw Error("values binding applies only to SELECT elements");var n=S.a.c(t()),a=e.scrollTop;n&&"number"==typeof n.length&&S.a.q(e.getElementsByTagName("option"),function(e){var t=0<=S.a.o(n,S.j.u(e));e.selected!=t&&S.a.uc(e,t)}),e.scrollTop=a}},S.h.ea.selectedOptions=!0,S.d.style={update:function(e,t){var n=S.a.c(t()||{});S.a.D(n,function(t,n){null!==(n=S.a.c(n))&&n!==o&&!1!==n||(n=""),e.style[t]=n})}},S.d.submit={init:function(e,t,n,a,i){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");S.a.p(e,"submit",function(n){var a,r=t();try{a=r.call(i.$data,e)}finally{!0!==a&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}})}},S.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){S.a.$a(e,t())}},S.e.V.text=!0,function(){if(s&&s.navigator)var e=function(e){if(e)return parseFloat(e[1])},t=s.opera&&s.opera.version&&parseInt(s.opera.version()),n=s.navigator.userAgent,a=e(n.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),i=e(n.match(/Firefox\/([^ ]*)/));if(10>S.a.C)var r=S.a.f.I(),c=S.a.f.I(),d=function(e){var t=this.activeElement;(t=t&&S.a.f.get(t,c))&&t(e)},l=function(e,t){var n=e.ownerDocument;S.a.f.get(n,r)||(S.a.f.set(n,r,!0),S.a.p(n,"selectionchange",d)),S.a.f.set(e,c,t)};S.d.textInput={init:function(e,n,r){function s(t,n){S.a.p(e,t,n)}function c(){u||(f=e.value,u=S.a.setTimeout(d,4))}function d(){clearTimeout(u),f=u=o;var t=e.value;p!==t&&(p=t,S.h.Ea(n(),r,"textInput",t))}var u,f,p=e.value,m=9==S.a.C?c:d;10>S.a.C?(s("propertychange",function(e){"value"===e.propertyName&&m(e)}),8==S.a.C&&(s("keyup",d),s("keydown",d)),8<=S.a.C&&(l(e,m),s("dragend",c))):(s("input",d),5>a&&"textarea"===S.a.A(e)?(s("keydown",c),s("paste",c),s("cut",c)):11>t?s("keydown",c):4>i&&(s("DOMAutoComplete",d),s("dragdrop",d),s("drop",d))),s("change",d),S.m(function t(){var a=S.a.c(n());null!==a&&a!==o||(a=""),f!==o&&a===f?S.a.setTimeout(t,4):e.value!==a&&(p=a,e.value=a)},null,{i:e})}},S.h.ea.textInput=!0,S.d.textinput={preprocess:function(e,t,n){n("textInput",e)}}}(),S.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++S.d.uniqueName.Jc;S.a.tc(e,n)}}},S.d.uniqueName.Jc=0,S.d.value={after:["options","foreach"],init:function(e,t,n){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var a=["change"],i=n.get("valueUpdate"),r=!1,o=null;i&&("string"==typeof i&&(i=[i]),S.a.ra(a,i),a=S.a.Ub(a));var s=function(){o=null,r=!1;var a=t(),i=S.j.u(e);S.h.Ea(a,n,"value",i)};!S.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=S.a.o(a,"propertychange")||(S.a.p(e,"propertychange",function(){r=!0}),S.a.p(e,"focus",function(){r=!1}),S.a.p(e,"blur",function(){r&&s()})),S.a.q(a,function(t){var n=s;S.a.od(t,"after")&&(n=function(){o=S.j.u(e),S.a.setTimeout(s,0)},t=t.substring(5)),S.a.p(e,t,n)});var c=function(){var a=S.a.c(t()),i=S.j.u(e);if(null!==o&&a===o)S.a.setTimeout(c,0);else if(a!==i)if("select"===S.a.A(e)){var r=n.get("valueAllowUnset");(i=function(){S.j.ha(e,a,r)})(),r||a===S.j.u(e)?S.a.setTimeout(i,0):S.l.w(S.a.Da,null,[e,"change"])}else S.j.ha(e,a)};S.m(c,null,{i:e})}else S.Ja(e,{checkedValue:t})},update:function(){}},S.h.ea.value=!0,S.d.visible={update:function(e,t){var n=S.a.c(t()),a="none"!=e.style.display;n&&!a?e.style.display="":!n&&a&&(e.style.display="none")}},function(e){S.d[e]={init:function(t,n,a,i,r){return S.d.event.init.call(this,t,function(){var t={};return t[e]=n(),t},a,i,r)}}}("click"),S.O=function(){},S.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},S.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},S.O.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var n=(t=t||c).getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new S.v.n(n)}if(1==e.nodeType||8==e.nodeType)return new S.v.qa(e);throw Error("Unknown template type: "+e)},S.O.prototype.renderTemplate=function(e,t,n,a){return e=this.makeTemplateSource(e,a),this.renderTemplateSource(e,t,n,a)},S.O.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")},S.O.prototype.rewriteTemplate=function(e,t,n){t=t((e=this.makeTemplateSource(e,n)).text()),e.text(t),e.data("isRewritten",!0)},S.b("templateEngine",S.O),S.Gb=function(){function e(e,t,n,a){e=S.h.yb(e);for(var i=S.h.ta,r=0;r<e.length;r++){var o=e[r].key;if(i.hasOwnProperty(o)){var s=i[o];if("function"==typeof s){if(o=s(e[r].value))throw Error(o)}else if(!s)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+S.h.Va(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",a.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Pc:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,function(e){return S.Gb.ed(e,t)},n)},ed:function(a,i){return a.replace(t,function(t,n,a,r,o){return e(o,n,a,i)}).replace(n,function(t,n){return e(n,"\x3c!-- ko --\x3e","#comment",i)})},Fc:function(e,t){return S.M.wb(function(n,a){var i=n.nextSibling;i&&i.nodeName.toLowerCase()===t&&S.Ja(i,e,a)})}}}(),S.b("__tr_ambtns",S.Gb.Fc),function(){S.v={},S.v.n=function(e){if(this.n=e){var t=S.a.A(e);this.bb="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}},S.v.n.prototype.text=function(){var e=1===this.bb?"text":2===this.bb?"value":"innerHTML";if(0==arguments.length)return this.n[e];var t=arguments[0];"innerHTML"===e?S.a.Cb(this.n,t):this.n[e]=t};var e=S.a.f.I()+"_";S.v.n.prototype.data=function(t){if(1===arguments.length)return S.a.f.get(this.n,e+t);S.a.f.set(this.n,e+t,arguments[1])};var t=S.a.f.I();S.v.n.prototype.nodes=function(){var e=this.n;if(0==arguments.length)return(S.a.f.get(e,t)||{}).jb||(3===this.bb?e.content:4===this.bb?e:o);S.a.f.set(e,t,{jb:arguments[0]})},S.v.qa=function(e){this.n=e},S.v.qa.prototype=new S.v.n,S.v.qa.prototype.text=function(){if(0==arguments.length){var e=S.a.f.get(this.n,t)||{};return e.Hb===o&&e.jb&&(e.Hb=e.jb.innerHTML),e.Hb}S.a.f.set(this.n,t,{Hb:arguments[0]})},S.b("templateSources",S.v),S.b("templateSources.domElement",S.v.n),S.b("templateSources.anonymousTemplate",S.v.qa)}(),function(){function e(e,t,n){var a;for(t=S.e.nextSibling(t);e&&(a=e)!==t;)n(a,e=S.e.nextSibling(a))}function t(t,n){if(t.length){var a=t[0],i=t[t.length-1],r=a.parentNode,o=S.R.instance,s=o.preprocessNode;if(s){if(e(a,i,function(e,t){var n=e.previousSibling,r=s.call(o,e);r&&(e===a&&(a=r[0]||t),e===i&&(i=r[r.length-1]||n))}),t.length=0,!a)return;a===i?t.push(a):(t.push(a,i),S.a.za(t,r))}e(a,i,function(e){1!==e.nodeType&&8!==e.nodeType||S.Sb(n,e)}),e(a,i,function(e){1!==e.nodeType&&8!==e.nodeType||S.M.Ac(e,[n])}),S.a.za(t,r)}}function n(e){return e.nodeType?e:0<e.length?e[0]:null}function a(e,a,i,o,s){s=s||{};var c=(e&&n(e)||i||{}).ownerDocument,d=s.templateEngine||r;if(S.Gb.Pc(i,d,c),"number"!=typeof(i=d.renderTemplate(i,o,s,c)).length||0<i.length&&"number"!=typeof i[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(c=!1,a){case"replaceChildren":S.e.da(e,i),c=!0;break;case"replaceNode":S.a.sc(e,i),c=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+a)}return c&&(t(i,o),s.afterRender&&S.l.w(s.afterRender,null,[i,o.$data])),i}function i(e,t,n){return S.H(e)?e():"function"==typeof e?e(t,n):e}var r;S.Db=function(e){if(e!=o&&!(e instanceof S.O))throw Error("templateEngine must inherit from ko.templateEngine");r=e},S.Ab=function(e,t,s,c,d){if(((s=s||{}).templateEngine||r)==o)throw Error("Set a template engine before calling renderTemplate");if(d=d||"replaceChildren",c){var l=n(c);return S.B(function(){var r=t&&t instanceof S.Q?t:new S.Q(t,null,null,null,{exportDependencies:!0}),o=i(e,r.$data,r);r=a(c,d,o,r,s),"replaceNode"==d&&(l=n(c=r))},null,{wa:function(){return!l||!S.a.nb(l)},i:l&&"replaceNode"==d?l.parentNode:l})}return S.M.wb(function(n){S.Ab(e,t,s,n,"replaceNode")})},S.ld=function(e,n,r,s,c){function d(e,n){t(n,u),r.afterRender&&r.afterRender(n,e),u=null}function l(t,n){return u=c.createChildContext(t,r.as,function(e){e.$index=n}),a(null,"ignoreTargetNode",i(e,t,u),u,r)}var u;return S.B(function(){var e=S.a.c(n)||[];void 0===e.length&&(e=[e]),e=S.a.La(e,function(e){return r.includeDestroyed||e===o||null===e||!S.a.c(e._destroy)}),S.l.w(S.a.Bb,null,[s,e,l,r,d])},null,{i:s})};var s=S.a.f.I();S.d.template={init:function(e,t){var n=S.a.c(t());if("string"==typeof n||n.name)S.e.xa(e);else{if("nodes"in n){if(n=n.nodes||[],S.H(n))throw Error('The "nodes" option must be a plain, non-observable array.')}else n=S.e.childNodes(e);n=S.a.lc(n),new S.v.qa(e).nodes(n)}return{controlsDescendantBindings:!0}},update:function(e,t,n,a,i){var r=t();n=!0,a=null,"string"==typeof(t=S.a.c(r))?t={}:(r=t.name,"if"in t&&(n=S.a.c(t.if)),n&&"ifnot"in t&&(n=!S.a.c(t.ifnot))),"foreach"in t?a=S.ld(r||e,n&&t.foreach||[],t,e,i):n?(i="data"in t?i.Zb(t.data,t.as):i,a=S.Ab(r||e,i,t,e)):S.e.xa(e),i=a,(t=S.a.f.get(e,s))&&"function"==typeof t.k&&t.k(),S.a.f.set(e,s,i&&i.ba()?i:o)}},S.h.ta.template=function(e){return 1==(e=S.h.yb(e)).length&&e[0].unknown||S.h.bd(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},S.e.V.template=!0}(),S.b("setTemplateEngine",S.Db),S.b("renderTemplate",S.Ab),S.a.fc=function(e,t,n){var a,i,r,o,s;if(e.length&&t.length)for(a=i=0;(!n||a<n)&&(o=e[i]);++i){for(r=0;s=t[r];++r)if(o.value===s.value){o.moved=s.index,s.moved=o.index,t.splice(r,1),a=r=0;break}a+=r}},S.a.ib=function(){function e(e,t,n,a,i){var r,o,s,c,d,l=Math.min,u=Math.max,f=[],p=e.length,m=t.length,_=m-p||1,h=p+m+1;for(r=0;r<=p;r++)for(c=s,f.push(s=[]),d=l(m,r+_),o=u(0,r-1);o<=d;o++)s[o]=o?r?e[r-1]===t[o-1]?c[o-1]:l(c[o]||h,s[o-1]||h)+1:o+1:r+1;for(l=[],u=[],_=[],r=p,o=m;r||o;)m=f[r][o]-1,o&&m===f[r][o-1]?u.push(l[l.length]={status:n,value:t[--o],index:o}):r&&m===f[r-1][o]?_.push(l[l.length]={status:a,value:e[--r],index:r}):(--o,--r,i.sparse||l.push({status:"retained",value:t[o]}));return S.a.fc(_,u,!i.dontLimitMoves&&10*p),l.reverse()}return function(t,n,a){return a="boolean"==typeof a?{dontLimitMoves:a}:a||{},n=n||[],(t=t||[]).length<n.length?e(t,n,"added","deleted",a):e(n,t,"deleted","added",a)}}(),S.b("utils.compareArrays",S.a.ib),function(){function e(e,t,n,a,i){var r=[],s=S.B(function(){var o=t(n,i,S.a.za(r,e))||[];0<r.length&&(S.a.sc(r,o),a&&S.l.w(a,null,[n,o,i])),r.length=0,S.a.ra(r,o)},null,{i:e,wa:function(){return!S.a.Rb(r)}});return{ca:r,B:s.ba()?s:o}}var t=S.a.f.I(),n=S.a.f.I();S.a.Bb=function(a,i,r,s,c){function d(e,t){D=p[t],g!==t&&(C[e]=D),D.qb(g++),S.a.za(D.ca,a),h.push(D),y.push(D)}function l(e,t){if(e)for(var n=0,a=t.length;n<a;n++)t[n]&&S.a.q(t[n].ca,function(a){e(a,n,t[n].ja)})}i=i||[],s=s||{};var u,f=S.a.f.get(a,t)===o,p=S.a.f.get(a,t)||[],m=S.a.fb(p,function(e){return e.ja}),_=S.a.ib(m,i,s.dontLimitMoves),h=[],b=0,g=0,v=[],y=[];i=[];for(var D,I,x,C=[],O=(m=[],0);I=_[O];O++)switch(x=I.moved,I.status){case"deleted":x===o&&((D=p[b]).B&&(D.B.k(),D.B=o),S.a.za(D.ca,a).length&&(s.beforeRemove&&(h.push(D),y.push(D),D.ja===n?D=null:i[O]=D),D&&v.push.apply(v,D.ca))),b++;break;case"retained":d(O,b++);break;case"added":x!==o?d(O,x):(D={ja:I.value,qb:S.N(g++)},h.push(D),y.push(D),f||(m[O]=D))}for(S.a.f.set(a,t,h),l(s.beforeMove,C),S.a.q(v,s.beforeRemove?S.$:S.removeNode),O=0,f=S.e.firstChild(a);D=y[O];O++){for(D.ca||S.a.extend(D,e(a,r,D.ja,c,D.qb)),b=0;_=D.ca[b];f=_.nextSibling,u=_,b++)_!==f&&S.e.ic(a,_,u);!D.Xc&&c&&(c(D.ja,D.ca,D.qb),D.Xc=!0)}for(l(s.beforeRemove,i),O=0;O<i.length;++O)i[O]&&(i[O].ja=n);l(s.afterMove,C),l(s.afterAdd,m)}}(),S.b("utils.setDomNodeChildrenFromArrayMapping",S.a.Bb),S.X=function(){this.allowTemplateRewriting=!1},S.X.prototype=new S.O,S.X.prototype.renderTemplateSource=function(e,t,n,a){return(t=9>S.a.C||!e.nodes?null:e.nodes())?S.a.W(t.cloneNode(!0).childNodes):(e=e.text(),S.a.ma(e,a))},S.X.sb=new S.X,S.Db(S.X.sb),S.b("nativeTemplateEngine",S.X),function(){S.vb=function(){var e=this.ad=function(){if(!l||!l.tmpl)return 0;try{if(0<=l.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,n,a,i){if(i=i||c,a=a||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var r=t.data("precompiled");return r||(r=t.text()||"",r=l.template(null,"{{ko_with $item.koBindingContext}}"+r+"{{/ko_with}}"),t.data("precompiled",r)),t=[n.$data],n=l.extend({koBindingContext:n},a.templateOptions),(n=l.tmpl(r,t,n)).appendTo(i.createElement("div")),l.fragments={},n},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){c.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")},0<e&&(l.tmpl.tag.ko_code={open:"__.push($1 || '');"},l.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},S.vb.prototype=new S.O;var e=new S.vb;0<e.ad&&S.Db(e),S.b("jqueryTmplTemplateEngine",S.vb)}()})}()},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(31),r=n(7),o=n(12),s=n(401),c=n(66),d=n(139),l=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=a,r=i.resources,c=i.observables,l=n.getCurrentItem,u=void 0===l?r.consume(o.i.lazy.optional):l,f=n.getItemSetSelectionModel,p=void 0===f?r.consume(o.b.lazy.optional):f,m=n.getSelectionHelper,_=void 0===m?r.consume(s.e.lazy.optional):m,h=t.allowMultiSelect,b=void 0!==h&&h,g=t.canFallback,v=void 0!==g&&g,y=t.ignoreSelection,S=void 0!==y&&y,D=t.overrideItem,I=t.useCurrentSelectionGroup,x=void 0!==I&&I;return a._allowMultiSelect=b,a._overrideItem=D,a._ignoreSelection=S,a._useCurrentSelectionGroup=x,a._placeholder=a.observables.create(new d.e),a._getSelectionModel=p,D||(a._selectionHelper=_&&_()),v&&u&&(a._fallback=u()),a.selection=c.pureCompute(a._computeSelection),a.firstItem=c.pureCompute(a._computeFirstItem),a.currentItem=c.pureCompute(function(){return(u&&u()||a._placeholder)()}),a}return Object(a.__extends)(t,e),t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,a=0,i=t;a<i.length;a++){var r=i[a],o=n.unwrap(r);if(!o)return!0;if(!e(o))return!1}return!0},t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})},t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})},t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))},t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()},t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()},t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]},t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()},t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];return(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]),e},t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.n.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return i.n.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():i.n.reject(new Error("Unable to resolve selection."))},t}(r.n),u=Object(c.o)("ItemSelectionHelper",l,Object(a.__assign)(Object(a.__assign)({},r.n.dependencies),{currentItem:o.i.lazy.optional,itemSetSelectionModel:o.b.lazy.optional,selectionHelper:s.e.lazy.optional}))},function(e,t,n){"use strict";n.d(t,"t",function(){return re});var a,i=n(0),r=n(29),o=n(16),s=n(5),c=n(76),d=n(67),l=n(56),u=n(27);!function(e){e[e.iosappstore=0]="iosappstore"}(a||(a={}));var f,p=a,m=n(2),_=n(20),h=n(72),b=n(185),g=n(91),v=n(322),y=n(192),S=n(267),D=n(154),I=n(46),x=n(3),C=n(66),O=n(85),w=n(36),E=n(142),A=n(15),L=n(359),k=n(33),M=n(111),P=n(197),T=n(120),U=n(14);function F(e){var t=e.itemInfo,n=e.parentItemInfo,a=e.viewParams,i=n&&n.itemKey,r=Object(A.p)({itemKey:t.itemKey,itemInfo:t,page:o.e.TextFileEditor,viewParams:a}),s=Object(A.h)(i||"");r.parId=s.id;var c=_.n(r,null,!0);return"TextFileEditor"!==a.v?Object(A.c)(2,c):"#"+c}function H(e){var t=e.itemInfo,n=e.parentItemInfo;return U.e.isActivated("6DCD168B-9EA1-4AD3-A81F-12E38ED97BF2","10/21/2021","Use getParentItemInfo")?n:n&&n.itemKey!==t.itemKey&&n||t.parentFolderItemInfo}function R(e){var t,n=e.itemInfo,a=H({itemInfo:n,parentItemInfo:e.parentItemInfo}),r=!1;U.e.isActivated("1065E6DF-81FE-4F4A-BB9A-625CC03793AA","10/21/2021","Compute URL using AllPhotos parentKey")||(r=Boolean("photos"===e.viewParams.v&&(n.itemIsVideo||n.itemIsPhoto)&&"allmyphotos"!==e.viewParams.qt&&!e.viewParams.parId&&!e.viewParams.parQt&&a&&!a.itemIsAlbum));var o=e;if(r){var s=Object(A._)(((t={}).qt="allmyphotos",t.id="root",t.cid=A.H,t));o=Object(i.__assign)(Object(i.__assign)({},e),{parentItemInfo:{itemKey:s}})}return N(o)}function N(e){var t=e.itemInfo,n=e.parentItemInfo,a=e.viewParams,r=e.additionalViewParams,o=n&&n.itemKey||"",s=Object(A.h)(t.itemKey),c=Object(A.p)(Object(i.__assign)(Object(i.__assign)({},e),{itemKey:o,itemInfo:n}));r&&Object(T.e)(s,r),a&&a.commentId&&(s.commentId=a.commentId),s.parId=c.id,s.parQt=c.qt,s.cid!==c.cid&&(s.parCid=c.cid,delete c.cid),delete c.internalPath,delete c.qt,delete c.id,delete s.u;var d=c.action;return d?a&&a.commentId&&"showproperties"===d.toLowerCase()?(delete c.action,s.o=M.r):(delete c.action,s.action=d):s.o=M.r,"#"+_.n(s,c,!0)}!function(e){e[e.current=0]="current",e[e.focus=1]="focus",e[e.external=2]="external"}(f||(f={}));var B,j=n(268),V=n(38),z=n(257),G=n(574),K=n(41);function W(e,t){void 0===t&&(t={});var n=t.viewParams,a=void 0===n?{}:n,r=t.item;return Object(A.m)(Object(i.__assign)(Object(i.__assign)({},t),{itemKey:e,itemInfo:r&&{itemKey:r.key,itemIsPlaceholder:r.isPlaceholder,itemVirtualItemType:r.virtualItemType,itemExtension:r.extension,itemType:r.type},viewParams:a}))}var q,Q=window.$Config&&window.$Config.isINT,Y=window.FilesConfig&&window.FilesConfig.skyApiDomain,J=window.FilesConfig&&window.FilesConfig.storageDomain,X=window.FilesConfig&&window.FilesConfig.mpcDomain;!function(e){e[e.DateCreated=0]="DateCreated",e[e.DateModified=1]="DateModified"}(q||(q={}));var Z=U.e.isActivated("6CEBAB53-E3AA-4B32-A437-CEC98812ABB4","10/21/2021","Refactor URL DataSource"),$=!U.e.isActivated("71CADB9F-8CE9-47DA-A4A3-0340D883A255","03/02/2023","Propogates redeemTokem if available in WAC open URLs"),ee=!U.e.isActivated("84da682b-95a0-41d5-96c7-c5039e03fe3d","06/14/2023","Move generating Moj url out of OdcUrlDataSource to avoid consume OdcUrlDataSource in Moj"),te=!U.e.isActivated("CA949581-487C-4A90-9D63-81958797F222","10/21/2021","Fast OneUp in ODC")&&Object(m.isFeatureEnabled)(m.UseItemsScopeInOneDrive),ne=new x.t({name:"".concat("UrlDataSource",".useRefactoredGetDefaultClickUrl"),factory:new x.e(!Z)}),ae=new x.t({name:"".concat("UrlDataSource",".enableFastOneUp"),factory:new x.e(te)}),ie=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=this,a=t.navigation,i=void 0===a?this.resources.consume(w.e):a,r=t.enableFastOneUp,o=void 0===r?this.resources.consume(ae):r,s=t.useRefactoredDefaultClickUrl,c=void 0===s?this.resources.consume(ne):s;this._navigation=i,this._enableFastOneUp=o,this._useRefactoredDefaultClickUrl=c,this.getCurrentPageBaseUrl=e&&e._getCurrentPageBaseUrl||(this._useRefactoredDefaultClickUrl?A.s:this.getCurrentPageBaseUrl),this._getCurrentUrlPathName=e&&e._getCurrentUrlPathName||this._getCurrentUrlPathName,this._events=new O.t(this),(this._mayBeFastOneUp=this._enableFastOneUp&&Object(m.isFeatureEnabled)(m.UseItemsScopeInOneDrive)&&!!this.getFocusItemKey(this._navigation.viewParams))&&this._events.on(this._navigation,"change",function(){n.getFocusItemKey(n._navigation.viewParams)||(n._mayBeFastOneUp=!1,n._events.off(n._navigation))})}return e.getKey=function(e){return void 0===e&&(e={}),Object(A._)(e)},e.getKeyParams=function(e){return Object(A.h)(e)},e.getIsSyncUserBusiness=function(e){return"b"===e.pt},e.getWtMcIdParamKeyIsSync=function(e){var t=e.ocid||e["WT.mc_id"];return t&&t.toLowerCase().indexOf("sync")>=0},e.getRedeemCodeParam=function(e){var t=e.redeemCode;return"undefined"===t?"":t},e.getProfileImage=function(t){return e.storageBaseUrl+"/users/0x"+t+"/myprofile/expressionprofile/profilephoto:UserTileLarge,UserTileStatic/MeControlMediumUserTile?ck=1&ex=24&fofoff=1"},e.getTermsUrl=function(){return"https://g.live.com/8seskydrive/tou"},e.getPrivacyUrl=function(){return"https://go.microsoft.com/fwlink/?LinkId=521839"},e.getImpressumUrl=function(){return Object(A.u)()},e.getResourceRedirectUrl=function(e){return"https://onedrive.live.com/redir.aspx?"+_.n({resid:e})},e.encodeSharingUrl=function(e){return Object(k.e)(e)},e.getThumbnailUrl=function(t,n,a,i){return i=i||a,h.s(e.storageBaseUrl+"/Items/{1}:CustomThumbnailSource,HighRes,Default?{2}",t,n,_.n({width:a,height:i,cropmode:"center"}))},e.getVroomBaseUrl=function(e){return Object(k.s)(e)},e.getAutoRedeemRedirectUrl=function(t){var n="",a=t.viewParams,i=a.id,r=a.cid,o=a.action;return a.autoredeeem&&i&&r&&o&&(n=e.getAutoRedeemLoginUrl(i,r,o,t)),n},e.getAutoRedeemLoginUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!1,i.viewParams),s=((r={}).ru=o,r.wreply=o,r);return I.t.signInUrl+"&"+_.n(s,null,!0)},e.getAutoRedeemLogoutUrl=function(t,n,a,i){var r,o=e._getAutoRedeemUrl(t,n,a,!0,i.viewParams),s=((r={}).lru=o,r);return I.t.autoRedeemSignOut+"&"+_.n(s,null,!0)},e.getCookieDomain=function(){return window.$Config.sd},e.getEnvironment=function(){return Object(P.e)()},e.areCidsEqual=function(e,t){return Object(L.e)(e,t)},e._getAutoRedeemUrl=function(e,t,n,a,i){var r,o=((r={}).id=e,r.cid=t,r.action=n,r.authkey=i.authkey,r);return a&&(o.autoredeeem="1"),window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+_.n(o,null,!0)},e.prototype.getDefaultRootItemId=function(){return"root"},e.prototype.getKey=function(t){return e.getKey(t)},e.prototype.getKeyParams=function(e){return Object(A.h)(e)},e.prototype.getRequestAccessLogoutUrl=function(e,t,n){var a,i,r=((a={resid:e,ithint:t}).challengeToken=n,a.v="requestaccess",a),o=window.location.protocol+"//"+window.location.host+document.location.pathname+"?"+_.n(r,null,!0),s=((i={}).lru=o,i);return I.t.autoRedeemSignOut+"&"+_.n(s,null,!0)},e.prototype.getItemHintRedirectViewParams=function(e){return void 0===e&&(e={}),Object(A.f)(e)},e.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(A.C)(e)},e.prototype.getPhotoType=function(e){return Object(A.I)(e)},e.prototype.getPageType=function(e,t){return void 0===e&&(e=this._navigation.viewParams),Object(A.S)(e,this._mayBeFastOneUp||t)},e.prototype.getViewerType=function(e){return function(e){var t=e.viewer;switch(t){case"3d":case"Audio":case"Error":case"FileHandler":case"Html":case"OnePlayerVideo":case"OnePlayerAudio":case"Other":case"Panorama":case"Image360":case"Pdf":case"MSPdf":case"Photo":case"TextFile":case"Thumbnail":case"Video":case"WAC":case"Wrs":case"Zip":return t}}(e)},e.prototype.saveViewerType=function(e){return function(e){var t;return(t={}).viewer=e,t}(e)},e.prototype.getFocusItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(A.l)(e)},e.prototype.getCurrentItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(A.o)(e)},e.prototype.areKeysEqual=function(e,t){var n=this.getKeyParams(e),a=this.getKeyParams(t);return delete n.u,delete a.u,this.getKey(n)===this.getKey(a)},e.prototype.getRootItemKey=function(e){return void 0===e&&(e=s.e.Files),Object(A.w)(e)},e.prototype.isRecycleBin=function(e){return this._useRefactoredDefaultClickUrl?Object(k.g)(e):e===s.e.RecycleBin},e.prototype.isCurrentQueryPhotoStream=function(e){return void 0===e&&(e=this._navigation.viewParams),"photostream"===e.qt},e.prototype.isCurrentQueryFiles=function(e){void 0===e&&(e=this._navigation.viewParams);var t=!U.e.isActivated("4B9ACAFF-DC04-4EA0-93FF-9439B92FD516","10/21/2021","Check is Search in Files pivot")&&(e.searchsessionid||"search"===e.parQt);return Object(A.P)(e)||0===Object.keys(e).length||!e.qt&&!e.v&&!t&&Object(A.n)(e)},e.prototype.isCurrentQueryRecent=function(e){return void 0===e&&(e=this._navigation.viewParams),"mru"===e.qt},e.prototype.isCurrentQuerySharedWithMe=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(A.k)(e)},e.prototype.isCurrentQuerySharedByMe=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt},e.prototype.isCurrentQuerySharedFilesRoot=function(e){return void 0===e&&(e=this._navigation.viewParams),"sharedbyme"===e.qt||"sharedby"===e.qt},e.prototype.isCurrentQueryRecycleBin=function(e){return void 0===e&&(e=this._navigation.viewParams),"recyclebin"===e.qt},e.prototype.getDisableQueryAlteration=function(e){return void 0===e&&(e=this._navigation.viewParams),!1},e.prototype.isCurrentQuery=function(e,t){switch(void 0===t&&(t=this._navigation.viewParams),e){case s.e.Files:return this.isCurrentQueryFiles();case s.e.Recent:return this.isCurrentQueryRecent();case s.e.SharedWithMe:return this.isCurrentQuerySharedWithMe();case s.e.SharedByMe:return this.isCurrentQuerySharedByMe();case s.e.RecycleBin:return this.isCurrentQueryRecycleBin();case s.e.Photos:case s.e.AllMyPhotos:return Object(A.L)(t);case s.e.PhotoStream:return this.isCurrentQueryPhotoStream(t);default:return!!t.qt&&t.qt.toString().toLowerCase()===s.e[e].toString().toLowerCase()}},e.prototype.getFilesQueryUrl=function(){return this._requireAuthentication(this.getItemUrl(this.getKey({}),{page:o.e.Files}))},e.prototype.getRecycleBinQueryUrl=function(){var e;return Object(V.e)(A.H)&&!Object(m.isFeatureEnabled)(m.ApplyItemsScopeToRecycleBin)?"".concat(this.getMpcOneDriveUrl(),"?view=5"):this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="recyclebin",e)),{page:o.e.Files}))},e.prototype.getRecentQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="mru",e)),{page:o.e.Files}))},e.prototype.getPhotoStreamQueryUrl=function(e,t){var n;void 0===t&&(t=!1);var a=Object(i.__assign)({},this._navigation.viewParams);return t||delete a.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="photostream",n.v="photoStream",n.psId=e||"me",n.psShareId=a.psShareId,n.psPostId=a.psPostId,n.pssc=a.pssc,n)),{page:o.e.PhotoStream,viewParams:a}))},e.prototype.getPhotoStreamMyFeedQueryUrl=function(e){var t;void 0===e&&(e=!1);var n=Object(i.__assign)({},this._navigation.viewParams);return e||delete n.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="photostream",t.v="photoStream",t.psShareId=n.psShareId,t.psPostId=n.psPostId,t.pssc=n.pssc,t)),{page:o.e.PhotoStream,viewParams:n}))},e.prototype.getPhotoStreamShareIdUrl=function(e){var t,n=((t={}).id="root",t.qt="photostream",t.v="photoStream",t.psShareId=e,t);return this.getCurrentPageBaseUrl()+"?"+_.n(n,null,!0)},e.prototype.getPhotoStreamForMojsQueryUrl=function(e,t,n){var a,r=Object(i.__assign)({},this._navigation.viewParams);return delete r.psShareId,this._requireAuthentication(this.getItemUrl(this.getKey(((a={}).qt="photostream",a.v="photoStream",a.mojDate=e,a.moj=t,a.psRIds=n.join(","),a)),{page:o.e.PhotoStream,viewParams:r}))},e.prototype.getAllMyPhotosQueryUrl=function(t){var n;return this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.id=t,n.cid=e.viewerId,n)),{page:o.e.Photos}))},e.prototype.getAlbumsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="albums",t)),{page:o.e.Photos}))},e.prototype.getTagsQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="tags",t)),{page:o.e.Photos}))},e.prototype.getPlacesQueryUrl=function(e){var t;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).id="places",t)),{page:o.e.Photos}))},e.prototype.getOnThisDayQueryUrl=function(e,t){var n,a;return ee?function(e,t){var n,a;return Object(A.U)(W(Object(A._)(((n={}).qt="allmyphotos",n.onThisDay=!0,n.moj="onThisDay",n)),{page:o.e.Photos,additionalViewParams:(a={},a.sc=e&&e.sc||"",a)}))}(e):this._requireAuthentication(this.getItemUrl(this.getKey(((n={}).qt="allmyphotos",n.onThisDay=!0,n.moj="onThisDay",n)),{page:o.e.Photos,additionalViewParams:(a={},a.sc=e&&e.sc||"",a)}))},e.prototype.getOnThisMonthQueryUrl=function(e){var t,n;return ee?function(e){var t,n;return Object(A.U)(W(Object(A._)(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.moj="onThisMonth",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))}(e):this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.onThisMonth=!0,t.moj="onThisMonth",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getLastWeekPreviousYearsQueryUrl=function(e){var t,n;return ee?function(e){var t,n;return Object(A.U)(W(Object(A._)(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.moj="lastWeekPreviousYears",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))}(e):this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.lastWeekPreviousYears=!0,t.moj="lastWeekPreviousYears",t.useUtilityFiltering=e.useUtilityFiltering,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getRecentPhotoUrl=function(e){var t,n;return this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).parQt=e.parQt,t.id=e.id,t.cid=e.cid,t)),{page:o.e.Photos,additionalViewParams:(n={},n.sc=e&&e.sc||"",n)}))},e.prototype.getAllPhotosForPlaceUrl=function(e,t){var n;return this.getItemUrl(this.getKey(((n={}).id=t,n.locationFilter=e,n.qt="allmyphotos",n)),{page:o.e.Photos})},e.prototype.getSharedByQueryUrl=function(){var e;return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt="sharedby",e)),{page:o.e.Files}))},e.prototype.getSharedByYouQueryUrl=function(){var e,t=this.resources.consume(z.e);return this._requireAuthentication(this.getItemUrl(this.getKey(((e={}).qt=t?"sharedbyme":"sharedby",e)),{page:o.e.Files}))},e.prototype.getOneDriveAppsUrl=function(){return"https://g.live.com/8SESkyDrive/SkyDriveApps?biciid=lhnlink"},e.prototype.getOptionsUrl=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getNewManageStorageUrl()},e.prototype.getManageStorageUrl=function(){return this.getCurrentPageBaseUrl()+"/options/ManageStorage"},e.prototype.getPhotoPreferencesUrl=function(){var e,t=((e={}).v="photopreferences",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getManageVaultUrl=function(){var e,t=((e={}).v="ManageVault",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getTagPreferencesUrl=function(){var e,t=((e={}).v="tagpreferences",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getOfficeFileOptionsUrl=function(){var e;if(Object(m.isFeatureEnabled)(m.EnableVroomDocFormatSettings)&&Object(V.e)(A.H)){var t=((e={}).v="documentoptions",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/DocumentOptions"},e.prototype.getPhotosOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/PeopleOptions"},e.prototype.getUpgradeOptionsUrl=function(e,t){return this.getNewUpgradeOptionsUrl(e,this._navigation.viewParams,t)},e.prototype.getNotificationOptionsUrl=function(){var e,t=((e={}).v="NotificationOptions",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)},e.prototype.getDeviceBackupsOptionsUrl=function(){return this.getCurrentPageBaseUrl()+"/options/DeviceBackups"},e.prototype.getSearchOptionsUrl=function(){var e;if(Object(m.isFeatureEnabled)(m.EnableSearchHistorySettingInCob)&&Object(V.e)(A.H)){var t=((e={}).v="search",e),n="#"+_.n(t,null,!0);return this._requireAuthentication(n)}return this.getCurrentPageBaseUrl()+"/options/Search"},e.prototype.getNewManageStorageUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).ocid=e.ocid||e["WT.mc_id"],t.v="managestorage",t),a="#"+_.n(n,null,!0);return this._requireAuthentication(a)},e.prototype.getNewUpgradeOptionsUrl=function(e,t,n){return void 0===t&&(t=this._navigation.viewParams),Object(A.y)({wtcParam:e,viewParams:t,hideLeftNav:n})},e.prototype.getNewRestoreOptionsUrl=function(e,t){var n;void 0===t&&(t=this._navigation.viewParams);var a=((n={}).ocid=t.ocid||t["WT.mc_id"]||e,n.v="restore",n),i="#"+_.n(a,null,!0);return this._requireAuthentication(i)},e.prototype.getTaggingOptionsUrl=function(){return"/options/PeopleOptions"},e.prototype.getPeopleApiUrl=function(t){var n={prefix:t};return e.peopleBaseUrl+"/directory/search?"+_.n(n)},e.prototype.getUserInfoApiUrl=function(){return Object(j.e)()},e.prototype.setUserInfoApiUrl=function(){return Object(j.t)()},e.prototype.getPublishToWalgreensUrl=function(){return e.skyApiBaseUrl+"PublishToWalgreens"},e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=e.ownerId,a=this.getAuthKeyParamValue(t),i=this.getTicketParamValue(t),r=I.t.canary,o={cid:n,authKey:a,ticket:i,resid:e.id,canary:r};if(e.video){var s=Math.ceil((1.25*e.video.duration||0)/6e4);o.duration=Math.min(Math.max(1,s)+60,1440)}return this.getCurrentPageBaseUrl()+"/GetDownloadUrl?"+_.n(o,null,!0)},e.prototype.getEmbedInfoUrl=function(t){var n={id:t.id};return e.skyApiBaseUrl+"GetEmbedInfo?"+_.n(n,null,!0)},e.prototype.getEmbedPageUrl=function(e){var t={cid:e.ownerId,resid:e.id};return this.getCurrentPageBaseUrl()+"/embed?"+_.n(t,null,!0)},e.prototype.getPermissionsUrl=function(t,n){var a;void 0===n&&(n=this._navigation.viewParams);var i=this.getAuthKeyParamValue(n),r=((a={}).id=t.id,a);return i&&(r.authkey=i),e.skyApiBaseUrl+"GetPermissions?"+_.n(r)},e.prototype.getSearchQueryUrl=function(e,t){var n,a=e.query,i=e.dateFilter,r=e.conversationId,o=e.largestSize,s=e.filter;s||(s=Object(A.L)(this._navigation.viewParams)?g.t.photos:g.t.all);var c=((n={}).qt="search",n.q=a,n.searchsessionid=r,n.ft=A.t[g.t[s]],n);if("number"==typeof i&&i!==g.e.anyDate){var d=new Date,l=this._getDateDuration(i,d);c.df=q[q.DateCreated],c.beginDate=l.toISOString(),c.endDate=d.toISOString()}return o&&(c.sp="size"),this.getItemUrl(this.getKey(c),t)},e.prototype.getSearchFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:e,dateFilter:this.getAppliedDateFilter()})},e.prototype.isSearchFilterApplied=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getContextualFilter(t)===String(A.t[g.t[e]])},e.prototype.getSearchByDateFilterQueryUrl=function(e,t){return void 0===t&&(t=this._navigation.viewParams),this.getSearchQueryUrl({query:t.q,conversationId:t.searchsessionid,filter:g.t[String(A.t[this.getContextualFilter(t)])],dateFilter:e})},e.prototype.isSearchByDateFilterApplied=function(e){return this.getAppliedDateFilter()===e},e.prototype.getAutoActionType=function(e){if(this._useRefactoredDefaultClickUrl)return Object(A.r)(e);var t=e.action||"";return u.e[t.toLowerCase()]||u.t.none},e.prototype.getQueryParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.q},e.prototype.getCommentIdParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.commentId},e.prototype.getLayoutContentType=function(t){void 0===t&&(t=this._navigation.viewParams);var n=t.layout;return n&&e.contentTypeByLayoutType[n]},e.prototype.getItemTypeFilter=function(e){var t=[],n=Number(e.ft)||0;7==(7&n)&&t.push(D.e.folder),16==(16&n)&&t.push(D.e.document),8==(8&n)&&t.push(D.e.media);for(var a=0,i=(e.ext||"").split(";");a<i.length;a++){var r=i[a];t.push(r)}return{filters:t}},e.prototype.saveItemTypeFilter=function(e){return void 0===e&&(e={filters:[]}),Object(A.F)(e)},e.prototype.getUsersFilter=function(e){var t=e.userFilters;return t&&t.split(";#")},e.prototype.saveUsersFilter=function(e){var t={};return t.userFilters=e&&e.join(";#"),t},e.prototype.saveDateDurationFilter=function(e){return{}},e.prototype.getDateDurationFilter=function(e){return""},e.prototype.getIAmValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getFeedbackUrl=function(){return e.skyApiBaseUrl+"GetFeedBackUrl"},e.prototype.getCidFromResourceId=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(k.t)(e)},e.prototype.getCreateTextDocumentUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i={};i.id=t,i.cid=n,i.iam=this.getIAmParamValue(a),i.action=e.createTextDocumentActionValue,i.v="TextFileEditor";var r=_.n(i,null,!0);return this._getCurrentPageUrl(2,r)},e.prototype.getCreateDocumentInTabUrl=function(e,t,n,a){var i;void 0===a&&(a=this._navigation.viewParams);var r,o=this.getAuthKeyParamValue(a),s=this.getTicketParamValue(a),c=this.getIAmParamValue(a),d=a.qt,l=1===e.documentFormat?"odf":"",f=((i={}).cid=e.ownerId,i.wacqt=d||"",i.wdo=1,i);if(n){r="?",f.id=e.id;var p=void 0;switch(t){case"w":p=u.t.createWord;break;case"x":p=u.t.createExcel;break;case"p":p=u.t.createPowerPoint;break;case"n":p=u.t.createOneNote}f.action=p&&u.t[p].toLowerCase()||""}else r="/create.aspx?",f.parId=e.id,f.nd=t+l;return o&&(f.authkey=o),s&&(f.ticket=s),c&&(f.iam=c),r+_.n(f)},e.prototype.getDownloadItemUrl=function(e,t,n,a){if(void 0===a&&(a=this._navigation.viewParams),e.processFilters)return e.processFilters.thumbnailUrl;var i=this.getAuthKeyParamValue(a),r=this.getTicketParamValue(a),o=this.getIAmParamValue(a),s={cid:e.ownerId,authKey:i,ticket:r,iam:o,resid:e.id,canary:t,ithint:e.extension&&e.extension.toLowerCase(),open:n||void 0};return this.getCurrentPageBaseUrl()+"/download.aspx?"+_.n(s,null,!0)},e.prototype.getPrintPdfUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n=this.getAuthKeyParamValue(t),a=this.getTicketParamValue(t),i=this.getIAmParamValue(t),r=I.t.canary,o={cid:e.ownerId,authKey:n,ticket:a,iam:i,resid:e.id,canary:r,ithint:e.extension&&e.extension.toLowerCase(),open:1,serve:1};return this.getCurrentPageBaseUrl()+"/pdf?"+_.n(o,null,!0)},e.prototype.getVersionHistoryUrl=function(e,t,n){var a,r;void 0===n&&(n=this._navigation.viewParams);var o=this.getIAmParamValue(n),s=this.getAuthKeyParamValue(n),c=n.redeem,d=Object(i.__assign)(Object(i.__assign)({cid:e,resid:t,iam:o},s?((a={}).authkey=s,a):{}),$&&c?((r={}).redeem=c,r):{});return"/versions.aspx?"+_.n(d,null,!0)},e.prototype.getOpenInOfficeOnlineUrl=function(e,t,n){void 0===n&&(n={});var a,i=n.forceReadOnly,r=void 0!==i&&i,o=e.properties.commandsSupported,s=(void 0===o?{}:o).defc,c=e.openUrl;a=r?"view.aspx":"2"===s?"edit.aspx":"view.aspx";var d=(null==e?void 0:e.itemId)||(null==e?void 0:e.id);if(d){var l=new K.t("/".concat(a));l.setQueryParameter("resid",d);var u=this.getAuthKeyParamValue(t);u&&l.setQueryParameter("authkey",u);var f=t.redeem;if($&&f&&l.setQueryParameter("redeem",f),!A.e)for(var p in t)p.startsWith("wd")&&l.setQueryParameter(p,t[p]);return l.toString()}var m=Object(v.n)(e),h=c.indexOf("?")>0?"&":"?";return c.replace("redir.aspx",a).replace("download.aspx",a)+h+_.n({app:m,wdo:1,wacqt:t.qt},null,!0)},e.prototype.getOpenInOfficeClientUrl=function(e,t,n){var a,r,o;if(void 0===t&&(t=this._navigation.viewParams),!U.e.isActivated("C1567AF7-26C3-4CFC-A439-2A58F8558245","07/18/2022","open history file in office client")&&Object(V.e)(e.ownerId)){var s=null===(r=e.itemFromServer)||void 0===r?void 0:r.webDavUrl;return(null===(o=e.properties)||void 0===o?void 0:o.path)&&(s=e.properties.path),Object(G.e)(e.appMap,s,e.extension,!0,!1)}var c=this.getAuthKeyParamValue(t),d=this.getIAmParamValue(t),l=t.redeem,u=Object(i.__assign)({cid:n,resid:e.id,authKey:c,iam:d,autoRedirect:"false"},$&&l?((a={}).redeem=l,a):{});return this.getCurrentPageBaseUrl()+"/openinclient?"+_.n(u,null,!0)},e.prototype.getNewInOfficeClientUrl=function(e,t,n){return""},e.prototype.getDownloadAsZipIframeUrl=function(e,t){void 0===t&&(t=this._navigation.viewParams);var n={canary:e,iam:this.getIAmParamValue(t)};return this.getCurrentPageBaseUrl()+"/downloadasziplanding?"+_.n(n,null,!0)},e.prototype.getDownloadAsZipPostUrl=function(t,n,a){void 0===a&&(a=this._navigation.viewParams);var i=h.s(e.storageBaseUrl+"/downloadfiles/V1/Zip",t),r=a,o={authKey:r.authkey,ticket:r.ticket,iam:this.getIAmParamValue(r),application:n};return i+"?"+_.n(o,null,!0)},e.prototype.getOwnerId=function(t,n){return this.getKeyParams(t||this.getCurrentItemKey(n)).cid||e.viewerId},e.prototype.getSharedByUrl=function(e,t,n){var a,r;return this.getItemUrl(this.getKey(Object(i.__assign)(((a={}).qt="sharedby",a.id=e,a.cid=t,a),n?((r={}).groupId=n,r):{})))},e.prototype.getExternalUrl=function(t){var n=p[t];if(!n)throw new Error("Invalid external alias provided to fetch external url.");return this.getCurrentPageBaseUrl()+e.EXTERNAL_URL_FORMAT+n},e.prototype.getUploadStorageUrl=function(t,n){return"root"===t.id?h.s(e.storageBaseUrl,[t.ownerId])+"/MyCIDStuff/0x"+t.ownerId+"/LiveFolders/"+b.e.encodeURIComponent(n):h.s(e.storageBaseUrl,[t.uploadOwnerId])+"/items/"+t.id+"/"+b.e.encodeURIComponent(n)},e.prototype.getAppSubfolder=function(){return"odc"},e.prototype.getDefaultClickUrl=function(e,t){var n,a,c,l,p,h,b,g,v,y;void 0===t&&(t={});var S,D=t.viewParams,x=void 0===D?this._navigation.viewParams:D,C=t.itemSet,O=t.urlType,w=void 0===O?"default":O,L=t.preserveAction,P=void 0!==L&&L,T=t.action,B=void 0===T?P&&this.getAutoActionType(x)||void 0:T;if(!e||!e.key)return"";if(Object(m.isFeatureEnabled)(m.UpdateOdcVaultApiForConvergence)&&Object(V.e)(A.H)&&this.getQueryType(x)===s.e.Files&&(_.e(e.key).cid!==e.ownerId&&(e=Object(i.__assign)(Object(i.__assign)({},e),{key:_.n(Object(i.__assign)(Object(i.__assign)({},_.e(e.key)),(n={},n.cid=e.ownerId,n)))})),(null===(h=null===(p=e.itemFromServer)||void 0===p?void 0:p.remoteItem)||void 0===h?void 0:h.containingDrivePolicyScenarioViewpoint)&&(e=Object(i.__assign)(Object(i.__assign)({},e),{key:_.n((a={},a.mcid=_.e(e.key).cid,a.mid=_.e(e.key).id,a.cid=null===(b=e.graph)||void 0===b?void 0:b.driveId,a.id=null===(g=e.graph)||void 0===g?void 0:g.itemId,a))}))),x.sb&&(!this.isCurrentQuery(e.queryType,x)||(e=Object(i.__assign)(Object(i.__assign)({},e),{key:_.n(Object(i.__assign)(Object(i.__assign)({},_.e(e.key)),(c={},c.sb=x.sb,c.sd=x.sd,c)))}))),x.mcid&&this.getKeyParams(e.key).cid===(x.cid||x.parCid)&&(e=Object(i.__assign)(Object(i.__assign)({},e),{key:_.n(Object(i.__assign)(Object(i.__assign)({},_.e(e.key)),(l={},l.mcid=x.mcid,l.mid=x.mid,l)))})),this._useRefactoredDefaultClickUrl){var j=null===(y=null===(v=null==e?void 0:e.properties)||void 0===v?void 0:v.commandsSupported)||void 0===y?void 0:y.defc,z=C&&C.item.peek(),G=z&&z.key!==e.key&&z||e.UNSAFE_parent,K=G&&G.key,W=void 0;return j&&(W="1"===j),function(e){var t,n=e.urlType,a=void 0===n?"default":n,i=e.preserveAction,s=void 0!==i&&i,c=e.viewParams,l=e.itemInfo.itemType,p=e.action,m=void 0===p?s&&Object(A.r)(c)||void 0:p,h=function(e){var t;switch(e){case r.e.Media:t=f.focus;break;case r.e.Folder:case r.e.Error:t=f.current;break;default:t=f.external}return t}(l),b=!!U.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||l!==r.e.Media;c.mid&&b&&(h=f.current),t=l===r.e.Error?f.external:"existing"===a?function(e){return Object(A.l)(e)?f.focus:f.current}(c):"focus"===a||m?m&&m!==u.t.locate&&h===f.current?h:f.focus:h;var g=function(e,t){var n=t.itemInfo,a=t.parentItemInfo,i=t.viewParams,s=t.queryType,c=t.page,l=void 0===c?Object(A.S)(i):c,p=n.itemKey,m=n.itemExtension,h=n.itemType;if(e!==f.current&&l===o.e.FilePicker)return"";var b,g=Object(A.h)(p);if(Object(k.g)(s)&&!Object(k.g)(Object(A.C)(g)))return"";if(m&&Object(E.n)(m,h))e=l===o.e.TextFileEditor?f.external:f.focus;else if(l===o.e.TextFileEditor&&Object(A.r)(i)===u.t.createTextDocument)return"#"+_.n(i,null,!0);switch(e){case f.current:b=function(e){var t=e.itemInfo,n=e.preserveAction,a=e.action,i=e.viewParams,r=e.page,o=e.additionalViewParams,s=t.itemKey;if(t.itemIsStub){var c=Object(A.l)(i);if(c)return Object(A.r)(i)===u.t.locate?"":(delete i.viewer,N({itemInfo:{itemKey:c},parentItemInfo:t,action:u.t.locate,viewParams:i}))}return Object(A.m)({itemKey:s,itemInfo:t,preserveAction:n,action:a,viewParams:i,page:r,additionalViewParams:o})}(t);break;case f.focus:b=R(t);break;default:b=function(e){var t,n=e.itemInfo,a=e.viewParams,i=H({itemInfo:n,parentItemInfo:e.parentItemInfo}),o=n.itemKey,s=n.openItemByDefault,c=n.itemExtension,l=n.itemType,f=n.itemErrorType,p=n.itemOpenUrl;return t=l===r.e.Error?function(e){var t,n=e.itemKey,a=e.viewParams;switch(e.itemErrorType||d.e.requestFailed){case d.e.marketBlocked:return Object(A.g)();case d.e.userNotReady:return Object(A.T)(Object(A.m)({itemKey:n,viewParams:a}));case d.e.accessDenied:var i=a.lor;return i&&i.toLowerCase()===M.a?"?".concat("v","=").concat("error","&").concat("type","=").concat(M.n):Object(A.U)(Object(A.m)({itemKey:n,viewParams:a,additionalViewParams:(t={},t.sc=a.sc||"",t)}));case d.e.authenticationExpired:return Object(A.U)(Object(A.m)({itemKey:n,viewParams:a}),!0);case d.e.userSuspended:var r=Object(A.r)(a)===u.t.feedback?u.t.feedback:void 0;return I.t.si?Object(A.U)(Object(A.m)({itemKey:n,viewParams:a,action:r}),!0):Object(A.m)({itemKey:n,action:r,viewParams:a});case d.e.passwordRequired:return Object(A.A)(a);case d.e.requestAccess:return Object(A.O)(a)}return Object(A.m)({itemKey:n,viewParams:a})}({itemKey:o,viewParams:a,itemErrorType:f}):c&&Object(E.n)(c,l)?F({itemInfo:n,parentItemInfo:i,viewParams:a}):void 0===s||s?s&&p&&-1===p.indexOf("redir.aspx")||c&&(".fluid"===c.toLowerCase()||".loop"===c.toLowerCase())?p:R({itemInfo:n,parentItemInfo:i,action:u.t.locate,viewParams:a}):R({itemInfo:n,parentItemInfo:i,action:u.t.defaultClick,viewParams:a}),t}({itemInfo:n,parentItemInfo:a,viewParams:i})}return b}(t,e);return g}({itemInfo:{itemKey:e.key,itemIsStub:e.isStub,itemIsPlaceholder:e.isPlaceholder,itemIsPhoto:!!e.photo,itemIsVideo:!!e.video,itemVirtualItemType:e.virtualItemType,itemExtension:e.extension,itemType:e.type,itemOpenUrl:e.openUrl,itemErrorType:e.error&&e.error.type,openItemByDefault:W},parentItemInfo:G&&{itemKey:K,itemIsAlbum:G.isAlbum,itemIsPlaceholder:G.isPlaceholder,itemIsStub:G.isStub,itemVirtualItemType:G.virtualItemType,itemExtension:G.extension,itemType:G.type,itemOpenUrl:G.openUrl,itemErrorType:G.error&&G.error.type},preserveAction:P,action:B,viewParams:x,page:t.page,queryType:e.queryType,additionalViewParams:t.additionalViewParams,urlType:w})}var q=this._getDefaultUrlFormat(e),Q=!!U.e.isActivated("CBF950BB-C412-4331-9430-066677E49966","10/21/2021","Compute OneUp URL for media items in mount points")||e.type!==r.e.Media;return x.mid&&Q&&(q=f.current),S=e.type===r.e.Error?f.external:"existing"===w?this._getCurrentUrlFormat(x):"focus"===w||B?B&&B!==u.t.locate&&q===f.current?q:f.focus:q,this._getItemClickUrl(e,C,S,t)},e.prototype.getTagUrl=function(e){var t,n;return n=e.localizedTag&&e.localizedTag!==e.tag?"".concat(e.localizedTag,";").concat(e.tag):e.tag,this._requireAuthentication(this.getItemUrl(this.getKey(((t={}).qt="allmyphotos",t.tagFilter=n,t)),{page:o.e.Photos}))},e.prototype.getAuthenticateUrl=function(e){if(this._useRefactoredDefaultClickUrl)return Object(A.i)(e);var t=I.t.signInUrl;return window.location.href.indexOf("iam=")>-1?(t+="&redirect_uri={0}",e=this.getCurrentPageBaseUrl()+"/business"):t+="&ru={0}&wreply={0}",h.s(t,b.e.encodeURIComponent(e||window.location.href))},e.prototype.getLanguageWithAuthenRedirectUrl=function(){return Object(A.b)()},e.prototype.getRootUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return this.getCurrentPageBaseUrl()+"?"+_.n(n,null,!0)},e.prototype.getCurrentSiteUrl=function(){return window.location.href},e.prototype.getCurrentPageBaseUrl=function(){return window.location.protocol+"//"+window.location.host},e.prototype.getMarketBlockedUrl=function(){return this._useRefactoredDefaultClickUrl?Object(A.g)():this.getCurrentPageBaseUrl()+"/marketblockerror.aspx"},e.prototype.getValidatePermissionUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(A.A)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="validatepermission",this.getCurrentPageBaseUrl()+"?"+_.n(e,null,!0)},e.prototype.getRequestAccessUrl=function(){if(this._useRefactoredDefaultClickUrl)return Object(A.O)(this._navigation.viewParams);var e={};return e.id=this._navigation.viewParams.id,e.challengeToken=this._navigation.viewParams.authkey,e.v="requestaccess",this.getCurrentPageBaseUrl()+"?"+_.n(e,null,!0)},e.prototype.handleFatalErrorDuringViewLoad=function(){0===document.cookie.indexOf("sr=3")||document.cookie.indexOf("; sr=3")>-1?this._setFatalErrorCookie(0,!0):0===document.cookie.indexOf("sr=2")||document.cookie.indexOf("; sr=2")>-1?(this._setFatalErrorCookie(3,!1),window.top.location=document.location.href):0===document.cookie.indexOf("sr=")||document.cookie.indexOf("; sr=")>-1?(this._setFatalErrorCookie(2,!1),location.reload(!0)):(this._setFatalErrorCookie(1,!1),window.top.location=document.location.href)},e.prototype.getForceLoginDownloadUrl=function(e){var t="https://"+location.host+"?"+this.getDefaultClickUrl(e.UNSAFE_parent).substring(1);return this.getAuthenticateUrl(t)},e.prototype.getItemUrl=function(e,t){if(void 0===t&&(t={}),this._useRefactoredDefaultClickUrl){var n=t.viewParams,a=void 0===n?this._navigation.viewParams:n,r=t.item;return Object(A.m)(Object(i.__assign)(Object(i.__assign)({},t),{itemKey:e,itemInfo:r&&{itemKey:r.key,itemIsPlaceholder:r.isPlaceholder,itemVirtualItemType:r.virtualItemType,itemExtension:r.extension,itemType:r.type},viewParams:a}))}var o=this._getItemQueryParams(e,t),s=t.additionalViewParams;return s&&s.sc?Object(T.e)(o,s):delete o.sc,"#"+_.n(o,null,!0)},e.prototype.getSuiteNavConfigUrl=function(e){var t;void 0===e&&(e=this._navigation.viewParams);var n=((t={}).iam=this.getIAmParamValue(e),t);return"/getsuitenavconfig?"+_.n(n,null,!0)},e.prototype.getApiName=function(){return"Vroom"},e.prototype.getApiBaseUrl=function(t){return e.getVroomBaseUrl(t)},e.prototype.getAppliedDateFilter=function(e){var t;if(void 0===e&&(e=this._navigation.viewParams),!e.df)return g.e.anyDate;var n=(Date.parse(e.endDate)-Date.parse(e.beginDate))/864e5;switch(Math.floor(n)){case 1:t=g.e.oneDay;break;case 30:t=g.e.oneMonth;break;case 7:t=g.e.oneWeek;break;case 365:t=g.e.oneYear}return t},e.prototype.getResourcePreloadUrl=function(){return"/preload?manifest=wac"},e.prototype.getHipCheckUrl=function(){return"https://mail.".concat(Q?"live-int":"live",".com/?rru=hip")},e.prototype.getVerifyAccountUrl=function(){return"https://g.live.com/8SESkydrive/VerifyAccount"},e.prototype.isSearchPassThrough=function(e){return void 0===e&&(e=this._navigation.viewParams),!!e.sp},e.prototype.isLargestFilesView=function(e){return void 0===e&&(e=this._navigation.viewParams),"size"===e.sp},e.prototype.getNavLinkClickUrl=function(e){return""},e.prototype.qualifyUrl=function(e){return this._useRefactoredDefaultClickUrl?Object(A.T)(e):(0===e.indexOf("#")&&(e=this._getCurrentPageUrl(2,e.substring(1))),e)},e.prototype.getSignInUrlWithAction=function(e,t){var n=t||I.t.si;if(!n)return"";var a=y.t(n),i=_.e(a),r=i.wreply,o=y.t(r),s=_.e(o);return s.action=u.t[e],i.wreply="".concat(y.n(r),"?").concat(_.n(s)),"".concat(y.n(n),"?").concat(_.n(i))},e.prototype.getNewPlaceholderItemKey=function(){var t;return _.n(((t={}).id="placeHolder ".concat(e.placeholderId++),t))},e.prototype.getIAmParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.iam},e.prototype.getAuthKeyParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(A.a)(e)},e.prototype.getTicketParamValue=function(e){return void 0===e&&(e=this._navigation.viewParams),e.ticket},e.prototype.getReferrer=function(e){return void 0===e&&(e=this._navigation.viewParams),e.referrer},e.prototype.getContextualFilter=function(e){return void 0===e&&(e=this._navigation.viewParams),this._useRefactoredDefaultClickUrl?Object(k.n)(e):e.ft},e.prototype.getMyRestorePageUrl=function(){return Promise.resolve("")},e.prototype.getTextEditorItemUrl=function(e,t){var n=t.parentItem,a=t.viewParams;if(this._useRefactoredDefaultClickUrl)return F({itemInfo:{itemKey:e.key,itemExtension:e.extension,itemType:e.type},parentItemInfo:n&&{itemKey:n.key},viewParams:a});var i=this._getItemQueryParams(e.key,{item:e,page:o.e.TextFileEditor,viewParams:a}),r=n||e.UNSAFE_parent,s=this.getKeyParams(r&&r.key||"");i.parId=s.id;var c=_.n(i,null,!0);return"TextFileEditor"!==a.v?this._getCurrentPageUrl(2,c):"#"+c},e.prototype.getQueryUrl=function(e,t){return this._requireAuthentication(this.getItemUrl(this.getRootItemKey(t),{page:e}))},e.prototype.getMpcOneDriveUrl=function(){return"".concat(X,"/personal/").concat(e.viewerId,"/_layouts/15/onedrive.aspx")},e.prototype._getItemQueryParams=function(e,t){var n=void 0===t?{}:t,a=n.item,r=n.page,o=n.action,d=n.preserveAction,f=void 0!==d&&d,p=n.viewParams,m=void 0===p?this._navigation.viewParams:p,_=this.getKeyParams(e),h=Object(i.__assign)({},_),b=Object(A.x)(m);void 0!==r&&(b.v=this._getPageParamValue(r,m));var g=!1,v=Object(E.a)(null==a?void 0:a.extension,null==a?void 0:a.type);if(a&&!a.isPlaceholder)switch("TextFileEditor"===b.v&&(v||(b.v="")),a.virtualItemType){case l.e.Album:case l.e.AlbumRoot:case l.e.Tag:case l.e.TagsRoot:b.v="photos",g=!0}else switch(h.id){case"tags":case"places":case"albums":b.v="photos",g=!0}"allmyphotos"===_.qt&&(h.v="photos",g=!0,"true"!==_.onThisDay&&"true"!==_.onThisMonth&&"true"!==_.lastWeekPreviousYears||(m&&m.startDate&&(h.startDate=m.startDate),m&&m.cid&&(h.cid=m.cid))),"photostream"===_.qt&&(h.v="photoStream",h.psShareId=m.psShareId);var y=this.getQueryType(_);v||!a||g||y===s.e.Search||y===s.e.AllMyPhotos||y===s.e.PhotoStream||(h.v=""),!v&&Object(c.e)(y)&&("photos"!==b.v&&"photoStream"!==b.v||this.getContextualFilter(_)!==A.t.photos.toString())&&(h.v=""),this._isFilePickerPage(b.v)&&(h.v=b.v),delete h.u;var S=this.getAutoActionType(m);return o?h.action=o&&u.t[o]&&u.t[o].toLowerCase()||"":f&&S&&(S===u.t.showProperties&&h.o||(h.action=u.t[S].toLowerCase())),Object(T.e)(b,h),b},e.prototype._getDateDuration=function(e,t){var n=new Date(t.toString())||new Date;switch(e){case g.e.oneDay:n.setDate(n.getDate()-1);break;case g.e.oneMonth:n.setDate(n.getDate()-30);break;case g.e.oneWeek:n.setDate(n.getDate()-7);break;case g.e.oneYear:n.setDate(n.getDate()-365)}return n},e.prototype._setFatalErrorCookie=function(e,t){var n="sr="+e+"requireDeps;path=/;domain="+window.$Config.urlHost+";";t&&(n+="expires="+new Date(2e3,1,1).toUTCString()+";"),document.cookie=n},e.prototype._getCurrentUrlFormat=function(e){return void 0===e&&(e=this._navigation.viewParams),this.getFocusItemKey(e)?f.focus:f.current},e.prototype._getDefaultUrlFormat=function(e){var t;switch(e.type){case r.e.Media:t=f.focus;break;case r.e.Folder:case r.e.Error:t=f.current;break;default:t=f.external}return t},e.prototype._getItemClickUrl=function(e,t,n,a){var i=a.viewParams,r=void 0===i?this._navigation.viewParams:i,s=a.page,c=void 0===s?this.getPageType(r):s;if(n!==f.current&&c===o.e.FilePicker)return"";var d,l=this.getKeyParams(e.key);if(this.isRecycleBin(e.queryType)&&!this.isRecycleBin(this.getQueryType(l)))return"";if(Object(E.a)(e.extension,e.type))n=c===o.e.TextFileEditor?f.external:f.focus;else if(c===o.e.TextFileEditor&&this.getAutoActionType(r)===u.t.createTextDocument)return"#"+_.n(r,null,!0);switch(n){case f.current:d=this._getCurrentItemUrl(e,a);break;case f.focus:d=this._getFocusItemUrl(e,t,a);break;default:d=this._getDefaultItemUrl(e,{itemSet:t,viewParams:r})}return d},e.prototype._getCurrentItemUrl=function(e,t){var n=void 0===t?{}:t,a=n.preserveAction,i=n.action,r=n.viewParams,o=void 0===r?this._navigation.viewParams:r,s=n.page,c=n.additionalViewParams;if(e.isStub){var d=this.getFocusItemKey(o);if(d)return this.getAutoActionType(o)===u.t.locate?"":this._getFocusItemUrlFromKey(d,e,{action:u.t.locate,viewParams:o})}return this.getItemUrl(e.key,{item:e,preserveAction:a,action:i,viewParams:o,page:s,additionalViewParams:c})},e.prototype._getFocusItemUrl=function(t,n,a){var i,r=this._getParentItem(t,n),o=!!a.viewParams&&Boolean("photos"===a.viewParams.v&&(t.video||t.photo)&&"allmyphotos"!==a.viewParams.qt&&!a.viewParams.parId&&!a.viewParams.parQt&&r&&!r.isAlbum),s={key:this.getKey((i={},i.qt="allmyphotos",i.id="root",i.cid=e.viewerId,i))};return this._getFocusItemUrlFromKey(t.key,o?s:r,a)},e.prototype._getFocusItemUrlFromKey=function(t,n,a){var i=void 0===a?{}:a,r=i.preserveAction,o=void 0!==r&&r,s=i.action,c=i.viewParams,d=void 0===c?this._navigation.viewParams:c,l=i.additionalViewParams,u=n&&n.key||"",f=this.getKeyParams(t),p=this._getItemQueryParams(u,{item:n,preserveAction:o,action:s,viewParams:d});d&&d.commentId&&(f.commentId=d.commentId),f.parId=p.id,f.parQt=p.qt,f.cid!==p.cid&&(f.parCid=p.cid,delete p.cid),delete p.internalPath,delete p.qt,delete p.id,delete f.u;var m=p.action;return m?d&&d.commentId&&"showproperties"===m.toLowerCase()?(delete p.action,f.o=e.oneUpOverlayValue):(delete p.action,f.action=m):f.o=e.oneUpOverlayValue,l&&Object(T.e)(f,l),"#"+_.n(f,p,!0)},e.prototype._getPageParamValue=function(e,t){var n,a=t.v;switch(e){case o.e.FilePicker:n=this._isFilePickerPage(a)?a:"FilePickerView";break;case o.e.TextFileEditor:n="TextFileEditor";break;case o.e.Photos:n="photos";break;case o.e.RansomwareDetection:n="RansomwareDetection";default:case o.e.Files:}return n},e.prototype._getErrorItemUrl=function(t,n){var a;switch(void 0===n&&(n=this._navigation.viewParams),t&&t.error&&t.error.type||d.e.requestFailed){case d.e.marketBlocked:return this.getMarketBlockedUrl();case d.e.userNotReady:return this.qualifyUrl(this.getItemUrl(t.key));case d.e.accessDenied:var i=n.lor;return i&&i.toLowerCase()===e.linkOriginParamValue?"?".concat("v","=").concat("error","&").concat("type","=").concat(e.linkNotSupportedParamValue):this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,additionalViewParams:(a={},a.sc=n.sc||"",a)}));case d.e.authenticationExpired:return this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n}),!0);case d.e.userSuspended:var r=this.getAutoActionType(n)===u.t.feedback?u.t.feedback:void 0;return I.t.si?this._requireAuthentication(this.getItemUrl(t.key,{viewParams:n,action:r}),!0):this.getItemUrl(t.key,{action:r});case d.e.passwordRequired:return this.getValidatePermissionUrl();case d.e.requestAccess:return this.getRequestAccessUrl()}return this.getItemUrl(t.key)},e.prototype._getDefaultItemUrl=function(e,t){var n,a,i=void 0===t?{}:t,o=i.itemSet,s=i.viewParams,c=void 0===s?this._navigation.viewParams:s,d=this._getParentItem(e,o);if(e.type===r.e.Error)a=this._getErrorItemUrl(e,c);else if(Object(E.a)(e.extension,e.type))a=this.getTextEditorItemUrl(e,{parentItem:d,viewParams:c});else{var l=null===(n=null==e?void 0:e.properties)||void 0===n?void 0:n.commandsSupported,f=(null==l?void 0:l.defc)||"";a=f&&"1"!==f?this._getFocusItemUrl(e,o,{action:u.t.defaultClick,viewParams:c}):"1"===f&&e.openUrl&&(-1===e.openUrl.indexOf("redir.aspx")||e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase()))?e.openUrl:this._getFocusItemUrl(e,o,{action:u.t.locate,viewParams:c})}return a},e.prototype._getCurrentPageUrl=function(t,n){if(this._useRefactoredDefaultClickUrl)return Object(A.c)(t,n);var a=[];switch(a.push(this.getCurrentPageBaseUrl()),t){case 0:a.push("/");break;case 1:a.push(e.nextSiteUrlPrefix);break;default:a.push(this._getCurrentUrlPathName())}return a.push("?"),a.push(n),a.join("")},e.prototype._getCurrentUrlPathName=function(){return this._useRefactoredDefaultClickUrl?Object(A.d)():window.location.pathname},e.prototype._isFilePickerPage=function(e){var t;switch(e){case"FilePickerView":case"2":case"FolderPickerView":case"1":case"pickerconsent":t=!0;break;default:t=!1}return t},e.prototype._requireAuthentication=function(e,t){return void 0===t&&(t=!1),this._useRefactoredDefaultClickUrl?Object(A.U)(e,t):t||I.t.si?this.getAuthenticateUrl(this.qualifyUrl(e)):e},e.prototype._getParentItem=function(e,t){var n=t&&t.item.peek();return n&&n.key!==e.key&&n||e.UNSAFE_parent},e.dependencies={navigation:w.e,useRefactoredDefaultClickUrl:ne,enableFastOneUp:ae},e.oneUpOverlayValue=M.r,e.EXTERNAL_URL_FORMAT="/externalredirector?alias=",e.skyApiBaseUrl=Y+"/API/2/",e.viewerId=A.H,e.storageBaseUrl=J,e.feedbackBaseUrl="https://cid-{0}.users.storage.live.com",e.tagsFeedbackBaseUrl="https://storage.live.com",e.peopleBaseUrl="https://people.onedrive.com",e.nextSiteUrlPrefix=M.i,e.scenarioName="odweb",e.locateActionName="locate",e.linkOriginParamValue="shorturl",e.linkNotSupportedParamValue="linknotsupported",e.createTextDocumentActionValue="createTextDocument",e.contentTypeByLayoutType=((B={}).photo=S.n,B.list=S.t,B.grid=S.e,B),e.placeholderId=0,e}(),re=(t.e=ie,Object(C.r)("UrlDataSource",ie))},,function(e,t,n){"use strict";var a=function(){function e(t){this.id="".concat(++e._lastId),this.name=t}return e.prototype.matches=function(e){return e===this},e._lastId=0,e}();t.e=a},function(e,t,n){"use strict";n.d(t,"t",function(){return l});var a=n(0),i=n(7),r=n(6),o=n(66),s=function(e){function t(t,n){var a=e.call(this,t)||this;return a._commandDataSource=n.itemCommandDataSource,a}return Object(a.__extends)(t,e),t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemCommandDataSource:r._}),t}(i.n),c=Object(o.r)("ItemCommandProvider",s),d=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.itemCommandProvider,r=void 0===i?a.resources.consume(c):i;return a._itemCommandProvider=r,a}return Object(a.__extends)(t,e),t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)},t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,a=n&&n.getCommand(e,t);return a&&a.behavior},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemCommandProvider:c}),t}(i.n),l=(t.e=d,Object(o.r)("ItemCommandHelper",d))},,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return i}),function(e){e[e.none=0]="none",e[e.locate=1]="locate",e[e.defaultClick=2]="defaultClick",e[e.download=3]="download",e[e.share=4]="share",e[e.sharing=5]="sharing",e[e.sendSurvey=6]="sendSurvey",e[e.createTextDocument=7]="createTextDocument",e[e.createWord=8]="createWord",e[e.createExcel=9]="createExcel",e[e.createExcelForm=10]="createExcelForm",e[e.createPowerPoint=11]="createPowerPoint",e[e.createOneNote=12]="createOneNote",e[e.openInExcel=13]="openInExcel",e[e.openInWord=14]="openInWord",e[e.openInPowerPoint=15]="openInPowerPoint",e[e.openInOneNote=16]="openInOneNote",e[e.openInVisio=17]="openInVisio",e[e.openInProject=18]="openInProject",e[e.openInPublisher=19]="openInPublisher",e[e.openInOffice=20]="openInOffice",e[e.embed=21]="embed",e[e.reportAbuse=22]="reportAbuse",e[e.addToShared=23]="addToShared",e[e.editBrowser=24]="editBrowser",e[e.feedback=25]="feedback",e[e.versionHistory=26]="versionHistory",e[e.showProperties=27]="showProperties",e[e.edit=28]="edit",e[e.editNew=29]="editNew"}(a||(a={}));var i={};for(var r in a)if("number"==typeof a[r]){var o=r,s=a[o];i[o.toLowerCase()]=s}t.t=a},,function(e,t,n){"use strict";var a;!function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare"}(a||(a={}));var i=a;t.e=i},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"o",function(){return d}),n.d(t,"c",function(){return l}),n.d(t,"u",function(){return f}),n.d(t,"f",function(){return p}),n.d(t,"l",function(){return m}),n.d(t,"d",function(){return _}),n.d(t,"v",function(){return h}),n.d(t,"S",function(){return b}),n.d(t,"y",function(){return g}),n.d(t,"_",function(){return v}),n.d(t,"h",function(){return y}),n.d(t,"m",function(){return S}),n.d(t,"g",function(){return D}),n.d(t,"b",function(){return I}),n.d(t,"t",function(){return x}),n.d(t,"n",function(){return C}),n.d(t,"i",function(){return O}),n(111);var a=n(197),i=n(5),r=n(42);n.d(t,"s",function(){return r.a}),n.d(t,"r",function(){return r.n}),n.d(t,"p",function(){return r.r}),n.d(t,"D",function(){return r.s});var o=n(38);function s(e){var t,n=Object(r.i)(),i=2===Object(a.e)()?"storage.live-int.com":"onedrive.live.com";return t="https://".concat(n).concat(i,"/redir?resid=").concat(e),"u!".concat(window.btoa(t).replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_"))}function c(e){return void 0===e&&(e="v1.0"),"https://graph.microsoft.com/".concat(e)}function d(){return"https://substrate.office.com"}function l(){return"/picker/accountchooser"===document.location.pathname.toLowerCase()}function u(e){return"photos"===e.v}function f(e){return"places"===e.id&&u(e)}function p(e){return"tags"===e.id&&u(e)}function m(e){return"allmyphotos"===e.qt||"allmyphotos"===e.parQt}function _(e){return"albums"===e.id&&u(e)}function h(e){return!!e.id&&"albums"!==e.id&&"tags"!==e.id&&"places"!==e.id&&!!e.cid&&u(e)&&!m(e)}function b(e){return m(e)&&!!e.tagFilter&&u(e)}function g(e){return!!e.locationFilter&&u(e)}function v(e){return!!e.onThisDay&&u(e)}function y(e){return!!e.onThisMonth&&u(e)}function S(e){return!!e.lastWeekPreviousYears&&u(e)}function D(e){return e===i.e.RecycleBin}function I(e){return"upgrade"===e.v}function x(e){var t=e.id;if(t){var n=t.indexOf("!");if(n>-1)return t.slice(0,n)}}function C(e){return e.ft}function O(e,t){return!(!e||!t)&&Object(o.e)(e)&&(t.toUpperCase().startsWith(e.toUpperCase())||t.indexOf("!")<0)}},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"a",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"i",function(){return d});var a,i,r=n(31),o=n(134);function s(){return{CorrelationId:o.e.generate(),MessageId:i.GrabFocus}}function c(){return{CorrelationId:o.e.generate(),MessageId:i.BlurFocus}}function d(e){var t;return function(n,a,i){return t?t(n,a,i):r.n.resolve(e()).then(function(e){return(t=e)(n,a,i)})}}!function(e){e.App_LoadingStatus="App_LoadingStatus",e.SetOverlayContent="SetOverlayContnet",e.UI_CheckUserAccessAndGrantPermissions="UI_CheckUserAccessAndGrantPermissions",e.GetAccessToken="GetAccessToken",e.App_GetCustomAuthConfig="App_GetCustomAuthConfig",e.App_RefreshSessionInfo="App_RefreshSessionInfo",e.File_Rename="File_Rename",e.UI_CopyAndEdit="UI_CopyAndEdit",e.App_WopiInfoFromUrl="App_WopiInfoFromUrl",e.Edit_Notification="Edit_Notification",e.UI_FileEmbed="UI_FileEmbed",e.UI_ShareForm="UI_ShareForm",e.UI_SignIn="UI_SignIn",e.User_Activity="User_Activity",e.App_WopiDavUrlFromIds="App_WopiDavUrlFromIds",e.UI_FileVersions="UI_FileVersions",e.UI_FileProperties="UI_FileProperties",e.App_PushState="App_PushState",e.App_SwitchMode="App_SwitchMode",e.UI_Sharing="UI_Sharing",e.App_MoveToFolder="App_MoveToFolder",e.App_FilePicker="App_FilePicker"}(a||(a={})),function(e){e.BlurFocus="BlurFocus",e.Host_AccessibilityLoopComplete="Host_AccessibilityLoopComplete",e.GrabFocus="GrabFocus",e.CanEmbed="CanEmbed",e.PostAccessToken="PostAccessToken",e.App_PopState="App_PopState",e.Host_RefreshSessionInfo="Host_RefreshSessionInfo",e.CheckUserAccessAndGrantPermissions_Result="CheckUserAccessAndGrantPermissions_Result",e.Host_WopiInfoFromUrl="Host_WopiInfoFromUrl",e.Host_DavUrlFromIds=" Host_DavUrlFromIds",e.Host_SetCustomAuthConfig="Host_SetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.Host_PerfTiming="Host_PerfTiming",e.Host_PostmessageReady="Host_PostmessageReady",e.Host_MoveToFolder="Host_MoveToFolder",e.Host_FilePicker="Host_FilePicker"}(i||(i={}))},,function(e,t,n){"use strict";var a=n(527);n.d(t,"e",function(){return a.e})},function(e,t,n){"use strict";var a=n(0),i=n(122),r=function(e){function t(t){void 0===t&&(t={});var n,a=e.call(this,t)||this;return n=a.useGlobalResources()?a.resources.consume(i.t):a.managed(i.e),a._loader=new n({path:a.getExecutorPath(),getModule:a.getModuleFactory(),getExecutorParams:function(){return a.selectionHelper.resolveSelection().then(function(e){return a.getExecutorParameters({selection:e})})}}),a}return Object(a.__extends)(t,e),t.prototype.useGlobalResources=function(){return!1},t.prototype.onExecute=function(e,t){return this._loader.execute(e,t)},t}(n(511).e);t.e=r},,,function(e,t,n){"use strict";var a=n(31),i=n(19),r=n(136),o=n(219),s=n(379),c=n(41),d=n(157),l=n(220),u=n(262),f=n(4),p=Object(f.es)(f.ne),m=function(){function e(){}return e.prototype.canHandleRequest=function(e){return e.indexOf("storage.live.com")>-1},e.prototype.handleRequest=function(e,t){var n=new d.e(t);if(p)this._bypassProxy(n,e);else{var a=this._getProxy(e.url);e.useDefaultHeaders=!0;var i=Object(l.t)(e,function(e){n.complete(e)});a.createRequest(i)}return n.getPromise()},e.prototype._getProxy=function(e){var t=new c.t(e);return this._xmlProxy||(this._xmlProxy=new u.e({source:t.getScheme()+"://"+t.getHost()+"/xmlproxy.htm?domain="+document.domain})),this._xmlProxy},e.prototype._bypassProxy=function(e,t){var n;this._basicRequestor||(this._basicRequestor=new o.e),t.disableLogging||(n=new r.e({url:t.url,name:t.qosName||"BaseStorageRequest."+t.apiName})),t.withCredentials=!0,this._basicRequestor.handleRequest(t,function(){null==n||n.end({resultType:i.t.ExpectedFailure}),e.cancel()}).then(function(t){e.complete(t),null==n||n.end({resultType:i.t.Success})},function(t){e.error(t),null==n||n.end({resultType:i.t.Failure})})},e}(),_=Object(f.es)(f.ne),h=function(){function e(){this._xmlProxies={}}return e.prototype.canHandleRequest=function(e){return e.indexOf(".users.storage.live.com")>-1},e.prototype.handleRequest=function(e,t){var n=new d.e(t);if(_)this._bypassProxy(n,e);else{var a=this._getProxy(e.url);e.useDefaultHeaders=!0;var i=Object(l.t)(e,function(e){n.complete(e)});a.createRequest(i)}return n.getPromise()},e.prototype._getProxy=function(e){var t=new c.t(e),n=t.getHost();return this._xmlProxies[n]||(this._xmlProxies[n]=new u.e({source:t.getScheme()+"://"+t.getHost()+"/xmlproxy.htm?domain="+document.domain})),this._xmlProxies[n]},e.prototype._bypassProxy=function(e,t){var n;this._basicRequestor||(this._basicRequestor=new o.e),t.disableLogging||(n=new r.e({url:t.url,name:t.qosName||"StorageRequest."+t.apiName})),t.withCredentials=!0,this._basicRequestor.handleRequest(t,function(){null==n||n.end({resultType:i.t.ExpectedFailure}),e.cancel()}).then(function(t){e.complete(t),null==n||n.end({resultType:i.t.Success})},function(t){e.error(t),null==n||n.end({resultType:i.t.Failure})})},e}(),b=n(250),g=[{Constructor:s.t},{Constructor:h},{Constructor:m},{Constructor:o.e}],v=function(){function e(){}return e.prototype.send=function(e){return y(e)},e.prototype.sendPost=function(e,t,n){return y({apiName:e,url:t,requestType:"POST",postData:n})},e.prototype.sendPostUrlEncoded=function(e,t,n){return y({apiName:e,url:t,requestType:"POST",postData:n,headers:{"Content-Type":"application/x-www-form-urlencoded;"}})},e}();function y(e){var t;if(e.requestType=e.requestType||"GET",!e.disableLogging){var n=e.url;n=n&&n.replace(/authkey=[^&]+&?/gi,""),t=new r.e({url:n,name:e.qosName||"DataRequest."+e.apiName})}var o,s=function(e){for(var t=0,n=g;t<n.length;t++){var a=n[t];if(a.instance||(a.instance=new a.Constructor),a.instance.canHandleRequest(e.url))return a.instance}}(e),c=s.getHandlerContentWindow&&s.getHandlerContentWindow(),d=(o=c||window)&&o.performance||void 0,l=d&&d.now();return s.handleRequest(e,function(){t&&t.end({resultType:i.t.ExpectedFailure})}).then(function(n){if(!e.returnRawXHR)return function(e){var t,n=e.data,r=e.apiEvent;if(!n||0===n.status)return r.end({error:"Unkown client side request error (status code 0)",resultType:i.t.ExpectedFailure}),a.n.reject({message:"Promise failed with empty error response",url:n&&n.responseURL||"",status:0,data:void 0});if(200===n.status||201===n.status){var o=JSON.parse(n.responseText);return r&&r.end({resultType:i.t.Success}),o}var s="",c="";try{var d=JSON.parse(n.responseText);t=d&&d.error||d,s=d&&d.transactionId||"",c=n.getResponseHeader("MS-CV")||""}catch(e){t={message:n.responseText}}var l=t,u=t&&t.items;if(u)for(var f=0,p=u;f<p.length;f++){var m=p[f];if(m.error){l=m.error;break}}l||(l={}),l.transactionId=s,l.msCorrelationVector=c;var _={errorCode:l&&l.code||"",errorTitle:""},h=e.isErrorExpectedCallback&&e.isErrorExpectedCallback(_);return r&&function(e,t,n,a){var r={resultCode:n&&n.code||"",resultType:a?i.t.ExpectedFailure:i.t.Failure,extraMetrics:{httpStatus:e.status,httpStatusText:e.statusText}};if(n&&n.items)for(var o=0,s=n.items;o<s.length;o++){var c=s[o];if(c.error){n=c.error;break}}n&&(r.error=n.debugMessage||n.message,r.extraData={stack:n.stackTrace,isExpected:n.isExpected,transactionId:n.transactionId,msCorrelationVector:n.msCorrelationVector}),t.end(r)}(n,r,l,h),a.n.reject({message:"Promise failed without error handler",url:n.responseURL||"",status:n.status,data:t})}({data:n,apiEvent:t,isErrorExpectedCallback:e.isErrorExpectedCallback});var r=Object(b.e)(e.url,l,c);return t&&t.end({resultType:i.t.Success,extraData:{rawRequestDuration:r.duration,performanceEntry:JSON.stringify(r)}}),n},function(n){if(n&&n.isProxyFailure)return t.end({error:n.message,resultType:i.t.ExpectedFailure}),a.n.reject(n.message);if(t){var r=Object(b.e)(e.url,l,c),o=n&&n.message||n||"Unkown error occurred while creating API request";t.end({error:o,resultType:i.t.Failure,extraData:{rawRequestDuration:r.duration,performanceEntry:JSON.stringify(r)}})}return a.n.reject(n)})}t.e=v},,function(e,t,n){"use strict";n.d(t,"o",function(){return s}),n.d(t,"r",function(){return c}),n.d(t,"s",function(){return d}),n.d(t,"a",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"t",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"e",function(){return m});var a=n(38),i=n(46),r=n(197),o=n(156),s=(null===i.t||void 0===i.t?void 0:i.t.mpcDomain)||"https://my.microsoftpersonalcontent.com",c="UnAuth"===(null===i.t||void 0===i.t?void 0:i.t.hcid),d=!c&&(null===i.t||void 0===i.t?void 0:i.t.hcid)||"";function l(e){var t=e.apiVersion,n=e.driveId,i=e.includeViewerId,r=void 0!==i&&i,o=e.migrationState,c=void 0!==o&&o;return n&&"me"!==n||(n=d),Object(a.e)(n)||c?("v1.0"===t&&(t="v2.0"),r?function(e){return void 0===e&&(e="v2.0"),"".concat(s,"/personal/").concat(d,"/_api/").concat(e)}(t):f(t)):u(t)}function u(e){void 0===e&&(e="v1.0");var t=p(),n=2===Object(r.e)()?"storage.live-int.com":"api.onedrive.com";return"https://".concat(t).concat(n,"/").concat(e)}function f(e){return void 0===e&&(e="v2.0"),"".concat(s,"/_api/").concat(e)}function p(){switch(Object(r.e)()){case 3:return"soak2.test.";case 4:return"soak3.test.";case 2:return"newapi.dev.";default:return""}}function m(e){var t,n,a;return null!==(a=null!==(n=null!==(t=null==e?void 0:e.driveId)&&void 0!==t?t:Object(o.e)(null==e?void 0:e.cid))&&void 0!==n?n:Object(o.e)(d||void 0))&&void 0!==a?a:"me"}},,function(e,t,n){"use strict";var a;!function(e){e[e.created=0]="created",e[e.started=1]="started",e[e.completed=2]="completed",e[e.failed=3]="failed",e[e.canceled=4]="canceled",e[e.expired=5]="expired"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n(41),i=n(3),r=window&&window.FilesConfig||{};r.skyDrivePickerOAuth||(r.skyDrivePickerOAuth="oauth"),!r.oauthToken&&window&&(r.oauthToken=new a.t(window.location.href).getQueryParameter("access_token"));var o=r,s=window&&window.$Config||{};new i.t({name:"".concat("Config",".files"),factory:new i.e(o)}),new i.t({name:"".concat("Config",".config"),factory:new i.e(s)})},function(e,t,n){"use strict";n.d(t,"n",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(3),i=new a.t("ODCUrlDataSource"),r=new a.t("ODCRecycleBinDataSource"),o=new a.t("ODCItemDataSource")},function(e,t,n){"use strict";n.d(t,"A",function(){return i}),n.d(t,"x",function(){return r}),n.d(t,"C",function(){return o}),n.d(t,"I",function(){return s}),n.d(t,"O",function(){return c}),n.d(t,"S",function(){return d}),n.d(t,"D",function(){return l}),n.d(t,"w",function(){return u}),n.d(t,"y",function(){return f}),n.d(t,"p",function(){return p}),n.d(t,"_",function(){return m}),n.d(t,"t",function(){return _}),n.d(t,"i",function(){return h}),n.d(t,"o",function(){return b}),n.d(t,"g",function(){return g}),n.d(t,"a",function(){return v}),n.d(t,"e",function(){return y}),n.d(t,"m",function(){return S}),n.d(t,"n",function(){return D}),n.d(t,"s",function(){return I}),n.d(t,"r",function(){return x}),n.d(t,"v",function(){return C}),n.d(t,"l",function(){return O}),n.d(t,"u",function(){return w}),n.d(t,"d",function(){return E}),n.d(t,"c",function(){return A}),n.d(t,"h",function(){return L}),n.d(t,"f",function(){return k}),n.d(t,"b",function(){return M}),n.d(t,"E",function(){return P});var a=n(14),i=(n(138),window._spPageContextInfo),r=function(){var e=-1!==navigator.userAgent.indexOf("OneDriveWinApp");try{e=e||!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){}return e}(),o=window._spModuleLink&&"SPListWebPack"===window._spModuleLink.manifestName,s=!i||"21"===i.webTemplate&&700===i.listBaseTemplate,c=window._spModuleLink&&"SPOFilePickerWebPack"===window._spModuleLink.manifestName,d=window._spModuleLink&&"ODBFileBrowserWebPack"===window._spModuleLink.manifestName,l=window._spModuleLink&&"ODBLightSpeedWebPack"===window._spModuleLink.manifestName,u=window._spModuleLink&&"TeamsODBFileBrowserV2"===window._spModuleLink.manifestName,f=window._spModuleLink&&"MetaOSODBFileBrowserV2"===window._spModuleLink.manifestName,p={ODB:!!(s||c||d||u||f)&&60443,ODC:"FluentVNextStyling"},m={serviceSetting:"ExternalService_bizappspowerappsenabled"},_={ODB:60596},h={ODB:60193},b={ODB:60486,ODC:"EnableODCCustomerPromiseWebWorker"},g={Fallback:!a.e.isActivated("E1435EAC-8118-427E-B25A-948FEA73E32A","6/6/2023","Use ODBInit for main thread instead of initializeOneDSTelemetry")},v={Fallback:a.e.isActivated("31D882E5-E207-4736-8B8E-DF0970630CE7","4/24/2023","Disable select-field data scrubbing in 1DS.")},y={Fallback:!a.e.isActivated("B35E04AA-346B-44E3-B7A4-88FC1D79C889","01/06/2023","Enable Popup flow for MSAL authentication")},S={ODB:60916},D={ODB:1441},I=(a.e.isActivated("DC975CAD-8F3C-4979-97E2-DA9970A68919","03/25/2022","Prefer isMySiteOwner check for ODB"),{ODB:60933}),x={ODB:!r&&60765},C={ODB:r?-60903:60903},O={ODB:r?-1943:1943},w={ODB:r?-1945:1945},E={ODB:61035},A={ODB:60952},L={ODB:!r&&1781},k={ODB:!a.e.isActivated("9D08C1B2-C10C-4473-8865-AE54FEA6843B","05/04/2023","Execute props.onRendered callback in Spartan based views")},M={ODB:-7007},P=function(){var e,t,n,a,i=(n=(t=(e=navigator.userAgent).substring(e.indexOf("OneDriveWinApp")))&&t.split("/"),{winappMajorVersion:(a=r&&(n.length>1?n[1].split("."):t))?parseInt(a[0],10):"-1",winappMinorVersion:a?parseInt(a[1],10):"-1",winappPatchVersion:a?parseInt(a[2],10):"-1"}),o=i.winappMajorVersion,s=i.winappMinorVersion;return!(o<19||19===o&&(s<23||23===s&&i.winappPatchVersion<7))}},,function(e,t,n){"use strict";n.d(t,"r",function(){return i}),n.d(t,"_",function(){return r}),n.d(t,"f",function(){return o}),n.d(t,"o",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"p",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"l",function(){return u}),n.d(t,"u",function(){return f}),n.d(t,"m",function(){return p}),n.d(t,"n",function(){return m}),n.d(t,"i",function(){return _}),n.d(t,"e",function(){return h}),n.d(t,"c",function(){return b}),n.d(t,"s",function(){return g}),n.d(t,"d",function(){return v});var a=n(3),i=(new a.t("provider.suiteNav"),new a.t("provider.peopleCard")),r=(new a.t("provider.shareByLink"),new a.t("provider.groupsLeftNav"),new a.t("provider.publishingSiteProvider"),new a.t("provider.userInfo")),o=new a.t("provider.tag"),s=new a.t("provider.photo"),c=(new a.t("provider.notification"),new a.t("provider.notificationManager"),new a.t("provider.instrumentation")),d=new a.t("provider.teachingBubble"),l=new a.t("provider.embed"),u=new a.t("provider.storageInfo"),f=new a.t("provider.storageOptions"),p=(new a.t("provider.subscriptions"),new a.t("provider.customAction"),new a.t("provider.taxonomy"),new a.t("provider.thumbnail")),m=(new a.t("provider.appsItem"),new a.t("provider.externallySharedItem")),_=(new a.t("provider.popularItem"),new a.t("provider.mostViewsItem"),new a.t("provider.mostViewersItem"),new a.t("provider.subsiteItem"),new a.t("provider.itemHistory")),h=(new a.t("provider.spotlight"),new a.t("provider.error"),new a.t("provider.publish"),new a.t("provider.bundleLoader")),b=(new a.t("provider.upsell"),new a.t("provider.profile")),g=new a.t("provider.processFilters"),v=new a.t("provider.userState");new a.t("provider.ransomwareDetection"),new a.t("provider.promotedPhotos"),new a.t("provider.site"),new a.t("provider.graphToken"),new a.t("provider.dragAndDropRobot"),new a.t("provider.recycleBin"),new a.t("provider.premiumState"),new a.t("provider.mruRecent"),new a.t("provider.userExpiration"),new a.t("provider.requestReview")},function(e,t,n){"use strict";n.r(t),n.d(t,"encodeItemSetParentKeyKey",function(){return M}),n.d(t,"resourceKey",function(){return T});var a=n(0),i=(n(399),n(7)),r=n(163),o=n(139),s=n(135),c=n(31),d=n(12),l=n(6),u=n(529),f=n(44),p=n(178),m=n(109),_=n(193),h=n(356);function b(e,t){for(var n=t.start,a=Math.min(t.end,e.length),i=n;i<a;i++)if(!e[i])return!1;return!0}var g=n(545),v=n(3),y=n(66),S=n(230),D=n(157),I=n(464),x=n(17),C="__next__",O=function(){function e(e,t,n,a){this._context=e,this._store=t,this._isTokenBaseApi=n,this._tokenBasedExtraItemCount=a}return e.prototype.initialize=function(e,t){if(this._skipDataFetch=!1,!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,a=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,a)}e&&e.isExpired&&(this._context.group=null),this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&this._context.group.groupingId!==C&&!this._context.groupReplace,this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&this._context.group.groupingId===C;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup},e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;return n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&b(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length)),n},e.prototype.computeNewChildren=function(e,t,n,a,i){var r,o=!1;if(this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken),r=i&&!n.isExpired?n.content.peek().items:[],e.nextRequestToken?(!t.requestToken&&r.length>e.totalChildren&&(r[e.totalChildren]=null),e.totalChildren+=this._tokenBasedExtraItemCount,this._store.setNextRequestToken(t.parentKey,a,e.nextRequestToken),o=!0,n&&(n.isTokenBasedApi=o)):this._store.setNextRequestToken(t.parentKey,a,"end"),t.requestToken&&(t.startIndex=r.length-this._tokenBasedExtraItemCount,e.totalChildren+=r.length-this._tokenBasedExtraItemCount),this._isFetchingNextGroup||this._isAllCollapsedQuery){var s=e.children.length,c=e.startIndex+s;e.nextRequestToken&&(c+=this._tokenBasedExtraItemCount),e.totalChildren=Math.max(e.totalChildren,Math.max(r.length,c))}if(e.item&&e.totalChildren>=0){var d;this._isExpandingGroup||(r.length>0&&0===e.totalChildren?r=[]:r.length=e.totalChildren),d=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,u=0;l<r.length;l++)l>=d&&u<e.children.length&&(r[l]=this._store.getItem(e.children[u].key),(t.remoteItem||t.isMountPointFolder)&&(r[l].peek().isMountPointFolder=!0,r[l].peek().remoteWebUrl=t.isMountPointFolder?t.remoteWebUrl:t.remoteItem.SiteUrl),u++)}return{allChildren:r,hasNextRequestToken:o}},e.prototype.computeNewGroupings=function(e,t,n,a,i){var r=this._isExpandingGroup?a.group:null,o=a.itemsPerGroup,s=e&&e.length>0?e[0].itemGroups:null,c=null;s&&s.length>0&&s[s.length-1].isPlaceholder&&(c=s.pop());var d=this._mergeGroupings(e,t,i,n);if(r&&d&&(d[0].isAllCollapsed(!1),r.state({isCollapsed:!1})),n&&n.length>0&&!n[n.length-1]&&(s=d&&d.length>0?d[0].itemGroups:null)&&s.length>0){var l=s[s.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var u=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),f=d[0].isAllCollapsed.peek();if(u||this._isFetchingNextGroup||f){var p=l.startIndex+l.count;c?c.startIndex=p:c={groupingId:C,startIndex:p,count:1,isPlaceholder:!0,state:x.observable({isCollapsed:!1})},n.length<p&&(n.length=p+1),s.push(c)}}return d},e.prototype._mergeGroupings=function(e,t,n,a){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var r=0;r<t.length;r++){var o=i[r].isAllCollapsed.peek();i[r].itemGroups=n?this._retainItemGroupState(i[r].itemGroups,t[r].itemGroups):this._mergeItemGroups(i[r].itemGroups,t[r].itemGroups,o,null,a)}}else i=t;return i},e.prototype._mergeItemGroups=function(e,t,n,a,i){var r=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=r[i];if(e.groupingId===o.groupingId){if(s._context.noIndexBasedDataFetch||!s._context.isTokenBasedApi)if(s._context.groupReplace?(o.count+=e.count,o.hasMoreData&&i<r.length-1&&(o.hasMoreData=!1)):o.count=e.count,o.children=s._mergeItemGroups(o.children,e.children,n,o),0===i)o.startIndex=a?a.startIndex:0;else{var c=r[i-1],d=c.startIndex+c.count-o.startIndex;o.startIndex+=d,o.children&&o.children.forEach(function(e){e.startIndex+=d})}else{var l=e.startIndex+s._context.startIndex,u=e.startIndex+s._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l),o.count=Math.max(u,o.startIndex+o.count)-o.startIndex}return t=!0,"break"}},c=0;c<r.length&&"break"!==o(c);c++);if(!t){var d=r[r.length-1],l=d.startIndex+d.count-e.startIndex;e.startIndex+=l,e.children&&e.children.forEach(function(e){e.startIndex+=l});var u=Math.min(e.count,30),f=0;if(i)for(var p=e.startIndex;p<e.startIndex+u;p++)i[p]||f++;f&&(e.emptyItemCount=f),r.push(e)}},s=this,c=0,d=t;c<d.length;c++)o(d[c])}else r=t;return r},e.prototype._retainItemGroupState=function(e,t,n){var a=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},r=0,o=e;r<o.length;r++){var s=o[r];i[s.groupingId]=s}for(var c=0,d=a;c<d.length;c++){var l=d[c],u=i[l.groupingId];u&&(l.state(u.state.peek()),l.children=this._retainItemGroupState(u.children,l.children,u))}}return a},e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(!(a&&a.startIndex<=e))break;var i=a.startIndex+a.count-1;if(a.children){if(i>=e)return this._getGroupStartingOnIndex(e,a.children)}else{if(a.startIndex===e)return a.state.peek().isCollapsed?null:a;if(i>=e){var r=n<t.length-1?t[n+1]:null;if(r&&!r.state.peek().isCollapsed)return this._skipDataFetch=!0,null}}}return null},e}(),w=n(453),E=n(4),A=n(257),L=n(14),k=100,M=new v.t({name:"".concat("ItemProvider",".encodeItemSetParentKey"),factory:new v.e(Object(E.es)(E.Po))}),P=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._registeredProjections={},a._pendingGetItemRequests={},a._store=n.itemsStore,a._operationProvider=n.operationProvider,a._schemaDataSource=n.schemaDataSource,a._updateQuota=n.updateQuota,a._groupThrottle=n.groupThrottle,a._encodeItemSetParentKey=n.encodeItemSetParentKey||!1,a._smartFiltersStore=n.smartFiltersStore,a}return Object(a.__extends)(t,e),t.prototype.getItem=function(e){return this._getItem(e)},t.prototype.getItemSetKey=function(e,t){var n="parentKey="+(this._encodeItemSetParentKey?encodeURIComponent(e.parentKey):e.parentKey);function a(e,t){t&&(n+="&".concat(e,"=").concat(t))}a("ownerId",e.ownerId),a("groupingType",e.groupingType),n+="&sortField="+(e.sortField||""),n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var r in i)n+="&"+r+"="+i[r];a("groupBy",e.groupBy),a("viewId",e.baseViewId),a("viewXml",e.viewXml),a("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var s="";for(var c in o)s+=c+"_"+o[c];n+="&projection="+s}return e.supportsNestedGroups&&(n+="&ng=1"),n},t.prototype.getSpecifiedItems=function(e){return e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey),this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})},t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,a=this._store.getItem(n),i=this._getItemSet(t,e);if(!a){var r=new o.e(n),s=e.queryType,c=void 0===s?r.queryType:s;r.queryType=c,this._store.setItem(r),a=this._store.getItem(n)}if(!i){var d=a.peek(),l=d&&d.folder,u=l&&l.childCount||0;(i=new h.e(t,e,u)).item=a;var f=e.needSchema;if(void 0===f||f){var p=this._schemaDataSource,m=p&&p.getColumns(d);m&&m.length>0&&i.schema(m)}this._store.setItemSet(t,i)}return i},t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,r=void 0!==i&&i,o=n.emptyAllOtherSets,s=void 0!==o&&o,c=n.refreshSchema,d=void 0!==c&&c,l=n.updateGrouping,u=void 0!==l&&l,f=n.purgeCache,p=void 0!==f&&f;if(s&&this._store.emptyAllOtherSets([e]),d&&(m=this._store.getItemSetFromItemKey(e))&&m.schema([]),u||this._store.invalidateItem(e,{purgeCache:p}),this._smartFiltersStore&&this._smartFiltersStore.invalidate(e),r){var m=this._store.getItemSetFromItemKey(e);this._getItem(Object(a.__assign)(Object(a.__assign)({parentKey:e},m&&m.context||{}),{skipCache:!0,updateGrouping:u}))}},t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){return n&&t.invalidateItem(e.parentKey),n})},t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return c.n.wrapError(e)})},t.prototype.createDocument=function(e,t,n,a,i){var r=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,a).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),a=n&&n[1];return a?o.updateContentType(e,a,i).then(function(){return r.invalidateItem(e),r._updateQuota(!0),t}):t}return r.invalidateItem(e),r._updateQuota(!0),t})})},t.prototype.createCustomDocument=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.createCustomDocument(e,t,n)}).then(function(t){return t?(a.invalidateItem(e),a._updateQuota(!0),a.getItem({parentKey:e}).then(function(e){return a.peekUnwrapObservable(a._store.getItem(t))})):c.n.wrapError()})},t.prototype.updateBundle=function(e,t){var n=this,a=[new S.e(e.item.key,e.item)];return t.update(a),this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key),a=a.map(function(e){return e.succeed()}),t.update(a)},function(i){n.invalidateItem(e.item.UNSAFE_parent?e.item.UNSAFE_parent.key:e.item.key);var r=new Error(i);return a=a.map(function(e){return e.fail(r)}),t.update(a),c.n.wrapError(r)})},t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return this.invalidateItem(e.parentKey),this.resources.consume(A.e)?[4,this.resources.consumeAsync(l.h)]:[3,2];case 1:t.sent().invalidateItems(e.parentKey),t.label=2;case 2:return[2,n]}})})})},t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})},t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:m.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),a=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});return n.state(f.e.started),n.progress.maximum(1),a.then(function(e){return n.state(f.e.completed),n.progress.current(1),e},function(e){return n.state(f.e.failed),n.error(new _.e({message:e})),c.n.wrapError(e)})},t.prototype.requestReview=function(e){for(var t=this,n=new p.e,a=e.items.map(function(e){var a=t._operationProvider.register({name:e.name||"",type:m.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});return a.progress.maximum(1),a.progress.current(0),a}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),r=0,o=a;r<o.length;r++)o[r].state(f.e.started);return i.then(function(n){for(var i=0,r=a;i<r.length;i++){var o=r[i];o.progress.current(1),o.state(f.e.completed)}var s=e.items[0].UNSAFE_parent;return s&&t.invalidateItem(s.key),n},function(e){for(var t=0,n=a;t<n.length;t++){var i=n[t];i.error(new _.e({message:e})),i.state(f.e.failed)}return c.n.wrapError(e)})},t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})},t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.addCoverPhotos,this._addCoverPhotos)},t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,m.e.removeCoverPhotos,this._removeCoverPhotos)},t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){return t.invalidateItem(e.item.key,{triggerFetch:!0}),n})},t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})},t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})},t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})},t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})},t.prototype.updateItemOcrInfo=function(e,t,n){var a=this;return this._getItemDataSource().then(function(a){return a.updateItemOcrInfo(e,t,n)}).then(function(t){return a.invalidateItem(e.key,{triggerFetch:!0}),t},function(e){return e})},t.prototype.rotateItems=function(e,t){var n=this,a={},i=e.items.map(function(e){return a[e.key]=new S.e(e.key,e)});return t.update(i),this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()}),t.update(i)},function(e){var r=e.data||[];i=[];for(var o=0,s=r;o<s.length;o++){var c=s[o],d=a[c.key];n._store.setItem(d.input),delete a[c.key],i.push(d.fail(c.error))}for(var l in a)d=a[l],delete a[l],i.push(d.succeed());t.update(i)})},t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t},t.prototype.computeProjectedItemSet=function(e,t,n,a){var i=n.itemSetProjections,r=a?null:this._store.getItemSet(e),o=!r||r.isPlaceholder||r.isExpired||r.version!==t.version;if(!r||o){for(var s in r||((r=new h.e(e,n)).item=t.item,r.isTokenBasedApi=t.isTokenBasedApi,r.isPlaceholder=t.isPlaceholder,r.isExpired=t.isExpired,r.version=t.version),i){var c=this._registeredProjections[s];c&&c.projectItemSet(r,t,i[s])}a||this._store.setItemSet(e,r)}return r},t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})},t.prototype._getItem=function(e){var n,i=this,r=g.e(e),o=this._store;e.keyAlias?(n=this.getItemSync({parentKey:e.keyAlias}).item,e.parentKey=n.peek().key):n=this.getItemSync(e).item;var s=e.skipCache,d=void 0!==s&&s,u=this.getItemSetKey(e),f=e.itemSetProjections?this.getItemSetKey(e,!0):u,p=this._getItemSet(u,e),m=p&&p.content.peek().items,_=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,v=!d&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||b(m,{start:0,end:m.length})),y=e.startIndex,S=void 0===y?0:y,I=e.pageSize,x=void 0===I?k:I,C=e.endIndex||S+x;C=m&&m.length>0&&!_?Math.min(m.length,C):C,S=Math.max(0,Math.min(C,S));var E=L.e.isActivated("73b2b18a-27b0-433f-95cf-c7f77326ff37","11/09/2021","Not set requestToken if itemSet is expired")||p&&!p.isExpired?o.getNextRequestToken(f):void 0;e.requestToken="end"===E?"":E;var A=new O(e,o,_,t.TOKEN_BASED_API_EXTRA_ITEMS);A.initialize(p,S);var M=!1,P=p&&p.content.peek();if(!P||1!==P.partialResultStatus&&2!==P.partialResultStatus||(M=!0,1===P.partialResultStatus&&p.content({items:P.items,groupings:P.groupings,partialResultRequestCount:0,partialResultStatus:2})),v&&!M&&A.isResultSetValid(m,{start:S,end:C}))return c.n.wrap(p);if(n&&n.peek().isStub){var T=e.startKey;if(T&&o.getItem(T)){p.content.peek().items=[o.getItem(T)],p.isPlaceholder=!0,p.isExpired=!1;var U=this._schemaDataSource,F=U&&U.getColumns(n.peek());F&&F.length>0&&p.schema(F),p.content.valueHasMutated&&p.content.valueHasMutated()}return c.n.wrap(p)}var H=p&&!p.isExpired&&p.content.peek().groupings;H&&H.length>0&&(e.isGrouped=!0),this._normalizeContext(e,m,S,C,!v);var R=this._getRequestKey(e),N=this._pendingGetItemRequests[R];return N?e.itemSetProjections?N.getPromise().then(function(t){return i.computeProjectedItemSet(u,t,e)}):N.getPromise():(_&&!E&&(e.startIndex=0),this._pendingGetItemRequests[R]=N=new D.e,this.resources.consumeAsync(l.u.bypass).then(function(t){return t.getItem(Object(a.__assign)(Object(a.__assign)({},e),{itemSetKey:u}))}).then(function(t){r.updateContextBasedOnResult&&e.updateContextBasedOnResult&&(r.updateContextBasedOnResult(r,t),e.updateContextBasedOnResult(e,t),u=i.getItemSetKey(r));var a=e.itemSetProjections?i.getItemSetKey(e,!0):u;n=o.getItem(e.parentKey);var s=o.getItemSet(a);v=!(!n||!s);var c=A.computeNewChildren(t,e,s,a,!!v),d=c.allChildren,l=c.hasNextRequestToken;if(l&&(_=l),t.item&&!e.ignoreChildren&&!e.skipStoreResults){v||((s=new h.e(a,e)).item=o.getItem(e.parentKey),s.isTokenBasedApi=_,o.setItemSet(a,s));var f=!!s.isExpired;s.sortField=t.sortField,s.isAscending=t.isAscending,s.isPlaceholder=!1,s.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var m=t.schema;s.schema(m&&m.length>0&&m||[]),t.customViewRenderer?s.customViewRenderer=i.observables.create(t.customViewRenderer):s.customViewRenderer=i.observables.create(void 0)}var y=t.groupings;_&&e.mergeGroupings&&(y=A.computeNewGroupings(s.content.peek().groupings,t.groupings,d,e,f)),t.contentTypes&&s.contentTypes&&s.contentTypes(t.contentTypes);var S=s.content.peek(),D=S.partialResultStatus,I=S.partialResultRequestCount,x=void 0===I?0:I;if(!(y&&y.length&&y[0]))if(l&&(t.children&&t.children.length<30||!t.children)){var C=x+1;C<=5?x=C:D=1}else void 0===D||0===D||l?2===D&&t.children&&30===t.children.length&&(D=0):D=3;s.content({items:d,groupings:y,partialResultRequestCount:x,partialResultStatus:D});var O=s.version,w=void 0===O?0:O;s.version=w+1}if(delete i._pendingGetItemRequests[R],e.requestAllChildren&&!b(d,{start:0,end:t.totalChildren})){var E=g.e(e),L=E.startIndex,M=void 0===L?0:L;return E.startIndex=M+k,i._getItem(E)}return t.isFromBrowserCache?(r.skipCache=!0,i._getItem(r)):(e.itemSetProjections&&(s=i.computeProjectedItemSet(u,s,e)),s)},function(e){return delete i._pendingGetItemRequests[R],c.n.wrapError(e)}).then(function(e){N.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(w.t.queryThrottled)&&!e.noGroupReplace?i._groupThrottle(!0):N.error(t)}),N.getPromise())},t.prototype._normalizeContext=function(e,t,n,a,i){var r=e.pageSize||k;if(!e.avoidSeamSnapping){if(!i&&n-n%r!=a-a%r&&t)for(;n<a&&t[n];)n++;e.startIndex=n-n%r}"number"!=typeof e.pageSize&&(e.pageSize=k);for(var o=e.startIndex,s=void 0===o?0:o;a-s>e.pageSize;)e.pageSize+=k},t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);return e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex,t+"&pageSize="+e.pageSize},t.prototype._getItemSet=function(e,t){var n=this._store,a=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),r=n.getItemSet(i);r&&(a=this.computeProjectedItemSet(e,r,t))}return a},t.prototype._updateCoverPhotos=function(e,t,n){for(var a=this,i=new p.e,r=e.target,o=e.items.map(function(e){var n=a._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:r,item:e}},iconName:e.iconName,batch:i});return n.progress.maximum(1),n.progress.current(0),n}),s=n.call(this,e),c=0,d=o;c<d.length;c++)d[c].state(f.e.started);return s.then(function(t){a.invalidateItem(r.key),(null==e?void 0:e.itemsScopeInvalidate)&&a.resources.consumeAsync(l.h).then(function(e){e.invalidateItems(null==r?void 0:r.key)});for(var n=0,i=o;n<i.length;n++){var s=i[n];s.progress.current(1),s.state(f.e.completed)}return t},function(){for(var e=0,t=o;e<t.length;e++)t[e].state(f.e.failed)})},t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})},t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})},t.prototype._getItemDataSource=function(){return c.n.resolve(this.resources.consumeAsync(l.b))},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{groupThrottle:d.l.optional,schemaDataSource:l.O.optional,itemsStore:s.e,operationProvider:r.e,smartFiltersStore:u.e.optional,updateQuota:I.e,encodeItemSetParentKey:M.optional}),t.TOKEN_BASED_API_EXTRA_ITEMS=2,t}(i.n),T=(t.default=P,Object(y.r)("ItemProvider",P))},function(e,t,n){"use strict";var a=n(622);t.e=a.e},function(e,t,n){"use strict";n.d(t,"e",function(){return r.e}),n.d(t,"t",function(){return r.t}),n.d(t,"n",function(){return o});var a=n(365);location.search,n(467),n(280),n(138),location.search;var i,r=n(256);function o(){if(!i){var e=navigator.userAgent;i=/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)).* Electron\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/.test(e)}return i||Object(a.t)()||Object(a.e)()}},,,function(e,t,n){"use strict";var a;!function(e){e[e.AlbumRoot=0]="AlbumRoot",e[e.TagsRoot=1]="TagsRoot",e[e.Album=2]="Album",e[e.Tag=3]="Tag",e[e.FaceRoot=4]="FaceRoot",e[e.Location=5]="Location"}(a||(a={})),t.e=a},function(e,t,n){"use strict";function a(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}n.d(t,"e",function(){return a})},,,,,function(e,t,n){"use strict";var a=n(0),i=n(18),r=function(e){function t(t,n){return e.call(this,t,n)||this}return Object(a.__extends)(t,e),t}(function(){function e(e,t){this.value=e,this.extraClasses=t}return e.prototype.getClass=function(){var e=this.value?Object(i.O)(this.value):void 0;return"ms-Icon ms-Icon--".concat(this.value," ").concat(e||"").concat(this.extraClasses?" "+this.extraClasses:"")},e.prototype.getExtraClasses=function(){return this.extraClasses},e.prototype.toString=function(){return this.value},e}());t.e=r},,,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.requestFailed=0]="requestFailed",e[e.authenticationExpired=1]="authenticationExpired",e[e.accessDenied=2]="accessDenied",e[e.marketBlocked=3]="marketBlocked",e[e.userSuspended=4]="userSuspended",e[e.userNotReady=5]="userNotReady",e[e.passwordRequired=6]="passwordRequired",e[e.mfaRequired=7]="mfaRequired",e[e.insufficientVaultQuota=8]="insufficientVaultQuota",e[e.requestAccess=9]="requestAccess"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(3),i=n(66),r=n(233),o=new a.t({name:"platformDetection",factory:new i.i(r.e)})},,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return f});var a=n(0),i=n(7),r=n(230);n.d(t,"t",function(){return r.e});var o=n(139),s=n(135),c=n(188);n.d(t,"e",function(){return c});var d=n(3),l=n(66),u=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=n.itemsStore,r=void 0===i?a.resources.consume(s.e):i;return a._itemsStore=r,a._itemUpdatesByKey={},a}return Object(a.__extends)(t,e),t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,a=e;n<a.length;n++){var i=a[n];this._processTask(i)}},t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,r=n;i<r.length;i++){var s=r[i],d=t[s],l=new o.e(s),u=this._getStoreItem(s);if(u){u.UNSAFE_parent;var f=Object(a.__rest)(u,["UNSAFE_parent"]);Object(c.default)(l,f)}Object(c.default)(l,{revision:0});for(var p=0,m=d.item;p<m.length;p++){var _=m[p];Object(c.default)(l,_)}e[s]=l}for(var h=0,b=n;h<b.length;h++){var g=(l=e[s=b[h]]).parentKey;if(g){var v=e[g]||this._getStoreItem(g)||new o.e(g);e[g]=v,l.UNSAFE_parent=v}else delete l.UNSAFE_parent}this._pushItemsToStore(e);for(var y=0,S=n;y<S.length;y++)s=S[y],delete(d=t[s]).item},t.prototype.reset=function(){this._itemUpdatesByKey={}},t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)},t.prototype.getChildren=function(e){var t,n,a,i=e.parentKey,r=e.startIndex,o=e.endIndex,s=[],c=this._itemUpdatesByKey[i];if(c){var d=c.set;if(d)if(d.childrenByIndex){r=void 0===(n=(t={startIndex:r,endIndex:o}).startIndex)?d.startIndex:n,o=void 0===(a=t.endIndex)?d.endIndex:a;for(var l=r;l<o;l++){var u=d.childrenByIndex[l],f=this._getStoreItem(u);s.push(f)}}else if(d.childrenBySibling)for(var p={},m="";m=d.childrenBySibling[m];){if(p[m])throw new Error("Circular reference encountered enumerating the children of '".concat(i,"'."));p[m]=!0,f=this._getStoreItem(m),s.push(f)}}return s},t.prototype._processTask=function(e){var t=e.key,n=e.output,a=n.item,i=n.set,r=this._itemUpdatesByKey,o=r[t];if(o||(o=r[t]={}),a&&(o.item||(o.item=[]),o.item.push(a)),i){var s=r[i.parent.key];s||(s=r[i.parent.key]={}),s.set||(s.set={});var c=s.set;if(void 0!==i.index){c.childrenByIndex||(c.childrenByIndex=[]),void 0===c.startIndex?c.startIndex=i.index:c.startIndex=Math.min(c.startIndex,i.index);var d=c.childrenByIndex.length;c.childrenByIndex[i.index]=t,void 0===c.endIndex?c.endIndex=i.index+1:c.endIndex>i.index+1?c.endIndex+=c.childrenByIndex.length-d:c.endIndex=Math.max(c.endIndex,i.index+1)}else i.after&&(c.childrenBySibling||(c.childrenBySibling={}),c.childrenBySibling[i.after.key]=t)}},t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)},t.prototype._pushItemsToStore=function(e){var t={};for(var n in e)(r=t[i=e[(c=e[n]).parentKey]&&c.parentKey||""]||(t[i]=[])).push(n);for(var a=[""];a.length;){var i,r;if(r=t[i=a.shift()]){for(var o=0,s=r;o<s.length;o++){var c;if(!(c=e[n=s[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(c,n)}a.push.apply(a,r)}}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemsStore:s.e}),t}(i.n),f=new d.t({name:"ItemTaskObserver",factory:new l.a(u)});t.n=u},,function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n(31),i=n(19),r=n(66),o=n(6),s=function(){function e(e,t){this._ticketRedeemer=t.ticketRedeemer}return e.prototype.redeemItem=function(e,t,n){return this.redeemItems([e],t,n)},e.prototype.redeemItems=function(e,t,n){return e&&e.some(function(e){return e&&e.tokenNeedsRedeeming})||n?a.n.resolve(this._ticketRedeemer()).then(function(n){return n?n.startRedeem(t,e&&e[0]):{resultType:i.t.Success}}):a.n.resolve({resultType:i.t.Success})},e}(),c=Object(r.r)("ItemRedeemer",s,{ticketRedeemer:o.F.async.optional})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(215);function i(e){return e===a.e.Search}},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"d",function(){return r}),n.d(t,"i",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"u",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"l",function(){return u}),n.d(t,"s",function(){return f}),n.d(t,"r",function(){return p}),n.d(t,"o",function(){return m}),n.d(t,"c",function(){return _});var a=n(24),i=new a.e("createFolder"),r=new a.e("rename"),o=new a.e("moveFrom"),s=new a.e("copyFrom"),c=(new a.e("moveTo"),new a.e("copyTo"),new a.e("deleteItem")),d=new a.e("restoreItem"),l=new a.e("deleteAllItems"),u=new a.e("restoreAllItems"),f=(new a.e("createText"),new a.e("changeExpiration"),new a.e("open"),new a.e("openInTextEditor")),p=new a.e("openInHtmlViewer"),m=new a.e("openInImageEditor"),_=new a.e("openPdfInBrowser");new a.e("quickEdit"),new a.e("editItem"),new a.e("createShortcut"),new a.e("pinToMru"),new a.e("printPdf")},,function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(7),r=n(66),o=n(17),s=n(31),c=n(157),d=n(59),l=n(504),u=function(){this.icon=null,this.isAvailable=o.observable(!0),this.isVisible=o.observable(!0),this.isDefault=!1,this.automationId="",this.instrumentationId="",this.isExecuting=o.observable(!1),this.isLink=!1,this.execute=function(){return s.n.wrap(1)}},f=function(e){function t(t){var n=e.call(this,t)||this;n.state=o.observable(1);var a=t.title,i=t.titleAction,r=t.titleIcon,s=t.titleIconAriaLabel,d=t.customCssClasses,f=t.actions,p=void 0===f?[]:f,m=t.component,_=t.control,h=t.isDismissable,b=void 0===h||h,g=t.isSoftDismissable,v=void 0===g||g,y=t.isDismissableOnResize,S=void 0!==y&&y,D=t.isDismissableOnScroll,I=void 0!==D&&D,x=t.size,C=void 0===x?"Small":x,O=t.automationId,w=t.executeDefaultAction,E=void 0===w||w,A=t.isCallout,L=t.isOverlayHidden,k=void 0!==L&&L,M=t.overlayColor,P=void 0===M?"rgba(255,255,255,.4)":M,T=t.invokerEvent,U=t.calloutHeight,F=t.instrumentationId,H=void 0===F?"":F,R=t.shouldPreserveFocus,N=void 0===R||R,B=t.stayAsPopup,j=void 0!==B&&B,V=t.template,z=void 0===V?1:V,G=t.style,K=void 0===G?l.e.normal:G,W=t.focusOnPrimaryAction,q=void 0!==W&&W,Q=t.dismissOnEsc,Y=void 0!==Q&&Q;n.title=o.isObservable(a)?a:o.observable(a),n.titleAction=i,n.titleIcon=r,n.titleIconAriaLabel=s,n.customCssClasses=d,n.actions=p,n.component=m,n.control=_,n.isDismissable=b,n.isSoftDismissable=v,n.isDismissableOnResize=S,n.isDismissableOnScroll=I,n.size=C,n.automationId=O||"",n.executeDefaultAction=E,n.isCallout=!!A&&!!T,n.isOverlayHidden=k,n.overlayColor=P,n.invokerEvent=T,n.calloutHeight=U,n.instrumentationId=H,n.shouldPreserveFocus=o.isObservable(N)?N:o.observable(N),n.stayAsPopup=j,n.template=z,n.style=K,n.focusOnPrimaryAction=q,n.dismissOnEsc=Y,n.actions=n.actions.map(function(e){return o.utils.extend(new u,e)}),n.actionsVisible=n.createComputed(function(){for(var e=!1,t=0,a=n.actions;t<a.length;t++)a[t].isVisible()&&(e=!0);return e},{disposeWhen:function(){return 1!==n.state()}});var J=new c.e;return n.createComputed(function(){var e=n.state();1!==e&&(2===e?J.complete():J.cancel())}),n._promise=J.getPromise(),n.events.on(document,"keydown",n._keyDownEvent),n}return Object(a.__extends)(t,e),t.prototype.complete=function(){this.state(2)},t.prototype.dismiss=function(){this.state(3)},t.prototype.wait=function(){return this._promise},t.prototype._keyDownEvent=function(e){e.keyCode===d.e.escape&&this.dismissOnEsc&&this.state(3)},t}(i.n),p=n(326),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._dialogs=[],a.currentDialog=a.observables.create(),a._needsOverlayContent=n.needsOverlayContent,a}return Object(a.__extends)(t,e),t.prototype.requestDialog=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=this._dialogs;if(e.maxOneDialog&&t.length>0)return t[0];var n=this.currentDialog,a=new f(e);e.queueDialog?(t.push(a),1===t.length&&n(a)):(t.unshift(a),n(a));var i=function(){var e=t.indexOf(a);e>=0&&(t.splice(e,1),n(t[0])),a.dispose()};return a.wait().then(i,i),a},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{needsOverlayContent:p.e}),t}(i.n),_=Object(r.r)("DialogProvider",m)},,,,function(e,t,n){"use strict";n.d(t,"s",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"o",function(){return u});var a=n(24),i=new a.e("share"),r=new a.e("addToShared"),o=new a.e("embed"),s=(new a.e("comment"),new a.e("removeFromShared")),c=new a.e("addAsMountPoint"),d=new a.e("removeAsMountPoint"),l=new a.e("reportAbuse"),u=new a.e("requestReview");new a.e("alertItem"),new a.e("alertItem")},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"i",function(){return s}),n.d(t,"a",function(){return c}),n.d(t,"d",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"c",function(){return u}),n.d(t,"s",function(){return f}),n.d(t,"o",function(){return p}),n.d(t,"l",function(){return m});var a=n(24),i=new a.e("createExcel"),r=new a.e("createOneNote"),o=new a.e("createPowerPoint"),s=new a.e("createWord"),c=new a.e("createSurvey"),d=new a.e("viewSurvey"),l=new a.e("editSurvey"),u=new a.e("publishSurvey"),f=new a.e("openOnline"),p=new a.e("openInClient"),m=new a.e("viewVersionHistory");new a.e("openInPowerBI"),new a.e("contentTypeNavigation"),new a.e("editNewMenu"),new a.e("uploadTemplate")},function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.all=0]="all",e[e.folders=1]="folders",e[e.photos=2]="photos",e[e.documents=3]="documents",e[e.music=4]="music"}(a||(a={})),function(e){e[e.anyDate=0]="anyDate",e[e.oneDay=1]="oneDay",e[e.oneWeek=2]="oneWeek",e[e.oneMonth=3]="oneMonth",e[e.oneYear=4]="oneYear"}(i||(i={}))},,,,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Home=1]="Home",e[e.Personal=2]="Personal",e[e.Solo=3]="Solo",e[e.Trial=4]="Trial",e[e.Storage=5]="Storage"}(a||(a={}))},function(e,t,n){"use strict";var a;!function(e){e[e.AllMyPhotos=0]="AllMyPhotos",e[e.Albums=1]="Albums",e[e.allTags=2]="allTags",e[e.allPlaces=3]="allPlaces",e[e.allPeople=4]="allPeople",e[e.singleAlbum=5]="singleAlbum",e[e.singleTag=6]="singleTag",e[e.singlePlace=7]="singlePlace",e[e.singlePerson=8]="singlePerson",e[e.onThisDay=9]="onThisDay",e[e.onThisMonth=10]="onThisMonth",e[e.lastWeekPreviousYears=11]="lastWeekPreviousYears"}(a||(a={}));var i=a;t.e=i},,,,function(e,t,n){"use strict";var a;!function(e){e[e.white=1]="white",e[e.themePrimary=2]="themePrimary",e[e.neutralLighterAlt=3]="neutralLighterAlt",e[e.themeTertiary=4]="themeTertiary"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(212),i=new a.e("Item",a.t.subject)},,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"e",function(){return u}),n.d(t,"t",function(){return p});var a,i=function(){return i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)},r="undefined"==typeof window?e:window,o=r&&r.CSPSettings&&r.CSPSettings.nonce,s=((a=r.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(a=i(i({},a),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),a.registeredThemableStyles||(a=i(i({},a),{registeredThemableStyles:[]})),r.__themeState__=a,a),c=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,d=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function l(e){var t=d();e();var n=d();s.perf.duration+=n-t}function u(e,t){void 0===t&&(t=!1),l(function(){var n=Array.isArray(e)?e:function(e){var t=[];if(e){for(var n=0,a=void 0;a=c.exec(e);){var i=a.index;i>n&&t.push({rawString:e.substring(n,i)}),t.push({theme:a[1],defaultValue:a[2]}),n=c.lastIndex}t.push({rawString:e.substring(n)})}return t}(e),a=s.runState,i=a.mode,r=a.buffer,o=a.flushTimer;t||1===i?(r.push(n),o||(s.runState.flushTimer=setTimeout(function(){s.runState.flushTimer=0,l(function(){var e=s.runState.buffer.slice();s.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&f(t)})},0))):f(n)})}function f(e,t){s.loadStyles?s.loadStyles(_(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),a=_(e),i=a.styleString,r=a.themable;n.setAttribute("data-load-themed-styles","true"),o&&n.setAttribute("nonce",o),n.appendChild(document.createTextNode(i)),s.perf.count++,t.appendChild(n);var c=document.createEvent("HTMLEvents");c.initEvent("styleinsert",!0,!1),c.args={newStyle:n},document.dispatchEvent(c);var d={styleElement:n,themableStyle:e};r?s.registeredThemableStyles.push(d):s.registeredStyles.push(d)}}(e)}function p(e){s.theme=e,function(){if(s.theme){for(var e=[],t=0,n=s.registeredThemableStyles;t<n.length;t++){var a=n[t];e.push(a.themableStyle)}e.length>0&&(void 0===(i=1)&&(i=3),3!==i&&2!==i||(m(s.registeredStyles),s.registeredStyles=[]),3!==i&&1!==i||(m(s.registeredThemableStyles),s.registeredThemableStyles=[]),f([].concat.apply([],e)))}var i}()}function m(e){e.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)})}function _(e){var t=s.theme,n=!1;return{styleString:(e||[]).map(function(e){var a=e.theme;if(a){n=!0;var i=t?t[a]:void 0,r=e.defaultValue||"inherit";return t&&!i&&console,i||r}return e.rawString}).join(""),themable:n}}}).call(this,n(590))},function(e,t,n){"use strict";var a;!function(e){e[e.multiple=0]="multiple",e[e.renameItems=1]="renameItems",e[e.deleteItems=2]="deleteItems",e[e.pointInTimeRestore=3]="pointInTimeRestore",e[e.restoreItems=4]="restoreItems",e[e.uploadItems=5]="uploadItems",e[e.moveItems=6]="moveItems",e[e.copyItems=7]="copyItems",e[e.rotateItems=8]="rotateItems",e[e.addItemsToAlbum=9]="addItemsToAlbum",e[e.addCoverPhotos=10]="addCoverPhotos",e[e.removeCoverPhotos=11]="removeCoverPhotos",e[e.createAlbumFromFolder=12]="createAlbumFromFolder",e[e.createColumn=13]="createColumn",e[e.editColumn=14]="editColumn",e[e.deleteColumn=15]="deleteColumn",e[e.checkInItem=16]="checkInItem",e[e.checkOutItem=17]="checkOutItem",e[e.undoCheckOutItem=18]="undoCheckOutItem",e[e.createFolder=19]="createFolder",e[e.updateBundle=20]="updateBundle",e[e.shareItem=21]="shareItem",e[e.reportAbuse=22]="reportAbuse",e[e.requestReview=23]="requestReview",e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto",e[e.createAlbum=25]="createAlbum",e[e.uploadVideos=26]="uploadVideos",e[e.saveItem=27]="saveItem",e[e.createItem=28]="createItem",e[e.publishItem=29]="publishItem",e[e.unPublishItem=30]="unPublishItem",e[e.applyOfficeLens=31]="applyOfficeLens",e[e.removeOfficeLens=32]="removeOfficeLens",e[e.updateMetadata=33]="updateMetadata",e[e.makeHomepage=34]="makeHomepage",e[e.triggerFlow=35]="triggerFlow",e[e.downloadAsZip=36]="downloadAsZip",e[e.saveAutoAlbum=37]="saveAutoAlbum",e[e.discardAutoAlbum=38]="discardAutoAlbum",e[e.addToOneDrive=39]="addToOneDrive",e[e.removeFromSharedList=40]="removeFromSharedList",e[e.setupApprovalFlow=41]="setupApprovalFlow",e[e.setupReminderFlow=42]="setupReminderFlow",e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore",e[e.sharingReport=44]="sharingReport",e[e.editViewColumns=45]="editViewColumns",e[e.runModelOnItems=46]="runModelOnItems",e[e.importModel=47]="importModel",e[e.downloadItem=48]="downloadItem",e[e.deleteSmartTemplate=49]="deleteSmartTemplate",e[e.publishSmartTemplate=50]="publishSmartTemplate",e[e.unpublishSmartTemplate=51]="unpublishSmartTemplate",e[e.universalAnnotationSync=52]="universalAnnotationSync"}(a||(a={})),t.e=a},function(e,t,n){var a;!function(i,r){"use strict";var o=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var t=function(e,n,a){return 1===arguments.length?t.get(e):t.set(e,n,a)};return t._document=e.document,t._cacheKeyPrefix="cookey.",t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),t.defaults={path:"/",secure:!1},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[t._cacheKeyPrefix+e]},t.set=function(e,n,a){return(a=t._getExtendedOptions(a)).expires=t._getExpiresDate(n===r?-1:a.expires),t._document.cookie=t._generateCookieString(e,n,a),t},t.expire=function(e,n){return t.set(e,r,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&e.secure!==r?e.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=e===1/0?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){var a=(e=(e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent)).replace(/\(/g,"%28").replace(/\)/g,"%29"))+"="+(t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent));return a+=(n=n||{}).path?";path="+n.path:"",a+=n.domain?";domain="+n.domain:"",(a+=n.expires?";expires="+n.expires.toUTCString():"")+(n.secure?";secure":"")},t._getCacheFromString=function(e){for(var n={},a=e?e.split("; "):[],i=0;i<a.length;i++){var o=t._getKeyValuePairFromCookieString(a[i]);n[t._cacheKeyPrefix+o.key]===r&&(n[t._cacheKeyPrefix+o.key]=o.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=t<0?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="cookies.js",n="1"===t.set(e,1).get(e);return t.expire(e),n},t.enabled=t._areEnabled(),t},s="object"==typeof i.document?o(i):o;(a=function(){return s}.call(t,n,t,e))===r||(e.exports=a)}("undefined"==typeof window?this:window)},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"r",function(){return i}),n.d(t,"i",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"o",function(){return c}),n.d(t,"t",function(){return d});var a=String.fromCharCode(9),i="OneUp",r="/next",o="shorturl",s="linknotsupported",c="https://".concat("onedrive.live.com","/edit.aspx"),d="b!"},,,function(e,t,n){"use strict";var a;!function(e){e[e.None=0]="None",e[e.NewBrandFRE=1]="NewBrandFRE",e[e.MusicFolderCreationOld=2]="MusicFolderCreationOld",e[e.MusicFolderCreation=3]="MusicFolderCreation",e[e.OneUnitUpsell=4]="OneUnitUpsell",e[e.OneDriveBusinessUpsell=5]="OneDriveBusinessUpsell",e[e.TenGigMaxFileSize=6]="TenGigMaxFileSize",e[e.PreviewTagsView=7]="PreviewTagsView",e[e.XboxMusic=8]="XboxMusic",e[e.O365Upsell1=9]="O365Upsell1",e[e.O365Upsell2=10]="O365Upsell2",e[e.O365Upsell3=11]="O365Upsell3",e[e.O365Upsell4=12]="O365Upsell4",e[e.OneRmO365Upsell=13]="OneRmO365Upsell",e[e.FirstRunExperienceDialog=14]="FirstRunExperienceDialog",e[e.ExpiringSharingLinks=15]="ExpiringSharingLinks",e[e.MobileUpsell=16]="MobileUpsell",e[e.WrsIntroduction=17]="WrsIntroduction"}(a||(a={})),t.e=a},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(135),i=n(66),r=function(){function e(e,t){this._itemsStore=t.itemsStore}return e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),a=n&&(n.parentKey||n.UNSAFE_parent&&n.UNSAFE_parent.key);return a?this._itemsStore.getItem(a):void 0}},e.prototype.getFacetedAncestorOrSelf=function(e,t,n){return void 0===n&&(n=""),this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})},e.prototype.getAncestorOrSelf=function(e,t){for(var n,a=e&&e.key;a;){var i=this._itemsStore.getItem(a),r=i&&i.peek();if(!r)break;if(t(r)){n=i;break}a=r&&(r.parentKey||r.UNSAFE_parent&&r.UNSAFE_parent.key)}return n},e.dependencies={itemsStore:a.e},e}(),o=Object(i.r)("ItemParentHelper",r)},,,,function(e,t,n){"use strict";n.d(t,"t",function(){return u});var a=n(0),i=n(31),r=n(3),o=n(7),s=n(50),c=n(382),d=n(14),l=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a._getModule=t.getModule,a._path=t.path,a._getExecutorParams=t.getExecutorParams,d.e.isActivated("9DB5106C-820A-4714-B0C1-1005523DFE8F","07/09/2021","Removes usage of BundeLoader from ExecutorAction to solve race conditions in BundleQueue")&&(a._bundleLoader=a.resources.consume(s.e),a._bundleLoader.queueLoad(a._path,a._getModule).done()),a}return Object(a.__extends)(t,e),t.prototype.execute=function(e,t){var n=this;return this._path?this._loadExecutorType().then(function(a){return"function"!=typeof a?i.n.wrapError(new Error("Cannot create action from ".concat(a,": ").concat(n._path))):i.n.as(n._getExecutorParams()).then(function(r){var o=new(n.resources.injected(a))(r);return i.n.as(o.execute(e,t))})}):i.n.wrapError(new Error("Cannot create action from nothing: ".concat(this._path)))},t.prototype._loadExecutorType=function(){if(d.e.isActivated("9DB5106C-820A-4714-B0C1-1005523DFE8F","07/09/2021","Removes usage of BundeLoader from ExecutorAction to solve race conditions in BundleQueue")){var e=this._bundleLoader.loadNow(this._path,this._getModule);return this._loadExecutorType=function(){return e},e}return this._getModule().then(function(e){return Object(c.e)(e)})},t.dependencies=Object(a.__assign)({},o.n.dependencies),t}(o.n);t.e=l;var u=new r.t({name:"ExecutorLoader",factory:{dependencies:l.dependencies,create:function(e){return{instance:function(t){function n(n){return t.call(this,n,e)||this}return Object(a.__extends)(n,t),n}(l)}}}})},function(e,t,n){"use strict";n.d(t,"a",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"e",function(){return _});var a=n(3),i=n(375),r=new(n(70).e)("photosExperimentHelperKeyFacet",{}).serialize({}),o=new(n(13).e)("photosExperimentHelper"),s=n(2);n(208),n(36);var c=n(4),d=n(68),l=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabled"),factory:{dependencies:{},create:function(e){return{instance:!c.rs||Object(c.es)(c.po)||Object(c.es)(c.vo)}}}}),u=(new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInFilesPivot"),factory:{dependencies:{},create:function(){return{instance:!c.rs||Object(c.es)(c.po)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSharedPivot"),factory:{dependencies:{},create:function(){return{instance:Object(c.es)(c._o)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInCrossSitePivots"),factory:{dependencies:{},create:function(){return{instance:!!c.rs&&Object(c.es)(c.vo)}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosPivot"),factory:{dependencies:{platformDetection:d.e},create:function(e){return{instance:Object(c.es)(c.ro)&&(!e.platformDetection.isIE||Object(c.es)(c.oo))&&(!e.platformDetection.isSafari||Object(c.es)(c.lo))&&(!e.platformDetection.isMobile||Object(c.es)(c.co))}}}})),f=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleAlbumView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.es)(c.ho)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),p=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.es)(c.go)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),m=new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInSinglePlace"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.es)(c.bo)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),_=(new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPhotosFilePicker"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.es)(c.so)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllTagsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.es)(c.uo)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllPlacesPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.es)(c.mo)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isItemsScopeEnabledInAllAlbumsPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:Object(c.es)(c.io)&&e.isItemsScopeEnabledInAllPhotosPivot}}}}));new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInAllPhotosPivot"),factory:{dependencies:{isItemsScopeEnabledInAllPhotosPivot:u},create:function(e){return{instance:function(e){var t=e(Object(i.e)(function(e){return e.demandItemFacet(o,r)}));return Object(s.isFeatureEnabled)(s.UseVroomInItemsScopeAllPhotos)||Boolean(t&&t.isUseVroomInItemsScopeAllPhotosOtdExpOn())}&&e.isItemsScopeEnabledInAllPhotosPivot}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSingleTagView"),factory:{dependencies:{isItemsScopeEnabledInSingleTagView:p},create:function(e){return{instance:Object(c.es)(c.Wo)&&e.isItemsScopeEnabledInSingleTagView}}}}),new a.t({name:"".concat("ItemsScopeFeature.key",".isVroomEnabledInSinglePlaceView"),factory:{dependencies:{isItemsScopeEnabledInSinglePlaceView:m},create:function(e){return{instance:Object(c.es)(c.Ko)&&e.isItemsScopeEnabledInSinglePlaceView}}}})},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n(0),i=n(10),r=n(19),o=n(17),s=n(7),c=n(31),d=n(157),l=n(660),u=n(354),f=function(e){function t(t){var n=e.call(this,t)||this,a=t.state,i=t.source,r=t.useToggleBehavior,o=t.useGlobalResources,s=t.getParams,d=t.useLocalBindingContext;if(function(e){return!!e.moduleDefinition}(i)){var f=i.moduleDefinition;n._getComponentDefinition=function(){return Object(l.e)(f)}}else{var p=i.component;n._getComponentDefinition=function(){return c.n.wrap(p)}}return n._useToggleBehavior=r,n._state=a,n._getParams=s,n._action=n.createObservable(),n._getHiddenDomProvider=n.resources.consume(u.e.async.lazy),n._useGlobalResources=o,n._useLocalBindingContext=!!d,n.isAvailable=n.createPureComputed(n._computeIsAvailable),n.isToggled=n.createPureComputed(n._computeIsToggled),n}return Object(a.__extends)(t,e),t.prototype.execute=function(e){var t,n=this;if(this._useToggleBehavior){var i=this._action.peek();if(i)return i.cancel(),c.n.wrap()}var r=new d.e,s={complete:function(){r.complete()},fail:function(e){r.error(e)},cancel:function(){r.cancel()}};this._useToggleBehavior&&this._action(s);var l=null==e?void 0:e.target,u=l?o.contextFor(l):void 0;return c.n.as(this._getParams()).then(function(i){return n._getHiddenDomProvider().then(function(o){return n._getComponentDefinition().then(function(c){return t=o.requestControl({name:c.tagName,params:Object(a.__assign)(Object(a.__assign)({action:s,event:e},i||{}),n._useGlobalResources?{}:{resources:n.resources})},{bindingContext:n._useLocalBindingContext?u:void 0}),r.getPromise()}).then(function(){t&&o.disposeControl(t),n._action.peek()===s&&n._action(void 0)},function(e){return t&&o.disposeControl(t),n._action.peek()===s&&n._action(void 0),c.n.wrapError(e)})})})},t.prototype._computeIsAvailable=function(){return this._state().isAvailable},t.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()},t}(s.n),p=function(e){function t(t){var n=e.call(this,t)||this,a=t.name,i=t.source,r=t.handlerType,o=t.actionParams,s=t.useToggleBehavior,c=void 0!==s&&s,d=t.useGlobalResources,l=t.useLocalBindingContext;n.name=a;var u=r?new(n.managed(r))(o):void 0,p=u&&u.state||n.createObservable({isAvailable:!0}),m=u&&u.getParams?function(){return u.getParams()}:function(){};return(null==u?void 0:u.getCustomerPromiseStartSchema)&&(n.customerPromiseStartSchema=u.getCustomerPromiseStartSchema()),n._controlExecutorLoader=new(n.managed(f))({source:i,state:p,useToggleBehavior:c,useGlobalResources:d,getParams:m,useLocalBindingContext:l}),n}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()},t.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()},t.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:r.t.Success}})},t}(i.e);function m(e){var t=e.name,n=e.source,i=e.useToggleBehavior,r=e.handlerType,o=e.useGlobalResources,s=void 0!==o&&o,c=e.useLocalBindingContext;return function(e){function o(a){return e.call(this,{name:t,source:n,useToggleBehavior:i,actionParams:a,handlerType:r,useGlobalResources:s,useLocalBindingContext:c})||this}return Object(a.__extends)(o,e),o}(p)}},function(e,t,n){"use strict";var a;n.d(t,"a",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o}),function(e){e[e.NotCreated=-1]="NotCreated",e[e.Created=0]="Created",e[e.BubbleShown=1]="BubbleShown",e[e.FreShown=2]="FreShown"}(a||(a={}));var i="oneDriveVault",r="canary",o=3},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return I});var a=n(0),i=n(139),r=n(100),o=n(117),s=n(3),c=n(66),d=n(20),l=n(160),u=n(29),f=n(373),p=n(188),m=n(2),_=Object(m.isFeatureEnabled)(m.ReadOnlyItemsStore),h="token=",b="result=",g="item_write=",v="item=";function y(e){return e&&e.item&&e.item.peek().key}function S(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null,n.items=[],t.valueHasMutated()}var D=function(e){function t(){var t=e.call(this,"ItemsStore")||this;return t._itemSetsKeys={},t._observables=new o.e({owner:t}),t._vaultItemsToPurge=[],window.odstore=t,t}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this._observables.dispose()},t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(a.__spreadArray)([e],t,!1))},t.prototype.getItem=function(e){return this.getValue(v+e)},t.prototype.setItemSet=function(e,t){var n=b+e;this.setValue(n,t),this._itemSetsKeys[n]=1},t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var a=(t=this.getValue(n)).content&&t.content.peek(),i=a&&a.items;if(i)for(var r=0,o=i;r<o.length;r++){var s=o[r];if(s&&s.peek().parentKey===e)return t}}},t.prototype.getItemSet=function(e){return this.getValue(b+e)},t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice(b.length));return e},t.prototype.setNextRequestToken=function(e,t,n){var a=h+t;n?this.setValue(a,n):this.remove(a)},t.prototype.getNextRequestToken=function(e){return this.getValue(h+e)},t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,a=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),a)},t.prototype.invalidateItemSet=function(e){var t=this.getValue(b+e);t&&S(t)},t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&S(t)},t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a),r=i&&i.locationFilter;r&&r.indexOf(e)>=0&&(t.isExpired=!0)}}},t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var a=y(t=this.getValue(n));if(a){var i=d.e(a);i&&i.tagFilter===e&&(t.isExpired=!0)}}},t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();n&&n.key&&n.key.indexOf("allmyphotos")>=0&&(e.isExpired=!0,this._invalidateItem(n))}},t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(a.__spreadArray)([],this._vaultItemsToPurge,!0);e<t.length;e++){var n=t[e],r=void 0;n.vault&&n.vault.root&&((r=new i.e(n.key)).name=n.name,r.displayName=n.displayName,r.dateModified=" ",r.folder={},r.vault={isLocked:!0,root:{}}),this._purgeItem(n,r)}this._vaultItemsToPurge=[]},t.prototype._handleItemInvalidation=function(e,t,n){var a=this;if(t){var i=t.peek(),r=!1,o=[];if(i)switch(o.push(i),i.type){case u.e.Folder:case u.e.Media:r=!0}for(var s in this._itemSetsKeys){var c=this.getValue(s),d=c.item&&c.item.peek(),l=d&&d.key;l&&(l===e||r&&l.indexOf("allmyphotos")>-1)&&(l===e?this.setNextRequestToken(e,c.key,""):o.push(d),c.isExpired=!0)}o.forEach(n?function(e){return a._purgeItem(e)}:function(e){return a._invalidateItem(e)})}},t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)},t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e),Object(p.default)(t,{revision:e.revision+1}),this.setItem(t)},t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];_&&!Object.isFrozen(e)&&Object.freeze(e),e.vault&&this._vaultItemsToPurge.push(e);for(var r=function(t){var n="".concat(v).concat(t),a=_?"".concat(g).concat(t):n,r=o.getValue(n),s=o.getValue(a);s?s(e):((s=o._observables.create(e)).equalityComparer=l.t,o.setValue(a,s),r=_?o._observables.pureCompute(function(){return s()}):s,o.setValue(n,r)),i.push(r)},o=this,s=0,c=Object(f.e)(Object(a.__spreadArray)([e.key],t,!0));s<c.length;s++){var d=c[s];r(d)}return i[0]},t}(r.e),I=new s.t({name:"ItemsStore",factory:new c.i(D)})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(526),i=window._spPageContextInfo,r=function(e){if(i&&i.farmSettings)return i.farmSettings[e]},o=function(e){return e.serviceSetting?(t=e.serviceSetting,1===Number(r(t))||"true"===r(t)):a.n.isFeatureEnabled(e);var t}},function(e,t,n){"use strict";var a=n(5);t.e=function(e){void 0===e&&(e=""),this.isDropEnabled=!1,this.permissions={High:0,Low:0},this.key=e,this.revision=0,this.queryType=a.e.Files,this.displayType=a.e.Files,this.isPlaceholder=!0,this.properties={},this.recycleBinProperties={},this.reputationProperties={},this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0},this.urls={},this.state={upload:{status:5},removing:!1}}},function(e,t,n){"use strict";var a=n(0),i=n(10),r=n(31),o=n(19),s=n(36),c=n(12),d=n(20),l=n(577),u=n(3),f=n(66),p=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="Navigation";var i=t.url,r=t.viewParams,o=t.target,d=void 0===o?"_top":o,l=t.forceNavigation,u=void 0!==l&&l,f=t.ignoreHistory,p=t.beforeNavigation,m=t.afterNavigation,_=t.postProcessUrl,h=n.navigation,b=void 0===h?a.resources.consume(s.e):h,g=n.viewParamsObservable,v=void 0===g?a.resources.consume(c.D):g;return a._navigation=b,a._viewParams=v,a._url=a.wrapObservable(i),a._inputViewParams=a.wrapObservable(r),a._target=a.wrapObservable(d),a._forceNavigation=u,a._ignoreHistory=f,a._beforeNavigation=p,a._afterNavigation=m,a._postProcessUrl=_,a}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this._url.peek(),a=this._inputViewParams.peek(),i=this._beforeNavigation;i&&i(this._navigation);var s=this._postProcessUrl?this._postProcessUrl(n):n;return(this._forceNavigation||n)&&this._navigation.navigateTo({url:s,viewParams:a,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory}),this._afterNavigation&&this._afterNavigation(this._navigation),r.n.wrap({resultType:o.t.Success})},t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),a="#"+d.n(n),i=t&&0===t.indexOf("#")?t.substring(1):"",r=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(r){var o=d.e(r);return!l.e(n,o)}return e!==a},t.dependencies={resources:u.r,navigation:s.e,viewParamsObservable:c.D},t}(i.e);t.e=p,Object(f.o)("NavigationAction",p)},,function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"n",function(){return c});var a=n(64),i="text/plain",r={abap:i,ada:i,adp:i,ahk:i,as:i,as3:i,asc:i,ascx:"text/xml",asm:i,asp:i,awk:i,bash:i,bash_login:i,bash_logout:i,bash_profile:i,bashrc:i,bat:"text/x-bat",bib:i,bsh:"text/x-java",build:i,builder:i,c:"text/x-cpp","c++":"text/x-c++src",capfile:i,cc:"text/x-c++src",cfc:i,cfm:i,cfml:i,cl:i,clj:i,cls:i,cmake:i,cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:i,cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:i,db:i,ddl:i,di:i,dif:i,diff:i,disco:"text/xml",dml:i,dtd:"text/xml",dtml:"text/xml",el:i,emakefile:i,erb:i,erl:i,f:i,f90:i,f95:i,fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:i,gemspec:"text/ruby",gitconfig:"text/x-ini",go:i,groovy:i,gvy:i,h:"text/x-cpp","h++":"text/x-c++hdr",haml:i,handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:i,hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:i,hs:i,htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:i,inc:"text/html",inf:i,ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:i,jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:i,jsx:"text/javascript",l:i,less:"text/x-less",lhs:i,lisp:i,log:i,lst:i,ltx:i,lua:"text/x-lua",m:i,mak:i,make:i,markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:i,mli:i,mll:i,mly:i,mm:i,mud:i,nfo:i,opml:"text/xml",osascript:i,osts:"text/javascript",out:i,p:i,pas:i,patch:i,php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:i,plist:i,pm:i,pod:i,pp:i,profile:i,properties:i,ps1:"text/x-powershell",ps1xml:"text/x-powershell",psd1:"text/x-powershell",psm1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:i,r:i,rake:i,rb:"text/ruby",rbx:i,rc:i,re:i,reg:i,rest:i,resw:"text/xml",resx:"text/xml",rhtml:i,rjs:i,rprofile:i,rpy:i,rss:"text/xml",rst:i,rxml:i,s:i,sass:"text/scss",scala:i,scm:i,sconscript:i,sconstruct:i,script:i,scss:"text/scss",sgml:"text/xml",sh:i,shtml:"text/html",sml:"text/xml",sql:i,sty:i,t:i,tcl:i,tex:i,text:i,textile:i,tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:i,vb:"text/x-vb",vi:i,vim:i,wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:i,xslt:i,yaml:i,yaws:i,yml:i,zsh:i};function o(e){return e=function(e){return((e&&"."===e[0]?e.substring(1):e)||"").toLowerCase()}(e),r.hasOwnProperty(e)}function s(e,t){return!!e&&c(e,t)}function c(e,t){return o(e)&&(t===a.t.File||t===a.t.Media||t===a.t.Unknown)}},,,,,,function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"t",function(){return d}),n.d(t,"e",function(){return a}),n.d(t,"n",function(){return i});var a,i,r,o,s=n(3),c=new s.t("sortManager"),d=new s.t("dataManager");new s.t("listViewContextMenuCommandSet"),new s.t("topCommandSet"),new s.t("listViewContextMenuHelper"),new s.t("fileContent"),new s.t("contentRange"),new s.t("error"),function(e){var t,n,a,i,r;(r=e.leftNav||(e.leftNav={})).isLeftNavClosing=new s.t("base.leftNav.isLeftNavClosing"),r.isLeftNavVisible=new s.t("base.leftNav.isLeftNavVisible"),r.hideLeftNav=new s.t("base.leftNav.hideLeftNav"),r.isLeftNavUserExpanded=new s.t("base.leftNav.isLeftNavUserExpanded"),r.toggleIsLeftNavUserExpanded=new s.t("base.leftNav.toggleIsLeftNavUserExpanded"),(i=e.suiteNav||(e.suiteNav={})).context=new s.t("base.suiteNav.context"),i.isTopBarVisible=new s.t("base.suiteNav.isTopBarVisible"),i.isTopBarHamburgerVisible=new s.t("base.suiteNav.isTopBarHamburgerVisible"),i.isSuiteNavHamburgerVisible=new s.t("base.suiteNav.isSuiteNavHamburgerVisible"),i.supportHamburgerInSuiteNav=new s.t("base.suiteNav.supportHamburgerInSuiteNav"),i.isSuiteNavHidden=new s.t("base.suiteNav.isSuiteNavHidden"),(a=e.commandBar||(e.commandBar={})).transclusionProvider=new s.t("base.commandBar.transclusionProvider"),a.isDarkTheme=new s.t("base.commandBar.isDarkTheme"),a.isSearchHidden=new s.t("base.commandBar.isSearchHidden"),(n=e.infoPane||(e.infoPane={})).isInfoPaneAvailable=new s.t("base.infoPane.isInfoPaneAvailable"),n.hidePreview=new s.t("base.infoPane.hidePreview"),(e.filtersPane||(e.filtersPane={})).isFiltersPaneAvailable=new s.t("base.filtersPane.isFiltersPaneAvailable"),(t=e.columnCustomizationPane||(e.columnCustomizationPane={})).isColumnCustomizationPaneExpanded=new s.t("base.columnCustomizationPane.isColumnCustomizationPaneExpanded"),t.columnToFormat=new s.t("base.columnCustomizationPane.columnToFormat"),t.viewToFormat=new s.t("base.columnCustomizationPane.viewToFormat"),(e.oneUpOverlay||(e.oneUpOverlay={})).isPhotosOnly=new s.t("base.oneUpOverlay.isPhotosOnly"),(e.footer||(e.footer={})).hasFooter=new s.t("base.footer.hasFooter"),e.isSPLightSpeed=new s.t("base.isSPLightSpeed"),e.isScrollbarHidden=new s.t("base.isScrollbarHidden"),e.addPaddingBottom=new s.t("base.addPaddingBottom"),e.makeFlexBox=new s.t("base.makeFlexBox"),e.contextMenuHelper=new s.t("base.contextMenuHelper"),e.isRetrievingData=new s.t("base.isRetrievingData")}(a||(a={})),function(e){e.layoutType=new s.t("files.layoutType"),e.isArrangeControlVisible=new s.t("files.isArrangeControlVisible")}(i||(i={})),function(e){e.layoutType=new s.t("photos.layoutType")}(r||(r={})),function(e){e.layoutType=new s.t("storageInfo.layoutType")}(o||(o={})),new s.t("eventScope")},function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.text=t.text,n}return Object(a.__extends)(t,e),t}(n(98).e),r=n(99).e({tagName:"ms-text-container",template:'<div class="TextContainer" data-bind="text:text"></div>',viewModel:i});t.e=r},,,,,function(e,t,n){"use strict";var a=n(530);n.d(t,"e",function(){return a.e})},,,,function(e,t,n){"use strict";var a=n(509);n.d(t,"e",function(){return a.e})},,,function(e,t,n){"use strict";var a;!function(e){e[e.Left=0]="Left",e[e.Top=0]="Top",e[e.Right=1]="Right",e[e.Bottom=2]="Bottom",e[e.Center=4]="Center",e[e.VerticalCenter=8]="VerticalCenter",e[e.BottomCenter=6]="BottomCenter",e[e.BottomRight=3]="BottomRight",e[e.RightVerticalCenter=9]="RightVerticalCenter"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";n.d(t,"e",function(){return b});var a=n(0),i=n(7),r=n(44),o=n(178),s=n(109),c=n(31);function d(){return c.n.wrap()}var l=function(e){function t(t){var n=e.call(this,t)||this;n.key=t.key;var a=n.observables,i=t.count,r=void 0===i?a.create(1):i,o=t.isAvailable,s=void 0===o?a.create(!0):o,c=t.onExecute,l=void 0===c?d:c;return n.count=r,n.isAvailable=s,n._onExecute=l.bind(t.operation),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._onExecute=d},t.prototype.execute=function(){return this._onExecute()},t}(i.n),u=function(e){function t(t){var n=e.call(this,{})||this,i=n.observables;n.name=t.name,n.iconName=t.iconName,n.state=i.create(r.e.created),n.warning=i.create(""),n.error=i.create(),n.count=i.create(1);var c=Object(a.__assign)({minimum:0,maximum:0,current:0},t.progress||{});return n.progress={minimum:i.create(c.minimum),maximum:i.create(c.maximum),current:i.create(c.current)},n.type=i.create(t.type||s.e.multiple),n.batch=t.batch||new o.e,n._initializeActions(t.actions),n.payloads=i.create(t.payloads||{}),n.visibility=i.create(t.visibility||0),n}return Object(a.__extends)(t,e),t.prototype.dispose=function(){this.actions({}),this.payloads({}),e.prototype.dispose.call(this)},t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var a=e[n];t[n]=this.scope.attach(new l({key:n,operation:this,isAvailable:a.isAvailable,onExecute:a.execute}))}this.actions=this.observables.create(t)},t}(i.n),f=n(243),p=n(376),m=function(e){function t(t){var n=e.call(this,t)||this;return n.operations=t.operations,n.name="",n.iconName="",n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)},n.batch=t.batch,n.error=n.createObservable(),n.count=n.createObservable(0),n._initializeType(),n.payloads=n.createPureComputed(n._computePayloads),n.actions=n.createObservable({}),n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0}),n._initializeOperations(),n.state=n.createPureComputed(n._computeState),n.visibility=n.createPureComputed(n._computeVisibility),n}return Object(a.__extends)(t,e),t.prototype._initializeType=function(){var e=this.addDisposable(p.e.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||s.e.multiple})},t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}},t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return r.e[t.state()]}),a=e.addDisposable(f.t(t.progress.minimum,e.progress.minimum)),i=e.addDisposable(f.t(t.progress.maximum,e.progress.maximum)),o=e.addDisposable(f.t(t.progress.current,e.progress.current)),s=e.addDisposable(f.e(n,e.states)),c=e.addDisposable(f.n(t.error,e.error)),d=e.addDisposable(f.t(t.count,e.count)),l=e.createComputed(function(){var n=!1,a=e.actions.peek();for(var i in t.actions())i in a||(a[i]=e._initializeAction(i),n=!0);n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose(),a.dispose(),i.dispose(),o.dispose(),s.dispose(),l.dispose(),c.dispose(),d.dispose()}}}}))},t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?r.e.started:e.created?r.e.created:e.failed?r.e.failed:e.completed?r.e.completed:e.canceled?r.e.canceled:r.e.expired},t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)},t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new l({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return c.n.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||c.n.wrap()}))}}))},t}(i.n),_=n(66),h=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.observables,r=new o.e;a._observers=i.createArray();var s=a.operations=i.createArray(),c=a.scope.attached(m),d=a.groups=a.addDisposable(p.e.group(s,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new c({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));return a.overall=new(a.managed(m))({batch:r,operations:d}),a.isLocked=a.createPureComputed(a._computeIsLocked),a.createBackgroundComputed(a._computeRemoveAllWhenUnlocked).extend({deferred:!0}),a}return Object(a.__extends)(t,e),t.prototype.lock=function(){var e=this,t={};return this._observers.push(t),{dispose:function(){e._observers.remove(t)}}},t.prototype.register=function(e){var t=new u(e);return 2!==t.visibility.peek()&&this.operations.push(t),t},t.prototype.deleteGroupOperation=function(e){var t=Object(a.__spreadArray)([],e.operations.peek(),!0);this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,a=this.groups.peek();n<a.length;n++){var i=a[n],o=i.state.peek();if(o===r.e.completed||!e&&(o===r.e.expired||o===r.e.canceled||o===r.e.failed))for(var s=i.operations.peek(),c=void 0,d=0;d<s.length;d++){c=!0;var l=s[d];if(o===r.e.failed&&l.actions)for(var u=l.actions.peek(),f=Object.keys(u),p=0;p<f.length;p++)if("cancel"!==f[p]&&u[f[p]].isAvailable.peek()){c=!1;break}c&&t.push(s[d])}}this.operations.removeAll(t),t.forEach(function(e){e.dispose()})},t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()},t.prototype._computeIsLocked=function(){return this._observers().length>0},t}(i.n),b=Object(_.r)("OperationProvider",h)},function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(3),i=n(66),r=n(357),o=n(520),s=n(282),c=n(507),d=n(31),l=new a.t({name:"cookieOrigin",factory:new a.e(window.location.origin)}),u="VroomDataRequestor",f=new a.t({name:"".concat(u,".isOfflineStatePromise"),factory:{dependencies:{isOfflineStateObservable:c.e},create:function(e){return{instance:function(){return d.n.resolve(e.isOfflineStateObservable.get())}}}}}),p=Object(i.r)(u,s.e,{sessionManagementProvider:o.e.optional,urlDataSource:r.e.optional,cookieOrigin:l,isOffline:f})},function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(1),i=Object(a.createContext)({});function r(){return Object(a.useContext)(i)}function o(e){var t=e.dispatcher,n=e.children;return a.createElement(i.Provider,{value:{dispatcher:t}},n)}},,,function(e,t,n){"use strict";n.d(t,"t",function(){return s}),n.d(t,"e",function(){return c});var a=n(1),i=n(165),r=n(157),o=Object(a.createContext)({clear:function(){throw new Error("Missing clear function in WacMessagePresenterContext")},cache:null});function s(){return Object(a.useContext)(o)}function c(e){var t=e.eventType,n=e.children,s=Object(i.t)().dispatcher,c=Object(a.useState)(null),d=c[0],l=c[1],u=a.useCallback(function(){l(null)},[l]),f=a.useCallback(function(e){var t=new r.e;l({message:e,signal:t});var n=t.getPromise();return n.then(u,u),n},[l]);return Object(a.useEffect)(function(){if(s&&t)return s.addEventListener(t,f),function(){s.removeEventListener(t,f)}},[s,t,f]),a.createElement(o.Provider,{value:{cache:d,clear:u}},d&&u?n:null)}},,function(e,t,n){"use strict";var a;n.d(t,"n",function(){return d}),n.d(t,"e",function(){return l}),function(e){e[e.FRE=0]="FRE",e[e.ONEUNIT=1]="ONEUNIT"}(a||(a={}));var i,r=a,o=n(114),s=n(2),c=window.$Config&&window.$Config.isINT,d="https://messaging-int.msonerm.com/",l="https://dynmsg.modpim.com/",u=((i={})[o.e.NewBrandFRE]={id:o.e.NewBrandFRE,type:r.FRE,checkThrottle:function(e){return e.viewCount<=2&&!e.didUserDismiss},getUpsellIframeUrl:function(e){return"".concat(c?d:l,"api/v1/messaging/web/message?puid=").concat(e.upsellUserId,"&locale=").concat(e.market,"&Source=OneDriveFRE")},shouldSendMessageOnClose:!0,renderType:0},i[o.e.OneRmO365Upsell]={id:o.e.OneRmO365Upsell,type:r.ONEUNIT,ramp:s.OneRmO365UpsellEnabled,checkThrottle:function(e){return Object(s.isFeatureEnabled)(s.OneRmO365UpsellEnabled)},getUpsellIframeUrl:function(e){return"".concat(c?d:l,"api/v1/messaging/web/message?puid=").concat(e.upsellUserId,"&locale=").concat(e.market,"&data=").concat(encodeURIComponent(JSON.stringify({isO365:e.isO365,bytesUsed:e.bytesUsed,bytesAvailable:e.bytesAvailable})),"&Source=OneDriveWebBanner")},shouldSendMessageOnClose:!0,renderType:1},i);t.t=u},,,,,,,,function(e,t,n){"use strict";var a=function(){function e(){this.id=++e._lastBatchId}return e._lastBatchId=0,e}();t.e=a},function(e,t,n){"use strict";var a=n(0),i=n(10),r=n(118),o=n(21),s=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this,i=t.item,s=n.getItemSelectionHelperType,c=void 0===s?a.resources.consume(o.e.lazy):s,d=n.itemParentHelper,l=void 0===d?a.resources.consume(r.e):d;return a.isItemSpecified=!!i,a.item=i||new(a.scope.attached(c()))({canFallback:!0,ignoreSelection:!0}).currentItem,a.itemParentHelper=l,a}return Object(a.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this.item()},t.prototype.getParent=function(e,t,n){var a=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(a):this.unwrapObservable(a)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{getItemSelectionHelperType:o.e.lazy,itemParentHelper:r.e}),t}(i.e);t.e=s},,,function(e,t,n){"use strict";var a;!function(e){e[e.defaultValue=0]="defaultValue",e[e.ascending=1]="ascending",e[e.descending=2]="descending"}(a||(a={})),t.e=a},,,,,,,,function(e,t,n){"use strict";var a;!function(e){e[e.Lock=1]="Lock",e[e.Unlock=2]="Unlock",e[e.Manage=3]="Manage",e[e.FreDialog=4]="FreDialog",e[e.ShowFiles=5]="ShowFiles",e[e.Reset=6]="Reset",e[e.Debug=7]="Debug",e[e.FilesRemaining=8]="FilesRemaining"}(a||(a={})),t.e=a},,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.errorType=t.errorType||0,n.payloads=t.payloads||{},n}return Object(a.__extends)(t,e),t}(n(77).e);t.e=i},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=window.FilesConfig&&window.FilesConfig.env;function i(){switch(a&&a.toLowerCase()){case"soak3":return 4;case"soak2":return 3;case"dev":return 2;case"df":return 1;default:return 0}}},function(e,t,n){"use strict";var a;!function(e){e[e.defaultValue=0]="defaultValue",e[e.displayName=1]="displayName",e[e.dateModified=2]="dateModified",e[e.dateCreated=3]="dateCreated",e[e.size=4]="size",e[e.itemType=5]="itemType",e[e.dateTaken=6]="dateTaken",e[e.owner=7]="owner",e[e.userArranged=8]="userArranged",e[e.dateAccessed=9]="dateAccessed",e[e.relevancy=10]="relevancy",e[e.dateDeleted=11]="dateDeleted",e[e.location=12]="location",e[e.dateShared=13]="dateShared",e[e.sharer=14]="sharer"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";function a(e){var t=!1;if(e)switch(e.errorCode){case 2:case 101:case 102:case 103:case 152:case 161:case 162:case 200:case 201:case 202:case 209:case 1e3:case 1006:case 1007:case 2006:case 3e3:case 3403:case 9017:case 10001:case 10002:case 10004:case 10006:case 10009:case 10011:case 10012:case 10013:case 10027:t=!0}return t}n.d(t,"e",function(){return a})},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(3).t)("pageContext")},,function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r}),n.d(t,"n",function(){return o});var a=n(13),i=new(n(70).e)("odspNextApp",{}),r=i.serialize({}),o=new a.e("resourceScopeFacet")},function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"n",function(){return c}),n.d(t,"a",function(){return d}),n.d(t,"i",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"s",function(){return p}),n.d(t,"d",function(){return m}),n.d(t,"l",function(){return _}),n.d(t,"r",function(){return h}),n.d(t,"c",function(){return g}),n.d(t,"o",function(){return v}),n.d(t,"u",function(){return y});var a=n(2),i=n(31);function r(e){var t;return function(){return t||(t=i.n.resolve(e()).then(function(e){return e.default}).catch(function(e){return t=void 0,i.n.reject(e)}))}}var o="ms-albums-list",s="ms-all-photos-list",c="ms-grid-customlist",d="ms-details-customlist",l="ms-details-list",u="ms-compact-details-list",f=Object(a.isFeatureEnabled)(a.UseTilesList)?"od-tiles-list":"ms-grid-list",p="ms-single-album-list",m="od-tag-grid",_="od-tags-list",h="od-doccard-grid",b="od-shared-grid-list",g="od-sites-grid-list",v={"ms-albums-list":r(function(){return n.ee([49,"ondemand.resx-ondemand"],1729)}),"od-tiles-list":r(function(){return n.ee([62],1747)}),"ms-all-photos-list":r(function(){return n.ee([50,"ondemand.resx-ondemand"],1730)}),"ms-grid-customlist":r(function(){return n.ee([52,"ondemand.resx-ondemand"],1708)}),"ms-details-customlist":r(function(){return n.ee([53,"ondemand.resx-ondemand"],1677)}),"ms-details-list":r(function(){return n.ee([54],1678)}),"ms-compact-details-list":r(function(){return n.ee([51],1679)}),"ms-grid-list":r(function(){return n.ee([56,"ondemand.resx-ondemand"],1786)}),"ms-single-album-list":r(function(){return n.ee([58,"ondemand.resx-ondemand"],1752)}),"od-tag-grid":r(function(){return n.ee([60,"ondemand.resx-ondemand"],1731)}),"od-tags-list":r(function(){return n.ee([61,"ondemand.resx-ondemand"],1299)}),"od-doccard-grid":r(function(){return n.ee([55,"ondemand.resx-ondemand"],1753)}),"od-shared-grid-list":r(function(){return n.ee([57,"ondemand.resx-ondemand"],1754)}),"od-sites-grid-list":r(function(){return n.ee([59,"ondemand.resx-ondemand"],1719)})};function y(e,t){var n=t&&t.isCustomList,a=t&&t.isPlaceholder;switch(e){case o:return o;case s:return s;case c:case"ms-grid-list":case"od-tiles-list":case f:return a?e:n?c:f;case d:case l:return a?e:n?d:l;case u:return u;case p:return p;case m:return m;case _:return _;case h:return h;case b:return b;case g:return g;default:return n?d:l}}},function(e,t,n){"use strict";var a=n(347);n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.t})},,function(e,t,n){"use strict";var a=n(362);n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.t}),n.d(t,"n",function(){return a.n})},,,function(e,t,n){"use strict";var a;!function(e){e[e.Files=0]="Files",e[e.Recent=1]="Recent",e[e.DocumentLibraries=2]="DocumentLibraries",e[e.SharedWithMe=3]="SharedWithMe",e[e.DocsInCommon=4]="DocsInCommon",e[e.RecycleBin=5]="RecycleBin",e[e.Photos=6]="Photos",e[e.Search=7]="Search",e[e.AllMyPhotos=8]="AllMyPhotos",e[e.AccountChooserPicker=9]="AccountChooserPicker",e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK",e[e.Popular=11]="Popular",e[e.RecentUnpopular=12]="RecentUnpopular",e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin",e[e.Apps=14]="Apps",e[e.Subsites=15]="Subsites",e[e.RecentActivity=18]="RecentActivity",e[e.ExternallyShared=19]="ExternallyShared",e[e.SharedByMe=20]="SharedByMe",e[e.Favorites=21]="Favorites",e[e.DetailsPane=22]="DetailsPane",e[e.Channels=24]="Channels",e[e.PhotoStream=25]="PhotoStream",e[e.PhoneLink=26]="PhoneLink",e[e.DefaultDocLib=27]="DefaultDocLib",e[e.ListSyncIssues=28]="ListSyncIssues",e[e.OneDriveHome=29]="OneDriveHome",e[e.TeamsDownloads=30]="TeamsDownloads",e[e.MyLists=31]="MyLists",e[e.Selection=32]="Selection",e[e.People=33]="People",e[e.Meetings=34]="Meetings",e[e.RecentLists=35]="RecentLists",e[e.MyOrganizationAssets=36]="MyOrganizationAssets"}(a||(a={})),t.e=a},,function(e,t,n){"use strict";n.d(t,"e",function(){return E});var a=n(0),i=n(153),r=n(185),o=n(31),s=n(157),c=n(19),d=n(3),l=n(66),u=n(41),f=new d.t("TokenFetcher.key"),p=n(487),m=n(4),_=n(40),h=n(242),b=n(85),g=n(147),v=n(116),y=n(462),S=n(110),D=n(33),I=n(14),x=!I.e.isActivated("51FC098A-B1A9-4476-B1F9-A8A3A0120F40","03/01/2023","Set substrate token expiration time manually to an hour"),C=!I.e.isActivated("B257F8BA-2071-43EB-B574-F547E86F454C","04/24/2023","Check for missing email in auth error case"),O=new d.t({name:"".concat("IdentityDataSource",".enableCooldownAfterAuthFlow"),factory:new d.e(Object(m.es)(m.Oe))}),w=function(){function e(e,t){var n=this;if(this._getResouceByTokenType=function(e){switch(e){case"graph_auth:":return Object(D.a)();case"substrate_auth:":return Object(D.o)();default:return Object(D.r)()}},this._enableCooldownAfterAuthFlow=t.enableCooldownAfterAuthFlow,this._tokenFetcher=t.tokenFetcher,this._tokenCache=new p.t,this._pendingSignals={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0,"phone_link:":void 0,"substrate_auth:":void 0},this._authFrameAttempts={"msa_auth:":0,"graph_auth:":0,"msa_strong_auth:":0,"phone_link:":0,"substrate_auth:":0},this._tokenRefreshCooldowns={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0,"phone_link:":void 0,"substrate_auth:":void 0},this._scope=new g.e,this._async=this._scope.attach(new v.e),this.getIdentity().type===i.e.msa){var a=this._scope.attach(new b.t(this));this._silentAuthOrigin=document.location.protocol+"//"+document.location.hostname,a.on(window,"message",this._onMessageReceived),this._sessionId=$Config.authSessionId||"0",I.e.isActivated("DA868920-AFA9-4023-A5F0-16185C12D46B","10/21/2021","Web canary refresh")||(this._lastCanaryRefreshTime=Date.now(),a.on(window,"focus",function(){Date.now()-n._lastCanaryRefreshTime>6e4&&(n._lastCanaryRefreshTime=Date.now(),n._refreshCanary())}))}Object(h.t)(h.e.spoSandbox)&&this.signOut()}return e.prototype.dispose=function(){this._scope.dispose()},e.prototype.getIdentity=function(){var e=i.e.anonymous,t="";return"UnAuth"!==$Config.unid&&(t=$Config.unid,e=$Config.aadClientId&&"live.com"===$Config.domain?i.e.aad:i.e.msa),{email:$Config.email,id:t,loginName:"",type:e,sessionState:""}},e.prototype.getSignInUrl=function(){return FilesConfig.si},e.prototype.signOut=function(){this._expireAuthCookie("msa_auth:"),this._expireAuthCookie("graph_auth:"),this._expireAuthCookie("substrate_auth:")},e.prototype.getSessionToken=function(e,t,n){void 0===e&&(e=!1),void 0===t&&(t=!1);var a=t?"msa_strong_auth:":"msa_auth:";return this._getToken(a,this._getResouceByTokenType(a),e,n)},e.prototype.getGraphToken=function(e){var t=e.forceRefresh,n=void 0!==t&&t,a=e.claimsChallenge;return this._getToken("graph_auth:",this._getResouceByTokenType("graph_auth:"),n,a)},e.prototype.getPhoneLinkToken=function(e){var t=e.resource,n=e.forceRefresh,a=void 0!==n&&n,i=e.claimsChallenge;return this._getToken("phone_link:",t,a,i)},e.prototype.getSubstrateToken=function(e,t){return this._getToken("substrate_auth:",this._getResouceByTokenType("substrate_auth:"),t)},e.prototype.getAuthUrl=function(e,t){var n=new u.t("https://login.live.com/oauth20_authorize.srf");if(n.setQueryParameter("client_id","00000000481710A4"),n.setQueryParameter("res","success"),n.setQueryParameter("resuictx","selection"),n.setQueryParameter("response_type","token"),this.getIdentity().type===i.e.msa){var a="sa.html";t?a="saroot.html":"soak2"===FilesConfig.env?a="sasoak2.html":"soak3"===FilesConfig.env?a="sasoak3.html":"dev"===FilesConfig.env&&(a="sadev.html"),n.setQueryParameter("redirect_uri","https://p.sfx.ms/".concat(a)),t||"msa_strong_auth:"===e||n.setQueryParameter("display","none");var r=void 0;switch(e){case"msa_auth:":case"msa_strong_auth:":r="dev"===FilesConfig.env||FilesConfig.isSpoSandbox?"onedrive-devbox.access":"msa_strong_auth:"===e?"onedrive_implicit_forceSA.access":"onedrive_implicit.access";break;case"graph_auth:":Object(m.es)(m.wo)?(r="contacts.read Files.ReadWrite people.read",Object(y.e)()&&(r+=" Mail.Read"),Object(m.es)(m.rn)&&(r+=" Family.Read")):r="contacts.read";break;case"substrate_auth:":r="https://substrate.office.com/M365.Access"}return n.setQueryParameter("scope",r),I.e.isActivated("EF2D0BBC-FA1F-44F7-A93D-899C2AB1F098","","")||n.setQueryParameter("login_hint",$Config.email),n.toString()}return $Config.silentAuth},e.prototype.refreshAuthTicket=function(){this._silentAuthRpsIframe&&document.body.removeChild(this._silentAuthRpsIframe),this._rpsIFrameQosEvent=new c.e({name:"IdentityDataSource.refreshAuthTicket"}),this._silentAuthRpsIframe=document.createElement("iframe");var e=$Config.silentAuth;this._silentAuthRpsIframe.src=e.replace(r.e.encodeURIComponent("{{RU}}"),r.e.encodeURIComponent("https://onedrive.live.com/sa?msaCallback=1")),document.body.appendChild(this._silentAuthRpsIframe)},e.prototype._refreshCanary=function(){(new _.e).send({apiName:"getPageContext",url:"/getpagecontext"}).then(function(e){e.canary&&FilesConfig.canary!==e.canary&&(FilesConfig.canary=e.canary)})},e.prototype._getToken=function(e,t,n,r){if(!this._tokenFetcher){if(this.getIdentity().type===i.e.aad)return o.n.reject("Unable to get a token for a business account");if(Object(m.es)(m.se)&&this.getIdentity().type===i.e.anonymous)return o.n.reject("Unable to silent auth anonymous unauth users.")}var d;switch(e){case"graph_auth:":d="Graph";break;case"msa_strong_auth:":d="MSAStrong";break;case"phone_link:":d="PhoneLink";break;case"substrate_auth:":d="Substrate";break;default:d="MSA"}var l=new c.e({name:"IdentityDataSource.get".concat(d,"Token")}),u=this._getTokenFromCache(e),f=u.token,p=u.shouldRefresh,_=u.hadCookie;if(n||r){f=void 0;var h=this._tokenRefreshCooldowns[e];h&&h.complete()}if((p||!f)&&!this._pendingSignals[e]){var b=this._pendingSignals[e]=new s.e;this._tokenFetcher?this._tokenFetcher.getToken({resource:t,tokenType:d,name:d,claimsChallenge:r}).then(function(e){b.complete(Object(a.__assign)({accessToken:e.access_token},"WLID1.1"===e.scheme?{wlidToken:e.access_token}:{}))},function(e){b.error(e)}):this._setupSilentAuthIframe(e)}return f?(l.end({resultType:c.t.Success,resultCode:p?"withinExpiration":"cached",error:_?void 0:"noCookie"}),o.n.resolve({accessToken:f})):this._pendingSignals[e].getPromise().then(function(e){return l.end({resultType:c.t.Success,resultCode:"fullRefresh"}),e},function(e){return l.end({resultType:c.t.Failure,error:e&&e.message}),o.n.reject(e)})},e.prototype._writeTokenToCache=function(e,t,n){this._writeAuthCookie(e,t,n);var a=Date.now()+1e3*(x&&"substrate_auth:"===e?3600:n);if(this._tokenCache){var i=this._getTokenCacheKey(e);this._tokenCache.setValue(i,{value:t,expiration:a})}},e.prototype._getTokenFromCache=function(e){var t=this._getTokenFromCookie(e);if(this._tokenCache){var n=Date.now(),a=this._getTokenCacheKey(e),i=this._tokenCache.getValue(a,n);if(i)return{token:i.value,shouldRefresh:n+6e4>i.expiration,hadCookie:!!t}}return{token:t,shouldRefresh:!t,hadCookie:!!t}},e.prototype._writeAuthCookie=function(e,t,n){var a=this._getTokenCacheKey(e),i=Date.now()+1e3*(x&&"substrate_auth:"===e?3600:n);S.set(a,t,{path:"/",secure:!0,expires:new Date(i).toUTCString()})},e.prototype._getTokenFromCookie=function(e){var t=this._getTokenCacheKey(e);return S.get(t)},e.prototype._expireAuthCookie=function(e){var t=this._getTokenCacheKey(e);S.expire(t,{secure:!0,path:"/"})},e.prototype._getTokenCacheKey=function(e){return e+this.getIdentity().id+this._sessionId},e.prototype._onMessageReceived=function(e){if(this._silentAuthRpsIframe&&e.source===this._silentAuthRpsIframe.contentWindow&&e.origin===window.location.origin&&e.data){var t=this._rpsIFrameQosEvent;"MSA_AuthenticationSuccess"===e.data?(this._refreshCanary(),t.end({resultType:c.t.Success})):"MSA_AuthenticationError"===e.data&&t.end({resultType:c.t.Failure,resultCode:"error"})}else if(this._silentAuthIframe&&e.source===this._silentAuthIframe.contentWindow&&e.origin===this._silentAuthOrigin&&void 0!==this._silentAuthIframeTokenType){t=this._currentIFrameQosEvent;var n="",a=0;if(e.data&&"object"==typeof e.data&&"ODSA"===e.data.source)n=e.data.token,a=parseInt(e.data.expiresIn,10);else{if("string"!=typeof e.data)return;var i=e.data.split(" ");if(2===i.length)n=i[0],a=parseInt(i[1],10);else if(1===i.length){var r=i[0].split("&"),o="error";if(C&&"unknown"===(null===$Config||void 0===$Config?void 0:$Config.email)&&(o="missingEmail"),t.end({resultType:c.t.Failure,resultCode:o}),0===r[0].indexOf("error=access_denied")){var s=null===$Config||void 0===$Config?void 0:$Config.anonId;Object(m.es)(m.qe)&&s&&"missingEmail"!==o&&window.open(this.getAuthUrl(this._silentAuthIframeTokenType,!0),"_self")}return}}if(n&&a>0){this._writeTokenToCache(this._silentAuthIframeTokenType,n,a),t.end({resultType:c.t.Success});var d=this._pendingSignals[this._silentAuthIframeTokenType];d&&d.complete({accessToken:n})}else t.end({resultType:c.t.Failure,resultCode:"invalidToken"});this._removeSilentAuthIframe(this._silentAuthIframeTokenType,!0)}},e.prototype._setupSilentAuthIframe=function(e){var t=this;if(!this._silentAuthIframe){this._authFrameAttempts[e]++,this._silentAuthIframeTokenType=e;var n=this._tokenRefreshCooldowns[e];o.n.resolve(n&&n.getPromise()).then(function(){var n=t._currentIFrameQosEvent=new c.e({name:"IdentityDataSource.getTokenViaIFrame",extraData:{authTokenType:e,attemptCount:t._authFrameAttempts[e]}});t._silentAuthIframe=document.createElement("iframe"),t._silentAuthIframe.style.display="none",t._silentAuthIframe.src=t.getAuthUrl(e),document.body.appendChild(t._silentAuthIframe),t._silentAuthIframeTimeoutId=t._async.setTimeout(function(){t._silentAuthIframeTimeoutId=void 0,n.end({resultType:c.t.Failure,resultCode:"timeout"}),t._authFrameAttempts[e]<5?(t._removeSilentAuthIframe(e,!1),t._setupSilentAuthIframe(e)):t._removeSilentAuthIframe(e,!0)},3e4)})}},e.prototype._removeSilentAuthIframe=function(e,t){if(this._silentAuthIframeTokenType=void 0,this._silentAuthIframe&&(document.body.removeChild(this._silentAuthIframe),this._silentAuthIframe=void 0),void 0!==this._silentAuthIframeTimeoutId&&(this._async.clearTimeout(this._silentAuthIframeTimeoutId),this._silentAuthIframeTimeoutId=void 0),this._enableCooldownAfterAuthFlow){var n=this._tokenRefreshCooldowns[e]=new s.e;this._async.setTimeout(function(){n.complete()},3e4)}if(t){var a=this._pendingSignals[e];a&&a.error(new Error("Timed out acquiring OAuth token.")),this._pendingSignals[e]=void 0,this._authFrameAttempts[e]=0,this._pendingSignals["msa_auth:"]?this._setupSilentAuthIframe("msa_auth:"):this._pendingSignals["msa_strong_auth:"]?this._setupSilentAuthIframe("msa_strong_auth:"):this._pendingSignals["graph_auth:"]?this._setupSilentAuthIframe("graph_auth:"):this._pendingSignals["substrate_auth:"]&&this._setupSilentAuthIframe("substrate_auth:")}},e.dependencies={enableCooldownAfterAuthFlow:O,tokenFetcher:f.optional},e}(),E=Object(l.r)("IdentityDataSource",w)},function(e,t,n){"use strict";var a;n.d(t,"t",function(){return i}),function(e){e[e.unknown=-1]="unknown",e[e.normal=0]="normal",e[e.critical=1]="critical",e[e.full=2]="full",e[e.outOfSpace=3]="outOfSpace",e[e.overQuota=4]="overQuota",e[e.nearing=5]="nearing"}(a||(a={}));var i=function(e){switch(e){case a.normal:return"normal";case a.nearing:return"nearing";case a.critical:return"critical";case a.full:return"full";case a.outOfSpace:return"outOfSpace";case a.overQuota:return"overQuota";default:return"unknown"}};t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(157),i=n(220),r=function(){function e(){}return e.prototype.canHandleRequest=function(e){return!0},e.prototype.handleRequest=function(e,t){var n=new a.e(t);try{var r=new XMLHttpRequest;e.withCredentials&&(r.withCredentials=!0),r.open(e.requestType||"GET",e.url,!0),e.responseType&&(r.responseType=e.responseType),r.timeout=6e4;var o=e.useDefaultHeaders?Object(i.e)(e.headers):e.headers||{};for(var s in o.Accept||r.setRequestHeader("Accept","application/json;odata=verbose"),e.postData&&!o["Content-Type"]&&r.setRequestHeader("Content-Type","application/json;odata=verbose"),o)o[s]&&r.setRequestHeader(s,o[s]);r.onreadystatechange=function(){4===r.readyState&&n.complete(r)},r.send(e.postData)}catch(e){n.error(e)}return n.getPromise()},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"t",function(){return d});var a=n(0),i=n(110),r=n(20),o=n(46),s={canary:o.t.canary,Accept:"application/json",AppId:o.t.appId,"Cache-Control":"private","X-ForceCache":"1"};function c(e){var t=Object(a.__assign)(Object(a.__assign)({},s),e||{}),n=function(){var e=window.location.search,t="";if(e){var n=r.e(e.substring(1)).iam,a=i.get("aad_auth:"+n);if(a){var o="id_token=",s=a.indexOf(o);t=a.substring(s+o.length,a.indexOf("&",s))}}return t}();return n&&(t.Authorization="Bearer "+n),o.t.canary&&o.t.canary!==t.canary&&(t.canary=o.t.canary),t}function d(e,t){var n=e.useDefaultHeaders?c(e.headers):e.headers||{};return{onData:t,payload:{url:e.url,cb:t,v:e.requestType,verb:e.requestType,headers:n,postString:e.postData,cbp:e.progressCallback,timeout:6e4}}}o.t.oauthToken&&(s["X-Auth"]=o.t.oauthToken)},,,,,,,,,,function(e,t,n){"use strict";var a=function(){function e(e,t){!function(e){return!!e&&"object"==typeof e}(e)?(this.key=e,this.input=t,this.status=0):(this.key=e.key,this.input=e.input,this.output=e.output,this.status=e.status,this.error=e.error)}return e.prototype.succeed=function(t){var n=new e(this);return n.output=t,n.status=1,delete n.error,n},e.prototype.fail=function(t){var n=new e(this);return n.error=t,n.status=2,n},e.prototype.cancel=function(){var t=new e(this);return delete t.error,t.status=3,t},e.prototype.restart=function(){return new e(this.key,this.input)},e.prototype.changeInput=function(t){var n=t(this.input),a=new e(this.key,n);return a.output=this.output,a.status=this.status,a.error=this.error,a},e.prototype.changeOutput=function(t){var n=t(this.output),a=new e(this.key,this.input);return a.output=n,a.status=this.status,a.error=this.error,a},e.prototype.compare=function(e){return e&&this.input===e.input&&this.output===e.output&&this.error===e.error&&this.status===e.status?null:{previous:e,current:this}},e}();t.e=a},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o});var a=n(192),i=n(14),r={showFre:"showFre",showPremiumPositioning:"showPremiumPositioning",showNewFeaturesExperience:"showNewFeaturesExperience",showWelcomeExperience:"showWelcomeExperience",showFamiliesFre:"showFamiliesFre",showGroupsFre:"showGroupsFre",showHolidayPosFre:"showHolidayPosFre",showQuotaLevelUpsellFre:"showQuotaLevelUpsellFre",upsellOverride:"upsell",resetUpsellParams:"resetUpsells",spoSandbox:"spoSandbox",showPwaInstallDialog:"showPwaInstallDialog"};function o(e,t){var n;return void 0===t&&(t={}),(null===(n=window.__testHooks)||void 0===n?void 0:n[e])||t[e]||void 0}i.e.isActivated("8C62316A-3AF9-4CDB-875D-5C08EA8E7C21","02/24/2022","Stash ODC test hooks to window so that they persist throughout page load and in-app navigations")||function(){if(!window.__testHooks){window.__testHooks={};var e=location.search?location.search.substring(1):"",t=Object(a.e)(e);for(var n in r)t[n]&&(window.__testHooks[n]=t[n])}}()},,,,,function(e,t,n){"use strict";n(0),n(1);var a=n(263);n.d(t,"e",function(){return a.e}),n.d(t,"t",function(){return a.n})},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3),i=n(66),r=new a.t("identity");new a.t({name:"IdentityDataSource.key",loader:new i.t(function(){return n.ee([128],651).then(function(e){return e.resourceKey})})})},,function(e,t,n){"use strict";var a,i;function r(){return void 0===a&&(a=-1!==navigator.userAgent.indexOf("OneDriveWinApp")||function(){try{return!!window.sessionStorage.getItem("_isOneDriveWinApp")}catch(e){return!1}}()),a}function o(){if(void 0===i){var e=navigator.userAgent;i=-1!==e.indexOf("Xbox")&&-1!==e.indexOf("OneDriveWinApp")}return i}n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3),i=n(4),r=new a.t({name:"".concat("SharedItemsScopeExperiment.key",".isUseItemsScopeInSharedEnabled"),factory:new a.e(Object(i.es)(i._o))})},,function(e,t,n){"use strict";var a=n(358);n.d(t,"e",function(){return a.e})},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(85),i=function(){function e(e){this._proxySetup=!1,this._eventGroup=new a.t(window),this._requests=[],this._onAttach=e.onAttach,this._onReady=e.onReady,this._initIframeIfNotExist(e.source),window.$Network||(window.$Network={Proxy:{_registerProxy:r},onhttperror:{fire:function(){}}}),window.NextNetworkRegisterProxy=r}return e.prototype.createRequest=function(e){this._proxySetup?this._doRequest(e):this._requests.push(e)},e.prototype.reloadIframe=function(e){var t=this._iframe.src;document.body.removeChild(this._iframe),this._proxySetup=!1,this._iframe=void 0,this._initIframeIfNotExist(e||t)},e.prototype._attachToIframe=function(e){var t=this;this._eventGroup.on(e,"iframeReady",function(){t._eventGroup.off(e),t._onProxyReady()}),this._onAttach&&this._onAttach(e)},e.prototype._onProxyReady=function(){this._onReady&&this._onReady(),this._proxySetup=!0;for(var e=0,t=this._requests;e<t.length;e++){var n=t[e];this.createRequest(n)}this._requests=[]},e.prototype._doRequest=function(e){this._iframe.contentWindow.fetchXML(e.payload,null,null,e.onData)},e.prototype._initIframeIfNotExist=function(e){var t,n;this._iframe||(this._iframe=(t=this._iframe,n=e,(t=document.createElement("iframe")).style.display="none",t.src=n,t),this._attachToIframe(this._iframe),document.body.insertBefore(this._iframe,document.body.firstChild))},e}();function r(e){var t=e.frameElement;a.t.raise(t,"iframeReady")}},,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r});var a="List",i="Grid",r="Album"},function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=(window.FilesConfig&&window.FilesConfig.skyApiDomain)+"/API/2/";function i(){return a+"GetUserInfo"}function r(){return a+"SetUserInfo"}},function(e,t,n){"use strict";var a=n(157),i=n(40),r=function(){function e(){}return e.start=function(e){var t=new a.e(function(){for(var e=0,t=o;e<t.length;e++)t[e].cancel()}),n=e.items.slice(),r=e.parallelRequests||1,o=[];function s(e){var t=o.indexOf(e);t>=0&&o.splice(1,t)}function c(){var a=new i.e,r=n.splice(0,e.batchSize),d=JSON.stringify(e.getPostData(r)),l=a.send({apiName:e.apiName,url:e.url,requestType:"POST",postData:d,isErrorExpectedCallback:e.isErrorExpectedCallback}).then(function(){s(l),e.onBatchComplete&&e.onBatchComplete(r),n.length?c():t.complete()},function(e){s(l),function(e){t.error(e)}(e)});o.push(l)}for(var d=0;n.length>0&&d<r;d++)c();return t.getPromise()},e}();t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(3).n)({owner:"OneDriveRoot",useFactoriesOnKeys:!0})},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i});var a=1,i=10},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"n",function(){return c}),n.d(t,"i",function(){return d}),n.d(t,"a",function(){return l});var a=n(16),i=n(5),r=["","Lock","Unlock","Manage","FreDialog","Unlock","Reset","Debug","FilesRemaining"],o="PVault-IconUpsell",s="PVault-QuotaBannerLearnMore",c="PVault-QuotaErrorLearnMore";function d(e){return r[e]}function l(e,t){var n;switch(e){case a.e.Files:n="Files";break;case a.e.Restore:n="Restore";break;case a.e.RansomwareDetection:n="RansomwareDetection";break;case a.e.ManageVault:n="ManageVault";break;default:n=""}return t?"".concat(n,"-").concat(i.e[t]):"".concat(n)}},,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3),i=n(66),r=new a.t({name:"VaultDataSource.key",loader:new i.t(function(){return n.ee(0,412).then(function(e){return e.resourceKey})})})},,function(e,t,n){"use strict";var a,i;n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i}),function(e){e[e.Storage50GbPlanMonthly=1]="Storage50GbPlanMonthly",e[e.Storage50GbPlanAnnual=2]="Storage50GbPlanAnnual",e[e.OfficeHomeMonthly=3]="OfficeHomeMonthly",e[e.OfficeHomeAnnual=4]="OfficeHomeAnnual",e[e.OfficePersonalMonthly=5]="OfficePersonalMonthly",e[e.OfficePersonalAnnual=6]="OfficePersonalAnnual",e[e.OfficeTrial=7]="OfficeTrial",e[e.OfficeOffer1YearFree=8]="OfficeOffer1YearFree",e[e.OfficeSolo=9]="OfficeSolo",e[e.OfficeHomeLearnMore=10]="OfficeHomeLearnMore",e[e.OfficePersonalLearnMore=11]="OfficePersonalLearnMore",e[e.ChangeCurrency=12]="ChangeCurrency",e[e.OfficePersonalTermsAndConditions=13]="OfficePersonalTermsAndConditions",e[e.FeatureCardStorage=14]="FeatureCardStorage",e[e.FeatureCardProductivity=15]="FeatureCardProductivity",e[e.FeatureCardSecurity=16]="FeatureCardSecurity",e[e.FeatureCardSharing=17]="FeatureCardSharing",e[e.FeatureCardOfficeApps=18]="FeatureCardOfficeApps",e[e.LaunchFeatureCard=19]="LaunchFeatureCard",e[e.LaunchSeeAllFeatures=20]="LaunchSeeAllFeatures",e[e.MonthlyAnnualPriceToggle=21]="MonthlyAnnualPriceToggle",e[e.StoragePlanOnSlider=22]="StoragePlanOnSlider",e[e.OfficePersonalOnSlider=23]="OfficePersonalOnSlider",e[e.OfficeHomeOnSlider=24]="OfficeHomeOnSlider",e[e.SelectPlanOnSlider=25]="SelectPlanOnSlider",e[e.EmbedConfiguratorLinkShown=26]="EmbedConfiguratorLinkShown",e[e.EmbedConfiguratorClick=27]="EmbedConfiguratorClick",e[e.WhatsTakingUpSpace=28]="WhatsTakingUpSpace",e[e.SelectedOfficeHomeMonthly=29]="SelectedOfficeHomeMonthly",e[e.SelectedOfficePersonalMonthly=30]="SelectedOfficePersonalMonthly",e[e.PlansInterruptDialogAnnualOption=31]="PlansInterruptDialogAnnualOption",e[e.PlansInterruptDialogMonthlyOption=32]="PlansInterruptDialogMonthlyOption",e[e.PrintPdfNative=33]="PrintPdfNative",e[e.PrintPdfDownloadOptionShown=34]="PrintPdfDownloadOptionShown",e[e.PrintPdfDownloadOptionClicked=35]="PrintPdfDownloadOptionClicked",e[e.SharedViaFacebook=36]="SharedViaFacebook",e[e.SharedViaTwitter=37]="SharedViaTwitter",e[e.SharedViaLinkedIn=38]="SharedViaLinkedIn",e[e.SharedViaSinaWeibo=39]="SharedViaSinaWeibo",e[e.ShowPlansInterruptDialog=40]="ShowPlansInterruptDialog",e[e.ClosePlansInterruptDialog=41]="ClosePlansInterruptDialog",e[e.Shown100GbPlanInterruptDialog=42]="Shown100GbPlanInterruptDialog",e[e.ShownRedeemSamsungBonusDialog=43]="ShownRedeemSamsungBonusDialog",e[e.InterruptO365Clicked=44]="InterruptO365Clicked",e[e.InterruptOD50Clicked=45]="InterruptOD50Clicked",e[e.DownloadOfficeApps=46]="DownloadOfficeApps",e[e.QuotaUsageClick=47]="QuotaUsageClick",e[e.GetAdditionalStorageClick=48]="GetAdditionalStorageClick",e[e.UnipuxExperiencePurchaseClick=49]="UnipuxExperiencePurchaseClick",e[e.AADCPurchaseBlock=50]="AADCPurchaseBlock",e[e.StorageInfoUpsellClick=51]="StorageInfoUpsellClick"}(a||(a={})),function(e){e[e.OfficePlansSection=1]="OfficePlansSection",e[e.StoragePlansSection=2]="StoragePlansSection",e[e.UpgradePage=3]="UpgradePage",e[e.BelowQuotaProgressBar=4]="BelowQuotaProgressBar",e[e.EmbedPane=5]="EmbedPane",e[e.OneUp=6]="OneUp",e[e.SharingDialog=7]="SharingDialog",e[e.ManageStoragePage=8]="ManageStoragePage"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(3).t)("engagementHandlers")}].concat(Array(23),[function(e,t,n){"use strict";n.d(t,"e",function(){return m}),n.d(t,"a",function(){return _}),n.d(t,"t",function(){return h}),n.d(t,"n",function(){return b});var a=n(0),i=n(7),r=n(87),o=n(634),s=n(135),c=n(515),d=n(12),l=n(3),u=n(66),f=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this,i=a.observables;a._selectionModel=n.itemSetSelectionModel,a._clientSideExtensionHelper=n.clientSideExtensionHelper,a._itemsStore=n.itemsStore;var s=a.selection=new o.e({selectionMode:1===a._selectionModel.mode?r.n.single:r.n.multiple,onSelectionChanged:a._onSelectionChange.bind(a),getKey:a.getKey.bind(a),canSelectItem:a._canSelectItem.bind(a)});return a._isModal=i.create(!!s.isModal&&s.isModal()),i.compute(a._computeUpdateItems),i.backgroundCompute(a._computeUpdateReactSelection),a.isModal=i.compute({read:function(){return a._isModal()},write:function(e){return s&&s.setModal(e)},pure:!0}),a}return Object(a.__extends)(t,e),t.prototype.getKey=function(e,t){return e&&this._selectionModel.getItemKey(this._itemsStore.getItem("".concat(e.key)))||"".concat(t)},t.prototype._computeUpdateReactSelection=function(){var e=this,t=this._selectionModel,n=this.selection,a=t.selection();this.observables.ignore(function(){if(e._shouldUpdateSelection())if(0===t.mode&&(t.isAllSelected()&&!n.isAllSelected()||0===t.selectedCount()&&n.isAllSelected()))n.setAllSelected(t.isAllSelected()&&!n.isAllSelected());else{n.setChangeEvents(!1),n.setAllSelected(!1);for(var i=0,r=a;i<r.length;i++){var o=r[i];n.setKeySelected(t.getItemKey(o),!0,!1)}n.setChangeEvents(!0)}})},t.prototype._shouldUpdateSelection=function(){var e=this._selectionModel,t=this.selection,n=!1;if(e.selectedCount()!==t.count||0===e.mode&&e.isAllSelected()!==t.isAllSelected())n=!0;else if(!t.isAllSelected()||1===e.mode)for(var a=0,i=e.selection();a<i.length;a++){var r=i[a];if(!t.isKeySelected(e.getItemKey(r))){n=!0;break}}return n},t.prototype._onSelectionChange=function(){var e=this;this.observables.ignore(function(){var t=e._selectionModel,n=e.selection;if(e._isModal(!!n.isModal&&n.isModal()),e._shouldUpdateSelection()){if(n.mode===r.n.multiple&&(!t.isAllSelected()&&n.isAllSelected()||t.isAllSelected()&&0===n.count))!t.isAllSelected()&&n.isAllSelected()?t.selectAll():t.clear();else{for(var a=[],i=0,o=n.getSelection();i<o.length;i++){var s=o[i],c=e.getKey(s);a.push(c)}t.setSelectedKeys(a)}var d=e._clientSideExtensionHelper;d&&d.raiseListChangeEvent(n.getSelection())}})},t.prototype._computeUpdateItems=function(){var e=this,t=this._selectionModel.itemSet(),n=[];if(t)for(var a=0,i=t.content().items;a<i.length;a++){var r=i[a],o=this.observables.peekUnwrap(r);o?n.push(o):n.push(void 0)}this.observables.ignore(function(){var a=t&&e.observables.peekUnwrap(t.item);(t&&!t.isPlaceholder||a&&a.isStub)&&e.selection.setItems(n,!1)})},t.prototype._canSelectItem=function(e){var t=this;return this.observables.ignore(function(){return t._selectionModel.canSelectItem(t._itemsStore.getItem(e.key))})},t}(i.n),p=new l.t({name:"".concat("SelectionManager",".selectionManager"),factory:new u.n(f,Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemSetSelectionModel:d.b,clientSideExtensionHelper:c.e.optional,itemsStore:s.e}))}),m=new l.t({name:"".concat("SelectionManager",".getKey"),factory:{dependencies:{selectionManager:p},create:function(e){var t=e.selectionManager;return{instance:function(e,n){return t.getKey(e,n)}}}}}),_=new l.t({name:"".concat("SelectionManager",".selectionMode"),factory:{dependencies:{itemSetSelectionModel:d.b},create:function(e){return{instance:0===e.itemSetSelectionModel.mode?r.n.multiple:r.n.single}}}}),h=new l.t({name:"".concat("SelectionManager",".getKey"),factory:{dependencies:{selectionManager:p},create:function(e){return{instance:e.selectionManager.isModal}}}}),b=new l.t({name:"SelectionManager",factory:{dependencies:{selectionManager:p},create:function(e){return{instance:e.selectionManager.selection}}}});new l.t({name:"".concat("SelectionManager",".hasSelection"),factory:{dependencies:{itemSetSelectionModel:d.b,isSelectionModal:h,observablesFactoryType:i.i},create:function(e){var t=new e.observablesFactoryType,n=e.itemSetSelectionModel,a=e.isSelectionModal;return{instance:t.pureCompute(function(){return a()||n.selectedCount()>0}),disposable:t}}}})},,function(e,t,n){"use strict";n.d(t,"n",function(){return g}),n.d(t,"a",function(){return v}),n(420),n(62);var a,i,r,o,s,c=n(43),d=n(325);n.d(t,"e",function(){return d.e}),n.d(t,"t",function(){return d.t}),n.d(t,"i",function(){return d.n}),n.d(t,"r",function(){return d.a}),n.d(t,"o",function(){return d.i});var l="ms-word",u="onenote|UsePlain",f="ms-powerpoint",p="ms-excel",m="ms-visio",_="ms-publisher",h="ms-project";(a={})[l]=c.OpenInWordOnline,a[u]=c.OpenInOneNoteOnline,a[f]=c.OpenInPowerPointOnline,a[p]=c.OpenInExcelOnline,a[m]=c.OpenInVisioOnline,(i={})[l]=c.OpenInWord,i[u]=c.OpenInOneNote,i[f]=c.OpenInPowerPoint,i[p]=c.OpenInExcel,i[m]=c.OpenInVisio,i[_]=c.OpenInPublisher,i[h]=c.OpenInProject,i["ms-infopath"]=c.OpenInInfoPath;var b=((r={})[l]="Word",r[u]="OneNote",r[f]="PowerPoint",r[h]="Project",r[m]="Visio",r[p]="Excel",r);function g(e){var t=e.extension;return t&&".pdf"===t.toLowerCase()?"WordPdf":b[e.appMap]||"Word"}function v(e){return b[e]}(o={})[l]="WordLogo",o[u]="OneNoteLogo",o[f]="PowerPointLogo",o[p]="ExcelLogo",o[m]="VisioLogo",o[_]="Page",(s={})[l]="svg/word_16x1.svg",s[u]="svg/onenote_16x1.svg",s[f]="svg/powerpoint_16x1.svg",s[p]="svg/excel_16x1.svg",s[m]="svg/visio_16x1.svg",s[_]="Page",s.Stream="svg/stream_16x1.svg"},function(e,t,n){"use strict";var a=n(0),i=n(7),r=n(230);n.d(t,"t",function(){return r.e});var o=n(408),s=n(31),c=n(157),d=n(163),l=n(44),u=n(193),f=n(109);n.d(t,"e",function(){return f.e});var p=n(178),m=n(425),_="_BaseOperator_actionName",h=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a._actionsByName={};var i=n.operationProvider,r=void 0===i?a.resources.consume(d.e):i,s=n.operatorBatchMonitorType,c=void 0===s?a.resources.consume(m.e):s;return a._operationProvider=r,a._operationBatch=new p.e,a._operatorBatchMonitor=a.scope.attach(new c({operationBatch:a._operationBatch,onOperationFinished:function(e){return a.onOperationFinished(e)}})),a._operationsByKey={},a._observer=a.addDisposable(new o.e(a._onTaskChanges.bind(a))),a._throttleExecuteAllActions=a.async.debounce(a._executeAllActions),a.registerActions({cancel:a.onCancel}),a}return Object(a.__extends)(t,e),t.prototype.dispose=function(){e.prototype.dispose.call(this),this._observer=null,this._actionsByName={},this._getActionExecutor=null,this._onTaskChanges=null,this._operationsByKey={},this._throttleExecuteAllActions=null},t.prototype.start=function(){var e=this;return this._operatorBatchMonitor.start(function(){return e.onStart(e._observer)})},t.prototype.wait=function(){var e=this;return this._operatorBatchMonitor.wait().then(function(){e.dispose()},function(){e.dispose()})},t.prototype.onStart=function(e){return s.n.wrap()},t.prototype.onCancel=function(e,t){return e=e.map(function(e){return e.cancel()}),t.update(e),s.n.wrap()},t.prototype.registerActions=function(e){for(var t in e){var n=e[t];n?(n[_]=t,this._actionsByName[t]={action:e[t],callback:e[t].bind(this),queue:[],signal:new c.e}):delete this._actionsByName[t]}},t.prototype.getOperationDetails=function(e){var t;return t=1===e.status?l.e.completed:2===e.status?l.e.failed:3===e.status?l.e.canceled:l.e.started,{type:f.e.multiple,name:"",iconName:null,error:e.error&&new u.e({message:e.error.message,payloads:{}})||null,state:t,progress:{minimum:0,maximum:3!==e.status?1:0,current:1===e.status?1:0},visibility:0,payloads:{},actions:[]}},t.prototype.onOperationFinished=function(e){},t.prototype._queueTaskForAction=function(e,t){var n=this._actionsByName[e];return n.queue.push(t),this._throttleExecuteAllActions(),n.signal.getPromise()},t.prototype._executeAllActions=function(){for(var e in this._actionsByName){var t=this._actionsByName[e],n=t.signal;if(t.signal=new c.e,t.queue.length){var a=t.queue.splice(0,t.queue.length);t.callback(a,this._observer).done(b(n),g(n))}}},t.prototype._onTaskChanges=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t];this._updateOperationForTask(a)}},t.prototype._updateOperationForTask=function(e){var t,n=e.current,a=this.getOperationDetails(n),i=this._operationsByKey[n.key];t={};for(var r=0,o=a.actions;r<o.length;r++){var s=o[r],c=s[_],d=this._actionsByName[c];d&&d.action===s&&(t[c]=!0)}if(!i){var l={};for(var c in this._actionsByName)l[c]={isAvailable:this.createObservable(c in t),execute:this._getActionExecutor(c,n)};var u={batch:this._operationBatch,type:a.type,name:a.name,iconName:a.iconName,payloads:a.payloads,progress:a.progress,visibility:a.visibility,actions:l};i=this._operationsByKey[n.key]=this._operationProvider.register(u)}for(var c in i.name!==a.name&&(i.name=a.name,i.payloads(a.payloads)),i.progress.minimum(a.progress.minimum),i.progress.maximum(a.progress.maximum),i.progress.current(a.progress.current),i.type(a.type),i.error(a.error),i.state(a.state),this._actionsByName)i.actions.peek()[c].isAvailable(c in t)},t.prototype._getActionExecutor=function(e,t){var n=this;return function(){return n._queueTaskForAction(e,t)}},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{operationProvider:d.e,operatorBatchMonitorType:m.e}),t}(i.n);function b(e){return function(){return e.complete()}}function g(e){return function(t){return e.error(t)}}t.n=h},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3),i=n(259),r=new a.t({name:"NeedsOverlayContent.key",factory:{dependencies:{},create:function(){return{instance:{needsOverlayContent:new i.e(!1)}}}}})},,,function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.notConfigured=0]="notConfigured",e[e.visible=1]="visible",e[e.notVisible=2]="notVisible"}(a||(a={}))},,function(e,t,n){"use strict";var a=n(635);t.e=a.e},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(3),i=new a.t("rumOneHelper");new a.t("rumOneListsHomeHelper"),new a.t("RUMOneScenarioPrefix")},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return p}),n.d(t,"n",function(){return m}),n.d(t,"t",function(){return _}),n(29);var a=n(126),i=n(72),r=(n(30),"Doc"),o="One",s="Ppt",c="Xls",d="Vsd",l="Lib",u="Drive",f={WinDocuments:l,WinLibrary:l,WinMusic:l,WinPictures:l,WinPodcastLibrary:l,WinVideos:l,WinDrive:u,CDDrive:"CDDrive",GenericDrive:u,UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:r,Docm:r,Docx:r,Dot:r,Dotm:r,Dotx:r,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:s,Ods:c,Odt:r,One:o,Onepkg:o,Onetoc2:o,Notebook:"OneNotebook",Pot:s,Potm:s,Potx:s,Ppa:s,Ppam:s,Pps:s,Ppsm:s,Ppsx:s,Ppt:s,Pptm:s,Pptx:s,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:d,Vsd:d,Vsdm:d,Vsdx:d,Vsl:d,Vss:d,Vssm:d,Vssx:d,Vst:d,Vstm:d,Vstx:d,Xaml:"Xaml",Xla:c,Xlam:c,Xll:c,Xls:c,Xlsb:c,Xlsm:c,Xlsx:c,Xlt:c,Xltm:c,Xltx:c,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};function p(e){var t=a.fileTypeNoExtension;if(!e)return t;var n,r=(n=i.e(e),f[n]);if(r)return a["fileType"+r];var o=e.toUpperCase();return o?i.s(a.fileTypeUnknown,o):t}function m(e){return _(e)&&!!e.properties.newTag}function _(e){return!!e.properties&&!!e.properties.autoAlbumTag}},function(e,t,n){"use strict";var a=n(0),i=n(246),r=n(68),o=function(e){function t(t){var n=e.call(this,t)||this,i=n.valueAccessor();n._platform=n.resources.consume(r.e.optional),n._isPermanent="object"==typeof i&&i.isPermanent||!1,n._isReentrant="object"==typeof i&&i.isReentrant||!1,document.activeElement===n.element&&n._select();var o=Object(a.__assign)({focus:n._onFocus,focusin:n._onFocus,mouseup:n._onMouseUp},n._isReentrant?{focusout:n._onFocusOut}:{});return n.events.onAll(n.element,o),n}return Object(a.__extends)(t,e),t.prototype._select=function(){var e=this.element;if((this._isPermanent||!this._hasSelected)&&"function"==typeof this.element.select){e.select();try{this._platform.isIOS&&e.value&&e.setSelectionRange(0,e.value.length)}catch(e){}return this._hasSelected=!0,!0}return!1},t.prototype._onFocus=function(e){return this._select(),!0},t.prototype._onFocusOut=function(){return this._hasSelected=!1,!0},t.prototype._onMouseUp=function(e){if(this._select())return!1},t}(i.t);t.e=o},,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(3).t)("attributionHelper")},,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(t){var n=e.call(this,t)||this;return n.html=t.html,n}return Object(a.__extends)(t,e),t}(n(98).e),r=n(99).e({tagName:"ms-html-container",template:'<div class="HTMLContainer" data-bind="html:html"></div>',viewModel:i});t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"n",function(){return i});var a={idParamKey:"id",parentIdParamKey:"parent",driveIdParamKey:"driveId",driveEndpointParamKey:"endpoint",queryTypeParamKey:"view",pageParamKey:"p",parentQueryTypeParamKey:"parentview",windowNameJsonKey:"ODBParams",queryParamKey:"q",conversationIdParamKey:"cvid",metadataSearchIdKey:"searchid",uniqueParamKey:"u",navParamKey:"nav",localeKey:"locale",dateFilterKey:"dateFilter",typeFiltersKey:"typeFilters",userFiltersKey:"userFilters",viewIdKey:"viewid",viewPathKey:"viewpath",isPowerAppView:"isPowerAppView",listIdKey:"listid",listUrlKey:"listurl",sortFieldKey:"sortField",isAscendingKey:"isAscending",policyTipKey:"policyTipForListItemId",sharingKey:"sharingDialogForListItemId",managePermissionsKey:"managePermissionsForListItemId",pseudoPolicyTipKey:"showpolicytips",groupByKey:"groupBy",errorTypeKey:"type",correlationIdKey:"correlation",approvalItemVersion:"approvalItemVersion",commentIdKey:"commentId",emailCTRParamKey:"e",useFiltersInViewXmlKey:"useFiltersInViewXml",itemId:"itemId",playlistLayout:"playlistLayout",needsAttentionViewKey:"needsAttentionView",requiredColumnsKey:"required",pickerLinkTypeKey:"link_type",pickerAADClientIdKey:"aad_client_id",pickerMSAClientIdKey:"msa_client_id",pickerSelectionModeKey:"selection_mode",pickerViewTypeKey:"view_type",pickerAccessLevelKey:"access",pickerReturnUrlKey:"ru",remoteItem:"remoteItem",stateParamKey:"state",callerId:"CallerId",callerScenarioId:"CallerScenarioId",listItemIdKey:"ID",rootFolderParamKey:"RootFolder",sourceKey:"Source",isDialogKey:"IsDlg",contentTypeId:"ContentTypeId",newTargetListUrlKey:"newTargetListUrl",shareLinkId:"slrid",settingKey:"setting",userExpirationPanelKey:"userExpiration",sharedLibraryCreated:"sharedLibraryCreated",expandPageRowLimitKey:"rowLimit",fileBrowserOptionsKey:"fileBrowser",groupIdKey:"groupId",odSkipAutoFocus:"odSkipAutoFocus",teamIdKey:"teamId",channelIdKey:"channelId",entityIdKey:"entityId",subEntityIdKey:"subEntityId",ringIdKey:"ringId",asidKey:"asid",sidKey:"sid",hostName:"hostName",returnUrl:"returnUrl",disableQueryAlterationKey:"dqa",searchScopeKey:"searchScope",action:"action",videoDriveId:"videoDriveId",videoItemId:"videoItemId",videoParentId:"videoParentId",referrer:"referrer",referrerScenario:"referrerScenario",viewerKey:"viewer",personIdKey:"personId",meetingIdKey:"meetingId",templateId:"templateId",sourceDoc:"sourcedoc",entryPoint:"entry",noAuthRedirect:"noAuthRedirect",appParamKey:"app",scenarioParamKey:"scenario",loadFormWithNucleus:"loadFormWithNucleus"},i=/^Filter(Field|Value|Type|Op|LookupId|Display)(s?)([1-9]|10)$/;t.t=a},function(e,t,n){"use strict";n.r(t),n.d(t,"ODB_LEFT_NAV",function(){return I}),n.d(t,"NEW_OFFICE_FILE",function(){return x}),n.d(t,"ODC_PHOTOS_SEARCH",function(){return C}),n.d(t,"DOCSET_PROPERTIES_PANE",function(){return O}),n.d(t,"PHOTO_LAYOUT",function(){return E}),n.d(t,"ODC_MOBILE_APP_UPSELL",function(){return L}),n.d(t,"ODC_WEB_COMMENTS",function(){return k}),n.d(t,"EXPIRING_SHARING_LINKS",function(){return M}),n.d(t,"FLOW_REQUEST_SIGNOFF",function(){return P}),n.d(t,"FLOW_REMIND_ME",function(){return U}),n.d(t,"FLOW_ODB_COMMAND_BAR_COACHMARK",function(){return H}),n.d(t,"RECENT_VIEW",function(){return N}),n.d(t,"LEFT_NAV_SITE_PINNING",function(){return B}),n.d(t,"GO_TO_SITE",function(){return j}),n.d(t,"ADD_TO_ONEDRIVE_COMMAND",function(){return V}),n.d(t,"ADD_TO_ONEDRIVE_COMMAND_CFT",function(){return z}),n.d(t,"PHOTO_EDIT",function(){return G}),n.d(t,"PDF_EDIT",function(){return K}),n.d(t,"PDF_EXTRACT_MERGE",function(){return W}),n.d(t,"PDF_GET_ESIGNATURES",function(){return q}),n.d(t,"LAUNCH_LIST_BUSINESS_APPS_SETUP_WIZARD_COMMAND",function(){return Q}),n.d(t,"LAUNCH_LIBRARY_BUSINESS_APPS_SETUP_WIZARD_COMMAND",function(){return Y}),n.d(t,"METADATA_SEARCH_TEACHING_BUBBLE",function(){return J}),n.d(t,"CONTENT_QUERY_DISCOVERY_TEACHING_BUBBLE",function(){return X}),n.d(t,"CONTENT_QUERY_DISCOVERY_TEACHING_BUBBLE_SECONDARY",function(){return Z}),n.d(t,"METADATA_SEARCH_QUERYABLE_FIELD",function(){return $}),n.d(t,"ADD_SMART_TEMPLATE",function(){return ee}),n.d(t,"GENERATE_CAAE_DOCUMENT",function(){return te}),n.d(t,"MODERN_TEMPLATE_VIEW_INFO",function(){return ne}),n.d(t,"USE_UNIVERSAL_ANNOTATION",function(){return ae}),n.d(t,"TMR_EXPIRATION_DATE_EDIT",function(){return ie}),n.d(t,"PHOTO_STORY",function(){return re}),n.d(t,"SHARE_TO_TEAMS",function(){return oe}),n.d(t,"BACK_UP_YOUR_PC_FILES",function(){return se}),n.d(t,"SETUP_DOCUMENT_ANALYSIS_FLOW_COMMAND",function(){return ce});var a=n(0),i=n(232),r=n(35),o=n(101),s=n(281),c=n(161),d=n(2),l=n(385),u=n(276),f=n(1),p=n(565),m=n(12),_=n(247),h=n(312),b=n(391),g=n(723),v=Object(g.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([71,"ondemand.resx-ondemand"],1665)];case 1:return[2,e.sent().PdfExtractAndMergeTeachingBubbleContent]}})})}),y=n(69),S=Object(g.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([183,"ondemand.resx-ondemand"],1787)];case 1:return[2,e.sent().PsOnboardingTeachingBubbleContent]}})})}),D=Object(g.e)(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([72,"ondemand.resx-ondemand"],1666)];case 1:return[2,e.sent().PdfGetESignaturesTeachingBubbleContent]}})})}),I={campaignGuid:"49FEA7F9-6B31-4C2C-95EC-A9246E51D22C",startDate:new Date(2014,8,29),endDate:new Date(2016,4,1),title:r.B,bodyCopy:r.N,flag:d.Off,colorVariation:o.e.themePrimary},x={campaignGuid:"1c2b5f74-1c33-4297-8199-97c78c2284c2",bodyCopy:r.u,flag:d.On,colorVariation:o.e.themePrimary,isDismissable:!0,isCoachmark:!0},C={campaignGuid:"D3F55EC7-C130-456E-8F27-2EA31F2D5B8D",startDate:new Date(2016,2,23),endDate:new Date(2019,2,23),bodyCopy:r.G,flag:d.PhotosSearchBubble,colorVariation:o.e.themePrimary},O={campaignGuid:"DB44A538-E6D0-4AC6-B735-3D77161E6E83",killSwitchGuid:"714AF444-CE4B-4A21-AFB9-71CAA861CC3D",title:r.p,bodyCopy:r.f,colorVariation:o.e.themePrimary,flag:d.DocumentSetsModernView,alignment:c.e.Left,isCoachmark:!0,isDismissable:!0,name:"DOCSET_PROPERTIES_PANE"},w=new i.e(100,s.e/2+4),E={campaignGuid:"C847EA02-D118-4C3E-A73E-8B2C5D9944DA",bodyCopy:r.z,flag:d.On,colorVariation:o.e.themePrimary,alignment:c.e.Right,offset:w},A=new i.e(s.e/2+4,0),L={campaignGuid:"523F0995-B7E2-4612-BEA5-A7EF9F949C64",title:r.T,bodyCopy:r.P,flag:d.EnableEnhancedMobileUpsell,alignment:c.e.Left,offset:A},k={campaignGuid:"FE1795D2-BC90-4CB0-9E1E-043738D734C8",teachingBubbleContentAs:function(e){var t=Object(_.t)(),n=t.consume(m.e),i=t.consume(p.e),r=e.defaultRender,o=e.onDismiss,s=Object(a.__rest)(e,["defaultRender","onDismiss"]),c=Object(u.e)(function(e){i.isPending=!0;var a=new(t.injected(n.ShowPropertiesAction))({useToggleBehavior:!1});a.execute(e),a.dispose(),o(e)}),d=Object(u.e)(function(e){i.isPending=!0,o(e)});if(o)return r?f.createElement(r,Object(a.__assign)({},s,{headline:h.t,hasCondensedHeadline:!1,onDismiss:o,primaryButtonProps:{text:h.n,onClick:c},secondaryButtonProps:{text:h.a,onClick:d}}),h.e):void 0},isDismissable:!0,flag:d.MentionTeachingUIAA,experimentData:Object(d.isFeatureEnabled)(d.MentionTeachingUI)?void 0:{name:"AtMentionTeachingUIExperiment",startDate:"8/24/2021"},aaToABExperimentFlight:d.MentionTeachingUIAB,directionalHint:y.e.bottomAutoEdge,persistentBeak:!0},M={campaignGuid:"A4776EC9-2059-4971-AB9C-4003C3C7B3D8",title:r._,bodyCopy:r.m,colorVariation:o.e.themePrimary,flag:d.On,alignment:c.e.Left,maxUserViewCount:1,isPremiumFeature:!0},P={campaignGuid:"A41001BA-6205-4730-A670-C89DD0D8451F",killSwitchGuid:"0EC0ED2B-06D2-4375-91E6-3CFF7E48B37D",experimentData:{name:"flowRequestSignOffCoachmarkExperiment2",startDate:"01/22/2019"},flag:d.FlowSignOffCoachmark,maxUserViewCount:1,title:r.C,isCoachmark:!0,isDismissable:!0,bodyCopy:r.x,automateExperimentBodyCopy:r.s,name:"FLOW_REQUEST_SIGNOFF"},T="flowRemindMeCoachmarkExperiment",U={campaignGuid:"87802041-45CB-4304-BFD1-E2E98E3CB31B",killSwitchGuid:"98802041-45CB-4304-BFD1-E2E98E3CB31C",compatibleCampaign:P,experimentData:{name:Object(d.isFeatureEnabled)(d.UseLegacyCoachmarkExperiment)?T:"".concat(T).concat(2),startDate:Object(d.isFeatureEnabled)(d.UseLegacyCoachmarkExperiment)?"10/17/2018":"01/22/2019"},flag:d.FlowRemindMeCoachmark,maxUserViewCount:1,title:r.I,isCoachmark:!0,isDismissable:!0,bodyCopy:r.D,automateExperimentBodyCopy:r.o,name:"FLOW_REMIND_ME"},F="flowOdbCommandBarCoachmarkExperiment",H={campaignGuid:"FD86A6D7-F3D9-47EC-994C-D01AAB624F28",killSwitchGuid:"B35D963C-9FFD-4154-9A9B-E112B67E5BCA",experimentData:{name:Object(d.isFeatureEnabled)(d.UseLegacyCoachmarkExperiment)?F:"".concat(F).concat(2),startDate:Object(d.isFeatureEnabled)(d.UseLegacyCoachmarkExperiment)?"10/17/2018":"01/22/2019"},flag:d.FlowOdbCommandBarCoachmark,maxUserViewCount:1,title:r.S,isCoachmark:!0,isDismissable:!0,bodyCopy:r.y,automateExperimentBodyCopy:r.r,name:"FLOW_ODB_COMMAND_BAR_COACHMARK"},R=new i.e(0,-40),N={campaignGuid:"696ee2ba-076d-400c-ae9a-0b28e71f567b",title:r.W,bodyCopy:r.K,colorVariation:o.e.themePrimary,flag:d.On,alignment:c.e.Left,offset:R},B={campaignGuid:"108dfc30-090d-4ab7-8575-372a28d7ee3a",title:r.M,bodyCopy:r.k,colorVariation:o.e.themePrimary,flag:d.ODBLeftNavPins,alignment:c.e.Left},j={campaignGuid:"976ef592-f66a-4d08-b837-ba3f9cda70fb",title:r.L,bodyCopy:r.A,colorVariation:o.e.themePrimary,flag:d.On,alignment:c.e.Left},V={campaignGuid:"94a29c48-ae93-44cc-94fa-bb106da7bb2d",flag:d.On,title:r.i,isCoachmark:!0,illustrationImage:{src:"".concat(window.require.toUrl("odsp-media/images/addtoonedrive/add2od_1x.gif")),alt:r.i,height:200},coachMarkStyles:function(e){var t=e.isCollapsed;return{entityHost:t&&{backgroundColor:"#0078D4"},childrenContainer:{selectors:{".ms-TeachingBubble-subText":{color:"#FFFFFF"},".ms-TeachingBubble-headline":{color:"#FFFFFF"},".ms-TeachingBubble-closebutton":{color:"#FFFFFF",selectors:{":hover":{color:"#FFFFFF"}}}}},rotateAnimationLayer:{selectors:{svg:{fill:t?"#0078D4":"#7BDCEE"}}}}},teachingBubbleStyles:{closeButton:{color:"#0078D4"}},isDismissable:!0,persistentBeak:!0,maxUserViewCount:2,disableCondensedHeadline:!0,bodyCopy:r.a,name:"ADD_TO_ONEDRIVE_COMMAND"},z=Object(a.__assign)(Object(a.__assign)({},V),{campaignGuid:"dcd7409f-bd4d-4b95-aeb4-f1156656b0ab",name:"ADD_TO_ONEDRIVE_COMMAND_CFT"}),G={campaignGuid:"ac1f12bf-bc9e-41f9-84e9-49351392a052",title:r.V,bodyCopy:r.j,flag:d.EnableEditControlTeachingBubble,directionalHint:y.e.bottomAutoEdge,colorVariation:o.e.themePrimary,alignment:c.e.Right,offset:w,isCoachmark:!0,persistentBeak:!0,isDismissable:!0},K={campaignGuid:"3aead293-1016-42fe-9e98-182280ae809c",flag:d.EnableEditPdfTeachingBubble,colorVariation:o.e.themePrimary,directionalHint:y.e.bottomAutoEdge,isCoachmark:!1,persistentBeak:!0,isDismissable:!0,teachingBubbleContentAs:function(e){var t=e.defaultRender,n=e.onDismiss,i=Object(a.__rest)(e,["defaultRender","onDismiss"]),r=Object(u.e)(function(e){n(e)});return t?f.createElement(t,Object(a.__assign)({},i,{headline:b.t,primaryButtonProps:{text:b.n,onClick:r},onDismiss:n}),b.e):void 0},name:"PDF_EDIT"},W={campaignGuid:"8ba90892-7cf5-4c07-9e6e-e53996904f9e",flag:d.EnableExtractAndMergeTeachingBubble,colorVariation:o.e.themePrimary,directionalHint:y.e.bottomAutoEdge,isCoachmark:!1,persistentBeak:!0,isDismissable:!0,teachingBubbleContentAs:v,name:"PDF_EXTRACT_MERGE"},q={campaignGuid:"df4486da-0183-4cf9-afbf-bbffb482e937",flag:d.EnableGetESignaturesTeachingBubble,colorVariation:o.e.themePrimary,directionalHint:y.e.bottomAutoEdge,isCoachmark:!1,persistentBeak:!0,isDismissable:!0,teachingBubbleContentAs:D,name:"PDF_GET_ESIGNATURES"},Q={campaignGuid:"8c5ffbba-577b-4a30-86bf-d93c02942877",flag:d.On,isCoachmark:!0,isDismissable:!0,persistentBeak:!0,title:r.v,bodyCopy:r.g,name:"LAUNCH_LIST_BUSINESS_APPS_SETUP_WIZARD_COMMAND",defaultFact:{d:!1,v:0}},Y={campaignGuid:"dc3ad2f7-89bd-4f0d-b5d6-38e0a97ba739",flag:d.On,isCoachmark:!0,isDismissable:!0,persistentBeak:!0,title:r.b,bodyCopy:r.h,name:"LAUNCH_LIBRARY_BUSINESS_APPS_SETUP_WIZARD_COMMAND",defaultFact:{d:!1,v:0}},J={campaignGuid:"b8ceb79a-73e5-4e1d-8df8-27dedb514597",flag:d.On},X={campaignGuid:"dcdd7a79-f0a6-4b88-94e2-a76178bd5eee",flag:d.On},Z={campaignGuid:"c75fc458-8c94-4e75-91c9-6be5e94cf2e4",flag:d.On},$={campaignGuid:"6f376cef-52b4-4abc-b6e9-aca8686e5220",flag:d.On},ee={campaignGuid:"b23b2ba7-87e7-44f1-a635-bf05c7fcde4e",flag:d.On,title:r.n,bodyCopy:r.e,primaryButtonText:r.t,isDismissable:!0,maxUserViewCount:5,name:"ADD_SMART_TEMPLATE"},te={campaignGuid:"c8896a46-5b51-474d-8b52-f7a9629c1751",flag:d.On,title:r.E,bodyCopy:r.O,primaryButtonText:r.w,isDismissable:!0,maxUserViewCount:5,name:"GENERATE_CAAE_DOCUMENT"},ne={campaignGuid:"f3d86546-dd2d-47aa-a3e8-9f1ce1afda52",flag:d.On,title:r.H,bodyCopy:r.U,primaryButtonText:r.F,isDismissable:!0,maxUserViewCount:5,name:"MODERN_TEMPLATE_VIEW_INFO"},ae={campaignGuid:"447eb215-1e48-45cd-8644-8c83c604d4c1",bodyCopy:r.te,colorVariation:o.e.themePrimary,flag:d.ERBugFixesEnabledForUniversalAnnotation,directionalHint:y.e.bottomRightEdge,isCoachmark:!1,persistentBeak:!0,isDismissable:!0,maxUserViewCount:5,name:"USE_UNIVERSAL_ANNOTATION"},ie={campaignGuid:Object(d.isFeatureEnabled)(d.EnableStableFREforTMR)?"5ee0205b-23b6-4867-a5ce-7fff50bb50b2":"bbc4c8cc-da34-424a-92ab-43ae518c1c7b",title:r.ee,bodyCopy:r.$,colorVariation:o.e.themePrimary,flag:d.EnableExpirationSectionForTMR,directionalHint:y.e.bottomRightEdge,isCoachmark:!1,persistentBeak:!0,isDismissable:!0,maxUserViewCount:Object(d.isFeatureEnabled)(d.EnableStableFREforTMR)?1e3:1,name:"TMR_EXPIRATION_DATE_EDIT"},re={campaignGuid:"65fe39bb-0669-4b21-a67d-a30c4ce3b959",flag:d.On,directionalHint:y.e.rightCenter,isCoachmark:!1,isDismissable:!0,persistentBeak:!0,maxUserViewCount:2,teachingBubbleContentAs:S,name:"PHOTO_STORY"},oe={campaignGuid:"59b0a6bb-d54c-48cc-a13e-8df743f6ffa3",killSwitchGuid:"8e80b4eb-f274-48fa-befa-3fca46573a91",title:r.Z,bodyCopy:r.X,primaryButtonText:r.J,secondaryButtonText:r.R,colorVariation:o.e.themePrimary,experimentId:l.e,flag:d.ShareToTeams,alignment:c.e.Left,isCoachmark:!0,isDismissable:!0,name:"SHARE_TO_TEAMS"},se={campaignGuid:"4c0cab92-8ab5-426e-ad64-860c49ec2a8a",title:r.d,bodyCopy:r.c,colorVariation:o.e.themePrimary,flag:d.On,alignment:c.e.Left,isCoachmark:!0,directionalHint:y.e.rightBottomEdge,isDismissable:!0,persistentBeak:!0},ce={campaignGuid:"21432b3b-ab4f-4a12-a4fa-f25b4de9cfef",flag:d.On,isCoachmark:!0,isDismissable:!0,persistentBeak:!0,title:r.Y,bodyCopy:r.q,primaryButtonText:r.Q,maxUserViewCount:5,name:"SETUP_DOCUMENT_ANALYSIS_FLOW_COMMAND",defaultFact:{d:!1,v:0}}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(3).t)("MoveCopyCapabilities")},function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(0),i=n(3),r=n(66),o=new i.t({name:"HiddenDomProvider.key",loader:new r.t(function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([127],667)];case 1:return[2,e.sent().resourceKey]}})})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(7),i=new(n(3).t)({name:"".concat("IsFiltersPaneExpanded",".isFiltersPaneExpanded"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},function(e,t,n){"use strict";var a=function(e){this.items=new Array(e||0),this.groupings=null,this.partialResultRequestCount=0,this.partialResultStatus=0},i=n(17),r=n(160);t.e=function(e,t,n){this.key=e||"",this.content=i.observable(new a(n)),this.content.equalityComparer=r.t,this.schema=i.observableArray([]),this.schema.equalityComparer=r.e,this.context=i.utils.extend({},t),this.contentTypes=i.observableArray([]),this.isPlaceholder=!0,this.version=0}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(3).t)("urlLite")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(e){this._value=e,this._observers=new Set}return e.prototype.get=function(){return this._value},e.prototype.set=function(e){this._value=e,this._observers.forEach(function(e){e()})},e.prototype.subscribe=function(e){var t=this;return this._observers.add(e),function(){t._observers.delete(e)}},e}()},,,,function(e,t,n){"use strict";n.d(t,"n",function(){return r});var a=n(128);n.d(t,"e",function(){return a.n});var i=n(3);n.d(t,"t",function(){return a.a});var r=new i.t({name:"".concat("Engagement",".engagementSource"),factory:new i.e(a.e)})},function(e,t,n){"use strict";var a;function i(){return"boolean"!=typeof a&&(a="srcdoc"in document.createElement("iframe")),a}n.d(t,"e",function(){return i})},,function(e,t,n){"use strict";var a;n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o}),function(){function e(){}e.DefaultLocale="en-US",e.TeamsListClientName="Teams.List",e.TeamsPagesClientName="Teams.Page",e.TeamsFileClientName="Teams.File",e.PageContextKey="_spPageContextInfo"}(),n(210),n(14),function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.Page=2]="Page",e[e.Portal=3]="Portal",e[e.File=4]="File"}(a||(a={}));var i=a.None;new function(){};var r=function(){return i===a.List},o=function(){return i===a.File};a.None},,,,,,,,function(e,t,n){"use strict";function a(e){var t;t={};for(var n=[],a=0,i=e;a<i.length;a++){var r=i[a],o="".concat(r);t[o]||(t[o]=!0,n.push(r))}return n}n.d(t,"e",function(){return a})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={ODB:window._spModuleLink&&-1!==["ODBLightSpeedWebPack","ODBOneDrive"].indexOf(window._spModuleLink.manifestName)}},,,function(e,t,n){"use strict";var a=n(0),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.trackPromise=function(e){var t=!1,n=this.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),a=function(){t=!0,n.dispose()};return e.done(a,a),e},t.prototype.trackSignal=function(e){return this.attach({dispose:function(){e.cancel()}}),e},t}(n(147).e);t.e=i},,function(e,t,n){"use strict";n.d(t,"e",function(){return p}),n.d(t,"t",function(){return _});var a=n(157),i=n(49),r=n(19),o=n(136),s=n(220),c=n(262),d=n(219),l=n(4),u={resultCode:"Proxy Timeout",message:"The SkyApiXmlProxy content failed to load within 15 seconds."},f={resultCode:"IFrame load failure",message:"The SkyApiXmlProxy content failed to execute correctly."},p=window.FilesConfig&&window.FilesConfig.skyApiDomain,m=Object(l.es)(l.ne),_=function(){function e(){this._requests=[]}return e.prototype.canHandleRequest=function(e){return e.indexOf(p)>-1},e.prototype.handleRequest=function(e,t){var n=this,i=new a.e(function(){n._removeSignal(i),t()});if(this._proxyFailure||m)this._bypassProxy(i,e);else{this._requests.push({signal:i,options:e}),e.useDefaultHeaders=!0;var r=Object(s.t)(e,function(e){n._removeSignal(i),i.complete(e)});this._initialize(),this._xmlProxy.createRequest(r)}return i.getPromise()},e.prototype.getHandlerContentWindow=function(){return this._iframe&&b(this._iframe)?this._iframe.contentWindow:null},e.prototype._initialize=function(){var e=this;this._xmlProxy||(this._xmlProxy=new c.e({source:h(!1),onAttach:this._attachToIframe.bind(this),onReady:function(){window.clearTimeout(e._timeout),e._qos&&e._qos.end({resultType:r.t.Success}),e._requests=[]}}))},e.prototype._bypassProxy=function(e,t){var n;this._basicRequestor||(this._basicRequestor=new d.e),t.disableLogging||(n=new o.e({url:t.url,name:t.qosName||"DataRequest.NoSkyProxy."+t.apiName})),t.withCredentials=!0,t.useDefaultHeaders=!0,this._basicRequestor.handleRequest(t,function(){n&&n.end({resultType:r.t.ExpectedFailure}),e.cancel()}).then(function(t){e.complete(t),n&&n.end({resultType:r.t.Success})},function(t){e.error(t),n&&n.end({resultType:r.t.Failure})})},e.prototype._attachToIframe=function(e){var t=this;this._iframe=e;var n=this._hasReloaded?"SkyApiXmlProxyRetry":"SkyApiXmlProxy";this._qos=new r.e({name:n}),this._timeout=window.setTimeout(function(){t._proxyFailed(u)},15e3),e.onload=function(){b(e)||(window.clearTimeout(t._timeout),t._hasReloaded?t._proxyFailed(f):(t._handleError(f),t._reloadIframe(h(!0))))}},e.prototype._removeSignal=function(e){this._requests=this._requests.filter(function(t){return e!==t.signal})},e.prototype._reloadIframe=function(e){this._hasReloaded=!0,window.clearTimeout(this._timeout),this._timeout=void 0,this._xmlProxy.reloadIframe(e)},e.prototype._handleError=function(e){this._qos.end({error:e.message,resultCode:e.resultCode,resultType:r.t.Failure}),this._qos=void 0,i.e.logError(e.message)},e.prototype._proxyFailed=function(e){this._handleError(e),this._proxyFailure={isProxyFailure:!0,message:e.message};for(var t=0,n=this._requests;t<n.length;t++){var a=n[t];this._bypassProxy(a.signal,a.options)}this._requests=[]},e}();function h(e){var t=e?"cache=".concat(function(e){try{return String.fromCharCode.apply(null,(window.crypto||window.msCrypto).getRandomValues(new Uint8Array(6)).map(function(e){return e%26+"A".charCodeAt(0)}))}catch(e){return""}}(),"&"):"";return"".concat(p,"/xmlproxy.htm?").concat(t,"domain=").concat(document.domain)}function b(e){try{for(var t=e.contentDocument.getElementsByTagName("script"),n=0;n<t.length;n++){var a=t[n];if(a&&a.src&&a.src.indexOf("xmlproxy.js")>=0)return!0}}catch(e){return!1}return!1}},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(7),i=new(n(3).t)({name:"".concat("IsCopilotPaneExpanded",".isCopilotPaneExpanded"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return D}),n.d(t,"t",function(){return I});var a=n(231),i=n(4),r=n(3),o=n(48),s=n(138),c=n(206),d={pageContext:c.e},l=new r.t({name:"spartanSharedWithMeExperiment",factory:{dependencies:d,create:function(e){return{instance:Object(a.t)(90050,e.pageContext)}}}}),u=n(290),f=n(14),p=n(256),m=new r.t({name:"alwaysUseOneDriveNavForUser.key",factory:new r.e(!1)}),_={pageContext:c.e,alwaysUseOneDriveNavForUser:m},h=!f.e.isActivated("AB919AD9-6E65-46B5-9864-3DC0F5939671","05/04/23","Enable use of spartan SWM in Airgap"),b=!f.e.isActivated("AC9095BE-D88E-408F-9419-3F46675C45FA","05/04/23","Enable use of spartan SWM in Gallatin"),g=new r.t({name:"isSpartanSharedWithMeSupported",factory:{dependencies:_,create:function(e){return{instance:function(){return n=(t=e).pageContext,a=t.alwaysUseOneDriveNavForUser,i=n&&(n.isExternalGuestUser||n.isAnonymousGuestUser),!(!n||!(a||!i&&n.isMySiteOwner)||!b&&Object(u.t)(n.env2)||!h&&Object(u.e)(n.env2)||Object(p.e)());var t,n,a,i}}}}}),v={pageContext:c.e},y={isSpartanSharedWithMeSupported:g,spartanSharedWithMeExperiment:l,newSpartanSharedWithMeExperiment:new r.t({name:"newSpartanSharedWithMeExperiment",factory:{dependencies:v,create:function(e){return{instance:Object(a.t)(90168,e.pageContext)}}}})},S=function(e){var t=e.isSpartanSharedWithMeSupported,n=e.spartanSharedWithMeExperiment,a=e.newSpartanSharedWithMeExperiment,i=t()&&(Object(s.e)(o.v)||!!n.variantToDisplay||!!a.variantToDisplay);return S=function(){return i},i};new r.t({name:"isSpartanSharedWithMeEnabled",factory:{dependencies:y,create:function(e){return{instance:function(){return S(e)}}}}});var D=90022,I=function(e,t){var n=window._spPageContextInfo;return n&&!(!Object(i.es)(t)||!Object(a.n)(e,n))}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(7),i=n(3),r=n(421),o=new i.t({name:"".concat("DetailsPaneId",".detailsPaneId"),factory:{dependencies:{},create:function(){return{instance:Object(r.e)("DetailsPane-")}}}}),s=new i.t({name:"".concat("IsDetailsPaneExpanded",".isDetailsPaneExpanded"),factory:{dependencies:{detailsPaneId:o,observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return q});var a=n(404),i=n(478),r=n(127),o=n(3),s=n(211),c=n(16),d=n(5),l=n(6),u=n(214),f=new u.e("storeKeyToNavigationUrl",{url:u.t}),p=new o.t("storeKeyToUrlControlHandler"),m=n(208),_=new o.t("IItemsScopeKeyConverter"),h=new u.e("itemKeyToStoreKey",{storeKey:u.t}),b=n(491),g=new o.t("ItemsScopeAddon"),v=new o.t("IItemCacheConfiguration"),y=n(66),S=new o.t({name:"ItemProvider.key",loader:new y.t(function(){return n.ee(0,51).then(function(e){return e.resourceKey})})}),D=new o.t({name:"KnockoutStoreItemControlHandler",factory:{dependencies:{itemProvider:S},create:function(e){var t=e.itemProvider;return{instance:function(e,n){return{getItem:function(e){return t.getItemSync({parentKey:e,ignoreChildren:!0}).item}}}}}}}),I=new u.e("knockoutStoreItem",{getItem:u.t}),x=n(576),C=n(375),O=n(727),w=n(0),E=(n(1),n(81)),A=n(265),L=n(55),k=n(560),M=n(533),P=n(93),T=n(334),U=n(721),F=n(4),H=n(328),R=n(121),N=n(68),B=n(562),j=n(14).e.isActivated("69cccbd8-2920-4c21-ac9a-62ff791a6c06","11/16/2022","set debounce render to be false"),V={resources:o.r},z=new o.t({name:"".concat("ItemCacheConfiguration",".webConfiguration"),factory:{dependencies:{},create:function(){return{instance:Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)({},M.e.pack(new U.e)),A.t.pack(Object(k.e)())),{}),L.o.pack({enablePageLoadBarrier:!0}))}}}}),G=(new o.t({name:"ItemCacheConfiguration",factory:{dependencies:V,create:function(e){var t=e.resources;return{instance:Object(r.e)(function(){return function(e){var n,a=new H.e,i=t.consume(N.e),r=Object(F.ds)("ExternalService_isitemscopefilecardenabled");a.resolveItems({items:(n={},n[R.e]=Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)(Object(w.__assign)({},L.r.pack({reportRUMOnePerfData:!1,logRenderEndTime:function(e,n){var a=t.consume(T.e.optional);a&&a.logRUMOneForItemsScopeListView(e,n)}})),L.o.pack({enablePageLoadBarrier:!0})),P.b.pack({language:E.e.language,cultureLCID:E.e.cultureLCID})),P.m.pack(!0)),P.d.pack(!0)),P.h.pack(!0)),P.f.pack(!!j)),P.r.pack(!0)),P._.pack(Object(F.es)(F.Wt))),P.p.pack(!0)),P.u.pack(!0)),P.c.pack(r&&!i.isMobile)),P.o.pack(Object(F.es)(F.Ee))),P.s.pack(Object(F.es)(F.Ae))),P.i.pack(!0)),B.e.pack({showInPLT:Object(F.es)(F.le)})),P.n.pack(.1)),P.l.pack(Object(F.es)(F.An))),n)}),e(a.execute())}})}}}}),new o.t({name:"".concat("ItemCacheStoreBase",".oneItemCacheInstance"),factory:{dependencies:{},create:function(){return{instance:{created:!1}}}}})),K=new o.t({name:"".concat("ItemCacheStoreBase",".storeBase"),factory:{dependencies:{webConfiguration:z,oneItemCacheInstance:G},create:function(e){var t=e.webConfiguration,n=e.oneItemCacheInstance;if(n.created)throw new Error("Attempted to create a second instance of the ItemCacheStore.");n.created=!0;var a=Object(O.e)({configuration:t});return{instance:a,disposable:a}}}}),W={urlRoutingAddon:new o.t({name:"".concat("ItemCacheStore",".urlRoutingAddon"),factory:{dependencies:{itemsScopeKeyConverter:_,storeKeyToUrlControlHandler:p},create:function(e){var t=e.itemsScopeKeyConverter,n=e.storeKeyToUrlControlHandler;return{instance:Object(r.e)(function(){return function(e){e(Object(s.t)(m.t,h)(t.itemKeyToStoreKeyControlHandler)),e(Object(s.t)(m.t,b.e)(t.viewParamsToItemKeyControlHandler)),e(Object(s.t)(m.t,f)(n)),e(x.e)}})}}}}),itemsScopeAddon:g,itemCacheConfiguration:v,itemCacheStoreBase:K,knockoutStoreItemAddon:new o.t({name:"".concat("ItemCacheStore",".knockoutStoreItemAddon"),factory:{dependencies:{getKnockoutStoreItemControlHandler:D.async.lazy},create:function(e){var t=e.getKnockoutStoreItemControlHandler;return{instance:Object(r.e)(function(){return function(e){e(Object(s.t)(m.t,I)(e(Object(s.e)(t))))}})}}}}),pageLoadAddon:new o.t({name:"".concat("ItemCacheStore",".pageLoadAddon"),factory:{dependencies:{pageLoadMonitor:i.e,resources:o.r},create:function(e){var t=e.resources,n=e.pageLoadMonitor;return{instance:Object(r.e)(function(){return function(e){e(Object(a.a)({waitIndefinitely:!0})).then(function(){var i=function(e){var t=e.consume(l.H);return"".concat(c.e[t.getPageType()]||"Default","-").concat(d.e[t.getQueryType()]||"Default")}(t);n.pageLoaded({name:i,error:e(Object(C.e)(function(e){return Object(a.e)(e)}))})})}})}}}})},q=new o.t({name:"ItemCacheStore",factory:{dependencies:W,create:function(e){var t=e.pageLoadAddon,n=e.urlRoutingAddon,a=e.itemsScopeAddon,i=e.itemCacheConfiguration,r=e.itemCacheStoreBase,o=e.knockoutStoreItemAddon;return r.dispatch(i),r.dispatch(n),r.dispatch(o),r.dispatch(a),r.dispatch(t),{instance:r}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return m});var a=n(0),i=n(7),r=n(82),o=n(149),s=n(31),c=n(43),d=n(383),l=n(62),u=n(12),f=(n(117),n(66)),p=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._dialogProvider=n.dialogProvider,a._promiseTracker=n.promiseTracker,a._itemSetSelectionModel=n.itemSetSelectionModel,a}return Object(a.__extends)(t,e),t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(d.e),a=this.createObservable(!0),i=this.createObservable(!1),r=this._shouldShowDialog();return this._itemSetSelectionModel?(t=this._itemSetSelectionModel.resolveSelection().then(function(t){return r=!1,e&&e.state(2),t},function(t){return e&&(n(d.t),a(!1),i(!0)),s.n.wrapError(t)}),r&&(e=this._createDialog(n,a,i)).wait().done(void 0,function(){t.cancel()}),this._promiseTracker&&this._promiseTracker.registerPromise(t)):t=s.n.wrap([]),t},t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:d.n,isDismissable:!1,component:{name:o.e.tagName,params:{text:e}},actions:[{name:c.cancelActionText,execute:function(){return s.n.wrap(3)},isVisible:t,icon:new l.e("Cancel"),isDefault:!0},{name:c.ok,execute:function(){return s.n.wrap(3)},isVisible:n,icon:new l.e("Cancel"),isDefault:!0}]})},t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{dialogProvider:r.e,promiseTracker:u.g.optional,itemSetSelectionModel:u.b}),t}(i.n),m=Object(f.r)("SelectionHelper",p)},,,,,,function(e,t,n){"use strict";var a,i,r;n.d(t,"e",function(){return r}),n.d(t,"t",function(){return s}),n.d(t,"n",function(){return o}),function(e){e[e.spam=0]="spam",e[e.nudityOrPornography=1]="nudityOrPornography",e[e.harassmentOrThreatening=2]="harassmentOrThreatening",e[e.childEndangermentOrExploitation=3]="childEndangermentOrExploitation",e[e.other=4]="other",e[e.copyrightInfringement=5]="copyrightInfringement"}(i||(i={})),function(e){e[e.malwareOrViruses=0]="malwareOrViruses",e[e.sexuallyInappropriate=1]="sexuallyInappropriate",e[e.harassmentOrThreatening=2]="harassmentOrThreatening",e[e.childSexualExploitation=3]="childSexualExploitation",e[e.other=4]="other",e[e.terroristContent=5]="terroristContent",e[e.fraudOrSpam=6]="fraudOrSpam",e[e.hateSpeech=7]="hateSpeech",e[e.imminentHarm=8]="imminentHarm",e[e.copyrightInfringement=9]="copyrightInfringement"}(r||(r={}));var o,s={childSexualExploitation:"ChildEndangermentExploitation",copyrightInfringement:"ContentInfringement",sexuallyInappropriate:"OffensiveContent",terroristContent:"Terrorism",malwareOrViruses:"VirusSpywareMalware",other:"Other",fraudOrSpam:"Fraud",hateSpeech:"HateSpeech",imminentHarm:"ImminentHarmToPersonsOrProperty"};!function(e){e[e.File=0]="File",e[e.PhotoStreamComment=1]="PhotoStreamComment",e[e.PhotoStreamFile=2]="PhotoStreamFile"}(o||(o={})),(a={})[o.PhotoStreamComment]="Comment",a[o.PhotoStreamFile]="PhotoStreamFile",t.a=i},function(e,t,n){"use strict";var a=function(){function e(e){this._tasksByKey={},this._onChanges=e}return e.map=function(e,t){return{update:function(n,a){void 0===a&&(a=!1),e.update(n.map(function(e){return t(e)}),a)}}},e.prototype.dispose=function(){this._tasksByKey={},this._onChanges=null},e.prototype.getTasks=function(){var e=[];for(var t in this._tasksByKey)e.push(this._tasksByKey[t]);return e},e.prototype.getTask=function(e){return this._tasksByKey[e]},e.prototype.update=function(e,t){var n,a,i;for(var r in void 0===t&&(t=!1),n={},this._tasksByKey)n[r]=this._tasksByKey[r];i=[];for(var o=0,s=e;o<s.length;o++){var c=s[o],d=n[c.key],l=c.compare(d);l&&i.push(l),delete n[c.key],this._tasksByKey[c.key]=c}if(t)for(var r in n)a=n[r],delete this._tasksByKey[r],i.push({previous:a,current:null});this.onChanges(i)},e.prototype.onChanges=function(e){this._onChanges&&this._onChanges(e)},e}();t.e=a},function(e,t,n){"use strict";n.d(t,"t",function(){return p}),n.d(t,"e",function(){return m});var a=n(0),i=n(7),r=n(31),o=n(47),s=n(40),c=n(22),d=n(269),l=n(20),u=n(341),f=n(200),p="__New",m="__Auto";!function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._urlDataSource=n.resources.consume(o.n),n}Object(a.__extends)(t,e),t.prototype.addToAlbum=function(e,n){var a={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.ADD_TO_ALBUM_ACTION};return this._handleRequest(n,a)},t.prototype.removeFromAlbum=function(e,n){var a={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.REMOVE_FROM_ALBUM_ACTION};return this._handleRequest(n,a)},t.prototype.createAlbum=function(e,n){var a=this,i=this._getIdsFromKeyArray(n),o=i.slice(0,20),c={id:null,name:e,items:o,action:t.CREATE_ALBUM_ACTION};return(new s.e).send({requestType:"POST",postData:JSON.stringify(c),apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(c.action),url:this._getModifyAlbumUrl(),isErrorExpectedCallback:f.e}).then(function(e){if(!n||n&&n.length<20)return e;o=i.slice(20);var s={id:e.id,items:o,action:t.ADD_TO_ALBUM_ACTION,name:null};return a._handleRequest(o,s).then(function(t){return e},function(e){var t={errorType:u.e.other,error:new Error(e.data.message)};return r.n.wrapError(t)})},function(e){var t=u.e.other;1e3===e.data.code&&(t=u.e.conflict);var n={errorType:t,error:new Error(e.data.message)};return r.n.wrapError(n)})},t.prototype.getWalgreensLandingPageUrl=function(e){var t=this._urlDataSource.getPublishToWalgreensUrl();return(new s.e).sendPostUrlEncoded("PublishToWalgreens",t,JSON.stringify({ids:e}))},t.prototype.createAlbumFromFolder=function(e){var n=this._getModifyAlbumUrl(),a=new s.e,i={id:null,name:e.folder.name,items:[e.folder.id],action:t.CREATE_ALBUM_WITH_RENAME_ACTION};return a.send({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(i.action),url:n,requestType:"POST",postData:JSON.stringify(i),isErrorExpectedCallback:f.e})},t.prototype.getAlbumsParentKey=function(e){var n;void 0===e&&(e={});var a=((n={}).id=t.ALBUMS_ID,n.cid=this._urlDataSource.getOwnerId(),n.tagFilter=e.tagFilter,n);return l.n(a,void 0,!0)},t.prototype.setCoverPhoto=function(e,n){var a=this._getModifyAlbumUrl(),i=new s.e,o={id:e.id,items:[n.id],action:t.SET_COVER_PHOTO_ACTION,name:null};return i.send({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(o.action),url:a,requestType:"POST",postData:JSON.stringify(o),isErrorExpectedCallback:f.e}).then(null,function(e){var t=e&&e.data&&e.data.message||"";return r.n.wrapError(t)})},t.prototype._handleRequest=function(e,n){var a=this._getModifyAlbumUrl();return d.e.start({apiName:"".concat(t.MODIFY_ALBUM_API_NAME,".").concat(n.action),url:a,batchSize:20,items:e,isErrorExpectedCallback:f.e,getPostData:function(e){return{id:n.id,name:n.name,items:e,action:n.action}}})},t.prototype._getModifyAlbumUrl=function(){return c.e.skyApiBaseUrl+t.MODIFY_ALBUM_API_NAME},t.prototype._getIdsFromKeyArray=function(e){return e.map(function(e){return l.e(e).id})},t.ADD_TO_ALBUM_ACTION="Add",t.CREATE_ALBUM_ACTION="Create",t.CREATE_ALBUM_WITH_RENAME_ACTION="CreateWithRename",t.REMOVE_FROM_ALBUM_ACTION="Remove",t.SET_COVER_PHOTO_ACTION="SetCoverPhoto",t.MODIFY_ALBUM_API_NAME="ModifyAlbum",t.ALBUMS_ID="albums"}(i.n)},,,function(e,t,n){"use strict";n.r(t),n.d(t,"STORAGE_KEY_EXPIRATION",function(){return H}),n.d(t,"resourceKey",function(){return V});var a=n(0),i=n(7),r=n(45),o=n(6),s=n(88),c=n(82),d=n(61),l=n(62),u=n(189),f=n(118),p=n(135),m=n(123),_=n(419),h=n(130),b=n(36),g=n(31),v=n(286),y=n(5),S=n(50),D=n(51),I=n(66),x=n(164),C=n(149),O=n(346),w=n(244),E=n(41),A=n(53),L=n(4),k=n(502),M=n(302),P=n(33),T=n(38),U=n(42),F=n(551),H="expirationtime",R="vaultMenuCalloutMessageShow",N=1200,B=["ManageVault","Restore","RansomwareDetection"],j=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._clientName=n.clientName,a._identityDataSource=n.identityDataSource,a._vroomDataRequestor=n.vroomDataRequestor,a._itemStore=n.itemStore,a._navigation=n.navigation,a._urlDataSource=n.urlDataSource,a._itemProvider=n.itemProvider,a._dialogProvider=n.dialogProvider,a._userInfoProvider=n.userInfoProvider,a._itemParentHelper=n.itemParentHelper,a._bundleLoader=n.bundleLoader,a._isItemsScopeEnabled=n.isItemsScopeEnabled,a._vaultStore=n.vaultStore,a._storageKeyPrefix=a._vaultStore.storageKeyPrefix,a._dataStore=a._vaultStore.dataStore,a._isVaultOpen=a._vaultStore.isVaultOpen,a._vaultFreState=a._vaultStore.vaultFreState,a._vaultSuggestCardState=a.createObservable(0),a._vaultQuota=a._vaultStore.vaultQuota,a._quotaLoaded=a.createComputed(a._computeQuotaLoaded),a._isVaultDisabled=a._vaultStore.isVaultDisabled,a._isLocking=!1,a._isOneDriveWinApp=Object(A.e)(),a.isOverQuota=a._vaultStore.isOverQuota,a._showVaultLockNotification=a._vaultStore.showVaultLockNotification,a._showVaultFreMessage=a._vaultStore.showVaultFreMessage,a.createComputed(a._calculateFreMessage),a.events.on(window,"storage",a._onStorageChange),a.createBackgroundComputed(a._updateVaultQuota),a.fetchIsVaultDisabled(),a._isVaultOpen.peek()&&(a._getExpiration()<Date.now()?a.lockVault(void 0,!0):a._handleVaultUnlock()),a}return Object(a.__extends)(t,e),t.prototype.vaultLockMessageSubscribe=function(e){this.scope.attach(e.register(this._showVaultLockNotification))},t.prototype.vaultStateSubscribe=function(e){this.scope.attach(e.register(this._isVaultOpen))},t.prototype.vaultFreSubscribe=function(e){this.scope.attach(e.register(this._vaultFreState))},t.prototype.vaultQuotaSubscribe=function(e){this.scope.attach(e.register(this._vaultQuota))},t.prototype.vaultMenuCalloutSubscribe=function(e){this.scope.attach(e.register(this._showVaultFreMessage))},t.prototype.vaultDisabledSubscribe=function(e){this.scope.attach(e.register(this._isVaultDisabled))},t.prototype.getVaultItem=function(){return this._vaultItem},t.prototype.isVaultOpen=function(){return this._isVaultOpen},t.prototype.isVaultDisabled=function(){return this._isVaultDisabled},t.prototype.freState=function(){return this._vaultFreState},t.prototype.suggestCardState=function(){return this._vaultSuggestCardState},t.prototype.getShowVaultFreMessage=function(){return this._showVaultFreMessage()},t.prototype.setShowVaultFreMessage=function(e,t){void 0===t&&(t=!1),t||this._showVaultFreMessage(e),this._setVaultIconFre(e)},t.prototype.unlockVault=function(e,t){var n=this;return this.getVault(!1,!0).then(function(i){if(!i||!i.vault||i.vault.isLocked||e){var r;r=e?n._identityDataSource.getSessionToken(!0):n._isOneDriveWinApp?g.n.resolve({wlidToken:t}):g.n.resolve({accessToken:t});var o={};return n._isOneDriveWinApp&&(o.Prefer="Include-Feature=Vault"),Object(L.es)(L.i)&&(o=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},o),{Scenario:M.e.OpenVault,ScenarioType:M.t.ActiveUserOperation}),n._clientName?{Application:n._clientName}:{})),r.then(function(t){return n._vroomDataRequestor.send(Object(a.__assign)({apiName:"action.unlockVault",path:"/drive/special/vault/action.unlockVault",headers:o,requestType:"POST",postData:JSON.stringify({}),accessToken:t,postProcessQos:n._postProcessUnlockQos.bind(n),useAuthorizationHeaders:!0,qosExtraData:{isExtend:!!e}},Object(L.es)(L.zr)&&Object(T.e)(U.s)?n.getUnlockVaultV2RequestData():{})).then(function(){if(n.setVaultLockState({root:void 0,isLocked:!1,expirationInSeconds:N}),!e){var t=n._urlDataSource.getRootItemKey();n._invalidateItems(t)}return g.n.resolve({})}).catch(function(e){return n._handleVaultLock(),g.n.reject(e)})})}n.setVaultLockState(i.vault,!!t)})},t.prototype.setVaultLockState=function(e,t,n){if(void 0===t&&(t=!1),!this._isLocking){var a=this._isVaultOpen.peek(),i=e.isLocked;if(i||a)i&&a&&this._handleVaultLock(!1,n);else{var o=e.expirationInSeconds||N,s=Date.now()+1e3*o;this._dataStore.setValue(H,s,r.e.local),this._handleVaultUnlock(t)}}},t.prototype.lockVault=function(e,t){var n=this;if(this._isLocking=!0,this._navToRootIfInVault(),e){var i=this._urlDataSource.getPageType(this._navigation.viewParams),r=this._urlDataSource.getQueryType(this._navigation.viewParams);s.e.logData({name:"Vault.Autolocked",extraData:{location:Object(v.a)(i,r)}})}var o=this._vaultItem?g.n.resolve(this._vaultItem):this.getVault(),c={};return this._isOneDriveWinApp&&(c.Prefer="Include-Feature=Vault"),Object(L.es)(L.i)&&(c=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},c),{Scenario:M.e.CloseVault,ScenarioType:M.t.ActiveUserOperation}),this._clientName?{Application:this._clientName}:{})),o.then(function(i){return n._vroomDataRequestor.send(Object(a.__assign)({apiName:"action.lockVault",path:"/drive/special/vault/action.lockVault",headers:c,requestType:"POST",postData:JSON.stringify({}),postProcessQos:n._postProcessQos.bind(n),qosExtraData:{isAutoLock:!!e}},Object(L.es)(L.zr)&&Object(T.e)(U.s)?n.getLockVaultV2RequestData():{})).then(function(){n._isLocking=!1,n._handleVaultLock(t)}).catch(function(e){return n._isLocking=!1,403===e.status?n._handleVaultLock(t):n._showLockFailed(),n._isExpectedError(e)?g.n.resolve():g.n.reject(e)})})},t.prototype.dismissLockNotification=function(){this._showVaultLockNotification(!1)},t.prototype.extendLock=function(){return this.unlockVault(!0)},t.prototype.getVault=function(e,t,n,a){var i=this,r={};return e&&(r.Prefer="auto-create-special-folder"),this._isOneDriveWinApp&&(r.Prefer=r.Prefer+",Include-Feature=Vault"),n=n||"GET",(Object(T.e)(U.s)?Object(L.es)(L.zr)?i.getVaultV2(e,a):g.n.reject(new Error("vault is not supported")):this._vroomDataRequestor.send({apiName:a?"EnableVault":e?"CreateVault":"GetVault",path:"/drive/special/vault",headers:r,requestType:n,breakCache:!0,qosExtraData:{requestType:n},postProcessQos:this._postProcessQos.bind(this)})).then(function(e){var t,n;return e&&((null===(n=null===(t=null==e?void 0:e.createdBy)||void 0===t?void 0:t.user)||void 0===n?void 0:n.id)&&(e.createdBy.user.id=e.createdBy.user.id.toUpperCase()),i._vaultItem=e),e}).catch(function(e){return t?null:g.n.reject(e)})},t.prototype.getQuota=function(){var e=this,t={};return this._isOneDriveWinApp&&(t.Prefer="Include-Feature=Vault"),this._vroomDataRequestor.send({apiName:"drive",path:"/drive?select=quota/vault",headers:t,requestType:"GET"}).then(function(t){var n=t&&t.quota&&t.quota.vault;return e._vaultQuota(n),n})},t.prototype.createVaultIfNotExist=function(){var e=this;return this._userInfoProvider.getUserFact(46).then(function(t){if(!t||e._vaultFreState.peek()===h.a.Created)return e.getVault(!0).then(function(t){e.setVaultState(h.a.Created),e._isVaultDisabled(!1);var n=e._urlDataSource.getRootItemKey();return e._invalidateItems(n,{triggerFetch:!0}),t});var n=JSON.parse(t.param||"{}");e._vaultFreState(n.s),e._vaultSuggestCardState(n.c)})},t.prototype.fetchIsVaultDisabled=function(){var e=this;return void 0!==this._isVaultDisabledPromise||(this._isVaultDisabledPromise=this._userInfoProvider.getUserFact(46).then(function(t){return t||Object(L.es)(L.zr)&&Object(T.e)(U.s)?e.getVault(!1,!1,"HEAD").then(function(){return e._isVaultDisabled(!1),!1}).catch(function(t){var n=404===t.status;return e._isVaultDisabled(n),n}):(e._isVaultDisabled(!0),!0)})),this._isVaultDisabledPromise},t.prototype.enableVault=function(){var e=this;return this.getVault(!0,!1,"GET",!0).then(function(t){var n=e._urlDataSource.getRootItemKey();return e._invalidateItems(n,{triggerFetch:!0}),e._isVaultDisabled(!1),t})},t.prototype.disableVault=function(e){var t=this;if(Object(L.es)(L.zr)&&Object(T.e)(U.s))return e?this.disableVaultV2():g.n.resolve("confirmToken");var n={};return e&&(n.If="(<".concat(e,">)")),this._isOneDriveWinApp&&(n.Prefer="Include-Feature=Vault"),this._vroomDataRequestor.send({apiName:"deleteVault",headers:n,path:"/drive/special/vault",requestType:"DELETE",postData:JSON.stringify({}),postProcessQos:this._postProcessQos.bind(this)}).then(function(){t._cleanLocalLockInfo(),t._isVaultDisabled(!0)}).catch(function(e){var t=e.response;if(t&&t.error&&t.error.fixItUrl){var n=new E.t(t.error.fixItUrl).getQueryParameter("confirmationToken");if(n)return n}return g.n.reject(e)})},t.prototype.setVaultState=function(e,t){var n=void 0;void 0!==e&&e>this._vaultFreState.peek()&&(this._vaultFreState(e),n=e),t&&this._vaultSuggestCardState(t);var a={s:n||this._vaultFreState.peek(),c:t||this._vaultSuggestCardState.peek()};return this._userInfoProvider.setUserInfo(46,3,JSON.stringify(a))},t.prototype.reset=function(){return g.n.resolve(!1)},t.prototype.toggleDebug=function(){},t.prototype._onNavigationChange=function(){var e=this._getCurrentItem(),t=this._navigation.viewParams,n=this._isVaultOpen.peek();e&&(n&&(!e.vault&&B.indexOf(t&&t.v)<=-1?this._detatchIdleEvents():this._attachIdleEvents()),e.vault&&e.vault.root?this._vaultRootLoadEventFiled||(s.e.logData({name:"Vault.Unlocked.Loaded"}),this._vaultRootLoadEventFiled=!0):this._vaultRootLoadEventFiled=!1)},t.prototype._computeQuotaLoaded=function(){return!!this._bundleLoader.getBundleInfo(2).isLoaded()&&(this._userStateProvider||(this._userStateProvider=this.resources.consume(S.d)),!0)},t.prototype._updateVaultQuota=function(){var e=this._userStateProvider&&this._userStateProvider.quotaNeedsUpdate();if(this._quotaLoaded()&&e&&this._isVaultOpen()&&(this.getQuota(),L.is)){var t=this._getCurrentItem();this.resources.consumeAsync(o.h).then(function(e){e.invalidateQuota(null==t?void 0:t.key)})}},t.prototype._isDebug=function(){return!1},t.prototype._getExpiration=function(){return this._isDebug()?Date.now()+12e4:this._dataStore.getValue(H,r.e.local)},t.prototype._startExpirationTimers=function(){var e=this;this._expirationWarningTimerId=this.async.setTimeout(function(){e._verifyLockExpiration()},this._getExpiration()-Date.now()-6e4),this._expirationLockTimerId=this.async.setTimeout(function(){e.lockVault(!0)},this._getExpiration()-Date.now())},t.prototype._stopExpirationTimers=function(){this.async.clearTimeout(this._expirationWarningTimerId),this.async.clearTimeout(this._expirationLockTimerId)},t.prototype._resetExpirationTimers=function(){this._stopExpirationTimers(),this._startExpirationTimers()},t.prototype._attachIdleEvents=function(){this._idleEventsAttached||("ontouchstart"in document.documentElement&&this.events.on(document,"touchstart",this._resetLastActivity,!0),this.events.on(document,"mousemove",this._resetLastActivity,!0),this.events.on(document,"keypress",this._resetLastActivity,!0),this._idleEventsAttached=!0)},t.prototype._detatchIdleEvents=function(){this._idleEventsAttached&&("ontouchstart"in document.documentElement&&this.events.off(document,"touchstart",this._resetLastActivity,!0),this.events.off(document,"mousemove",this._resetLastActivity,!0),this.events.off(document,"keypress",this._resetLastActivity,!0),this._idleEventsAttached=!1)},t.prototype._resetLastActivity=function(){this._lastActivity=Date.now()},t.prototype._verifyLockExpiration=function(){var e=this;this._isDebug()?this._showLockWarning():Date.now()-this._lastActivity<9e5?this.extendLock().then(function(){e._resetExpirationTimers()}):this.getVault().then(function(t){var n=t.vault&&t.vault.expirationInSeconds||0;if(1e3*n>12e4){var a=Date.now()+1e3*n;e._dataStore.setValue(H,a,r.e.local),e._resetExpirationTimers()}else e._showLockWarning()}).catch(function(t){return e.lockVault()})},t.prototype._showLockFailed=function(){var e=this,t=this._dialogProvider.requestDialog({title:w.r,component:{name:O.e.tagName,params:{html:'<span class="ms-fontColor-error">'.concat(w.a,"</span>")}},actions:[{name:w.i,execute:function(){return g.n.resolve(2)},isAvailable:this.observables.create(!0),icon:new l.e("CheckMark"),isDefault:!0}],isSoftDismissable:!1});t.wait().then(function(){2===t.state.peek()&&(e.async.clearTimeout(e._retryLockVault),e._retryLockVault=e.async.setTimeout(function(){e.lockVault()},500))})},t.prototype._showLockWarning=function(){var e=this;this._warningDialog=this._dialogProvider.requestDialog({title:w.n,component:{name:C.e.tagName,params:{text:w.e}},actions:[{name:w.t,execute:function(){return s.e.logData({name:"Vault.StillHere.Extend"}),e.extendLock().then(function(){return e._resetExpirationTimers(),g.n.resolve(2)})},isAvailable:this.observables.create(!0),icon:new l.e("Cancel"),isDefault:!0}],isSoftDismissable:!1}),s.e.logData({name:"Vault.StillHere.Shown"}),this._warningDialog.wait().catch(function(){3===e._warningDialog.state.peek()&&s.e.logData({name:"Vault.StillHere.Dismiss"})})},t.prototype._handleVaultLock=function(e,t){this._cleanLocalLockInfo(t),this._showVaultLockNotification(!e)},t.prototype._cleanLocalLockInfo=function(e){var t=this;this._isVaultOpen(!1),this._dataStore.remove(H,r.e.local),this._stopExpirationTimers(),e||this._navToRootIfInVault(),this.events.off(this._navigation,"change",this._onNavigationChange),this._navEventAttached=!1,this._getVaultIconFre()||this._showVaultFreMessage(!1),this._detatchIdleEvents(),this._warningDialog&&this._warningDialog.dismiss(),Object.keys(y.e).map(function(e){var n=t._urlDataSource.getRootItemKey(y.e[e]);t._invalidateItems(n)});var n=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(n,"vault"))){var a=this._urlDataSource.getRootItemKey();this._itemStore.emptyAllOtherSets([a])}else n&&this._invalidateItems(n.key,{emptyAllOtherSets:!0});this._itemStore.invalidateAllVault()},t.prototype._navToRootIfInVault=function(){var e,t,n,a=this._getCurrentItem(),i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(a,"vault")),r=Object(L.es)(L.zr)&&Object(T.e)(U.s)&&this._vaultItem&&(null===(e=null==a?void 0:a.graph)||void 0===e?void 0:e.driveId)===(null===(n=null===(t=this._vaultItem.remoteItem)||void 0===t?void 0:t.parentReference)||void 0===n?void 0:n.driveId);if(i||r){var o=this._urlDataSource.getRootItemKey(),s=this._urlDataSource.getItemUrl(o);this._navigation.navigateTo({url:s})}},t.prototype._invalidateItems=function(e,t){var n=this;this._isItemsScopeEnabled()?this.resources.consumeAsync(o.h).then(function(a){a.invalidateItems(e),Object(L.es)(L.zr)&&Object(T.e)(U.s)&&a.invalidateCurrentItemSet(),L.is&&n._itemProvider.invalidateItem(e,t);var i=n._getCurrentItem();(null==i?void 0:i.vault)&&a.invalidateItems(i.key)}):this._itemProvider.invalidateItem(e,t)},t.prototype._handleVaultUnlock=function(e){var t=this;void 0===e&&(e=!1),this._isVaultOpen(!0),this._resetExpirationTimers();var n=this._urlDataSource.getRootItemKey();this._invalidateItems(n,{triggerFetch:!0}),this._navEventAttached||(this.events.on(this._navigation,"change",this._onNavigationChange),this._navEventAttached=!0,this._onNavigationChange()),this.getQuota(),this._warningDialog&&this._warningDialog.dismiss();var a=this._getCurrentItem();if(a&&(a.vault||a.isPlaceholder||a.error&&a.error.data&&161===a.error.data.errorCode||a.queryType===y.e.RecycleBin&&"root"===a.id)){this._invalidateItems(a.key,{triggerFetch:!0});var i=this._urlDataSource.getFocusItemKey(this._navigation.viewParams);i&&this._invalidateItems(i,{purgeCache:!0})}this._showVaultLockNotification(!1),s.e.logData({name:"Vault.Unlocked.Succeeded"}),this._getVaultIconFre()&&!e&&(this.async.setTimeout(function(){t._showVaultFreMessage(!0)},5e3),this._setVaultIconFre(!1))},t.prototype._onStorageChange=function(e){var t=e.key,n=e.oldValue,a=e.newValue;if(t===this._storageKeyPrefix+h.e&&a)try{var i=JSON.parse(a);FilesConfig.canary!==i&&(FilesConfig.canary=FilesConfig.navCanary=i)}catch(e){}t===this._storageKeyPrefix+H&&(a?(!n||a>n)&&(this._dataStore.getValue(H,r.e.local)||this._dataStore.setValue(H,parseInt(a,10),r.e.local),this._handleVaultUnlock()):this._isVaultOpen.peek()&&this._handleVaultLock())},t.prototype._calculateFreMessage=function(){var e=this;this._getVaultIconFre()&&this.async.setTimeout(function(){e._showVaultFreMessage(!0)},5e3)},t.prototype._getCurrentItem=function(){var e=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams);return this.unwrapObservable(this._itemStore.getItem(e))},t.prototype._getVaultIconFre=function(){return this._dataStore.getValue(R,r.e.local)},t.prototype._setVaultIconFre=function(e){e?this._dataStore.setValue(R,e,r.e.local):this._dataStore.remove(R,r.e.local)},t.prototype._postProcessQos=function(e,t){return this._isExpectedError(t)&&(e.resultType=d.e.ExpectedFailure),e},t.prototype._postProcessUnlockQos=function(e,t){return this._isExpectedUnlockError(t)&&(e.resultType=d.e.ExpectedFailure),e},t.prototype._isExpectedError=function(e){if(400===e.status||403===e.status){var t=Object(u.i)(e);if("memberdoesnotexist"===(t=t&&t.toLowerCase())||"unlockrequired"===t||"accessdenied"===t||"confirmationrequired"===t)return!0}else if(404===e.status)return!0;return!1},t.prototype._isExpectedUnlockError=function(e){var t=Object(u.i)(e);return"vaultunlockextensiontimeexceeded"===(t=t&&t.toLowerCase())&&(s.e.logData({name:"Vault.Unlock.MaxExtensionError"}),!0)},t.prototype.enableVaultV2=function(e){var t=this,n="POST",a="v2.1";return this._vroomDataRequestor.send({endpoint:Object(P.s)({apiVersion:a,driveId:"me",includeViewerId:!0}),apiName:e?"CreateVault":"EnableVault",path:"/oneDrive.createVault",requestType:n,breakCache:!0,apiVersion:a,qosExtraData:{requestType:n},postProcessQos:this._postProcessQos.bind(this),useAuthorizationHeaders:!0}).then(function(){t.setVaultLockState({root:void 0,isLocked:!1,expirationInSeconds:N})})},t.prototype.disableVaultV2=function(){var e,t=this,n="POST",a="v2.1";return(null===(e=this._identityDataSource)||void 0===e?void 0:e.getSessionToken(!0)).then(function(e){return t._vroomDataRequestor.send({endpoint:Object(P.s)({apiVersion:a,driveId:"me",includeViewerId:!0}),apiName:"deleteVault",path:"/oneDrive.disableVault",requestType:n,breakCache:!0,apiVersion:a,qosExtraData:{requestType:n},postProcessQos:t._postProcessQos.bind(t),useAuthorizationHeaders:!0,accessToken:e}).then(function(){t._cleanLocalLockInfo(),t._isVaultDisabled(!0)}).catch(function(e){return g.n.reject(e)})})},t.prototype.getUnlockVaultV2RequestData=function(){return{endpoint:Object(P.s)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"action.unlockVaultV2",path:"/oneDrive.unlockVault"}},t.prototype.getLockVaultV2RequestData=function(){return{endpoint:Object(P.s)({apiVersion:"v2.1",driveId:"me",includeViewerId:!0}),apiName:"action.lockVaultV2",path:"/oneDrive.lockVault"}},t.prototype.getVaultV2=function(e,t){var n=this,i="v2.1",r={Prefer:"Include-Feature=AddToOneDrive"};return(e||t?this.enableVaultV2(e):g.n.resolve()).then(function(){return n._vroomDataRequestor.send({endpoint:Object(P.s)({apiVersion:i,driveId:"me",includeViewerId:!0}),apiName:"GetVault",path:"/drive/items/root/children?select=*,containingDrivePolicyScenarioViewpoint&filter=remoteItem/containingDrivePolicyScenarioViewpoint/PolicyScenarioId eq '".concat("fa0c6428-7a2e-4a42-a9cc-52f48021d0ba","'"),headers:r,breakCache:!0,apiVersion:i,useAuthorizationHeaders:!0})}).then(function(e){var t,n=(void 0===e?{value:[]}:e).value;if(0===n.length)return g.n.reject({status:404,message:"Vault not found"});var i=n[0];return Object(a.__assign)(Object(a.__assign)({},i),{vault:Object(F.e)(null===(t=i.remoteItem)||void 0===t?void 0:t.containingDrivePolicyScenarioViewpoint)})})},t}(i.n);t.default=j;var V=Object(I.r)("VaultDataSource",j,Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{clientName:k.e.optional,identityDataSource:o.p,vroomDataRequestor:x.e,itemStore:p.e,vaultStore:_.resourceKey,urlDataSource:o.H,navigation:b.e,itemProvider:D.resourceKey,dialogProvider:c.e,userInfoProvider:S._,itemParentHelper:f.e,bundleLoader:S.e,isItemsScopeEnabled:m.a.lazy}))},,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return u});var a=n(0),i=n(7),r=n(66),o=n(100),s=n(45),c=n(130),d=n(6),l=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._identityDataSource=n.identityDataSource,a.isVaultDisabled=a.createObservable(void 0),a.vaultFreState=a.createObservable(c.a.NotCreated),a.vaultQuota=a.createObservable(void 0),a.isOverQuota=a.createPureComputed(a._computeIsOverQuota),a.showVaultLockNotification=a.createObservable(!1),a.showVaultFreMessage=a.createObservable(!1),a.storageKeyPrefix=c.t+a._identityDataSource.getIdentity().id,a.dataStore=new o.e(a.storageKeyPrefix,s.e.local),a.isVaultOpen=a.createObservable(!!a.dataStore.getValue("expirationtime",s.e.local)),a}return Object(a.__extends)(t,e),t.prototype._computeIsOverQuota=function(){var e=this.vaultQuota();return!!e&&e.remainingFiles<=0&&e.totalFiles>0},t}(i.n);t.default=l;var u=Object(r.r)("VaultStore",l,Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{identityDataSource:d.p}))},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s});var a=n(424),i=n(1),r=n(165);function o(e){var t=e.targetOrigin,n=e.logOnly,o=e.iframeElem,s=e.allowedOrigins,c=e.migrationState,d=Object(r.t)().dispatcher;return Object(i.useEffect)(function(){if(o){var e=new a.t({targetOrigin:t,logOnly:n,iframeElem:o,allowedOrigins:s,migrationState:c});return e.attach(d),e.start(),e.sendHostReadyMessage(),function(){e.dispose(),e.deattach()}}},[n,o,s,d]),null}function s(e){var t=e.application,n=e.session,o=e.migrationState,s=Object(r.t)().dispatcher;return Object(i.useEffect)(function(){if(t&&n&&s){var e=Microsoft.Office[t.name].CommandIds,i=new a.e({application:t,session:n,migrationState:o,commandIds:e});return i.attach(s),i.start(),function(){i.dispose(),i.deattach()}}},[t,n,s]),null}},function(e,t,n){"use strict";n.d(t,"t",function(){return l}),n.d(t,"e",function(){return u});var a=n(0),i=n(134),r=n(34),o=n(31),s=n(19),c=n(57),d=n(88),l=function(){function e(e){var t=this;this.handleMessage=function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,i,r,l,u,f,p,m,_;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(Object(c.e)("WacPostMessageSource receive message: ",e.data),t=new s.e({name:"WacHost.Message.Post.".concat(e.type)}),!this.validate(e))return Object(c.e)("WacPostMessageSource invalid message: ",e.data),t.end({resultType:s.t.ExpectedFailure,resultCode:"WAC Post message source/origin is invalid",extraData:{origin:e.origin}}),[2];try{n=JSON.parse(e.data)}catch(n){return Object(c.e)("WacPostMessageSource invalid message data: ",e.data),t.end({resultType:s.t.Failure,resultCode:"WAC Post message data is invalid",extraData:{data:e.data,Error:null==n?void 0:n.message}}),[2]}if(this.logOnly)return Object(c.e)("WacPostMessageSource log message only: ",e.data),t.end({resultType:s.t.Success,resultCode:"WAC post message handling success",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(u=n.Values)||void 0===u?void 0:u.wdUserSession)}}),[2];d.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Receive.").concat(n.MessageId),usageType:"Click",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(f=n.Values)||void 0===f?void 0:f.wdUserSession)}}),a.label=1;case 1:return a.trys.push([1,6,,7]),this.dispatcher?(i=this.dispatcher.dispatch(n.MessageId,n.Values))?(r=void 0,o.n.isPromise(i)?[4,i]:[3,3]):[3,5]:(Object(c.e)("WacPostMessageSource ignore message cause no dispatcher: ",e.data),t.end({resultType:s.t.Success,resultCode:"Application message handling skip",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(p=n.Values)||void 0===p?void 0:p.wdUserSession)}}),[2]);case 2:return r=a.sent(),[3,4];case 3:r=i,a.label=4;case 4:r&&this.receive(r,e.source,e.origin),a.label=5;case 5:return t.end({resultType:s.t.Success,resultCode:"WAC post message handling success",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(m=n.Values)||void 0===m?void 0:m.wdUserSession)}}),[3,7];case 6:return l=a.sent(),Object(c.e)("WacPostMessageSource message error: ",l),t.end({resultType:s.t.Failure,resultCode:"WAC Post message handling error",extraData:{SendTime:n.SendTime,CorrelationId:n.CorrelationId,wdUserSession:n.wdUserSession||(null===(_=n.Values)||void 0===_?void 0:_.wdUserSession),Error:null==l?void 0:l.message}}),[3,7];case 7:return[2]}})})},this.logOnly=e.logOnly,this.targetOrigin=e.targetOrigin,this.allowedOrigins=e.allowedOrigins,this.iframeElem=e.iframeElem,this.migrationState=e.migrationState}return e.prototype.attach=function(e){this.deattach(),this.dispatcher=e,e.attach(this)},e.prototype.deattach=function(){this.dispatcher&&(this.dispatcher.deattach(this),this.dispatcher=void 0)},e.prototype.start=function(){window.addEventListener("message",this.handleMessage)},e.prototype.dispose=function(){window.removeEventListener("message",this.handleMessage)},e.prototype.sendHostReadyMessage=function(){if(this.iframeElem)try{this.receive({CorrelationId:i.e.generate(),MessageId:r.t.Host_PostmessageReady})}catch(e){console.log(e)}},e.prototype.receive=function(e,t,n){this.logOnly||(d.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Send.").concat(e.MessageId),usageType:"Click",extraData:{SendTime:Date.now(),CorrelationId:null==e?void 0:e.CorrelationId}}),t=t||this.iframeElem.contentWindow,n=n||this.targetOrigin,t&&n&&t.postMessage(JSON.stringify(Object(a.__assign)(Object(a.__assign)({},e),{SendTime:Date.now()})),n))},e.prototype.validate=function(e){var t=this.allowedOrigins,n=this.iframeElem,a=e.origin,i=e.source;return n&&i===n.contentWindow?!t||-1!==t.findIndex(function(e){return a.toLowerCase()===e.toLowerCase()})||(Object(c.e)("WacPostMessageSource invalid message cause invalid origin"),!1):(Object(c.e)("WacPostMessageSource invalid message cause invalid source"),!1)},e}(),u=function(){function e(e){var t=this;this.handleMessage=function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,i,r,l,u,f,p,m;return Object(a.__generator)(this,function(a){switch(a.label){case 0:Object(c.e)("WacPostMessageSource receive message: ",e.data),t=new s.e({name:"WacHost.Message.Application.".concat(e.type)}),n=e.type,i=e.data,d.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Receive.").concat(n),usageType:"Click",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(u=i.Values)||void 0===u?void 0:u.wdUserSession)}}),a.label=1;case 1:return a.trys.push([1,6,,7]),this.dispatcher?(r=this.dispatcher.dispatch(n,i))?(l=void 0,o.n.isPromise(r)?[4,r]:[3,3]):[3,5]:(t.end({resultType:s.t.Success,resultCode:"Application message handling skip",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(f=i.Values)||void 0===f?void 0:f.wdUserSession)}}),[2]);case 2:return l=a.sent(),[3,4];case 3:l=r,a.label=4;case 4:l&&this.receive(l),a.label=5;case 5:return t.end({resultType:s.t.Success,resultCode:"Application message handling success",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(p=i.Values)||void 0===p?void 0:p.wdUserSession)}}),[3,7];case 6:return a.sent(),Object(c.e)("WacPostMessageSource receive message: ",e.data),t.end({resultType:s.t.Failure,resultCode:"Application message handling error",extraData:{SendTime:i.SendTime,CorrelationId:i.CorrelationId,wdUserSession:i.wdUserSession||(null===(m=i.Values)||void 0===m?void 0:m.wdUserSession)}}),[3,7];case 7:return[2]}})})},this.application=e.application,this.session=e.session,this.migrationState=e.migrationState,this.commandIds=e.commandIds}return e.prototype.attach=function(e){this.deattach(),this.dispatcher=e,e.attach(this)},e.prototype.deattach=function(){this.dispatcher&&(this.dispatcher.deattach(this),this.dispatcher=void 0)},e.prototype.start=function(){this.application.addEventListener(this.handleMessage)},e.prototype.dispose=function(){this.application.removeEventListener(this.handleMessage)},e.prototype.receive=function(e){d.e.logData({name:"".concat(this.migrationState?"COB":"ODC",".WacPostMessage.Send.").concat(e.MessageId),usageType:"Click",extraData:{SendTime:Date.now(),CorrelationId:null==e?void 0:e.CorrelationId}}),this.runCommand(e)},e.prototype.runCommand=function(e){var t=e.MessageId,n=e.Values,a=this.getCommandId(t);a&&this.session.run(a,n)},e.prototype.getCommandId=function(e){var t=this.commandIds;switch(e){case r.t.BlurFocus:return t.blurFocus;case r.t.Host_AccessibilityLoopComplete:return t.continueAccessibilityLoop;case r.t.GrabFocus:return t.grabFocus;case r.t.CanEmbed:return t.sendEmbeddedViewUrl;case r.t.PostAccessToken:return t.sendAccessToken;case r.t.App_PopState:return t.popState;case r.t.Host_RefreshSessionInfo:return t.sendSessionInfo;case r.t.CheckUserAccessAndGrantPermissions_Result:return t.sendUserAccessAndPermissions;case r.t.Host_WopiInfoFromUrl:return t.sendWopiInfo;case r.t.Host_DavUrlFromIds:return t.sendDavUrl;case r.t.Host_SetCustomAuthConfig:return t.sendCustomAuthConfig;case r.t.Host_MoveToFolder:return t.moveToFolder;case r.t.Host_FilePicker:return t.completeSharedFilePicker}},e}()},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(7),r=n(66),o=n(163),s=n(31),c=n(157),d=n(44),l=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._operationProvider=n.operationProvider,a._operationBatch=t.operationBatch,a._onOperationFinished=t.onOperationFinished,a._completionSignal=new c.e,a._completionSignal.getPromise().done(function(){a.dispose()},function(){a.dispose()}),a.addDisposable(a._operationProvider.groups.subscribe(a._onOperationProviderGroupsChanged,a,"arrayChange")),a}return Object(a.__extends)(t,e),t.prototype.getGroupOperation=function(){return this._groupOperation},t.prototype.start=function(e){var t=this;return e().then(function(){t._completeIfNoGroupCreated()},function(e){return t._completeIfNoGroupCreated(),s.n.wrapError(e)})},t.prototype.wait=function(){return this._completionSignal.getPromise()},t.prototype._createGroupOperationSubscription=function(e){var t=this,n=this.createPureComputed(function(){var t=e.state();return t===d.e.completed||t===d.e.canceled||t===d.e.failed||t===d.e.expired});this.createBackgroundComputed(function(){n()&&t.observables.ignore(function(){t._onOperationFinished&&t._onOperationFinished(e)})})},t.prototype._onOperationProviderGroupsChanged=function(e){for(var t=0,n=e;t<n.length;t++){var a=n[t],i=a.value;i.batch===this._operationBatch&&("added"===a.status?this._groupOperation||(this._groupOperation=i,this._createGroupOperationSubscription(i)):"deleted"!==a.status||a.moved||this._completionSignal.complete())}},t.prototype._completeIfNoGroupCreated=function(){this._groupOperation||this._completionSignal.complete()},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{operationProvider:o.e}),t}(i.n),u=Object(r.o)("OperatorBatchMonitor",l)},function(e,t,n){"use strict";var a=n(0),i=n(59),r=function(){function e(){}return e.isOpenDebugWindowEvent=function(e){return!(e.keyCode!==i.e.graveAccent||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.isOpenSimplePerfDashboardEvent=function(e){return!(e.keyCode!==i.e.f8||!e.ctrlKey&&!e.altKey||e.shiftKey)},e.initSimplePerfDashboard=function(t){e._perfDashboardOpen||(e._markPerfDashboardOpen(!0),n.ee([142],658).then(function(n){n.show(t,e._markPerfDashboardOpen)}))},e.isInitialized=function(){return e._initialized},e.init=function(t){e._initialized||Object(a.__awaiter)(this,void 0,void 0,function(){var i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,n.ee([122],666)];case 1:return i=a.sent().default,e._initialized||(e._initialized=!0,i.init(t)),[2]}})})},e.enableAutoOpen=function(e){},e._markPerfDashboardOpen=function(t){e._perfDashboardOpen=t},e.AutoOpenSessionKey="DebugWindow_AutoOpen",e}();t.e=r},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3),i=n(66),r=new a.t({name:"VaultStore.key",loader:new i.t(function(){return n.ee(0,419).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return h});var a=n(0),i=n(31),r=n(645),o=n(553),s=n(52),c=n(191),d=n(15),l=n(57),u=n(19),f=new(function(){function e(){}return e.prototype.getItem=function(e,t){try{var n=null,a=window.opener;return a&&"onedrive.live.com"===a.location.host&&a.WacItemConfig&&"2cd39a29-83d8-4bf9-8ae7-33cdaeb38be8"===a.WacItemConfig.UniqueId&&(n=a.WacItemConfig.getWacItem(e,t)),i.n.resolve(n)}catch(e){return i.n.resolve(null)}},e}()),p=n(42),m=n(110),_=n(22),h=function(){function e(e,t,n){this._apiUrlBase=e,this._identityDataSource=t,this._badgerToken=n}return e.prototype.getItem=function(e,t,n,r,o,s){return void 0===o&&(o=!0),void 0===s&&(s=!1),Object(a.__awaiter)(this,void 0,i.n,function(){var c,d,u=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return s?[4,this._getItemFromCache(e,t)]:[3,2];case 1:if(c=a.sent())return[2,i.n.resolve(c)];a.label=2;case 2:return d=r?"/drives/"+encodeURIComponent(e)+"/items/root:/".concat(r):"/drives/"+encodeURIComponent(e)+"/items/".concat(t),d+="?".concat(this._getItemParams(n)),[2,this.request(d,"GET",o).then(function(e){var t=e[0];return u.buildOneDriveItemFromResponse(t)},function(e){var t=e[0];return Object(l.e)("Error: cannot get item info from vroom call: ",t),null})]}})})},e.prototype.redeemAndGetItem=function(e,t,n,i){return void 0===n&&(n=!1),void 0===i&&(i=!1),Object(a.__awaiter)(this,void 0,void 0,function(){var r,o,s,c,d,l,f=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=new u.e({name:"Wac.Shares.Redeem",startTimeOverride:Date.now()}),o="".concat(Object(p.t)(),"/shares/u!").concat(e),s=o,n&&(s+="/driveItem?".concat(this._getItemParams(t))),c=fetch,d=[s],l={method:"POST"},[4,this._createHeaders(!1,!0)];case 1:return[4,c.apply(void 0,d.concat([(l.headers=a.sent(),l)]))];case 2:return[2,a.sent().json().then(function(e){var t;return r.end({resultType:u.t.Success,resultCode:"Success",error:""}),e&&e.error?Promise.resolve(e):e&&e.id&&e.openWith?(i&&function(e){if(e){var t=new Date(Date.now()+6048e5);m.set("BadgerAuth",e,{secure:!0,expires:t.toUTCString(),domain:_.e.getCookieDomain()})}}(null===(t=f._badgerToken)||void 0===t?void 0:t.token),Promise.resolve(f.buildOneDriveItemFromResponse(e))):Promise.resolve(null)})]}})})},e.prototype.getWopiInfoWithItemId=function(e,t){var n="/items/".concat(e,"/driveItem?$select=openWith");return this.request(n,"GET",t).then(function(e){var t=e[0],n=t.openWith,a=t.webDavUrl,r=t.id,o=t.parentReference;return n&&n.wac?{driveId:o.driveId,itemId:r,webDavUrl:a,accessToken:n.wac.accessToken,accessTokenExpiry:n.wac.accessTokenExpiry,wopiSrc:n.wac.wopiSrc}:i.n.reject({driveId:null==o?void 0:o.driveId,itemId:r,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],a=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",r=JSON.stringify({error:n});return i.n.reject({error:{Id:a,Details:r}})})},e.prototype.getWopiInfoWithUrl=function(e,t){var n="/shares/".concat(e,"/driveItem?$select=openWith,parentReference,id");return this.request(n,"GET",t).then(function(e){var t=e[0],n=t.openWith,a=t.webDavUrl,r=t.id,o=t.parentReference;return n&&n.wac?{driveId:o.driveId,itemId:r,webDavUrl:a,accessToken:n.wac.accessToken,accessTokenExpiry:n.wac.accessTokenExpiry,wopiSrc:n.wac.wopiSrc}:i.n.reject({driveId:null==o?void 0:o.driveId,itemId:r,webDavUrl:a,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],a=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",r=JSON.stringify({error:n});return i.n.reject({error:{Id:a,Details:r}})})},e.prototype.getWopiDavURLWithDriveIdItemId=function(e,t,n){var a="/drives/".concat(e,"/items/").concat(t,"?$select=openWith,webDavUrl");return this.request(a,"GET",n).then(function(n){var a=n[0],r=a.openWith,o=a.webDavUrl;return r&&r.wac?{driveId:e,itemId:t,webDavUrl:o,accessToken:r.wac.accessToken,accessTokenExpiry:r.wac.accessTokenExpiry,wopiSrc:r.wac.wopiSrc}:i.n.reject({driveId:e,itemId:t,webDavUrl:o,error:{Id:"MissingProperty",Details:"No wac property was found in the response"}})},function(e){var t,n=e[0],a=(null===(t=e[1].status)||void 0===t?void 0:t.toString())||"Unknown",r=JSON.stringify({error:n});return i.n.reject({error:{Id:a,Details:r}})})},e.prototype.request=function(e,t,n,r){var o=this;return void 0===t&&(t="POST"),void 0===n&&(n=!1),void 0===r&&(r=!1),this._createHeaders(n,r).then(function(n){return new i.n(function(i,r){return Object(a.__awaiter)(o,void 0,void 0,function(){var o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,fetch("".concat(this._apiUrlBase).concat(e),{method:t,headers:n})];case 1:return[4,(o=a.sent()).json()];case 2:return s=a.sent(),o.ok?i([s,o]):r([null==s?void 0:s.error,o]),[2]}})})})})},e.prototype.buildOneDriveItemFromResponse=function(e){var t,n;if(!e)return Object(l.e)("Error: the item info is null"),null;var a=e.id,i=e.name,s=e.folder,c=e.thumbnails,u=e.size,f=e.description,p=e.root,m=e.eTag,_=e.parentReference,h=_&&_.driveId,b={key:Object(d._)((t={},t.id=a,t.driveId=h,t))},g=_.id?Object(d._)(((n={}).id=_.id,n.driveId=h,n)):void 0;b.parentKey=g,b.sharingRole=this._getSharingRole(e);var v=(s?{extension:""}:r.n(i)).extension;b.id=a,b.itemId=a;var y=_&&_.driveType;b.graph={itemId:a,driveId:h,driveType:y};var S=p?o.e:i;if(b.name=i,b.displayName=S,b.extension=v,b.size=u,b.caption=f||"",b.ownerId=h,b.isRootFolder=!!p,b.eTag=m,s){var D=s.childCount;if(b.folder={childCount:D},c&&c.length>0){b.folder.covers=[];for(var I=0,x=c;I<x.length;I++){var C=x[I];b.folder.covers.push(C.large)}}b.childCount=D}return b.vault=e.vault,b.itemFromServer=e,b},e.prototype._createHeaders=function(e,t){void 0===t&&(t=!1);var n={Accept:"application/json"};return e&&(n.Prefer="Include-Feature=Vault"),t&&(n.Prefer=n.Prefer?n.Prefer+",autoredeem":"autoredeem"),this._badgerToken?(n.Authorization="Badger ".concat(this._badgerToken.token),i.n.resolve(n)):this._identityDataSource.getSessionToken().then(function(e){return n.Authorization="Bearer ".concat(e.accessToken),n})},e.prototype._getSharingRole=function(e){var t=e.shared;if(t&&t.effectiveRoles&&t.owner){var n=t.effectiveRoles,a=Object(c.e)(n||[],function(){return!0});return a.owner?s.e.Owner:a.write?s.e.Edit:a.read?s.e.View:s.e.None}return s.e.Owner},e.prototype._getItemFromCache=function(e,t){var n=this,a=new u.e({name:"Wac.Item.Cache",startTimeOverride:Date.now()});return f.getItem(e,t).then(function(e){return e?(a.end({resultType:u.t.Success,resultCode:"Success",error:""}),n.buildOneDriveItemFromResponse(e)):null}).catch(function(e){return null})},e.prototype._getItemParams=function(e){return"action=".concat(e,"&$select=*,openWith,webDavUrl")},e}()}],Array(19),[function(e,t,n){"use strict";n.d(t,"i",function(){return i.e}),n.d(t,"e",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"a",function(){return c});var a=n(3),i=n(206),r=(new a.t("sharingContextInformation"),new a.t("listContext")),o=(new a.t("listItems"),new a.t("inplaceEditorUrl"),new a.t("inplaceEditorClosing"),new a.t("appViewChangeInProgress"),new a.t("appViewChangeInProgress"),new a.t("itemsPerGroup"),new a.t("loggingContext")),s=new a.t("loggingContextBuckets"),c=(new a.t("provider.contentTypes"),new a.t("onePageContext"),new a.t("searchBehavior"),new a.t("newDocumentTemplates"));new a.t("listsHostContext"),new a.t("listsHostWelcomeContext"),new a.t("getApplicationKey")},,,,function(e,t,n){"use strict";var a,i=n(0),r=n(246),o=n(7),s=n(157),c=n(66),d=n(570),l=n(294),u=n(253),f=n(23),p=n(19);!function(e){e[e.none=0]="none",e[e.queue=1]="queue",e[e.server=2]="server"}(a||(a={}));var m=a,_=Object(u.e)({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:a,type:f.e.Enum}},p.e),h=n(459),b=n(77),g=n(14),v=n(2),y=!g.t.isActivated("C123FC1B-1706-4C97-AFF3-45C077654F1A","08/11/2022","Enable not pre-auth vroom style image preview"),S=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._semaphore=new l.e(16),a._thumbnailCache=n.thumbnailCache,a}return Object(i.__extends)(t,e),t.prototype.loadImage=function(e){var t=this,n=e.url,a=e.imageElement,i=void 0===a?document.createElement("img"):a,r=e.scenarioName,o=e.desiredSize,s=e.getContents,c={url:n,width:0,height:0},l=this._thumbnailCache,u=l.isLoaded(c),f=function(e){return d.e.authenticate(e).then(function(){return t._waitForImageLoad(i,e,r)}).then(function(e){if(l.record(c),i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var t=i.naturalWidth||i.width,n=i.naturalHeight||i.height;return{url:e,width:t,height:n}})};return y&&s?this.trackPromise(s(Object(v.isFeatureEnabled)(v.FixODCOneUpPreview)?o:void 0,n).then(function(e){var n=URL.createObjectURL(e);return u?f(n):t._semaphore.enqueue(function(){return f(n)})})):u?f(n):this._semaphore.enqueue(function(){return f(n)})},t.prototype._waitForImageLoad=function(e,t,n){var a,i,r,o=this.async,c=this.events,d=function(){r&&o.clearTimeout(r),c.off(e)},l=new s.e(function(){d(),e.setAttribute("src",""),t&&/^blob:/.test(t)&&URL.revokeObjectURL(t)}),u=t&&t.indexOf("&encodeFailures=1")>=0;return c.onAll(e,{load:function(){if(d(),u&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;i&&i.end({resultType:n?p.t.ExpectedFailure:p.t.Failure,resultCode:"".concat(t),error:"Encoded failure"}),l.error(new b.e({code:"".concat(t),isExpected:n,message:"Server returned encoded failure ".concat(t)}))}else i&&i.end({resultType:p.t.Success}),l.complete(a)},error:function(){d(),i&&i.end({resultType:p.t.Failure}),l.error(new Error("Image '".concat(t,"' failed to load")))}}),r=o.setTimeout(function(){l.cancel()},3e4),n&&(i=new _({name:n,loadType:m.server})),e.setAttribute("src",t),a=!!e.complete,this.trackPromise(l.getPromise())},t.prototype._waitForTimeout=function(e){var t,n=this.async,a=new s.e(function(){t&&n.clearTimeout(t)});return t=n.setTimeout(function(){a.complete()},e),a.getPromise()},t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.n.dependencies),{thumbnailCache:h.e}),t}(o.n),D=Object(c.r)("ImageLoader",S),I=n(317),x=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t)||this;a._debouncer=new I.e,a._imageLoader=a.resources.consume(D);var i=a.valueAccessor(),r=i.src,o=i.image,s=i.error,c=i.isLoaded,d=i.isError,l=i.actualSize,u=i.scenarioName,f=i.desiredSize,p=i.getContents;a._src=a.wrapObservable(r),a._image=a.wrapObservable(o),a._error=a.wrapObservable(s),a._scenarioName=u,a._getContents=p,a._desiredSize=a.wrapObservable(f);var m=n.outputExtenders,_=void 0===m?{deferred:!0}:m;return a.createComputed(a._computeLoadImage),a.createBackgroundComputed(function(){var e=a._image();if(c&&c(!!e),l){var t=void 0;e&&(t={width:e.width,height:e.height}),l(t)}o&&o(e)}).extend(_),a.createBackgroundComputed(function(){var e=a._error();s&&s(e),d&&d(!!e)}).extend(_),a}return Object(i.__extends)(t,e),t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src),a=this.unwrapObservable(this._getContents);this._image(void 0),this._scenarioName&&(e=new _({name:this._scenarioName,loadType:m.queue})),this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName,desiredSize:this.unwrapObservable(this._desiredSize),getContents:a}))).then(function(n){t._image(n),t._error(void 0),e&&e.end({resultType:p.t.Success})},function(n){t._error(n),e&&e.end({resultType:n.isExpected?p.t.ExpectedFailure:p.t.Failure})})},t}(r.t);t.e=x},,,,function(e,t,n){"use strict";var a=n(108);Object(a.e)([{rawString:".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"}]);var i=n(0),r=n(17),o=n(98),s=n(452),c=n(472),d=function(e){function t(t){var n=e.call(this,t)||this;return t&&void 0!==t.loadingText?n.loadingText=t.loadingText:n.loadingText=c.e,n.addBindingHandlers({imageLoader:s.e}),n.isVisible=r.observable(!0),n.isImageLoaded=r.observable(!1),n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif"),n}return Object(i.__extends)(t,e),t.prototype.hideSpinner=function(){this.isVisible(!1)},t}(o.e),l=n(99).e({tagName:"ms-loadingSpinner",template:'<div class="od-LoadingSpinner" data-automationid="ms-loadingSpinner"><img class="od-LoadingSpinner-loadingGif" role="presentation" data-bind="click:hideSpinner,visible:isVisible,imageLoader:{src:loadingImageUrl,isLoaded:isImageLoaded}"><span class="od-LoadingSpinner-loadingText" data-bind="text:loadingText"></span></div>',viewModel:d,synchronous:!0});t.e=l},,function(e,t,n){"use strict";var a;!function(e){e[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(0),i=n(7),r=n(66),o=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a._recordsByThumbnailKey={},a._bucketsByImageKey={};var i=a.observables;a.lastAccessedDate=i.create(new Date);var r=n.pruneThumbnailsExtenders,o=void 0===r?{rateLimit:{timeout:6e5}}:r;return i.backgroundCompute(a._pruneThumbnails).extend(o),a}return Object(a.__extends)(t,e),t.prototype.getCoveragePercent=function(e,t){var n=l(e),a=l(t);return Math.sqrt(a/n)},t.prototype.register=function(e,t,n,a){void 0===n&&(n=t),void 0===a&&(a=!0);var i=this.lastAccessedDate;i(new Date);var r=d(this.getCoveragePercent(e,n)),o=c(e),s=c(t),l=this._recordsByThumbnailKey,u=this._bucketsByImageKey,f=l[o]||{lastAccessed:void 0,buckets:{}};f.lastAccessed=i.peek();var p=f.buckets[r];(!p||this.getCoveragePercent(p.size,n)>1)&&(p&&delete u[p.key],p=f.buckets[r]={key:s,size:n,image:t,isLoaded:a,lastAccessed:i.peek()}),u[s]=p,l[o]=f},t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=c(e),a=this._bucketsByImageKey,i=a[n];i?i.isLoaded=!0:a[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}},t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=c(e),a=this._bucketsByImageKey[n];return a&&(a.lastAccessed=t.peek()),!!a&&a.isLoaded},t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=t);var a=c(e),i=this._recordsByThumbnailKey[a],r=this.lastAccessedDate;if(r(new Date),i){var o=i.buckets;i.lastAccessed=r.peek();var s=d(t),l=d(n),u=-1/0,f=!1;for(var p in o){var m=Number(p);m<=s&&m>=l&&o[m].isLoaded&&(u=Math.max(u,m),f=!0)}var _=f&&o[u];return _&&_.image}},t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();u(this._recordsByThumbnailKey,e),u(this._bucketsByImageKey,e)},t}(i.n),s=Object(r.r)("ThumbnailCache",o);function c(e){var t=e.url,n=e.width,a=e.height;return JSON.stringify({url:t,width:n,height:a})}function d(e){return Math.floor(Math.log(e)/Math.log(2)*4)}function l(e){return e.width*e.height}function u(e,t){for(var n=0,a=Object.keys(e);n<a.length;n++){var i=a[n];t-e[i].lastAccessed.getTime()>432e5&&delete e[i]}}},function(e,t,n){"use strict";var a;!function(e){e[e.Recycle=2]="Recycle",e[e.PermanantDelete=3]="PermanantDelete",e[e.MoveToSecondStage=4]="MoveToSecondStage"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.r(t),n.d(t,"resourceKey",function(){return D});var a=n(0),i=n(94),r=n(66),o=n(36),s=n(724),c=n(14),d=n(31),l=function(){function e(e,t){this.item=e.item,this._dataSource=t.dataSource}return e.prototype.getSettings=function(){var e=this;return this._settingsPromise||(this._settingsPromise=this._dataSource.getSettings(this),this._settingsPromise.done(null,function(t){d.n.isCanceled(t)&&(e._settingsPromise=null,e._rawResponse=null)})),this._settingsPromise},e.prototype.getPermissions=function(e){return this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this)),this._permissionsPromise},e.prototype.cancelGetPermissionsPromise=function(){this._permissionsPromise&&(this._permissionsPromise.cancel(),this._cleanCacheIfCancel())},e.prototype.getLinks=function(){var e=this;return this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(t){return e._linksData=t,t})),this._linksPromise},e.prototype.cancelGetLinksPromise=function(){this._linksPromise&&(this._linksPromise.cancel(),this._cleanCacheIfCancel())},e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)},e.prototype.setLink=function(e){var t=this._linksData;if(e&&t){var n=t.filter(function(t){return t&&t.role===e.role&&t.type===e.type});if(0===n.length)t.push(e);else{var a=n[0];a.url=e.url,a.expiration=e.expiration,a.isActive=e.isActive}}},e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()},e.prototype.getRawResponse=function(){var e=this;return this._rawResponse||(this._rawResponse=this._dataSource.getRawResponse(this),this._rawResponse.done(null,function(t){d.n.isCanceled(t)&&(e._rawResponse=null)})),this._rawResponse},e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null,this._settingsPromise=null,this._permissionsPromise=null,this._rawResponse=null},e}(),u=n(215),f=n(138),p={ODB:!c.e.isActivated("61c45046-bce1-4f47-a4dc-477520ba1895","11/16/2021","Do not invalidate item after sharing when in search view")},m=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._dataSource=n.sharingDataSource,a._shareDataCache={},a._shareItemHelper=n.shareItemHelper,a}return Object(a.__extends)(t,e),t.prototype.getSharingInformation=function(e,t,n,a,i){return this._dataSource.getSharingInformation(e,t,n,a,"",i)},t.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){return n.link&&(t._invalidateCachedItem(e.items[0]),t._invalidateItem(e.items[0])),n})},t.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){return t._invalidateCachedItem(e.item),t._invalidateItem(e.item),n})},t.prototype.updatePermissions2=function(e,t,n){var a=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){return a._invalidateCachedItem(t),a._invalidateItem(t),e})},t.prototype.updatePermissionsMultiple=function(e,t,n,a,i){var r=this;return this._dataSource.updatePermissionsMultiple(e,t,n,a,i).then(function(e){return r._invalidateCachedItem(t),r._invalidateItem(t),e})},t.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)},t.prototype.getClientId=function(){return this._dataSource.getClientId()},t.prototype.parseRawSharingInformation=function(e,t){return this._dataSource.parseRawSharingInformation(e,t)},t.prototype.emailWithoutPermissioning=function(e,t,n){return this._dataSource.emailWithoutPermissioning(e,t,n)},t.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)},t.prototype.setAddressBarLinkCapability=function(e,t){return this._dataSource.setAddressBarLinkCapability(e,t)},t.prototype.shareLinkExpress=function(e,t){return this._dataSource.shareLinkExpress(e,t,s.e.AddressBarLink)},t.prototype.getSharingData=function(e,t){var n=this._shareDataCache[e.id],a=n&&n.data;return a&&e.eTag===n.eTag&&!t||(a=this.scope.attach(new l({item:e},{dataSource:this.getSharingDataDataSource()})),this._shareDataCache[e.id]={eTag:e.eTag,data:a}),a},t.prototype.share=function(e,t){var n=this;return this._shareItemHelper.share(e,t).then(function(e){return n._invalidateCache(),e})},t.prototype.stopSharing=function(e,t){var n=this;return this._dataSource.stopSharing(e,t).then(function(e){return n._invalidateCache(),e})},t.prototype.unshare=function(e){var t=this;return this._dataSource.unshare(e).then(function(n){return t._invalidateCache(),t.itemProviderInvalidateParent(e),t.itemProviderInvalidate(e.key),n})},t.prototype.updatePermissions=function(e,t,n,a){var i=this;return this._dataSource.updatePermissions(e,t,n,a).then(function(e){return i._invalidateCache(),i.itemProviderInvalidateParent(t),e})},t.prototype.manageSharingLinks=function(e,t){var n=this;if(t&&t.link&&t.link.shareId&&!t.create){var a={item:e[0],kind:t.link.kind,shareId:t.link.shareId};return this._dataSource.unshareLink(a).then(function(e){return n._invalidateCachedItem(a.item),n._invalidateItem(a.item),[]})}var i=(e=e&&e.length?e:[]).map(function(e){return n.getSharingData(e)});return this._dataSource.manageSharingLinks(i,t).then(function(t){n._invalidateCache();var a=e[0];return a&&n.itemProviderInvalidateParent(a),t})},t.prototype._invalidateCache=function(){this._shareDataCache={}},t.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)},t.prototype._invalidateItem=function(e){!this.itemProviderInvalidate||!e||e.queryType===u.e.Search&&Object(f.e)(p)||this.itemProviderInvalidateParent(e)},t}(i.e),_=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._dataSource=n.sharingDataSource,a}return Object(a.__extends)(t,e),t.prototype.share=function(e,t,n){return this._dataSource.share(e,t)},t}(i.e),h=n(6),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.dependencies={sharingDataSource:h.L},t}(_),g=Object(r.r)("ShareItemHelper",b),v=n(50),y=n(51),S=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._sharingDataDataSource=n.sharingDataDataSource,a._itemProvider=n.externallySharedItemProvider||n.itemProvider,a}return Object(a.__extends)(t,e),t.prototype.getSharingDataDataSource=function(){return this._sharingDataDataSource},t.prototype.itemProviderInvalidate=function(e){this._itemProvider.invalidateItem(e)},t.prototype.itemProviderInvalidateParent=function(e){var t=e&&e.UNSAFE_parent&&e.UNSAFE_parent.key;t&&this._itemProvider.invalidateItem(t)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.e.dependencies),{sharingDataSource:h.L,sharingDataDataSource:h.k.optional,navigation:o.e,externallySharedItemProvider:v.n.optional,itemProvider:y.resourceKey.optional,shareItemHelper:g}),t}(m),D=(t.default=S,Object(r.r)("SharingProvider",S))},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(7),i=new(n(3).t)({name:"".concat("UserStateProvider.key",".updateQuota"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3),i=n(66),r=new a.t({name:"UploadOperator.key",loader:new i.t(function(){return n.ee([88],652).then(function(e){return e.typeResourceKey})})})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return o});var a=n(3),i=n(259),r=n(329),o=new a.t({name:"".concat("FirstRunExperienceStatus.key",".FirstRunExperienceStatus"),factory:{dependencies:{},create:function(e){return{instance:new i.e(r.e.notConfigured)}}}})},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n(0),i=n(7),r=n(66),o=n(31),s=n(17),c=function(){function e(e){var t=this,n=e.noTitle,a=void 0!==n&&n,i=e.title,r=void 0===i?s.observable(""):i,c=e.elementDescribedBy,d=void 0===c?"":c,l=e.hasCommandBar,u=void 0!==l&&l,f=e.size,p=void 0===f?"Small":f,m=e.scrollMode,_=void 0===m?"auto":m,h=e.showCloseButton,b=void 0===h||h,g=e.includePadding,v=void 0===g||g,y=e.preserveLightDismiss,S=void 0!==y&&y,D=e.stickyCloseButton,I=void 0!==D&&D,x=e.component,C=void 0===x?null:x,O=e.maximizePanelContent,w=void 0!==O&&O,E=e.panelContentSize,A=void 0===E?s.observable({width:0,height:0}):E,L=e.isBlocking,k=e.disableEscape,M=void 0!==k&&k,P=e.overridePanelStyle;this.size=p,this.title=s.isObservable(r)?r:s.observable(r),this.elementDescribedBy=d,this.maximizePanelContent=w,this.panelContentSize=A,this.noTitle=a,this.hasCommandBar=u,this.component=C,this.scrollMode=_,this.showCloseButton=b,this.includePadding=v,this.preserveLightDismiss=S,this.stickyCloseButton=I,this.isBlocking=s.isObservable(L)?L:s.observable(L),this.disableEscape=M,this.overridePanelStyle=P,this.state=s.observable(0),this._promise=new o.n(function(e){var n=s.computed(function(){1===t.state()&&(e(!0),n.dispose())},t)})}return e.prototype.wait=function(){return this._promise},e}(),d=n(326),l=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a.currentPanels=a.observables.createArray(),a._needsOverlayContent=n.needsOverlayContent,a}return Object(a.__extends)(t,e),t.prototype.requestPanel=function(e){this._needsOverlayContent.needsOverlayContent.set(!0);var t=new c(e),n=this.currentPanels;n.push(t);var a=function(){return n.remove(t)};return t.wait().then(a,a),t},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{needsOverlayContent:d.e}),t}(i.n),u=Object(r.r)("PanelProvider",l)},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(3).t)("people")},function(e,t,n){"use strict";n.d(t,"e",function(){return D});var a,i,r=n(0),o=n(116),s=n(31),c=n(157),d=n(187),l=n(66),u=n(3),f=n(532),p=n(19),m=n(390),_=n(14),h=_.e.isActivated("06BB39DE-57D9-40CA-B107-2EBFF4CE4AF5","11/10/2022","Point logSuccess, logUnexpectedFailure, and logExpectedFailure to use logEndData"),b=_.e.isActivated("68B68656-3621-421B-9045-10B503504CEC","12/17/2022","Log and end a Qos Event when AppQos logs an end event without a start.");function g(e,t,n){if(void 0===n&&(n=!1),!a){var o=e||{name:"App"},s=p.e.withContext(function(e){return t?Object(r.__assign)(Object(r.__assign)({},e),{Workload:t}):e});a=new s(o),n&&(i=new m.e({scenario:"AppBoot",pillar:"Boot"}))}return a}var v=new u.t("BootOptions"),y=n(105),S=function(){function e(e,t){this.isPageLoaded=!1,this.isPageRenderingComplete=!1,this._pltSignal=new c.e,this._renderingCompleteSignal=new c.e,this._async=new o.e,this._resources=t.resources,this._immediatePageLoadedCallbacks=[],this._scope=new f.e,this._scope.attach(this._async),this._scope.trackSignal(this._pltSignal),this._scope.trackSignal(this._renderingCompleteSignal)}return e.prototype.pageLoaded=function(e){var t,n,o,c=this;if(e&&("string"==typeof e?t=e:(t=e.name,n=e.workload,o=e.error)),!this.isPageLoaded){t&&d.e.plt(t),function(e){if(h){var t=(e||{}).workload;a||g(void 0,t),null==a||a.end(e||{resultType:p.t.Success})}else!function(e){var t=e.workload;a||(g(void 0,t),b||new p.e({name:"AppQosWithoutStart"}).end({resultType:p.t.Failure})),e&&a&&a.end(e),i&&e&&i.end({resultType:e.resultType,errorCode:null==e?void 0:e.resultCode,extraData:null==e?void 0:e.extraData})}(e||{resultType:p.t.Success})}(Object(r.__assign)({resultType:p.t.Success},n?{workload:n}:{})),this.isPageLoaded=!0,this.pageLoadError=o;var l=this._resources.consume(v.optional);l&&l.onEUPL&&l.onEUPL();for(var u=[],f=this._immediatePageLoadedCallbacks.shift();f;)u.push(this._scope.trackPromise(f())),f=this._immediatePageLoadedCallbacks.shift();s.n.all(u).then(function(){c._async.setImmediate(function(){return c._pltSignal.complete()})})}},e.prototype.pageRenderingIsComplete=function(e){var t=this;this._async.setImmediate(function(){return t._renderingCompleteSignal.complete()})},e.prototype.waitForPLT=function(){var e=this,t=this._pltSignal;return t.getPromise().catch(function(n){return n instanceof y.e&&t!==e._pltSignal?e.waitForPLT():s.n.reject(n)})},e.prototype.waitForPageRenderingComplete=function(){var e=this,t=this._renderingCompleteSignal;return t.getPromise().catch(function(n){return n instanceof y.e&&t!==e._renderingCompleteSignal?e.waitForPageRenderingComplete():s.n.reject(n)})},e.prototype.reset=function(){this.isPageLoaded=!1,this.pageLoadError=void 0;var e=this._pltSignal,t=this._renderingCompleteSignal;this._pltSignal=new c.e,this._renderingCompleteSignal=new c.e,e.error(new y.e({message:"Reset page load state."})),t.error(new y.e({message:"Reset page load state."}))},e.prototype.addImmediatePageLoadedCallback=function(e){if(this.isPageLoaded)throw"Cannot add immediate page loaded call back after page has already loaded";if(this._immediatePageLoadedCallbacks.length>3)throw"Too many callbacks registered!";this._immediatePageLoadedCallbacks.push(e)},e.prototype.dispose=function(){this._scope.dispose()},e}(),D=Object(l.r)("PageLoadMonitor",S,{resources:u.r})},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3),i=n(66),r=new a.t({name:"AlbumProvider.key",loader:new i.t(function(){return n.ee([82,"ondemand.resx-ondemand"],650).then(function(e){return e.resourceKey})})})},,,function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(100),i=function(){function e(){this._state={}}return e.prototype.getValue=function(e,t){var n=this._state[e];if(n&&t<n.expiration)return n;delete this._state[e]},e.prototype.setValue=function(e,t){t?this._state[e]=t:delete this._state[e]},e}(),r=function(){function e(e){var t=e.userId,n=e.cachingType;this._store=new a.e("Identity.OAuth.".concat(t),n)}return e.prototype.getValue=function(e,t){var n=this._store.getValue(e);if(n&&t<n.expiration)return n;this._store.remove(e)},e.prototype.setValue=function(e,t){t?this._store.setValue(e,t):this._store.remove(e)},e}()},,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var a=n(14),i=n(3),r=n(66),o=n(621),s=n(138),c=a.e.isActivated("EEE100CF-4686-4365-A420-B78444ADC660","07/06/2023")||Object(s.e)({ODB:60362}),d=function(){function e(){}return e.prototype.onChange=function(){return function(){}},Object.defineProperty(e.prototype,"offline",{get:function(){return!1},enumerable:!1,configurable:!0}),e}(),l=new i.t({name:"offlineDetection",factory:c?new r.i(o.e):new r.i(d)})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3),i=n(66),r=new a.t({name:"".concat("AlbumsInvalidator.key",".albumsInvalidator"),loader:new i.t(function(){return n.ee([91],670).then(function(e){return e.resourceKey})})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(214),i=new a.e("viewParamsToItemKey",{itemKey:a.t})},function(e,t,n){"use strict";var a,i=n(0),r=n(7),o=n(31),s=n(344),c=n(345),d=n(112),l=n(269),u=n(40),f=n(52),p=n(56),m=n(29),_=n(458),h=n(167),b=n(499);!function(e){e.AppleLivePhoto="AppleLivePhoto",e.SamsungMotionPhoto="SamsungMotionPhoto"}(a||(a={}));var g,v=n(293),y=n(107),S=n(5),D=n(76),I=n(22),x=n(14),C=n(72),O=n(322),w=n(319),E=n(81);!function(e){e[e.unRes=0]="unRes",e[e.doc=1]="doc"}(g||(g={}));var A,L=n(20),k=g[g.unRes],M=g[g.doc],P="scaled",T=function(e){function t(t){return void 0===t&&(t={}),e.call(this,t)||this}return Object(i.__extends)(t,e),t.prototype.processThumbnailSet=function(e,t){for(var n={},a={},r=0,o=e.thumbnails;r<o.length;r++){var s=o[r];n[s.name]=s,0===s.name.indexOf(P)&&(a[s.name.substring(P.length).toLowerCase()]=s)}var c,d={thumbnailSet:e,thumbnailsByType:n,thumbnailsBySize:a,item:t},l=n[k],u=n[M];return l?c=this._isOriginalThumbnailRequired(t)?this._getOriginalThumbnail(l,d):this._getUnResThumbnail(l,d):u?c=t.video&&t.video.width&&t.video.height?this._getUnResThumbnail(Object(i.__assign)(Object(i.__assign)({},u),{width:t.video.width,height:t.video.height}),d):t.photo&&t.photo.width&&t.photo.height?this._getUnResThumbnail(Object(i.__assign)(Object(i.__assign)({},u),{width:t.photo.width,height:t.photo.height}),d):this._getDocThumbnail(u,d):Object.keys(a).length&&(c=this._getScaledThumbnail(d)),c},t.prototype.getProcessFiltersUrl=function(e,t){for(var n,a=0,i=e.thumbnails;a<i.length;a++){var r=i[a];"custom"===r.name&&(n=r)}return n?this._createSizedUrl(e.baseUrl,n.url,{width:n.width,height:n.height}):""},t.prototype._getOriginalThumbnail=function(e,t){var n=t.item.photo.originalUrl||t.item.urls&&t.item.urls[h.e[h.e.download]];return n?{width:t.item.photo.width,height:t.item.photo.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(e,a){return{width:t.item.photo.width,height:t.item.photo.height,url:n}}}:this._getUnResThumbnail(e,t)},t.prototype._getUnResThumbnail=function(e,t){var n=this;return{width:e.width,height:e.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(a,i){return{width:e.width,height:e.height,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,a)}}}},t.prototype._getDocThumbnail=function(e,t){var n=this;return{width:0,height:0,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(a,i){return{width:0,height:0,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,{width:a.width,height:Math.max(a.height,2048)})}}}},t.prototype._getScaledThumbnail=function(e){var t,n=this,a=[];for(var i in e.thumbnailsBySize){var r=e.thumbnailsBySize[i];"largest"===i?t=r:a.push(r)}a.sort(function(e,t){return e.width*e.height-t.width*t.height}),t=t||a[a.length-1];var o=e.item.photo||t;return{url:this._createUrl(e.thumbnailSet.baseUrl,t.url),width:o.width,height:o.height,getAligned:function(i,r){for(var s,c=i.width*i.height,d=0,l=a;d<l.length;d++){var u=l[d];if(u.width*u.height>.9*c){s=u.url;break}}return{width:o.width,height:o.height,url:n._createUrl(e.thumbnailSet.baseUrl,s||t.url)}}}},t.prototype._createSizedUrl=function(e,t,n){var a={width:Math.ceil(n.width),height:Math.ceil(n.height)};return n.width===n.height&&(a.cropMode="center"),this._createUrl(e,t,a)},t.prototype._createUrlPattern=function(e,t){return this._createUrl(e,t,{width:{uriValue:"{0}"},height:{uriValue:"{1}"},cropMode:"center"})},t.prototype._createUrl=function(e,t,n){void 0===n&&(n={});var a="".concat(e).concat(t),i=L.n(n)?a.indexOf("?")>-1?"&":"?":"";return"".concat(a).concat(i).concat(L.n(n))},t.prototype._isOriginalThumbnailRequired=function(e){var t=e.extension,n=void 0===t?"":t,a=e.photo;return".gif"===n.toLowerCase()&&!!a},t}(r.n),U=n(2),F=n(47),H=n(6),R=n(186),N=n(409),B=n(373),j=n(73),V=n(142),z=((A={}).at="1",A.ata="1",A.de="3",A.defc="1",A.dl="3",A.em="3",A.mc="1",A.rfa="1",A.rn="1",A.sh="1",A.vo="1",[".jfif",".jfif-tbnl",".jpe",".jpg",".jpeg"]),G=n(435);function K(e,t,n){var a=window.FilesConfig&&window.FilesConfig.df?"s":"p";return"https://southcentralus1-media".concat(a,".svc.ms/transform/").concat(e,"?provider=odc&cs=V2VifE9EQw==&inputFormat=").concat(t,"&docid=").concat(encodeURIComponent(n))}var W=n(720);function q(e){if("number"==typeof e)return Object(W.e)(e)}var Q=n(153),Y=!x.e.isActivated("B11CEEB1-B225-42EF-A0A0-0892C41C07F1","07/15/2022","Force item redemption for skyapi items when the user is anonymous"),J={0:f.e.Owner,1:f.e.Edit,2:f.e.View,3:f.e.Submitter,4:f.e.CoOwner,5:f.e.None},X="1209427492",Z="0000000048166624",$=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.getRootItemTitle,i=void 0===a?n._getRootItemTitle:a,r=t.getItemKeyExtension,o=void 0===r?n._getItemKeyExtension:r;return n._getRootItemTitle=i,n._getItemKeyExtension=o,n._urlDataSource=n.resources.consume(F.n),n._identityDataSource=n.resources.consume(H.p),n._thumbnailProcessor=new(n.managed(T)),n}return Object(i.__extends)(t,e),t.prototype.processItemResult=function(e){var t=this,n=e.requestKey,r=e.itemFromServer,o=e.requestMetadata,s=e.setItemKey,c=e.skipSettingChildren,l=e.isPrimaryRequestedItem,u=e.isPlaceholder,_=e.observer,g=this._urlDataSource.getKeyParams(n),y=e.queryType,x=void 0===y?this._urlDataSource.getQueryType(g):y;if(r){var A=this.getItemKey({requestKey:n,itemFromServer:r}),L={key:A},k=r.itemStatus;L.itemStatus=k;var M="";r.locatedIn?M=r.locatedIn:r.deletedFromLocation?M="/"===r.deletedFromLocation[0]?r.deletedFromLocation.substr(1):r.deletedFromLocation:r.ownerCid&&r.ownerCid===I.e.viewerId?M=d.e:r.ownerName&&(M=C.s(d.u,r.ownerName));var P=r.internalPath;P&&(L.internalPath=P);var T=this._identityDataSource.getIdentity(),F=r.ownerCid||T.id,H=this._getNormalizedId(r);L.id=H;var N="root"===r.id?r.rootResourceId||"root":H,V=r.resourcePartitionCid||F;L.itemId=N,void 0!==r.mruId&&(L.mruState={mruId:r.mruId,app:r.mruApp,type:r.mruType}),L.graph={itemId:N,driveId:V,driveType:"personal"},L.statistics={views:r.visitorViews},L.eTag=r.eTag,L.isSharerFolder=r.isSharerFolder,L.parentKey=this._getParentKey(r,{requestKeyParams:g});var W=this._getVirtualItemType(r);L.virtualItemType=W;var X=this._isPhotosRoot(r,{requestKeyParams:g}),Z=this._isPhotosSubRoot(r,{requestKeyParams:g,isPhotosRoot:X}),$=this._getIsRootFolder(r,{isPhotosSubRoot:Z});L.isRootFolder=$;var ee=r.name,te="";L.comments={count:r.commentCount||0,settings:{isCommentDisabled:r.commentSettings&&r.commentSettings.commentingDisabled&&!!r.commentSettings.commentingDisabled.isDisabled}},l||(L.isStub=r.isPlaceholder);var ne=r.iconType?O.e[r.iconType.toLowerCase()]:"";L.appMap=ne;var ae=this._getItemType(r,ne),ie=r.extension||"";L.extension=ie,L.size=Number(r.size);var re,oe=r.sharingLevelValue;L.sharingType=oe,L.isBundle=!!r.isBundle,L.locations=r.locations,L.creatorName=r.creatorName,L.caption=r.caption||"",L.itemFromServer=r,(r.photo||r.video||r.isAlbum)&&(re=r.tags||[]),L.tags=re,L.ocr=r.ocr,L.urls=r.urls;var se=r.userRole in J?J[r.userRole]:f.e.None;"MountPoint"===r.groupFolderType&&(se=f.e.Edit,L.mountPoint={}),L.vault=r.vault;var ce=r.vault;ce&&ce.root&&this.resources.consumeAsync(v.e).then(function(e){e.setVaultLockState(ce)}),L.defaultSubText=this._getDefaultSubText(se,oe,r.sharingLevel),L.location=M,L.ownerId=F,L.ownerName=r.ownerName||"",L.uploadOwnerId=V,L.specialFolderCanonicalName=r.specialFolderCanonicalName||"",L.isSpecialFolder=!!r.isSpecialFolder;var de={};if($&&(I.e.areCidsEqual(L.ownerId,I.e.viewerId)?(ee=this._getRootItemTitle(A),se=f.e.Owner):ee=d.l,o&&(L.taskStatus={restoreAllCount:o.restoreAllWorkItemCount,deleteAllCount:o.deleteAllWorkItemCount})),o&&(L.tokenNeedsRedeeming=o.tokenNeedsRedeeming,L.tokenType=o.tokenType),Y&&T.type===Q.e.anonymous&&(L.tokenNeedsRedeeming=!0),r.settings&&(de.allPhotosFolderId=r.settings.allPhotosFolderId,de.allPhotosSortAscending=r.settings.allPhotosSortAscending),r.displayQuotaExceeded&&(de.quota={display:{exceeded:r.displayQuotaExceeded,remaining:r.displayQuotaRemaining,total:r.displayQuotaTotal,used:r.displayQuotaUsed,size:r.displaySize},exceeded:r.quotaExceeded,remaining:r.quotaRemaining,status:r.quotaStatus,total:r.quotaTotal}),de.ghostId=r.ghostId,r.thumbnailSet){L.thumbnail=this._thumbnailProcessor.processThumbnailSet(r.thumbnailSet,r);var le=this._thumbnailProcessor.getProcessFiltersUrl(r.thumbnailSet,r);le&&(L.processFilters={thumbnailUrl:le})}var ue=r.folder;if(ue){var fe=[];L.folder={childCount:ue.childCount,documentCount:ue.documentCount,folderCount:ue.folderCount,photoCount:ue.photoCount,totalCount:ue.totalCount,covers:fe};var pe=ue.covers;if(pe)for(var me=0,_e=pe;me<_e.length;me++){var he=_e[me],be=this._thumbnailProcessor.processThumbnailSet(he,r);be&&fe.push(be)}}var ge,ve=r.photo;ve&&(ge={width:ve.width,height:ve.height,cameraMake:ve.cameraMake,cameraModel:ve.cameraModel,exposureNumerator:ve.exposureNumerator,exposureDenominator:ve.exposureDenominator,focalLength:ve.focalLength,focalRatio:ve.focalRatio,iso:ve.iso,originalUrl:r.urls[h.e[h.e.open]],displayDateTaken:ve.displayDateTaken,dateTaken:ve.dateTaken,quality:j.e.optional(ve.quality?{isBad:ve.quality.isBad}:void 0),isLivePhoto:j.e.optional(ve.isLivePhoto),isSamsungMotionPhoto:j.e.optional(ve.isSamsungMotionPhoto)}),L.photo=ge,(null==ve?void 0:ve.isLivePhoto)&&Object(U.isFeatureEnabled)(U.EnableLivePhotoVideos)?L.video=Object(i.__assign)(Object(i.__assign)({},function(e){return{width:e.width,height:e.height,fourCC:"H264",burstPhotoType:a.AppleLivePhoto}}(ve)),r.video):(null==ve?void 0:ve.isSamsungMotionPhoto)&&Object(U.isFeatureEnabled)(U.EnableSamsungMotionPhotoVideos)?L.video=Object(i.__assign)(Object(i.__assign)({},function(e){return{width:e.width,height:e.height,fourCC:"H264",burstPhotoType:a.SamsungMotionPhoto}}(ve)),r.video):L.video=r.video,L.audio=r.audio,L.panorama=r.panorama,L.geoLocation=r.location;var ye=r.textEditorMimeType;L.textEditorMimeType=ye;var Se=!!r.isAlbum;L.isAlbum=Se;var De,Ie=r.photo||r.video,xe=q(r.dateModifiedOnClient),Ce=q(r.creationDate),Oe=q(r.lastAccess),we=q(r.dateShared),Ee=q(r.dateDeleted),Ae=q(r.dateExpires),Le=Ie&&q(Ie.dateTaken),ke=r.displayModifiedDate,Me=r.displayCreationDate,Pe=r.displayLastAccess,Te=r.displayDateShared,Ue=r.displayDateDeleted,Fe=r.displayExpiryDate;try{xe&&(ke=Object(R.t)(xe)),Ce&&(Me=Object(R.r)(Ce)),Oe&&(Pe=Object(R.r)(Oe)),we&&(Te=Object(R.r)(we)),Ee&&(Ue=Object(R.r)(Ee)),Ae&&(Fe=Object(R.r)(Ae)),Le&&(De=Object(R.t)(Le,!1,!1,!0))}catch(e){}L.dateModifiedValue=r.dateModifiedOnClient,L.dateModifiedTime=L.vault&&L.vault.root?"":xe,L.dateCreatedTime=Ce,L.dateAccessedTime=Oe,L.dateSharedTime=we,L.dateDeletedTime=Ee,L.dateExpiresTime=Ae,L.dateModified=L.vault&&L.vault.root?L.vault.isLocked?" ":"Unlocked":ke,L.dateCreated=Me,L.dateAccessed=Pe,L.dateShared=Te,L.dateDeleted=Ue,L.dateExpires=Fe,Ie&&(L.dateTakenTime=j.e.optional(Le),L.dateTaken=j.e.optional(De)),L.itemFromServer=r,L.lifeCycleStatus=j.e.optional(this._getItemLifeCycleStatus(L));var He={},Re={};if(r.isAlbumRoot&&(Re.dl=!0,Re.sh=!0,Re.rn=!0),(null==ve?void 0:ve.isLivePhoto)&&Object(U.isFeatureEnabled)(U.EnableLivePhotoVideos)&&(Re.aol=!0,Re.rot=!0,Re.vo=!0,He.acp="1"),(ve||r.video)&&(He.ata="1"),ve&&!function(e){return z.some(function(t){return e.toLowerCase()===t})}(L.extension)&&(Re.rot=!0),r.commands)for(var Ne=r.commands.split(","),Be=0;Be<Ne.length;Be+=2)Ne[Be]in Re||(He[Ne[Be]]=Ne[Be+1]);else"root"===L.id&&Object(D.e)(x)&&(He.defc="1");r.audio&&(delete He.pl,He.defc="1");var je,Ve,ze,Ge=!!He.orr;if(L.isViolation=Ge,L.queryType=x,L.displayType=!ue||1!==ue.category||x===S.e.Files&&$?x:S.e.Photos,L.queryType===S.e.Recent&&$&&(He.defc="1"),ae===m.e.Folder&&!L.isStub)switch(se){case f.e.Owner:case f.e.CoOwner:case f.e.Edit:ze=L.queryType===S.e.Files||L.queryType===S.e.SharedWithMe&&!$;break;default:ze=!1}if(L.sharingRole=se,L.isDropEnabled=ze,L.iconName=w.n({type:ae,extension:ie,sharingType:oe,textEditorMimeType:ye}),L.iconName=this._isFluidFile(r)?"fluid":L.iconName,L.documentFormat=r.docFormat||0,W===p.e.AlbumRoot&&(ee=b.e),P&&(te=E.e.isRightToLeft?P.slice(0).reverse().join(" < "):P.join(" > ")),u||(L.isPlaceholder=!1),L.isDraggable=L.queryType===S.e.Files&&!L.mountPoint,ue){L.childCount=r.estimatedResultCount||ue.totalCount,L.category=ue.category,je=[],ue.itemGroupings&&(Ve=ue.itemGroupings.map(function(e){var n=e.itemGroups,a=Object(i.__rest)(e,["itemGroups"]);return Object(i.__assign)(Object(i.__assign)({},a),{itemGroups:n.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{state:t.observables.create({isCollapsed:!1})})})})}));var Ke={};if(ue.children&&!c)for(var We=0,qe=ue.children;We<qe.length;We++){var Qe=qe[We],Ye=this.processItemResult({observer:_,requestKey:n,itemFromServer:Qe,queryType:x,requestMetadata:o,skipSettingChildren:!1,isPrimaryRequestedItem:!1}).item;je.push(Ye),Ke[Ye.key]={newTag:this.getNewTagIfExists(Qe),autoAlbumTag:this.getAutoAlbumTagIfExists(Qe)}}if(W===p.e.AlbumRoot){for(var Je={groupingId:"newAutoAlbums",count:0,state:this.observables.create({isCollapsed:!0})},Xe=[],Ze=0,$e=[],et=Math.max(3,10-je.length),tt=0,nt=je;tt<nt.length;tt++){var at=nt[tt],it=Ke[at.key];it&&it.newTag&&it.autoAlbumTag&&++Ze>et?(Xe.push(at),Je.count++):$e.push(at)}Je.startIndex=$e.length,je=$e.concat(Xe);var rt={name:"newAutoAlbumsGrouping",itemGroups:[Je]};Ve.push(rt)}}else r.name&&this._isFluidFile(r)?L.openUrl=this._generateOpenUrlForFluidFile(r.name,V,N):r.urls&&(r.urls.oneNoteWeb?L.openUrl=r.urls.oneNoteWeb:L.openUrl=r.urls.viewInBrowser);var ot=ie&&ie.toLowerCase(),st=ot&&ot.slice(1);(".pdf"===ot||".ai"===ot&&He.dl)&&(He.defc="1",L.openUrl=this._urlDataSource.getDownloadItemUrl({key:A,id:N,ownerId:F,extension:ie},FilesConfig.canary,!0),Object(U.isFeatureEnabled)(U.UseWebPdfViewer)&&(ae=m.e.Media));var ct,dt,lt="".concat(I.e.getVroomBaseUrl({apiVersion:"v1.0",driveId:V}),"/drives/").concat(V,"/items/").concat(N);!Object(U.isFeatureEnabled)(U.EnableZipFilePreviewing)||".zip"!==ot&&".rar"!==ot||(He.defc="1",ae=m.e.Media,L.zip=j.e.optional((ct=st,(dt=lt)?{downloadZipContentsUrl:K("zipcontent",ct,dt),zipMetaDataUrl:K("zipmetadata",ct,dt)}:void 0)));var ut=function(e,t){var n=G.e(e),a=G.t(e);if(n||a)return{canConvert:n,canRenderNative:a,conversionUrl:n&&t?"".concat(K("glb",e,t),"&{.authParams}"):void 0}}(st,lt);ut&&(ae=m.e.Media,L.model3d=ut,He.defc="1"),L.type=ae,L.thumbnail&&"4"===He.defc&&(He.defc="1"),!l&&r.isPlaceholder&&(He.defc="1"),"allmyphotos"===g.qt&&L.id===g.id&&(He.defc="1",ee="");var ft=ue?ue.childCount:0;L.name=ee,L.displayName=te||"".concat(ee).concat(ie),r.estimatedResultCount&&(ft=je.length+(r.folder&&r.folder.startIndex||0)),r.isRecycled&&r.folder&&!ft&&(ft=je.length,L.childCount=ft),de.newTag=this.getNewTagIfExists({tags:re}),de.autoAlbumTag=this.getAutoAlbumTagIfExists({isAlbum:Se,tags:re});var pt=[A];s&&n&&pt.push(n),e.keyAlias&&pt.push(e.keyAlias);var mt=!0;"allmyphotos"===g.qt&&L.id===g.id&&(mt=!1),de.commandsSupported=j.e.replace(He),L.properties=de;for(var _t=0,ht=Object(B.e)(pt);_t<ht.length;_t++){var bt=ht[_t];_.update([new j.t(bt).succeed({item:mt?L:{key:A}})])}var gt=r.hasMoreResults?""+r.estimatedResultCount:"";return"search"===g.qt&&r.folder&&r.folder.pagingToken&&(gt=r.folder.pagingToken),r.isRecycled&&r.folder&&r.folder.hasMoreRecycledItems&&(gt=r.folder.pagingToken),{item:{key:A},children:je,groupings:Ve,totalChildren:ft,nextRequestToken:gt}}},t.prototype.getAutoAlbumTagIfExists=function(e){var t=null;if(!e.isAlbum)return t;var n=e.tags;if(n)for(var a=0,i=n;a<i.length;a++){var r=i[a];if(r.tag===N.e){t=r;break}}return t},t.prototype.getNewTagIfExists=function(e){var t=e.tags,n=null;if(t)for(var a=0,i=t;a<i.length;a++){var r=i[a];if(r.tag===N.t){n=r;break}}return n},t.prototype.getItemKey=function(e){var t,n,a,r,o,s=e.itemFromServer,c=e.requestKey,d=this._urlDataSource.getKeyParams(c);if(s.isAlbumRoot)o=this._urlDataSource.getKey(((t={}).id="albums",t.tagFilter=d.tagFilter,t));else if(s.isTagsRoot)o=this._urlDataSource.getKey(((n={}).id="tags",n));else{var l=this._getItemKeyExtension(s,c),u=s.ownerCid,f=s.internalPath,p=void 0===f?[]:f,m=this._getNormalizedId(s),_=this._urlDataSource.isCurrentQuery(S.e.SharedWithMe,d);_&&s.ownerDCid===X&&s.ownerCid===Z&&(m=X,u=Z),o=this._urlDataSource.getKey(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},l),((a={}).id=m,a.cid=u,a.internalPath=p.join(","),a)),Object(U.isFeatureEnabled)(U.AttachGroupIdToSharedByKey)&&_&&s.groupId?((r={}).u="group_".concat(s.groupId),r):{}))}return o},t.prototype._generateOpenUrlForFluidFile=function(e,t,n){var a=Object(U.isFeatureEnabled)(U.UseFluidDevPreview)?"https://dev.fluidpreview.office.net/p":"https://fluidpreview.office.net/p",i=encodeURIComponent(btoa("spo:https://api.onedrive.com")),r=encodeURIComponent(e),o=encodeURIComponent(t),s=encodeURIComponent(n);return"".concat(a,"/").concat(i,"/").concat(o,"/").concat(s,"/").concat(r)},t.prototype._getDefaultSubText=function(e,t,n){var a;switch(e){case f.e.Owner:a=t===_.e.Private?"":y.l;break;case f.e.View:a=y.t;break;case f.e.Edit:case f.e.CoOwner:a=y.e;break;default:a=""}return a},t.prototype._getItemType=function(e,t){return e.isPlaceholder?m.e.Folder:17===e.itemType?m.e.OneNote:e.folder?m.e.Folder:e.video||e.photo||e.audio?m.e.Media:t||this._isTextEditorFile(e)||this._isFluidFile(e)?m.e.File:e.thumbnailSet?m.e.Media:m.e.File},t.prototype._isFluidFile=function(e){return!!e.extension&&(".fluid"===e.extension.toLowerCase()||".loop"===e.extension.toLowerCase())},t.prototype._isTextEditorFile=function(e){return Object(V.t)(e.extension||"")},t.prototype._getItemKeyExtension=function(e,t){var n,a=this._urlDataSource.getKeyParams(t);return a.id===e.id?a:e.folder?((n={}).ft=a.ft,n.ext=a.ext,n):{}},t.prototype._getRootItemTitle=function(e){return c.e},t.prototype._getNormalizedId=function(e){return e.id&&e.id.indexOf("!")>=0?e.id.toUpperCase():e.id},t.prototype._getParentKey=function(e,t){var n,a,i=t.requestKeyParams;return e.isRecycled&&"root"!==e.id?a=this._urlDataSource.getRootItemKey(S.e.RecycleBin):e.isSharerFolder?a=this._urlDataSource.getRootItemKey(S.e.SharedWithMe):e.isAlbumRoot?a=void 0:e.parentId&&(a=this._urlDataSource.getKey(((n={}).id=e.parentId,n.cid=e.ownerCid,n.ft=i.ft,n.ext=i.ext,n))),a},t.prototype._getVirtualItemType=function(e){var t;return e.isAlbumRoot?t=p.e.AlbumRoot:e.isAlbum?t=p.e.Album:e.isTagsRoot&&(t=p.e.TagsRoot),t},t.prototype._getIsRootFolder=function(e,t){var n=t.isPhotosSubRoot;return("root"===e.id||e.isAlbumRoot)&&!n},t.prototype._isPhotosRoot=function(e,t){var n=t.requestKeyParams;return"allmyphotos"===n.qt&&e.id===n.id},t.prototype._isPhotosSubRoot=function(e,t){var n=t.requestKeyParams;return t.isPhotosRoot&&(!!n.tagFilter||!!n.locationFilter)},t.prototype._getItemLifeCycleStatus=function(e){var t={};return this._isItemLifeCycleStatusNew(e.dateCreatedTime)&&(t.isNew=!0),t},t.prototype._isItemLifeCycleStatusNew=function(e){var t=(new Date).getTime(),n=e&&e.valueOf();return!isNaN(n)&&t-n<1728e5},t}(r.n),ee=n(17),te=n(460),ne=n(30),ae=n(137),ie=n(235),re=n(12),oe=n(68);function se(e,t,n){var a;if(void 0===n&&(n={}),n){var r=function(e,t){var n,a=t.consume(oe.e).isMobile&&!!t.consume(re.y.optional),r=Object(i.__assign)(Object(i.__assign)({},de("type","","FileTypeIcon",!1)),{minWidth:a?48:16,width:a?48:16,isIcon:!0,fieldType:ae.e.FileIcon}),o=ue(!0),s=me(!0),c=fe(),l=le(!0),u=Object(i.__assign)(Object(i.__assign)({},de("_shareHeroCommand","","_shareHeroCommand",!1)),{isIcon:!0,minWidth:16,width:16,fieldType:ae.e.ShareCommand}),f=ue(!1),p=me(!1),m=le(!1),_=Object(i.__assign)(Object(i.__assign)({},de("dateTaken",ie.informationDateTaken,"dateTaken",!0)),{fieldType:ae.e.DateTime}),h=a?ce(r,[[o],[s,l,c]],Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([],"userArranged"===e?[pe()]:[],!0),[o,s],!1),"dateTaken"===e?[_]:[],!0),[l,c],!1)):Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([],"userArranged"===e?[pe()]:[],!0),[r,o],!1),[u],!1),[s],!1),"dateTaken"===e?[_]:[],!0),[c,l],!1),b=a?ce(r,[[o],[s,l,c]],[o,s,_,l,c]):Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)(Object(i.__spreadArray)([],"userArranged"===e?[pe()]:[],!0),[r,o],!1),[u],!1),[s,_,c,l],!1),g=Object(i.__assign)(Object(i.__assign)({},de("dateAccessed",d.n,"dateAccessed",!0)),{fieldType:ae.e.DateTime}),v=Object(i.__assign)(Object(i.__assign)({},de("location",d.a,"",!1)),{showTooltip:!0}),y=a?ce(r,[[o],[g,l,c]],[o,g,l,c]):[r,o,g,s,v,l],D=fe(),I=[r,o,D,l],x=[r,o,D,l],C=a?ce(r,[[f],[p,m,c]],[f,p,m,c]):[r,f,c,p,v,m],O=Object(i.__assign)(Object(i.__assign)({},de("location",d.o,"location",!0)),{width:300,showTooltip:!0}),w=Object(i.__assign)(Object(i.__assign)({},de("dateDeleted",d.t,"dateDeleted",!0)),{fieldType:ae.e.DateTime}),E=a?ce(r,[[o],[l,w,O]],[o,w,l,O]):[r,o,O,w,l];return(n={})[S.e.Files]=h,n[S.e.Photos]=b,n[S.e.Recent]=y,n[S.e.SharedWithMe]=I,n[S.e.DocsInCommon]=x,n[S.e.Search]=C,n[S.e.RecycleBin]=E,n}(n.defaultSortField,t);e.type===m.e.Folder&&(a=r[e.displayType]||r[S.e.Files]),a&&(a=a.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),n.isSortEnabled?(e.internalName||e.key)===n.sortField?{isSorted:!0,isAscending:n.isAscending}:{isSorted:!1}:{sortable:!1})}))}return a}function ce(e,t,n){for(var a=[],r=0;r<t.length;r++)for(var o=0,s=t[r];o<s.length;o++){var c=s[o];a.push(Object(i.__assign)(Object(i.__assign)({},c),{customRowNumber:r}))}for(var d=[e,Object(i.__assign)(Object(i.__assign)({},de("","","",!1)),{width:900,customFields:a})],l=0,u=n;l<u.length;l++){var f=u[l];d.push(Object(i.__assign)(Object(i.__assign)({},f),{isVisible:!1,isVisibleMobile:!1}))}return d}function de(e,t,n,a,i){return{key:e,name:t,internalName:n,minWidth:90,width:130,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:a,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:ae.e.Text,filterable:!1,isFocused:ee.observable(!1)}}function le(e){return Object(i.__assign)(Object(i.__assign)({},de("size",d.c,"size",e)),{isHtml:!0,fieldType:ae.e.FileSize,sortable:e})}function ue(e){return Object(i.__assign)(Object(i.__assign)({},de("displayName",d.r,"displayName",e)),{isCollapsable:!1,minWidth:220,width:440,fieldType:ae.e.Name,sortable:e,hasListItemMenu:!0})}function fe(){return Object(i.__assign)(Object(i.__assign)({},de("defaultSubText",d.s,"",!1)),{fieldType:ae.e.Shared})}function pe(){return Object(i.__assign)(Object(i.__assign)({},de("",d.d,"userArranged",!0)),{isVisible:!1,isVisibleMobile:!1})}function me(e){var t=d.i;return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},de("dateModified",t,"dateModified",e)),{sortable:e,sortDescFirst:e,fieldType:ae.e.DateTime}),"ml"==="".concat(E.e.language).toLowerCase()?{width:150}:{})}var _e=n(135),he=n(182),be=n(198),ge=n(67),ve=function(e){function t(t){return e.call(this,t)||this}return Object(i.__extends)(t,e),t.prototype.processError=function(e){var t,n=e.requestKey,a=e.error,i=e.itemName,r=e.observer;switch(a&&a.data&&a.data.code||0){case 101:case 102:case 103:case 152:t=ge.e.authenticationExpired;break;case 161:t=ge.e.mfaRequired;break;case 162:t=ge.e.insufficientVaultQuota;break;case 200:t=ge.e.userSuspended;break;case 201:t=ge.e.userNotReady;break;case 202:t=ge.e.marketBlocked;break;case 3e3:case 10009:t=ge.e.accessDenied;break;case 3403:t=ge.e.passwordRequired;break;case 3404:t=ge.e.requestAccess;break;case 9017:break;default:t=ge.e.requestFailed}var o=this.getError(a,i);return r.update([new j.t(n).succeed({item:{key:n,type:m.e.Error,error:{type:t,data:o},isPlaceholder:!1,properties:{commandsSupported:{defc:"1"}}}})]),{error:o,key:n}},t.prototype.getError=function(e,t){var n,a,i,r=e&&e.data&&e.data.code||0;switch(r){case 209:n=y.m,a=y.p;break;case 509:n=y.f;break;case 1e3:n=y.i;break;case 1006:n=y.r;break;case 2005:case 2006:n=y.d;break;case 3e3:n=y.c,a=y.s;break;case 9001:n=Object(C.s)(y.o,t);break;case 9006:n=y.u;break;default:n=y.a,a=y.n}return 161===r&&(i=e&&e.data&&e.data.exceptionData&&e.data.exceptionData.fixItUrl||null,this.resources.consumeAsync(H.B).then(function(e){return e.setVaultLockState({root:void 0,isLocked:!0},void 0,!0)})),{errorCode:r,errorTitle:n,errorDetailedText:a,actionUrl:i}},t}(r.n),ye=n(407),Se=n(267),De=function(){function e(){this._urlDataSource=this.resources.consume(H.H)}return e.prototype.getDefaultGetItemContext=function(e){var t=this._urlDataSource.getCurrentItemKey(e),n=this._urlDataSource.getKeyParams(t),a=this._urlDataSource.getOwnerId(t,e),i=this._urlDataSource.getQueryType(n);return{groupingType:this._getGroupingType(a),isAscending:void 0,pageSize:this._getPageSize(i),ownerId:a,parentKey:t,queryType:i,resultSetOptions:void 0,revision:0,sortField:void 0,startIndex:0,startKey:void 0}},e.prototype._getPageSize=function(e){return e===S.e.Search?50:100},e.prototype._getGroupingType=function(e){var t=this._getLocalStorageValue("".concat("ItemsStoreonedrive.web.files.filesquerytype",".").concat(e.toLowerCase())),n=JSON.parse(t||"{}");return t&&n[S.e[S.e.Files]]!==Se.e?0:1},e.prototype._getLocalStorageValue=function(e){try{return window.localStorage[e]}catch(e){return""}},e}(),Ie=n(187),xe=n(36),Ce=n(46),Oe=n(200),we=n(110),Ee=function(){function e(){this._urlDataSource=this.resources.consume(F.n),this._navigation=this.resources.consume(xe.e)}return e.prototype.getFetchUrl=function(e,t,n){var a="".concat(e.sortField?be.e[e.sortField]:be.e.defaultValue),i=null===e.isAscending||void 0===e.isAscending?he.e.defaultValue.toString():e.isAscending?he.e.ascending.toString():he.e.descending.toString(),r=this._urlDataSource.getKeyParams(e.parentKey),o=this._urlDataSource.getQueryType(r);Object(D.e)(o)&&(e.groupingType=0);var s=1===e.groupingType?"0,1,2":"0",c={caller:I.e.viewerId,sb:n?"":a,ps:e.pageSize,sd:i,gb:s,d:"1",m:Ce.e.mkt,iabch:"1",pi:"5",path:1,lct:1,rset:I.e.scenarioName,v:t};(n||Object(U.isFeatureEnabled)(U.UsePagingTokenForSearch)&&o===S.e.Search)&&(c.pagingToken=e.requestToken||""),we.get("BadgerAuth")||(c.urlType=0),e.startKey?c.sid=this._urlDataSource.getKeyParams(e.startKey).id:void 0!==e.startIndex&&(c.si=e.startIndex);var d=this._urlDataSource.getAuthKeyParamValue(),l=this._urlDataSource.getTicketParamValue(),u=this._urlDataSource.getReferrer();d&&(c.authKey=d),l&&(c.ticket=l),Object(D.e)(o)&&u&&(c.searchreferrer=u),e.filters&&(e.filters.tagFilter&&(c.tagFilter=e.filters.tagFilter),e.filters.locationFilter&&(c.tagFilter=e.filters.locationFilter));var f=e.parentKey||"",p=this._urlDataSource.getKeyParams(f);return delete p.u,o===S.e.Recent&&delete p.ext,Object(D.e)(o)&&!p.sp&&(c.includeSharedItems=1),p.sp&&(c.searchpassthru="sortby=largestsize",delete p.sp),n&&o===S.e.RecycleBin&&(p.qt="recyclebinv2"),5!==this._urlDataSource.getAppliedDateFilter()&&delete p.endDate,I.e.skyApiBaseUrl+"GetItems?"+L.n(p,c)},e.prototype.triggerGetItemsIfApplicable=function(e,t){var n=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams),a=this._urlDataSource.getKeyParams(n);if(this._urlDataSource.getQueryType(a)===S.e.Files&&!this._navigation.viewParams.v){var i=new u.e,r=new(this.resources.injected(De)),o={};o["X-SkyApiOriginId"]=t;var s=r.getDefaultGetItemContext(this._navigation.viewParams);s.skipCache=!0;var c=this.getRequestVersion(s),d=this.getFetchUrl(s,c,!1);Ie.e.mark("Prefetch.GetItems.Started"),e[d]=i.send({apiName:"GetItems",url:d,headers:o,isErrorExpectedCallback:Oe.e}).then(function(e){return Ie.e.mark("Prefetch.GetItems.Done"),e}),this.persistResultVersion(s,c)}},e.prototype.getRequestVersion=function(e){var t=Ae(e.ownerId),n=t?JSON.parse(this._getLocalStorageValue(t)||"{}"):{},a=String(Math.random()),i=this._urlDataSource.getKeyParams(e.parentKey),r=this._urlDataSource.getQueryType(i);return e.skipCache||r===S.e.RecycleBin?a:n[e.parentKey&&e.parentKey.toLowerCase()]||a},e.prototype.persistResultVersion=function(e,t){if(e.ownerId){var n=Ae(e.ownerId),a=JSON.parse(this._getLocalStorageValue(n)||"{}");a[e.parentKey.toLowerCase()]=t,this._persistResultVersion(n,JSON.stringify(a))}},e.prototype.removeBrowserCacheResultVersion=function(e,t){if(e){var n=Ae(e),a=JSON.parse(this._getLocalStorageValue(n)||"{}");delete a[t.toLowerCase()],this._persistResultVersion(n,JSON.stringify(a))}},e.prototype._persistResultVersion=function(e,t){try{window.localStorage[e]=t}catch(e){}},e.prototype._getLocalStorageValue=function(e){try{return window.localStorage[e]}catch(e){return""}},e}();function Ae(e){return e&&"OneDrive.GetItemsVersionLookup.".concat(e.toLowerCase())}var Le={},ke=String(Math.random()),Me=n(353);function Pe(e){return{items:e.items.map(function(e){return e.id}),targetId:e.targetId,cid:e.cid,group:e.group,nameConflict:e.nameConflict,deleteSource:e.deleteSource,overrideLock:e.overrideLock}}!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(i.__extends)(t,e),t.prototype.getCapabilities=function(){return this.resources.consume(Me.e)},t.prototype.copyItemsAsync=function(e){return this._handleMoveCopyAsyncApiRequest(e,this._getCopyItemsAsyncUrl())},t.prototype.hasMatchingId=function(e,t){return e===t.id},t.prototype._handleMoveCopyAsyncApiRequest=function(e,t){var n=new u.e,a=Pe(e);return n.send({apiName:"CopyItemsAsync",url:t,requestType:"POST",postData:JSON.stringify(a),isErrorExpectedCallback:function(e){return 2001===e.errorCode}})},t.prototype._getCopyItemsAsyncUrl=function(){return I.e.skyApiBaseUrl+"CopyItemsAsync"}}(r.n);var Te=n(294),Ue=n(123),Fe=n(490),He=n(406),Re=n(42),Ne=n(400),Be=n(191),je=n(38),Ve=n(33),ze=n(15),Ge=0,Ke=function(e){function t(){var t=e.call(this)||this;return t._itemDataSourceHelper=new(t.managed(Ee)),t.isLargeRecycleBin=ee.observable(!1),t._pendingGetItemRequests={},t._itemsStore=t.resources.consume(_e.e),t._urlDataSource=t.resources.consume(F.n),t._identity=t.resources.consume(H.p),t._itemResultProcessor=new(t.managed($))({getRootItemTitle:t.getRootItemTitle.bind(t),getItemKeyExtension:t._getItemKeyExtension.bind(t)}),t._itemErrorProcessor=new(t.managed(ve)),t._rotationSemaphore=new Te.e,t}return Object(i.__extends)(t,e),t.getServerDocumentType=function(e){var t;switch(e){case ne.e.Word:t="w";break;case ne.e.Excel:t="x";break;case ne.e.PowerPoint:t="p";break;case ne.e.OneNote:t="n";break;case ne.e.ExcelSurvey:t="f"}return t},t.prototype.getItem=function(e){var t=this._itemDataSourceHelper.getRequestVersion(e),n=this._itemDataSourceHelper.getFetchUrl(e,t,this.isLargeRecycleBin.peek());return this._getItem(n,t,e)},t.prototype.getSpecifiedItems=function(e){return null},t.prototype.getColumns=function(e,t){return void 0===t&&(t=this._getDefaultSortInformation(e.itemFromServer)),se(e,this.resources,t)},t.prototype.deleteItems=function(e){var t=this,a=this._urlDataSource.getKeyParams(e.parentKey);if(Object(je.e)(Re.s)&&Object(U.isFeatureEnabled)(U.UpdateOdcPhotoApiForConvergence)&&("allmyphotos"===a.qt||["places".toString(),"tags".toString()].indexOf(a.id)>=0)){var i=this.resources.consume(Ne.e);return new o.n(function(t,a){n.ee([146],1772).then(function(t){var n=t.deleteItems;return i.dispatch(n({items:Object(Be.e)(e.items,function(e){return{currentItemSetKey:e.graph.itemId}},function(e){return He.e.serialize({endpoint:Object(Re.t)("v2.0"),driveId:e.graph.driveId,itemId:e.graph.itemId})})}))}).then(function(){t(e.items.map(function(e){return e.graph.itemId}))}).catch(function(e){a(e)})})}var r=e.items;return r&&r[0].key&&!r[0].id&&(r=r.map(function(e){return t._itemsStore.getItem(e.key).peek()})),l.e.start({apiName:"DeleteItems",url:this._getDeleteItemsUrl(),batchSize:100,items:r,getPostData:function(t){return{deletionType:e.deletionType?e.deletionType:te.e.Recycle,targetId:a.id,cid:I.e.viewerId,group:0,overrideLock:!!e.overrideLock,items:t.map(function(e){return e.id})}},isErrorExpectedCallback:function(e){switch(e.errorCode){case 3e3:case 9001:return!0;default:return!1}},onBatchComplete:function(e){for(var t=0,n=e;t<n.length;t++)n[t].eTag=""}})},t.prototype.renameItem=function(e){var t=this,a=this._urlDataSource.getKeyParams(e.parentKey),i=e.item.name,r=e.newName+e.item.extension,s=e.item.extension;if(e.nameHasExtension){var c=e.newName.lastIndexOf(".");c>0&&(s=e.newName.substr(c+1),Array.isArray(Ce.t.createTextDocumentExts)&&Ce.t.createTextDocumentExts.indexOf(s)>=0&&(r=e.newName))}if(Object(je.e)(Re.s)&&Object(U.isFeatureEnabled)(U.UpdateOdcPhotoApiForConvergence)&&("allmyphotos"===a.qt||["places".toString(),"tags".toString()].indexOf(a.id)>=0)){var d=this.resources.consume(Ne.e),l=He.e.serialize({endpoint:Object(Re.t)("v2.0"),driveId:e.item.graph.driveId,itemId:e.item.graph.itemId});return new o.n(function(t,a){return n.ee([147],1773).then(function(t){var n,a,i=t.renameItem;return d.dispatch(i({items:(n={},n[l]={names:(a={},a[e.item.name]={newName:e.newName,newExtension:s},a)},n)}))}).then(function(){t(e.newName)}).catch(function(e){a(e)})})}var f=this._getUpdateItemsUrl(),p=new u.e,m=JSON.stringify({id:e.item.properties.ghostId||e.item.id,name:r,lid:a.id,rset:I.e.scenarioName,ownerId:e.ownerId});return p.send({apiName:"UpdateItem",url:f,requestType:"POST",postData:m,isErrorExpectedCallback:this._isErrorExpected}).then(function(n){if(t.resources.consume(Ue.t)){var a=e.item.id;e.item.isAlbum&&void 0!==a&&t.resources.consumeAsync(Fe.e).then(function(e){e.invalidateAlbumName(a)})}return n},function(e){return o.n.wrapError(t._itemErrorProcessor.getError(e,i).errorTitle)})},t.prototype.getOpenInClientDetails=function(e){var t=this._getOpenInClientDetailsUrl()+"?id="+e.id;return(new u.e).send({apiName:"GetOpenInClientDetails",url:t})},t.prototype.saveSortOrder=function(e){var t=this._getUpdateItemsUrl(),n=new u.e,a=JSON.stringify({id:e.item.id,sortOrder:e.sortOrder,sortDirection:e.sortDirection,cid:I.e.viewerId});return n.sendPost("UpdateItem",t,a)},t.prototype.reportAbuse=function(e){var t=this,n=this._getReportAbuseUrl(),a=new u.e,i=JSON.stringify({rao:e.rao,id:e.item.id,ownerName:e.item.ownerName,ownerCid:e.item.ownerId,itemName:e.item.name,urls:e.item.urls,cid:I.e.viewerId,group:0,desc:e.desc,ref:window.location.href,photoStreamId:e.photoStreamId,postId:e.postId,reportContentType:e.reportContentType||ye.n.File});return a.send({apiName:"ReportAbuse",url:n,requestType:"POST",postData:i,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return o.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})},t.prototype.requestReview=function(e){var t=this,n=this._getRequestReviewUrl(),a=window.$Config,i=new u.e,r=JSON.stringify({email:a.email,ids:e.items.map(function(e){return e.id}),photoStreamId:e.photoStreamId,postId:e.postId,reportContentType:e.reportContentType||ye.n.File});return i.send({apiName:"OwnerRequestReview",url:n,requestType:"POST",postData:r,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return o.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})},t.prototype.updateBundle=function(e){var t=this,n=this._getUpdateBundleUrl(),a=new u.e,i=JSON.stringify({bundleId:e.item.id,bundleAction:e.bundleAction,items:e.items});return a.send({apiName:"UpdateBundle",url:n,requestType:"POST",postData:i,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return o.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})},t.prototype.removeFromSharedList=function(e){var t=this._getRemoveFromSharedListUrl(),n=new u.e,a=JSON.stringify({items:e.items.map(function(e){return e.id}),markAsSpam:e.markAsSpam});return n.sendPost("AbdicatePermissions",t,a)},t.prototype.addCoverPhotos=function(e){var t=this._getAddCoverPhotoUrl(),n=new u.e,a=e.items.map(function(e){return e.id}),i=JSON.stringify({items:a,targetId:e.target.id,cid:I.e.viewerId,group:e.target.isGroup?1:0});return n.sendPost("AddFavorites",t,i)},t.prototype.removeCoverPhotos=function(e){var t=this._getRemoveCoverPhotoUrl(),n=new u.e,a=e.items.map(function(e){return e.id}),i=JSON.stringify({items:a,targetId:e.target.id,cid:I.e.viewerId,group:e.target.isGroup?1:0});return n.sendPost("RemoveFavorites",t,i)},t.prototype.changeFolderType=function(e){var t=this._getUpdateItemsUrl(),n=new u.e,a=JSON.stringify({id:e.item.id,category:e.category,cid:I.e.viewerId});return n.sendPost("UpdateItem",t,a)},t.prototype.updateItemProperty=function(e){var t,n,a=this._getUpdateItemsUrl(),i=new u.e;Object(U.isFeatureEnabled)(U.UseItemsScopeInOneDrive)&&(n=L.e(e.item.parentKey));var r={id:e.item.id,lid:(null===(t=e.item.UNSAFE_parent)||void 0===t?void 0:t.id)||(null==n?void 0:n.id),overrideLock:(!!e.overrideLock).toString(),rset:I.e.scenarioName};r[e.propertyName]=e.propertyValue||"";var o=e.qosPostfix?"UpdateItem_"+e.qosPostfix:"UpdateItem";return i.sendPost(o,a,JSON.stringify(r))},t.prototype.createFolder=function(e){var t=this,n=this._getCreateFolderUrl(),a=this._urlDataSource.getKeyParams(e.parent.key),i=new u.e,r=[];if(e.selectedPeople&&e.selectedPeople.length>0)for(var s=0,c=e.selectedPeople;s<c.length;s++){var d=c[s];r.push({role:2,type:0,email:d.email})}var l={ownerCid:this._identity.getIdentity().id,message:e.sharingNote,requireSignIn:!0,entities:r},f=JSON.stringify({parentId:a.id,cid:a.cid,group:0,name:e.folderName,permissionsInfo:e.selectedPeople&&e.selectedPeople.length>0?l:null,doNotRollbackOnPartialPermissionsError:!0,sendShareNotification:!0});return i.send({apiName:"AddFolder",url:n,requestType:"POST",postData:f,isErrorExpectedCallback:this._isErrorExpected}).then(function(n){n=n.items||n.item;var a=new(t.resources.consume(j.a)),i=t._getItemResult({requestKey:e.parent.key,itemFromServer:n,queryType:S.e.Files,keyAlias:e.keyAlias,isPrimaryRequestedItem:!0,observer:a});return a.flush(),i?a.getItem({key:i.item.key}):null},function(e){return o.n.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})},t.prototype.createDocument=function(e,n,a){var i=this;if(n===ne.e.Text)return o.n.wrap(this._createTextDocument(e));var r=this._getCreateDocumentUrl(),s=t.getServerDocumentType(n),c=new u.e,d=this._urlDataSource.getKeyParams(e),l=JSON.stringify({parentId:d.id,nameConflict:a?0:2,overrideLock:!1,cid:d.cid,group:0,name:a,docType:s});return c.send({apiName:"CreateDocument",url:r,requestType:"POST",postData:l,isErrorExpectedCallback:this._isErrorExpected}).then(function(t){var a="";if((t=t.items||t.item)&&t.length>0){var r=new(i.resources.consume(j.a)),o=i._getItemResult({requestKey:e,itemFromServer:t[0],queryType:S.e.Files,isPrimaryRequestedItem:!0,observer:r});r.flush(),a=(a=r.getItem({key:o.item.key}).openUrl.replace("redir.aspx","edit.aspx")).replace("&page=view",""),n===ne.e.OneNote&&(a+="&nd=1")}return a},function(e){return o.n.wrapError(i._itemErrorProcessor.getError(e).errorTitle)})},t.prototype.createCustomDocument=function(e,t,n){return null},t.prototype.createShortcut=function(e,t,n){return null},t.prototype._createTextDocument=function(e){var t=this._urlDataSource.getKeyParams(e);return this.resources.consume(F.n).getCreateTextDocumentUrl(t.id,t.cid)},t.prototype.createDocumentInTab=function(e,n,a){var i=t.getServerDocumentType(e);return e===ne.e.Text?this._createTextDocument(n.key):this.resources.consume(F.n).getCreateDocumentInTabUrl(n,i,a)},t.prototype.getFilterData=function(e,t,n){return null},t.prototype.restoreItems=function(e){var t=this._urlDataSource.getKeyParams(e.parentKey);return l.e.start({apiName:"RestoreItems",url:this._getRestoreItemsUrl(),batchSize:100,items:e.items,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 2001:return!0;default:return!1}},getPostData:function(n){var a={targetId:t.id,cid:I.e.viewerId,group:0,items:n.map(function(e){return e.id}),recycleBinItems:n.map(function(e){return{deletedFromLocation:e.location===d.e?"":e.location,id:e.id,name:e.extension?e.name+e.extension:e.name}}),retainAcls:e.retainAcls||!1};return e.nameConflict&&(a.nameConflict=e.nameConflict),a}})},t.prototype.restoreAll=function(e){var t=this._getRestoreAllUrl(),n=new u.e;return new o.n(function(e,a){n.sendPost("RestoreAll",t,"").then(function(){e(!0)},a)})},t.prototype.copyItems=function(e){return this._handleMoveCopyApiRequest("CopyItems",e,this._getCopyItemsUrl())},t.prototype.moveItems=function(e){return this._handleMoveCopyApiRequest("MoveItems",e,this._getMoveItemsUrl())},t.prototype.removeFromRecent=function(e){for(var t,n=this._getRemoveFromRecentUrl(),a=new u.e,i=[],r=0;r<e.items.length;r++)i.push(e.items[r].id);return t=JSON.stringify({items:i}),a.sendPost("RemoveFromMRU",n,t)},t.prototype.removeMountPoint=function(e){var t,n=this._getRemoveMountPointUrl(),a=new u.e;return t=JSON.stringify({id:e.item.properties.ghostId||e.item.id}),a.sendPost("RemoveMountPoint",n,t)},t.prototype.createMountPoint=function(e){var t,n=this,a=this._getCreateMountPointUrl(),i=new u.e,r=this._urlDataSource.getAuthKeyParamValue();return t=JSON.stringify({isMountPoint:1,sourceResourceId:e.item.id,nameConflict:1,authKey:r}),i.sendPost("MountFolder",a,t).then(function(e){var t=new(n.resources.consume(j.a)),a=e?n._getItemResult({requestKey:"",itemFromServer:e.item,queryType:S.e.Files,isPrimaryRequestedItem:!0,observer:t}).item:null;return t.flush(),a?t.getItem({key:a.key}):null},function(e){return o.n.wrapError(e)})},t.prototype.getWorkProgress=function(e){var t=this._getWorkProgressUrl(e),n=new u.e;return(e.workItemIds?n.sendPost("GetWorkProgress",t,JSON.stringify({workItemIds:e.workItemIds})):n.send({apiName:"GetWorkProgress",url:t})).then(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{progress:e.progress.map(function(e){var t,n,a;if("Completed"===e.status){var r=e.targetResourceId;if(r){var o=Object(Ve.t)(((t={}).id=r,t));a={key:Object(ze._)(((n={}).cid=o,n.id=r,n))}}}return Object(i.__assign)(Object(i.__assign)({},e),{createdItem:a})})})})},t.prototype.cancelWork=function(e){var t=this._getCancelWorkUrl();return(new u.e).sendPost("CancelWork",t,JSON.stringify(e)),o.n.wrap(!0)},t.prototype.getItemOcrTextContent=function(e){var t=new u.e,n=JSON.stringify({ids:[e.id],streamName:"TextContent"});return t.sendPost("Download",I.e.skyApiBaseUrl+"GetDownloadUrl",n).then(function(e){var t=e.DownloadUrl||e.items&&e.items[0]&&e.items[0].downloadUrl;return s.e.start({url:t,json:null}).then(function(e){var t=window.DOMParser,n=(t&&(new t).parseFromString(e.responseText,"text/xml")).querySelector("c");return n&&n.textContent})})},t.prototype.updateItemOcrInfo=function(e,t,n){var a,i=this._getUpdateItemsUrl(),r=new u.e,o=JSON.stringify({eTag:e.eTag,id:e.id,textContent:t||"",entityTags:n,lid:null===(a=e.UNSAFE_parent)||void 0===a?void 0:a.id,rset:I.e.scenarioName});return r.sendPost("UpdateItem",i,o)},t.prototype.processReferral=function(e,t){var n=this._getProcessReferralUrl(),a=new u.e,i={inviterId:e};return t&&""!==t&&(i.inviteSrc=t),a.sendPost("ProcessReferral",n,JSON.stringify(i))},t.prototype.rotateItems=function(e){for(var t=this,n=new(this.resources.consume(j.a)),a=this._getRotateItemUrl(),r=[],s=function(s){var d=c.peekUnwrapObservable(c._itemsStore.getItem(s.key)),l=++Ge;if(d.thumbnail){var f=d.orientedThumbnail;f=f?Object(i.__assign)(Object(i.__assign)({},f),{rotation:f.rotation+e.rotation,version:l}):{rotation:e.rotation,thumbnail:Object(i.__assign)({},d.thumbnail),version:l},n.update([new j.t(s.key).succeed({item:{key:s.key,orientedThumbnail:j.e.replace(f)}})])}var p=new u.e,m=JSON.stringify({targetId:s.id,numberOfClockwiseRotations:-e.rotation,cid:I.e.viewerId,rset:I.e.scenarioName});r.push(c._rotationSemaphore.enqueue(function(){return p.sendPost("ChangeImageOrientation",a,m).then(function(e){var a=t.peekUnwrapObservable(t._itemsStore.getItem(s.key)),i=a.itemFromServer&&a.itemFromServer.commands;e.item.commands=i||e.item.commands,t._itemResultProcessor.processItemResult({observer:n,itemFromServer:e.item,isPrimaryRequestedItem:!0,skipSettingChildren:!0,requestKey:s.key});var r=a.orientedThumbnail;return r&&r.version===l&&n.update([new j.t(s.key).succeed({item:{key:s.key,orientedThumbnail:j.e.remove()}})]),a},function(a){var i=t.peekUnwrapObservable(t._itemsStore.getItem(s.key)).orientedThumbnail;i&&(i=i.version===l?j.e.remove():{rotation:i.rotation-e.rotation},n.update([new j.t(s.key).succeed({item:{key:s.key,orientedThumbnail:i}})]));var r=new Error(a.data.message);return r.data={key:s.key,error:a.data},o.n.wrapError(r)})}))},c=this,d=0,l=e.items;d<l.length;d++)s(l[d]);return n.flush(),o.n.all(r).then(function(e){if(n.flush(),t.resources.consume(Ue.t))for(var a=function(e){var n=L.e(e.key);t.resources.consumeAsync(H.h).then(function(e){e.invalidateItems(L.n(n))})},i=0,r=e;i<r.length;i++)a(r[i]);return e.map(function(e){var n=t.peekUnwrapObservable(t._itemsStore.getItem(e.key));return n&&n.UNSAFE_parent&&t._itemDataSourceHelper.removeBrowserCacheResultVersion(n.ownerId,n.UNSAFE_parent.key),n})},function(e){n.flush();var t=new Error;return t.data=Object.keys(e).map(function(t){return e[t].data}),o.n.wrapError(t)})},t.prototype.redeemPermissionToken=function(e){var t=this._urlDataSource.getAuthKeyParamValue(),n=this._getRedeemPermissionTokenUrl(),a=new u.e,i={id:e.item.id,authKey:t};return a.sendPost("RedeemPermissionToken",n,JSON.stringify(i))},t.prototype.updateViewCount=function(e){var t=e.items.filter(function(e){return e.ownerId!==I.e.viewerId});return 0===t.length?o.n.wrap(null):l.e.start({apiName:"UpdateViewCount",url:this._getUpdateViewCountUrl(),batchSize:100,items:t,getPostData:function(e){return{cid:I.e.viewerId,ids:e.map(function(e){return e.id})}}})},t.prototype.getRootItemTitle=function(e){return c.e},t.prototype._getRootFileId=function(){return"root"},t.prototype._getParentItemId=function(){return""},t.prototype._getItemKeyExtension=function(e,t){var n,a=this._urlDataSource.getKeyParams(t);return a.id===e.id?a:e.folder?((n={}).ft=a.ft,n.ext=a.ext,n):{}},t.prototype._handleMoveCopyApiRequest=function(e,t,n){for(var a,r=new u.e,s=t.items.map(function(e){return e.id}),c=Pe(t),d=[],l=new Te.e,f=function(){var o=s.splice(0,100);c.items=o;var u=JSON.stringify(c);!1!==t.ackMoveIfShared&&(a={prefer:"Block-Move-Into-Vault-If-Shared"});var f=l.enqueue(function(){return r.send({apiName:e,url:n,requestType:"POST",headers:a,postData:u,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 1007:case 1012:case 2028:case 2029:case 3e3:case 3e3:case 9001:return!0}}}).then(function(e){return e},function(e){return e.data&&e.data.items?e.data:{items:[Object(i.__assign)(Object(i.__assign)({},e),{error:e.data})]}})});d.push(f)};s.length;)f();return o.n.all(d).then(function(e){var t=e.map(function(e){return e.items});return{items:[].concat.apply([],t)}})},t.prototype._getItem=function(e,t,n){var a,r=this,s=String(Math.random()),c=((a={})["X-SkyApiOriginId"]=s,a),d=this._pendingGetItemRequests[e];if(!d){var l=Le[e];l&&(s=ke,delete Le[e]);var f=void 0;f=!x.e.isActivated("4AE305A7-991F-4556-87DE-C1DDF1D5F01A","10/21/2021","Override invalid SkyAPI root item request")&&this._isInvalidRootItemRequest(e)?this._getMockItemNotFoundResponse(e):!n.skipCache&&l||(new u.e).send({apiName:"GetItems",qosName:n.qosName,url:e,headers:c,isErrorExpectedCallback:Oe.e});var p=!1;d=f.then(function(a){p=!0,Ie.e.mark("ItemsDataSource.GetItems.Normalizing");var o,c=a.originId,d=a.items||a.item&&[a.item]||[];if(d&&d.length>0){for(var l=new(r.resources.consume(j.a)),u=void 0,f=d.length-1;f>=0;f--){var _=0===f;if(!d[0].isBundle||_){var h=f>0,b=r._getItemResult({observer:l,requestKey:n.parentKey,itemFromServer:d[f],queryType:n.queryType,requestMetadata:{tokenNeedsRedeeming:a.tokenNeedsRedeeming,tokenType:a.tokenType,restoreAllWorkItemCount:a.restoreAllWorkItemCount||0,deleteAllWorkItemCount:a.deleteAllWorkItemCount||0},setItemKey:!h,skipSettingChildren:h,isPrimaryRequestedItem:_});_&&(u=b)}}if(l.flush(),u&&u.item){var g=l.getItem({key:u.item.key}),v=d[0],y=r._getDefaultSortInformation(v);if(n.sortField){var S=y&&y.defaultSortField;y={sortField:n.sortField,defaultSortField:S,isAscending:n.isAscending,isSortEnabled:!r.isLargeRecycleBin.peek()}}var D=void 0;y&&(D=y.isAscending);var I=c!==s;I||g.type!==m.e.Folder||r._itemDataSourceHelper.persistResultVersion(n,t);var x=se(g,r.resources,y),C=void 0;if(x&&y)for(var O=0,w=x;O<w.length;O++){var E=w[O];if(E.internalName===y.sortField){C=E.key;break}}o=Object(i.__assign)(Object(i.__assign)({},u),{schema:x,startIndex:v.folder?v.folder.startIndex:n.startIndex,isFromBrowserCache:I,sortField:C,isAscending:D})}}return delete r._pendingGetItemRequests[e],o},function(t){delete r._pendingGetItemRequests[e];var a=new(r.resources.consume(j.a)),i=r._itemErrorProcessor.processError({requestKey:n.parentKey,error:t,observer:a}).error;return a.flush(),o.n.wrapError(i)}),p||(this._pendingGetItemRequests[e]=d)}return d},t.prototype._isErrorExpected=function(e){switch(e.errorCode){case 209:case 509:case 1e3:case 1006:case 2006:case 3e3:case 9001:case 9006:case 3403:return!0;default:return!1}},t.prototype._getDefaultSortInformation=function(e){var t;return e&&e.folder&&e.folder.defaultSort&&e.folder.defaultSortDirection&&Object.keys(be.e).length/2>e.folder.defaultSort&&(t={sortField:be.e[e.folder.defaultSort],defaultSortField:be.e[e.folder.defaultSort],isAscending:e.folder.defaultSortDirection.toString()===he.e.ascending.toString(),isSortEnabled:!0}),t},t.prototype._getItemResult=function(e){return this._itemResultProcessor.processItemResult(e)},t.prototype._getCreateDocumentUrl=function(){return I.e.skyApiBaseUrl+"CreateDocument"},t.prototype._getCreateFolderUrl=function(){return I.e.skyApiBaseUrl+"AddFolder?lct=1"},t.prototype._getDeleteItemsUrl=function(){return I.e.skyApiBaseUrl+"DeleteItems"},t.prototype._getUpdateViewCountUrl=function(){return I.e.skyApiBaseUrl+"UpdateViewCount"},t.prototype._getRestoreItemsUrl=function(){return I.e.skyApiBaseUrl+"RestoreItems"},t.prototype._getOpenInClientDetailsUrl=function(){return I.e.skyApiBaseUrl+"GetOpenInClientDetails"},t.prototype._getRequestReviewUrl=function(){return I.e.skyApiBaseUrl+"OwnerRequestReview"},t.prototype._getReportAbuseUrl=function(){return I.e.skyApiBaseUrl+"ReportAbuse"},t.prototype._getRemoveFromSharedListUrl=function(){return I.e.skyApiBaseUrl+"AbdicatePermissions"},t.prototype._getAddCoverPhotoUrl=function(){return I.e.skyApiBaseUrl+"AddFavorites"},t.prototype._getRemoveCoverPhotoUrl=function(){return I.e.skyApiBaseUrl+"RemoveFavorites"},t.prototype._getUpdateItemsUrl=function(){return I.e.skyApiBaseUrl+"UpdateItem?lct=1"},t.prototype._getUpdateBundleUrl=function(){return I.e.skyApiBaseUrl+"UpdateBundle"},t.prototype._getCopyItemsUrl=function(){return I.e.skyApiBaseUrl+"CopyItemsAsync"},t.prototype._getMoveItemsUrl=function(){return I.e.skyApiBaseUrl+"MoveItems"},t.prototype._getRemoveFromRecentUrl=function(){return I.e.skyApiBaseUrl+"RemoveFromMRU"},t.prototype._getRemoveMountPointUrl=function(){return I.e.skyApiBaseUrl+"RemoveMountPoint"},t.prototype._getCreateMountPointUrl=function(){return I.e.skyApiBaseUrl+"AddFolder"},t.prototype._getRestoreAllUrl=function(){return I.e.skyApiBaseUrl+"RestoreAll"},t.prototype._getWorkProgressUrl=function(e){return I.e.skyApiBaseUrl+"GetWorkProgress?type="+e.type},t.prototype._getRotateItemUrl=function(){return I.e.skyApiBaseUrl+"ChangeImageOrientation"},t.prototype._getCancelWorkUrl=function(){return I.e.skyApiBaseUrl+"CancelWork"},t.prototype._getProcessReferralUrl=function(){return I.e.skyApiBaseUrl+"ProcessReferral"},t.prototype._getRedeemPermissionTokenUrl=function(){return I.e.skyApiBaseUrl+"RedeemPermissionToken"},t.prototype._isInvalidRootItemRequest=function(e){var t=new URL(e);return"root"===t.searchParams.get("id")&&t.searchParams.has("caller")&&t.searchParams.has("cid")&&!I.e.areCidsEqual(t.searchParams.get("caller"),t.searchParams.get("cid"))},t.prototype._getMockItemNotFoundResponse=function(e){return o.n.reject({message:"Promise failed without error handler",url:e,status:500,data:{code:3e3,debugMessage:"Item not found or access denied.",isExpected:!0,message:"This item might have been deleted, expired, or you might not have permission to access it. Contact the owner of this item for more information.",stackTrace:""}})},t}(r.n);t.e=Ke},function(e,t,n){"use strict";n.d(t,"t",function(){return s.e});var a=n(0),i=n(7),r=n(36),o=(n(218),n(41)),s=n(343),c=n(536),d={cmmskgzokmj:"LeftNav",cmmbmfcmgdo:"LeftNav",cmmugdncaui:"LeftNav",cmmfqa4dpsq:"LeftNav",cmmfk8o8cot:"HeaderDiamond"},l=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._navigation=n.resources.consume(r.e),n}return Object(a.__extends)(t,e),t.prototype.appendPurchaseAttribution=function(e,t,n){var a=new o.t(t),i=this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"];(!i||i.indexOf("PROD_OneDrive")>-1)&&(i=n||this.getPurchaseAttribution(e));var r=a.getQueryParameter("ru");if(r){var s=new o.t(r);s.setQueryParameter("ocid",i),a.setQueryParameter("ru",s.toString())}return a.setQueryParameter("ocid",i),a.toString()},t.prototype.getPurchaseAttribution=function(e){return this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"]||Object(c.e)(e.source,e.cta)},t.prototype.getSourceFromIdeasAttribution=function(e){return function(e){return d["".concat(e)]}(e)},t}(i.n);t.e=l},,function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(17),r=function(e){function t(t){var n=e.call(this,t)||this;return n.memoryContent=i.observable(null),n.serverContent=i.observable(null),n.outDated=i.observable(!1),n.isEditable=i.observable(!1),n.hasConflict=n.createPureComputed(n._computeHasConflict),n.hasPendingSave=n.createPureComputed(n._computeHasPendingSave),n.hasChanges=n.createPureComputed(n._computeHasChanges),n._lastSaved=i.observable(null),n._pendingSave=i.observable(null),n}return Object(a.__extends)(t,e),t.prototype.startingSave=function(){this.hasPendingSave.peek()||this._pendingSave(this.memoryContent.peek().text)},t.prototype.saveFailed=function(){this.hasPendingSave.peek()&&this._pendingSave(null)},t.prototype.saveSucceded=function(){this.hasPendingSave.peek()&&(this.updateETag=!0,this._lastSaved(this._pendingSave.peek()),this._pendingSave(null))},t.prototype._computeHasPendingSave=function(){return!!this._pendingSave()},t.prototype._computeHasChanges=function(){var e=this.memoryContent();if(!e||"string"!=typeof e.text)return!1;var t=this._lastSaved();return null===t?(this._lastSaved(e.text),!1):e.text!==t},t.prototype._computeHasConflict=function(){return!!this.serverContent()},t}(n(7).n),o=n(223),s=n(66),c=function(){function e(e,t){this._itemContents={}}return e.prototype.getItemContent=function(e){var t=e.key,n=this._itemContents,a=n[t];return a||(a=new r,Object(o.e)(a,function(){delete n[t]}),n[t]=a),a},e.prototype.dispose=function(){this._itemContents={}},e}(),d=Object(s.r)("ItemContentProvider",c,{})},,,,,,function(e,t,n){"use strict";n.d(t,"n",function(){return s}),n.d(t,"t",function(){return c});var a=n(3),i=n(66),r=n(17),o=new a.t({name:"Share.key",loader:new i.t(function(){return n.ee([76,"ondemand.resx-ondemand"],668).then(function(e){return e.resourceKey.local})})});t.e=o;var s=new a.t({name:"share",factory:new a.e(r.observable())}),c=new a.t({name:"manageAccessShare",factory:new a.e(r.observable())});new a.t({name:"manageAccessAddPeople",factory:new a.e(r.observable())}),new a.t({name:"copy",factory:new a.e(r.observable([]))}),new a.t("sharingContextInformation")},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(3).t)("clientName")},,function(e,t,n){"use strict";var a;!function(e){e[e.normal=0]="normal",e[e.blocker=1]="blocker",e[e.vaultBlocker=2]="vaultBlocker"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"n",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a={ODB:!n(14).e.isActivated("96723D41-0476-4E60-A02D-199517143E81","11/10/2020","Allow ADAL as fallback for OAuth token requests")},i={ODB:1026},r={ODB:1977}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={unauthUser:"unauthUser"}},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n(3),i=n(489),r=n(377),o=n(358),s=new a.t({name:"".concat("isOfflineStateObservable.key",".isOfflineStateObservable"),factory:{dependencies:{offlineDetection:i.e},create:function(e){var t=new r.e,n=new o.e(e.offlineDetection.offline);return t.attach(e.offlineDetection.onChange(function(e){n.set(e)})),{instance:n,disposable:t}}}})},,function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(0),i=n(128),r=n(88),o=n(3),s=n(66),c=n(362),d=n(296),l="Engagement",u=new o.t({name:"".concat(l,".useEngagementSystem"),factory:new o.e(!0)}),f={engagementHandlers:d.e.optional},p=new o.t({name:"".concat(l,".engagementHelper"),loader:{load:function(){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,n.ee([144],671)];case 1:return e=t.sent().EngagementHelper,[2,{dependencies:f,create:function(t){var n=t.engagementHandlers;return{instance:new e({},{handlers:n})}}}]}})})}}}),m=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._isEnabled=n.isEnabled,a._getEngagementHelper=n.getEngagementHelper,a._getEngagementHandlers=n.getEngagementHandlers,a._isEnabled&&a._getEngagementHelper().catch(function(){}),a}return Object(a.__extends)(t,e),t.prototype.logData=function(e){var t=this;void 0===e&&(e={}),this._isEnabled?this._getEngagementHelper().then(function(n){n.fromSource({contexts:t.contexts}).logData(e)}).catch(function(){}):e.name&&r.e.logData(e)},t.prototype.clone=function(e){return new t({},{engagementSource:{contexts:e},isEnabled:this._isEnabled,getEngagementHelper:this._getEngagementHelper,getEngagementHandlers:this._getEngagementHandlers})},t.dependencies={engagementSource:c.n,isEnabled:u,getEngagementHelper:p.async.lazy,getEngagementHandlers:d.e.optional.async.lazy},t}(i.t),_=Object(s.r)(l,m)},,function(e,t,n){"use strict";var a=n(0),i=n(10),r=n(25),o=n(21),s=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.itemCommandHelper=new(n.managed(r.e)),n.selectionHelper=new(n.child(o.e))(Object(a.__assign)(Object(a.__assign)({},n.getSelectionOptions(t)),{overrideItem:t.item})),n}return Object(a.__extends)(t,e),t.prototype.getSelectionOptions=function(e){return void 0===e&&(e={}),{}},t}(i.e);t.e=s},,function(e,t,n){"use strict";var a=n(0),i=n(10),r=n(102),o=n(6),s=n(25),c=n(90),d=n(21),l=n(12),u=n(53),f=n(9),p=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInOfficeOnline";var a=t.openLocal,i=void 0!==a&&a,r=t.forceReadOnly,c=void 0!==r&&r,p=t.useDefaultAction,m=void 0!==p&&p;n._forceReadOnly=c,n._useDefaultAction=m,n._urlDataSource=n.resources.consume(o.H),n._viewParams=n.resources.consume(l.D),n._itemSelectionHelper=new(n.child(d.e))({overrideItem:t.item}),n._itemCommandHelper=n.resources.consume(s.t),n.item=n._itemSelectionHelper.firstItem,n._url=n.createPureComputed(n._computeUrl);var _=!1;f.e.isActivated("4DF83139-3BF3-4543-81F8-8AE4BF66F8B3","09/03/2018","Teams Open Office Online In-App")||(_=Object(u.n)());var h=n.resources.consume(l.e);return n._navigationAction=new(n.managed(h.NavigationAction))({url:n._url,target:i||_?void 0:"_blank",postProcessUrl:function(e){return n._postProcessUrl(e)}}),n}return Object(a.__extends)(t,e),t.prototype._postProcessUrl=function(e){return e},t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._itemCommandHelper.isCommandSupported(e,c.s)&&this._navigationAction.isAvailable()},t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(r.e,{item:this._itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})},t}(i.e);t.e=p},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n(7),i=new(n(3).t)({name:"".concat("UseItemsScope.key",".useItemsScope"),factory:{dependencies:{observablesFactoryType:a.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return r});var a=n(3),i=(new a.t("idle"),new a.t("beforeUnload"),new a.t("syncActiveXClient"),new a.t("attributionHelper"),new a.t("educationAndUpsells"),new a.t("fileHandlerHelper"),new a.t("clientSideExtensionHelper")),r=new a.t("needsAttentionViewHelper");new a.t("shyConductor")},function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n.d(t,"t",function(){return i}),n.d(t,"n",function(){return r});var a="ListsAction",i="resetAllSurveyStatuses",r="resetSurveyStatusById"},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=new(n(3).t)("KnockoutResourceScope.key")},function(e,t,n){"use strict";var a=n(108);Object(a.e)([{rawString:".od-ItemNameEditor-input{display:table-cell;width:100%}.od-ItemNameEditor-extension{direction:ltr;display:table-cell}[dir=ltr] .od-ItemNameEditor-extension{padding-left:8px}[dir=rtl] .od-ItemNameEditor-extension{padding-right:8px}.od-ItemNameEditor--noExtension .od-ItemNameEditor-input{display:block;width:auto}.od-ItemNameEditor--noExtension .od-ItemNameEditor-extension{display:none}.od-ItemNameEditor-status{font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";word-wrap:break-word}.od-ItemNameEditor-status--error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}.od-ItemNameEditor-input--error{border-color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"!important}"}]);var i=n(0),r=n(17),o=n(98),s=n(568),c=n(340),d=function(e){function t(t){var n=e.call(this,t)||this;return n.namePlaceholder=s.e,n.name=t.name,n.extension=t.extension,n.status=t.status||r.observable(""),n.hasError=t.hasError||r.observable(!1),n.isEnabled=t.isEnabled||r.observable(!0),n.hasFocus=t.hasFocus||r.observable(!0),n.namePlaceholder=t.namePlaceholder||n.namePlaceholder,n.nameAriaLabel=t.nameAriaLabel||"",n.addBindingHandlers({selectOnFocus:c.e}),n}return Object(i.__extends)(t,e),t.prototype.onClick=function(e,t){t.stopPropagation()},t}(o.e),l=n(99).e({tagName:"ms-item-name-editor",template:'<div class="od-ItemNameEditor" data-bind="css:{\'od-ItemNameEditor--noExtension\':!extension,\'is-focused\':hasFocus,\'is-error\':hasError}"><div class="od-TextField"><span class="od-ItemNameEditor-input"><input class="od-TextField-field" id="ItemNameEditor-input" type="text" data-bind="textInput:name,hasFocus:hasFocus,selectOnFocus,attr:{\'aria-label\':nameAriaLabel,placeholder:namePlaceholder},css:{\'od-ItemNameEditor-input--error\':hasError},click:onClick,enable:isEnabled,automation:\'itemNameEditor-Input\'"></span><span class="od-ItemNameEditor-extension" data-bind="text:extension"></span></div>\x3c!--ko if:hasError--\x3e<div class="od-ItemNameEditor-status" aria-live="assertive" role="status" data-bind="text:status,css:{\'od-ItemNameEditor-status--error\':hasError}"></div>\x3c!--/ko--\x3e</div>',viewModel:d,synchronous:!0});t.e=l},function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a=n(66),i=n(0),r=n(94),o=n(254),s=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._identityDataSource=n.identityDataSource,a}return Object(i.__extends)(t,e),t.prototype.getToken=function(){return this._identityDataSource.getGraphToken({})},t.dependencies=Object(i.__assign)(Object(i.__assign)({},r.e.dependencies),{identityDataSource:o.e}),t}(r.e),c=Object(a.r)("GraphTokenProvider",s),d=n(3),l=function(){function e(){}return e.prototype.getApiName=function(){return"Graph"},e.prototype.getApiBaseUrl=function(){return"https://graph.microsoft.com/beta"},e}(),u=new d.t({name:"GraphUrlDataSource",factory:new a.i(l)}),f=n(282),p=Object(a.r)("GraphDataRequestor",f.e,{sessionManagementProvider:c,urlDataSource:u});f.e},function(e,t,n){"use strict";n.d(t,"e",function(){return _});var a=n(153),i=new(n(3).t)("".concat("MicroServiceDataSource.key",".microServiceDataSource")),r=n(31),o=n(254),s=n(66),c=n(77),d=n(205),l=n(506),u=n(138),f={ODB:n(374).e.ODB?1651:60021},p=Object(u.e)(f)&&Object(u.e)({ODB:-671}),m=function(){function e(e,t){this._identityDataSource=t.identityDataSource,this._microServiceDataSource=t.microServiceDataSource}return e.prototype.getToken=function(e,t){var n=this._identityDataSource.getIdentity().type;if(n===a.e.aad){if(t&&p){var i=new d.e(t).authority;return this._identityDataSource.getSharePointToken(i)}if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return r.n.resolve()})}else if(n===a.e.msa)return this._identityDataSource.getSessionToken();return r.n.reject(new c.e({code:l.e.unauthUser,isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))},e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)},e.dependencies={identityDataSource:o.e,microServiceDataSource:i.optional},e}(),_=Object(s.r)("SessionManagementProvider",m)},,,function(e,t,n){"use strict";var a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var a={};return"abcdefghijklmnopqrst".split("").forEach(function(e){a[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},a)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,c=o(e),d=1;d<arguments.length;d++){for(var l in n=Object(arguments[d]))i.call(n,l)&&(c[l]=n[l]);if(a){s=a(n);for(var u=0;u<s.length;u++)r.call(n,s[u])&&(c[s[u]]=n[s[u]])}}return c}},,,,,function(e,t,n){"use strict";var a;!function(e){e[e.Loading=0]="Loading",e[e.Files=1]="Files",e[e.FilePicker=2]="FilePicker",e[e.FolderPicker=3]="FolderPicker",e[e.Photos=4]="Photos",e[e.TextFileEditor=5]="TextFileEditor",e[e.AccountChooser=6]="AccountChooser",e[e.StorageInfo=7]="StorageInfo",e[e.StorageOptions=8]="StorageOptions",e[e.AppData=9]="AppData",e[e.Error=10]="Error",e[e.SyncOnboarding=11]="SyncOnboarding",e[e.Share=12]="Share",e[e.OneUp=14]="OneUp",e[e.PhotoPreferences=15]="PhotoPreferences",e[e.Embed=16]="Embed",e[e.SyncPlaceholders=17]="SyncPlaceholders",e[e.Restore=18]="Restore",e[e.ValidatePermission=20]="ValidatePermission",e[e.RansomwareDetection=21]="RansomwareDetection",e[e.Settings=22]="Settings",e[e.Unlock=23]="Unlock",e[e.MobileAppUpsell=24]="MobileAppUpsell",e[e.FileRequest=26]="FileRequest",e[e.CreateList=27]="CreateList",e[e.ManageVault=28]="ManageVault",e[e.RequestAccess=29]="RequestAccess",e[e.TraceMe=30]="TraceMe",e[e.FileBrowser=31]="FileBrowser",e[e.TagPreferences=32]="TagPreferences",e[e.PhotoStream=33]="PhotoStream",e[e.Convergence=34]="Convergence",e[e.DocumentOptions=35]="DocumentOptions",e[e.DeviceBackups=37]="DeviceBackups",e[e.Search=38]="Search",e[e.NotificationOptions=39]="NotificationOptions",e[e.ContentAssembly=40]="ContentAssembly",e[e.MetaOSAuthPopup=41]="MetaOSAuthPopup",e[e.SharingSettings=301]="SharingSettings",e[e.SyncSettings=302]="SyncSettings",e[e.StorageSettings=303]="StorageSettings",e[e.AccessPolicySettings=304]="AccessPolicySettings",e[e.ComplianceSettings=305]="ComplianceSettings",e[e.NotificationSettings=306]="NotificationSettings",e[e.GeoLocations=307]="GeoLocations"}(a||(a={})),t.e=a},function(e,t,n){"use strict";n.d(t,"t",function(){return i}),n.d(t,"e",function(){return r});var a=n(3),i=(new a.t("dataStore"),new a.t("userSettingsStore")),r=(new a.t("userInfoStore"),new a.t("smartFiltersStore"))},,,function(e,t,n){"use strict";var a=n(377);t.e=a.e},,,function(e,t,n){"use strict";n.d(t,"t",function(){return l});var a=n(0),i=n(6),r=n(31),o=n(170),s=n(66),c=n(14),d=function(e){function t(t,n){var a=e.call(this,t,n)||this,r=c.t.isActivated("8dba7267-c081-480e-9601-f659d6395db5","09/09/2020","Add dependencies to UserInfoProvider and UserInfoDataSource");return a.dataSource=!r&&n&&n.dataSource||a.resources.consume(i.N),a.canPersistUserInfo=a.dataSource.canPersistUserInfo(),a}return Object(a.__extends)(t,e),t.prototype.getAnid=function(){return this.dataSource.getAnid()},t.prototype.isAuthenticated=function(){return this.dataSource.isAuthenticated()},t.prototype.getUserInfo=function(e){var t=this;return e||!this._cachedUserInfo?this.isAuthenticated()?this.dataSource.getUserInfo(e).then(function(e){return t._cachedUserInfo=e,e},function(e){return r.n.wrapError(null)}):r.n.wrap(null):r.n.wrap(this._cachedUserInfo)},t.prototype.setUserInfo=function(e,t,n,a,i){return this.dataSource.setUserInfoWithUserFacts(e,t,n,a,i)},t.prototype.resetUpsellUserFact=function(){return this.dataSource.resetUpsellUserFact()},t.prototype.getBubbleUserFact=function(e,t,n){return this.dataSource.getBubbleUserFact?this.dataSource.getBubbleUserFact(e,t,n):this.getUserInfo(n).then(function(t){if(t&&t.info)for(var n=0,a=t.info;n<a.length;n++){var i=a[n],r=e.campaignGuid;if(i.id&&i.id.toLowerCase()===r.toLowerCase())return JSON.parse(i.data)}return{d:!1,v:0}},function(e){return r.n.wrapError(null)})},t.prototype.setBubbleUserFact=function(e,t){return this.dataSource.setBubbleUserFact?this.dataSource.setBubbleUserFact(e,t):this.setUserInfo(17,3,null,e.campaignGuid,JSON.stringify(t))},t.prototype.getSurveyStatusUserFact=function(e,t,n){return t?r.n.resolve({activated:!1,dateLastModified:new Date}):this.dataSource.getSurveyStatusUserFact?this.dataSource.getSurveyStatusUserFact(e):this.getUserInfo(n).then(function(t){if(t&&t.info)for(var n=0,a=t.info;n<a.length;n++){var i=a[n];if(i.id&&i.id.toLowerCase()===e.toLowerCase())return{activated:JSON.parse(i.data).a,dateLastModified:new Date(i.modifiedDate)}}return{activated:!1,dateLastModified:new Date}})},t.prototype.setSurveyStatusUserFact=function(e,t){return this.dataSource.setSurveyStatusUserFact?this.dataSource.setSurveyStatusUserFact(e,t):this.setUserInfo(47,3,null,e,JSON.stringify({a:t.activated}))},t.prototype.getUpsellDismissedById=function(e,t){return this.dataSource.getUpsellDismissedById(e,t)},t.prototype.getUpsellViewCountById=function(e,t){return this.dataSource.getUpsellViewCountById(e,t)},t.prototype.markUpsellAsSeen=function(e){return this.dataSource.markUpsellAsSeen(e)},t.prototype.markUpsellAsDismissed=function(e){return this.dataSource.markUpsellAsDismissed(e)},t.prototype.updateUpsellData=function(e,t,n){return this.dataSource.updateUpsellData(e,t,n)},t.prototype.hasUserFact=function(e){return this.dataSource.hasUserFact(e)},t.prototype.getUserFact=function(e){return this.dataSource.getUserFact(e)},t.prototype.getIsPremium=function(e){return this.dataSource.getIsPremium(e)},t.prototype.getUpsellToShow=function(e){return this.dataSource.getUpsellToShow(e)},t.prototype.getUpsellViewCount=function(e){return this.dataSource.getUpsellViewCount(e)},t.prototype.getUpsellDismissed=function(e){return this.dataSource.getUpsellDismissed(e)},t.prototype.getUpsellIframeSrc=function(e,t){return this.dataSource.getUpsellIframeSrc(e,t)},t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?o.t[e.variation]:e},t.prototype.sendShowUpsell=function(e,t,n){return this.dataSource.sendShowUpsell(e,t,n)},t.prototype.sendCloseUpsell=function(e,t,n){return this.dataSource.sendCloseUpsell(e,t,n)},t.prototype.getMarket=function(){return this.dataSource.getMarket()},t.prototype.getFirstRunExperienceDismissed=function(){return this.dataSource.getFirstRunExperienceDismissed()},t.prototype.getFirstRunExperienceViewCount=function(){return this.dataSource.getFirstRunExperienceViewCount()},t.prototype.updateFirstRunExperienceData=function(e,t){return this.dataSource.updateFirstRunExperienceData(e,t)},t.prototype.hasPositioningBeenViewed=function(){return this.dataSource.hasPositioningBeenViewed()},t.prototype.datePositioningViewed=function(){return this.dataSource.datePositioningViewed()},t.prototype.getPremiumUpsellsViewed=function(){return this.dataSource.getPremiumUpsellsViewed()},t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){return this.dataSource.getMostRecentNewFeaturesUpsellViewed()},t.prototype.setPositioningUserFactWithParams=function(e){return this.dataSource.setPositioningUserFactWithParams(e)},t.prototype.getExpiringSharingLinksSeen=function(){return this.dataSource.getExpiringSharingLinksSeen()},t.prototype.setExpiringSharingLinksSeen=function(){return this.dataSource.setExpiringSharingLinksSeen()},t.dependencies={dataSource:i.N},t}(n(94).e);t.e=d;var l=Object(s.r)("UserInfoProvider",d)},function(e,t,n){"use strict";function a(e,t){var n=e.toLowerCase(),a=t.toLowerCase();switch(n){case"premiumleftnav":if("getmorestorage"===a)return"cmmskgzokmj";if("learnmore"===a)return"cmmugdncaui";break;case"leftnav":switch(a){case"cleanupfiles":case"getmorestorage":return"cmmskgzokmj";case"try100gbforfree":return"cmmbmfcmgdo"}break;case"onehundredgbdialog":switch(a){case"get100gbstorage":return"cmmhc23e1b2";case"seeallfeatures":return"cmmlgh002ak";case"100gbtrial":return"cmmyb212hx6"}break;case"onehundredgbdialogrecurring":switch(a){case"get100gbstorage":return"cmml5cvidcs";case"seeallfeatures":return"cmmv5yyv1kk";case"100gbtrial":return"cmmbsrcmzlb"}break;case"suitenav":switch(a){case"upgradepage":return"cmmgpmx52xe";case"headerdiamond":return"cmmfk8o8cot"}break;default:return i["".concat(n)]||"cmmb989rxgz"}}n.d(t,"e",function(){return a});var i={trialbanner:"cmmywkr3bya​","100gbfreetrialdialog":"cmmw0zap5ip",deleteupselldialog:"cmmt1f0yr9b",expiringlinks:"cmmpk30kagw",fileuploadquotawarning:"cmmr3jgar60",quotablockupload:"cmmr3jgar60",fluentdialog:"cmmunfcy9ah",secondfredialog:"cmmunfcy9ah",fullquotablocknew:"cmmwf4dl6go",quotablock:"cmmwf4dl6go",quotablocklogin:"cmmwf4dl6go",quotablocknew:"cmmwf4dl6go",highquotablocknew:"cmmwf4dl6go",frozenblock:"cmmwf4dl6go",highquotabanner:"cmmko1p0k2g",quotabanner:"cmmko1p0k2g",overquotaleftnav:"cmmskgzokmj",leftnavlearnmore:"cmmugdncaui",managestorage:"cmmti3rc7hf",managestorageupsell:"cmmti3rc7hf",freupsellcardpresetplan:"cmmiw84xkf6",uploadprogresstile:"cmmmms1945c",movecopyprogresstile:"cmmr6xo8d4g",planspage:"cmm3jx2egoo",leftnavpagelist:"cmmfqa4dpsq",largestfiles:"cmma25ztypi",largestfilesview:"cmma25ztypi",quotablockcreate:"cmmxtp48hl0",passwordprotectedlinks:"cmmu5sxocgb","positioning-security-returninguser":"cmmnwk592om",premiumdialogrecurring:"cmmjgu04znm",targetedmlupsell:"cmmjgu04znm",newpremiumfeaturesupsellcard:"cmmjgu04znm","pvault-quotabannergopremium":"cmmcbfoyl8z","pvault-quotapositioning":"cmmjf7rlbil",vaultquotapositioning:"cmmjf7rlbil",quotalevelupselldialog:"cmmoruv6ml9"}},function(e,t,n){"use strict";var a=n(290);n.d(t,"e",function(){return a.t})},function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n(195),i=n(488);function r(e){return e}function o(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&e.itemStatus!==a.e.ConditionalAccessViewOnly&&e.itemStatus!==a.e.ConditionalAccessBlocked&&i.e.hasItemPermission(e,i.e.openItems)}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n(3),i=n(7),r=new a.t({name:"".concat("UploadedItemResourceKey",".UploadedItem"),factory:{dependencies:{observablesFactoryType:i.i},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create({}),disposable:t}}}})},function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n(0),i=n(323),r=n(51),o=n(109),s=n(66),c=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._context=t,a._itemProvider=n.itemProvider,a}return Object(a.__extends)(t,e),t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),a=t.input;return n.type=o.e.updateBundle,n.name=a.name,n.iconName=a.iconName,n.payloads.updateBundle={item:a,parent:a.UNSAFE_parent},n},t.prototype.onStart=function(e){var t=[new i.t(this._context.item.key,this._context.item)];return e.update(t),this._itemProvider.updateBundle(this._context,e)},t.dependencies=Object(a.__assign)(Object(a.__assign)({},i.n.dependencies),{itemProvider:r.resourceKey}),t}(i.n),d=Object(s.o)("UpdateBundleOperator",c)},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a="oneDriveQuotaDialog"},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a="screenBlockingDialogShownThisSession"},function(e,t,n){"use strict";var a=n(0),i=n(7),r=n(88),o=n(62),s=n(82),c=n(6),d=n(31),l=n(19),u=n(157),f=n(346),p=n(225),m=n(293),_=n(53),h=function(e){function t(t){var n=e.call(this,t)||this;return n._identityDataSource=n.resources.consume(c.p),n._isOneDriveWinApp=Object(_.e)(),n}return Object(a.__extends)(t,e),t.prototype.unlockPopup=function(){var e=this;return this._unlockSignal=new u.e,this.async.setTimeout(function(){e._showPopupNotice()},500),this._isOneDriveWinApp?(this.events.on(window,"StrongAuthTokenFromWinApp",this._onReceivedTokenFromWinApp),this._showLoginPopupForWinApp()):(this.events.on(window,"message",this._onReceivedMessage),this._createLoginPopup()),this._unlockSignal.getPromise()},t.prototype._onReceivedMessage=function(e){var t=this;if(this._loginPopup&&e.origin===window.location.origin&&e.data){var n=void 0;try{n=JSON.parse(e.data)}catch(e){}if(n&&n.isVault){this.async.clearInterval(this._popupInterval),this._popupInterval=0;var a=new l.e({name:"VaultHelper.FinalizeUnlock"});n.success?(n.canary&&(FilesConfig.canary=n.canary),n.navCanary&&(FilesConfig.navCanary=n.navCanary),this.resources.consumeAsync(m.e).then(function(e){e.unlockVault().then(function(){a.end({resultType:l.t.Success}),t._popupNoticeDialog.complete(),t._unlockSignal.complete(n.success),t._loginPopup.close(),t._loginPopup=null}).catch(function(){a.end({resultType:l.t.Failure,resultCode:"UnlockSessionMismatch",error:n.error&&n.error.message||"Unknown"}),t._showUnlockError()})})):(a.end({resultType:l.t.Failure,resultCode:"UnlockFailure",error:n.error&&n.error.message||"Unknown"}),this._showUnlockError())}}},t.prototype._showUnlockPopBlockError=function(){this._popupNoticeDialogText("".concat(p.a,'<p class="ms-fontColor-error">').concat(p.e,"</p>")),r.e.logData({name:"Vault.VerificationNeeded.Blocked"}),this._loginPopup=null},t.prototype._showUnlockError=function(){this._popupNoticeDialogText("".concat(p.a,'<p class="ms-fontColor-error">').concat(p.t,"</p>")),r.e.logData({name:"Vault.Unlock.Failed"}),this._unlockSignal.complete(!1),this._loginPopup&&(this._loginPopup.close(),this._loginPopup=null)},t.prototype._createLoginPopup=function(){var e=this._identityDataSource.getAuthUrl("msa_strong_auth:"),t=window.screenX,n=window.screenY,a=window.outerWidth,i=window.outerHeight,r=t+Math.max(a-500,0)/2,o=n+Math.max(i-500,0)/2;this._loginPopup=window.open(e,"vaultPopup","width=".concat(500,",height=").concat(500,",top=").concat(o,",left=").concat(r,",status=no,resizeable=yes,toolbar=no,menubar=no,scrollbars=yes")),this._monitorLoginPopup()},t.prototype._monitorLoginPopup=function(){var e=this;this._popupInterval||(this._popupInterval=this.async.setInterval(function(){if(e._loginPopup)if(e._loginPopup.closed)e.async.clearInterval(e._popupInterval),e._popupInterval=0;else try{e._loginPopup.postMessage("updating reference of parent to support navigations in auth popup",window.location.origin)}catch(t){t&&"TypeError"===t.name&&e._showUnlockPopBlockError()}else e.async.clearInterval(e._popupInterval),e._popupInterval=0},500))},t.prototype._showPopupNotice=function(){var e=this;if(!this._popupNoticeDialog||1!==this._popupNoticeDialog.state.peek()){var t=this.resources.consume(s.e),n=p.i;this._popupNoticeDialogText=this.observables.create(p.a),this._popupNoticeDialog=t.requestDialog({title:n,isSoftDismissable:!1,focusOnPrimaryAction:!0,component:{name:f.e.tagName,params:{html:this._popupNoticeDialogText}},actions:[{name:p.n,execute:function(){return e.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new o.e("CheckMark"),isDefault:!0}]}),this._logVaultEvent("Vault.VerificationNeeded.Shown"),this._popupNoticeDialog.wait().catch(function(){e._loginPopup&&3===e._popupNoticeDialog.state.peek()&&(e._logVaultEvent("Vault.VerificationNeeded.Dismiss"),e._unlockSignal.cancel(),e._loginPopup.close(),e._loginPopup=null)}),this._popupNoticeDialog.wait().then(function(){e._loginPopup&&2===e._popupNoticeDialog.state.peek()&&e._logVaultEvent("Vault.VerificationNeeded.Succeeded")})}},t.prototype.onDialogExecute=function(){if(this._logVaultEvent("Vault.VerificationNeeded.ShowPopup"),this._loginPopup&&!this._loginPopup.closed)try{this._loginPopup.focus()}catch(e){}else this._isOneDriveWinApp?this._showLoginPopupForWinApp():this._createLoginPopup();return d.n.resolve(1)},t.prototype._logVaultEvent=function(e){r.e.logData({name:e})},t.prototype._showLoginPopupForWinApp=function(){this._identityDataSource.getSessionToken(void 0,!0)},t.prototype._onReceivedTokenFromWinApp=function(e){var t=this,n=new l.e({name:"VaultHelper.PWA.FinalizeUnlock"});e.detail.error||!e.detail.token?(n.end({resultType:l.t.Failure,resultCode:"UnlockFailure",error:e.detail.error||"Unknown"}),this._showUnlockError()):this.resources.consumeAsync(m.e).then(function(a){a.unlockVault(!1,e.detail.token).then(function(){n.end({resultType:l.t.Success}),t._popupNoticeDialog.complete(),t._unlockSignal.complete(!0)}).catch(function(){n.end({resultType:l.t.Failure,resultCode:"UnlockSessionMismatch",error:e.detail.error||"Unknown"}),t._showUnlockError()})})},t}(i.n);t.e=h}],Array(22),[function(e,t,n){!function(){function t(e,t){var n,a,i,r,o,s,c,d;for(n=3&e.length,a=e.length-n,i=t,o=3432918353,s=461845907,d=0;d<a;)c=255&e.charCodeAt(d)|(255&e.charCodeAt(++d))<<8|(255&e.charCodeAt(++d))<<16|(255&e.charCodeAt(++d))<<24,++d,i=27492+(65535&(r=5*(65535&(i=(i^=c=(65535&(c=(c=(65535&c)*o+(((c>>>16)*o&65535)<<16)&4294967295)<<15|c>>>17))*s+(((c>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(r>>>16)&65535)<<16);switch(c=0,n){case 3:c^=(255&e.charCodeAt(d+2))<<16;case 2:c^=(255&e.charCodeAt(d+1))<<8;case 1:i^=c=(65535&(c=(c=(65535&(c^=255&e.charCodeAt(d)))*o+(((c>>>16)*o&65535)<<16)&4294967295)<<15|c>>>17))*s+(((c>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}var n=t;n.v2=function(e,t){for(var n,a=e.length,i=t^a,r=0;a>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),a-=4,++r;switch(a){case 3:i^=(255&e.charCodeAt(r+2))<<16;case 2:i^=(255&e.charCodeAt(r+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(r)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0},n.v3=t,e.exports=n}()},,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"ShowPropertiesAction",function(){return y});var a=n(0),i=n(10),r=n(388),o=n(355),s=n(384),c=n(31),d=n(21),l=n(148),u=n(12),f=n(334),p=n(158),m=n(19),_=n(85),h=n(5),b={},g=n(102),v=n(2),y=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="ShowProperties";var i=n.isInfoPaneExpanded,c=void 0===i?a.resources.consume(r.e):i,m=n.isSharingSectionExpanded,_=void 0===m?a.resources.consume(u._.optional):m,h=n.isInfoPaneAvailable,b=void 0===h?a.resources.consume(l.e.infoPane.isInfoPaneAvailable.optional):h,g=n.isFiltersPaneExpanded,v=void 0===g?a.resources.consume(o.e):g,y=n.isCopilotPaneExpanded,S=void 0===y?a.resources.consume(s.e):y,D=n.isColumnCustomizationPaneExpanded,I=void 0===D?a.resources.consume(l.e.columnCustomizationPane.isColumnCustomizationPaneExpanded.optional):D,x=n.rumOneHelper,C=void 0===x?a.resources.consume(f.e.optional):x,O=n.itemSelectionHelperType,w=void 0===O?a.resources.consume(d.e):O,E=n.engagement,A=void 0===E?a.resources.consume(p.e):E,L=t.useToggleBehavior,k=void 0!==L&&L,M=t.isSharingSectionExpanded,P=void 0!==M&&M,T=t.allowMultiSelect,U=void 0!==T&&T;return a._isInfoPaneExpanded=c,a._isSharingSectionExpanded=_,a._isInfoPaneAvailable=b||a.observables.create(!0),a._isFiltersPaneExpanded=v,a._isCopilotPaneExpanded=S,a._isColumnCustomizationPaneExpanded=I,a._rumOneHelper=C,a._useToggleBehavior=k,a._allowMultiSelect=U,a._shouldExpandSharingSection=P,a._itemSelectionHelper=new(a.scope.attached(w))({allowMultiSelect:a._allowMultiSelect,canFallback:!0,useCurrentSelectionGroup:!0}),a._engagement=A,a}return Object(a.__extends)(t,e),t.prototype.onExecute=function(e){this.isToggled.peek()||(this._rumOneHelper&&this._rumOneHelper.logPropertiesPaneLaunch(),this._isFiltersPaneExpanded&&this._isFiltersPaneExpanded(!1),this._isCopilotPaneExpanded&&this._isCopilotPaneExpanded(!1),this._isColumnCustomizationPaneExpanded&&this._isColumnCustomizationPaneExpanded(!1)),this._isSharingSectionExpanded&&this._isSharingSectionExpanded(this._shouldExpandSharingSection);var t=!this._useToggleBehavior||!this._isInfoPaneExpanded.peek();return t&&function(e){var t=b.LaunchInfoPane;if(t&&(t.end({resultType:m.t.Failure}),t=void 0),!t){var n={name:e};!function(e,t){b.LaunchInfoPane=t}(0,t=new m.e(n))}}("LaunchInfoPane"),this._engagement.logData({name:"DetailsPane.Click.".concat(t?"Open":"Close"),isIntentional:!0}),this._isInfoPaneExpanded(t),_.t.raise(document.body,"resize",void 0,!0),c.n.wrap({resultType:m.t.Success})},t.prototype.onIsAvailable=function(){var e=this._isInfoPaneAvailable();if(this._useToggleBehavior&&this._isInfoPaneExpanded())return!0;if(!e)return!1;var t=this._itemSelectionHelper.firstItem;if(!t())return!1;var n=[t];this._allowMultiSelect&&(n=this._itemSelectionHelper.selection());for(var a=0,i=n;a<i.length;a++){var r=i[a];if(r){var o=r();if(o&&(o.error||o.isPlaceholder&&o.queryType!==h.e.Search))return!1}}return!0},t.prototype.onIsToggled=function(){return this._isInfoPaneExpanded()},t.prototype.getEngagement=function(){return Object(v.isFeatureEnabled)(v.EngagementTelemetryEnhancement)?e.prototype.getEngagement.call(this).withPart(g.e,{item:this._itemSelectionHelper.firstItem}):e.prototype.getEngagement.call(this)},t}(i.e);t.default=y}],Array(14),[function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}],Array(23),[function(e,t,n){"use strict";e.exports=n(615)},function(e,t,n){"use strict";var a,i,r,o;if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var l=null,u=null,f=function(){if(null!==l)try{var e=t.unstable_now();l(!0,e),l=null}catch(e){throw setTimeout(f,0),e}};a=function(e){null!==l?setTimeout(a,0,e):(l=e,setTimeout(f,0))},i=function(e,t){u=setTimeout(e,t)},r=function(){clearTimeout(u)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var p=window.setTimeout,m=window.clearTimeout;if("undefined"!=typeof console){var _=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof _&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var h=!1,b=null,g=-1,v=5,y=0;t.unstable_shouldYield=function(){return t.unstable_now()>=y},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):v=0<e?Math.floor(1e3/e):5};var S=new MessageChannel,D=S.port2;S.port1.onmessage=function(){if(null!==b){var e=t.unstable_now();y=e+v;try{b(!0,e)?D.postMessage(null):(h=!1,b=null)}catch(e){throw D.postMessage(null),e}}else h=!1},a=function(e){b=e,h||(h=!0,D.postMessage(null))},i=function(e,n){g=p(function(){e(t.unstable_now())},n)},r=function(){m(g),g=-1}}function I(e,t){var n=e.length;e.push(t);e:for(;;){var a=n-1>>>1,i=e[a];if(!(void 0!==i&&0<O(i,t)))break e;e[a]=t,e[n]=i,n=a}}function x(e){return void 0===(e=e[0])?null:e}function C(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var a=0,i=e.length;a<i;){var r=2*(a+1)-1,o=e[r],s=r+1,c=e[s];if(void 0!==o&&0>O(o,n))void 0!==c&&0>O(c,o)?(e[a]=c,e[s]=n,a=s):(e[a]=o,e[r]=n,a=r);else{if(!(void 0!==c&&0>O(c,n)))break e;e[a]=c,e[s]=n,a=s}}}return t}return null}function O(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var w=[],E=[],A=1,L=null,k=3,M=!1,P=!1,T=!1;function U(e){for(var t=x(E);null!==t;){if(null===t.callback)C(E);else{if(!(t.startTime<=e))break;C(E),t.sortIndex=t.expirationTime,I(w,t)}t=x(E)}}function F(e){if(T=!1,U(e),!P)if(null!==x(w))P=!0,a(H);else{var t=x(E);null!==t&&i(F,t.startTime-e)}}function H(e,n){P=!1,T&&(T=!1,r()),M=!0;var a=k;try{for(U(n),L=x(w);null!==L&&(!(L.expirationTime>n)||e&&!t.unstable_shouldYield());){var o=L.callback;if("function"==typeof o){L.callback=null,k=L.priorityLevel;var s=o(L.expirationTime<=n);n=t.unstable_now(),"function"==typeof s?L.callback=s:L===x(w)&&C(w),U(n)}else C(w);L=x(w)}if(null!==L)var c=!0;else{var d=x(E);null!==d&&i(F,d.startTime-n),c=!1}return c}finally{L=null,k=a,M=!1}}var R=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){P||M||(P=!0,a(H))},t.unstable_getCurrentPriorityLevel=function(){return k},t.unstable_getFirstCallbackNode=function(){return x(w)},t.unstable_next=function(e){switch(k){case 1:case 2:case 3:var t=3;break;default:t=k}var n=k;k=t;try{return e()}finally{k=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=R,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=k;k=e;try{return t()}finally{k=n}},t.unstable_scheduleCallback=function(e,n,o){var s=t.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:A++,callback:n,priorityLevel:e,startTime:o,expirationTime:c=o+c,sortIndex:-1},o>s?(e.sortIndex=o,I(E,e),null===x(w)&&e===x(E)&&(T?r():T=!0,i(F,o-s))):(e.sortIndex=c,I(w,e),P||M||(P=!0,a(H))),e},t.unstable_wrapCallback=function(e){var t=k;return function(){var n=k;k=t;try{return e.apply(this,arguments)}finally{k=n}}}},function(e,t,n){var a,i,r;!function(o){"use strict";function s(e,t,n,a,i,r,o){this.inputItem=t,this.stateArrayIndex=n,this.mappingOptions=i,this.arrayOfState=r,this.outputObservableArray=o,this.outputArray=this.outputObservableArray.peek(),this.isIncluded=null,this.suppressNotification=!1,this.outputArrayIndex=e.observable(a),this.disposeFuncFromMostRecentMapping=null,this.mappedValueComputed=e.computed(this.mappingEvaluator,this),this.mappedValueComputed.subscribe(this.onMappingResultChanged,this),this.previousMappedValue=this.mappedValueComputed.peek()}function c(e,t){if(!e)return null;switch(e.status){case"added":return e.index;case"deleted":return e.index+t;default:throw new Error("Unknown diff status: "+e.status)}}function d(e,t,n,a,i,r,o,c,d){var l="number"==typeof t.moved,u=l?n[t.moved]:new s(e,t.value,a,i,r,o,c);return o.splice(a,0,u),u.isIncluded&&d.splice(i,0,u.mappedValueComputed.peek()),l&&(u.stateArrayIndex=a,u.setOutputArrayIndexSilently(i)),u}function l(e,t,n,a,i){var r=t.splice(n,1)[0];r.isIncluded&&i.splice(a,1),"number"!=typeof e.moved&&r.dispose()}function u(e,t,n){return e.stateArrayIndex=t,e.setOutputArrayIndexSilently(n),n+(e.isIncluded?1:0)}function f(e,t,n,a,i,r){return t.subscribe(function(t){if(t.length){for(var o=function(e,t){for(var n={},a=0;a<e.length;a++){var i=e[a];"added"===i.status&&"number"==typeof i.moved&&(n[i.moved]=t[i.moved])}return n}(t,n),s=0,f=t[0],p=0,m=f&&function(e,t,n){return n.length&&t[e.index]?t[e.index].outputArrayIndex.peek():n.length}(f,n,a),_=f.index;f||_<n.length;_++)if(c(f,p)===_){switch(f.status){case"added":d(e,f,o,_,m,r,n,i,a).isIncluded&&m++,p++;break;case"deleted":l(f,n,_,m,a),p--,_--;break;default:throw new Error("Unknown diff status: "+f.status)}f=t[++s]}else _<n.length&&(m=u(n[_],_,m));i.valueHasMutated()}},null,"arrayChange")}function p(e,t){var n=[],a=[],i=e.observableArray(a),r=this.peek();if("function"==typeof t&&(t={mapping:t}),t.mappingWithDisposeCallback){if(t.mapping||t.disposeItem)throw new Error("'mappingWithDisposeCallback' cannot be used in conjunction with 'mapping' or 'disposeItem'.")}else if(!t.mapping)throw new Error("Specify either 'mapping' or 'mappingWithDisposeCallback'.");for(var o=0;o<r.length;o++){var c=r[o],d=new s(e,c,o,a.length,t,n,i),l=d.mappedValueComputed.peek();n.push(d),d.isIncluded&&a.push(l)}var u=f(e,this,n,a,i,t),p=e.computed(i).extend({trackArrayChanges:!0}),m=p.dispose;return p.dispose=function(){u.dispose(),e.utils.arrayForEach(n,function(e){e.dispose()}),m.call(this,arguments)},_(e,p),p}function m(e,t){return p.call(this,e,function(e){return t(e)?e:b})}function _(e,t){return e.utils.extend(t,e[g]),t}function h(e){e.projections={_exclusionMarker:b},function(e){function t(e,t){return function(){return t.apply(this,[e].concat(Array.prototype.slice.call(arguments,0)))}}e[g]={map:t(e,p),filter:t(e,m)}}(e),_(e,e.observableArray.fn)}var b={};s.prototype.dispose=function(){this.mappedValueComputed.dispose(),this.disposeResultFromMostRecentEvaluation()},s.prototype.disposeResultFromMostRecentEvaluation=function(){if(this.disposeFuncFromMostRecentMapping&&(this.disposeFuncFromMostRecentMapping(),this.disposeFuncFromMostRecentMapping=null),this.mappingOptions.disposeItem){var e=this.mappedValueComputed();this.mappingOptions.disposeItem(e)}},s.prototype.mappingEvaluator=function(){var e;if(null!==this.isIncluded&&this.disposeResultFromMostRecentEvaluation(),this.mappingOptions.mapping)e=this.mappingOptions.mapping(this.inputItem,this.outputArrayIndex);else{if(!this.mappingOptions.mappingWithDisposeCallback)throw new Error("No mapping callback given.");var t=this.mappingOptions.mappingWithDisposeCallback(this.inputItem,this.outputArrayIndex);if(!("mappedValue"in t))throw new Error("Return value from mappingWithDisposeCallback should have a 'mappedItem' property.");e=t.mappedValue,this.disposeFuncFromMostRecentMapping=t.dispose}var n=e!==b;return this.isIncluded!==n&&(null!==this.isIncluded&&this.moveSubsequentItemsBecauseInclusionStateChanged(n),this.isIncluded=n),e},s.prototype.onMappingResultChanged=function(e){e!==this.previousMappedValue&&(this.isIncluded&&this.outputArray.splice(this.outputArrayIndex.peek(),1,e),this.suppressNotification||this.outputObservableArray.valueHasMutated(),this.previousMappedValue=e)},s.prototype.moveSubsequentItemsBecauseInclusionStateChanged=function(e){var t,n,a=this.outputArrayIndex.peek();if(e)for(this.outputArray.splice(a,0,null),t=this.stateArrayIndex+1;t<this.arrayOfState.length;t++)(n=this.arrayOfState[t]).setOutputArrayIndexSilently(n.outputArrayIndex.peek()+1);else for(this.outputArray.splice(a,1),t=this.stateArrayIndex+1;t<this.arrayOfState.length;t++)(n=this.arrayOfState[t]).setOutputArrayIndexSilently(n.outputArrayIndex.peek()-1)},s.prototype.setOutputArrayIndexSilently=function(e){this.suppressNotification=!0,this.outputArrayIndex(e),this.suppressNotification=!1};var g="_ko.projections.cache";!function(){if(void 0!==e.exports){var o=n(17);h(o),e.exports=o}else i=[n(17)],void 0===(r="function"==typeof(a=h)?a.apply(t,i):a)||(e.exports=r)}()}()},,function(e,t,n){"use strict";n.r(t);var a,i=n(0),r=n(1),o=n(133),s=n(393),c=n(443),d=n(41),l=n(110),u=n.n(l),f=n(412),p=n(130),m=12e4;!function(e){e[e.Valid=0]="Valid",e[e.Expiring=1]="Expiring",e[e.Locked=2]="Locked",e[e.Unlocked=3]="Unlocked",e[e.Extended=4]="Extended",e[e.Ended=5]="Ended"}(a||(a={}));var _,h=function(){function e(e,t){var n=this;this.listeners=[],this.checkExpiration=function(){n.fetchExpirationTime().then(function(e){e?e-m<Date.now()?n.notifyExpiring():n.handleVaultExtended():n.notifyLocked()},function(){n.notifyExpiring()})},this.handleVaultLocked=function(){n.stopTimers(),n.notifyLocked()},this.handleVaultUnlocked=function(){n.notifyUnlocked()},this.handleVaultExtended=function(){n.stopTimers(),n.startTimers(),n.notifyExtended()},this.handleStorageEvent=function(e){if(e.key===n.expirationTimeStorageKey){var t=e.newValue,a=e.oldValue;t?a?t>a&&n.handleVaultExtended():n.handleVaultUnlocked():n.handleVaultLocked()}},this.wacDataSource=t,this.storagePrefix="".concat(p.t).concat(e),this.expirationTimeStorageKey="".concat(this.storagePrefix).concat(f.STORAGE_KEY_EXPIRATION)}return e.prototype.setup=function(){var e=this;return this.addStorageEventListener(),this.syncExpirationTime().then(function(){e.startTimers()})},e.prototype.dispose=function(){this.removeStorageEventListener(),this.stopTimers()},e.prototype.addEventListener=function(e){-1===this.listeners.findIndex(function(t){return t===e})&&this.listeners.push(e)},e.prototype.removeEventListener=function(e){var t=this.listeners.findIndex(function(t){return t===e});-1!==t&&this.listeners.splice(t)},e.prototype.extendVault=function(){var e=this;return this.wacDataSource.request("/drive/special/vault/action.unlockVault","POST",!0).then(function(){return e.syncExpirationTime()}).then(function(){return e.handleVaultExtended()}).catch(function(){e.handleVaultLocked()})},e.prototype.onUserActivity=function(){this.extendVault()},e.prototype.notify=function(e){for(var t=0,n=this.listeners;t<n.length;t++)(0,n[t])(e)},e.prototype.notifyExpiring=function(){this.notify(a.Expiring)},e.prototype.notifyLocked=function(){this.notify(a.Locked)},e.prototype.notifyUnlocked=function(){this.notify(a.Unlocked)},e.prototype.notifyExtended=function(){this.notify(a.Extended)},e.prototype.syncExpirationTime=function(){var e=this;return this.fetchExpirationTime().then(function(t){t&&e.setExpirationTime(t)})},e.prototype.fetchExpirationTime=function(){return this.wacDataSource.request("/drive/special/vault","GET",!0).then(function(e){var t=e[0];if(t.vault.expirationInSeconds)return Date.now()+1e3*t.vault.expirationInSeconds})},e.prototype.getExpirationTime=function(){return Number(window.localStorage.getItem(this.expirationTimeStorageKey))},e.prototype.setExpirationTime=function(e){try{e&&window.localStorage.setItem(this.expirationTimeStorageKey,String(e))}catch(e){console.log(e)}},e.prototype.startTimers=function(){this.stopTimers();var e=this.getExpirationTime();if(e){var t=e-Date.now();this.expirationTimerId=window.setTimeout(this.checkExpiration,t-m),this.lockedTimerId=window.setTimeout(this.handleVaultLocked,t)}},e.prototype.stopTimers=function(){this.expirationTimerId&&(window.clearTimeout(this.expirationTimerId),this.expirationTimerId=void 0),this.lockedTimerId&&(window.clearTimeout(this.lockedTimerId),this.lockedTimerId=void 0)},e.prototype.addStorageEventListener=function(){window.addEventListener("storage",this.handleStorageEvent)},e.prototype.removeStorageEventListener=function(){window.removeEventListener("storage",this.handleStorageEvent)},e}();!function(e){e[e.JSApiBootNotStart=0]="JSApiBootNotStart",e[e.JSApiBootStarted=1]="JSApiBootStarted",e[e.JSApiBootPendingComplete=2]="JSApiBootPendingComplete",e[e.JSApiBootSuccess=3]="JSApiBootSuccess",e[e.JSApiBootFailed=4]="JSApiBootFailed"}(_||(_={}));var b="Unknown",g=function(){function e(e,t,n){void 0===e&&(e=b),void 0===n&&(n=_.JSApiBootNotStart),this.reset(e,t,n)}return e.prototype.update=function(e){if(this.data&&e)for(var t in e)this.data[t]=e[t]},e.prototype.reset=function(e,t,n){void 0===e&&(e=b),void 0===n&&(n=_.JSApiBootNotStart),this.data={bootState:n,entryPoint:e,userClickTime:t}},e}(),v=n(19),y=n(157);function S(e,t){var n=new y.e,a=new v.e({name:"WacHost.JsApiScriptLoad"}),i=document.createElement("script");return i.onload=function(){a.end({resultType:v.t.Success,resultCode:"JS API script Load Completed"}),n.resolve(void 0)},i.onerror=function(){document.body.removeChild(i),a.end({resultType:v.t.Failure,resultCode:"JS API script Load Failure"}),t({bootState:void 0,resultType:v.t.Failure,resultCode:"LoadFailed",errorInfo:"Failed to load JsApi"}),n.reject(void 0)},i.onabort=function(){document.body.removeChild(i),a.end({resultType:v.t.Failure,resultCode:"JS API script Load Abort"}),t({bootState:void 0,resultType:v.t.Failure,resultCode:"LoadFailed",errorInfo:"Failed to load JsApi Abort"}),n.reject(void 0)},i.src=e,document.body.appendChild(i),n.getPromise()}function D(e,t){var n=setTimeout(function(){n=null,new v.e({name:"WacHost.JsApiScriptBootstrap",startTimeOverride:t.officeInitializationTime}).end({resultType:v.t.Failure,resultCode:"JS API script bootstrap timeout"}),t.bootState===_.JSApiBootPendingComplete&&e.triggerLogEvent({bootState:_.JSApiBootFailed,resultType:"visible"===document.visibilityState?v.t.Failure:v.t.ExpectedFailure,resultCode:"Timeout",errorInfo:"Timeout"})},15e4);return n}var I=n(31),x=n(57),C=function(){function e(){this.sources=[],this.handlers={}}return e.prototype.attach=function(e){var t=this;return Object(x.e)("MessageDispatcher: attached source ",e),-1===this.sources.findIndex(function(t){return e===t})&&this.sources.push(e),function(){t.deattach(e)}},e.prototype.deattach=function(e){Object(x.e)("MessageDispatcher: deattached source ",e);var t=this.sources.findIndex(function(t){return e===t});-1!==t&&this.sources.splice(t,1)},e.prototype.dispatch=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,a,r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:Object(x.e)("MessageDispatcher dispatch message: ",e,t),i.label=1;case 1:return i.trys.push([1,8,,9]),(n=this.handlers[e])?(Object(x.e)("MessageDispatcher handle event: ",e,t),(a=n(t))?(r=void 0,I.n.isPromise(a)?[4,a]:[3,3]):[3,5]):[3,6];case 2:return r=i.sent(),[3,4];case 3:r=a,i.label=4;case 4:return Object(x.e)("MessageDispatcher receive response: ",e,r),[2,r];case 5:return[3,7];case 6:Object(x.e)("MessageDispatcher ignore event: ",e,t),i.label=7;case 7:return[3,9];case 8:throw o=i.sent(),Object(x.e)("MessageDispatcher unhandled error: ",o),o;case 9:return[2]}})})},e.prototype.respond=function(e){for(var t=0,n=this.sources;t<n.length;t++)n[t].receive(e)},e.prototype.addEventListener=function(e,t){Object(x.e)("MessageDispatcher add event handler: ",e),this.handlers[e]=t},e.prototype.removeEventListener=function(e,t){Object(x.e)("MessageDispatcher remove event handler: ",e),this.handlers[e]=void 0},e.prototype.dispose=function(){this.sources=[],this.handlers={}},e}(),O=n(34),w=n(428),E=n(20),A=n(204),L=n(728),k=n(241),M=n(571),P=n(719),T=n(572);function U(e){var t=e.vault,n=e.dispatcher,i=Object(r.useState)(a.Valid),o=i[0],s=i[1];Object(r.useEffect)(function(){if(t)return t.setup(),t.addEventListener(s),function(){t.dispose(),t.removeEventListener(s)}},[t,s]);var c=null;switch(o){case a.Expiring:c=r.createElement(F,{onExtend:function(){t.extendVault(),n.respond(Object(O.a)())},onClose:function(){window.location.href="/"},onLayerDidMount:function(){n.respond(Object(O.n)())},onDismiss:function(){window.location.href="/"}});break;case a.Locked:c=r.createElement(H,{onUnlock:function(){window.location.reload()},onClose:function(){window.location.href="/"},onLayerDidMount:function(){n.respond(Object(O.n)())},onDismiss:function(){window.location.href="/"}});break;case a.Unlocked:window.location.reload();break;case a.Extended:c=null}return r.createElement("div",null,c)}function F(e){var t=e.onExtend,n=e.onClose,a=e.onLayerDidMount,i=e.onDismiss;return r.createElement(R,{title:A.a,subText:A.e,onOk:t,okText:A.n,onCancel:n,cancelText:A.t,onLayerDidMount:a,onDismiss:i})}function H(e){var t=e.onUnlock,n=e.onClose,a=e.onLayerDidMount,i=e.onDismiss;return r.createElement(R,{title:A.o,subText:A.i,onOk:t,okText:A.s,onCancel:n,cancelText:A.r,onLayerDidMount:a,onDismiss:i})}function R(e){var t=e.title,n=e.subText,a=e.okText,i=e.onOk,o=e.cancelText,s=e.onCancel,c=e.onLayerDidMount,d=e.onDismiss;return r.createElement(L.e,{minWidth:480,hidden:!1,type:k.e.normal,modalProps:{isOpen:!0,isBlocking:!0,layerProps:{onLayerDidMount:c}},onDismiss:d,dialogContentProps:{title:t,subText:n}},r.createElement(M.e,null,a?r.createElement(P.e,{onClick:i,text:a}):null,o?r.createElement(T.e,{onClick:s,text:o}):null))}var N=n(270),B=(n(586),n(36)),j=n(66),V=n(6),z=n(47),G=n(217),K=n(22),W=n(247),q=n(50),Q=n(492),Y=n(5),J=n(283),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.getItem=function(t){var n,a=this._urlDataSource.getKeyParams(t.parentKey),i=this._urlDataSource.getQueryType(a);switch(t.qosName=t.qosName||"Odc.".concat(Y.e[i],".ItemDataSource.getItem"),i){case Y.e.SharedWithMe:n=this._getSharedDataSource().then(function(e){return e.getItem(t)});break;case Y.e.Recent:n=this._getRecentDataSource().then(function(e){return e.getItem(t)});break;case Y.e.RecycleBin:n=this._getRecycleBinDataSource().then(function(e){return e.getItem(t)});break;case Y.e.Search:n=this._getSearchDataSource().then(function(e){return e.getItem(t)});break;default:n=e.prototype.getItem.call(this,t)}return n},t.prototype._getRecentDataSource=function(){var e=this,t=I.n.resolve(n.ee([172],1660)).then(J.e).then(function(t){return new(e.managed(t))});return this._getRecentDataSource=function(){return t},t},t.prototype._getSearchDataSource=function(){var e=this,t=I.n.resolve(n.ee([175,"ondemand.resx-ondemand"],1661)).then(J.e).then(function(t){return new(e.managed(t))});return this._getSearchDataSource=function(){return t},t},t.prototype._getRecycleBinDataSource=function(){var e=this,t=I.n.resolve(n.ee([173],1662)).then(J.e).then(function(t){return new(e.managed(t))});return this._getRecycleBinDataSource=function(){return t},t},t.prototype._getSharedDataSource=function(){var e=this,t=I.n.resolve(n.ee([177],1663)).then(J.e).then(function(t){return new(e.managed(t))});return this._getSharedDataSource=function(){return t},t},t}(Q.e),Z=X,$=n(7),ee=n(164),te=999999,ne=function(e){function t(t){return e.call(this,t)||this}return Object(i.__extends)(t,e),t.prototype.getThumbnails=function(e,t,n){void 0===n&&(n=null);var a=t.map(ae).join(",");return this.resources.consume(ee.e).send({apiName:"thumbnails",path:"/drives/".concat(e.driveId,"/items/").concat(e.itemId,"/thumbnails?select=").concat(a).concat(n?"&authkey=".concat(n):""),needsAuthorization:!n})},t.prototype.getThumbnailForLargestDimension=function(e,t,n){return n?this.getThumbnailForSize(e,t,te):this.getThumbnailForSize(e,te,t)},t.prototype.getThumbnailForSize=function(e,t,n){var a="c".concat(t,"x").concat(n);return e.value[0][a]},t}($.n);function ae(e){return"c".concat(e.width||te,"x").concat(e.height||te)}var ie=n(94),re=n(153),oe=n(16),se=n(348),ce=n(2),de=n(4),le={ODC:"DisableTeachingBubbleForTABTest"},ue={ODB:-834},fe=n(9),pe=n(88),me=n(100),_e=n(45),he=n(463),be=n(385),ge=n(281),ve=n(259),ye=function(){function e(e,t){void 0===e&&(e={}),this._dataStore=new me.e("TeachingBubbleProvider",_e.e.session),this._identityDataSource=t.identityDataSource,this._userInfoProvider=t.userInfoProvider,this._navigation=t.navigation,this.currentBubble=new ve.e(void 0),this._bubbles=[],this._navigation.viewParams.resetAllBubbles&&this._resetAllBubbles();var n=this._navigation.viewParams.resetBubbleByGuid;n&&this._resetBubbleByGuid(n)}return e.prototype.clearAllBubbles=function(){this._bubbles=[]},e.prototype.showNextBubble=function(){var e=this.getNextBubble();for(this.clearCurrentBubble();e&&this.hasBubbleBeenSeenThisSession(e.campaign);)e=this.getNextBubble();e&&this._setCurrentBubble(e)},e.prototype.getNextBubble=function(){return this._bubbles.pop()},e.prototype.clearCurrentBubble=function(){this.currentBubble&&this.currentBubble.set(null)},e.prototype.addBubble=function(e){var t=this,n=e.bubble;return n?this.shouldBubbleBeAdded(n,!1).then(function(n){return!!n&&(t._addBubbleToQueue(e),!0)}):I.n.wrap(!1)},e.prototype.shouldBubbleBeAdded=function(e,t,n,a,i){var r=this;if(void 0===i&&(i=!0),Object(ce.isFeatureEnabled)(le)||Object(ce.isFeatureEnabled)(ue))return I.n.wrap(!1);if(a){var o=this._checkShouldBubbleBeAdded(e,t,a);return I.n.wrap(o)}return this._userInfoProvider.getBubbleUserFact(e,n,i).then(function(n){return r._checkShouldBubbleBeAdded(e,t,n)})},e.prototype.markBubbleAsDismissed=function(e){var t=this;return this._userInfoProvider.getBubbleUserFact(e).then(function(n){n.d=!0;var a=t._userInfoProvider.setBubbleUserFact(e,n);return t.markBubbleAsSeen(e),pe.e.logData({name:"TeachingBubble.Dismissed",extraData:{campaignGuid:e.campaignGuid}}),t.showNextBubble(),a})},e.prototype.markBubbleAsSeen=function(e){var t=this;return this.markBubbleAsSeenThisSession(e),this._userInfoProvider.getBubbleUserFact(e).then(function(n){return n.v++,pe.e.logData({name:"TeachingBubble.Seen",extraData:{campaignGuid:e.campaignGuid}}),t._userInfoProvider.setBubbleUserFact(e,n)})},e.prototype.hasBubbleBeenSeen=function(e){return this._userInfoProvider.getBubbleUserFact(e).then(function(e){return e.v>0})},e.prototype.hasBubbleBeenSeenToday=function(e){var t=this._dataStore.getValue(this.getTeachingBubbleCampaignSessionSeenTimeKey(e),_e.e.local);return!!t&&(t-(new Date).getTime())/864e5<1},e.prototype.markBubbleAsSeenThisSession=function(e){this._dataStore.setValue(this.getTeachingBubbleCampaignSessionSeenKey(e),!0),this._dataStore.setValue(this.getTeachingBubbleCampaignSessionSeenTimeKey(e),(new Date).getTime(),_e.e.local)},e.prototype.hasBubbleBeenSeenThisSession=function(e){return this._dataStore.getValue(this.getTeachingBubbleCampaignSessionSeenKey(e))},e.prototype.getTeachingBubbleCampaignSessionSeenKey=function(e){return"Seen"+e.campaignGuid},e.prototype.getTeachingBubbleCampaignSessionSeenTimeKey=function(e){return"SeenTime"+e.campaignGuid},e.prototype._checkShouldBubbleBeAdded=function(e,t,n){var a=!this._identityDataSource||this._identityDataSource.getIdentity().type!==re.e.anonymous,i=e.maxUserViewCount||ge.t,r=Object(ce.isFeatureEnabled)(ce.EnableTeachingBubbles)||t,o=Object(ce.isFeatureEnabled)(e.flag)||!(!e.experimentId||!Object(be.t)(e.experimentId,e.flag)),s=!e.killSwitchGuid||!fe.e.isActivated(e.killSwitchGuid);return r&&a&&n&&o&&s&&!this.hasBubbleBeenSeenThisSession(e)&&this._isExperimentEnabled(e)&&!n.d&&n.v<i},e.prototype._isExperimentForceEnabled=function(e){if(!e)return!1;var t=e.getExperimentData();return t&&t.name&&!!this._navigation.viewParams[t.name]},e.prototype._isExperimentEnabled=function(e){if(!e.experimentData)return!0;var t=this._getExperiment(e);return!t||this._isExperimentForceEnabled(t)||t.IsExperimentOn()},e.prototype._getExperiment=function(t){if(t.experimentData&&t.experimentData.name){var n=t.experimentData.name;return e.experiments[n]||(e.experiments[n]=new he.t(t.experimentData,t.aaToABExperimentFlight)),e.experiments[n]}},e.prototype._resetBubbleCampaignUserFact=function(e){this._userInfoProvider.setBubbleUserFact(e,{d:!1,v:0})},e.prototype._resetCampaignSeenSessionStorage=function(e){this._dataStore.remove(this.getTeachingBubbleCampaignSessionSeenKey(e))},e.prototype._resetAllBubbles=function(){var e=this;this._iterateThroughBubbles(function(t){e._resetBubbleCampaignUserFact(t),e._resetCampaignSeenSessionStorage(t)})},e.prototype._resetBubbleByGuid=function(e){var t=this;this._iterateThroughBubbles(function(n){n.campaignGuid===e&&(t._resetBubbleCampaignUserFact(n),t._resetCampaignSeenSessionStorage(n))})},e.prototype._iterateThroughBubbles=function(e){for(var t in se)se[t].campaignGuid&&e(se[t])},e.prototype._setCurrentBubble=function(e){this.currentBubble.set(e)},e.prototype._addBubbleToQueue=function(e){var t=e.bubble,n=e.element;this._bubbles.unshift({campaign:t,anchorElement:n}),this.currentBubble.get()||this.showNextBubble()},e.dependencies={identityDataSource:V.p.optional,userInfoProvider:q._,navigation:B.e},e.experiments={},e}(),Se=Object(j.r)("TeachingBubbleProvider",ye),De=n(3),Ie=new De.t({name:"FloodgateDataSource.key",loader:new j.t(function(){return n.ee([124,"ondemand.resx-ondemand"],1733).then(function(e){return e.resourceKey})})}),xe=n(15),Ce=n(33),Oe=function(){function e(e,t){this._navigation=t.navigation,this._mayBeFastOneUp=!!Object(de.es)(de.fn)&&!!this.getFocusItemKey(this._navigation.viewParams),this._isFastOneUp=this._mayBeFastOneUp}return e.prototype.checkIsFastOneUp=function(){return this._isFastOneUp},e.prototype.resetIsFastOneUp=function(){this._isFastOneUp=!1},e.prototype.getCurrentItemKey=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(xe.o)(e)},e.prototype.getKey=function(e){return Object(xe._)(e)},e.prototype.getKeyParams=function(e){return Object(xe.h)(e)},e.prototype.getQueryType=function(e){return void 0===e&&(e=this._navigation.viewParams),Object(xe.C)(e)},e.prototype.getPageType=function(e,t){return void 0===e&&(e=this._navigation.viewParams),Object(xe.S)(e,this._mayBeFastOneUp||t)},e.prototype.getSubQueryType=function(e,t){return void 0===e&&(e=this._navigation.viewParams),Object(xe.E)(e,t)},e.prototype.getFocusItemKey=function(e){void 0===e&&(e=this._navigation.viewParams);var t=null;return(e.parId||e.parQt||e.parCid)&&((t={}).id=e.id,t.qt=e.qt,t.cid=e.cid,t.internalPath=e.internalPath,delete t.u),t&&Object(xe._)(t)||null},e.prototype.getRootItemKey=function(e){return void 0===e&&(e=Y.e.Files),Object(xe.w)(e)},e.prototype.getDefaultRootItemId=function(){return"root"},e.prototype.getApiBaseUrl=function(e){return Object(Ce.s)(e)},e.prototype.getNavLinkClickUrl=function(e){return""},e.dependencies={navigation:B.e,resources:De.r},e}(),we=Object(j.r)("UrlDataSourceLite",Oe),Ee=n(469),Ae=n(329),Le=n(14),ke=!Le.t.isActivated("261E9FAA-0D80-41B7-A45F-FD8A6AE6327C","04/04/2021","Capture referral origin information"),Me=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._navigation=n.resources.consume(B.e),n._identityDataSource=n.resources.consume(G.e),n._urlDataSourceLite=n.resources.consume(we),n._teachingBubbleProvider=n.resources.consume(Se),n._firstRunExperienceStatus=n.resources.consume(Ee.e),n}return Object(i.__extends)(t,e),t.prototype.getEngagementData=function(e){var t=this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"],n={referralOrigin:t};return e===oe.e[oe.e.StorageOptions]?Object(i.__assign)({purchaseSource:t},ke&&t&&n):ke&&t?n:void 0},t.prototype.userExecuteAction=function(e){var t=this;if(Object(ce.isFeatureEnabled)(ce.EnableFloodgate)&&e){var n=e.name;this.resources.consumeAsync(Ie).then(function(e){0===n.indexOf("Upload")&&(n="Upload"),t._identityDataSource.getIdentity().type!==re.e.anonymous&&("NewSession"===n&&t._isValidNpsSurveyContext()&&e.recordUserAction("NewNpsSession"),t._isMeaningfulNpsAction(n)&&e.recordUserAction("MeaningfulNpsAction"),"Navigation"===n&&Object(Ce.l)(t._navigation.viewParams)&&e.recordUserAction("EnteredAllPhotosView")),e.recordUserAction(n)})}},t.prototype.userSeeItem=function(e){},t.prototype._isValidNpsSurveyContext=function(){var e=this._urlDataSourceLite.getPageType(),t=e===oe.e.Files||e===oe.e.Photos;return!this._teachingBubbleProvider.currentBubble.get()&&this._firstRunExperienceStatus.get()!==Ae.e.visible&&t},t.prototype._isMeaningfulNpsAction=function(e){return"Open.File"===e||"Open.Media"===e||/OpenIn[a-zA-z]+/.test(e)||"Upload"===e||"CreateFolder"===e||/Create[a-zA-Z]+DocumentAction/.test(e)},t}(ie.e),Pe=n(167),Te=n(439),Ue=n(166),Fe=n(191),He=Le.e.isActivated("FAD63583-9D31-41FA-9F61-FA6F6D68D4F7","07/12/2023","TTF Open restricted to File"),Re=function(){function e(){this._hasReported=!1}return e.prototype.trackUserAction=function(e){if(!this._hasReported)if(this._startEngagement){var t=function(e){switch(e.name){case"Open.File":case"Open.Media":return"Open";case"OpenItemActivityAction":case"OpenItemAction":if(He)return"Open";case"Open":if(He){if("File"!==e.objectType)return}else if(!e.objectType||"Folder"===e.objectType)return;return"Open";case"CopyLink":case"CopyTo":case"CreateDocument":case"CreateFolder":case"Delete":case"Download":case"ItemPicker.Complete":case"MoveTo":case"OpenInOfficeClient":case"OpenInOfficeOnline":case"OpenInImmersiveReader":case"Upload":case"Rename":case"Share":case"Favorite":case"Unfavorite":return e.name;case"ShareAction":return"Share";case"CopyLinkAction":return"CopyLink";case"UploadFileAction":case"UploadFolderAction":return"Upload"}}(e);t&&(this._endEngagement=e,this._report(t))}else"ItemsView.Load"===e.name&&("101"!==e.listTemplateId&&"700"!==e.listTemplateId&&"Recent"!==e.objectType&&"Files-RecentSpartan"!==e.currentPage&&"Files-Home"!==e.currentPage&&"SharedWithMe"!==e.objectType&&"Files-SharedWithMeSpartan"!==e.currentPage&&"SharedByMe"!==e.objectType&&"Files-SharedByMeSpartan"!==e.currentPage&&"Files-Favorites"!==e.currentPage&&"Files-Meetings"!==e.currentPage&&"Files-People"!==e.currentPage&&"Files-MeetingsL2"!==e.currentPage&&"Files-PeopleL2"!==e.currentPage||(this._startEngagement=e))},e.prototype._report=function(e){this._startEngagement&&this._endEngagement&&(pe.e.logData(Object(i.__assign)(Object(i.__assign)({},this._endEngagement),{action:e,name:"TimeToFile",isIntentional:!0,extraData:Object(i.__assign)(Object(i.__assign)({"TimeToFile.Duration":performance.now()},this._endEngagement.extraData),Object(Fe.t)(this._startEngagement.extraData||{},function(e){return e},function(e){return"extraData"===e?void 0:"entry.".concat(e)}))})),this._hasReported=!0)},e}(),Ne=Object(j.r)("TimeToFileResporter",Re,{}),Be=n(76),je=n(134),Ve=new De.t({name:"SearchSession.key",factory:new De.e(je.e.generate())}),ze=n(158),Ge=n(253),Ke=n(23),We=Object(Ge.e)({eventName:"Page,",shortEventName:"Page"},{previousName:Ke.e.String,currentName:Ke.e.String}),qe=n(736),Qe=!Le.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),Ye={".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},Je=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t)||this;return a.searchSessionStarted=!1,a._dataStore=new me.e("",_e.e.session),a._instrumentationDataSource=n.instrumentationDataSource||a.resources.consume(V.m.optional),a._pageEvent=void 0,a._engagement=n.engagement||a.resources.consume(ze.e),a._searchSession=n.searchSession||a.resources.consume(Ve.optional),a._timeToFileReporter=n.timeToFileReporter||a.resources.consume(Ne),a}return Object(i.__extends)(t,e),t.prototype.logStartSearchOnSubmit=function(){var e,t;if(!this.searchSessionStarted){var n={name:"StartSearchSession",location:"NA",usageType:Ue.e[Ue.e.Click],currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{searchSessionId:this._searchSession}};this._startSearchSession(),this._engagement.logData(n)}null===(t=null===(e=this._instrumentationDataSource)||void 0===e?void 0:e.onSearchStarted)||void 0===t||t.call(e)},t.prototype.currentPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.currentName},t.prototype.previousPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.previousName},t.prototype.userViewPage=function(e){var t=e.name,n="(none)";this._pageEvent&&(n=this._pageEvent.data.currentName,this._pageEvent.end(),this.userExecuteAction({name:"NavigatePage"})),this._pageEvent=new We({currentName:t,previousName:n}),this._engagement.logData({name:"Page.View",location:"NA",usageType:Ue.e[Ue.e.Click],currentPage:t,previousPage:n,extraData:this._getExtraData(t,e)})},t.prototype.userSeeItem=function(e){var t,n;this._instrumentationDataSource&&(this._instrumentationDataSource.userSeeItem(e),Object(Be.e)(e.queryType)&&(null===(n=(t=this._instrumentationDataSource).logSearchResultsRendered)||void 0===n||n.call(t)))},t.prototype.userExecuteAction=function(e){this._instrumentationDataSource&&this._instrumentationDataSource.userExecuteAction(e),this._timeToFileReporter&&this._timeToFileReporter.trackUserAction({name:e.name,currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:this.getEngagementData()||{}})},t.prototype.userClickItem=function(e){var t=Pe.e[Pe.e.bingClickInstrumentation];if(Object(Be.e)(e.queryType)&&e.urls&&e.urls[t]){var n=new v.e({name:"SearchResultClickItem"});Te.e(e.urls[t]).done(function(){n.end({resultType:v.t.Success})},function(){n.end({resultType:v.t.Failure,extraData:{url:e.urls[t]}})})}this._logOfficeDocAge(e)},t.prototype.userClickSuggestion=function(e){if(e){var t=new v.e({name:"SearchSuggestionClickItem"});Te.e(e).done(function(){t.end({resultType:v.t.Success})},function(){t.end({resultType:v.t.Failure,extraData:{url:e}})})}},t.prototype.getEngagementData=function(e){return this._getExtraData(void 0,e)},t.prototype.logSearchResultsRendered=function(){var e,t;null===(t=null===(e=this._instrumentationDataSource)||void 0===e?void 0:e.logSearchResultsRendered)||void 0===t||t.call(e)},t.prototype._getExtraData=function(e,t){return this._instrumentationDataSource?this._instrumentationDataSource.getEngagementData(e||this.currentPageName(),t):null},t.prototype._startSearchSession=function(){this.searchSessionStarted=!0},t.prototype._logOfficeDocAge=function(e){if(e&&e.dateModifiedValue)try{var t=e&&e.extension&&e.extension.toLowerCase();if(t){var n=Qe?Object(qe.e)(t):t,a=this._engagement;if(a.logData({name:"File.Clicked",currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{extension:n,size:e.size}}),"ms-word"===e.appMap||"ms-powerpoint"===e.appMap?this._dataStore.setValue("OfficeDocClickTime",new Date):this._dataStore.setValue("OfficeDocClickTime",""),Ye[t]){var i=new Date(e.dateModifiedValue),r=Math.ceil(((new Date).getTime()-i.getTime())/1e3);r>0&&a.logData({name:"OfficeDocument.Clicked",extraData:{extension:n,age:r,dateModified:e.dateModifiedValue}})}}}catch(e){}},t.dependencies=Object(i.__assign)(Object(i.__assign)({},ie.e.dependencies),{instrumentationDataSource:V.m.optional,engagement:ze.e,searchSession:Ve.optional,timeToFileReporter:Ne}),t}(ie.e),Xe=Je,Ze=(Object(j.r)("InstrumentationProvider",Je),n(535)),$e=n(40),et=n(95),tt=n(170),nt=n(114),at=n(268),it=n(242),rt=!Le.e.isActivated("8C62316A-3AF9-4CDB-875D-5C08EA8E7C21","02/24/2022","Stash ODC test hooks to window so that they persist throughout page load and in-app navigations"),ot=window.$Config&&window.$Config.isINT,st=1;Object(ce.isFeatureEnabled)(ce.EnableSecurityMomentLightbox)&&(st=2);var ct=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a._pendingRequests={},a._currentParamUpsells={},a._navigation=a.resources.consume(B.e),a}return Object(i.__extends)(t,e),t.prototype.canPersistUserInfo=function(){return!0},t.prototype.getCurrentParamUpsells=function(){return this._currentParamUpsells},t.prototype.setCurrentParamUpsells=function(e){this._currentParamUpsells=e},t.prototype.getAnid=function(){return et.e.getAnid()},t.prototype.getMarket=function(){return et.e.getMarket()},t.prototype.getLanguage=function(){return et.e.getLanguage()},t.prototype.isNewUser=function(){return et.e.isNewUser()},t.prototype.isAuthenticated=function(){return et.e.isAuthenticated()},t.prototype.getUserInfo=function(e){var t=this,n=Object(at.e)(),a=e?n+"?v="+Math.random():n,i=new $e.e;if(this._pendingRequests[n])return this._pendingRequests[n];if(!this.isAuthenticated()||!e&&this._cachedUserInfo)return I.n.wrap(this._cachedUserInfo);var r=i.send({apiName:"GetUserInfo",url:a}).then(function(e){if(delete t._pendingRequests[n],t._cachedUserInfo=e,e&&e.notifications)for(var a=0,i=e.notifications;a<i.length;a++){var r=i[a];7===r.type&&r.param&&(t._currentParamUpsells=JSON.parse(r.param))}if(e&&e.info)for(var o=0,s=e.info;o<s.length;o++){var c=s[o];24===c.type&&(t._positioningData=c)}return e},function(e){return delete t._pendingRequests[n],I.n.wrapError(e)});return this._pendingRequests[n]=r,r},t.prototype.setUserInfo=function(e){var t=Object(at.t)();return(new $e.e).sendPostUrlEncoded("SetUserInfo",t,JSON.stringify(e)).then(function(e){return!(!e||e.error)})},t.prototype.setUserInfoWithUserFacts=function(e,t,n,a,i){var r={type:e,action:t};return n&&(r.param=n),i&&(r.data=i),a&&(r.id=a),n&&7===e&&(this._currentParamUpsells=JSON.parse(n)),this.setUserInfo(r)},t.prototype.sendShowUpsell=function(e,t,n){return this._sendUpsell(e,t,n,"SHOWED")},t.prototype.sendCloseUpsell=function(e,t,n){return this._sendUpsell(e,t,n,"CLOSE")},t.prototype.resetUpsellUserFact=function(){return this.setUserInfoWithUserFacts(7,3,JSON.stringify({}))},t.prototype.handleUpdateUpsellData=function(e,t,n){var a=this.getUpsellVariationIfApplicable(e),i=this._currentParamUpsells[a.id];i?(t&&(i.d=1),n&&i.v++):this._currentParamUpsells[a.id]={d:t?1:0,v:n?1:0}},t.prototype.updateUpsellData=function(e,t,n){return this.handleUpdateUpsellData(e,t,n),this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))},t.prototype.hasUserFact=function(e){var t=this;return this.getUserInfo(!1).then(function(n){var a=!1;if(!t._cachedUserInfo)throw new Error("CachedUserInfo is not defined when trying to access user fact");return(a=t._cachedUserInfo.info.some(function(t){return t.type===e&&t.isSet}))||(a=t._cachedUserInfo.rewards.some(function(t){return t.type===e&&t.isSet})),a})},t.prototype.getUserFact=function(e){return this.getUserInfo(!1).then(function(t){if(t&&t.info)for(var n=t.info,a=0;a<n.length;a++)if(n[a].type===e)return n[a];return null})},t.prototype.getIsPremium=function(e){return this.getUserInfo(e).then(function(e){if(e&&e.info)for(var t=e.info,n=0;n<t.length;n++)if(35===t[n].type)return!0;return!1})},t.prototype.getUpsellToShow=function(e){var t=this._checkForParamOverrides();return null!==t?I.n.wrap(t):this.checkThrottle(tt.t[nt.e.OneRmO365Upsell]).then(function(e){return e?tt.t[nt.e.OneRmO365Upsell]:null})},t.prototype.getUpsellViewCount=function(e){var t=this,n=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var a=0;return t._currentParamUpsells[n.id]&&(a=t._currentParamUpsells[n.id].v),a},function(e){return null})},t.prototype.getUpsellDismissed=function(e){var t=this,n=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var a=!1;return t._currentParamUpsells[n.id]&&(a=!!t._currentParamUpsells[n.id].d),a},function(e){return null})},t.prototype.checkThrottle=function(e){var t=this._navigation.viewParams,n=this.getUpsellDismissed(e),a=this.getUpsellViewCount(e);return I.n.all({didUserDismiss:n,viewCount:a}).then(function(n){var a=n.didUserDismiss,i=n.viewCount;return null!==a&&null!==i&&e.checkThrottle({viewCount:i,didUserDismiss:a,viewParams:t,market:$Config.mkt})})},t.prototype.getUpsellIframeSrc=function(e,t){var n=this;return this.getUserInfo(!1).then(function(a){if(e.getUpsellIframeUrl)return n.getIsPremium(!1).then(function(a){return e.getUpsellIframeUrl({anid:n.getAnid(),market:$Config.mkt,override:0,isNewUser:n.isNewUser(),upsellUserId:$Config.upsellUserId,variationId:e.id,availableUpsells:tt.t,isO365:a,bytesAvailable:n._getTotalQuotaInBytes(t),bytesUsed:n._getQuotaUsedInBytes(t)})})})},t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?tt.t[e.variation]:e},t.prototype.getUpsellDismissedById=function(e,t){return I.n.wrap(void 0)},t.prototype.getUpsellViewCountById=function(e,t){return I.n.wrap(void 0)},t.prototype.markUpsellAsSeen=function(e){return I.n.wrap(void 0)},t.prototype.markUpsellAsDismissed=function(e){return I.n.wrap(void 0)},t.prototype.getFirstRunExperienceDismissed=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=!1;return e._currentParamUpsells[nt.e.FirstRunExperienceDialog]&&(n=!!e._currentParamUpsells[nt.e.FirstRunExperienceDialog].d),n},function(e){return!0})},t.prototype.getFirstRunExperienceViewCount=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=0,a=e._currentParamUpsells[nt.e.FirstRunExperienceDialog];return a&&(n=a.v),n})},t.prototype.updateFirstRunExperienceData=function(e,t){return this.handleUpdateFirstRunExperienceData(e,t),this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))},t.prototype.handleUpdateFirstRunExperienceData=function(e,t){var n=this._currentParamUpsells[nt.e.FirstRunExperienceDialog];n?(e&&(n.d=1),t&&n.v++):this._currentParamUpsells[nt.e.FirstRunExperienceDialog]={d:e?1:0,v:t?1:0}},t.prototype.hasPositioningBeenViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){return!!e._positioningData},function(e){return!0})},t.prototype.datePositioningViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._positioningData;if(t)return new Date(t.createdDate+"z")})},t.prototype.getPremiumUpsellsViewed=function(){return I.n.all({hasPositioningViewed:this.hasPositioningBeenViewed(),hasNewFeaturesViewed:this.getMostRecentNewFeaturesUpsellViewed()})},t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._positioningData;return!t||!!t.param&&JSON.parse(t.param).v>=st},function(e){return!0})},t.prototype.setPositioningUserFactWithParams=function(e){if(Object(ce.isFeatureEnabled)(ce.DisablePremiumUserFactUpdate))return I.n.resolve(!0);var t={v:0};return this._positioningData&&this._positioningData.param&&(t=JSON.parse(this._positioningData.param)),e&&(t.v=st),this.setUserInfoWithUserFacts(24,3,JSON.stringify(t),"78f745e2-e4f9-4734-8a08-454e12832a22")},t.prototype.getExpiringSharingLinksSeen=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=e._currentParamUpsells[nt.e.ExpiringSharingLinks];return n&&!!n.d},function(e){return!0})},t.prototype.setExpiringSharingLinksSeen=function(){var e=this._currentParamUpsells[nt.e.ExpiringSharingLinks];e?e.d=1:this._currentParamUpsells[nt.e.ExpiringSharingLinks]={d:1,v:1},this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))},t.prototype._checkForParamOverrides=function(){var e=this._navigation.viewParams,t=lt(it.e.upsellOverride,e);return t?tt.t[t]:(lt(it.e.resetUpsellParams,e)&&this.resetUpsellUserFact(),null)},t.prototype._getTotalQuotaInBytes=function(e){return e&&e.properties&&e.properties.quota&&e.properties.quota.total},t.prototype._getQuotaUsedInBytes=function(e){var t=this._getTotalQuotaInBytes(e);return t?t-e.properties.quota.remaining:null},t.prototype._sendUpsell=function(e,t,n,a){var i=new $e.e,r=ot?tt.n:tt.e,o={CampaignId:e.CampaignID,ContentId:e.MessageID,Id:t,Locale:n,Source:"OneDriveWebBanner",TransactionID:e.TransactionID,Type:0,UserAction:a},s="".concat(r,"api/v1/messaging/web/useraction?").concat(E.n(o));return i.sendPost("OneRM",s,"").then(function(e){return!0},function(e){return!1})},t}($.n),dt=ct;function lt(e,t){return rt?Object(it.t)(e,t):t[e]}Object(j.r)("UserInfoDataSource",ct);var ut=function(e){function t(t){var n=e.call(this,t)||this;return n._embedDataSource=n.resources.consume(V.o),n}return Object(i.__extends)(t,e),t.prototype.getEmbedInfo=function(e){return this._embedDataSource.getEmbedInfo(e)},t.prototype.createEmbedLink=function(e){return this._embedDataSource.createEmbedLink(e)},t}($.n),ft=Object(r.createContext)({});function pt(e){var t=e.diagnostics,n=e.children;return r.createElement(ft.Provider,{value:{diagnostics:t}},n)}var mt=n(423);function _t(e){var t,n,a=Object(r.useRef)(null),i=Object(r.useState)(null),o=i[0],s=i[1],c=Object(r.useState)(null),l=c[0],u=c[1],f=Object(r.useState)(null),p=f[0],m=f[1],h=e.bootstrapParams,b=Object(r.useContext)(ft).diagnostics,g=Object(r.useRef)(e.onStart),S=Object(r.useRef)(e.onSucceed),I=Object(r.useRef)(e.onFailed),x=Object(r.useRef)(e.onTimeout);return Object(r.useEffect)(function(){g.current=e.onStart,S.current=e.onSucceed,I.current=e.onFailed,x.current=e.onTimeout},[e.onStart,e.onSucceed,e.onFailed,e.onTimeout]),Object(r.useEffect)(function(){return function(){var e;if(a.current&&b){var t;null===(e=g.current)||void 0===e||e.call(g);var n=Date.now();b.update({bootState:_.JSApiBootStarted,officeInitializationTime:n,hostInitializeCallTime:n}),function(e,t,n){try{return t.UseV2?function(e,t,n){var a=new v.e({name:"WacHost.JsApiScriptBootstrap"}),i=D(t,n),r={host:{storageHostName:t.HostName,capabilities:t.capabilities},user:{id:t.UserId},bootstrapperUrl:t.BootstrapperUrl},o=Microsoft.Office[t.Application].createApplication(r),s={hostSessionId:t.HostSessionId},c=o.createSession(s),d={appUrl:t.ApplicationUrl,file:{name:t.FileName,getUrl:t.FileGetUrl,getUrlExpiry:t.FileGetUrlExpiry,size:t.FileSize,eTag:t.ETag,uniqueId:t.UniqueId},container:e,wopi:{source:t.WopiSrc,accessToken:t.AccessToken,expiry:t.AccessTokenExpiry},bootParams:{readOnly:t.ReadOnly,viewOnly:t.ViewOnly},ownerId:t.OwnerId,diagnostics:{entryPoint:n.entryPoint,userClickTime:n.userClickTime,hostPageNavigationStartTime:n.hostPageNavigationStartTime,hostPageFetchStartTime:n.hostPageFetchStartTime,hostPageResponseStartTime:n.responseStartTime,hostPageFirstFlushTime:n.hostPageFirstFlushTime,officeBootstrapperStartTime:n.officeBootstrapperStartTime,officeBootstrapperEndTime:n.officeBootstrapperEndTime,officeInitializationTime:n.officeInitializationTime,hostInitializeCallTime:n.hostInitializeCallTime,hostCompleteCallTime:void 0},sessionContext:t.SessionContext};return c.boot(d).then(function(e){var n;if(i&&(clearTimeout(i),i=null),"success"===e.completion){a.end({resultType:v.t.Success,resultCode:"JS API script bootstrap success"}),t.triggerLogEvent({bootState:_.JSApiBootSuccess,resultType:v.t.Success,resultCode:"Success"});var r=null===(n=c.diagnostics)||void 0===n?void 0:n.appInitDiagnostics,s={documentLoadedTime:null==r?void 0:r.documentLoadedTime,appCompletedTime:null==r?void 0:r.appCompletedTime};return{application:o,session:c,wacAppDiagnostics:s}}return a.end({resultType:v.t.Failure,resultCode:"JS API script bootstrap not completed",extraData:{error:e.error,completion:e.completion}}),t.triggerLogEvent({bootState:_.JSApiBootFailed,resultType:v.t.Failure,resultCode:"InitFailed",error:e.error}),Promise.reject(e.error)},function(e){return i&&(clearTimeout(i),i=null),a.end({resultType:v.t.Failure,resultCode:"JS API script bootstrap failure",extraData:{error:e}}),t.triggerLogEvent({bootState:_.JSApiBootFailed,resultType:v.t.Failure,resultCode:"InitFailed",error:e}),Promise.reject(e)})}(e,t,n):function(e,t,n){var a=new y.e,i=new v.e({name:"WacHost.JsApiScriptBootstrap"}),r=D(t,n),o={BootstrapperUrl:t.BootstrapperUrl,Container:e,SessionInformation:{HostName:t.HostName,HostSessionId:t.HostSessionId,UserId:t.UserId,OwnerId:t.OwnerId,SessionContext:t.SessionContext,SupportsCustomAuthConfig:t.capabilities.customAuthConfig,SupportsCommonFilePicker:t.capabilities.commonFilePicker,SupportsMoveToFolder:t.capabilities.moveToFolder},ApplicationUrl:t.ApplicationUrl,WopiPrecheckInfo:{DocUniqueId:t.UniqueId,ETag:t.ETag,FileName:t.FileName,FileGetUrl:t.FileGetUrl,FileGetUrlExpiry:t.FileGetUrlExpiry,FileSize:t.FileSize,ReadOnly:t.ReadOnly,ViewOnly:t.ViewOnly},WopiInfo:{WopiSrc:t.WopiSrc,AccessToken:t.AccessToken,AccessTokenExpiry:new Date(t.AccessTokenExpiry)},ApplicationCustomSettings:{UnifiedAppEnabled:t.AppEnabled},Diagnostics:{entryPoint:n.entryPoint,userClickTime:n.userClickTime,hostPageNavigationStartTime:n.hostPageNavigationStartTime,hostPageFetchStartTime:n.hostPageFetchStartTime,hostPageResponseStartTime:n.responseStartTime,hostPageFirstFlushTime:n.hostPageFirstFlushTime,officeBootstrapperStartTime:n.officeBootstrapperStartTime,officeBootstrapperEndTime:n.officeBootstrapperEndTime,officeInitializationTime:n.officeInitializationTime,hostInitializeCallTime:n.hostInitializeCallTime,hostCompleteCallTime:void 0},FnOnInitializeSuccess:function(e,n){r&&(clearTimeout(r),r=null),i.end({resultType:v.t.Success,resultCode:"JS API script bootstrap success"}),t.triggerLogEvent({bootState:_.JSApiBootSuccess,resultType:v.t.Success,resultCode:"Success"});var o={documentLoadedTime:null==n?void 0:n.documentLoadedTime,appCompletedTime:null==n?void 0:n.appCompletedTime};a.resolve({application:s,wacAppDiagnostics:o})},FnOnInitializeFailure:function(e){r&&(clearTimeout(r),r=null),i.end({resultType:v.t.Failure,resultCode:"JS API script bootstrap failure"}),t.triggerLogEvent({bootState:_.JSApiBootFailed,resultType:v.t.Failure,resultCode:"InitFailed",error:e}),a.reject(void 0)},FnOnAppModeSwitched:function(e){t.onModeSwitched({NewMode:e})},FnIsFeatureEnabled:t.capabilities.isFeatureEnabled},s=Microsoft.Office[t.Application].Application.InitializeWopiPending(o);return o.Diagnostics.hostCompleteCallTime=Date.now(),s.Complete(o.WopiInfo),a.getPromise()}(e,t,n)}catch(e){var a=(null==e?void 0:e.message)||"Error during JsApi initialize.";t.triggerLogEvent({bootState:_.JSApiBootFailed,resultType:v.t.Failure,resultCode:"BootException",errorInfo:a})}}(a.current,h,b.data).then(function(e){var n,i=e.application,r=e.session,o=e.wacAppDiagnostics;b.update({wacHostCompleteTime:Date.now(),wacAppDiagnostics:o}),t=function(){i&&i.Dispose&&(i.Dispose(),i=null)};var c=a.current.querySelector("iframe");s(c),u(i),m(r),null===(n=S.current)||void 0===n||n.call(S)},function(e){var t;b.update({wacHostCompleteTime:Date.now()}),null===(t=I.current)||void 0===t||t.call(I,e)}),b.update({bootState:_.JSApiBootPendingComplete});var i=function(){var e;(null===(e=b.data)||void 0===e?void 0:e.bootState)===_.JSApiBootPendingComplete&&h.triggerLogEvent({bootState:_.JSApiBootFailed,resultType:v.t.ExpectedFailure,resultCode:"UserNavAway",errorInfo:"User navigate away"})};return window.addEventListener("beforeunload",i),function(){window.removeEventListener("beforeunload",i),t&&t()}}}()},[b,h]),r.createElement(r.Fragment,null,r.createElement("div",{id:"WACContainer",ref:a}),r.createElement(mt.e,{targetOrigin:(t=h.ApplicationUrl,n=new d.t(t,{queryCaseInsensitive:!0}),n.getLeftPart(d.e.authority)),logOnly:h.UseV2,iframeElem:o,allowedOrigins:h.AllowedOrigins,migrationState:h.MigrationState}),r.createElement(mt.t,{application:l,session:p,migrationState:h.MigrationState}))}var ht=n(165);function bt(e){var t=e.context,n=e.eventType,a=e.handler,i=Object(ht.t)().dispatcher,o=Object(r.useCallback)(function(e){return a(e,t,i)},[a,t,i]);return Object(r.useEffect)(function(){if(i&&n)return i.addEventListener(n,o),function(){i.removeEventListener(n,o)}},[i,n,o]),null}var gt,vt=n(725),yt=n(168);!function(e){e.COB_UpdateUI="COB_UpdateUI",e.COB_SyncPageContext="COB_SyncPageContext"}(gt||(gt={}));var St=n(42),Dt=n(197),It=n(519),xt=n(500),Ct=n(282),Ot=function(e){function t(){var t=e.call(this)||this;return t._dataRequestor=t.resources.consume(It.e),t._urlDataSource=t.resources.consume(z.n),t}return Object(i.__extends)(t,e),t.prototype.getEmbedInfo=function(e){return Object(i.__awaiter)(this,void 0,I.n,function(){var t,n,a,r,o=this;return Object(i.__generator)(this,function(s){switch(s.label){case 0:return Object(ce.isFeatureEnabled)(ce.EnableGraphApiGetEmbedInfo)?[4,this.resources.consumeAsync(V.p)]:[3,3];case 1:return t=s.sent(),this._dataRequestor=new Ct.t({},{urlDataSource:{getApiBaseUrl:function(){return"https://graph.microsoft.com/beta"}},sessionManagementProvider:{getToken:function(){return Object(i.__awaiter)(o,void 0,I.n,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return t?[4,t.getGraphToken({})]:[3,2];case 1:return[2,e.sent()];case 2:return[2,I.n.reject("Could not retrieve identity data source")]}})})}}}),this._sharingService=new xt.e({},{dataRequestor:this._dataRequestor}),[4,this._sharingService.getPermissions(e.id)];case 2:return n=s.sent(),[2,this._parsePermissions(n)];case 3:return a=new $e.e,r=this._urlDataSource.getEmbedInfoUrl(e),[2,a.send({apiName:"GetEmbedInfo",url:r,useDefaultHeaders:!0,isErrorExpectedCallback:this._isExpected}).then(function(e){return{embedCode:e.embedCode,embedUrl:e.embedUrl,configuratorUrl:e.embedConfiguratorUrl}},function(e){return o._isExpected(e)?null:I.n.wrapError(e)})]}})})},t.prototype.createEmbedLink=function(e){var t=this,n={type:"embed"};return this._getItemUrl(e).then(function(e){var a="".concat(e,"/createLink");return t._dataRequestor.send({path:a,apiName:"createLink",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(n||{}),getErrorAsMessage:!0}).then(function(e){if(Object(ce.isFeatureEnabled)(ce.FixCustomizationOptionInEmbedDialog)){var t=e.link,n=void 0===t?{}:t,a=n.webHtml,i=void 0===a?"":a,r=n.webUrl,o=void 0===r?"":r,s=n.configuratorUrl;return{embedCode:i,embedUrl:o,configuratorUrl:void 0===s?"":s}}var c=e.link,d=void 0===c?{}:c,l=d.webHtml,u=(i=void 0===l?"":l,d.webUrl);return{embedCode:i,embedUrl:o=void 0===u?"":u}})})},t.prototype._parsePermissions=function(e){for(var t,n=0,a=e;n<a.length;n++){var i=a[n];if("embed"===(null===(t=i.link)||void 0===t?void 0:t.type)){if(Object(ce.isFeatureEnabled)(ce.FixCustomizationOptionInEmbedDialog)){var r=i.link,o=r.webHtml,s=void 0===o?"":o,c=r.webUrl,d=void 0===c?"":c,l=r.configuratorUrl;return{embedCode:s,embedUrl:d,configuratorUrl:void 0===l?"":l}}return{embedCode:i.link.webHtml,embedUrl:i.link.webUrl}}}},t.prototype._isExpected=function(e){return e&&e.data&&3017===e.data.code},t.prototype._getItemUrl=function(e,t){return I.n.resolve(this.resources.consumeAsync(V.f).then(function(n){return n.getItemUrl(e,{apiVersion:t})}))},t}($.n),wt={EnableWacJsApiV2:{ODC:"EnableWacJsApiV2"},EnableWacOfficeWebLoader:{ODC:"EnableWacOfficeWebLoader"},EnableWacUnifiedApps:{ODC:"EnableWacUnifiedApps"},Word:{WacHostFlightWordWordJsApiV2NoWrapper:{ODC:"Wac_HostFlight_Word_WordJsApiV2NoWrapper"},WacHostFlightWordWordJsApiV2:{ODC:"Wac_HostFlight_Word_WordJsApiV2"},WacHostFlightWordODCShareLinkPreload:{ODC:"Wac_HostFlight_Word_ODCShareLinkPreload"},WacHostFlightWordWordScriptsPreload:{ODC:"Wac_HostFlight_Word_WordScriptsPreload"},WacJsApiWordView:{ODC:"Wac_JsApi_Word_View"},WacJsApiWordEdit:{ODC:"Wac_JsApi_Word_Edit"},WacJsApiWordEditNew:{ODC:"Wac_JsApi_Word_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedWord:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Word"}},Excel:{WacHostFlightExcelExcelJsApiV2NoWrapper:{ODC:"Wac_HostFlight_Excel_ExcelJsApiV2NoWrapper"},WacHostFlightExcelExcelJsApiV2:{ODC:"Wac_HostFlight_Excel_ExcelJsApiV2"},WacHostFlightExcelExcelLandingPageOfflineTelemetry:{ODC:"Wac_HostFlight_Excel_ExcelLandingPageOfflineTelemetry"},WacHostFlightExcelInstantShell:{ODC:"Wac_HostFlight_Excel_InstantShell"},WacHostFlightExcelODCShareLinkPreload:{ODC:"Wac_HostFlight_Excel_ODCShareLinkPreload"},WacHostFlightExcelExcelAdaptiveLayoutDownload:{ODC:"Wac_HostFlight_Excel_ExcelAdaptiveLayoutDownload"},WacHostFlightExcelExcelLandingPageObserver:{ODC:"Wac_HostFlight_Excel_ExcelLandingPageObserver"},WacJsApiExcelView:{ODC:"Wac_JsApi_Excel_View"},WacJsApiExcelEdit:{ODC:"Wac_JsApi_Excel_Edit"},WacJsApiExcelEditNew:{ODC:"Wac_JsApi_Excel_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedExcel:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Excel"}},PowerPoint:{WacHostFlightPowerPointPowerPointJsApiV2NoWrapper:{ODC:"Wac_HostFlight_PowerPoint_PowerPointJsApiV2NoWrapper"},WacHostFlightPowerPointPowerPointJsApiV2:{ODC:"Wac_HostFlight_PowerPoint_PowerPointJsApiV2"},WacHostFlightPowerPointODCShareLinkPreload:{ODC:"Wac_HostFlight_PowerPoint_ODCShareLinkPreload"},WacJsApiPowerPointView:{ODC:"Wac_JsApi_PowerPoint_View"},WacJsApiPowerPointEdit:{ODC:"Wac_JsApi_PowerPoint_Edit"},WacJsApiPowerPointEditNew:{ODC:"Wac_JsApi_PowerPoint_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedPowerPoint:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_PowerPoint"}},OneNote:{WacHostFlightOneNoteOneNoteJsApiV2NoWrapper:{ODC:"Wac_HostFlight_OneNote_OneNoteJsApiV2NoWrapper"},WacHostFlightOneNoteOneNoteJsApiV2:{ODC:"Wac_HostFlight_OneNote_OneNoteJsApiV2"},WacHostFlightOneNoteODCShareLinkPreload:{ODC:"Wac_HostFlight_OneNote_ODCShareLinkPreload"},WacJsApiOneNoteView:{ODC:"Wac_JsApi_OneNote_View"},WacJsApiOneNoteEdit:{ODC:"Wac_JsApi_OneNote_Edit"},WacJsApiOneNoteEditNew:{ODC:"Wac_JsApi_OneNote_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedOneNote:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_OneNote"}},Visio:{WacHostFlightVisioVisioJsApiV2NoWrapper:{ODC:"Wac_HostFlight_Visio_VisioJsApiV2NoWrapper"},WacHostFlightVisioVisioJsApiV2:{ODC:"Wac_HostFlight_Visio_VisioJsApiV2"},WacHostFlightVisioODCShareLinkPreload:{ODC:"Wac_HostFlight_Visio_ODCShareLinkPreload"},WacJsApiVisioView:{ODC:"Wac_JsApi_Visio_View"},WacJsApiVisioEdit:{ODC:"Wac_JsApi_Visio_Edit"},WacJsApiVisioEditNew:{ODC:"Wac_JsApi_Visio_EditNew"},EnableWacUseOpenUrlInPlaceOfEditForUnifiedVisio:{ODC:"EnableWacUseOpenUrlInPlaceOfEditForUnified_Visio"}},WacSendPerformanceLog:{ODC:"WacSendPerformanceLog"}};function Et(e,t,n){var a=e.replace(/_/g,"").replace(/\{0\}/g,t).replace(/\{1\}/g,n);return wt[t][a]}function At(e){return!!e&&Object(de.es)(e)}var Lt,kt={ODC:!Le.e.isActivated("528C4A31-D086-4ED5-A4C1-A9049215C434","05/31/2023","enable use cache for wac item")},Mt={ODC:"EnableGetItemInShares"},Pt={ODC:"EnableBadgerCookieForWac"},Tt=n(156),Ut=n(236),Ft=n(387),Ht=n(567),Rt=n(224),Nt=n(222),Bt=n(79),jt=n(240),Vt=n(390),zt=n(723),Gt=n(38),Kt=n(96),Wt=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.storageOptionsData=n.createObservable(null),n._storageOptionsDataSource=n.resources.consume(V.T),n}return Object(i.__extends)(t,e),t.prototype.updateStorageOptions=function(e){if(void 0===e&&(e=!1),!e&&this.storageOptionsData.peek())return I.n.wrap(this.storageOptionsData.peek());var t=new v.e({name:"GetUpgradeOptionsRetry"});return this._storageOptionsHelper(0,t)},t.prototype._storageOptionsHelper=function(e,t){var n=this;return e<=7?this._storageOptionsDataSource.getStorageOptions().then(function(a){return t.end({resultType:v.t.Success,extraData:{retries:e}}),n.storageOptionsData(a),a},function(a){a.data&&159===a.data.code?n.async.setTimeout(function(){n._storageOptionsHelper(e+1,t)},1e3):t.end({resultType:v.t.Failure,extraData:{retries:e}})}):void t.end({resultType:v.t.Failure,extraData:{retries:e}})},t}($.n),qt=107374182400,Qt=function(e){function t(t){var n=e.call(this,t)||this;return n._storageOptionsDataSource=n.resources.consume(V.T),n._storageOptionsRequestor=new(n.managed(Wt)),n._storageOptionsRequestor.updateStorageOptions(),n.isReady=n.createPureComputed(n._computeIsReady),n.isEligibleForPremium=n.createPureComputed(n._computeIsEligibleForPremium),n.isEligibleForOneDrivePlan=n.createPureComputed(n._computeIsEligibleForOneDrivePlan),n.isEligibleFor100Gbplan=n.createPureComputed(n._computeIsEligibleFor100GbPlan),n.hasOffice=n.createPureComputed(n._computeHasOffice),n.hasStoragePlan=n.createPureComputed(n._computeHasStoragePlan),n._data=n.createPureComputed(function(){return n._storageOptionsRequestor.storageOptionsData()}),n}return Object(i.__extends)(t,e),t.prototype.getStorageOptions=function(e){return void 0===e&&(e=!0),!e&&this._data()?I.n.wrap(this._data()):this._storageOptionsDataSource.getStorageOptions()},t.prototype.getPremiumPurchaseInformation=function(e){var t=this;return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){var n=t._parsePremiumPlans(e),a=n[0],i=n[1];return a&&a.pricePerMonth?t._getPurchaseInfo(a,!0,!0):i&&i.pricePerMonth?t._getPurchaseInfo(i,!0,!1):a&&a.pricePerYear?t._getPurchaseInfo(a,!1,!0):i&&i.pricePerYear?t._getPurchaseInfo(i,!1,!1):void 0})},t.prototype.getHasCurrentOfficePlan=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){return e.hasCurrentOfficePlan})},t.prototype.getIsEligibleForPremium=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,n=e.officePlans;t<n.length;t++){var a=n[t];if(Kt.e[a.type]===Kt.e.Home||Kt.e[a.type]===Kt.e.Personal||Kt.e[a.type]===Kt.e.Solo)for(var i=0,r=a.purchaseActions;i<r.length;i++){var o=r[i];if(1===o.durationInMonths||12===o.durationInMonths)return!0}}}return!1})},t.prototype._getHasBiggestOneDrivePlan=function(){var e,t=this._data(),n=t.oneDrivePlans,a=t.hasCurrentOfficePlan,i=null!==(e=null==n?void 0:n.length)&&void 0!==e?e:0;return!(!a||i<1)&&n[i-1].isCurrentPlan},t.prototype._areOneDrivePlansAvailable=function(){var e=this._data().oneDrivePlans;return!!e&&e.length>0},t.prototype._hasPlanWith100GBOrMore=function(){var e=this._data().storagePlans;if(null!==e){for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a.isCurrentPlan&&a.durationInMonths>0)return a.planQuotaBytes>=qt}return!1}return null},t.prototype._getPurchaseInfo=function(e,t,n){e.market=this._data().market;var a=t?e.secondaryOfficePlanUrl:e.mainOfficePlanUrl;return{price:t?e.pricePerMonth:e.pricePerYear,purchaseUrl:a,planName:e.type,planType:n?Kt.e.Personal:Kt.e.Home}},t.prototype._parsePremiumPlans=function(e){var t,n;if(e&&e.officePlans)for(var a=0,i=e.officePlans;a<i.length;a++){var r=i[a];if(Kt.e[r.type]!==Kt.e.Trial){for(var o=0,s=r.purchaseActions;o<s.length;o++){var c=s[o];1===c.durationInMonths&&(r.pricePerMonth=c.price,r.secondaryOfficePlanUrl=c.purchaseUrl),12===c.durationInMonths&&(r.pricePerYear=c.price,r.mainOfficePlanUrl=c.purchaseUrl)}Kt.e[r.type]===Kt.e.Home?t=r:n=r}}return[n,t]},t.prototype._computeIsEligibleForPremium=function(){var e=this._data();if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,n=e.officePlans;t<n.length;t++){var a=n[t];if(Kt.e[a.type]===Kt.e.Home||Kt.e[a.type]===Kt.e.Personal||Kt.e[a.type]===Kt.e.Solo)for(var i=0,r=a.purchaseActions;i<r.length;i++){var o=r[i];if(1===o.durationInMonths||12===o.durationInMonths)return!0}}return!1}},t.prototype._computeIsEligibleForOneDrivePlan=function(){return!(!this.hasOffice()||!this._areOneDrivePlansAvailable()||this._getHasBiggestOneDrivePlan())},t.prototype._computeIsEligibleFor100GbPlan=function(){var e,t=this._data(),n=null===(e=null==t?void 0:t.storagePlans)||void 0===e?void 0:e.find(function(e){return e.planQuotaBytes===qt&&1===e.durationInMonths});return!(!(null==n?void 0:n.price)||!(null==n?void 0:n.purchaseUrl)||this.hasOffice()||this.hasStoragePlan())},t.prototype._computeHasOffice=function(){var e=this._data();if(e)return e.hasCurrentOfficePlan},t.prototype._computeHasStoragePlan=function(){var e=this._data();if(e)return!!e.hasCurrentStoragePlan||this._hasPlanWith100GBOrMore()},t.prototype._computeIsReady=function(){return!!this._data()},t}($.n),Yt=n(493),Jt=n(343),Xt=n(10),Zt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="Unsupported",t}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!1},t}(Xt.e),$t=Zt,en=n(420),tn=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ExternalNavigate",n._item=t.item,n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e){var t=this,n=window.open("","_blank"),a=this._item.peek();return I.n.resolve(this.resources.consumeAsync(z.n)).then(function(e){var i;return(i=t._isOfficeItem()&&a.openUrl?a.openUrl:e.getItemUrl(a.key,{item:a}))?(n.location.href=i,{resultType:v.t.Success}):(n.close(),{resultType:v.t.Failure})})},t.prototype._isOfficeItem=function(){var e=this._item.peek(),t=e.extension&&e.extension.replace(/^\./,"");return t&&en.t[t]&&".pdf"!==e.extension},t}(Xt.e),nn=n(21),an=n(29);!function(e){e[e.DefaultClick=0]="DefaultClick",e[e.OpenInOfficeOnline=1]="OpenInOfficeOnline",e[e.OpenFileLocation=2]="OpenFileLocation",e[e.OpenItemActivityItem=3]="OpenItemActivityItem",e[e.OpenPdfInBrowser=4]="OpenPdfInBrowser"}(Lt||(Lt={}));var rn=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.item,i=t.openRelation,r=void 0===i?0:i,o=t.actionType;return n.name="OpenInDesktop",n._itemSelectionHelper=new(n.child(nn.e))({overrideItem:2===r?a:void 0,allowMultiSelect:!1,canFallback:0!==r,ignoreSelection:0!==r}),n._urlDataSource=n.resources.consume(V.H),n._actionType=o,n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem(),a={id:n.id,name:n.name,actionType:Lt[this._actionType],queryType:Y.e[n.queryType],itemType:an.e[n.type],openUrl:n.openUrl,parentUrl:n.parentLink,shortcutUrl:n.urls[Pe.e.shortcutTarget],siteUrl:this._urlDataSource.getCurrentSiteUrl(),fullItemUrl:this._urlDataSource.getItemUrl(n.key),extension:n.extension};return window.external.notify(JSON.stringify(a)),I.n.wrap({resultType:v.t.Success})},t}(Xt.e),on=n(75),sn=n(25),cn=n(51),dn=n(24),ln=new dn.e("removeFromRecent"),un=new dn.e("addCoverPhoto"),fn=new dn.e("removeCoverPhoto"),pn=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="AddCoverPhotoAction",a._itemReedemer=a.resources.consume(on.e),a._itemCommandHelper=new(a.managed(sn.e)),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e,t=this;if(!Object(de.es)(ce.EnableSetAsCoverForFolderInCob)&&Object(Gt.e)(xe.H))return!1;var n=this._itemSelectionHelper.currentItem(),a=null===(e=null==n?void 0:n.vault)||void 0===e?void 0:e.root;return n.queryType!==Y.e.Search&&n.queryType!==Y.e.SharedWithMe&&!a&&(!n.isBundle||!!n.isAlbum)&&this._itemSelectionHelper.filterItems(function(e){return t._itemCommandHelper.isCommandSupported(e,un)})},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n,a=t.resources.consume(cn.resourceKey),i=e[0].UNSAFE_parent;if(Object(de.es)(de.po)){var r=e[0],o=(null==r?void 0:r.parentKey)&&Object(xe.h)(r.parentKey);n={key:e[0].parentKey,id:o.id}}return a.addCoverPhotos({items:e,target:i||n,itemsScopeInvalidate:!!n}).then(function(){return{resultType:v.t.Success}})})]:[2,I.n.resolve({resultCode:"EmptySelection",resultType:v.t.Failure})]}})})},t}(Xt.e),mn=n(37),_n=n(473),hn=(new dn.e("play"),new dn.e("rotate")),bn=new dn.e("editCaption"),gn=new dn.e("editTags"),vn=new dn.e("removeTags"),yn=new dn.e("viewOriginal"),Sn=new dn.e("applyOfficeLens"),Dn=new dn.e("removeOfficeLens"),In=new dn.e("addToAlbum"),xn=new dn.e("removeFromAlbum"),Cn=new dn.e("addPhotosToAlbum"),On=!fe.e.isActivated("B8D2D2A7-E86C-4603-A180-25887F432C8C","",""),wn=!fe.e.isActivated("12240148-D376-40BA-91CD-7D460F2D6DA2","04/18/2022","Disable AddToAlbumAction in vault since it is not working, because of access denied"),En=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="AddToAlbum",n._panelProvider=n.resources.consume(_n.e),n._urlDataSource=n.resources.consume(V.H),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./AddToAlbumExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([5,"ondemand.resx-ondemand"],1738))}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper,panelProvider:this._panelProvider,urlDataSource:this._urlDataSource}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}},t.prototype.onIsAvailable=function(){if(!Object(ce.isFeatureEnabled)(ce.EnableAddToAlbum)&&!0===Object(Gt.e)(St.s))return!1;var e=this.selectionHelper.firstItem(),t=null==e?void 0:e.vault;return!(wn&&t)&&(!On||(null==e?void 0:e.ownerId)&&Object(xe.M)(e.ownerId))&&this.itemCommandHelper.isCommandSupported(e,In)&&e.queryType!==Y.e.RecycleBin},t}(mn.e),An=n(118),Ln=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="AddToFolderAction",n._itemParentHelper=n.resources.consume(An.e),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./AddToFolderExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([7,"ondemand.resx-ondemand"],1670))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault","root"));return!!t&&!t.vault.isLocked},t}(mn.e),kn=n(62),Mn=n(235),Pn=n(108);Object(Pn.e)([{rawString:".FolderTypeEditor-option+.FolderTypeEditor-option{margin-top:10px}"}]);var Tn,Un=n(98);!function(e){e[e.documents=0]="documents",e[e.photos=1]="photos",e[e.favorites=2]="favorites"}(Tn||(Tn={}));var Fn,Hn=Tn,Rn=n(17),Nn=function(e){function t(t){var n=e.call(this,t)||this;return n.infoPaneResx=Mn,n.category=t.category,n.typeDocuments=Hn[Hn.documents],n.typePhotos=Hn[Hn.photos],n.categoryText=Rn.observable(Hn[n.category()]),n.subscribe(n.categoryText,function(){n.category(Hn[n.categoryText()])}),n}return Object(i.__extends)(t,e),t}(Un.e),Bn=n(99),jn=Bn.e({tagName:"ms-folder-type-editor",template:'<div class="FolderTypeEditor"><div class="FolderTypeEditor-option"><div class="ms-RadioButton"><input class="ms-RadioButton-input" type="radio" name="folderType" id="folderTypeDocuments" data-bind="attr:{value:typeDocuments},checked:categoryText"><label for="folderTypeDocuments" class="ms-RadioButton-field"><span class="od-Label" data-bind="text:infoPaneResx.informationFolderTypeDocuments"></span></label></div></div><div class="FolderTypeEditor-option"><div class="ms-RadioButton"><input type="radio" name="folderType" id="folderTypePhotos" value="photos" data-bind="attr:{value:typePhotos},checked:categoryText" class="ms-RadioButton-input"><label for="folderTypePhotos" class="ms-RadioButton-field"><span class="od-Label" data-bind="text:infoPaneResx.informationFolderTypePhotos"></span></label></div></div></div>',viewModel:Nn,synchronous:!0}),Vn=n(82),zn=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="ChangeFolderType",a._itemProvider=a.resources.consume(cn.resourceKey),a._urlDataSource=a.resources.consume(V.H),a._identityDataSource=a.resources.consume(V.p),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!Le.e.isActivated("B93166B0-4771-4455-90F3-5E582AF8CF19","10/21/2021","Disable change folder type"))return!1;var e=this._itemSelectionHelper.firstItem(),t=this._identityDataSource.getIdentity();return!(!e||!t||void 0===e.queryType||t.type===re.e.anonymous||void 0===e.category||this._urlDataSource.isRecycleBin(e.queryType))},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var e,t,n,a=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=i.sent())?(t=e.category,n=this.observables.create(t),[2,this.resources.consume(Vn.e).requestDialog({title:Mn.informationChangeFolderTitle,component:{name:jn.tagName,params:{category:n}},actions:[{name:Mn.informationSave,execute:function(){return I.n.resolve(2)},isAvailable:this.createComputed(function(){return e.category!==n()}),isDefault:!0,icon:new kn.e("Save"),automationId:"changeFolderTypeSave"}]}).wait().then(function(){return a._itemProvider.changeFolderType({category:n(),item:e}).then(function(){return{resultType:v.t.Success}})})]):[2,I.n.resolve({resultCode:"EmptySelection",resultType:v.t.Failure})]}})})},t}(Xt.e),Gn=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="ClearSelection";var i=a.resources;return a._urlDataSource=i.consume(V.H),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!0,canFallback:!1}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper,t=this._urlDataSource,n=t.getKeyParams(e.currentItem().key),a=t.getQueryType(n);return e.selection().length>0&&!t.isRecycleBin(a)},t.prototype.onExecute=function(e,t){return this._itemSelectionHelper.clearSelection(),I.n.resolve({resultType:v.t.Success})},t}(Xt.e),Kn=n(179),Wn=n(30),qn=n(518),Qn=n(43),Yn=n(68),Jn=n(738),Xn=n(53),Zn=new De.t({name:"".concat("CreateDocumentAction",".createItemOperator"),loader:new j.t(function(){return I.n.resolve(n.ee([85],1671)).then(function(e){return e.typeResourceKey})})}),$n=function(e){function t(t){var n=e.call(this,t)||this;return n._isRunningTABTest=!1,n.docType=t.docType,n.templateUrl=t.templateUrl,n.name="Create"+(Wn.e[n.docType]||"")+"DocumentAction",n.navigation=n.resources.consume(B.e),n.itemProvider=n.resources.consume(cn.resourceKey),n._dialogProvider=n.resources.consume(Vn.e),n.platformDetection=n.resources.consume(Yn.e),n.redirect=!0,n.openInNewTab=!1,n.askForFileName=n.docType===Wn.e.OneNote,n._isOneDriveWinApp=Object(Xn.e)(),"true"===window.sessionStorage.getItem("_isRunningTABTest")&&(n._isRunningTABTest=!0),n}return Object(i.__extends)(t,e),t.prototype.createDocument=function(e,t){var n=this,a=this.navigation,i=this.itemProvider,r=null,o=i.createDocument(e.key,this.docType,t,this.templateUrl).then(function(e){return e&&(r=e),I.n.wrap({resultType:v.t.Success})});return o.done(function(e){r&&!window._isRunningTABTest&&n.async.setImmediate(function(){return a.navigateTo({url:r,frameId:n.openInNewTab?"_blank":null})})}),o},t.prototype.onIsAvailable=function(){return!(this.platformDetection.isMobile&&!this.platformDetection.isIPad||this._isOneDriveWinApp)&&this.item().queryType===Y.e.Files},t.prototype.isCommandSupported=function(){return!0},t.prototype.onExecute=function(e,t){return this.isCommandSupported()?this.onExecuteCore():I.n.wrap({resultType:v.t.Success})},t.prototype.onExecuteCore=function(){if(!this._isCreatingFile){var e=this.item.peek();return this.askForFileName?this._createDocumentWithDialog(e):this.createDocument(e)}},t.prototype.onCreateDocumentPromise=function(e,t,n){return null},t.prototype.createNewFile=function(e,t){var n=this;return I.n.resolve(this.resources.consumeAsync(Zn)).then(function(t){var a=new t({fileName:e,parentItem:n.item.peek()});return n.trackPromise(a.start())})},t.prototype._createDocumentWithDialog=function(e){var t=this,n=this._dialogProvider,a=this.observables.create(""),i=this.observables.create(""),r=this.observables.create(!1),o=this.observables.create(!0),s=null,c=Object(Jn.t)(this.docType);this._isCreatingFile=!0;var d,l=function(e){return r(!0),o(!0),i(e),1},u=n.requestDialog({title:Object(Jn.e)(this.docType,Qn),isDismissable:this.docType!==Wn.e.Text||Object(ce.isFeatureEnabled)(ce.CreateDocumentPromptSameTab),component:{name:qn.e.tagName,params:{name:a,automationId:"createDocumentDialog",extension:c,status:i,hasError:r,isEnabled:o}},actions:[{name:Qn.CreateCommit,execute:function(){return i(Qn.Saving),o(!1),r(!1),n=t.docType===Wn.e.OneNote||t.docType===Wn.e.ExcelSurvey||t.docType===Wn.e.ExcelForm?a.peek():a.peek()+c,(d=t.onCreateDocumentPromise(t.docType,e,n))?d.then(function(e){return s=e,2},l):t.redirect?t.itemProvider.createDocument(e.key,t.docType,n,t.templateUrl).then(function(e){return s=e,2},l):t.createNewFile(n,e).then(function(){return 2},l);var n,d},isAvailable:this.observables.pureCompute(function(){return t._isCreateAvailable(o,a)}),isDefault:!0,icon:new kn.e("Save"),automationId:"createDocumentDialogCommit"}]}).wait().then(function(){return Object(ce.isFeatureEnabled)(ce.CreateDocumentPromptSameTab)&&t.docType!==Wn.e.Text&&(d=window.open("",t._isRunningTABTest?"_self":"_blank")),{resultType:v.t.Success}},function(){return{resultType:v.t.ExpectedFailure}});return u.done(function(){if(t._isCreatingFile=!1,s)if(d)d.location.href=s;else{var e=t.navigation;t.async.setImmediate(function(){return e.navigateTo({url:s,frameId:t.openInNewTab?"_blank":null})})}}),u},t.prototype._isCreateAvailable=function(e,t){if(!e())return!1;var n=t();return!!n&&" "!==n[0]},t}(Kn.e),ea=function(e){function t(t){var n=e.call(this,t)||this;return n._platform=n.resources.consume(Yn.e),n.formAction=t.formAction,n.canary=t.canary,n.target=t.target||(n._platform.isMobile?"":"_blank"),n}return Object(i.__extends)(t,e),t}(Un.e),ta=Bn.e({tagName:"ms-create-doc-form",template:'<form class="CreateDocumentForm" id="create_form" name="create_form" method="post" data-bind="attr:{action:formAction,target:target}"><input name="canary" type="hidden" data-bind="value:canary"></form>',viewModel:ea,synchronous:!0}),na=n(123);!function(e){e[e.Excel=1]="Excel",e[e.OneNote=2]="OneNote",e[e.PowerPoint=3]="PowerPoint",e[e.Word=4]="Word",e[e.Visio=5]="Visio",e[e.Project=6]="Project",e[e.Publisher=7]="Publisher"}(Fn||(Fn={}));var aa=Fn,ia=function(){var e,t,n,a,i,r,o,s,c,d="SharePoint.OpenDocuments.5",l="SharePoint.OpenDocuments.4",u="SharePoint.OpenDocuments.3",f="SharePoint.OpenDocuments.2",p="application/x-sharepoint",m="application/x-sharepoint-webkit",_="application/officelive",h="npSharePointPlugin",b="RoamingOfficeActiveX.RoamingOffice",g="",v={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4},y={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32},S={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4},D={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},I={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};function x(){return window.navigator.userAgent.indexOf("Windows")>=0}function C(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function O(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),n=-1;return null!=t&&t.length>=2&&(n=parseFloat(t[1]),isNaN(n)&&(n=-1)),n}function w(){return s||(s=!0,c=O("Windows Phone")),c>=8}function E(){return"function"==typeof navigator.msLaunchUri&&!C()&&!L()}function A(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function L(){return window.navigator.userAgent.indexOf("Edge/")>=0}function k(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function M(){return!!k()&&8==window.document.documentMode}function P(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function T(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")>=0}function U(){return(P()?H("firefox/"):0)>=3}function F(){return(window.navigator.userAgent.indexOf(" AppleWebKit/")>=0?H("version/"):0)>=3}function H(e){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf(e);if(n>=0){var a=n+e.length,i=t.length;return parseInt(t.substring(a,i))}return 0}function R(e,t,n){E()?navigator.msLaunchUri(e,t,n):!T()&&!(window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0)||L()?function(e,t,n){var a="OICFrame",i=document.getElementById(a);null==i&&((i=document.createElement("iframe")).className="ObjectInDialog",i.style.visibility="hidden",i.src="about:blank",document.body.appendChild(i),i.id=a);try{i.contentWindow.location.href=e}catch(e){return void(null!=n&&n())}null!=t&&t()}(e,t,n):function(e,t,n){var a="OICLinkTag",i=document.getElementById(a);null==i&&((i=document.createElement("a")).id=a,i.style.visibility="hidden",i.href="",i.target="_top",document.body.appendChild(i),null!=i.addEventListener&&i.addEventListener("click",function(e){null!=e.stopPropagation&&e.stopPropagation()},!1));try{i.href=e,i.click()}catch(e){return void(null!=n&&n())}null!=t&&t()}(e,t,n)}function N(e){return 0!=(e.Options&y.SkipProtocolHandler)||M()}function B(){return A()&&(U()||F())||U()}function j(e){return e===v.ReadOnly||e===v.ReadWrite}function V(e,t,n,a){var r=function(e){if(e!=I.OneNote&&C()&&!w())return"office:";switch(e){case I.Excel:return"ms-excel:";case I.OneNote:return"onenote:";case I.PowerPoint:return"ms-powerpoint:";case I.Visio:return"ms-visio:";case I.Word:return"ms-word:";case I.Project:return"ms-project:";case I.Publisher:return"ms-publisher:";case I.Infopath:return"ms-infopath:";case I.Access:return"ms-access:";default:return""}}(e);if(null==r)return ie(S.Unattempted,i.Application),!1;e==I.Visio&&n==v.ReadWrite&&(n=v.WriteOnly);var o=r;if(!(a=a||C()&&!w())){var s="";j(n)?s+="ofv|":s+="ofe|",o+=z(s+="u|")}return R(o+=z(t),G,K),!0}function z(e){if(A()&&T()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function G(){ae(D.ProtocolHandler)}function K(){i.Options|=y.SkipProtocolHandler,ne(i,e,t)}function W(){if(E())return!0;if(T())return void 0!==navigator.plugins.refresh&&navigator.plugins.refresh(),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(P()){var e=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(e);var t=document.createEvent("Events");return t.initEvent("RoamingOfficeInstalled",!0,!1),e.dispatchEvent(t),!!e.getAttribute("installed")}if(k())try{return new ActiveXObject(b).HrExists()}catch(e){}return!1}function q(e,t,n,a,i,r){Q(e,t,function(e){switch(e){case I.Excel:return"root\\office15\\excel.exe";case I.PowerPoint:return"root\\office15\\powerpnt.exe";case I.Visio:return"root\\office15\\visio.exe";case I.Word:return"root\\office15\\winword.exe";case I.Project:return"root\\office15\\winproj.exe";case I.Publisher:return"root\\office15\\mspub.exe";case I.Infopath:return"root\\office15\\infopath.exe";case I.Access:return"root\\office15\\msaccess.exe";default:return null}}(n),a,"x86",g,i,r)}function Q(e,t,i,r,o,s,c,d){var l="";if(null!=r&&(l+=" "+r),null!=e&&(l+=' "'+e+'"'),E()||T()){n=c,a=d;var u="office:";u+=' "'+s+'"',u+=' "'+i+'"',u+=' "ROAMING"',u+=' "'+t+'"',u+=' "'+o+'"',R(u+=" "+l,Y,J)}else if(P()){var f=document.createElement("RoamingExtensionElement");f.setAttribute("cabUrl",s),f.setAttribute("app",i),f.setAttribute("licensingEntitlements",t),f.setAttribute("platform",o),f.setAttribute("args",l),document.documentElement.appendChild(f);var p=document.createEvent("Events");p.initEvent("RoamingOfficeLaunch",!0,!1),f.dispatchEvent(p),null!=c&&c(D.RoamingFFExtension)}else if(k()){var m=new ActiveXObject(b);if(null!=m)try{m.HrConfigureSingle(s,i,t,o,l),null!=c&&c(D.RoamingActiveX)}catch(e){}}else null!=d&&d(S.Failed)}function Y(){null!=n&&n(D.RoamingProtocolHandler)}function J(){null!=a&&a(S.ControlNeeded)}function X(){var e=document.getElementById(h);if(null==e){var t=p;if(A()&&F()&&$(m)&&(t=m),!$(t)){if(!A()||!$(_))return null;t=_}var n=document.createElement("object");n.id=h,n.type=t,n.style.width="0px",n.style.height="0px",n.style.setProperty("visibility","hidden",""),document.body.appendChild(n),e=document.getElementById(h)}return e}function Z(e,t){var n=window.navigator.mimeTypes;if(null==n)return!1;var a=n[e];return!(!a||t&&!a.enabledPlugin)}function $(e){return Z(e,!0)}function ee(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function te(e){return e===I.OneNote?"OneNote.Notebook":""}function ne(n,a,s){if(i=n,e=a,t=s,n.DocumentUrl){var c,p=n.DocumentUrl;try{p=decodeURIComponent(n.DocumentUrl)}catch(e){}if(n.Mode===v.ReadWrite&&y.CheckoutRequired===(n.Options&y.CheckoutRequired)&&(n.Mode=v.ForceCheckout),y.HostIsEditOnly===(n.Options&y.HostIsEditOnly)&&(n.Mode=v.WriteOnly),function(e){return!N(e)&&(!!function(e){return A()&&(e.Application==I.OneNote||Z("application/x-sharepoint-protocolhandler",!1)||Z("application/x-sharepoint-webkit-protocolhandler",!1))}(e)||!!E()||!(B()||"ActiveXObject"in window&&!C()||T())||re()>=15)}(n))V(n.Application,n.DocumentUrl,n.Mode,n.Application==I.OneNote);else if(M()&&function(e,t,n,a){try{var i=new ActiveXObject(d);if(i)return i.ViewDocument3(window.self,e,t,a)}catch(e){}return!1}(p,n.Mode,n.Options,te(n.Application)))ae(D.O15ActiveX);else if(B()?c=function(e,t,n){var a=X();if(null==a)return S.Unattempted;var i=!1;try{i=a.ViewDocument3(window.self,e,t,n)}catch(e){}if(!i)try{i=j(t)?a.ViewDocument2(window.self,e,n):a.EditDocument2(window.self,e,n)}catch(e){}return i?(ae(D.NpapiPlugin),S.None):S.Failed}(p,n.Mode,te(n.Application)):(function(){try{var e=new ActiveXObject("IDBHO.IDBHOCtrl");null!=e&&e.SaveSSOCreds()}catch(e){}}(),c=function(e,t,n,a){var i;try{if(i=new ActiveXObject(l))return i.ViewDocument3(window.self,e,t,a)?(ae(D.O14ActiveX),S.None):S.Failed}catch(e){}if(y.O14Only===(n&y.O14Only))return S.Unattempted;try{if(i=new ActiveXObject(u))return i.ViewDocument3(window.self,e,t,a)?(ae(D.O12ActiveX),S.None):S.Failed}catch(e){}if(y.O12UpOnly===(n&y.O12UpOnly))return S.Unattempted;try{if(i=new ActiveXObject(f))return(j(t)?i.ViewDocument2(window.self,e,a):i.EditDocument2(window.self,e,a))?(ae(D.O11ActiveX),S.None):S.Failed}catch(e){}return S.Unattempted}(p,n.Mode,n.Options,te(n.Application))),c!=S.None){if(n.CouldUseRoamingApps&&(r||(r=!0,o=O("Windows NT")),o>=6.1&&!(window.navigator.userAgent.indexOf("ARM;")>=0)&&(k()||U()||T()))&&n.Application!=I.OneNote){if(!W())return void ie(S.ControlNeeded,i.Application);if(n.RoamingAppsLauncher)return void function(n){void 0!==n.RoamingAppsLauncher&&null!=n.RoamingAppsLauncher?void 0===n.RoamingBitsUrl||null==n.RoamingBitsUrl?q(n.DocumentUrl,n.RoamingAppsLauncher,n.Application,n.ApplicationParameters,e,t):Q(n.DocumentUrl,n.RoamingAppsLauncher,n.RoamingApplicationExe,n.ApplicationParameters,n.RoamingPlatform,n.RoamingBitsUrl,e,t):ie(S.Unattempted,i.Application)}(n);if(!n.ContinueIfLauncherIsNull)return void ie(S.LauncherNeeded,i.Application)}if(!(y.NoProtocolHandlerFallback==(n.Options&y.NoProtocolHandlerFallback)||N(n)||k()||A()&&c!=S.Unattempted))return void V(n.Application,n.DocumentUrl,n.Mode,n.Application==I.OneNote);ie(c,i.Application)}}else ie(S.Unattempted,i.Application)}function ae(t){null!=e&&e(t)}function ie(e,n){void 0===n&&(n=null),null!=t&&t(e,n)}function re(){var e=0;if(B()||T()){var t=X();try{null!=t&&(e=t.GetOfficeVersion())}catch(e){}}else ee(d)?e=15:ee(l)?e=14:ee(u)?e=12:ee(f)&&(e=11);return e}function oe(){return A()&&($(p)||$(m))}return{OpenDocumentMode:v,OpenDocumentOptions:y,OpenDocumentFailureType:S,OpenDocumentControl:D,OfficeApplication:I,EditDocumentInClient:ne,EditDocumentInClientParams:function(){this.DocumentUrl="",this.Mode=0,this.Options=0,this.Application=I.Unknown,this.CouldUseRoamingApps=!1,this.RoamingAppsLauncher="",this.ContinueIfLauncherIsNull=!1,this.ApplicationParameters="",this.RoamingPlatform="",this.RoamingApplicationExe="",this.RoamingBitsUrl=""},OfficeVersionInstalled:re,IsO14MacPluginInstalled:oe,OfferOfficeInDialog:function(){return x()&&re()<=11},OfferOfficeNoIntrusive:function(){return x()&&re()<15},OfferMacOffice:function(){return A()&&!(window.navigator.userAgent.indexOf("PPC Mac")>=0)&&!oe()},CanUseRoamingControl:W,InitUrls:function(e,t,n){g=e},LaunchRoamingApps:q,LaunchRoamingApps2:Q,ShouldShowDialog:function(){return!C()},IsInternetExplorer:k}}(),ra=n(52),oa=function(){function e(){}return e.executeOpenInClient=function(t,n){return e._item=t.item,e._provider=n.consume(cn.resourceKey),t.isDavUrl?(e._openInClient(t),I.n.wrap({resultType:v.t.Success})):e._getOpenInClientDetails(t)},e._getOpenInClientDetails=function(t){return e._provider.getOpenInClientDetails(e._item).then(function(n){if(n){var a=n.davUrl;t.url=a,t.isDavUrl=!0,e._openInClient(t)}return I.n.wrap({resultType:v.t.Success})})},e._openInClient=function(e){if(!e.useDirectInvoke){var t=ia.OpenDocumentMode.WriteOnly;e.item.sharingRole===ra.e.View&&(t=ia.OpenDocumentMode.ReadOnly),e.appType===aa[7].toString()&&(t=ia.OpenDocumentMode.WriteOnly);var n=ia.OpenDocumentOptions.None;e.Mode=t,e.Options=n;var a={DocumentUrl:e.url,Mode:t,Options:n,Application:ia.OfficeApplication[e.appType],ContinueIfLauncherIsNull:!0};ia.EditDocumentInClient(a,null,null)}},e}(),sa=n(85),ca=!Le.e.isActivated("6FFA2C0E-77D3-4E3F-9C8D-DD5834567BC5","05/20/2022","Invalidate itemCache as part of SkyApiHelper.refreshItemWhenVisible");function da(e,t,n){var a=function(){var e=window.document;return"hidden"in e?"":"msHidden"in e?"ms":"webkitHidden"in e?"webkit":"mozHidden"in e?"moz":void 0}(),i=a?a+"Hidden":"hidden",r=a+"visibilitychange",o=new sa.t({}),s=window.document;if(i){var c=function(){s[i]||(o.off(s,r,c),t.consume(cn.resourceKey).invalidateItem(e.key,{triggerFetch:n}),ca&&t.consume(na.a.lazy)&&t.consumeAsync(V.h).then(function(t){t.invalidateItems(e.key)}))};o.on(s,r,c)}}var la,ua=n(354),fa=n(90),pa=new dn.e("upload"),ma=new dn.e("download"),_a=(new dn.e("sync"),n(163)),ha=n(309),ba=n(111),ga=function(e){function t(t,n){var a=e.call(this,t,n)||this;return a._vroomDataRequestor=n.vroomDataRequestor,a}return Object(i.__extends)(t,e),t.prototype.create=function(e,t,n,a){var i=this;return a?t===Wn.e.OneNote?this.getCreateUrl(e,t,!0).then(function(t){var a={name:n,folder:{},package:{type:"oneNote"},"@microsoft.graph.conflictBehavior":"fail"};return i._vroomDataRequestor.send({apiName:"createFolder",path:t,requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(a),headers:{Prefer:"allow-zerobyte"}}).then(function(t){return i._invalidateItem(e),i._buildOpenUrl(t)},function(e){return I.n.reject(e.message)})}):this.getCreateUrl(e,t,!0).then(function(t){return i._vroomCreateDoc(t).then(function(t){return i._invalidateItem(e),i._setItemCache(t),i._buildOpenUrl(t)})}):this.getCreateUrl(e,t).then(function(e){return i._vroomCreateDoc(e).then(function(e){return e.webUrl})})},t.prototype.getCreateUrl=function(e,t,n){var a=this;if(n&&t===Wn.e.OneNote)return this.getGraphItemUrl(e,!1).then(function(e){return e+"/children"});var i="@name.conflictBehavior=defaultName";return Object(ce.isFeatureEnabled)(ce.EnableItemCacheCreateDocument)&&(i+="&action=edit&$select=*,openWith,webDavUrl"),this.getGraphItemUrl(e,!0).then(function(e){return(!n&&Object(ce.isFeatureEnabled)(ce.CreateDocumentToVroomOdf)||n&&Object(ce.isFeatureEnabled)(ce.CreateODFDocumentViaVroom)&&Object(ce.isFeatureEnabled)(ce.EnableCreateODFDocument)?I.n.resolve(a.resources.consumeAsync(V.i)).then(function(e){return e.getDocumentExtension(t).then(function(e){return e})}):I.n.resolve(Object(ha.e)(t))).then(function(t){return e+"/"+t+":/content?".concat(i)})})},t.prototype.getGraphItemUrl=function(e,t){return I.n.resolve(this.resources.consumeAsync(V.f)).then(function(n){return n.getItemUrl(e,{isPath:t,useDirectEndpoint:!0})})},t.prototype._vroomCreateDoc=function(e){return this._vroomDataRequestor.send({apiName:"CreateDocument",path:e,requestType:"PUT",useAuthorizationHeaders:!0,headers:{Prefer:"allow-zerobyte"}})},t.prototype._invalidateItem=function(e){this.resources.consumeAsync(V.h).then(function(t){e.key&&t.invalidateItems(e.key)})},t.prototype._setItemCache=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),Object(ce.isFeatureEnabled)(ce.EnableItemCacheCreateDocument)?[4,n.ee([163],1785)]:[3,2];case 1:t.sent().wacItemProvider.setItemCache(e,"createNew"),t.label=2;case 2:return[3,4];case 3:return t.sent(),[3,4];case 4:return[2]}})})},t.prototype._buildOpenUrl=function(e){var t,n=e.id,a=null===(t=e.parentReference)||void 0===t?void 0:t.driveId,i=new d.t(ba.o);return n&&i.setQueryParameter("resid",n,!0),a&&0===a.indexOf(ba.t)&&i.setQueryParameter("driveId".toLowerCase(),a,!0),i.setQueryParameter("nd","1",!0),i.toString()},t.dependencies=Object(i.__assign)(Object(i.__assign)({},$.n.dependencies),{vroomDataRequestor:ee.e}),t}($.n),va=Object(j.r)("CreateDocumentDataSource",ga,Object(i.__assign)(Object(i.__assign)({},$.n.dependencies),{vroomDataRequestor:ee.e})),ya=n(392),Sa=n(193),Da=n(44),Ia=n(109),xa=n(319),Ca=n(440),Oa=!Le.e.isActivated("0174E87A-4271-4BB2-9664-193F480AE6DB","01/24/2023","Enables various actions to redirect to sign in if attempted by an unauth user"),wa=!Le.e.isActivated("1097DC43-A3D7-4151-A119-48637C6D4534","04/05/2022","Fixes itemsscope + ko shim logic related to items with view-only permissions"),Ea=0,Aa=!1,La=function(e){function t(t){var n=e.call(this,t)||this;return n._enableCreateDocumentForCOB=!1,n.c_pathLimitError="folderPathLimitExceeded",n.c_accessDeniedError="accessDenied",n.c_pathLengthErrorLearnMoreLink="https://support.office.com/article/0b10108f-8459-4a7a-b912-28f8adec5a81",n._identityDataSource=n.resources.consume(G.e),n._itemDataSource=n.resources.consume(z.e),n._getHiddenDomProvider=n.resources.consume(ua.e.async.lazy),n._createDocumentDataSource=n.resources.consume(va),n._forceRedeem=!n.resources.consume(q._).isAuthenticated(),n._operationProvider=n.resources.consume(_a.e),n._itemCommandHelper=new(n.managed(sn.e)),n._itemReedemer=n.resources.consume(on.e),n.askForFileName=!!t.autoInvokedItem,t.docType===Wn.e.Text&&(n.redirect=!1),n._itemCommandKey=n._getItemCommandKey(n.docType),n.docType===Wn.e.ExcelSurvey&&Object(ce.isFeatureEnabled)(ce.RedirectExcelSurveysToFormsV2)&&(n.name="CreateFormsSurveyDocumentAction"),Object(ce.isFeatureEnabled)(ce.CreateDocumentToVroom)&&(n._vroomDocTypes=[Wn.e.Word,Wn.e.Excel,Wn.e.PowerPoint]),n}return Object(i.__extends)(t,e),t.prototype.onCreateDocumentPromise=function(e,t,n){if(this._enableCreateDocumentForCOB&&Object(Ca.t)(e,!0)){if(Le.e.isActivated("9744B736-537F-4A3E-9C11-B60273E2D1BA","07/01/2022","create onenote via vroom api")){var a=this._createDocumentForCOB(e,t,n);return I.n.resolve(null==a?void 0:a.toString())}return this._createDocumentDataSource.create(t,e,n,!0).then(function(e){return I.n.resolve(e)},function(e){return I.n.reject(e)})}return null},t.prototype.onIsAvailable=function(){var t=this.item();if(t&&t.vault&&t.vault.isLocked||!this._itemCommandKey)return!1;var n=this._itemCommandHelper.getCommandBehavior(t,this._itemCommandKey);return(wa&&n?1===n:this._itemCommandHelper.isCommandSupported(t,this._itemCommandKey))&&e.prototype.onIsAvailable.call(this)},t.prototype.onExecute=function(e,t){var n,a,i=this,r=this.item.peek();if(Oa&&!et.e.isAuthenticated()){var o=this.navigation;return o.navigateTo(K.e.getAutoRedeemLoginUrl(r.id,r.ownerId,this.name,o)),I.n.resolve({resultType:v.t.Success})}this._checkCreateDocumentForCOB(r);var s=Object(ce.isFeatureEnabled)(ce.CreateDocumentToVroom)&&-1!==this._vroomDocTypes.indexOf(this.docType);return Object(ce.isFeatureEnabled)(ce.UseItemsScopeInOneDrive)&&s&&!Aa&&!this._enableCreateDocumentForCOB?(this._isRunningTABTest?(n="_self",a=window.open("",n)):(n="newDocumentTab_".concat(Ea),a=window.open("",n),Ea++),Object(ce.isFeatureEnabled)(ce.CreateDocumentToVroomOdf)?this._executeAction(e,t,n,la,a):this._itemDataSource.getItem({parentKey:r.key,startIndex:0,pageSize:0,skipInMemoryCache:!0}).then(function(r){var o;return la=null===(o=null==r?void 0:r.item)||void 0===o?void 0:o.documentFormat,Aa=!0,i._executeAction(e,t,n,la,a)}).catch(function(){return i._executeAction(e,t,n,la,a)})):this._executeAction(e,t,void 0,la)},t.prototype._executeAction=function(t,n,a,i,r){var o=this,s=this.item.peek(),c=(1!==(i||(null==s?void 0:s.documentFormat))||Object(ce.isFeatureEnabled)(ce.CreateDocumentToVroomOdf))&&Object(ce.isFeatureEnabled)(ce.CreateDocumentToVroom)&&-1!==this._vroomDocTypes.indexOf(this.docType);return!c||a||this._enableCreateDocumentForCOB||(r=window.open("",this._getTargetId())),this._itemReedemer.redeemItem(s,this,this._forceRedeem).then(function(){var i=o._itemDataSource;if(o.askForFileName)return e.prototype.onExecute.call(o,t,n);if(o.docType===Wn.e.OneNote||o.docType===Wn.e.Text||2===o._itemCommandHelper.getCommandBehavior(s,o._itemCommandKey)){if(Object(ce.isFeatureEnabled)(ce.CreateDocumentPromptSameTab))return o.askForFileName=!0,e.prototype.onExecute.call(o,t,n);var d=o.navigation,l=i.createDocumentInTab(o.docType,s,!0);return d.navigateTo({url:l,frameId:o._getTargetId()}),da(s,o.resources),{resultType:v.t.Success}}if(o.docType===Wn.e.ExcelSurvey&&Object(ce.isFeatureEnabled)(ce.RedirectExcelSurveysToFormsV2)){d=o.navigation;var u=o._identityDataSource.getIdentity(),f="Action=Create&Host=ODC&Title="+encodeURIComponent(Qn.FormDefaultName),p="https://forms.office.com/Pages/DesignPage.aspx?Action=Create&auth_pvr=WindowsLiveId"+(u.email?"&auth_upn="+encodeURIComponent(u.email):"")+"&Fragment="+encodeURIComponent(f);return d.navigateTo({url:p,frameId:o._getTargetId()}),{resultType:v.t.Success}}if(o._enableCreateDocumentForCOB){if(!Le.e.isActivated("45955574-DA27-457D-BF90-A452A8068680","09/05/2022","COB account use Vroom to create new file")&&Object(ce.isFeatureEnabled)(ce.CreateConvergenceViaVroom))return r=null!=r?r:window.open("",o._getTargetId()),o._createDocumentDataSource.create(s,o.docType,null,!0).then(function(e){return r.location.href=e,o._writePerfForWac(),{resultType:v.t.Success}}).catch(function(e){r.close();var t=Object(ha.e)(o.docType);return o._showError(e,s,t),{resultType:v.t.Failure}});var m=o._createDocumentForCOB(o.docType,s);return o.navigation.navigateTo({url:null==m?void 0:m.toString(),frameId:o._getTargetId()}),o._writePerfForWac(),{resultType:v.t.Success}}return c?o._createDocumentDataSource.create(s,o.docType).then(function(e){return r?r.location.href=e:o.navigation.navigateTo({url:e}),o._writePerfForWac(),da(s,o.resources),{resultType:v.t.Success}}).catch(function(e){r&&r.close();var t=Object(ha.e)(o.docType);return o._showError(e,s,t),{resultType:v.t.Failure}}):o._getHiddenDomProvider().then(function(e){var t=i.createDocumentInTab(o.docType,s,!1),n=e.requestControl({name:ta.tagName,params:{canary:FilesConfig.navCanary,formAction:t,resources:o.resources,target:a}});return o._writePerfForWac(),document.getElementById("create_form").submit(),e.disposeControl(n),da(s,o.resources),I.n.wrap({resultType:v.t.Success})})})},t.prototype._showError=function(e,t,n){var a,i=this,r=this.observables;(a=this._operationProvider.register({iconName:xa.n({type:an.e.File,extension:n}),name:"",type:Ia.e.createItem,payloads:{uploadItems:{name:"New file",parent:t}},actions:{close:{isAvailable:r.create(!0),execute:function(){return a.actions().learnMore.isAvailable(!1),a.state(Da.e.canceled),I.n.wrap(null)}},learnMore:{isAvailable:r.create(!0),execute:function(){return window.open(i.c_pathLengthErrorLearnMoreLink,i._getTargetId()),I.n.wrap()}}}})).progress.maximum(1),a.progress.current(0);var o=a.actions().learnMore;switch(e.code){case this.c_pathLimitError:o.isAvailable(!0),a.error(new Sa.e({message:ya.n}));break;case this.c_accessDeniedError:o.isAvailable(!1),a.error(new Sa.e({message:ya.e}));break;default:o.isAvailable(!1),a.error(new Sa.e({message:ya.t}))}a.state(Da.e.failed)},t.prototype._writePerfForWac=function(){try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}},t.prototype._getTargetId=function(){return this._isRunningTABTest?"_self":"_blank"},t.prototype._getItemCommandKey=function(e){var t;switch(e){case Wn.e.Word:t=fa.i;break;case Wn.e.Excel:t=fa.e;break;case Wn.e.PowerPoint:t=fa.n;break;case Wn.e.ExcelSurvey:t=fa.a;break;case Wn.e.OneNote:t=fa.t;break;case Wn.e.Text:t=pa}return t},t.prototype._checkCreateDocumentForCOB=function(e){this._enableCreateDocumentForCOB=!Le.e.isActivated("25D2DD67-8AD1-4CF3-9AB1-0662C8CB3588","3/24/2022","create new codument for COB")&&Object(ce.isFeatureEnabled)(ce.CreateConvergenceEnabled)&&Object(Gt.e)(e.ownerId)},t.prototype._createDocumentForCOB=function(e,t,n){var a,i;try{if(e===Wn.e.Visio)return null;var r="".concat(St.o,"/personal/").concat(null===(a=t.ownerId)||void 0===a?void 0:a.toUpperCase(),"/Documents"),o="".concat(r,"/_layouts/15/doc.aspx"),s=void 0;t.itemFromServer.sharepointIds&&(s=t.itemFromServer.sharepointIds.listItemUniqueId);var c=this._getDocAspxUrlForCOB(o,r+"/Documents",e,s),l=new d.t(new d.t(window.location.href).getStringWithoutQueryAndFragment()+"edit.aspx?"+c.getQuery(!0));return n&&l.setQueryParameter("fn",n,!0),e===Wn.e.OneNote&&l.setQueryParameter("progId","OneNote.Notebook",!0),l.setQueryParameter("cid",null===(i=t.ownerId)||void 0===i?void 0:i.toUpperCase(),!0),l}catch(e){return console.log(e),null}},t.prototype._getDocAspxUrlForCOB=function(e,t,n,a){var i=Object(Ca.e)(e,t,n,a,!0),r=new d.t(i);return r.setQueryParameter("CT",(new Date).getTime().toString(),!0),r.setQueryParameter("OR","DocLib",!0),r},t}($n),ka=n(80),Ma=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="CreateFolder",t}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./CreateFolderExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([164,"ondemand.resx-ondemand"],1672))}},t.prototype.getSelectionOptions=function(){return{canFallback:!0}},t.prototype.getExecutorParameters=function(){var e=this;return this.selectionHelper.resolveFirst().then(function(t){return{actionName:e.name,item:t}})},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return!(e&&e.vault&&e.vault.isLocked)&&e&&e.queryType===Y.e.Files&&this.itemCommandHelper.isCommandSupported(e,ka.t)},t}(mn.e),Pa=Ma,Ta=function(e){function t(n){var a=e.call(this,n)||this;return a.text=n.text,a.isLearnMoreVisible=n.isLearnMoreVisible,a.learnMoreText=Qn.CreateMountPointLearnMore,a.learnMoreUrl=t.LEARNMORE_URL,a}return Object(i.__extends)(t,e),t.LEARNMORE_URL="https://go.microsoft.com/fwlink/p/?LinkID=389986",t}(Un.e),Ua=Bn.e({tagName:"ms-create-mp",template:'<div class="CreateMountPoint"><span data-bind="text:text"></span>\x3c!--ko if:isLearnMoreVisible--\x3e&nbsp;<a data-bind="attr:{href:learnMoreUrl},text:learnMoreText"></a>\x3c!--/ko--\x3e</div>',viewModel:Ta,synchronous:!0}),Fa=n(72),Ha=n(86),Ra=n(147),Na=n(12),Ba=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.isSingleSelectAction=!0,a.canFallbackToParent=!0,a.name="CreateMountPoint",a._actionMap=a.resources.consume(Na.e),a._itemReedemer=a.resources.consume(on.e),a._itemCommandHelper=new(a.managed(sn.e)),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,Ha.e)},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var e,t,n,a,r,o,s,c,d,l=this;return Object(i.__generator)(this,function(u){switch(u.label){case 0:return e=this.resources.consume(Vn.e),[4,this._itemSelectionHelper.resolveFirst()];case 1:return(t=u.sent())?[4,this._itemReedemer.redeemItem(t,this)]:[2,{resultType:v.t.ExpectedFailure}];case 2:u.sent(),n=new(this.scope.attached(Ra.e)),a=this.observables.create(!0),r=this.observables.create(!0),o=this.observables.create(Qn.CreateMountPointDetails),s=Fa.s(Qn.CreateMountPointTitle,t.name),c=function(){return Object(i.__awaiter)(l,void 0,I.n,function(){var e,n,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:e=this.resources.consume(cn.resourceKey),a(!1),r(!1),o(Qn.CreateMountPointWait),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.createMountPoint({item:t})];case 2:return n=i.sent(),new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this.createObservable(n)}).execute(null),[2,2];case 3:return(s=i.sent()).data&&s.data.message?(o(s.data.message),[2,1]):[2,1];case 4:return[2]}})})},d=e.requestDialog({title:s,component:{name:Ua.tagName,params:{text:o,isLearnMoreVisible:a}},actions:[{name:Qn.CreateMountPointConfirm,execute:function(){return c()},isAvailable:a,isVisible:a,icon:new kn.e("FabricFolderLink"),isDefault:!0},{name:Qn.Close,execute:function(){return I.n.resolve(2)},isAvailable:this.observables.create(!0),isVisible:n.attach(this.observables.pureCompute(function(){return!a()})),icon:new kn.e("Cancel"),isDefault:!0}]}),u.label=3;case 3:return u.trys.push([3,,5,6]),[4,d.wait()];case 4:return u.sent(),this._itemSelectionHelper.clearSelection(),[3,6];case 5:return n.dispose(),[7];case 6:return[2,{resultType:v.t.Success}]}})})},t}(Xt.e),ja=n(160),Va=n(102),za=n(512),Ga=n(212),Ka=new Ga.e("Open",Ga.t.intent),Wa=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="DefaultClick",a.isQosLogged=!1;var i=t.item,r=t.userInvokedItem,o=void 0!==r&&r,s=t.hideIfDefaultIsDownload,c=void 0!==s&&s,d=t.sourceEngagement,l=void 0===d?"":d,u=a,f=u.resources,p=u.observables;return f.expose(Ga.n,f.consume(Ga.n).withPart(Ka)),a._itemSelectionHelper=new(a.child(nn.e))({overrideItem:i,allowMultiSelect:!1,canFallback:!1}),a.item=a._itemSelectionHelper.firstItem,a.sourceEngagement=l,a.userInvokedItem=o,a.hideIfDefaultIsDownload=c,a.actionMap=f.consume(Na.e),a.urlDataSource=f.consume(V.H),a.viewParams=f.consume(Na.D),a._isFilePickerPage=p.pureCompute(a._computeIsFilePickerPage),a._action=p.pureCompute(a._computeAction),a._action.equalityComparer=ja.t,a._instrumentationProvider=f.consume(q.a),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.observables.peekUnwrap(this._action);return!!e&&e.isAvailable()},t.prototype.onExecute=function(e){var t=this.observables,n=t.peekUnwrap(this.item);this._logEngagement(n,e);var a=this._instrumentationProvider;a&&n&&a.userClickItem(n);var i=t.peekUnwrap(this._action);return i&&i.execute(e)||I.n.resolve({resultType:v.t.ExpectedFailure})},t.prototype.onComputeAction=function(){return new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item})},t.prototype._computeIsFilePickerPage=function(){return this.urlDataSource.getPageType(this.viewParams())===oe.e.FilePicker},t.prototype._computeAction=function(){var e,t=this._lastAction;t&&(t.dispose(),this._lastAction=void 0);var n=this.item();return this._isFilePickerPage()&&n&&n.type!==an.e.Folder||(e=this.onComputeAction()),this._lastAction=e,e},t.prototype._logEngagement=function(e,t){var n=this.sourceEngagement;if(n){var a;if(e)switch(e.type){case an.e.File:a="FileOpen.".concat(n);break;case an.e.Folder:a="FolderOpen.".concat(n);break;case an.e.App:a="AppOpen.".concat(n);break;case an.e.Subsite:a="SubsiteOpen.".concat(n);break;default:a="Open.".concat(n)}else a="Open.".concat(n);this.resources.consume(ze.e).withPart(za.e).withPart(Va.e,{item:e}).logData({name:a,extraData:{action:t?t.type:"unknown"}})}},t}(Xt.e),qa=n(441),Qa=n(149),Ya=function(e){function t(){var t=e.call(this,{})||this;return t.name="ShowNotShared",t._dialogProvider=t.resources.consume(Vn.e),t}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e){return this._dialogProvider.requestDialog({title:qa.t,component:{name:Qa.e.tagName,params:{text:qa.e}},actions:[]}).wait().then(function(){return I.n.wrap({resultType:v.t.Success})})},t}(Xt.e),Ja=n(27),Xa=new dn.e("defaultClick"),Za=function(e){function t(t){var n=e.call(this,t)||this;return n._odcUrlDataSource=n.resources.consume(z.n),n._itemCommandHelper=new(n.managed(sn.e)),n._defaultClickBehavior=n.createPureComputed(n._computeDefaultClickBehavior),n._isOneDriveWinApp=Object(Xn.e)(),n._isOneDriveXboxApp=Object(Xn.t)(),n._isPWA=n.resources.consume(Yn.e).isPWA,n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var t=this.item(),n=this.hideIfDefaultIsDownload&&4===this._itemCommandHelper.getCommandBehavior(t,Xa);return e.prototype.onIsAvailable.call(this)&&!n},t.prototype.onComputeAction=function(){var t,n=this;switch(this._defaultClickBehavior()){case 1:t=e.prototype.onComputeAction.call(this);break;case 2:case 3:t=this._isOneDriveWinApp||this._isPWA?new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,urlType:"focus"}):new(this.managed(this.actionMap.OpenInOfficeOnlineAction))({item:this.item,openLocal:!this.userInvokedItem,useDefaultAction:!0});break;case 4:case 7:t=this._isOneDriveXboxApp?new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,urlType:"focus"}):new(this.managed(this.actionMap.DownloadAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 6:case 10:t=new(this.managed(this.actionMap.OpenInOfficeClientAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 11:t=new(this.managed(this.actionMap.NavigationAction))({url:this.createPureComputed(function(){var e=n._odcUrlDataSource.qualifyUrl(n._odcUrlDataSource.getDefaultClickUrl(n.item(),{action:Ja.t.defaultClick,viewParams:n.viewParams()}));return n._odcUrlDataSource.getAuthenticateUrl(e)}),userInvokedItem:this.userInvokedItem});break;case 15:t=new(this.managed(this.actionMap.PlayAudioAction))({item:this.item});break;case 50:t=new(this.managed(Ya))}return t},t.prototype._computeDefaultClickBehavior=function(){return this._itemCommandHelper.getCommandBehavior(this.item(),Xa)},t}(Wa),$a=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="Delete",n.logStartEnd=!0,n._currentItem=Object(de.es)(de.Z)?n.selectionHelper.currentItem:n.resources.consume(Na.i),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./DeleteExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([165,"ondemand.resx-ondemand"],1468))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}},t.prototype.onIsAvailable=function(){var e=this;return this._currentItem()&&this.selectionHelper.filterItems(function(t){var n=!!t.UNSAFE_parent&&t.UNSAFE_parent.isBundle,a=!!t.UNSAFE_parent&&t.UNSAFE_parent.isAlbum;return e.itemCommandHelper.isCommandSupported(t,ka.a)&&t.queryType!==Y.e.SharedWithMe&&t.queryType!==Y.e.DocsInCommon&&!n&&!a})},t}(mn.e),ei=function(e){function t(t){void 0===t&&(t={});var n,a=this;return(a=e.call(this,t)||this)._itemCommandHelper=new(a.managed(sn.e)),a.name="Download",a._focusItem=null===(n=t.item)||void 0===n?void 0:n.peek(),a._currentItem=Le.e.isActivated("CA6B3004-C196-4F99-90F6-72ACA9F6971B","10/21/2021","Get Current Item from ItemSelectionHelper")?a.resources.consume(Na.i):a.selectionHelper.currentItem,a._itemCommandHelper=new(a.managed(sn.e)),a._isOneDriveWinApp=Object(Xn.e)(),a._isOneDriveXboxApp=Object(Xn.t)(),a}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./DownloadExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([169,"ondemand.resx-ondemand"],1717))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!this._isOneDriveWinApp,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),actionName:this.name,focusItem:this._focusItem}},t.prototype.onIsAvailable=function(){var e=this,t=this.selectionHelper.selection(),n=this.selectionHelper.firstItem();if((t.length>1||n&&n.folder)&&l.get("BadgerAuth"))return!1;var a=this._currentItem();return!(t.length>1&&a.queryType===Y.e.SharedWithMe&&a.isRootFolder)&&!this._isOneDriveXboxApp&&this.selectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,ma)})},t}(mn.e),ti=function(e){function t(t){var n=e.call(this,t)||this;return n.name="EditTagsAction",n._itemCommandHelper=new(n.managed(sn.e)),n._currentItem=Le.e.isActivated("5E6E4463-F472-41DE-9873-C1A437FCA008","10/21/2021","Get Current Item from ItemSelectionHelper")?n.resources.consume(Na.i):n.selectionHelper.currentItem,n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./EditTagsExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([14,"ondemand.resx-ondemand"],1673))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}},t.prototype.onIsAvailable=function(){var e=this;return(!Object(Gt.e)(St.s)||Object(ce.isFeatureEnabled)(ce.HideTaggingFeatures))&&this.selectionHelper.filterItems(function(t){return t&&(!!t.photo||!!t.video)&&t.sharingRole===ra.e.Owner&&(!t.queryType||t.queryType!==Y.e.RecycleBin)&&e._itemCommandHelper.isCommandSupported(t,gn)})},t}(mn.e),ni=n(129),ai=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.state=n.createPureComputed(n._computeState),n._itemSelectionHelper=new(n.child(nn.e))({allowMultiSelect:!0,canFallback:!0,overrideItem:t.item}),n._itemCommandHelper=new(n.managed(sn.e)),n._currentItem=Object(ce.isFeatureEnabled)(ce.CurrentItemUsingItemSelectionHelper)?n._itemSelectionHelper.currentItem:n.resources.consume(Na.i),n}return Object(i.__extends)(t,e),t.prototype.getParams=function(){return{actionName:"ShowTagsEditor",selectionHelper:this._itemSelectionHelper,currentItem:this._currentItem.peek()}},t.prototype._computeState=function(){return{isAvailable:this._isAvailable()}},t.prototype._isAvailable=function(){var e=this;return(!Object(Gt.e)(St.s)||Object(ce.isFeatureEnabled)(ce.HideTaggingFeatures))&&this._itemSelectionHelper.filterItems(function(t){return t&&(!!t.photo||!!t.video)&&t.sharingRole===ra.e.Owner&&(!t.queryType||t.queryType!==Y.e.RecycleBin)&&e._itemCommandHelper.isCommandSupported(t,gn)})},t}($.n),ii=Object(ni.e)({name:"ShowTagsEditor",source:{moduleDefinition:{path:"./ShowTagsEditorExecutor",getModule:function(){return I.n.resolve(n.ee([15,"ondemand.resx-ondemand"],1739))}}},handlerType:ai}),ri=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="Embed",n._isOneDriveXboxApp=Object(Xn.t)(),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./EmbedExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([16,"ondemand.resx-ondemand"],1727))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){if(!Object(ce.isFeatureEnabled)(ce.HideEmbedButton)&&!0===Object(Gt.e)(St.s))return!1;var e=this.selectionHelper.firstItem();return!this._isOneDriveXboxApp&&e&&this.itemCommandHelper.isCommandSupported(e,Ha.n)},t}(mn.e),oi=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="EmptyRecycleBin",n._urlDataSource=n.resources.consume(V.H),n._strings=Qn,n._usePollGetItemsForDeletion=t.usePollGetItemsForDeletion,n._currentItem=Object(de.es)(de.Z)?n.selectionHelper.currentItem:n.resources.consume(Na.i),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./EmptyRecycleBinExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([170,"ondemand.resx-ondemand"],1749))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),usePollGetItemsForDeletion:this._usePollGetItemsForDeletion}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection(),t=this._currentItem();return t&&this.itemCommandHelper.isCommandSupported(t,ka.n)&&this._urlDataSource.isRecycleBin(t.queryType)&&t.childCount>0&&0===e.length},t.prototype.onExecute=function(t){var n=this;return this._usePollGetItemsForDeletion?e.prototype.onExecute.call(this,t):this.resources.consume(Vn.e).requestDialog({title:this._strings.emptyRecycleBin,component:{name:Qa.e.tagName,params:{text:this._strings.recycleBinEmptyConfirm}},actions:[{name:this._strings.recycleBinEmptyConfirmYes,execute:function(){return I.n.wrap(2)},isAvailable:this.createObservable(!0),icon:new kn.e("Delete"),isDefault:!1},{name:this._strings.recycleBinEmptyConfirmNo,execute:function(){return I.n.wrap(3)},isAvailable:this.createObservable(!0),icon:new kn.e("Cancel"),isDefault:!0}]}).wait().then(function(){return e.prototype.onExecute.call(n,t)}).then(function(){return{resultType:v.t.Success}})},t}(mn.e),si=n(122),ci=function(e){function t(t){void 0===t&&(t={});var a=e.call(this,t)||this;return a.name="Feedback",a._executorLoader=new(a.managed(si.e))({path:"./FeedbackExecutor",getModule:function(){return I.n.resolve(n.ee([17,"ondemand.resx-ondemand"],1728))},getExecutorParams:function(){return{}}}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e){return this._executorLoader.execute(e)},t}(Xt.e);Object(Pn.e)([{rawString:".LanguagePicker select{width:100%}"}]);var di,li=n(310),ui=n(81),fi=function(e){function t(t){var n=e.call(this,t)||this;n.canary=t.canary,n.selectedLanguage=t.selectedLanguage,n.loadingText=li.t;var a=n.observables;n.isLoading=a.create(!0),n.languages=a.createArray([]),n.currentLanguage=a.create("");var i=n.resources.consume(V.g.optional);return i&&i.getLanguages().then(function(e){n.canary(e.canary),n.currentLanguage(e.currentLanguage);for(var t=e.languageList,a=0,i=t;a<i.length;a++){var r=i[a];r.displayText=(ui.e.isRightToLeft?"&rlm;":"&lrm;")+r.nativeName+" - "+r.name}n.languages(t),n.isLoading(!1)}),n}return Object(i.__extends)(t,e),t}(Un.e),pi=Bn.e({tagName:"ms-language-picker",template:'<form class="LanguagePicker">\x3c!--ko if:$data.isLoading--\x3e<div data-bind="text:loadingText"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:$data.isLoading--\x3e<select name="language" data-bind="value:selectedLanguage,foreach:languages,automation:\'dropDown\'"><option data-bind="attr:{selected:isoValue===$parent.currentLanguage()},value:isoValue,html:displayText"></option></select>\x3c!--/ko--\x3e</form>',viewModel:fi}),mi=function(e){function t(t){var n=e.call(this,t)||this;return n.name="LanguagePicker",n._languagePickerDataSource=n.resources.consume(V.g),n._navigation=n.resources.consume(B.e),n._dialogProvider=n.resources.consume(Vn.e),n._lang=n.observables.create(""),n._canary=n.observables.create(""),n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this;return this._dialogProvider.requestDialog({title:li.e,automationId:"languagePicker",component:{name:pi.tagName,params:{selectedLanguage:this._lang,canary:this._canary}},actions:[{name:li.n,execute:function(){return n.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new kn.e("Save"),isDefault:!0}]}).wait().then(function(){return{resultType:v.t.Success}})},t.prototype.onIsAvailable=function(){return!0},t.prototype.onDialogExecute=function(){var e=this;return this._languagePickerDataSource.saveLanguage(this._lang(),this._canary()).then(function(t){return e._navigation.navigateTo(E.t(window.location.href,"mkt",t)),2})},t}(Xt.e),_i=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t)||this;a.name="NavigateToItem",a._urlDataSource=a.resources.consume(V.H),a._viewParams=a.resources.consume(Na.D);var i=t.item,r=t.itemSet,o=void 0===r?a.resources.consume(Na.r.optional):r,s=t.parentItem,c=t.urlType,d=t.isRedirect,l=void 0!==d&&d,u=t.forceInSameWindow,f=void 0!==u&&u,p=t.shouldPreserveAction,m=void 0!==p&&p;a._itemSet=o,a._parentItem=s,a._urlType=a.wrapObservable(c),a._isRedirect=l,a._forceInSameWindow=a.wrapObservable(f),a._shouldPreserveAction=a.wrapObservable(m);var _=n.itemSelectionHelperType,h=void 0===_?a.resources.consume(nn.e):_;a._itemSelectionHelper=new(a.scope.attached(h))({overrideItem:i,allowMultiSelect:!1,canFallback:!0}),a._url=a.createPureComputed(a._computeUrl),a._target=a.createPureComputed(a._computeTarget);var b=a.resources.consume(Na.e);return a._navigationAction=new(a.managed(b.NavigationAction))({url:a._url,ignoreHistory:a._isRedirect,target:a._target}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._navigationAction.isAvailable()},t.prototype.onExecute=function(e){return this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return Object(ce.isFeatureEnabled)(ce.EngagementTelemetryEnhancement)?e.prototype.getEngagement.call(this).withPart(Va.e,{item:this._itemSelectionHelper.firstItem}):e.prototype.getEngagement.call(this)},t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._urlDataSource.getDefaultClickUrl(e,{urlType:this._urlType(),preserveAction:this._shouldPreserveAction(),itemSet:this._itemSet&&this._itemSet(),parentItem:this._parentItem&&this._parentItem(),viewParams:this._viewParams()})||""},t.prototype._computeTarget=function(){var e;return!this._forceInSameWindow()&&(e=this._url())&&0!==e.indexOf("#")?"_blank":"_top"},t}(Xt.e),hi=n(140),bi=n(148),gi=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SortAction",n.isExecutionIntentional=!0,n._sortManager=n.resources.consume(bi.a),n._column=t.column,n._ascending=t.ascending,n}return Object(i.__extends)(t,e),t.getSortedColumn=function(e){var t,n=e();if(n)for(var a=0;a<n.length;a++)if(n[a]&&n[a].isSorted){t=n[a];break}return t},t.prototype.onExecute=function(e,t){return this._updateCurrentSort(this._column,this._ascending),I.n.wrap({resultType:v.t.Success})},t.prototype.onIsAvailable=function(){return!0},t.prototype.onIsToggled=function(){var e=!1;return this._column&&(e=this._column.isSorted&&this._column.isAscending===this._ascending),e},t.prototype._updateCurrentSort=function(e,t){if(e){var n=e.internalName||e.key;this._sortManager.updateSort(n,t)}},t}(Xt.e);!function(e){e[e.Column=0]="Column",e[e.Order=1]="Order"}(di||(di={}));var vi,yi=di,Si=function(e){function t(t){var n=e.call(this,t)||this;return n.name="Sort",n._sortManager=n.resources.consume(bi.a),n._currentItemSet=n.resources.consume(Na.r),n._mode=t.mode,n._column=t.column,n._ascending=t.ascending,n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=gi.getSortedColumn(this._currentItemSet().schema);this._column||(this._column=n);var a={sortMode:yi[this._mode],sortAscending:"Ascending"};return this._column&&(a.sortColumn=this._column.internalName||this._column.key),this._mode===yi.Column?this.updateCurrentSort(this._column,n.isAscending):this._mode===yi.Order?this._currentItemSet&&this._currentItemSet().schema&&(a.sortAscending=this._ascending?"Ascending":"Descending",this.updateCurrentSort(n,this._ascending)):I.n.wrap({resultType:v.t.Failure}),I.n.wrap({resultType:v.t.Success,extraData:a})},t.prototype.onIsAvailable=function(){return!!this._currentItemSet&&!this._isVaultLocked()&&!!gi.getSortedColumn(this._currentItemSet().schema)},t.prototype.onIsToggled=function(){var e=!1;if(this._mode===yi.Column&&this._column)e=this._column.isSorted;else if(this._mode===yi.Order&&this._currentItemSet&&this._currentItemSet().schema){var t=gi.getSortedColumn(this._currentItemSet().schema);e=t&&t.isAscending===this._ascending}return!this._isVaultLocked()&&e},t.prototype.updateCurrentSort=function(e,t){if(e){var n=e.internalName||e.key;this._sortManager.updateSort(n,t)}},t.prototype._isVaultLocked=function(){var e=this._currentItemSet&&this._currentItemSet().item();return e&&e.vault&&e.vault.isLocked},t}(Xt.e),Di=n(139),Ii=n(120),xi=!Le.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),Ci=new Di.e,Oi=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="Open";var i=t.item,r=t.openRelation,o=void 0===r?0:r,s=t.ignoreHistory,c=void 0!==s&&s,d=t.itemSet,l=t.openLocal,u=void 0!==l&&l,f=t.urlType,p=void 0===f?"default":f,m=t.preserveAction,_=void 0!==m&&m,h=t.nonFoldersOnly,b=void 0!==h&&h;a._openRelation=o,a._nonFoldersOnly=b,a._urlType=a.wrapObservable(p),a._itemSelectionHelper=new(a.child(nn.e))({overrideItem:2===o?i:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o}),a.item=a.createComputed(a._computeItem,{deferEvaluation:!0,pure:!0});var g=a.resources.consume(Na.e);return a._navigateToItemAction=new(a.managed(g.NavigateToItemAction))({item:a.item,itemSet:d,parentItem:a._itemSelectionHelper.currentItem,urlType:a._urlType,forceInSameWindow:u,isRedirect:c,shouldPreserveAction:_}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||!!e&&!e.folder)&&this._navigateToItemAction.isAvailable()},t.prototype.onExecute=function(e,t){var n=this.item.peek();return n?(n.type===an.e.Folder&&t&&t.data&&(t.data.folder=!0),t.data.extraData||(t.data.extraData={}),Ii.e(t.data.extraData,{uniqueId:n.properties?n.properties.uniqueId:void 0}),this._navigateToItemAction.execute(e).then(function(){var e=xi&&n.extension?Object(qe.e)(n.extension):n.extension||"",t={fileType:an.e[n.type||an.e.Unknown],extension:e};return I.n.resolve({resultType:v.t.Success,extraData:t})})):I.n.resolve({resultType:v.t.ExpectedFailure})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(Va.e,{item:this.item})},t.prototype.trackUserAction=function(t){var n=this.item.peek();if(n)switch(n.type){case an.e.File:e.prototype.trackUserAction.call(this,"Open.File");break;case an.e.Media:e.prototype.trackUserAction.call(this,"Open.Media");break;default:e.prototype.trackUserAction.call(this,t)}},t.prototype._computeItem=function(){var e=this._itemSelectionHelper.firstItem();return(3===this._openRelation?e&&e.UNSAFE_parent:e)||Ci},t}(Xt.e),wi=n(190),Ei=function(e){function t(t){var n=e.call(this,t)||this;return n._itemCommandHelper=new(n.managed(sn.e)),n._skipVaultChecks=!!t.ignoreHistory,n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var t=this.item();return e.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(t,Xa)},t.prototype.onExecute=function(t,n){var a=this,i=this.item.peek();if(i&&i.vault&&!this._skipVaultChecks){var r=this.resources.consume(V.H),o=this.resources.consume(Na.D),s=r.getPageType(o.peek()),c=s===oe.e.FilePicker||s===oe.e.FolderPicker;if(i.vault.isLocked||c){var d=this.resources.consume(Na.e);return new(this.managed(d.VaultAction))({actionType:wi.e.Unlock,item:this.item}).execute(null).then(function(i){if(i.resultType===v.t.Success)return e.prototype.onExecute.call(a,t,n)})}}return e.prototype.onExecute.call(this,t,n)},t}(Oi),Ai=n(537),Li=!Le.e.isActivated("A61307C5-CA5C-474C-99AB-E9F954A94351","06/06/2022","Hide preview button for loop powered files"),ki=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Preview";var a=n.resources.consume(Na.e);return n._dataStore=new me.e("",_e.e.local),n._itemSelectionHelper=new(n.child(nn.e))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1}),n._openAction=new(n.managed(a.OpenAction))({urlType:n.observables.compute(n._computeUrlType),item:t.item,openRelation:t.item?2:void 0,nonFoldersOnly:!0}),n._itemParentHelper=n.resources.consume(An.e),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=void 0;return e&&(t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"))),!(Li&&this._isBFile()||!e||e.external||!this._openAction.isAvailable()||e.type===an.e.OneNote||Object(Ai.e)()&&e.queryType===Y.e.SharedWithMe||t&&t.list&&!t.list.isDocumentLibrary)},t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem.peek();return!n||"ms-word"!==n.appMap&&"ms-powerpoint"!==n.appMap?this._dataStore.setValue("OfficeDocClickTime",""):this._dataStore.setValue("OfficeDocClickTime",new Date),this._openAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(Va.e,{item:this._itemSelectionHelper.firstItem})},t.prototype._computeUrlType=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.queryType===Y.e.Recent?"default":"focus"},t.prototype._isBFile=function(){var e=this._itemSelectionHelper.firstItem();if(e){var t=e.extension,n=e.properties,a=t?t.toLowerCase():"",i=n&&n.ProgId?n.ProgId:"";return".fluid"===a||".note"===a||".whiteboard"===a||".loop"===a||"Fluid."===i.substring(0,6)}return!1},t}(Xt.e),Mi=!Le.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),Pi=((vi={})[1]=aa.Excel,vi[2]=aa.OneNote,vi[3]=aa.PowerPoint,vi[4]=aa.Word,vi[5]=aa.Visio,vi[6]=aa.Project,vi[7]=aa.Publisher,vi),Ti=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="OpenInOfficeClient",a._itemReedemer=a.resources.consume(on.e),a._navigation=a.resources.consume(B.e),a._platform=a.resources.consume(Yn.e),a._itemCommandHelper=new(a.managed(sn.e)),a._urlDataSource=a.resources.consume(z.n),a._isOneDriveXboxApp=Object(Xn.t)(),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._platform,t=this._itemSelectionHelper.firstItem();return(e.isMac||e.isWindows||e.isIOS||e.isWinPhone||e.isAndroid)&&!this._isOneDriveXboxApp&&!!t&&this._itemCommandHelper.isCommandSupported(t,fa.o)},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var e,n,a=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=i.sent())?(t.data.extraData||(t.data.extraData={}),n=e.extension?e.extension.toLowerCase():void 0,Ii.e(t.data.extraData,{fileType:Mi&&n?Object(qe.e)(n):n}),[2,this._itemReedemer.redeemItem(e,this).then(function(){if(a._platform.isMobile){var t=a._navigation,n=a._urlDataSource;return t.navigateTo(n.getOpenInOfficeClientUrl(e,a._navigation.viewParams,K.e.viewerId)),{resultType:v.t.Success}}var i=a._itemCommandHelper.getCommandBehavior(e,fa.o),r=Pi[i];return function(e,t,n,a,i){var r;e.type===an.e.OneNote&&(r=e.urls.oneNoteClient);var o={url:r,isDavUrl:!!r,fileName:e.name,iconType:e.iconName,appType:a,extension:a===aa[2].toString()?".one":e.extension,item:e};return oa.executeOpenInClient(o,i)}(e,K.e.viewerId,e.isGroup,aa[r],a.resources)})]):[2,I.n.resolve({resultCode:"EmptySelection",resultType:v.t.Failure})]}})})},t}(Xt.e),Ui=n(538),Fi=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenPdfInBrowserAction";var a=n,i=a.observables,r=a.resources;n._itemCommandHelper=r.consume(sn.t),n._itemSelectionHelper=new(n.child(nn.e))({overrideItem:t.item}),n._urlDataSource=r.consume(V.H);var o=i.pureCompute(function(){var e=n._itemSelectionHelper.firstItem();return e&&e.openUrl}),s=r.consume(Na.e);return n._navigationAction=new(n.managed(s.NavigationAction))({url:o,target:"_blank"}),Object(Xn.e)()&&(n._openInDesktopAction=new(n.managed(s.OpenInDesktopAction))({openRelation:2,item:n._itemSelectionHelper.firstItem,actionType:Lt.OpenPdfInBrowser})),n._pdfViewerHelper=t.pdfViewerHelper,n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&!!e&&Object(Ui.e)(e,this._urlDataSource)&&this._itemCommandHelper.isCommandSupported(e,ka.c)&&".pdf"===e.extension.toLowerCase()&&(!this._pdfViewerHelper||!this._pdfViewerHelper.isPdfEditAvailable(e))},t.prototype.onExecute=function(e,t){return this._openInDesktopAction?this._openInDesktopAction.execute(e):this._navigationAction.execute(e)},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(Va.e,{item:this._itemSelectionHelper.firstItem})},t}(Xt.e),Hi=n(513),Ri=n(514),Ni=!Le.e.isActivated("DA910F66-8C98-428B-8A0F-C9BDE6481EB9","08/26/2022","Perform extra sanitization prior to logging extension, part 2"),Bi=function(e){function t(t){return void 0===t&&(t={}),e.call(this,t)||this}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.item();return!!e&&(e.extension&&".pdf"===e.extension.toLowerCase()||this._itemCommandHelper.isCommandSupported(e,fa.s))&&e.queryType!==Y.e.RecycleBin},t.prototype.onExecute=function(t,n){var a,i=this.item.peek();if(i.queryType!==Y.e.Search){var r=void 0;this.resources.consume(Ri.e)()&&(r={key:null==i?void 0:i.parentKey}),da((null===(a=null==i?void 0:i.UNSAFE_parent)||void 0===a?void 0:a.isStub)?i:i.UNSAFE_parent||r,this.resources,!0)}n.data.extraData||(n.data.extraData={});var o=i.extension?i.extension.toLowerCase():void 0;Ii.e(n.data.extraData,{fileType:Ni&&o?Object(qe.e)(o):o});try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}return e.prototype.onExecute.call(this,t,n)},t}(Hi.e),ji=n(195),Vi=n(142),zi=n(363),Gi=function(){function e(){}return e.alert=function(t,n,a,i,r){void 0===a&&(a=!1),void 0===r&&(r="alert");var o="sp_a11y_alert_"+t,s=document.querySelector("#"+o);s&&document.body.removeChild(s);var c=document.createElement("p");a||c.setAttribute("style",e._cssHidden),i&&c.classList.add(i),c.setAttribute("role",r),c.setAttribute("aria-live","assertive"),c.setAttribute("id",o);var d=document.createTextNode(n);document.body.appendChild(c),c.appendChild(d)},e._cssHidden="position:absolute;text-indent:-9999px;\n    width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0;",e}(),Ki=fe.e.isActivated("995DA390-4F3E-4CA5-A276-9DAB53FEE8A8","10/21/2022","Enables the openInTextEditor Command for html files"),Wi=fe.e.isActivated("2A5735C3-7E7C-4AA8-BB28-03BF84755D01","11/9/2022","Defers Open commands until after the Open Command Menu is closed"),qi=fe.e.isActivated("BB09B7DC-B8E9-4FA4-B25F-306EBCBE147A","04/18/2023","Allows the Command to appear in SWM"),Qi=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInTextEditor";var i=a.resources,r=n.urlDataSource,o=void 0===r?i.consume(V.H):r,s=n.viewParams,c=void 0===s?i.consume(Na.D):s,d=n.itemCommandHelper,l=void 0===d?i.consume(sn.t):d,u=n.platformDetection,f=void 0===u?i.consume(Yn.e):u,p=n.actionMap,m=void 0===p?i.consume(Na.e):p;return a._urlDataSource=o,a._viewParams=c,a._itemCommandHelper=l,a._platformDetection=f,a._url=a.createPureComputed(a._computeUrl),a.itemSelectionHelper=new(a.child(nn.e))({overrideItem:t.item}),a._navigationAction=new(a.managed(m.NavigationAction))({url:a._url,target:a._platformDetection.isPWA?"_self":"_blank"}),a._isOneDriveWinApp=Object(Xn.e)(),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;if(!this._availableForHtml(e))return!1;var t=this.itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key),a=this._urlDataSource.getQueryType(n),i=fe.e.isActivated("35BD4D5C-F09B-4F80-BBFD-1080AFB2EBC1","11/10/2021","Use item.parentKey as fallback since item.UNSAFE_parent will not be set in ItemsScope pivots")?!!e.UNSAFE_parent||Object(de.es)(de.Po)&&!!e.parentKey:!!e.UNSAFE_parent||!!e.parentKey;return this._itemCommandHelper.isCommandSupported(e,ka.s)&&!this._platformDetection.isMobile&&this._navigationAction.isAvailable()&&!!e&&i&&Object(Vi.a)(e.extension,e.type)&&(!qi||a!==Y.e.SharedWithMe)&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(a)&&e.itemStatus!==ji.e.ConditionalAccessViewOnly&&e.itemStatus!==ji.e.ConditionalAccessBlocked},t.prototype.onExecute=function(e){var t=this;return Wi?this._navigationAction.execute(e):new I.n(function(n){setTimeout(function(){Gi.alert("OpenInTextEditor",Qn.OpenInTextEditorAriaAlert),n(t._navigationAction.execute(e))},0)})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(Va.e,{item:this.itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();if(!e||!e.UNSAFE_parent&&!e.parentKey)return"";var t=this._availableForHtml(e)?this._urlDataSource.saveViewerType("TextFile"):{};return this._urlDataSource.getDefaultClickUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams(),additionalViewParams:t})},t.prototype._availableForHtml=function(e){var t=e&&e.htmlConversion&&Object(de.es)(ce.UseSandboxHtmlViewer)&&(Object(zi.e)()||this._platformDetection.isEdge),n="TextFile"===this._urlDataSource.getViewerType(this._viewParams());return t&&!n&&!Ki},t}(Xt.e),Yi=fe.e.isActivated("17DB17D7-FC3F-4243-B2CE-A54D5E531404","10/27/2022","Enable OpenInHtmlViewer Action"),Ji=fe.e.isActivated("2A5735C3-7E7C-4AA8-BB28-03BF84755D01","11/9/2022","Defers Open commands until after the Open Command Menu is closed"),Xi=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="OpenInHtmlViewer";var i=a.resources,r=n.urlDataSource,o=void 0===r?i.consume(V.H):r,s=n.viewParams,c=void 0===s?i.consume(Na.D):s,d=n.itemCommandHelper,l=void 0===d?i.consume(sn.t):d,u=n.platformDetection,f=void 0===u?i.consume(Yn.e):u,p=n.actionMap,m=void 0===p?i.consume(Na.e):p;return a._urlDataSource=o,a._viewParams=c,a._itemCommandHelper=l,a._platformDetection=f,a._url=a.createPureComputed(a._computeUrl),a.itemSelectionHelper=new(a.child(nn.e))({overrideItem:t.item}),a._navigationAction=new(a.managed(m.NavigationAction))({url:a._url,target:a._platformDetection.isPWA?"_self":"_blank"}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.itemSelectionHelper.firstItem();if(!e)return!1;var t=e&&e.htmlConversion&&Object(de.es)(ce.UseSandboxHtmlViewer)&&(Object(zi.e)()||this._platformDetection.isEdge),n="TextFile"!==this._urlDataSource.getViewerType(this._viewParams());return this._itemCommandHelper.isCommandSupported(e,ka.r)&&t&&!n&&!Yi},t.prototype.onExecute=function(e){var t=this;return Ji?this._navigationAction.execute(e):new I.n(function(n){setTimeout(function(){Gi.alert("OpenInHTMLViewer",Qn.OpenInHtmlViewerAriaAlert),n(t._navigationAction.execute(e))},0)})},t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(Va.e,{item:this.itemSelectionHelper.firstItem})},t.prototype._computeUrl=function(){var e=this.itemSelectionHelper.firstItem();if(!e||!e.UNSAFE_parent&&!e.parentKey)return"";var t=this._urlDataSource.saveViewerType("Html");return this._urlDataSource.getDefaultClickUrl(e,{parentItem:this.itemSelectionHelper.currentItem(),viewParams:this._viewParams(),additionalViewParams:t})},t}(Xt.e),Zi=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="OrderPrints",n._platformDetection=n.resources.consume(Yn.e),n._identity=n.resources.consume(V.p).getIdentity(),n._isOneDriveXboxApp=Object(Xn.t)(),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./OrderPrintsExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([21,"ondemand.resx-ondemand"],1734))}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}},t.prototype.onIsAvailable=function(){if(!Object(ce.isFeatureEnabled)(ce.EnableOrderPrints))return!1;if(this._identity.type===re.e.anonymous)return!1;var e=this.selectionHelper.firstItem(),t=this.selectionHelper.selection().length,n=e&&e.queryType,a=n===Y.e.Files||n===Y.e.Photos||Object(Be.e)(n)||n===Y.e.AllMyPhotos||n===Y.e.SharedWithMe;return!(!t||!a||this._isOneDriveXboxApp)&&this._identity.type!==re.e.aad&&e.photo&&t>=1&&t<=100&&$Config&&"en-us"===$Config.mkt.toLowerCase()&&!this._platformDetection.isMac},t}(mn.e),$i=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="PlayAudio";var a=n.resources.consume(Na.e),i=n.observables;n._item=new(n.child(nn.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1}).firstItem;var r=new(n.managed(a.OpenAction))({urlType:i.pureCompute(n._computeUrlType),item:t.item,nonFoldersOnly:!0});return n._action=r,n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._item();return e&&!e.external&&!!e.audio&&this._action.isAvailable()},t.prototype.onExecute=function(e,t){return this._action.execute(e)},t.prototype._computeUrlType=function(){var e=this._item();return e&&e.queryType===Y.e.Recent?"default":"focus"},t}(Xt.e),er=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="PlaySlideShow",a._slideshowState=a.resources.consume(Na.v),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e,t,n=this._itemSelectionHelper.firstItem(),a=!(!Object(ce.isFeatureEnabled)(ce.EnableLivePhotoVideos)||!(null===(e=null==n?void 0:n.photo)||void 0===e?void 0:e.isLivePhoto)),i=!(!Object(ce.isFeatureEnabled)(ce.EnableSamsungMotionPhotoVideos)||!(null===(t=null==n?void 0:n.photo)||void 0===t?void 0:t.isSamsungMotionPhoto));return!(!n||!n.photo||a||i||this._slideshowState.isSlideShowModeEnabled())},t.prototype.onExecute=function(e,t){return this._slideshowState.isSlideShowModeEnabled(!0),this._slideshowState.enterSlideshowMode()?I.n.resolve({resultType:v.t.Success}):I.n.resolve({resultType:v.t.Failure})},t}(Xt.e),tr=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="StopSlideShow",a._slideshowState=a.resources.consume(Na.v),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this._itemSelectionHelper.firstItem()&&this._slideshowState.isSlideShowModeEnabled()},t.prototype.onExecute=function(e,t){return this._slideshowState&&this._slideshowState.exitSlideshowMode()?I.n.resolve({resultType:v.t.Success}):I.n.resolve({resultType:v.t.Failure})},t}(Xt.e),nr=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveCoverPhotoAction",a._itemReedemer=a.resources.consume(on.e),a._itemCommandHelper=new(a.managed(sn.e)),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e,t=this,n=this._itemSelectionHelper.currentItem(),a=null===(e=null==n?void 0:n.vault)||void 0===e?void 0:e.root;return n.queryType!==Y.e.SharedWithMe&&!a&&(!n.isBundle||!!n.isAlbum)&&this._itemSelectionHelper.filterItems(function(e){return t._itemCommandHelper.isCommandSupported(e,fn)})},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n,a=t.resources.consume(cn.resourceKey),i=e[0].UNSAFE_parent;if(Object(de.es)(de.po)){var r=e[0],o=(null==r?void 0:r.parentKey)&&Object(xe.h)(r.parentKey);n={key:e[0].parentKey,id:o.id}}return a.removeCoverPhotos({items:e,target:i||n,itemsScopeInvalidate:!!n}).then(function(){return{resultType:v.t.Success}})})]:[2,I.n.resolve({resultCode:"EmptySelection",resultType:v.t.Failure})]}})})},t}(Xt.e),ar=n(569),ir=n(287),rr=n(201),or=function(e){function t(t,n){var a=e.call(this,t)||this;a._dataSource=n.mruRecentDataSource,a._itemProvider=n.itemProvider;var i=n.location,r=void 0===i?window.location:i;return a._origin=new ir.e(r.href).authority,a}return Object(i.__extends)(t,e),t.prototype.changePinStatus=function(e){return this._dataSource.changePinStatus(e)},t.prototype.getTokenForMru=function(){return this._dataSource.getTokenForMru()},t.prototype.removeFromRecent=function(e){var t=this;return Object(ce.isFeatureEnabled)(ce.MruToMruPlusPlusSkyApi)?this._dataSource.removeRecentItem(e).then(function(n){return t._itemProvider.invalidateItem(e.parentKey),n}):this._itemProvider.removeFromRecent(e)},t.prototype.recordDocumentView=function(e){var t=e.graph,n=new ir.e(e.openUrl),a="".concat(n.authority||this._origin).concat(n.path),r=e.sharingType,o=e.dateCreatedTime,s=e.dateModifiedTime,c=e.mruState,d=e.properties,l=void 0===d?{}:d,u=l.editorName,f=void 0===u?[]:u,p=l.creatorName,m=void 0===p?[]:p,_=c&&c.mruId,h=f[0],b=m[0],g=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({category:"Document",type:"DocumentUrl",app:sr(e),url:a},function(e){var t=e.name,n=e.extension,a=n&&n.replace(/^\.+/,"");return{title:t&&(n?t.replace(RegExp(".".concat(a,"$")),""):t),extension:a}}(e)),{file_size:e.size}),_?{mru_id:_}:{onedrive_info:t&&{drive_id:t.driveId,item_id:t.itemId,parent_reference_id:e.UNSAFE_parent&&e.UNSAFE_parent.graph&&e.UNSAFE_parent.graph.itemId,drive_type:t.driveType},resource_id:e.itemId}),{sharing_info:{state:"number"==typeof r&&r<rr.e.Private?1:0},modification_info:cr(h,s),creation_info:cr(b,o)});return this._dataSource.recordDocumentView(e,g)},t.dependencies=Object(i.__assign)(Object(i.__assign)({},$.n.dependencies),{itemProvider:cn.resourceKey,mruRecentDataSource:V.S}),t}($.n);function sr(e){return Object(ar.e)(e.extension)?"PdfViewer":e.audio||e.image360||e.photo||e.video?"Media":"OtherNonOffice"}function cr(e,t){if(e&&t)return{timestamp:t.toISOString(),user_info:{upn:e.sip||e.email,display_name:e.title}}}var dr=Object(j.r)("MruRecentProvider",or),lr=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveFromRecent",a._urlDataSource=a.resources.consume(V.H),a._itemCommandHelper=new(a.managed(sn.e)),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!Object(ce.isFeatureEnabled)(ce.MruToMruPlusPlusSkyApi),canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._urlDataSource.getKeyParams(this._itemSelectionHelper.currentItem().key),t=this._urlDataSource.getQueryType(e),n=this._itemSelectionHelper.firstItem();return t===Y.e.Recent&&!!n&&this._itemCommandHelper.isCommandSupported(n,ln)},t.prototype.onExecute=function(e,t){var n=this,a=this._itemSelectionHelper.currentItem.peek();return this._itemSelectionHelper.resolveSelection().then(function(e){return n._itemSelectionHelper.clearSelection(),n.resources.consumeAsync(dr).then(function(t){return t.removeFromRecent({parentKey:a.key,items:e})})}).then(function(){return{resultType:v.t.Success}})},t}(Xt.e),ur=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveTag",a._tag=t.tag,a._itemReedemer=a.resources.consume(on.e),a._itemCommandHelper=new(a.managed(sn.e)),a._itemSet=a.resources.consume(Na.r.optional),a._tagProvider=a.resources.consume(q.f),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this;return(!Object(Gt.e)(St.s)||Object(ce.isFeatureEnabled)(ce.HideTaggingFeatures)||"objectdetectors"===this._tag().source)&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,vn)})},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n,a=t._tag.peek(),i=t.resources.consume(q.o).getAllPhotosSettings().peek(),r=t._itemSet&&(null===(n=t._itemSet.peek())||void 0===n?void 0:n.key);return t._tagProvider.updateTags({items:e,tagsToAdd:null,tagsToDelete:[a],parentKey:r,rootItemId:i.rootId}).then(function(){return{resultType:v.t.Success}})})]:[2,I.n.resolve({resultCode:"EmptySelection",resultType:v.t.Failure})]}})})},t}(Xt.e),fr=function(e){function t(t){var n=e.call(this,t)||this;return n.name="Rename",n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./RenameExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([174],1750))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this.itemCommandHelper.isCommandSupported(e,ka.d)},t}(mn.e),pr=new De.t({name:"".concat("RestoreAction",".restoreItemsOperator"),loader:new j.t(function(){return I.n.resolve(n.ee([29],1674)).then(function(e){return e.typeResourceKey})})}),mr=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._urlDataSource=n.resources.consume(V.H),n._itemSelectionHelper=new(n.child(nn.e))({allowMultiSelect:!0,overrideItem:t.item}),n._itemCommandHelper=new(n.managed(sn.e)),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this._itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key);return!!this._urlDataSource.isRecycleBin(this._urlDataSource.getQueryType(n))&&this._itemCommandHelper.isCommandSupported(e,ka.u)},t.prototype.onExecute=function(e){var t=this,n=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(e){return t.resources.consumeAsync(pr).then(function(a){var i=new a({parentKey:n,items:e});return t.trackPromise(i.start()),i.wait()})}).then(function(){return{resultType:v.t.Success}})},t}(Xt.e),_r=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="RestoreAll",n._itemCommandHelper=new(n.managed(sn.e)),n._currentItem=Object(de.es)(de.Z)?n.selectionHelper.currentItem:n.resources.consume(Na.i),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./RestoreAllExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([28],1675))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection&&this.selectionHelper.selection(),t=this._currentItem();return t&&t.childCount>0&&0===e.length&&this._itemCommandHelper.isCommandSupported(t,ka.l)},t}(mn.e),hr=n(454),br=new De.t({name:"RotateAction",loader:new j.t(function(){return I.n.resolve(n.ee([30],1676)).then(function(e){return e.typeResourceKey})})}),gr=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._itemSelectionHelper=new(n.child(nn.e))({allowMultiSelect:!0,overrideItem:t.item}),n._itemCommandHelper=new(n.managed(sn.e)),n._itemRedeemer=n.resources.consume(on.e),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!Object(ce.isFeatureEnabled)(ce.EnableRotatePhotoInCob)&&Object(Gt.e)(St.s))return!1;var e=this._itemSelectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,hn)},t.prototype.onExecute=function(e){var t=this,n=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(e){return t._itemRedeemer.redeemItems(e,t).then(function(){return I.n.resolve(t.resources.consumeAsync(br))}).then(function(a){var i=new a({items:e,parentKey:n,rotation:hr.e.right});return t.trackPromise(i.start())})}).then(function(){return{resultType:v.t.Success}})},t}(Xt.e),vr=n(198),yr=n(182),Sr=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SaveSort",n._item=n.resources.consume(Na.i),n._currentItemSet=n.resources.consume(Na.r),n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=gi.getSortedColumn(this._currentItemSet().schema);if(!n)return I.n.wrapError({resultType:v.t.Failure});var a=n.isAscending,i=vr.e[n.internalName||n.key].toString(),r=null===a?yr.e.defaultValue.toString():a?yr.e.ascending.toString():yr.e.descending.toString();return this.resources.consume(cn.resourceKey).saveSortOrder({sortOrder:i,sortDirection:r,item:this._item()}).then(function(){return{resultType:v.t.Success}})},t.prototype.onIsAvailable=function(){var e=this._item(),t=e&&e.displayType;return!(e&&e.vault&&e.vault.isLocked||t!==Y.e.Files&&t!==Y.e.Photos)},t}(Xt.e),Dr=n(316),Ir=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SetFocus",n._selector=t.selector,n._shouldClick=t.shouldClick,n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=document.querySelector(this._selector);return n&&(n.focus(),this._shouldClick&&Dr.e.clickElement(n)),I.n.wrap({resultType:v.t.Success})},t}(Kn.e),xr=function(e){function t(t){var n=e.call(this,t)||this;return n.sharingMethod=t&&t.sharingMethod?t.sharingMethod:null,n._alreadyRedeemed=t&&t.alreadyRedeemed?t.alreadyRedeemed:null,n.name="ShareByLink",n._urlDataSource=n.resources.consume(V.H),n._itemCommandHelper=new(n.managed(sn.e)),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this.selectionHelper.selection().length,n=t>1&&e.queryType===Y.e.SharedWithMe&&e.isRootFolder,a=t>1&&e.isAlbum,i=this._urlDataSource.isRecycleBin(e.queryType);return(this._itemCommandHelper.isCommandSupported(e,Ha.s)||e.vault)&&!n&&!a&&!i&&this._allItemsSupportShare()},t.prototype.getExecutorPath=function(){return"./ShareByLinkExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([176,"ondemand.resx-ondemand"],1702))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,startState:this._startState,alreadyRedeemed:this._alreadyRedeemed,sharingMethod:this.sharingMethod}},t.prototype._allItemsSupportShare=function(){var e=this.selectionHelper.selection();if(!e.length)return!1;for(var t=0,n=e;t<n.length;t++){var a=n[t];if(a){var i=a();if(!i)return!0;if(!this._itemCommandHelper.isCommandSupported(i,Ha.s)&&(!i.vault||i.vault.isLocked))return!1}}return!0},t}(mn.e),Cr=function(e){function t(t){var a=e.call(this,t)||this;return a.name="ShowKeymap",a._executorLoader=new(a.managed(si.e))({path:"./ShowKeyboardMapExecutor",getModule:function(){return I.n.resolve(n.ee([35,"ondemand.resx-ondemand"],1740))},getExecutorParams:function(){return{}}}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e){return this._executorLoader.execute(e)},t}(Xt.e),Or=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._operationProvider=n.resources.consume(_a.e),n.state=n.createPureComputed(n._computeState),n}return Object(i.__extends)(t,e),t.prototype._computeState=function(){return{isAvailable:this._operationProvider.overall.state()!==Da.e.expired,isToggled:this._operationProvider.isLocked()}},t}($.n),wr=Object(ni.e)({name:"ShowOperations",source:{moduleDefinition:{path:"./ShowOperationsExecutor",getModule:function(){return I.n.resolve(n.ee([36,"ondemand.resx-ondemand"],1709))}}},handlerType:Or});Object(Pn.e)([{rawString:"@keyframes commandBarBoxShadowAnimation{0%{box-shadow:none;background-color:transparent}100%{background-color:"},{theme:"listBackground",defaultValue:"#fff"},{rawString:";box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,.132),0 .6px 1.8px 0 rgba(0,0,0,.108)}}@keyframes commandBarDividerAnimation{0%{opacity:1}100%{opacity:0}}.InfoPane-sharing{margin-top:.5rem}.InfoPane-sectionHeaderText{font-size:.875rem}.od-SharingSection-ManageAccessLink{font-size:.75rem}.SharingSection-shareLink{line-height:1.625rem;font-size:.75rem}html[dir=ltr] .SharingSection-shareLink{float:right}html[dir=rtl] .SharingSection-shareLink{float:left}.SharingSection-entity{padding:.5rem 0;font-size:.75rem}.SharingSection-entity .ms-Persona{white-space:nowrap}.SharingSection-entity .ms-Persona .ms-Persona-details{display:inline-block;max-width:10.625rem;padding:0}.SharingSection-addPeople{font-size:1.125rem;min-height:3.125rem;margin-top:.625rem}.SharingSection-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.25rem;border-radius:50%;width:3.125rem;height:3.125rem}[dir=ltr] .SharingSection-addPeople-icon{margin-right:.625rem}[dir=rtl] .SharingSection-addPeople-icon{margin-left:.625rem}.SharingSection-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:.75rem}[dir=ltr] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{left:.9375rem}[dir=rtl] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{right:.9375rem}.SharingSection-addPeople-text{display:inline-block;vertical-align:top;line-height:3.125rem}.SharingSection-linksBox a{display:inline-block;margin-top:.3125rem}.SharingSection-link,.od-PermissionsPanel-link{padding-top:.5rem}.od-alert{display:none}.od-alert.od-PermissionsPanel-alert{display:block}div.ms-ContextualMenu.is-open{z-index:299}.od-PermissionsPanel{height:100%;overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel .od-SharingLink-linkSwitcher{font-size:.75rem}.od-PermissionPile-FacePile{display:inline-block;margin:0;padding:0}.od-PermissionPile-FacePile.od-PermissionPile-Unshared{display:inline-flex;flex-wrap:wrap;justify-content:start}.od-PermissionsPanel-shareLink{line-height:1.625rem;font-size:.75rem}html[dir=ltr] .od-PermissionsPanel-shareLink{float:right}html[dir=rtl] .od-PermissionsPanel-shareLink{float:left}.od-PermissionPile-accessibleLabel{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-PermissionsPanel-stopSharing{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:1rem;background:0 0;border:none;padding:0;cursor:pointer}.od-PermissionsPanel-stopSharing:focus,.od-PermissionsPanel-stopSharing:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-PermissionsPanel-stopSharing a:focus{border:.0625rem solid "},{theme:"white",defaultValue:"#fff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-PermissionsPanel-stopSharing a:focus{border:.0625rem solid "},{theme:"black",defaultValue:"#000"},{rawString:"}}.od-PermissionsPanel-entity{padding:.5rem 0;font-size:.75rem}.od-PermissionsPanel-entity .od-Persona .od-Persona-details{display:inline-block;max-width:200px;padding:0}.od-PermissionsPanel-addPeople{font-size:1.0625rem;min-height:3.125rem;padding-bottom:.625rem}.od-PermissionsPanel-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:1.25rem;border-radius:50%;width:3.125rem;height:3.125rem}[dir=ltr] .od-PermissionsPanel-addPeople-icon{margin-right:.625rem}[dir=rtl] .od-PermissionsPanel-addPeople-icon{margin-left:.625rem}.od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:.75rem;left:.9375rem}.od-PermissionsPanel-addPeople-text{display:inline-block;vertical-align:top;line-height:3.125rem}.od-PermissionsPanel-linksBox a{display:inline-block;margin-top:.3125rem}.od-PermissionsPanel-link{padding-top:.5rem}.od-PermissionsPanel-container{overflow:hidden}.od-PermissionsPanel-container-withCommandbar{top:40px}.od-PermissionsPanel-head{font-size:1.25rem;font-weight:600;margin-bottom:.5rem}.od-PermissionsPanel-fileName{font-size:.875rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:1.5625rem}[dir=ltr] .od-PermissionsPanel-fileName{padding-right:2.5rem}[dir=rtl] .od-PermissionsPanel-fileName{padding-left:2.5rem}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path{padding:.1875rem;display:inline-block;vertical-align:middle}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element{display:inline;word-break:break-all}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:';padding:0 .3125rem;font-size:.5rem;font-weight:800;content:"\\e76c"}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:last-child:after{content:"";display:none}html[dir=rtl] .od-PermissionsPanel-Path-Element:after{content:"\\e76b"}.od-PermissionsPanel-titleBar{padding-top:1rem;padding-bottom:.25rem;border-bottom:solid .0625rem '},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}[dir=ltr] .od-PermissionsPanel-titleBar{padding-left:1rem}[dir=rtl] .od-PermissionsPanel-titleBar{padding-right:1rem}.od-PermissionsPanel-parent{height:100%}.od-PermissionsPanel-content{padding-top:15px;padding-left:32px;padding-right:5px}.od-PermissionsPanel-linksBox,.od-PermissionsPanel-linksBox-row{right:0;bottom:0}.od-SharingSection-PermissionsPile{width:20rem;background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";box-sizing:border-box;margin-bottom:1rem;padding:1rem 1.5rem}.od-SharingSection-PermissionsPile .InfoPane-sectionHeader{cursor:default;padding-bottom:0}.od-SharingSection-PermissionsPile .od-Link:focus-visible{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-ManageAccessLink-Button{border:0;background:"},{theme:"white",defaultValue:"#fff"},{rawString:";font-size:inherit;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer}.od-SharingSection-PermissionsPile-personas{margin-bottom:.25rem}.od-SharingSection-PermissionsPile-personas .od-Persona{display:inline-block;width:2rem;height:2rem;box-sizing:border-box;cursor:pointer;vertical-align:top}[dir=ltr] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-right:.25rem}[dir=rtl] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-left:.25rem}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs{border:.0625rem solid transparent}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs .od-Persona-initials{font-size:1rem}.od-SharingSection-PermissionsPile-personas .od-Persona.od-HasAccessControl{text-align:center;padding:.375rem 0;height:unset;width:unset}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Pointer{cursor:auto}.od-SharingSection-PermissionsPile-personas .od-Persona-presence{box-sizing:border-box;border:.0625rem solid "},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-SharingSection-PermissionsPile-personas .od-PersonaTile{outline:0}.od-SharingSection-PermissionsPile-personas .od-Persona-image[disabled] .od-SharingSection-PermissionsPile-addFriend{cursor:default;background-color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}.od-focus--enabled .od-Persona--xs:focus{box-shadow:0 0 0 .0625rem "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:" inset}.od-SharingSection-PermissionsPile-addFriend{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:";height:100%;border-radius:50%;position:relative;font-size:1.0625rem}.od-SharingSection-PermissionsPile-numberText{font-size:.625rem;padding-top:1rem;text-align:center;pointer-events:none;color:"},{theme:"black",defaultValue:"#000"},{rawString:";line-height:normal}.od-SharingSection-PermissionsPile-personaBorder{box-sizing:border-box}.od-SharingSection-PermissionsPile-personaBorder:focus{outline:.0625rem solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-PermissionsPile-personaBorder .ms-Icon{font-size:.875rem}.od-SharingSection-PermissionsPile-personaIcon{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:100%;pointer-events:none;color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";border-radius:50%}.od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{position:absolute;top:.25rem;transform:translateX(-50%);color:"},{theme:"neutralDark",defaultValue:"#201f1e"},{rawString:";font-size:.75rem;line-height:normal}[dir=ltr] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{right:50%}.od-SharingSection-PermissionsPile-personaMore{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:100%}.od-SharingSection-PermissionsPile-moreNumber{position:absolute;font-size:.625rem;top:50%;transform:translate(-50%,-50%);color:"},{theme:"black",defaultValue:"#000"},{rawString:"}[dir=ltr] .od-SharingSection-PermissionsPile-moreNumber{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-moreNumber{right:50%}.od-SharingSection-PermissionsPile-description{margin-bottom:.25rem;padding:.125rem}.od-SharingSection-PermissionsPile-description .ms-Icon{font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.od-SharingSection-PermissionsPile-descriptionText{display:inline-block;font-size:.75rem;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";vertical-align:top;padding:.1875rem}.od-Persona .od-Persona--xs{display:inline-block}.od-SharingSection-PermissionsPile-personas .od-Persona .od-Persona-details{display:none}.od-Panel-button--close .ms-Icon--Cancel{font-size:1rem}.od-ShowPermissions-commandBar{outline:0;margin:0;border:0;top:0;width:100%;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .ms-CommandBar{animation:none}}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 .0625rem 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button i{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:0 0 0 .0625rem "},{theme:"white",defaultValue:"#fff"},{rawString:" inset}.od-ShowPermissions-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(0.1,0.9,0.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .CommandBar{animation:none}}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 .0625rem 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:.75rem;padding-right:.75rem}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:.0625rem solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";margin:.125rem -.5rem}"}]);var Er=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.state=n.createPureComputed(n._computeState),n._itemSelectionHelper=new(n.child(nn.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),n._itemCommandHelper=n.resources.consume(sn.t),n.engagementSource=t.engagementSource,n}return Object(i.__extends)(t,e),t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem.peek(),engagementSource:this.engagementSource}},t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this._itemCommandHelper.isCommandSupported(e,Ha.s),n=e&&e.remoteItem;return{isAvailable:!!e&&t&&!n}},t}($.n),Ar=Object(ni.e)({name:"ShowPermissions",source:{moduleDefinition:{path:"./ShowPermissionsExecutor",getModule:function(){return I.n.resolve(n.ee([37,"ondemand.resx-ondemand"],1703))}}},handlerType:Er});Object(Pn.e)([{rawString:".od-SuggestedFiles-titleBar{padding-bottom:8px}.od-SuggestedFiles-head{font-size:20px;font-weight:600}.od-SuggestedFiles-description{padding:4px 0 12px;font-size:14px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}"}]);var Lr=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.state=n.createPureComputed(n._computeState),n}return Object(i.__extends)(t,e),t.prototype._computeState=function(){return{isAvailable:!0}},t}($.n),kr=Object(ni.e)({name:"ShowSuggestedFiles",source:{moduleDefinition:{path:"./ShowSuggestedFilesExecutor",getModule:function(){return I.n.resolve(n.ee([38,"ondemand.resx-ondemand"],1741))}}},handlerType:Lr}),Mr=n(575),Pr=n(388),Tr=n(355),Ur=n(384),Fr=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="ShowCopilot",t}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){try{var n=this.resources.consume(Ur.e);return n(!n()),this.resources.consume(Tr.e)(!1),this.resources.consume(Pr.e)(!1),this.resources.consume(bi.e.columnCustomizationPane.isColumnCustomizationPaneExpanded)(!1),sa.t.raise(document.body,"resize",void 0,!0),I.n.wrap({resultType:v.t.Success})}catch(e){return I.n.wrap({resultType:v.t.Failure})}},t.prototype.onIsAvailable=function(){return Object(de.es)(de.vr)},t.prototype.onIsToggled=function(){return!1},t}(Xt.e),Hr=Fr,Rr=n(320),Nr=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="ShowSelection",a._urlDataSource=a.resources.consume(V.H),a._isSelectionModal=a.resources.consume(Rr.t),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!0,canFallback:!1}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return(this._itemSelectionHelper.selection().length>0||this._isSelectionModal())&&this._urlDataSource.getPageType()!==oe.e.TextFileEditor},t.prototype.onExecute=function(e,t){return this._itemSelectionHelper.clearSelection(),this._isSelectionModal(!1),I.n.resolve({resultType:v.t.Success})},t}(Xt.e),Br=n(209),jr=n(317),Vr=function(e){function t(t,n){void 0===t&&(t={});var a=e.call(this,t,n)||this;return a._pageLayoutType=n.pageLayoutType,a.layoutType=a._getLayoutType(),a._debouncer=a.scope.attach(new jr.e),a}return Object(i.__extends)(t,e),t.prototype._getLayoutType=function(){var e=this,t=this.observables,n=t.create("");return t.backgroundCompute(function(){var t=e._pageLayoutType(),a=Br.o[t];e._debouncer.debounce(a?a().then(function(e){return e.tagName}):I.n.wrap("")).then(function(e){n(e)})}),n},t.dependencies=Object(i.__assign)(Object(i.__assign)({},$.n.dependencies),{pageLayoutType:bi.n.layoutType}),t}($.n),zr=new De.t({name:"".concat("ToggleListLayoutHelper",".layoutTypeResolver"),factory:new j.n(Vr)}),Gr=(new De.t({name:"".concat("ToggleListLayoutHelper",".resolvedLayoutType"),factory:{dependencies:{layoutTypeResolver:zr},create:function(e){return{instance:e.layoutTypeResolver.layoutType}}}}),function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.pageLayoutType=n.resources.consume(bi.n.layoutType),n}return Object(i.__extends)(t,e),t.prototype.changeLayout=function(e){var t=this;return(0,Br.o[e])().then(function(n){return t.pageLayoutType(n.tagName),I.n.resolve({resultType:v.t.Success,extraData:{layout:e}})})},t}($.n)),Kr=n(56),Wr=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ToggleListLayout",n._layoutType=Br.u(t.layoutType),n._shouldClearContextualFilter=void 0===t.clearContextualFilter||t.clearContextualFilter,n._currentItem=n.resources.consume(Na.i),n._viewParams=n.resources.consume(Na.D),n._actionMap=n.resources.consume(Na.e),n._urlDataSource=n.resources.consume(V.H),n._helper=new(n.managed(Gr)),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.resources.consume(na.t),t=this._currentItem(),n=t&&t.queryType,a=t.key!==this._urlDataSource.getRootItemKey(Y.e.SharedWithMe)&&n!==Y.e.DocsInCommon;e||(a=a&&n!==Y.e.AllMyPhotos);var i=this._urlDataSource.getKeyParams(t.key),r=t.virtualItemType!==Kr.e.Album;return this._layoutType===Br.s&&(r=n===Y.e.Files),e&&n===Y.e.AllMyPhotos&&(r=!("allmyphotos"!==i.qt||i.tagFilter||i.locationFilter||i.onThisDay||i.onThisMonth||i.lastWeekPreviousYears)),"allmyphotos"===i.qt&&(r=this._layoutType!==Br.i&&this._layoutType!==Br.t),a&&r},t.prototype.onExecute=function(e,t){var n,a=this;if(this._shouldClearContextualFilter){var i=Ii.e({},this._viewParams.peek());delete i.ft,n=new(this.managed(this._actionMap.NavigationAction))({url:"#".concat(E.n(i))}).execute(e)}else n=I.n.wrap();return n.then(function(){return a._helper.changeLayout(a._layoutType)},function(){return a._helper.changeLayout(a._layoutType)})},t.prototype.onIsToggled=function(){return this._layoutType===this._helper.pageLayoutType()},t}(Xt.e),qr=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ViewOriginal",n._itemCommandHelper=new(n.managed(sn.e)),n._selectionHelper=new(n.child(nn.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),n._url=n.observables.pureCompute(function(){var e=n._selectionHelper.firstItem(),t=e&&e.photo&&e.photo.originalUrl;return t&&t.replace(/#/g,"%23")}),n._navigationAction=new(n.managed(hi.e))({url:n._url,target:"_blank"}),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return!!e&&!!this._url()&&this._itemCommandHelper.isCommandSupported(e,yn)},t.prototype.onExecute=function(e,t){return this._url.peek()?this._navigationAction.execute(e):I.n.reject({})},t}(Xt.e),Qr=n(213),Yr=n(465),Jr=n(539),Xr=n(448),Zr=n(467),$r=n(280),eo=n(516),to=function(e){function t(t){var n=e.call(this,t)||this;return n.logStartEnd=!0,n.name="Upload."+Qr.e[n.uploadProcessorType],n._itemRedeemer=n.resources.consume(on.e),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){if(!this._isPlatformSupported())return!1;var t=this.item();return e.prototype.onIsAvailable.call(this)&&t.type===an.e.Folder},t.prototype.onExecute=function(t,n){var a=this,i=this.item.peek();return this._itemRedeemer.redeemItem(i,this).then(function(){return e.prototype.onExecute.call(a,t,n)})},t.prototype._isPlatformSupported=function(){var e=!1,t=this.platform.isIPad&&this.platform.browserMajor<6;if(this.platform.isWinAppWipEnabled)return!1;if(!t)switch(this.uploadProcessorType){case Qr.e.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case Qr.e.Folder:e=this.platform.isFolderUploadSupported}return e},t}(function(e){function t(t){var n=e.call(this,t)||this;return n.name="Upload",n.platform=n.resources.consume(Yn.e),n.uploadProcessorType=t.uploadProcessorType,n._resetInputElement(),n.addDisposable({dispose:function(){n._inputElement&&(document.body.removeChild(n._inputElement),n._inputElement=void 0)}}),n.itemCommandHelper=n.resources.consume(sn.t),n.skipInvalidation=!1,n._currentItemSet=n.resources.consume(Na.r.optional),n._createUploadObserver=t.createUploadObserver,n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){this.resources.consume(ze.e).logData({name:"Upload.TopMenu.Click",isIntentional:!0});var n=new y.e;return window.sessionStorage.getItem("_isRunningTABTest")||this._clickHiddenInput(n),n.getPromise()},t.prototype.onIsAvailable=function(){var e=!1,t=this.item();if(!this.itemCommandHelper.isCommandSupported(t,pa))return!1;switch(this.uploadProcessorType){case Qr.e.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case Qr.e.Folder:e=this.platform.isFolderUploadSupported}return e&&!t.isPlaceholder&&t.queryType===Y.e.Files},t.prototype._resetInputElement=function(){var e=this;this._inputElement&&document.body.removeChild(this._inputElement);var t=document.createElement("input");this._inputElement=t,t.style.display="none",t.type="file";var n="commandFileInput";this.uploadProcessorType===Qr.e.Folder&&(n="commandFolderInput",t.webkitdirectory=!0),t.className=n,t.multiple=!0,t.onchange=function(n){e._uploadFiles(t).done(function(){e._resetInputElement()})},document.body.appendChild(t)},t.prototype._clickHiddenInput=function(e){var t=this,n=this._inputElement;n.onchange=function(a){t._uploadFiles(n).then(function(t){e.complete(t)},function(t){e.error(t)}).then(function(){t._resetInputElement()})},n.click()},t.prototype._uploadFiles=function(e){var t=this,n=Array.prototype.slice.call(e&&(e["test-files"]||e.files)||[]);if(n){var a=this._createUploadObserver&&this._createUploadObserver(),i=fe.e.isActivated("5C4BC63E-54D5-4F24-8333-E6905633B445","9/4/2020","Wait for KO item to resolve before upload")?void 0:a&&a.resolveParentItem();return I.n.resolve(i).then(function(){return I.n.resolve(t.resources.consumeAsync(Yr.e))}).then(function(e){var i=new e({files:n,parentItem:t.item.peek(),wasDragAndDropped:!1,type:t.uploadProcessorType,itemSet:t._currentItemSet&&t._currentItemSet.peek(),skipInvalidation:t.skipInvalidation,isTemplate:t.isTemplate,onItemUploaded:function(e){a&&a.onItemUploaded(e),t.resources.consume(Jr.e)(e)}});return i.start(),i.wait()}).then(function(){return a&&a.onUploadCompleted(),function(e,t,n){if(e.isExposed(V.d)){var a=e.consume(Xr.i.optional),i=!1;if(a&&a.isSPO){var r=Number(a.webTemplate)===Zr.t.mySite;if(i=!!a.listBaseTemplate&&Object($r.r)(a.listBaseTemplate),r&&!i)return}var o=i?"FloodgateForLists.":"FloodgateForSPO.";try{var s=e.consume(V.d),c=i?eo.e:"SPListAction";s.recordUserAction(c,t)}catch(e){pe.e.logData({name:o+"error"+t,extraData:{error:e}})}}}(t.resources,"uploadAction"),{resultType:v.t.Success}},function(e){return a&&a.onUploadCompleted(),I.n.reject(e)})}return I.n.wrap({resultType:v.t.ExpectedFailure})},t}(Kn.e)),no="caption",ao={scenario:"updateDescription"},io=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._itemCommandHelper=new(t.managed(sn.e)),t}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var t=this.item();return e.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(t,bn)&&!(t.vault&&t.vault.root&&t.vault.isLocked)},t}(function(e){function t(t){var n=e.call(this,t)||this;return n.name="UpdateCaption",n.caption=t.caption,n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){var n,a,i,r,o;if(!Object(ce.isFeatureEnabled)(ce.UseVroomUpdateCaption))return this.resources.consume(cn.resourceKey).updateItemProperty({item:this.item(),propertyName:no,propertyValue:this.caption(),overrideLock:!0,qosPostfix:no}).then(function(){return{resultType:v.t.Success}});var s=this.resources.consume(ee.e),c=((n={}).description=this.caption(),n),d=this.item();if(!(null===(a=d.graph)||void 0===a?void 0:a.itemId))return I.n.wrapError(new Error("invalid itemId"));var l="".concat(Object(Ce.s)({apiVersion:"v2.1",driveId:(null===(i=d.graph)||void 0===i?void 0:i.driveId)||"me"}),"/drives/").concat((null===(r=d.graph)||void 0===r?void 0:r.driveId)||"me","/items/").concat(null===(o=d.graph)||void 0===o?void 0:o.itemId);s.send({apiName:"updateItem_".concat("description").concat(Object(Gt.e)(xe.H)?".migratedUser":""),path:l,useAuthorizationHeaders:!0,requestType:"PATCH",postData:JSON.stringify(c),headers:ao}).then(function(){return{resultType:v.t.Success}})},t.prototype.onIsAvailable=function(){if(Object(ce.isFeatureEnabled)(ce.EnableSamsungMotionPhotoVideos)){var e=this.item();return!(e&&e.photo&&e.photo.isSamsungMotionPhoto)}return!0},t}(Kn.e)),ro=io;Object(Pn.e)([{rawString:"html[dir=ltr] .od-sharesurvey-preview{float:left}html[dir=rtl] .od-sharesurvey-preview{float:right}[dir=ltr] .od-sharesurvey-preview{margin-right:10px}[dir=rtl] .od-sharesurvey-preview{margin-left:10px}.od-sharesurvey-details{max-width:350px}html[dir=ltr] .od-sharesurvey-details{float:left}html[dir=rtl] .od-sharesurvey-details{float:right}.od-sharesurvey-create{margin-top:10px}.od-sharesurvey-textbox{padding:1px 5px 2px 10px;margin:10px 0;width:100%;box-sizing:border-box;text-overflow:ellipsis}html[dir=rtl] .od-sharesurvey-textbox{padding:1px 10px 2px 5px}.od-sharesurvey-error{color:"},{theme:"redDark",defaultValue:"#a4262c"},{rawString:"}"}]);var oo=n(461),so=n(340),co=n(203),lo=n(331),uo=n(456),fo=function(e){function t(t){var n=e.call(this,t)||this;return n.loadingSpinnerTagName=uo.e.tagName,n._item=t.item,n.previewSrc=t.previewSrc,n.isLoading=Rn.observable(!0),n.sharingLink=Rn.observable(null),n.hasError=Rn.observable(!1),n.instructionsText=co.i,n.createText=co.e,n.removeText=co.r,n.loadingText=co.a,n.errorText=co.n,n._sharingProvider=n.resources.consume(oo.resourceKey),n._getSharingInfo(),n.addBindingHandlers({selectOnFocus:so.e}),n}return Object(i.__extends)(t,e),t.prototype.onCreateClicked=function(){var e=this;this.isLoading(!0);var t={type:lo.e.Form,role:ra.e.Submitter,create:!0};this._sharingProvider.manageSharingLinks([this._item],t).done(function(){e._getSharingInfo()},function(t){e.isLoading(!1),e.hasError(!0)})},t.prototype.onRemoveClicked=function(){var e=this;this.isLoading(!0);var t={id:this.sharingLink().id,type:lo.e.Form,role:ra.e.None,create:!1};this._sharingProvider.manageSharingLinks([this._item],t).done(function(){e.isLoading(!1),e.sharingLink(null)},function(t){e.isLoading(!1),e.hasError(!0)})},t.prototype._getSharingInfo=function(){var e=this;this._sharingProvider.getSharingData(this._item).getLinks().then(function(t){if(e.isLoading(!1),t)for(var n=0,a=t;n<a.length;n++){var i=a[n];i.type===lo.e.Form&&e.sharingLink(i)}})},t}(Un.e),po=Bn.e({tagName:"od-share-survey",template:'<div class="ShareSurvey"><div class="od-sharesurvey-preview"><img data-bind="attr:{src:previewSrc}"></div><div class="od-sharesurvey-details">\x3c!--ko if:isLoading--\x3e<span class="ms-font-m" data-bind="component:{name:loadingSpinnerTagName,params:{loadingText:loadingText}}"></span>\x3c!--/ko--\x3e\x3c!--ko if:!isLoading()--\x3e<span class="od-sharesurvey-instructions" data-bind="text:instructionsText"></span>\x3c!--ko if:!sharingLink()--\x3e<button class="od-Button od-sharesurvey-create" data-bind="click:onCreateClicked"><span class="od-Button-label" data-bind="text:createText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if:sharingLink()--\x3e<input type="text" class="od-sharesurvey-textbox" readonly data-bind="attr:{value:sharingLink().url},selectOnFocus:{isPermanent:true}"><br><button class="od-Button" data-bind="click:onRemoveClicked"><span class="od-Button-label" data-bind="text:removeText"></span></button>\x3c!--/ko--\x3e<br>\x3c!--ko if:hasError()--\x3e<span class="od-sharesurvey-error" data-bind="text:errorText"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class="ms-clearfix"></div></div>',viewModel:fo,synchronous:!0}),mo=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="Survey",a._actionType=t.actionType,a._navigation=a.resources.consume(B.e),a._dialogProvider=a.resources.consume(Vn.e),a._itemCommandHelper=new(a.managed(sn.e)),a._urlDataSource=a.resources.consume(z.n),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this,t=this._getCommandKey();return this._itemSelectionHelper.filterItems(function(n){return e._itemCommandHelper.isCommandSupported(n,t)})},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var t,n,a,r,o,s,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(t=i.sent())?1===this._actionType?[2,this.showShareDialog(t)]:(n=this._navigation,a=this._urlDataSource.getAuthKeyParamValue(),r=this._urlDataSource.getTicketParamValue(),o=n.viewParams.qt,s=3===this._actionType?3:2,c=Fa.s("/edit.aspx?cid={0}&resid={1}&wacqt={2}&formAction={3}&app=Excel",K.e.viewerId,t.id,o||"",s),a?c+="&authKey="+a:r&&(c+="&ticket="+r),[2,new(this.managed(hi.e))({url:c,target:"_blank"}).execute(e)]):[2,I.n.resolve({resultCode:"EmptySelection",resultType:v.t.Failure})]}})})},t.prototype.showShareDialog=function(e){var t=Fa.s(co.o,e.name);return this._dialogProvider.requestDialog({title:t,size:"Large",component:{name:po.tagName,params:{item:e,previewSrc:FilesConfig.imgBaseUrl+"images/embed_form.png"}},actions:[{name:co.t,execute:function(){return I.n.resolve(2)},isAvailable:this.observables.create(!0),isVisible:this.observables.create(!0),icon:new kn.e("Cancel")}]}).wait().then(function(){return{resultType:v.t.Success}})},t.prototype._getCommandKey=function(){switch(this._actionType){case 1:return fa.c;case 2:return fa.d;case 3:return fa.r}},t}(Xt.e),_o=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="AddToSharedList",a._itemReedemer=a.resources.consume(on.e),a._itemCommandHelper=new(a.managed(sn.e)),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,Ha.t)},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=n.sent())?[2,this._itemReedemer.redeemItem(e,this,!0).then(function(){return t.resources.consume(cn.resourceKey).invalidateItem(e.key,{triggerFetch:!0}),{resultType:v.t.Success}})]:[2,I.n.resolve({resultCode:"EmptySelection",resultType:v.t.Failure})]}})})},t}(Xt.e),ho=Le.e.isActivated("C092CAF4-C574-4ADB-9783-65C549F8FBFC","11/22/2022","Only show the remove from shared list command in the Shared with me view"),bo=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="RemoveFromSharedList",n._itemCommandHelper=new(n.managed(sn.e)),n._currentItem=Object(de.es)(de.Z)?n.selectionHelper.currentItem:n.resources.consume(Na.i),n._urlDataSource=n.resources.consume(K.t),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./RemoveFromSharedListExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([24,"ondemand.resx-ondemand"],1725))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek(),selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return(ho||this._urlDataSource.isCurrentQuerySharedWithMe())&&this._itemCommandHelper.isCommandSupported(e,Ha.i)},t}(mn.e),go=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="AddToBundleAction",n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./AddToBundleExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([6,"ondemand.resx-ondemand"],1680))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&e.ownerId&&e.ownerId.toUpperCase(),n=K.e.viewerId&&K.e.viewerId.toUpperCase();return e&&e.isBundle&&t===n},t}(mn.e),vo=n(540),yo=Le.t.isActivated("7B5F7746-6573-454C-B237-500C813D8D50","4/19/2022","Fix the remove from bundle availability logic in ItemsScope"),So=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveFromBundleAction",a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(Object(de.es)(de.po)){var t=this._itemSelectionHelper.currentItem();if(yo)return!!e&&!!(null==t?void 0:t.isBundle)&&!t.isAlbum&&Object(xe.M)(t.ownerId);var n=t&&t.ownerId&&t.ownerId.toUpperCase(),a=xe.H.toUpperCase(),i=(null==e?void 0:e.parentKey)&&Object(xe.h)(e.parentKey),r=t.id&&i&&i.id===t.id;return!(!e||!t.isBundle||!r||n!==a)}return!!(e&&e.UNSAFE_parent&&e.UNSAFE_parent.isBundle)&&e.UNSAFE_parent.ownerId===K.e.viewerId},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this.resources.consumeAsync(vo.e).then(function(n){var a=new n({items:e.map(function(e){return e.id}),bundleAction:1,item:e[0].UNSAFE_parent});return t.trackPromise(a.start()),a.wait()}).then(function(){return{resultType:v.t.Success}})]:[2,I.n.resolve({resultCode:"EmptySelection",resultType:v.t.Failure})]}})})},t}(Xt.e),Do=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="ReportAbuse",n._navigation=n.resources.consume(B.e),n}return Object(i.__extends)(t,e),t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}},t.prototype.getExecutorPath=function(){return"./ReportAbuseExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([26,"ondemand.resx-ondemand"],1711))}},t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this.itemCommandHelper.isCommandSupported(e,Ha.r)||Object(ce.isFeatureEnabled)(ce.EnableAnonReportConcernCommand)&&!K.e.viewerId&&e&&!e.itemStatus&&(!e.folder||e.type===an.e.OneNote)},t.prototype.onExecute=function(t,n){return Object(ce.isFeatureEnabled)(ce.EnableAnonReportConcernCommand)&&!K.e.viewerId?(this._navigation.navigateTo({url:"https://www.microsoft.com/concern/onedrive",frameId:"_blank"}),I.n.wrap({resultType:v.t.Success})):e.prototype.onExecute.call(this,t,n)},t}(mn.e),Io=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveMountPoint",a._urlDataSource=a.resources.consume(V.H),a._dialogProvider=a.resources.consume(Vn.e),a._itemProvider=a.resources.consume(cn.resourceKey),a._navigation=a.resources.consume(B.e),a._itemCommandHelper=new(a.managed(sn.e)),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,Ha.a)},t.prototype.onExecute=function(e,t){var n=this,a=this._itemSelectionHelper.currentItem.peek(),i=this._itemProvider,r=this._navigation,o=this._dialogProvider;return this._itemSelectionHelper.resolveFirst().then(function(e){if(!e)return{resultType:v.t.ExpectedFailure};var t=e.UNSAFE_parent,s=Fa.s(Qn.RemoveMountPointDetails2,e.name);return o.requestDialog({title:Qn.RemoveMountPointTitle,component:{name:Qa.e.tagName,params:{text:s}},actions:[{name:Qn.RemoveMountPoint,execute:function(){return I.n.resolve(2)},isAvailable:n.observables.create(!0),icon:new kn.e("Cancel"),isDefault:!0}]}).wait().then(function(){return n._itemSelectionHelper.clearSelection(),i.removeMountPoint({parentKey:a.key,item:e}).then(function(){var e,a=t?n._urlDataSource.getDefaultClickUrl(t):"";Object(de.es)(de.po)&&(e=n._urlDataSource.getRootUrl());var i=a||e;return r.navigateTo(i),{resultType:v.t.Success}})})})},t}(Xt.e),xo=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="RequestReview",n._itemCommandHelper=new(n.managed(sn.e)),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./RequestReviewExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([27,"ondemand.resx-ondemand"],1735))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!Object(ce.isFeatureEnabled)(ce.UseVroomApiForRequestReview),canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,Ha.o)},t}(mn.e),Co=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="ViewInFolderAction",a._navigation=a.resources.consume(B.e),a._urlDataSource=a.resources.consume(z.n),a._itemReedemer=a.resources.consume(on.e),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=e&&e.parentKey&&Object(Be.e)(e.queryType),n=this._urlDataSource.isCurrentQuery(Y.e.Photos);return!!e&&(t||n&&e.type===an.e.Media)&&K.e.areCidsEqual(e.ownerId,K.e.viewerId)},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var e,t=this;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=n.sent())?[2,this._itemReedemer.redeemItem(e,this).then(function(){return t._navigation.navigateTo({url:t._urlDataSource.getItemUrl(e.parentKey,{page:oe.e.Files})}),I.n.resolve({resultType:v.t.Success})})]:[2,I.n.resolve({resultCode:"EmptySelection",resultType:v.t.Failure})]}})})},t}(Xt.e),Oo=n(541),wo=n(542),Eo=function(e){function t(t){var n=e.call(this,t)||this;n.name="SignOut",n.url=t.url,n.target=t.target||"_top",n._navigation=n.resources.consume(B.e),n._sessionProvider=n.resources.consume(G.e);var a=Oo.e+n._sessionProvider.getIdentity().id;return n._dataStore=new me.e(a,_e.e.local),n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){this._sessionProvider.signOut();try{delete localStorage["onedrive.autoredirect"]}catch(e){}return this._dataStore.remove(wo.e,_e.e.session),this._dataStore.remove("officeFileOpenQuotaDialogShownThisSession",_e.e.session),this.url&&"#"!==this.url&&this._navigation.navigateTo({url:this.url,frameId:this.target}),I.n.wrap({resultType:v.t.Success})},t.prototype.onIsAvailable=function(){return!0},t}(Xt.e),Ao=n(426),Lo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="ToggleDebugWindow",t}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!0},t.prototype.onExecute=function(e,t){if(Ao.e.isInitialized()){var n=this.resources.consume(Na.u);n(!n())}else Ao.e.init(this.resources);return I.n.wrap({resultType:v.t.Success})},t}(Xt.e),ko=Lo,Mo=n(484),Po=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveFromAlbum",a._itemCommandHelper=new(a.managed(sn.e)),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.currentItem(),t=this._itemSelectionHelper.firstItem();return!!e.isAlbum&&!!t&&this._itemCommandHelper.isCommandSupported(t,xn)},t.prototype.onExecute=function(e,t){var n=this,a=this._itemSelectionHelper.currentItem();return this._itemSelectionHelper.resolveSelection().then(function(e){n._itemSelectionHelper.clearSelection();var t={album:a,items:e};return I.n.resolve(n.resources.consumeAsync(Mo.e)).then(function(e){return e.removeFromAlbum(t)}).then(function(){return n._refreshItemsScopeRemovedItems(e),{resultType:v.t.Success}},function(e){return n._refreshItemsScopeCurrentItemSet(),{resultType:v.t.Failure}})})},t.prototype._refreshItemsScopeRemovedItems=function(e){this.resources.consume(na.e)&&this.resources.consumeAsync(V.h).then(function(t){for(var n=0,a=e;n<a.length;n++){var i=a[n];i.id&&t.invalidateItems(i.key)}})},t.prototype._refreshItemsScopeCurrentItemSet=function(){this.resources.consume(na.e)&&this.resources.consumeAsync(V.h).then(function(e){e.invalidateCurrentItemSet()})},t}(Xt.e),To=n(46),Uo=!fe.e.isActivated("B8D2D2A7-E86C-4603-A180-25887F432C8C","",""),Fo=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,a=t.item;return n._itemSelectionHelper=new(n.child(nn.e))({overrideItem:a,allowMultiSelect:!1,canFallback:!0}),n._itemCommandHelper=new(n.managed(sn.e)),n.state=n.createPureComputed(n._computeState),n}return Object(i.__extends)(t,e),t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})},t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:!!e&&!!To.e.hcid&&e.virtualItemType===Kr.e.Album&&(!Uo||e.ownerId&&Object(xe.M)(e.ownerId))&&this._itemCommandHelper.isCommandSupported(e,Cn)}},t}($.n),Ho=Object(ni.e)({name:"AddPhotosToAlbum",source:{moduleDefinition:{path:"./AddPhotosToAlbumExecutor",getModule:function(){return I.n.resolve(n.ee([4,"ondemand.resx-ondemand"],1751))}}},handlerType:Fo}),Ro=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._itemSelectionHelper=new(n.child(nn.e))({allowMultiSelect:!1,canFallback:!0}),n.state=n.createPureComputed(n._computeState),n}return Object(i.__extends)(t,e),t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:e&&e.virtualItemType===Kr.e.AlbumRoot}},t}($.n),No=Object(ni.e)({name:"CreateAlbum",source:{moduleDefinition:{path:"./CreateAlbumExecutor",getModule:function(){return I.n.resolve(n.ee([10,"ondemand.resx-ondemand"],1726))}}},handlerType:Ro}),Bo=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;a.name="SelectAction";var i=n.itemSelectionHelperType,r=void 0===i?a.resources.consume(nn.e):i,o=n.actionMap,s=void 0===o?a.resources.consume(Na.e):o;return a._item=t.item,a._selectItems=t.selectItems,a._itemSelectionHelper=new r({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1}),t.showProperties&&(a._showPropertiesAction=new(a.managed(s.ShowPropertiesAction))({})),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!!e&&!e.isPlaceholder},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var t,n=this;return Object(i.__generator)(this,function(a){switch(a.label){case 0:return this._selectItems?(t=this._selectItems.map(function(e){return n.observables.peekUnwrap(e)}),this._itemSelectionHelper.selectItems(t)):this._item&&this._itemSelectionHelper.selectItems([this.observables.peekUnwrap(this._item)]),this._showPropertiesAction?[4,this._showPropertiesAction.execute(e)]:[3,2];case 1:a.sent(),a.label=2;case 2:return[2,{resultType:v.t.Success}]}})})},t}(Xt.e),jo=function(e){function t(t,n){void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="SelectAll",a._selectionModel=a.resources.consume(Na.b),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return 0===this._selectionModel.mode},t.prototype.onExecute=function(e,t){return this._selectionModel.selectAll(),I.n.resolve({resultType:v.t.Success})},t}(Xt.e),Vo=n(91),zo=function(e){function t(t){var n=e.call(this,t)||this;return n.name="FilterSearch",n._filter=t.filter,n._urlDataSource=n.resources.consume(V.H),n._viewParams=n.resources.consume(Na.D),n._showCurrentView=t.showCurrentView,n._url=n.createPureComputed(n._computeUrl),n._supportsSearchFiltering=n._getSupportsSearchFiltering(),n._navigationAction=new(n.managed(hi.e))({url:n._url,forceNavigation:!0}),n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)},t.prototype.onIsAvailable=function(){return this._viewParams(),this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&Object(Be.e)(this._urlDataSource.getQueryType())&&this._navigationAction.isAvailable()},t.prototype.onIsToggled=function(){this._viewParams();var e=Object(Be.e)(this._urlDataSource.getQueryType())&&this._urlDataSource.isSearchFilterApplied(this._filter)&&!this._urlDataSource.isSearchPassThrough();return e&&this._showCurrentView(e&&this._filter!==Vo.t.all),e},t.prototype._computeUrl=function(){return this._viewParams(),this._urlDataSource.getSearchFilterQueryUrl(this._filter)},t.prototype._getSupportsSearchFiltering=function(){var e=this.createObservable(!1);return I.n.resolve(this.resources.consumeAsync(V.w)).done(function(t){e(t.getCapabilities().supportsSearchFiltering)}),e},t}(Xt.e),Go=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="RemoveTagFromItem",a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item}),a._viewParams=a.resources.consume(Na.D),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.currentItem(),t=this._itemSelectionHelper.firstItem();return e.virtualItemType===Kr.e.Tag&&!!t&&!!e.tags&&e.tags.length>0},t.prototype.onExecute=function(e,t){var n=this,a=this._itemSelectionHelper.currentItem(),i=a.tags,r=this.resources.consume(q.f),o=this.resources.consume(q.o).getAllPhotosSettings().peek();return this._itemSelectionHelper.resolveSelection().then(function(e){var t,s=e[0],c=s&&s.tags;if(c&&i)for(var d=0,l=c;d<l.length;d++){var u=l[d];if(u.tag===i[0].tag){t=u;break}}if(n._itemSelectionHelper.clearSelection(),!t)return I.n.resolve({resultType:v.t.Failure});var f=!1,p=n._viewParams.peek();return n.resources.consume(na.t)&&void 0===p.tagFilter&&(f=!0),r.updateTags({items:e,tagsToAdd:null,tagsToDelete:[t],parentKey:a.key,rootItemId:o.rootId,skipInvalidate:f}).then(function(){return{resultType:v.t.Success}})})},t}(Xt.e),Ko=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SetAlbumCoverPhoto",n._currentItem=Object(de.es)(de.Z)?n.selectionHelper.currentItem:n.resources.consume(Na.i),n._itemCommandHelper=new(n.managed(sn.e)),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./SetAlbumCoverPhotoExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([33],1774))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1}},t.prototype.getExecutorParameters=function(){return{itemSelectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}},t.prototype.onIsAvailable=function(){var e=this._currentItem(),t=this.selectionHelper.firstItem();return!!e&&e.virtualItemType===Kr.e.Album&&this._itemCommandHelper.isCommandSupported(e,ka.a)&&!!t&&!(!t.photo&&!t.video)},t}(mn.e),Wo=n(97),qo=n(324),Qo=function(e){function t(t){var a=e.call(this,t)||this;return a.name="SetPhotosRoot",a._rootId=t.rootId,a._photoProvider=a.resources.consume(q.o),a._itemProvider=a.resources.consume(cn.resourceKey),a._viewParams=a.resources.consume(Na.D),a._urlDataSource=a.resources.consume(z.n),a._executorLoader=new(a.managed(si.e))({path:"./SetPhotosRootExecutor",getModule:function(){return I.n.resolve(n.ee([34],1681))},getExecutorParams:function(){return{photoProvider:a._photoProvider,itemProvider:a._itemProvider,urlDataSource:a._urlDataSource,rootId:a._rootId}}}),a}return Object(i.__extends)(t,e),t.prototype.onIsToggled=function(){var e=!1,t=this._viewParams().id;return"ROOT"===this._rootId?e="root"===t:"SAMSUNGFOLDER"===this._rootId?e="samsungGallery"===this._photoProvider.getAllPhotosSettings()().folderName:"ALLPHOTOSFOLDER"===this._rootId&&(e="photos"===this._photoProvider.getAllPhotosSettings()().folderName),e},t.prototype.onIsAvailable=function(){var e=this._viewParams();switch(this._urlDataSource.getPhotoType(e)){case Wo.e.AllMyPhotos:case Wo.e.onThisDay:case Wo.e.onThisMonth:case Wo.e.lastWeekPreviousYears:return!0;default:return!1}},t.prototype.onExecute=function(e){return this._executorLoader.execute(e)},t.prototype.onCreateQosEvent=function(e){return new qo.e({name:this.name,pageType:this._urlDataSource&&oe.e[this._urlDataSource.getPageType()]||"",queryType:this._urlDataSource&&Y.e[this._urlDataSource.getQueryType()]||"",logStartEnd:this.logStartEnd,extraData:{filter:this._rootId}})},t}(Xt.e),Yo=function(e){function t(t){var n=e.call(this,t)||this;return n.name="FilterSearchByDateAction",n._filter=t.filter,n._urlDataSource=n.resources.consume(V.H),n._viewParams=n.resources.consume(Na.D),n._showCurrentView=t.showCurrentView,n._url=n.createPureComputed(n._computeUrl),n._supportsSearchFiltering=n._getSupportsSearchFiltering(),n._navigationAction=new(n.managed(hi.e))({url:n._url,forceNavigation:!0}),n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)},t.prototype.onIsAvailable=function(){return this._viewParams(),this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&Object(Be.e)(this._urlDataSource.getQueryType())&&this._navigationAction.isAvailable()},t.prototype.onIsToggled=function(){this._viewParams();var e=this._urlDataSource.isSearchByDateFilterApplied(this._filter)&&Object(Be.e)(this._urlDataSource.getQueryType())&&!this._urlDataSource.isSearchPassThrough();return e&&this._showCurrentView(e&&this._filter!==Vo.e.anyDate),e},t.prototype._computeUrl=function(){return this._viewParams(),this._urlDataSource.getSearchByDateFilterQueryUrl(this._filter)},t.prototype._getSupportsSearchFiltering=function(){var e=this.createObservable(!1);return I.n.resolve(this.resources.consumeAsync(V.w)).done(function(t){e(t.getCapabilities().supportsSearchFiltering)}),e},t}(Xt.e),Jo=n(353),Xo=n(257),Zo=!Le.e.isActivated("F821B97F-2856-4BCD-A56C-3D1866606118","05/09/2022",'Enable "copy to" action when accessing a share link'),$o=function(e){function t(t){var n=e.call(this,t)||this;return n._isMove=t.isMove,n.name="LaunchMoveCopyPanel",n._currentItem=Le.e.isActivated("CA6B3004-C196-4F99-90F6-72ACA9F6971B","10/21/2021","Get Current Item from ItemSelectionHelper")?n.resources.consume(Na.i):n.selectionHelper.currentItem,n._urlDataSource=n.resources.consume(z.n),n._capabilities=n.resources.consume(Jo.e),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"../LaunchMoveCopyPanelExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([18],1775))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{isMove:this._isMove,actionName:this.name,selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this;if(!this._capabilities.supportsMoveCopy)return!1;var t=this._currentItem();if(this.selectionHelper.selection().length>1&&t.queryType===Y.e.SharedWithMe&&t.isRootFolder)return!1;if(!Zo&&!this._isMove&&this._urlDataSource.getAuthKeyParamValue()&&this.resources.consume(Xo.e))return!1;var n=this._isMove?ka.i:ka.e;return this._urlDataSource.getPageType()!==oe.e.TextFileEditor&&this.selectionHelper.filterItems(function(t){return e.itemCommandHelper.isCommandSupported(t,n)})},t}(mn.e),es=n(228),ts=n(501),ns=new De.t({name:"DeeplinkCommentId.key",factory:{dependencies:{},create:function(){return{instance:Rn.observable({})}}}}),as=function(e){function t(t){var n=e.call(this,t)||this;return n.name="AutoExecute",n._focusItem=t.focusItem,n._actionMap=n.resources.consume(Na.e),n._navigation=n.resources.consume(B.e),n._urlDataSource=n.resources.consume(z.n),n._viewParams=n.resources.consume(Na.D),n._originalViewParams=Object(i.__assign)({},n._viewParams.peek()),n._actionType=n.createPureComputed(n._computeAutoActionType,{deferEvaluation:!0}),n._createAction=n.createPureComputed(n._computeCreateAction,{deferEvaluation:!0}),n._action=n.createPureComputed(n._computeAction,{deferEvaluation:!0}),n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){var n,a=this,i=this._actionType.peek(),r=this._action.peek(),o=this.item.peek(),s=this._viewParams.peek(),c=new v.e({name:"AutoExecute-".concat(Ja.t[i])});return n=r&&r.isAvailable.peek()?r.execute(e):I.n.resolve({resultType:v.t.ExpectedFailure}),i!==Ja.t.locate&&i!==Ja.t.download&&this._navToDefaultUrl(o,s),n.then(function(e){return i===Ja.t.download&&a._navToDefaultUrl(o,s,"focus"),c.end(e),I.n.resolve(e)}).catch(function(e){return c.end(Object(es.e)(e)),I.n.reject(e)})},t.prototype.onIsAvailable=function(){var e=this._actionType(),t=this.item(),n=this._focusItem&&this._focusItem(),a=!t.isPlaceholder,i=!n||!n().isPlaceholder;return!!e&&i&&a},t.prototype._computeAutoActionType=function(){var e=this._viewParams();return this._urlDataSource.getAutoActionType(e)},t.prototype._computeCreateAction=function(){var e,t=this;switch(this._actionType()){case Ja.t.defaultClick:e=function(){return new(t.managed(t._actionMap.DefaultClickAction))({sourceEngagement:"AutoExecuteAction",item:t._focusItem&&t._focusItem()})};break;case Ja.t.download:var n=this._focusItem&&this._focusItem(),a=this.item;e=function(){return new(t.managed(t._actionMap.DownloadAction))({item:n||a})};break;case Ja.t.share:case Ja.t.sharing:if(Object(ce.isFeatureEnabled)(ce.ODCRequestAccess)){var i=this._originalViewParams,r=i.rc,o=i.isEdit,s=i.isDirect,c="1"===o,d="1"===s,l=r?[r]:void 0;e=function(){return new(t.managed(t._actionMap.ShowShareMultiItemAction))({focusItems:t.resources.consume(ts.n),isEdit:c,isSecureShare:d,defaultRecipients:l})}}else e=function(){return new(t.managed(t._actionMap.ShareByLinkAction))({})};break;case Ja.t.sendSurvey:e=function(){return new(t.managed(t._actionMap.SurveyAction))({actionType:1})};break;case Ja.t.createTextDocument:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:Wn.e.Text,autoInvokedItem:!0})};break;case Ja.t.createWord:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:Wn.e.Word,autoInvokedItem:!0})};break;case Ja.t.createExcel:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:Wn.e.Excel,autoInvokedItem:!0})};break;case Ja.t.createExcelForm:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:Wn.e.ExcelSurvey,autoInvokedItem:!0})};break;case Ja.t.createPowerPoint:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:Wn.e.PowerPoint,autoInvokedItem:!0})};break;case Ja.t.createOneNote:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:Wn.e.OneNote,autoInvokedItem:!0})};break;case Ja.t.openInExcel:case Ja.t.openInWord:case Ja.t.openInPowerPoint:case Ja.t.openInOneNote:case Ja.t.openInVisio:case Ja.t.openInProject:case Ja.t.openInPublisher:case Ja.t.openInOffice:e=function(){return new(t.managed(t._actionMap.OpenInOfficeClientAction))({})};break;case Ja.t.embed:e=function(){return new(t.managed(t._actionMap.EmbedAction))({})};break;case Ja.t.reportAbuse:e=function(){return new(t.managed(t._actionMap.ReportAbuseAction))({})};break;case Ja.t.addToShared:e=function(){return new(t.managed(t._actionMap.AddToSharedListAction))({})};break;case Ja.t.editBrowser:case Ja.t.edit:case Ja.t.editNew:e=function(){return new(t.managed(t._actionMap.OpenInOfficeOnlineAction))({})};break;case Ja.t.feedback:e=function(){return new(t.managed(t._actionMap.FeedbackAction))({})};break;case Ja.t.versionHistory:e=function(){return new(t.managed(t._actionMap.ShowVersionHistoryAction))({})};break;case Ja.t.showProperties:if(this._focusItem&&!this._focusItem()){var u=this._originalViewParams.commentId,f=this.resources.consume(ns);u&&f({commentId:u}),e=function(){return new(t.managed(t._actionMap.ShowPropertiesAction))({useToggleBehavior:!0})}}case Ja.t.locate:}return e},t.prototype._computeAction=function(){var e=this._action.peek();e&&e.dispose(),e=null;var t=this._createAction();return t&&(e=t()),e},t.prototype._navToDefaultUrl=function(e,t,n){this._navigation.navigateTo(this._urlDataSource.getDefaultClickUrl(e,{viewParams:t,urlType:n}))},t}(Kn.e),is=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="ToggleSelectionModeAction",n._platformDetection=n.resources.consume(Yn.e),n._isSelectionModal=n.resources.consume(Rr.t),n._selectionHelper=new(n.child(nn.e))({}),n._isOneDriveXboxApp=Object(Xn.t)(),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._isOneDriveXboxApp||this._platformDetection.isMobile&&!this._isSelectionModal()&&!this._selectionHelper.firstItem()},t.prototype.onExecute=function(e){var t=this._isSelectionModal.peek();return this._isSelectionModal(!t),I.n.wrap({resultType:v.t.Success})},t.prototype.onIsToggled=function(){return this._isSelectionModal()},t}(Xt.e),rs=function(e){function t(t){var a=e.call(this,t)||this;return a.name="RedeemCode",a._executorLoader=new(a.managed(si.e))({path:"./RedeemCodeExecutor",getModule:function(){return I.n.resolve(n.ee([23,"ondemand.resx-ondemand"],1742))},getExecutorParams:function(){return{redeemSuccess:t.redeemSuccess,redeemCode:t.redeemCode,actionName:a.name}}}),a}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e){return this._executorLoader.execute(e)},t.prototype.onIsAvailable=function(){return!0},t}(Xt.e),os=n(495),ss=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"../SaveExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([32],1682))}},t}(function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Save",n._itemContentsProvider=n.resources.consume(os.e),n._urlDataSource=n.resources.consume(V.H),n._selectionHelper=new(n.child(nn.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});var a=Object(de.es)(de.Z)?n._selectionHelper.currentItem.peek():n.resources.consume(Na.i).peek(),i=n._urlDataSource.getKeyParams(a.key);return n._urlDataSource.getQueryType(i)===Y.e.SharedWithMe&&(a=void 0),n._loader=new(n.managed(si.e))({path:n.getExecutorPath(),getModule:n.getModuleFactory(),getExecutorParams:function(){return{selectionHelper:n._selectionHelper,currentItem:a}}}),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._itemContentsProvider.getItemContent(e);return!!t.isEditable()&&!!t.memoryContent()&&!t.hasConflict()&&!t.hasPendingSave()&&t.hasChanges()},t.prototype.onExecute=function(e){return this._loader.execute(e)},t}(Xt.e)),cs=ss,ds=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="Redeem",n._itemProvider=n.resources.consume(cn.resourceKey),n._urlDataSource=n.resources.consume(V.H),n._itemReedemer=n.resources.consume(on.e),n._selectionHelper=new(n.child(nn.e))({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1}),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return this._urlDataSource.getPageType()===oe.e.TextFileEditor&&this._selectionHelper.filterItems(function(e){return e.tokenNeedsRedeeming})},t.prototype.onExecute=function(e){var t=this;return this._selectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){for(var n=0,a=e;n<a.length;n++){var i=a[n];t._itemProvider.invalidateItem(i.key,{triggerFetch:!0})}return I.n.wrap({resultType:v.t.Success})})})},t}(Xt.e),ls=function(e){function t(t,n){var a=e.call(this,t,n)||this,i=n.itemSet;return a.itemSet=i,a.item=a.createPureComputed(a._computeItem),a.item.equalityComparer=ja.t,a.isEmpty=a.createPureComputed(a._computeIsEmpty),a.hasItems=a.createPureComputed(a._computeHasItems),a.hasName=a.createPureComputed(a._computeHasName),a.hasParent=a.createPureComputed(a._computeHasParent),a.name=a.createPureComputed(a._computeName),a.isPlaceholder=a.createPureComputed(a._computeIsPlaceholder),a}return Object(i.__extends)(t,e),t.prototype._computeItem=function(){return this.itemSet().item()},t.prototype._computeHasItems=function(){return this.itemSet().content().items.length>0},t.prototype._computeIsEmpty=function(){var e=0===this.itemSet().content().items.length&&!this.itemSet().isPlaceholder,t=!this.item().isPlaceholder;return e&&t},t.prototype._computeHasName=function(){var e=this.item();return!(!e.displayName&&!e.name)},t.prototype._computeHasParent=function(){return Le.e.isActivated("D99057A9-4CBD-49C0-8721-0C2D2A23ADC7","06/23/2021","Use item.parentKey and itemParentHelper to get parent of item")?!!this.item().UNSAFE_parent:!!this.item().parentKey},t.prototype._computeName=function(){var e=this.item();return e.displayName||e.name},t.prototype._computeIsPlaceholder=function(){return this.item().isPlaceholder},t.dependencies=Object(i.__assign)(Object(i.__assign)({},$.n.dependencies),{itemSet:Na.r}),t}($.n),us=Object(j.r)("ItemSetMonitor",ls),fs=function(e){function t(t){var n=e.call(this,t)||this;return n.name="SwitchPhotoFolderLayoutType",n._itemSetMonitor=n.resources.consume(us),n}return Object(i.__extends)(t,e),t.prototype.onIsToggled=function(){var e=this._itemSetMonitor.item();return!K.e.getKeyParams(e.key).ft},t.prototype.getExecutorPath=function(){return"./SwitchPhotoFolderLayoutTypeExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([40],1683))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name}},t}(mn.e),ps=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="CreateAlbumFromFolder",n._identity=n.resources.consume(V.p),n._urlDataSource=n.resources.consume(z.n),n._itemParentHelper=n.resources.consume(An.e),n}return Object(i.__extends)(t,e),t.prototype.isValidItem=function(e,t,n){var a=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"mountPoint")),i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault")),r=n!==oe.e.TextFileEditor,o=e&&e.ownerId&&e.ownerId.toUpperCase(),s=K.e.viewerId&&K.e.viewerId.toUpperCase();return r&&t&&t.type!==re.e.anonymous&&o===s&&!a&&e.type===an.e.Folder&&e.queryType===Y.e.Files&&"root"!==e.id&&!e.isBundle&&!e.isAlbum&&!i},t.prototype.getExecutorPath=function(){return"./CreateAlbumFromFolderExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([9],1776))}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.onIsAvailable=function(){if(!Object(ce.isFeatureEnabled)(ce.EnableCreateAlbumFromFolder)&&Object(Gt.e)(St.s))return!1;var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this._identity.getIdentity(),n=this._urlDataSource.getPageType();return this.isValidItem(e,t,n)},t}(mn.e),ms=n(442),_s=n(488),hs=n(403),bs=new RegExp("^".concat("Templates","$"),"i"),gs=function(){function e(){}return e.isFolder=function(e,t){var n=!!e;return n&&!(n=e.type===an.e.Folder)&&t&&e.type===an.e.OneNote&&(n=!!fe.e.isActivated("94B1529C-14BB-4854-B5FC-748FCEFF2681","3/29/2022","Check for OneNote note")||!e.contentTypeId||0!==e.contentTypeId.lastIndexOf("0x0101",0)),n},e.isCheckedOut=function(e){return hs.e(e)},e.isCheckedOutByUser=function(e,t){return hs.n(e,t)},e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)},e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:ms.t,component:{name:Qa.e.tagName,params:{text:ms.e}},actions:[{name:Qn.cancelActionText,execute:function(){return I.n.wrap(2)},icon:new kn.e("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:v.t.Success}})},e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major},e.needsPublishingReminder=function(t,n){return!e.isPublished(t,n)&&!e.isPendingApproval(t,n)&&!e.isPageTemplate(t)&&(!t.properties||!t.properties._ScheduledVersion||t.properties.owshiddenversion!==t.properties._ScheduledVersion)&&_s.e.hasItemPermission(t,_s.e.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0)},e.isPublishingRelevant=function(t,n){return _s.e.hasItemPermission(t,_s.e.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)},e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)},e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var a=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:a}}return{major:0,minor:0}},e.isPendingApproval=function(t,n){return!!n.isModerated&&t&&t.properties&&t.properties[e.PublishProperty]&&"2"===t.properties[e.PublishProperty]},e.isPageTemplate=function(e){if(!e)return!1;var t=!1,n=!1;if(e.id){var a=e.id.split("/"),i=a.length;t=bs.test(a[i-2])}if(e.properties){var r=e.properties._SPSitePageFlags;n=!!r&&r.filter(function(e){return"template"===e.toLowerCase()}).length>0}return t||n},e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&_s.e.hasItemPermission(t,_s.e.editListItems)&&_s.e.hasItemPermission(t,_s.e.approveItems)},e.FileTypeProperty="FSObjType",e.PublishProperty="_ModerationStatus.",e.VersionProperty="_UIVersion",e}(),vs=(new dn.e("checkout"),new dn.e("quickEdit"),new dn.e("editItem"),new dn.e("viewItem"),new dn.e("versionHistory")),ys=(new dn.e("exportList"),function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.state=n.createPureComputed(n._computeState),n._urlDataSource=n.resources.consume(V.H),n._itemParentHelper=n.resources.consume(An.e),n._itemCommandHelper=n.resources.consume(sn.t),n._itemSelectionHelper=new(n.child(nn.e))({allowMultiSelect:!1,canFallback:!1}),n}return Object(i.__extends)(t,e),t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem}},t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list,a=!gs.isFolder(e,!0)&&_s.e.hasItemPermission(e,_s.e.viewVersions);return{isAvailable:this._urlDataSource.getPageType()!==oe.e.TextFileEditor&&!!n&&!n.isExternal&&(n.enableVersions||n.isModerated)&&this._itemCommandHelper.isCommandSupported(e,vs)&&e.itemStatus!==ji.e.ConditionalAccessBlocked&&e.itemStatus!==ji.e.ConditionalAccessViewOnly&&a}},t}($.n)),Ss=Object(ni.e)({name:"ShowReactVersionHistory",source:{moduleDefinition:{path:"./ShowReactVersionHistoryExecutor",getModule:function(){return I.n.resolve(n.ee([39,"ondemand.resx-ondemand"],1736))}}},handlerType:ys}),Ds=function(e){function t(t,n){void 0===t&&(t={}),void 0===n&&(n={});var a=e.call(this,t,n)||this;return a.name="VersionHistory",a._itemCommandHelper=new(a.managed(sn.e)),a._itemSelectionHelper=new(a.child(nn.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!Object(Xn.e)()&&(this._itemCommandHelper.isCommandSupported(e,fa.l)||!!e&&(e.type===an.e.File||e.type===an.e.Media)&&!e.dateDeletedTime&&Object(ce.isFeatureEnabled)(ce.VersionAllFiles))},t.prototype.onExecute=function(e,t){return Object(i.__awaiter)(this,void 0,I.n,function(){var t,n,a,r;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(t=i.sent())?!Object(Gt.e)(t.ownerId)&&this._itemCommandHelper.isCommandSupported(t,fa.l)?(n=this.resources.consume(V.H),a=n.getVersionHistoryUrl(K.e.viewerId,t.id),[2,new(this.managed(hi.e))({url:a,target:"_blank"}).execute(e)]):et.e.isAuthenticated()?[2,(new(this.managed(Ss))).execute(e)]:(r=this.resources.consume(B.e),[2,new(this.managed(hi.e))({url:K.e.getAutoRedeemLoginUrl(t.id,t.ownerId,this.name,r)}).execute(e)]):[2,I.n.resolve({resultCode:"EmptySelection",resultType:v.t.Failure})]}})})},t}(Xt.e),Is=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="ApplyOfficeLens",n._item=Object(de.es)(de.Z)?n.selectionHelper.currentItem:n.resources.consume(Na.i),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./ApplyOfficeLensExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([8],1777))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,item:this._item.peek()}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this._item&&this.itemCommandHelper.isCommandSupported(e,Sn)},t}(mn.e),xs=function(e){function t(t){void 0===t&&(t={});var a=e.call(this,t)||this;return a.name="RemoveOfficeLens",a._selectionHelper=new(a.child(nn.e))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1}),a._itemCommandHelper=new(a.managed(sn.e)),a._item=Object(de.es)(de.Z)?a._selectionHelper.currentItem:a.resources.consume(Na.i),a._loader=new(a.managed(si.e))({path:"./RemoveOfficeLensExecutor",getModule:function(){return I.n.resolve(n.ee([25],1778))},getExecutorParams:function(){return{actionName:a.name,selectionHelper:a._selectionHelper,item:a._item.peek()}}}),a}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return e&&this._item()&&this._itemCommandHelper.isCommandSupported(e,Dn)},t.prototype.onExecute=function(e){return this._loader.execute(e)},t}(Xt.e),Cs=n(327),Os=function(e){function t(t){var n=e.call(this,t)||this;n._primary=new(n.managed(t.primary))(t.actionParams);var a=Object(i.__assign)(Object(i.__assign)({},t.actionParams),{primaryActionName:n._primary.name});return n._secondary=new(n.managed(t.secondary))(a),n.name=n._primary.name,n.isAvailable=n._primary.isAvailable,n.isExecuting=n.createPureComputed(n._computeIsExecuting),n.isToggled=n.createPureComputed(n._computeIsToggled),n.inputType=n.createPureComputed(n._computeInputType),n}return Object(i.__extends)(t,e),t.create=function(e,n){var a=function(t){function a(a){return t.call(this,{primary:e,secondary:n,actionParams:a})||this}return Object(i.__extends)(a,t),a}(t);return a},t.prototype.execute=function(e){return this._getAction().execute(e)},t.prototype._getAction=function(){return this._secondary.isAvailable.peek()?this._secondary:this._primary},t.prototype._computeIsExecuting=function(){return this._primary.isExecuting()||this._secondary.isExecuting()},t.prototype._computeIsToggled=function(){return this._primary.isToggled()||this._secondary.isToggled()},t.prototype._computeInputType=function(){var e=this._secondary.isAvailable()?this._secondary:this._primary;return e&&e.inputType?e.inputType():Cs.e.none},t}($.n),ws=n(295),Es=!Le.e.isActivated("85B60F61-8AB8-435E-92B3-7D9D9F3451ED","03/30/2023","Prompt for download on PDF print"),As=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="PrintPdf",n._urlDataSource=n.resources.consume(z.n),n._instrumentationProvider=n.resources.consume(q.a),n._platform=n.resources.consume(Yn.e),n._navigation=n.resources.consume(B.e),n._supportsIframePrint=!Es&&(n._platform.isChrome||n._platform.isSafari),n._isOneDriveXboxApp=Object(Xn.t)(),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./PrintPdfExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([22,"ondemand.resx-ondemand"],1684))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}},t.prototype.getExecutorParameters=function(){return{actionName:this.name,urlDataSource:this._urlDataSource,instrumentationProvider:this._instrumentationProvider,navigation:this._navigation,selectionHelper:this.selectionHelper}},t.prototype.onExecute=function(t){var n=this;return this._supportsIframePrint?this.selectionHelper.resolveFirst().then(function(e){var t=n._urlDataSource.getPrintPdfUrl(e);return pe.e.logData({name:ws.t[ws.t.PrintPdfNative],location:ws.e[ws.e.OneUp],usageType:Ue.e[Ue.e.Click],currentPage:n._instrumentationProvider.currentPageName(),previousPage:n._instrumentationProvider.previousPageName()}),n._navigation.navigateTo({url:t,frameId:"_blank"}),I.n.wrap({resultType:v.t.Success})}):e.prototype.onExecute.call(this,t)},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&".pdf"===e.extension&&!this._platform.isMobile&&!this._isOneDriveXboxApp&&Object(ce.isFeatureEnabled)(ce.UseWebPdfViewer)},t}(mn.e),Ls=n(339),ks=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="SaveAutoAlbum",n._isHidden=t.isHidden||!1,n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./SaveAutoAlbumExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([31,"ondemand.resx-ondemand"],1779))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,isHidden:this._isHidden}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return Object(ce.isFeatureEnabled)(ce.EnableEvokeAlignments)&&e&&e.virtualItemType===Kr.e.Album&&(Ls.n(e)||Object(ce.isFeatureEnabled)(ce.EvokeDev))},t}(mn.e),Ms=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n.name="DiscardAutoAlbum",n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./DiscardAutoAlbumExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([12,"ondemand.resx-ondemand"],1780))}},t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}},t.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}},t.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return Object(ce.isFeatureEnabled)(ce.EnableEvokeAlignments)&&e&&e.virtualItemType===Kr.e.Album&&Ls.n(e)},t}(mn.e),Ps=function(e){function t(t){var n=e.call(this,t)||this;return n.name="ImplicitSaveAutoAlbum",n._action=t.action,n._saveAutoAlbumAction=t.saveAutoAlbumAction,n}return Object(i.__extends)(t,e),t.prototype.onExecute=function(e,t){var n=this;return this._action.execute(e).then(function(t){return n._saveAutoAlbumAction.isAvailable()&&n._saveAutoAlbumAction.execute(e),t})},t.prototype.onIsAvailable=function(){return this._action.isAvailable()},t}(Xt.e),Ts=n(117),Us=n(286),Fs=n(427),Hs=n(543),Rs=function(e){function t(t){var n=e.call(this,t)||this;return n._itemParentHelper=n.resources.consume(An.e),n._itemSelectionHelper=new(n.child(nn.e))({allowMultiSelect:!0,overrideItem:t.item}),n._urlDataSource=n.resources.consume(V.H),n._viewParams=n.resources.consume(Na.D),n._vaultActionType=t.actionType,n._isGlobal=t.isGlobal,n._goPremiumSource=t.goPremiumSource,n._shouldShowFRE=!1!==t.shouldShowFRE,n._vaultHelper=new(n.managed(Hs.e))({}),n._isVaultUnlocked=n.observables.createCallback(Object(Ts.t)(!1)),n._vaultFreState=n.observables.createCallback(Object(Ts.t)(p.a.NotCreated)),n._isVaultDisabled=n.observables.createCallback(Object(Ts.t)(!1)),n.resources.isDefined(Fs.e)&&n.resources.consumeAsync(Fs.e).then(function(e){n._isVaultUnlocked.register(e.isVaultOpen),n._vaultFreState.register(e.vaultFreState),n._isVaultDisabled.register(e.isVaultDisabled)}),n._isOneDriveWinApp=Object(Xn.e)(),n}return Object(i.__extends)(t,e),t.prototype.getExecutorPath=function(){return"./VaultExecutor"},t.prototype.getModuleFactory=function(){return function(){return I.n.resolve(n.ee([41,"ondemand.resx-ondemand"],1743))}},t.prototype.getSelectionOptions=function(e){return e.actionType===wi.e.ShowFiles?{allowMultiSelect:!0,canFallback:!1}:{allowMultiSelect:!1,canFallback:!0}},t.prototype.onIsAvailable=function(){var e,t=this.selectionHelper.firstItem(),n=t&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"vault"));if(this._isVaultDisabled())return!1;var a=Object(de.es)(de.zr)&&Object(Gt.e)(St.s)?!this._isVaultUnlocked():(null===(e=null==n?void 0:n.vault)||void 0===e?void 0:e.isLocked)||!1;if(this._vaultActionType===wi.e.ShowFiles){var i=this._itemSelectionHelper.currentItem(),r=this._urlDataSource.getKeyParams(i.key),o=this._urlDataSource.getQueryType(r),s=this.selectionHelper.selection();return!(o!==Y.e.RecycleBin||this._vaultFreState()!==p.a.FreShown||this._isOneDriveWinApp||s.length>0||this._isVaultUnlocked())}if(this._vaultActionType===wi.e.Unlock)return!!(n&&n.vault&&a);if(this._vaultActionType===wi.e.Lock){var c=this._isGlobal&&this._isVaultUnlocked(),d=t&&t.vault&&t.vault.root&&!a;return!(!c&&!d)}return n&&!n.error||this._isVaultUnlocked()},t.prototype.getExecutorParameters=function(){return{actionType:this._vaultActionType,isPickerPage:this._isPickerPage,goPremiumSource:this._goPremiumSource}},t.prototype.onExecute=function(t,n){var a=this._urlDataSource.getPageType(this._viewParams.peek()),i=this._urlDataSource.getQueryType(this._viewParams.peek());if(this._isPickerPage=a===oe.e.FilePicker||a===oe.e.FolderPicker,pe.e.logData({name:"Vault.".concat(Object(Us.i)(this._vaultActionType)),extraData:{location:Object(Us.a)(a,i)}}),this._vaultActionType===wi.e.Unlock&&!this._isOneDriveWinApp&&!this._isPickerPage){var r=this._vaultFreState.peek();if(this._shouldShowFRE&&(r===p.a.BubbleShown||r===p.a.Created))return this._vaultActionType=wi.e.FreDialog,e.prototype.onExecute.call(this,t,n);var o=this._vaultActionType.toString();return this._vaultHelper.unlockPopup().then(function(e){return e?I.n.resolve({name:o,resultType:v.t.Success}):I.n.reject({name:o,resultType:v.t.Failure})})}return e.prototype.onExecute.call(this,t,n)},t}(mn.e),Ns=function(e){function t(t){var n=e.call(this,t)||this;return n._itemRedeemer=n.resources.consume(on.e),n._isEdit=t.isEdit,n._isSecureShare=t.isSecureShare,n._defaultRecipients=t.defaultRecipients,n._itemsBeingShared=t.focusItems,n._selectionHelper=new(n.child(nn.e))({overrideItem:null,allowMultiSelect:!0,canFallback:!0}),n._urlDataSource=n.resources.consume(V.H),n._itemCommandHelper=n.resources.consume(sn.t),n.name="ShowShareMultiItemAction",n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._selectionHelper.selection().length;if(!Object(ce.isFeatureEnabled)(ce.HideShareButton)&&!0===Object(Gt.e)(St.s)&&1!==t)return!1;var n=t>1&&e.queryType===Y.e.SharedWithMe&&e.isRootFolder,a=t>1&&e.isAlbum,i=this._urlDataSource.isRecycleBin(e.queryType);return this._itemCommandHelper.isCommandSupported(e,Ha.s)&&!n&&!a&&!i},t.prototype.onExecute=function(e,t){var n=this;this._itemsBeingShared.peek()&&this._itemsBeingShared(void 0);var a=this._selectionHelper.selection().map(function(e){return e.peek()});return this._itemRedeemer.redeemItems(a,this).then(function(){return n._itemsBeingShared({items:a,defaultRecipients:n._defaultRecipients,isEdit:n._isEdit,isSecureShare:n._isSecureShare}),I.n.wrap({resultType:v.t.Success})},function(e){return I.n.reject(e)})},t}(Xt.e),Bs=function(e){function t(t){var n=this,a=t.load,i=t.actionParams,r=(n=e.call(this,i)||this).resources.consume(q.e.optional);n.isQosLogged=!1,n.name="Deferred".concat(t.modulePath).replace(/Action|\.|\//g,""),n._action=n.createObservable();var o=new y.e;return(r?r.waitForPLT().then(a):I.n.resolve(a())).done(function(e){return o.complete(e)},function(e){return o.error(e)}),n._getActionPromise=n.trackPromise(o.getPromise().then(function(e){return new(n.managed(e))(i)})),n._getActionPromise.done(function(e){return n._action(e)}),n.inputType=n.createPureComputed(n._computeInputType),n}return Object(i.__extends)(t,e),t.prototype.onIsAvailable=function(){return!!this._action()&&this._action().isAvailable()},t.prototype.onIsToggled=function(){return!!this._action()&&this._action().isToggled()},t.prototype.onExecute=function(e,t){return this._getActionPromise.then(function(t){return t.execute(e)})},t.prototype._computeInputType=function(){var e=this._action();return e&&e.inputType?e.inputType():Cs.e.none},t}(Xt.e);function js(e,t){return function(e,t){var n;function a(){return n||(n=t())}return function(t){function n(n){return t.call(this,{load:a,modulePath:e,actionParams:n})||this}return Object(i.__extends)(n,t),n}(Bs)}(e,function(){return t().then(J.e)})}var Vs=function(e){function t(){var t=e.call(this)||this,a=js("../quotaBlock/odc/QuotaBlockAction",function(){return n.ee([161,"ondemand.resx-ondemand"],1714)});return t.ExternalNavigateAction=tn,t.OpenInDesktopAction=rn,t.AddCoverPhotoAction=pn,t.AddPhotosToAlbumAction=Ho,t.AddToAlbumAction=En,t.AddToBundleAction=go,t.AddToFolderAction=Ln,t.AddToSharedListAction=_o,t.ApplyOfficeLensAction=Is,t.AutoExecuteAction=as,t.ChangeFolderTypeAction=zn,t.ClearSelectionAction=Gn,t.CreateAlbumAction=No,t.CreateAlbumFromFolderAction=ps,t.CreateDocumentAction=Os.create(La,a),t.CreateFolderAction=Pa,t.CreateNewFolderAction=js("../createNewFolder/odc/CreateNewFolderAction",function(){return n.ee([155],1770)}),t.CreateMountPointAction=Ba,t.DefaultClickAction=Za,t.DeleteAction=$a,t.DiscardAutoAlbumAction=Ms,t.DownloadAction=ei,t.DownloadZipContentsAction=js("../downloadZipContents/odc/DownloadZipContentsAction",function(){return n.ee([156],1724)}),t.EditTagsAction=ti,t.ShowTagsEditorAction=ii,t.EmbedAction=ri,t.EmptyRecycleBinAction=oi,t.FeedbackAction=ci,t.FilterSearchAction=zo,t.FilterSearchByDateAction=Yo,t.ImplicitSaveAutoAlbumAction=Ps,t.LanguagePickerAction=mi,t.LaunchMoveCopyPanelAction=$o,t.LaunchMoveCopyPickerAction=js("../launchMoveCopyPicker/LaunchMoveCopyPickerAction",function(){return n.ee([129],1667)}),t.MoveCopyAction=js("../moveCopy/odc/MoveCopyAction",function(){return n.ee([158],1771)}),t.NavigateToItemAction=_i,t.NavigationAction=hi.e,t.OneDriveSortAction=Si,t.OpenAction=Ei,t.PreviewAction=ki,t.OpenInOfficeClientAction=Ti,t.OpenPdfInBrowserAction=Fi,t.OpenInOfficeOnlineAction=Os.create(Bi,a),t.OpenInTextEditorAction=Qi,t.OpenInHtmlViewerAction=Xi,t.OpenInImageEditorAction=js("../openInImageEditor/OpenInImageEditorAction",function(){return n.ee([159],1668)}),t.OrderPrintsAction=Zi,t.PlayAudioAction=$i,t.PlaySlideShowAction=er,t.PrintPdfAction=As,t.RedeemAction=ds,t.RedeemCodeAction=rs,t.RemoveCoverPhotoAction=nr,t.RemoveFromAlbumAction=Po,t.RemoveFromBundleAction=So,t.RemoveFromRecentAction=lr,t.RemoveFromSharedListAction=bo,t.RemoveMountPointAction=Io,t.RemoveOfficeLensAction=xs,t.RemoveTagAction=ur,t.RemoveTagFromItemAction=Go,t.RenameAction=fr,t.ReportAbuseAction=Do,t.RequestReviewAction=xo,t.RestoreAction=mr,t.RestoreAllAction=_r,t.RotateAction=gr,t.SaveAction=cs,t.SaveAutoAlbumAction=ks,t.SaveSortOrderAction=Sr,t.SelectAction=Bo,t.SelectAllAction=jo,t.SetAlbumCoverPhotoAction=Ko,t.SetFocusAction=Ir,t.SetPhotosRootAction=Qo,t.ShareByLinkAction=xr,t.ShowKeyboardMapAction=Cr,t.ShowOperationsAction=wr,t.ShowPermissionsAction=Ar,t.ShowSuggestedFilesAction=kr,t.ShowPropertiesAction=Mr.default,t.ShowCopilotAction=Hr,t.ShowSelectionAction=Nr,t.ShowVersionHistoryAction=Ds,t.SignOutAction=Eo,t.SortAction=gi,t.StopSlideShowAction=tr,t.SurveyAction=mo,t.SwitchPhotoFolderLayoutTypeAction=fs,t.ToggleDebugWindowAction=ko,t.ToggleIsLeftNavUserExpandedAction=js("../../controls/leftNavExpander/actions/ToggleIsLeftNavUserExpandedAction",function(){return n.ee([162],1669)}),t.ToggleListLayoutAction=Wr,t.ToggleSelectionModeAction=is,t.UpdateCaptionAction=ro,t.UploadAction=Os.create(to,a),t.QuotaBlockAction=a,t.VaultAction=Rs,t.ViewInFolderAction=Co,t.ViewOriginalAction=qr,t.ShowShareMultiItemAction=Ns,t}return Object(i.__extends)(t,e),t}(function(){this.AddCoverPhotoAction=$t,this.AddExistingAppViewAction=$t,this.AddFlowAction=$t,this.AddPhotosToAlbumAction=$t,this.EditSmartTemplateAction=$t,this.DeleteSmartTemplateAction=$t,this.DeleteSmartTemplateWithProgressAction=$t,this.PublishSmartTemplateAction=$t,this.PublishSmartTemplateWithProgressAction=$t,this.UnPublishSmartTemplateAction=$t,this.UnPublishSmartTemplateWithProgressAction=$t,this.CopySmartTemplateLinkAction=$t,this.ActivateUniversalAnnotationAction=$t,this.AddToAlbumAction=$t,this.AddToBundleAction=$t,this.AddToFolderAction=$t,this.AddToOneDriveAction=$t,this.AddToQuickLaunchAction=$t,this.AddToSharedListAction=$t,this.AddToSpotlightAction=$t,this.AlertAction=$t,this.ApplyOfficeLensAction=$t,this.ApproveRejectAction=$t,this.AuthenticationPolicyWarningAction=$t,this.AutoExecuteAction=$t,this.BackToClassicAction=$t,this.CancelEditAction=$t,this.ChangeAppViewVisibilityAction=$t,this.ChangeFolderTypeAction=$t,this.CheckInAction=$t,this.CheckOutAction=$t,this.ClearFilterAction=$t,this.ClearSelectionAction=$t,this.ComplianceDetailsAction=$t,this.ContentTypeNavigationAction=$t,this.LaunchConfigureFlowsPanelAction=$t,this.CopyFieldAction=$t,this.CopyFormAction=$t,this.CreateAlbumAction=$t,this.CreateAlbumFromFolderAction=$t,this.CreateAppViewAction=$t,this.CreateColumnAction=$t,this.CreateCustomDocumentAction=$t,this.CreateDocumentAction=$t,this.CreateFileRequestAction=$t,this.CreateFolderAction=$t,this.CreateItemAction=$t,this.CreateMountPointAction=$t,this.CreateNewFolderAction=$t,this.CreateSitePageAction=$t,this.CustomActionNavigationAction=$t,this.CustomizeClientFormAction=$t,this.CustomClientFormPaneAction=$t,this.CustomizeFormsNavigationAction=$t,this.CustomizeViewAction=$t,this.DefaultClickAction=$t,this.DeleteAction=$t,this.DeleteTemplateAction=$t,this.DeleteAppAction=$t,this.DeleteViewAction=$t,this.DiscardAutoAlbumAction=$t,this.DownloadAction=$t,this.SendForSignatureAction=$t,this.SendForSignatureAdobeAction=$t,this.SendForSignatureDocusignAction=$t,this.OpenSWAAction=$t,this.DownloadZipContentsAction=$t,this.EditAction=$t,this.EditInClipchampAction=$t,this.EditItemAction=$t,this.EditItemCancelAction=$t,this.EditItemSaveAction=$t,this.EditNewAppViewAction=$t,this.EditNewMenuAction=$t,this.EditNewMenuPaneAction=$t,this.EditPdfAction=$t,this.EditRenditionsAction=$t,this.EditTagsAction=$t,this.ShowTagsEditorAction=$t,this.EmbedAction=$t,this.EmptyRecycleBinAction=$t,this.ExportListAction=$t,this.ExternalNavigateAction=$t,this.FeedbackAction=$t,this.FileHandlerOpenAction=$t,this.FileHandlerCreateAction=$t,this.FilterAction=$t,this.FilterSearchAction=$t,this.FilterSearchByDateAction=$t,this.GetLinkAction=$t,this.GroupItemsAction=$t,this.ImplicitSaveAutoAlbumAction=$t,this.InvokeFirstRunExperienceAction=$t,this.LanguagePickerAction=$t,this.LaunchApprovalDetailsDialogAction=$t,this.LaunchChangeTheLookPanelAction=$t,this.LaunchColumnCustomizationPaneAction=$t,this.LaunchColumnManagementPanelAction=$t,this.LaunchCreateAppViewPanelAction=$t,this.LaunchCreateGroupPanelAction=$t,this.LaunchCreateListDialog=$t,this.LaunchCreateShortcutPanel=$t,this.LaunchDocLibSettingPanelAction=$t,this.LaunchFilterPanelAction=$t,this.LaunchFlowWidgetPanelAction=$t,this.LaunchFormatViewPaneAction=$t,this.LaunchGroupifyPanelAction=$t,this.LaunchGroupMembershipPanelAction=$t,this.LaunchHubSettingsPanelAction=$t,this.LaunchListCreationPanelAction=$t,this.LaunchListFormAction=$t,this.LaunchMoveCopyPanelAction=$t,this.LaunchPdfExtractionAction=$t,this.LaunchPdfMergeAction=$t,this.LaunchSitePermissionsPanelAction=$t,this.LaunchSiteSettingsPanelAction=$t,this.LaunchGlobalNavSettingsPanelAction=$t,this.LaunchWebTemplatesGalleryAction=$t,this.LaunchUserExpirationPanelAction=$t,this.LaunchVivaConnectionsSettingsPanelAction=$t,this.ListFormActivityPaneToggleAction=$t,this.MakeHomepageAction=$t,this.VaultAction=$t,this.ModifyColumnAction=$t,this.ModifyShowInFiltersPaneAction=$t,this.MoveCopyAction=$t,this.MoveLeftSpotlightAction=$t,this.MoveRightSpotlightAction=$t,this.NavigateToItemAction=$t,this.NavigateToSharePointHomeAction=$t,this.NavigationAction=$t,this.NewClipchampAction=$t,this.OneDriveSortAction=$t,this.OpenAction=$t,this.OpenChatAction=$t,this.OpenAppAction=$t,this.OpenDocSetAction=$t,this.OpenHyperlinkAction=$t,this.OpenInExplorerAction=$t,this.OpenInfoPathAction=$t,this.OpenInImageEditorAction=$t,this.OpenInOfficeClientAction=$t,this.OpenInOfficeOnlineAction=$t,this.OpenInImmersiveReaderAction=$t,this.OpenInSharePointAction=$t,this.OpenInDesktopAction=$t,this.OpenInTextEditorAction=$t,this.OpenInClipchampAction=$t,this.OpenInHtmlViewerAction=$t,this.OpenNeedsAttentionViewAction=$t,this.OpenPdfInBrowserAction=$t,this.OpenInPowerBIAction=$t,this.OpenInTeamsPreviewAction=$t,this.OpenShortcutAction=$t,this.OpenSiteAction=$t,this.OrderPrintsAction=$t,this.PinToMruAction=$t,this.PlayAudioAction=$t,this.PlaySlideShowAction=$t,this.PolicyTipAction=$t,this.PreviewAction=$t,this.PrintPdfAction=$t,this.PublishAction=$t,this.RedeemAction=$t,this.RedeemCodeAction=$t,this.RemoveCoverPhotoAction=$t,this.RemoveFromAlbumAction=$t,this.RemoveFromBundleAction=$t,this.RemoveFromRecentAction=$t,this.RemoveFromSharedListAction=$t,this.RemoveFromSpotlightAction=$t,this.RemoveMountPointAction=$t,this.RemoveOfficeLensAction=$t,this.RemoveTagAction=$t,this.RemoveTagFromItemAction=$t,this.RenameAction=$t,this.RenameColumnAction=$t,this.ReportAbuseAction=$t,this.RequestReviewAction=$t,this.RestoreAction=$t,this.RestoreAllAction=$t,this.RestoreFilesAction=$t,this.RotateAction=$t,this.SaveAction=$t,this.SaveAutoAlbumAction=$t,this.SaveSortOrderAction=$t,this.SaveViewAction=$t,this.SeeAllAppsAction=$t,this.SelectAction=$t,this.SelectAllAction=$t,this.SetAlbumCoverPhotoAction=$t,this.SetDefaultViewAction=$t,this.SetFocusAction=$t,this.SetPhotosRootAction=$t,this.SetUpApprovalFlowAction=$t,this.SetUpReminderFlowAction=$t,this.ShareAction=$t,this.ShareByLinkAction=$t,this.ShowExistingFlowsAction=$t,this.ShowFiltersAction=$t,this.ShowCopilotAction=$t,this.ShowItemAnalyticsAction=$t,this.ShowSuggestedFilesAction=$t,this.ShowKeyPointsAction=$t,this.ShowKeyboardMapAction=$t,this.ShowMalwareDetectedAction=$t,this.ShowOperationsAction=$t,this.ShowPermissionsAction=$t,this.ShowPropertiesAction=$t,this.ShowReactVersionHistoryAction=$t,this.ShowRunReportAction=$t,this.ShowSelectionAction=$t,this.ShowShareAction=$t,this.ShowShareMultiItemAction=$t,this.ShowVersionHistoryAction=$t,this.SignOutAction=$t,this.SortAction=$t,this.StopSlideShowAction=$t,this.SurveyAction=$t,this.SwitchPhotoFolderLayoutTypeAction=$t,this.SwitchSharingLinkAction=$t,this.SwitchViewAction=$t,this.SyncAction=$t,this.SynchronizeAppViewAction=$t,this.LaunchTeamChannelAction=$t,this.ToggleAction=$t,this.ToggleDebugWindowAction=$t,this.ToggleIsLeftNavUserExpandedAction=$t,this.ToggleListLayoutAction=$t,this.ToggleSelectionModeAction=$t,this.TriggerFlowAction=$t,this.TriggerFlowByIdAction=$t,this.TriggerODBConvertToPdfFlowAction=$t,this.TriggerODBRequestSignOffFlowAction=$t,this.TriggerSignoffFlowAction=$t,this.TriggerExtractFileMetadataFlowAction=$t,this.UndoCheckOutAction=$t,this.UnPublishAction=$t,this.UpdateCaptionAction=$t,this.UpdatePermissionsAction=$t,this.UploadAction=$t,this.UploadTemplateAction=$t,this.QuotaBlockAction=$t,this.ViewInFolderAction=$t,this.ViewItemAction=$t,this.ViewOriginalAction=$t,this.WorkflowAction=$t}),zs=n(517),Gs=n(379);function Ks(e,t){var n,a=null===(n=e.purchaseActions)||void 0===n?void 0:n[0];return Object(i.__assign)({price:null==a?void 0:a.price,durationInMonths:null==a?void 0:a.durationInMonths,purchaseUrl:null==a?void 0:a.purchaseUrl,planQuotaBytes:e.quotaBytes,market:t.market,purchaseData:{Currency:t.currency,Name:e.planName,Duration:null==a?void 0:a.durationInMonths}},e)}var Ws="GetUpgradeOptions",qs={unknown:0,upgrade:1,downgrade:2},Qs=function(e){function t(){var t=e.call(this)||this;return t._pendingRequests={},t._navigation=t.resources.consume(B.e),t._ctpMktParam=t._navigation.viewParams.ctpMkt,t}return Object(i.__extends)(t,e),t.prototype.getStorageOptions=function(){var e=this;if(Object(de.es)(de.Vr))return this.getStorageOptionsV2();var n=new $e.e,a=this._navigation.viewParams.accountid,i=new d.t(t._storageOptionsUrl);if(i.setQueryParameter("ctpMkt",this._ctpMktParam,!1),i.setQueryParameter("accountid",a,!1),this._pendingRequests[i.toString()])return this._pendingRequests[i.toString()];var r=n.send({apiName:Ws,url:i.toString()}).then(function(t){return delete e._pendingRequests[i.toString()],t}).catch(function(t){return delete e._pendingRequests[i.toString()],I.n.wrapError(t)});return this._pendingRequests[i.toString()]=r,r},t.prototype.getStorageOptionsV2=function(){var e=this,t="v2.1",n="/sites/root/consumerSiteAppConfigs/files/oneDrive.getUpgradeOptions(market='".concat(this._ctpMktParam||"en-Us","')");if(this._pendingRequests[n])return this._pendingRequests[n];var a=this.resources.consume(ee.e).send({endpoint:Object(Ce.s)({apiVersion:t,driveId:"me",includeViewerId:!0}),apiName:"GetUpgradeOptionsV2",path:n,apiVersion:t,useAuthorizationHeaders:!0}).then(function(t){var a,r,o;return delete e._pendingRequests[n],Object(i.__assign)(Object(i.__assign)({},t),{storagePlans:null===(a=t.storagePlans)||void 0===a?void 0:a.filter(function(e){return e.purchaseActions&&e.purchaseActions.length>0}).map(function(e){return Ks(e,t)}),officePlans:null===(r=t.officePlans)||void 0===r?void 0:r.filter(function(e){return e.purchaseActions&&e.purchaseActions.length>0}).map(function(e){return Ks(e,t)}),oneDrivePlans:null===(o=t.incrementalOneDrivePlans)||void 0===o?void 0:o.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{transition:qs[e.transition]||0})})})}).catch(function(t){return delete e._pendingRequests[n],I.n.wrapError(t)});return this._pendingRequests[n]=a,a},t._storageOptionsUrl=Gs.e+"/API/2/"+Ws,t}($.n),Ys=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([93],1642)];case 1:return[2,e.sent().handleAppLoadingStatus]}})})}),Js=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([102],1643)];case 1:return[2,e.sent().handleSetOverlayContent]}})})}),Xs=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([95],1644)];case 1:return[2,e.sent().handleCopyAndEdit]}})})}),Zs=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([96],1645)];case 1:return[2,e.sent().handleDavUrlFromIds]}})})}),$s=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([97],1646)];case 1:return[2,e.sent().handleEditNotification]}})})}),ec=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([100],1647)];case 1:return[2,e.sent().handleGetCustomAuthConfig]}})})}),tc=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([101],1648)];case 1:return[2,e.sent().handleRefreshSessionInfo]}})})}),nc=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([99],1649)];case 1:return[2,e.sent().handleFileRename]}})})}),ac=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([103],1650)];case 1:return[2,e.sent().handleSignIn]}})})}),ic=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([104],1651)];case 1:return[2,e.sent().handleUserActivity]}})})}),rc=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([107],1652)];case 1:return[2,e.sent().handleWopiInfoFromUrl]}})})}),oc=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([98],1653)];case 1:return[2,e.sent().handleFileProperties]}})})}),sc=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([105],1654)];case 1:return[2,e.sent().handleVersionHistory]}})})}),cc=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([106],1655)];case 1:return[2,e.sent().handleWacClose]}})})}),dc=Object(O.i)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([94],1656)];case 1:return[2,e.sent().handleAppPushState]}})})}),lc=Object(zt.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(9,1748)];case 1:return[2,e.sent().WacGrantAccessDialog]}})})}),uc=Object(zt.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(9,1748)];case 1:return[2,e.sent().WacShareDialog]}})})}),fc=Object(zt.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([133,"ondemand.resx-ondemand"],1767)];case 1:return[2,e.sent().WacEmbedDialog]}})})}),pc=Object(zt.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([135,"ondemand.resx-ondemand"],1768)];case 1:return[2,e.sent().WacQuotaDialog]}})})}),mc=Object(zt.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([136,"ondemand.resx-ondemand"],1723)];case 1:return[2,e.sent().WacRedeemDialog]}})})}),_c=Object(zt.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([130],1769)];case 1:return[2,e.sent().LegacyWacApplication]}})})}),hc=Object(zt.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee([121],1745)];case 1:return[2,e.sent().COBWacApplication]}})})}),bc=Object(zt.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(6,1657)];case 1:return[2,e.sent().WacFilePickerDialog]}})})}),gc=Object(zt.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,n.ee(6,1657)];case 1:return[2,e.sent().WacMoveToFolderPickerDialog]}})})});Object(vt.e)(),Object(s.e)();var vc,yc,Sc="https://onedrive.live.com",Dc=new d.t(window.location.href);function Ic(e,t,n,a){var r,o,s,c,l,u;return void 0===a&&(a=null),Object(i.__awaiter)(this,void 0,I.n,function(){var f,p,m,_,h,b,g,v,y,S;return Object(i.__generator)(this,function(D){switch(D.label){case 0:return f=window.WacConfig,p=Pc(t),m=Uc(t),Mc()?("editnew"!==(null===(r=null==t?void 0:t.action)||void 0===r?void 0:r.toLowerCase())&&"editnew"!==(null===(o=null==Dc?void 0:Dc.getQueryParameter("action"))||void 0===o?void 0:o.toLowerCase())||(f.OriginalMode="EditNew"),null==a?[3,1]:(_=a,[3,3])):[3,4];case 1:return[4,e.getItem(p,m,f.OriginalMode,f.RelativePath,!0,At(kt))];case 2:_=D.sent(),D.label=3;case 3:return(b=_)&&function(e,t){var n,a,r,o=window.WacConfig,s=null===(a=null===(n=e.itemFromServer)||void 0===n?void 0:n.openWith)||void 0===a?void 0:a.wac;if(!s)return Object(x.e)("Error: the wopiInfo is null"),!1;var c,l,u,f=!1;At(wt.EnableWacUnifiedApps)&&(f=!1,s.bootstrapperUrl&&(c="Wac_JsApi_{0}_{1}",l=s.appName,u=o.OriginalMode,At(Et(c,l,u)))&&(f=!0,o.OriginalMode===vc.Edit&&At(Et("EnableWacUseOpenUrlInPlaceOfEditForUnified_{0}",s.appName))&&(s.applicationUrl||(f=!1))));var p=!1;f&&(p=!0);var m=!1;p&&At(wt.EnableWacJsApiV2)&&(At(Et("Wac_HostFlight_{0}_{0}JsApiV2",s.appName))||At(Et("Wac_HostFlight_{0}_{0}JsApiV2NoWrapper",s.appName)))&&(m=!0),o.UseUnifiedApps=p?1:0,o.BootWithJsApiV2=m?1:0,o.Application=s.appName,o.OpenInClientAction="OpenIn"+s.appName;var _=e.itemId;if(o.RelativePath){var h=new d.t(o.CloseUrl);h.setQueryParameter("id",_),o.CloseUrl=h.toString(),(h=new d.t(o.FilePropertiesUrl)).setQueryParameter("id",_),o.FilePropertiesUrl=h.toString(),(h=new d.t(o.FileVersionUrl)).setQueryParameter("resid",_),o.FileVersionUrl=h.toString(),(h=new d.t(o.EditUrl)).setQueryParameter("resid",_),o.EditUrl=h.toString(),(h=new d.t(o.ViewUrl)).setQueryParameter("resid",_),o.ViewUrl=h.toString(),o.viewParams.id=_}var b,g="{0}";try{var v=JSON.parse(o.PageTitleTypeList);for(var y in v){if("string"==typeof v[y]&&-1!==v[y].indexOf(s.appName)){g=v[y];break}if("object"==typeof v[y]&&-1!==v[y].key.indexOf(s.appName)){g=v[y].value;break}}}catch(e){Object(x.e)("json parse failed: ",e)}(o.PageTitleType=g,p)?(b={WordJsApiV2NoWrapper:At(wt.Word.WacHostFlightWordWordJsApiV2NoWrapper)?1:0,WordJsApiV2:At(wt.Word.WacHostFlightWordWordJsApiV2)?1:0,WordScriptsPreload:At(wt.Word.WacHostFlightWordWordScriptsPreload)?1:0,ExcelJsApiV2NoWrapper:At(wt.Excel.WacHostFlightExcelExcelJsApiV2NoWrapper)?1:0,ExcelJsApiV2:At(wt.Excel.WacHostFlightExcelExcelJsApiV2)?1:0,ExcelLandingPageOfflineTelemetry:At(wt.Excel.WacHostFlightExcelExcelLandingPageOfflineTelemetry)?1:0,InstantShell:At(wt.Excel.WacHostFlightExcelInstantShell)?1:0,ExcelAdaptiveLayoutDownload:At(wt.Excel.WacHostFlightExcelExcelAdaptiveLayoutDownload)?1:0,ExcelLandingPageObserver:At(wt.Excel.WacHostFlightExcelExcelLandingPageObserver)?1:0,PowerPointJsApiV2NoWrapper:At(wt.PowerPoint.WacHostFlightPowerPointPowerPointJsApiV2NoWrapper)?1:0,PowerPointJsApiV2:At(wt.PowerPoint.WacHostFlightPowerPointPowerPointJsApiV2)?1:0,OneNoteJsApiV2NoWrapper:At(wt.OneNote.WacHostFlightOneNoteOneNoteJsApiV2NoWrapper)?1:0,OneNoteJsApiV2:At(wt.OneNote.WacHostFlightOneNoteOneNoteJsApiV2)?1:0,VisioJsApiV2NoWrapper:At(wt.Visio.WacHostFlightVisioVisioJsApiV2NoWrapper)?1:0,VisioJsApiV2:At(wt.Visio.WacHostFlightVisioVisioJsApiV2)?1:0,ODCShareLinkPreload:At(Et("Wac_HostFlight_{0}_ODCShareLinkPreload",s.appName))?1:0},o.Unified=Object(i.__assign)(Object(i.__assign)({},o.Unified),{WacApplication:s.appName,WacBootstrapperUrl:s.bootstrapperUrl,UserId:$Config.hcid,OwnerId:e.ownerId,ApplicationUrl:Fc(s.applicationUrl,e.size,t),PageTitle:o.PageTitleType.replace("{0}",e.name),ETag:e.eTag,FileName:e.name,FileGetUrl:s.fileGetUrl,FileGetUrlExpiry:null===(r=s.fileGetUrlExpiry)||void 0===r?void 0:r.toString(),FileSize:e.size,WopiSrc:s.wopiSrc,AccessToken:s.accessToken,AccessTokenExpiry:s.accessTokenExpiry,HostFlights:b,AppEnabled:f?1:0,ResourceId:_})):o.Unified=void 0;return!0}(b,t)?(function(e){var t,n=window.WacConfig;document.title=n.PageTitleType.replace("{0}",null==e?void 0:e.name);var a=void 0,i=JSON.parse(n.IconPathList);for(var r in i)if(-1!==i[r].key.indexOf(n.Application)){a=i[r].value;break}if(a){var o=document.head.querySelector('link[rel="icon"]');null!==o?o.href=a:((o=document.createElement("link")).rel="icon",o.href=a,o.type="image/x-icon",document.head.appendChild(o))}if(window.history&&window.history.replaceState){var s=new d.t(window.location.href);s.getQueryParameter("resid")&&(null===(t=n.viewParams)||void 0===t?void 0:t.id)&&s.setQueryParameter("resid",n.viewParams.id,!0),window.history.replaceState(null,document.title,s.toString())}}(b),"Other"===(null===(s=n.data)||void 0===s?void 0:s.entryPoint)&&(h=Cc())&&n.update({entryPoint:h.entryPoint}),m=Uc(t),[2,{id:b.itemId,name:b.name,eTag:b.eTag,key:"id=".concat(m),vault:b.vault,urls:{dav:null===(c=b.itemFromServer)||void 0===c?void 0:c.webDavUrl},sharingType:b.sharingType,ownerId:b.ownerId,folder:b.folder,video:b.video,photo:b.photo,itemFromServer:b.itemFromServer,parentKey:b.parentKey,graph:{itemId:b.itemId,driveId:(null===(u=null===(l=b.itemFromServer)||void 0===l?void 0:l.parentReference)||void 0===u?void 0:u.driveId)||Object(Tt.e)(p)}}]):[2,null];case 4:return b=JSON.parse(f.GetItemsResponse).items[0],g=Object(xe._)(((y={}).id=b.id,y.cid=Tc(t),y)),v=b.parentId?Object(xe._)(((S={}).id=b.parentId,S.cid=Tc(t),S)):void 0,[2,{id:b.id,name:b.name,eTag:b.eTag,key:g,parentKey:v,vault:b.vault,urls:b.urls,sharingType:b.sharingLevelValue,ownerId:b.ownerCid,folder:b.folder?{}:void 0,video:b.video,photo:b.photo,graph:{itemId:b.id,driveId:Object(Tt.e)(p)}}]}})})}function xc(){return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(i.__generator)(this,function(a){switch(a.label){case 0:return At(Pt)&&(e=l.get("BadgerAuth"))?[2,{authScheme:"badger",token:e,expiryTimeUtc:""}]:(t=2===Object(Dt.e)(),n="https://api.badger".concat(t?"d":"p",".svc.ms/v1.0/token"),[4,fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({appid:"00000000-0000-0000-0000-0000481710a4"})})]);case 1:return[4,a.sent().json()];case 2:return[2,a.sent()]}})})}function Cc(){var e,t,n="SDX.Skydrive*Root";try{var a="ODCWac_ST",i=localStorage.getItem(a);if(i)return localStorage.removeItem(a),{entryPoint:n,clickTime:Number(i)};var r=u.a.get("BP"),o=E.e(r),s=o.ST,c=o.FR;if(s&&c&&(c.indexOf("WC.Hotmail*WACCopy")>-1||c.indexOf(n)>-1))return{clickTime:Number(s),entryPoint:c};if(null===(t=null===(e=window.WacConfig)||void 0===e?void 0:e.Unified)||void 0===t?void 0:t.ApplicationUrl){var l=new d.t(window.WacConfig.Unified.ApplicationUrl),f=l.getQueryParameter("wdorigin")||l.getQueryParameter("wdOrigin");if(f)return{entryPoint:f}}return{entryPoint:"Other"}}catch(e){return{entryPoint:"Other"}}}function Oc(e,t){var n,a=1===(null===(n=e.Ramps)||void 0===n?void 0:n.WacUseShareTestEndpoint)?"https://www.onedrive-tst.com":"https://www.onedrive.com",i=t.sharedevhost;return i&&(a="https://www.onedrive-tst.com"),{origin:a,devHost:i,height:402,width:320}}function wc(e){var t,n,a=this,r=e.redeemDialogHandleRef,o=e.diagnostics,s=e.viewParams,c=e.item,d=e.resourceScope,l=e.wacDataSource,u=e.vault,f=window.Flight,p=window.FilesConfig,m=window.$Config,_=window.WacConfig,h=d.consume(V.p).getIdentity().type!==re.e.anonymous;return{diagnostics:o,viewParams:s,callerCid:m.hcid,env:p.env,enableInteractiveAuthFlow:1===(null===(t=f.Ramps)||void 0===t?void 0:t.WacAddinInteractiveAuthFlow),email:m.email,pageTitleType:_.PageTitleType,wacIframeDomain:null===(n=_.Unified)||void 0===n?void 0:n.ApplicationUrl,Mode:_.Mode,ViewUrl:_.ViewUrl,EditUrl:_.EditUrl,FileVersionUrl:_.FileVersionUrl,FilePropertiesUrl:_.FilePropertiesUrl,CloseUrl:_.CloseUrl,SignInUrl:p.signInUrl,autoRedeemSignOut:p.autoRedeemSignOut,autoRedeemUrl:p.autoRedeemUrl,authKey:p.authKey,item:c,refreshItem:function(e){return Object(i.__awaiter)(a,void 0,void 0,function(){var e,t;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return e=Pc(s),t=Uc(s),[4,l.getItem(e,t,_.OriginalMode,_.RelativePath)];case 1:return n.sent().key="id=".concat(t),[2]}})})},wacDataSource:l,isAuthenticated:h,vault:u,Ramps:f.Ramps,shareDialog:Oc(window.Flight,s),redeemDialogHandleRef:r}}function Ec(e){var t=Object(r.useState)(function(){return new v.e({name:"ODCWacHost.Bootstrap"})})[0],n=e.item,a=e.vault,c=e.diagnostics,l=e.viewParams,u=e.wacDataSource,f=e.bootstrapperUrl,p=e.resources,m=Object(r.useRef)(null),_=Object(r.useState)(function(){return wc({redeemDialogHandleRef:m,diagnostics:c,viewParams:l,item:n,resourceScope:p,wacDataSource:u,vault:a})}),h=_[0],b=_[1],g=Object(r.useCallback)(function(e){window.WacConfig.Mode=e.NewMode,Object(s.t)({Mode:window.WacConfig.Mode||window.WacConfig.OriginalMode}),b(function(t){return Object(i.__assign)(Object(i.__assign)({},t),{Mode:e.NewMode})})},[b]),y=function(e){e&&(e.bootState&&c.update({bootState:e.bootState}),function(e,t){var n,a=e.resultType,i=e.resultCode,r=e.errorInfo,o=e.error;new v.e({name:"".concat(Mc()?"COB":"ODC",".Wac.Init"),startTimeOverride:null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.hostInitializeCallTime}).end({resultType:a,resultCode:i,error:r,extraData:{error:o?JSON.stringify(o):""}})}(e,c),function(e,t){var n=e.resultType,a=e.resultCode,i=e.errorInfo,r=e.error,o=window.WacConfig,s=o.Unified,c=window.Flight;new Vt.e({scenario:"DocOpenODC",extraData:{clientId:null==s?void 0:s.WacApplication}}).end({resultType:n,errorCode:a,extraData:{HostSessionId:null==s?void 0:s.HostSessionId,FileSize:null==s?void 0:s.FileSize,errorInfo:i,error:r?JSON.stringify(r):"",action:o.Mode||o.OriginalMode,session:c.session,xid:c.xid}})}(e))},D=Object(r.useState)(function(){var e,t=window.WacConfig,n=t.Unified,a=window.Flight,i=Mc(),r=new d.t(n.ApplicationUrl),o=void 0;return i&&r&&(o=decodeURIComponent(r.getQueryParameter("sc"))),{UseV2:!!t.BootWithJsApiV2,UserId:n.UserId,SessionContext:o,MigrationState:i,HostName:n.HostName,HostSessionId:n.HostSessionId,OwnerId:n.OwnerId,AppEnabled:n.AppEnabled,capabilities:{isFeatureEnabled:function(e){return!(!n||!n.HostFlights||!n.HostFlights[e])},customAuthConfig:!!(null===(e=a.Ramps)||void 0===e?void 0:e.WacSupportCustomAuthConfig),commonFilePicker:At(de.Jo),moveToFolder:At(de.Xo)},BootstrapperUrl:n.WacBootstrapperUrl,Application:n.WacApplication,ApplicationUrl:n.ApplicationUrl,FileName:n.FileName,FileGetUrl:n.FileGetUrl,FileGetUrlExpiry:n.FileGetUrlExpiry,FileSize:n.FileSize,ETag:n.ETag,UniqueId:n.ResourceId,WopiSrc:n.WopiSrc,AccessToken:n.AccessToken,AccessTokenExpiry:n.AccessTokenExpiry,ReadOnly:n.ReadOnly,ViewOnly:n.ViewOnly,onModeSwitched:g,triggerLogEvent:y}})[0],I=Object(r.useState)(yc.Initial),x=I[0],w=I[1],E=Object(r.useState)(function(){return new C})[0],A=Object(r.useCallback)(function(e){e.state?E.respond({MessageId:O.t.App_PopState,Values:{Url:window.location.href,State:e.state},CorrelationId:je.e.generate()}):window.history&&window.history.back()},[E]);Object(r.useEffect)(function(){return window.addEventListener("popstate",A),function(){window.removeEventListener("popstate",A)}},[E]),Object(r.useEffect)(function(){!function(){Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),x!==yc.Initial?[2]:(w(yc.Loading),c.update({officeBootstrapperStartTime:Date.now()}),[4,S(f,y)]);case 1:return e.sent(),c.update({officeBootstrapperEndTime:Date.now()}),w(yc.Loaded),[3,3];case 2:return e.sent(),c.update({officeBootstrapperEndTime:Date.now()}),w(yc.Failed),[2];case 3:return[2]}})})}()},[x,f,c]);var L=function(){var e,t,n,a,i=window.WacConfig;return(null===(a=null===(t=null===(e=window.Microsoft)||void 0===e?void 0:e.Office)||void 0===t?void 0:t[null===(n=null==i?void 0:i.Unified)||void 0===n?void 0:n.WacApplication])||void 0===a?void 0:a.EventIds)||{}}();return r.createElement(W.e,{resources:p},r.createElement(pt,{diagnostics:c},r.createElement(ht.e,{dispatcher:E},x===yc.Loaded?r.createElement(_t,{bootstrapParams:D,onSucceed:function(){var e,n,a,i,s;if(window.g_WACDone=!0,!(null==l?void 0:l.disableQuotaWarning)&&(null===(e=window.WacConfig)||void 0===e?void 0:e.IsOverQuota)){var d=null===(n=window.WacConfig)||void 0===n?void 0:n.Unified,u=d.OwnerId,f=d.UserId;!function(e,t,n,a){var i="wac-quota-dialog",s=document.getElementById(i);s||((s=document.createElement("div")).id=i,document.body.append(s)),o.render(r.createElement(pc,{fileSize:e,wacType:a,resources:t,isUserFileOwner:n}),s)}(null===(a=window.WacConfig.Unified)||void 0===a?void 0:a.FileSize,p,u===f,null===(s=null===(i=window.WacConfig.Unified)||void 0===i?void 0:i.WacApplication)||void 0===s?void 0:s.toLowerCase())}t.end({resultType:v.t.Success,resultCode:"WacApplication bootstrap succeed",extraData:{diagnostics:h.diagnostics.data}}),function(e){var t,n,a,i;if(At(wt.WacSendPerformanceLog)&&(null==e?void 0:e.data)){var r,o=window.WacConfig,s=e.data;if(s.userClickTime)r=s.userClickTime;else{if(!s.hostPageNavigationStartTime)return;r=s.hostPageNavigationStartTime}var c="".concat(Mc()?"COB":"ODC",".Wac.Perf"),d=function(e,t){new v.e({name:"".concat(c,".").concat(e),startTimeOverride:Date.now()-(t-r)}).end({resultType:v.t.Success,resultCode:"Success",extraData:{userClickTime:s.userClickTime,hostPageNavigationStartTime:s.hostPageNavigationStartTime,ServerStartTime:o.ServerStartTime?Number(o.ServerStartTime):void 0,name:e,time:t}})};s.userClickTime&&d("userClickTime",s.userClickTime),s.hostPageNavigationStartTime&&d("hostPageNavigationStartTime",s.hostPageNavigationStartTime),s.hostPageFirstFlushTime&&d("hostPageFirstFlushTime",s.hostPageFirstFlushTime),s.officeBootstrapperStartTime&&d("officeBootstrapperStartTime",s.officeBootstrapperStartTime),s.officeBootstrapperEndTime&&d("officeBootstrapperEndTime",s.officeBootstrapperEndTime),s.officeInitializationTime&&d("officeInitializationTime",s.officeInitializationTime),(null===(t=s.wacAppDiagnostics)||void 0===t?void 0:t.documentLoadedTime)&&d("documentLoadedTime",null===(n=s.wacAppDiagnostics)||void 0===n?void 0:n.documentLoadedTime),(null===(a=s.wacAppDiagnostics)||void 0===a?void 0:a.appCompletedTime)&&d("appCompletedTime",null===(i=s.wacAppDiagnostics)||void 0===i?void 0:i.appCompletedTime),s.wacHostCompleteTime&&d("wacHostCompleteTime",s.wacHostCompleteTime),s.serverStartTime&&(r=s.serverStartTime,s.serverStartTime&&d("serverStartTime",s.serverStartTime),s.pageTaskCompleteTime&&d("pageTaskCompleteTime",s.pageTaskCompleteTime),s.responseCompleteTime&&d("responseCompleteTime",s.responseCompleteTime))}}(c)},onFailed:function(){window.g_WACDone=!1,t.end({resultType:v.t.Failure,resultCode:"WacApplication bootstrap failed",extraData:{diagnostics:h.diagnostics.data}})}}):null,r.createElement(mc,{redeemDialogHandleRef:m,callerCid:h.callerCid,item:n,signInUrl:h.SignInUrl,autoRedeemSignOut:h.autoRedeemSignOut,autoRedeemUrl:h.autoRedeemUrl,authKey:h.authKey}),r.createElement(yt.e,{eventType:L.UserAccessAndPermissions},r.createElement(lc,Object(i.__assign)({itemName:n.name,listItemId:n.id},h.shareDialog))),r.createElement(bt,{eventType:L.SetOverlayContent,handler:Js,context:h}),r.createElement(bt,{eventType:L.CopyAndEdit,handler:Xs,context:h}),r.createElement(bt,{eventType:L.Edit,handler:Xs,context:h}),r.createElement(bt,{eventType:L.GetDavUrlFromIds,handler:Zs,context:h}),r.createElement(bt,{eventType:L.UserEditActivity,handler:$s,context:h}),r.createElement(yt.e,{eventType:L.FileEmbed},r.createElement(fc,{item:h.item})),r.createElement(bt,{eventType:L.GetCustomAuthConfig,handler:ec,context:h}),r.createElement(bt,{eventType:L.RefreshSessionInfo,handler:tc,context:h}),r.createElement(bt,{eventType:L.FileRenamed,handler:nc,context:h}),r.createElement(yt.e,{eventType:L.Share},r.createElement(uc,Object(i.__assign)({itemName:n.name,listItemId:n.id},h.shareDialog))),At(de.Xo)?r.createElement(yt.e,{eventType:L.MoveToFolder},r.createElement(gc,{item:n})):null,At(de.Jo)?r.createElement(yt.e,{eventType:L.SharedFilePicker},r.createElement(bc,{item:n})):null,r.createElement(bt,{eventType:L.SignIn,handler:ac,context:h}),r.createElement(bt,{eventType:L.UserActivity,handler:ic,context:h}),r.createElement(bt,{eventType:L.FileVersions,handler:sc,context:h}),r.createElement(bt,{eventType:L.GetWopiInfoFromUrl,handler:rc,context:h}),r.createElement(bt,{eventType:L.UI_Close,handler:cc,context:h}),r.createElement(kc,{context:h,updateWacAppMode:g}))),r.createElement(U,{vault:a,dispatcher:E}))}function Ac(e){var t=e.item,n=e.vault,a=e.diagnostics,o=e.viewParams,s=e.wacDataSource,c=e.applicationUrl,d=e.applicationParams,l=e.resources,u=Object(r.useRef)(null),f=Object(r.useState)(function(){return wc({redeemDialogHandleRef:u,diagnostics:a,viewParams:o,item:t,resourceScope:l,wacDataSource:s,vault:n})}),p=f[0],m=f[1],_=Object(r.useCallback)(function(e){m(function(t){return Object(i.__assign)(Object(i.__assign)({},t),{Mode:e.NewMode})})},[m]),h=Object(r.useState)(function(){return new C})[0],b=Object(r.useCallback)(function(e){e.state?h.respond({MessageId:O.t.App_PopState,Values:{Url:window.location.href,State:e.state},CorrelationId:je.e.generate()}):window.history&&window.history.back()},[h]);return Object(r.useEffect)(function(){return window.addEventListener("popstate",b),function(){window.removeEventListener("popstate",b)}},[h]),r.createElement(W.e,{resources:l},r.createElement(pt,{diagnostics:a},r.createElement(ht.e,{dispatcher:h},r.createElement(_c,{applicationUrl:c,params:d,migrationState:Mc()}),r.createElement(mc,{redeemDialogHandleRef:u,callerCid:p.callerCid,item:t,signInUrl:p.SignInUrl,autoRedeemSignOut:p.autoRedeemSignOut,autoRedeemUrl:p.autoRedeemUrl,authKey:p.authKey}),r.createElement(kc,{context:p,updateWacAppMode:_}))),r.createElement(U,{vault:n,dispatcher:h}))}function Lc(e){var t=e.token,n=e.diagnostics,a=e.wacDataSource,o=e.viewParams,s=e.migration,c=e.resources,d=Object(r.useRef)(null),l=Object(r.useState)(function(){return wc({redeemDialogHandleRef:d,diagnostics:n,viewParams:o,resourceScope:c,wacDataSource:a})}),u=l[0],f=l[1],p=Object(r.useCallback)(function(e){f(function(t){return Object(i.__assign)(Object(i.__assign)({},t),{Mode:e.NewMode})})},[f]),m=Object(r.useState)(function(){return new C})[0],_=Object(r.useCallback)(function(e){e.state?m.respond({MessageId:O.t.App_PopState,Values:{Url:window.location.href,State:e.state},CorrelationId:je.e.generate()}):window.history&&window.history.back()},[m]);Object(r.useEffect)(function(){return window.addEventListener("popstate",_),function(){window.removeEventListener("popstate",_)}},[m]);var h=Object(r.useCallback)(function(e){if(e){var t=e.page,n=e.item,a=e.wopiContext;n.id="".concat(s.hcid,"!s").concat(n.id.slice(1,-1).replace(/-/g,""));var r=t.title,o=t.faviconLink,c=t.queryUrl;if(r&&(document.title=r),o){var d=document.head.querySelector('link[rel="icon"]');null!==d?d.href=o:((d=document.createElement("link")).rel="icon",d.href=o,d.type="image/x-icon",document.head.appendChild(d))}if(c){-1===c.indexOf("?cid=")&&-1===c.indexOf("&cid=")&&(c+="&cid="+s.hcid);var l=location.href.substring(0,location.href.indexOf(location.search)+1);window.history.replaceState({},"",l+c)}new v.e({name:"Convergence.WacOpen"}).end({resultType:v.t.Success,resultCode:"Success",error:""}),f(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{item:Object(i.__assign)(Object(i.__assign)({},n),{graph:{itemId:n.id,driveId:Object(Tt.e)(s.hcid)}}),wacIframeDomain:a.WebAppUrl})})}},[f,s.hcid]);return r.createElement(W.e,{resources:c},r.createElement(ht.e,{dispatcher:m},t.accessToken?r.createElement(hc,{docAspxUrl:s.DocAspxUrl,token:t}):null,u.item?r.createElement(mc,{redeemDialogHandleRef:d,callerCid:u.callerCid,item:u.item,signInUrl:u.SignInUrl,autoRedeemSignOut:u.autoRedeemSignOut,autoRedeemUrl:u.autoRedeemUrl,authKey:u.authKey}):null,r.createElement(bt,{eventType:gt.COB_SyncPageContext,handler:h,context:u}),r.createElement(kc,{context:u,updateWacAppMode:p})))}function kc(e){var t=e.context,n=e.updateWacAppMode;if(!t.item)return null;var a=t.item;return r.createElement(r.Fragment,null,r.createElement(yt.e,{eventType:O.e.UI_CheckUserAccessAndGrantPermissions},r.createElement(lc,Object(i.__assign)({itemName:a.name,listItemId:a.id},t.shareDialog))),r.createElement(bt,{eventType:O.e.SetOverlayContent,handler:Js,context:t}),r.createElement(bt,{eventType:O.e.App_LoadingStatus,handler:Ys,context:t}),r.createElement(bt,{eventType:O.e.UI_CopyAndEdit,handler:Xs,context:t}),r.createElement(bt,{eventType:O.e.App_WopiDavUrlFromIds,handler:Zs,context:t}),r.createElement(bt,{eventType:O.e.App_WopiInfoFromUrl,handler:rc,context:t}),r.createElement(bt,{eventType:O.e.Edit_Notification,handler:$s,context:t}),r.createElement(yt.e,{eventType:O.e.UI_FileEmbed},r.createElement(fc,{item:t.item})),r.createElement(bt,{eventType:O.e.App_GetCustomAuthConfig,handler:ec,context:t}),r.createElement(bt,{eventType:O.e.App_RefreshSessionInfo,handler:tc,context:t}),r.createElement(bt,{eventType:O.e.File_Rename,handler:nc,context:t}),r.createElement(yt.e,{eventType:O.e.UI_Sharing},r.createElement(uc,Object(i.__assign)({itemName:a.name,listItemId:a.id},t.shareDialog))),At(de.Xo)?r.createElement(yt.e,{eventType:O.e.App_MoveToFolder},r.createElement(gc,{item:a})):null,At(de.Jo)?r.createElement(yt.e,{eventType:O.e.App_FilePicker},r.createElement(bc,{item:a})):null,r.createElement(bt,{eventType:O.e.UI_SignIn,handler:ac,context:t}),r.createElement(bt,{eventType:O.e.User_Activity,handler:ic,context:t}),r.createElement(bt,{eventType:O.e.UI_FileVersions,handler:sc,context:t}),r.createElement(bt,{eventType:O.e.UI_FileProperties,handler:oc,context:t}),r.createElement(bt,{eventType:O.e.App_PushState,handler:dc,context:t}),r.createElement(bt,{eventType:O.e.App_SwitchMode,handler:n,context:t}))}function Mc(){var e=window.WacConfig;return!(!e||!e.MigrationState&&!e.Migration)}function Pc(e){var t,n=window.WacConfig;return Mc()&&((null===(t=n.viewParams)||void 0===t?void 0:t.driveid)||(null==e?void 0:e.driveid))||Tc(e)}function Tc(e){var t,n,a=window.WacConfig;return(null===(t=a.viewParams)||void 0===t?void 0:t.cid)||(null==e?void 0:e.cid)||(null===(n=a.Migration)||void 0===n?void 0:n.hcid)}function Uc(e){var t,n,a=window.WacConfig;return(null===(t=a.viewParams)||void 0===t?void 0:t.id)||(null==e?void 0:e.resid)||(null===(n=a.Migration)||void 0===n?void 0:n.id)}function Fc(e,t,n){if(!Mc())return e;var a=new d.t(e);0===t&&a.setQueryParameter("new","1",!0);try{var r=JSON.parse(a.getQueryParameter("sc"));r=r?Object(i.__assign)(Object(i.__assign)({},r),{pmo:r.pmo||Sc}):{pmo:Sc},n.redeem&&(r.redeem=n.redeem),a.setQueryParameter("sc",encodeURIComponent(JSON.stringify(r)),!0)}catch(e){Object(x.e)("can not add sessionContext: ",e)}!Le.e.isActivated("F1ECDFC1-79AA-4298-BF16-D19171FA771C","3/8/2023","KillSwitch to Update Language Param from mkt")&&$Config.mkt&&(a.setQueryParameter("ui",$Config.mkt,!0),a.setQueryParameter("rs",$Config.mkt,!0)),!Le.e.isActivated("A8024D7A-83BC-471B-8F1F-533B48FB5B4A","4/5/2023","KillSwitch to Append UiHost To UnifiedAppUrls")&&a.setQueryParameter("uih","OneDrive",!0);var o=(null==n?void 0:n.wd)||(null==Dc?void 0:Dc.getQueryParameter("wd"));o&&a.setQueryParameter("wd",o,!0);var s=(null==n?void 0:n.wdorigin)||(null==n?void 0:n.wdOrigin)||(null==Dc?void 0:Dc.getQueryParameter("wdorigin"))||(null==Dc?void 0:Dc.getQueryParameter("wdOrigin"));return s&&a.setQueryParameter("wdorigin",s,!0),a.toString()}function Hc(){window.location.href="https://onedrive.live.com/error.html"}!function(e){e.View="View",e.Edit="Edit",e.EditNew="EditNew",e.BinaryConvert="BinaryConvert"}(vc||(vc={})),function(e){e[e.Initial=0]="Initial",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Failed=3]="Failed"}(yc||(yc={})),function(){var e,t,a,l,u,f,p,m,_;Object(i.__awaiter)(this,void 0,void 0,function(){var b,v,y,S,D,I,C,O,E,A,L,k,M,P,T,U,F,H,R,W,Q,Y,J,X,$,ee,te,ae,ie,oe,se,ce;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(i.trys.push([0,12,,13]),b=window.WacConfig,v=function(){var e,t=Cc();e=t?new g(t.entryPoint,t.clickTime):new g;var n=window.$Config,a=window.WacConfig;if(e.update({serverStartTime:(null==a?void 0:a.ServerStartTime)?Number(null==a?void 0:a.ServerStartTime):void 0,pageTaskCompleteTime:(null==a?void 0:a.WacPageTaskCompleteTime)?Number(null==a?void 0:a.WacPageTaskCompleteTime):void 0,responseStartTime:n.pageResponseStartTime?Number(n.pageResponseStartTime):void 0,responseCompleteTime:n.pageResponseCompleteTime?Number(n.pageResponseCompleteTime):void 0,hostPageFirstFlushTime:Date.now()}),window.performance&&window.performance.timing){var i=window.performance.timing;e.update({hostPageFetchStartTime:i.fetchStart,hostPageNavigationStartTime:i.navigationStart})}return e}(),window.history&&window.history.replaceState&&(y=window.location.href.replace(/&(wdo|wdfre)=\d+/gi,""),window.history.replaceState(null,document.title,y)),function(e){e.expose(B.e,new c.e),e.expose(Na.D,Rn.observable({})),e.expose(V.N,new(e.injected(dt))),e.expose(q._,new(e.injected(Ze.e))),e.exposeFactory(V.p,new j.e(G.e)),e.expose(z.n,new(e.injected(K.e))),e.exposeFactory(V.H,new j.e(z.n));var t=new(e.injected(Z));e.expose(V.u,t),e.expose(V.b,t),e.expose(V.a,t),e.expose(V.O,t),e.expose(z.e,t),e.expose(q.m,new(e.injected(ne))),e.expose(V.m,new(e.injected(Me))),e.expose(q.a,new(e.injected(Xe))),e.expose(V.T,new(e.injected(Qs))),e.expose(Jt.e,new(e.injected(Yt.e))),e.expose(q.u,new(e.injected(Qt))),e.expose(Na.e,new Vs),e.exposeAsync(V.f,new j.t(function(){return n.ee([157],1658).then(function(e){return e.resourceKey})})),e.expose(zs.e,e),e.expose(V.o,new(e.injected(Ot))),e.expose(q.t,new(e.injected(ut)))}(N.e),S=new c.e,D=S.viewParams,I=Object(St.a)({apiVersion:"v1.0",driveId:Pc(D),includeViewerId:!1,migrationState:Mc()}),C=N.e.consume(V.p),O=void 0,E=C.getIdentity().type===re.e.anonymous,A=void 0,L=void 0,!(D&&D.redeem&&Mc()))return[3,6];i.label=1;case 1:return i.trys.push([1,5,,6]),E?[4,xc()]:[3,3];case 2:A=i.sent(),i.label=3;case 3:return[4,(O=new w.e(I,C,A)).redeemAndGetItem(D.redeem,b.OriginalMode,At(Mt),At(Pt))];case 4:return(null==(k=i.sent())?void 0:k.error)?function(e,t){var n;if(e&&e.innerError&&"sharingPasswordRequired"===e.innerError.code)if(0===(null===(n=e["@error.fixItUrl"])||void 0===n?void 0:n.indexOf(Sc)))window.location.href=e["@error.fixItUrl"];else{var a=new d.t(Sc);a.setQueryParameter("v","validatepermission",!0),a.setQueryParameter("redeem",null==t?void 0:t.redeem,!0),a.setQueryParameter("migratedtospo","true",!0),a.setQueryParameter("cid",null==t?void 0:t.cid,!0),a.setQueryParameter("id",null==t?void 0:t.resid,!0),a.setQueryParameter("ithint",null==t?void 0:t.ithint,!0),window.location.href=a.toString()}}(k.error,D):k&&(L=k),[3,6];case 5:return M=i.sent(),Object(x.e)("can not acquire badger token or session token, can not complete redeem operation: ",M),Hc(),[2];case 6:return O=null!=O?O:new w.e(I,C,A),(P=document.createElement("div")).id="app",document.body.append(P),b.Migration?A?(U={accessToken:A.token,isBadger:!0},[3,9]):[3,7]:[3,10];case 7:return[4,C.getSessionToken()];case 8:U=i.sent(),i.label=9;case 9:return T=U,o.render(r.createElement(Lc,{diagnostics:v,token:T,wacDataSource:O,viewParams:D,authSessionId:$Config.authSessionId,email:$Config.email,migration:b.Migration,resources:N.e}),P),[2];case 10:return[4,Ic(O,D,v,L)];case 11:return(F=i.sent())?(H=E?Bt.e.ConsumerAnonymous:Object(Gt.e)($Config.hcid)?Bt.e.ConsumerOnSPO:Bt.e.Consumer,Object(s.t)({ClientName:"WacHost.".concat(null===(e=b.Unified)||void 0===e?void 0:e.WacApplication),Application:b.Application,Mode:b.Mode||b.OriginalMode,OriginalMode:b.OriginalMode,AccountType:Bt.e[H]}),R=null,W=null,Object(jt.t)()?W=function(e){var t=Object(Nt.getAriaInfo)(),n=t.ariaEnvironment,a=t.version,i=t.ariaContext,r=e.clientName,o="prod"===n?Rt.ODCTenantTokens.prod:Rt.ODCTenantTokens.ppe;if(n&&"dev"!==a||Object(de.es)(de.hn)){var s=Object(Ht.getCustomerPromiseHandler)({clientName:r,ariaEnvironment:n,ariaContext:i,tenantToken:o});return s.attach(Object(Ut.e)()),s}return null}({clientName:null===(t=b.Unified)||void 0===t?void 0:t.WacApplication}):R=function(e){var t=Object(Nt.getAriaInfo)(),a=t.ariaEnvironment,i=t.version,r=t.ariaContext,o=e.clientName,s="prod"===a?Rt.ODCTenantTokens.prod:Rt.ODCTenantTokens.ppe;if(a&&"dev"!==i||Object(de.es)(de.hn)){var c=Object(Ft.getCustomerPromiseHandler)({clientName:o,ariaEnvironment:a,ariaContext:r,ariaLoader:function(){return n.ee(1,1659,7)},disableCookies:r.disableCookies,tenantToken:s});return c.attach(Object(Ut.e)()),c}return null}({clientName:null===(a=b.Unified)||void 0===a?void 0:a.WacApplication}),(null===(l=b.Unified)||void 0===l?void 0:l.HostSessionId)&&(W?W.updateContext({context:{customerPromiseSessionId:null===(u=b.Unified)||void 0===u?void 0:u.HostSessionId,accountType:Bt.e[H]}}):R&&R.updateContext({customerPromiseSessionId:null===(f=b.Unified)||void 0===f?void 0:f.HostSessionId,accountType:Bt.e[H]})),Q=!!F.vault,Y=Q?new h($Config.unid,O):void 0,J=null===(p=b.Unified)||void 0===p?void 0:p.WacBootstrapperUrl,b.UseUnifiedApps&&b.Unified?(o.render(r.createElement(Ec,{item:F,vault:Y,viewParams:D,wacDataSource:O,bootstrapperUrl:J,diagnostics:v,resources:N.e}),P),[3,13]):(Mc()&&(X=null===(_=null===(m=F.itemFromServer)||void 0===m?void 0:m.openWith)||void 0===_?void 0:_.wac,te=Fc(X.applicationUrl,F.size,D),($={}).access_token=X.accessToken,$.access_token_ttl=X.accessTokenExpiry,$.owner_id=F.ownerId,$.user_id=$Config.hcid,b.Legacy={Url:te,Params:$}),b.Legacy||(ee="Edit"===b.OriginalMode,te=ee?F.urls.wacIframeEdit:F.urls.wacIframeView,ae={},null==(ie=ee?F.urls.wacIframeEditPostParameters:F.urls.wacIframeViewPostParameters)||ie.split("&").forEach(function(e){var t=e.split("=");ae[decodeURIComponent(t[0])]=decodeURIComponent(t[1])}),b.Legacy={Url:te,Params:ae}),oe=b.Legacy.Url,se=b.Legacy.Params,o.render(r.createElement(Ac,{item:F,vault:Y,viewParams:D,wacDataSource:O,diagnostics:v,resources:N.e,applicationUrl:oe,applicationParams:se}),P),[2])):(Hc(),[2]);case 12:return ce=i.sent(),Object(x.e)("error when rendering app: ",ce),[2];case 13:return[2]}})})}()}])),define("ODCWacHostWebpack",[],{});