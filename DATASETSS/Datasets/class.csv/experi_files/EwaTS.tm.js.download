'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1206:function(w,B,a){a.r(B);w=a(0);var b=a(16),c=a(102),h=a(82),f=a(11),e=a(233);class k extends e.a{constructor(v){super();this.$=v;this.Oe()}create(){const {RenderingFidelityTracker:v}=a(1206);let u=this.$.ia.Ja(462);u||(u=this.$.ia.Va(462,new v));this.ve(u)}}Object(w.a)(k,"RenderingFidelityTrackerFactory",e.a,[]);var l=a(53);a.d(B,"RenderingFidelityTracker",function(){return r});class r extends h.a{constructor(){super();
this.d_i=3E4;this.Ikb={};this.K$d={};this.TGe={};c.Health.instance.addQosPillar("Fidelity")}static la(v){v.ia.Va(463,new k(v))}w3g(v,u,x,t){if(!(l.a.instance.Gea(new Date)<this.d_i)){var m=f.HelperMethods.VN(()=>{var n=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(u),A=Object.keys(n),y=this.TGe[v];for(var z=0;z<A.length;z++){var F=A[z];this.K$d[F]||(null===y||void 0===y?0:y[F])&&this.Ikb[F]&&(this.Ikb[F]-=y[F])}this.TGe[v]=n;for(z=0;z<A.length;z++)if(y=A[z],!this.K$d[y])if(F=n[y],
this.Ikb[y]&&(F+=this.Ikb[y]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(y,F)){this.K$d[y]=!0;n=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(y);A=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(y);z=!("ThickBorder"===y||"MediumBorder"===y);n&&A&&z&&c.Health.instance.recordQosError(n,[A],!1,!0,!0,!1,null);b.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+y+", isHC:"+x+", scaleFactor:"+t+"}");break}else this.Ikb[y]=
F});1<m&&b.ULS.sendTraceTag(527472323,1,50,`RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration=${m}`)}}}Object(w.a)(r,"RenderingFidelityTracker",h.a,[398,5])},1328:function(w,B,a){function b(ja){var ia=ja.replace(/-.*/g,()=>"");ia=tc.get(ia);return null!==ia&&void 0!==ia?ia:ja.startsWith("ooux")?"ooux":"other"}function c(ja){switch(!0){case ja.qB:return Vd.MergedCell;case ja.gQ:return Vd.WAg;case ja.xz:return Vd.Formula;case ja.hasAutoFilter:return Vd.AutoFilter;
case ja.Qea:return Vd.PivotFilter;case !!ja.gzc:return Vd.PivotTable;case ja.aoa:return Vd.Comment;case ja.v$a:return Vd.Sparkline;case ja.s$a:return Vd.InCellImage;case ja.hasRichText:return Vd.XCg;default:return""}}a.r(B);var h={};a.r(h);a.d(h,"InteractivityTrackerService",function(){return uc});var f={};a.r(f);a.d(f,"JsSelfProfilerManager",function(){return Ud});var e={};a.r(e);a.d(e,"PageLoadEngagementInfo",function(){return Xc});var k={};a.r(k);var l={};a.r(l);a.d(l,"GridActionTelemetryManager",
function(){return ge});var r={};a.r(r);a.d(r,"DocumentVisibilityObserver",function(){return Cb});var v={};a.r(v);a.d(v,"ValidationTelemetryManager",function(){return kd});var u=a(0),x=a(16);class t{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=
this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(u.a)(t,"BrowserInfo",null,[]);class m{constructor(){this.Version=this.Name=null}}Object(u.a)(m,"PluginInfo",null,[]);var n=a(5),A=a(30);class y{static $Ed(){if(n.AFrameworkApplication.da.na("LogBrowserInfoIsEnabled")){var ja=y.MZh();try{const ia=
JSON.stringify(ja);x.ULS.sendTraceTag(6903563,102,50,ia)}catch(ia){x.ULS.sendTraceTag(6903564,102,15,ia.message)}}else x.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static Ydi(){const ja=window.navigator.plugins;if(!ja||!ja.length)return null;const ia=[];for(let dc=0;dc<ja.length;dc++){const od=ja[dc].name,ae=ja[dc].version;Array.add(ia,Object.assign(new m,{Name:od,Version:ae}))}return ia}static MZh(){const ja=new t,ia=new Sys.StringBuilder;y.Cw(dc=>{ja.DocElemClientHeight=
dc},()=>document.documentElement.clientHeight,ia);y.Cw(dc=>{ja.DocElemClientWidth=dc},()=>document.documentElement.clientWidth,ia);y.Cw(dc=>{ja.DocElemOffsetHeight=dc},()=>document.documentElement.offsetHeight,ia);y.Cw(dc=>{ja.DocElemOffsetWidth=dc},()=>document.documentElement.offsetWidth,ia);y.Cw(dc=>{ja.ScreenAvailHeight=dc},()=>window.screen.availHeight,ia);y.Cw(dc=>{ja.ScreenAvailWidth=dc},()=>window.screen.availWidth,ia);y.Cw(dc=>{ja.ScreenWidth=dc},()=>window.screen.width,ia);y.Cw(dc=>{ja.ScreenHeight=
dc},()=>window.screen.height,ia);y.Cw(dc=>{ja.ScreenLogicalXdpi=dc},()=>window.screen.logicalXDPI,ia);y.Cw(dc=>{ja.ScreenLogicalYdpi=dc},()=>window.screen.logicalYDPI,ia);y.Cw(dc=>{ja.ScreenDeviceXdpi=dc},()=>window.screen.deviceXDPI,ia);y.Cw(dc=>{ja.ScreenDeviceYdpi=dc},()=>window.screen.deviceYDPI,ia);y.Cw(dc=>{ja.WinInnerHeight=dc},()=>window.self.innerHeight,ia);y.Cw(dc=>{ja.WinInnerWidth=dc},()=>window.self.innerWidth,ia);y.Cw(dc=>{ja.WinOuterHeight=dc},()=>window.self.outerHeight,ia);y.Cw(dc=>
{ja.WinOuterWidth=dc},()=>window.self.outerWidth,ia);y.Cw(dc=>{ja.WinOrientation=dc},()=>window.self.orientation,ia);y.Cw(dc=>{ja.WinDevicePixelRatio=dc},()=>window.self.devicePixelRatio,ia);y.Cw(dc=>{ja.SupportsTouch=dc},()=>A.a.IIc,ia);y.Cw(dc=>{ja.NavAppName=dc},()=>window.navigator.appName,ia);y.Cw(dc=>{ja.NavAppVersion=dc},()=>window.navigator.appVersion,ia);y.Cw(dc=>{ja.NavLanguage=dc},()=>window.navigator.browserLanguage||window.navigator.language,ia);y.Cw(dc=>{ja.NavUserAgent=dc},()=>window.navigator.userAgent,
ia);y.Cw(dc=>{ja.NavPlatform=dc},()=>window.navigator.platform,ia);y.Cw(dc=>{ja.NavPlugins=dc},y.Ydi,ia);y.Cw(dc=>{ja.CalculatedDevicePixelRatio=dc},()=>y.devicePixelRatio,ia);ja.Error=ia.toString();return ja}static get devicePixelRatio(){const ja=window.devicePixelRatio;return isNaN(ja)?window.screen.deviceXDPI/window.screen.logicalXDPI:ja}static Cw(ja,ia,dc){try{const od=ia();ja(od)}catch(od){dc.isEmpty()||dc.append(" | "),dc.append(od.message||"null")}}}Object(u.a)(y,"BrowserInfoLogger",null,[]);
var z=a(260);class F{get name(){return"Common.App.BrowserInfoLogger"}nk(){}init(){y.$Ed()}dispose(){}static main(){z.a.instance.$k(new F)}}Object(u.a)(F,"BrowserInfoLoggerPackage",null,[3,4]);var D=a(65);class I{constructor(ja){this.tOc=ja}Erf(ja){if(!this.tOc)return!0;ja=D.a.upd(ja);if(!ja)return!1;ja=ja.toLowerCase();for(let ia=0;ia<this.tOc.length;ia++)if(ja.endsWith(this.tOc[ia]))return!0;return!1}}Object(u.a)(I,"DomainAllowListManager",null,[]);class H{constructor(ja,ia){this.IX=null;this.f1c=
ja;this.url=ia}get M9d(){return D.a.p4(this.url)}get Zt(){return this.f1c}v6d(){const ja={},ia=this.Zt;ja.a=this.M9d;ja.b=this.round(ia.navigationStart);ja.c=this.round(ia.unloadEventStart);ja.d=this.round(ia.unloadEventEnd);ja.e=this.round(ia.redirectStart);ja.f=this.round(ia.redirectEnd);ja.g=this.round(ia.fetchStart);ja.h=this.round(ia.domainLookupStart);ja.i=this.round(ia.domainLookupEnd);ja.j=this.round(ia.connectStart);ja.k=this.round(ia.connectEnd);ja.l=void 0!==ia.secureConnectionStart&&null!==
ia.secureConnectionStart?this.round(ia.secureConnectionStart):0;ja.m=this.round(ia.requestStart);ja.n=this.round(ia.responseStart);ja.o=this.round(ia.responseEnd);ja.q=this.round(ia.domInteractive);ja.r=this.round(ia.domContentLoadedEventStart);ja.s=this.round(ia.domContentLoadedEventEnd);ja.t=this.round(ia.domComplete);ja.u=this.round(ia.loadEventStart);ja.v=this.round(ia.loadEventEnd);ja.w=this.IX;return ja}round(ja){return Math.round(1E3*ja)/1E3}}Object(u.a)(H,"PerformanceTimingEntry",null,[]);
const N=(ja,ia)=>{var dc,od;const ae={};let Pe=null;switch(ja){case 0:Pe="ResourceTiming";ja=ia.a;null!=ja&&(ae.Url=ja);ja=ia.b;null!=ja&&(ae.InitiatorType=ja);ja=null==ia.c?null:ia.c.toString();null!=ja&&(ae.RedirectStart=ja);ja=null==ia.d?null:ia.d.toString();null!=ja&&(ae.RedirectEnd=ja);ja=null==ia.e?null:ia.e.toString();null!=ja&&(ae.FetchStart=ja);ja=null==ia.f?null:ia.f.toString();null!=ja&&(ae.DomainLookupStart=ja);ja=null==ia.g?null:ia.g.toString();null!=ja&&(ae.DomainLookupEnd=ja);ja=null==
ia.h?null:ia.h.toString();null!=ja&&(ae.ConnectStart=ja);ja=null==ia.i?null:ia.i.toString();null!=ja&&(ae.ConnectEnd=ja);ja=null==ia.j?null:ia.j.toString();null!=ja&&(ae.SecureConnectionStart=ja);ja=null==ia.k?null:ia.k.toString();null!=ja&&(ae.RequestStart=ja);ja=null==ia.l?null:ia.l.toString();null!=ja&&(ae.ResponseStart=ja);ja=null==ia.m?null:ia.m.toString();null!=ja&&(ae.ResponseEnd=ja);ja=ia.n;null!=ja&&(ae.CustomText=ja);ja=null==ia.o?null:ia.o.toString();null!=ja&&(ae.DecodedBodySize=ja);ja=
null==ia.p?null:ia.p.toString();null!=ja&&(ae.EncodedBodySize=ja);ja=null==ia.q?null:ia.q.toString();null!=ja&&(ae.TransferSize=ja);ia=null!==(od=null===(dc=ia.r)||void 0===dc?void 0:dc.toString())&&void 0!==od?od:null;null!=ia&&(ae.responseStatus=ia);break;case 1:Pe="PerformanceTiming",dc=ia.a,null!=dc&&(ae.Url=dc),dc=null==ia.b?null:ia.b.toString(),null!=dc&&(ae.NavigationStart=dc),dc=null==ia.c?null:ia.c.toString(),null!=dc&&(ae.UnloadEventStart=dc),dc=null==ia.d?null:ia.d.toString(),null!=dc&&
(ae.UnloadEventEnd=dc),dc=null==ia.e?null:ia.e.toString(),null!=dc&&(ae.RedirectStart=dc),dc=null==ia.f?null:ia.f.toString(),null!=dc&&(ae.RedirectEnd=dc),dc=null==ia.g?null:ia.g.toString(),null!=dc&&(ae.FetchStart=dc),dc=null==ia.h?null:ia.h.toString(),null!=dc&&(ae.DomainLookupStart=dc),dc=null==ia.i?null:ia.i.toString(),null!=dc&&(ae.DomainLookupEnd=dc),dc=null==ia.j?null:ia.j.toString(),null!=dc&&(ae.ConnectStart=dc),dc=null==ia.k?null:ia.k.toString(),null!=dc&&(ae.ConnectEnd=dc),dc=null==ia.l?
null:ia.l.toString(),null!=dc&&(ae.SecureConnectionStart=dc),dc=null==ia.m?null:ia.m.toString(),null!=dc&&(ae.RequestStart=dc),dc=null==ia.n?null:ia.n.toString(),null!=dc&&(ae.ResponseStart=dc),dc=null==ia.o?null:ia.o.toString(),null!=dc&&(ae.ResponseEnd=dc),dc=null==ia.p?null:ia.p.toString(),null!=dc&&(ae.DomLoading=dc),dc=null==ia.q?null:ia.q.toString(),null!=dc&&(ae.DomInteractive=dc),dc=null==ia.r?null:ia.r.toString(),null!=dc&&(ae.DomContentLoadedEventStart=dc),dc=null==ia.s?null:ia.s.toString(),
null!=dc&&(ae.DomContentLoadedEventEnd=dc),dc=null==ia.t?null:ia.t.toString(),null!=dc&&(ae.DomComplete=dc),dc=null==ia.u?null:ia.u.toString(),null!=dc&&(ae.LoadEventStart=dc),dc=null==ia.v?null:ia.v.toString(),null!=dc&&(ae.LoadEventEnd=dc),ia=ia.w,null!=ia&&(ae.CustomText=ia)}ae.Table=Pe;return Sys.Serialization.JavaScriptSerializer.serialize(ae)};var U=a(50),L=a(176),J=a(328);class P{constructor(ja,ia,dc){this.lj=ja;this.L9d=this;this.TJg=(void 0===ia?null:ia)||(()=>window.location.href);this.sRc=
new I(void 0===dc?null:dc)}vO(){if(P.h1(window.performance))try{const ae=this.TJg();if(P.ESg.exec(ae)&&this.sRc.Erf(ae)){var ja=new H(window.performance.timing,ae);J.a.instance.Rwj(ja.Zt.fetchStart);J.a.instance.Swj(ja.Zt.navigationStart);J.a.instance.CKb(U.a.LYh,"connectStart","requestStart");J.a.instance.CKb(U.a.TYh,"requestStart","responseStart");J.a.instance.CKb(U.a.WYh,"responseStart","responseEnd");this.L9d.Ih(1,ja.v6d());this.lj.Pn(U.a.$ya,ja.Zt.fetchStart);this.lj.Pn(U.a.QYh,ja.Zt.domainLookupStart);
this.lj.Pn(U.a.PYh,ja.Zt.domainLookupEnd);this.lj.Pn(U.a.NYh,ja.Zt.connectStart);this.lj.Pn(U.a.XYh,ja.Zt.secureConnectionStart);this.lj.Pn(U.a.MYh,ja.Zt.connectEnd);this.lj.Pn(U.a.UYh,ja.Zt.requestStart);this.lj.Pn(U.a.vBb,ja.Zt.responseStart);this.lj.Pn(U.a.RYh,ja.Zt.responseEnd-ja.Zt.responseStart);this.lj.Pn(U.a.VYh,ja.Zt.responseStart-ja.Zt.requestStart);var ia=0,dc=0,od=0;(()=>{let Pe=this.Rgk(ae);({transferSize:ia,Ehd:dc,efd:od}=Pe);return Pe})().returnValue&&(this.lj.Pn(U.a.YYh,ia),this.lj.Pn(U.a.OYh,
od),this.lj.Pn(U.a.SYh,dc));this.lj.Pn(U.a.hmd,ja.Zt.navigationStart)}}catch(ae){x.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",ae)}}Rgk(ja){let ia,dc,od;od=dc=ia=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:ia,Ehd:dc,efd:od};ja=window.performance.getEntriesByName(ja,"navigation");if(void 0===ja||null===ja||1!==ja.length)return{returnValue:!1,transferSize:ia,Ehd:dc,efd:od};
ja=ja[0];var ae=ja.transferSize;void 0!==ia&&null!==ia&&(ia=ae);ae=ja.decodedBodySize;void 0!==ae&&null!==ae&&(od=ae);ja=ja.encodedBodySize;void 0!==ja&&null!==ja&&(dc=ja);return{returnValue:!0,transferSize:ia,Ehd:dc,efd:od}}Ih(ja,ia){x.ULS.sendTraceTag(4551815,306,50,N(ja,ia))}static get instance(){return P.La||(P.La=new P(L.a.instance,null,n.AFrameworkApplication.da.na("PerfTimingLoggerFilterDomainsIsEnabled")?n.AFrameworkApplication.da.By("ResourceLoggerDomainAllowList"):null))}static h1(ja){return!(void 0===
ja||null===ja)&&!(void 0===ja.timing||null===ja.timing)}}P.La=null;P.ESg=RegExp("^https?://.*","i");Object(u.a)(P,"PerformanceTimingLogger",null,[448]);var K=a(106),ca=a(143);class T{constructor(ja,ia){this.IX=null;this.f1c=ja;this.behavior=ia;this.url=this.Zt.name}get M9d(){return 2===this.behavior?this.url:D.a.p4(this.url)}get Zt(){return this.f1c}v6d(){const ja={},ia=this.Zt;ja.a=this.M9d;ja.b=ia.initiatorType;ja.c=this.round(ia.redirectStart);ja.d=this.round(ia.redirectEnd);ja.e=this.round(ia.fetchStart);
ja.f=this.round(ia.domainLookupStart);ja.g=this.round(ia.domainLookupEnd);ja.h=this.round(ia.connectStart);ja.i=this.round(ia.connectEnd);ja.j=void 0!==ia.secureConnectionStart&&null!==ia.secureConnectionStart?this.round(ia.secureConnectionStart):0;ja.k=this.round(ia.requestStart);ja.l=this.round(ia.responseStart);ja.m=this.round(ia.responseEnd);ja.o=this.round(T.Kna(ia,"decodedBodySize"));ja.p=this.round(T.Kna(ia,"encodedBodySize"));ja.q=this.round(T.Kna(ia,"transferSize"));ja.n=this.IX;ja.r=T.Kna(ia,
"responseStatus")||0;return ja}round(ja){return Math.round(1E3*ja)/1E3}static Kna(ja,ia){return ja[ia]}}Object(u.a)(T,"ResourceTimingEntry",null,[465]);var Q=a(102),fa=a(147),ha=a(41),Ea=a(112),ra=a(177);class Z{constructor(ja,ia,dc){this.Xce=ja;this.c4b=void 0===ia?null:ia;this.Cta={};this.CGg=void 0===dc?100:dc}fgk(ja){var ia=ja.name.toLowerCase();const dc=D.a.G8(ia);this.x9f(dc,ia)&&(dc in this.Cta?x.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",
dc):(ia={},ia.fetchstart=ja.fetchStart,ia.responseend=ja.responseEnd,ia.iscached=this.Zwf(ja),ia.encodedsize=T.Kna(ja,"encodedBodySize"),ia.decodedsize=T.Kna(ja,"decodedBodySize"),this.Cta[dc]=ia))}ggk(ja){var ia=ja.name.toLowerCase();const dc=D.a.G8(ia);this.AJj(dc,ia)&&(dc in this.Cta?x.ULS.sendTraceTag(508925201,306,50,"AppStaticResourceManager: file downloaded multiple times for filename: {0}",dc):(ia={},ia.fetchstart=ja.fetchStart,ia.responseend=ja.responseEnd,ia.iscached=this.Zwf(ja),ia.encodedsize=
T.Kna(ja,"encodedBodySize"),ia.decodedsize=T.Kna(ja,"decodedBodySize"),ia.it=ja.initiatorType,ia.ress=ja.responseStart,ia.cs=ja.connectStart,ia.ce=ja.connectEnd,ia.dls=ja.domainLookupStart,ia.dle=ja.domainLookupEnd,ia.rs=ja.redirectStart,ia.re=ja.redirectEnd,ia.reqs=ja.requestStart,ia.scs=ja.secureConnectionStart,this.Cta[dc]=ia))}x9f(ja,ia){if(this.Xce)return Array.contains(this.Xce,ja);if(this.c4b)for(ja=D.a.uN(ia),ia=0;ia<this.c4b.length;ia++)if(this.c4b[ia]&&ja.endsWith(this.c4b[ia]))return!0;
return!1}AJj(ja,ia){return this.x9f(ja,ia)?ja.endsWith(".js")||ja.endsWith(".css"):!1}Zwf(ja){try{const ia=T.Kna(ja,"transferSize");if(void 0!==ia&&null!==ia)return!ia;x.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return ja.responseEnd-ja.fetchStart<this.CGg}catch(ia){x.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",ia.message)}return!1}pxj(){if(Ea.a.Fj(this.Cta))x.ULS.sendTraceTag(575931855,
306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var ja=n.AFrameworkApplication.flightId?n.AFrameworkApplication.flightId.split(";"):[],ia=Object.assign(new ra.a,{extendedProperties:fa.a.mu()});ia.extendedProperties.set("Flights",ha.c(ja));this.mUi(ia,this.Cta,Q.Health.instance)}}hnd(ja){let ia=0,dc=0,od=0,ae=0;const Pe=this.Cta;for(const vf in Pe){var Xe=Pe[vf];vf.endsWith(".js")&&(Xe=Object(ca.a)(Object,Xe),Xe.responseend<ja&&(ia+=1,dc+=Xe.decodedsize,ae+=Xe.encodedsize,
od+=Xe.iscached?0:Xe.encodedsize))}ja={};ja.filesLoaded=ia;ja.decodedBytes=dc;ja.transferredBytes=od;ja.encodedBytes=ae;return ja}mUi(ja,ia,dc){if(ia){var od=0,ae=0,Pe=0,Xe=0,vf=0,Sf=0,xf=0,Jg=0,yg=0,Xf=0,Lg=0;for(const Kf in ia){var lg=ia[Kf];try{const Dh=Object(ca.a)(Object,lg);if(!Dh)continue;const hh=Dh.iscached?Boolean.parse(Dh.iscached.toString()):!1,Da=Dh.fetchstart?this.parseFloat(Dh.fetchstart.toString()):0,Lb=(Dh.responseend?this.parseFloat(Dh.responseend.toString()):0)-Da,rc=Dh.encodedsize?
this.parseFloat(Dh.encodedsize.toString()):0,zc=Dh.decodedsize?this.parseFloat(Dh.decodedsize.toString()):0;od+=Lb;Xe+=rc;xf+=zc;Xf++;hh?(Pe+=Lb,Sf+=rc,yg+=zc,Lg++):(ae+=Lb,vf+=rc,Jg+=zc)}catch(Dh){x.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Dh.message)}}ja.extendedProperties.set("StaticResources",ha.c(ia));ja.extendedProperties.set("TotalResourceDownloadLatency",od.toString());ja.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",
ae.toString());ja.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",Pe.toString());ja.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",Xe.toString());ja.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",vf.toString());ja.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Sf.toString());ja.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",xf.toString());ja.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Jg.toString());
ja.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",yg.toString());ja.extendedProperties.set("TotalNumberOfResourcesDownloaded",Xf.toString());ja.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Lg.toString());dc.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);dc.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",ja)}}parseFloat(ja){if(!ja)return 0;ja=parseFloat(ja);return isNaN(ja)?0:ja}}Object(u.a)(Z,"AppStaticResourceManager",
null,[]);class wa extends Sys.EventArgs{constructor(ja){super();this.entries=ja}}Object(u.a)(wa,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var la=a(114);class ta{constructor(ja,ia,dc,od,ae,Pe){dc=void 0===dc?null:dc;od=void 0===od?null:od;ae=void 0===ae?100:ae;Pe=void 0===Pe?!1:Pe;this.AVc=!1;this.tl=null;this.inb=0;this.$b=new K.a;this.YGa=null;this.tS=!1;this.pve=0;this.Bg=ja;this.Xfe=0;this.L9d=this;this.sRc=new I(dc);this.iy=ia;od&&(this.YGa=new Z(null,od,ae));this.iFg=Pe}get zHe(){try{return!(void 0===
this.iy||null===this.iy)&&!(void 0===this.iy.getEntriesByType||null===this.iy.getEntriesByType)}catch(ja){return x.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",ja),!1}}get Fxh(){return this.Xfe}get isActive(){return this.tS}get k6d(){return this.pve}HZg(ja){this.$b.addHandler(ta.fid,ja)}cDj(ja){this.$b.removeHandler(ta.fid,ja)}nk(ja,ia){const dc=this.k6d!==ja;this.pve=ja;this.isActive&&this.Bg&&dc&&(this.Rr(),this.Xh());this.Xfe=
ia}activate(){!this.isActive&&this.zHe&&(this.Xh(),this.tS=!0)}deactivate(ja){this.isActive&&(this.Rr(),ja&&this.flush(),this.tS=!1)}flush(){if(this.isActive&&this.zHe)try{var ja=window.performance.getEntriesByType("resource");0<ja.length-this.inb&&x.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",ja.length-this.inb);const ia=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);
ia&&(window.performance.clearResourceTimings(),this.inb=0);const dc=[];for(let od=this.inb;od<ja.length;od++)this.sRc.Erf(ja[od].name)&&(this.YGa&&(this.iFg?this.YGa.ggk(ja[od]):this.YGa.fgk(ja[od])),dc.push(new T(ja[od],this.Fxh)));ia||(this.inb=ja.length);this.$b.raiseEvent(ta.fid,new wa(dc));for(ja=0;ja<dc.length;ja++)0!==dc[ja].behavior&&2!==dc[ja].behavior||this.L9d.Ih(0,dc[ja].v6d());0<dc.length&&x.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",
dc.length)}catch(ia){x.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",ia)}}Ih(ja,ia){x.ULS.sendTraceTag(4310804,306,50,N(ja,ia))}Qwj(){this.YGa.pxj()}hnd(ja){return this.YGa.hnd(ja)}Xh(){this.Bg&&0<this.k6d&&(this.tl=new la.a(3,2,1E3*this.k6d,()=>{this.flush()},5),this.Bg.Xh(this.tl),this.AVc=!0)}Rr(){this.AVc&&(this.Bg.Rr(this.tl),this.tl=null,this.AVc=!1)}}ta.fid="EntriesAvailable";Object(u.a)(ta,"ResourceTimingLogger",null,[424,448]);var Ca=a(126);class Ga{constructor(){this.Fd=
null}get name(){return"Common.ResourceTiming"}init(){this.Fd.resolve("Common.NetworkTiming.IResourceTimingLogger");P.instance.vO()}dispose(){}nk(ja){this.Fd=ja;let ia=null;if(n.AFrameworkApplication.da.na("ResourceLoggerFilterDomainsIsEnabled"))try{ia=n.AFrameworkApplication.da.By("ResourceLoggerDomainAllowList")}catch(Pe){x.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const dc=[];dc.push(D.a.uN(Ca.a.XL).toLowerCase());dc.push(D.a.uN(Ca.a.bjb).toLowerCase());
const od=n.AFrameworkApplication.da.eg("AppStaticResourceMonitorCacheThresholdInMs",100),ae=n.AFrameworkApplication.da.na("PPTAggregateResourceTimingV2Enabled");ja.register(424,"Common.NetworkTiming.IResourceTimingLogger").Ve().$e(()=>new ta(n.AFrameworkApplication.Pj,window.performance,ia,dc,od,ae))}static main(){z.a.instance.$k(new Ga)}}Object(u.a)(Ga,"ResourceTimingPackage",null,[3,4]);var Oa=a(125);class eb extends Sys.EventArgs{constructor(ja,ia){super();this.Cbk=ja;this.actualValue=ia}}Object(u.a)(eb,
"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var nb=a(116);class $a{constructor(){this.r_a=[];this.vfe=this.LQc=0;this.Yia=null;this.$b=new K.a;this.Goh=(ja,ia)=>{nb.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.Fqh(ia.Cbk,ia.actualValue))}}init(ja,ia,dc){this.Yia=ja;this.LQc=ia;this.vfe=dc;this.Yia.PAe(Object(Oa.a)(this,this.x7i,"onCpuMeterFrameAvailable"));this.b0g(this.Goh)}x7i(ja,ia){ia.PHf&&(Array.enqueue(this.r_a,ia.PHf.CP),this.r_a.length>this.vfe&&
(Array.dequeue(this.r_a),this.wgh()))}wgh(){var ja=this.r_a.length;let ia=0;for(let dc=0;dc<ja;dc++){const od=Array.dequeue(this.r_a);ia+=od;Array.enqueue(this.r_a,od)}ja=ia/ja;ja>this.LQc&&this.$b.raiseEvent("CPTTE",new eb(this.LQc,ja))}b0g(ja){this.$b.addHandler("CPTTE",ja)}Fqh(ja,ia){const dc={};dc.ThresholdValue=ja;dc.ActualValue=ia;return dc}}Object(u.a)($a,"CpuMeterMonitor",null,[507]);var oa=a(180);class Fa{constructor(){this.S=this.T=this.M=this.C=0}}Object(u.a)(Fa,"ProfileInformation",null,
[]);var X=a(15),va=a(47),xa=a(267);class Pa{constructor(ja,ia){this.ZTc=!1;this.bIa={};this.m1b=void 0===ja?0:ja;this.w1b=void 0===ia?0:ia;this.v1c=0;va.a.addHandler(window.self,X.a.I2g,()=>{this.ZTc=!0});va.a.addHandler(window.self,X.a.J2g,()=>{this.ZTc=!1})}iCe(ja,ia,dc){const od=Pa.generateKey(ia,dc);od in this.bIa?ia=this.bIa[od]:(ia=new Fa,ia.S=dc?1:0,this.bIa[od]=ia,this.v1c++);ia.C++;ia.M=ja>ia.M?ja:ia.M;ia.T+=ja}Mca(ja,ia){this.iCe(ja,ia,!1);this.ZTc&&this.iCe(ja,ia,!0)}getData(){if(0<this.w1b&&
this.v1c>this.w1b)return this.S5h();const ja=0<this.m1b,ia={},dc=this.bIa;for(const ae in dc){var od=ae;const Pe=dc[ae];this.J$f(Pe);ja&&Pe.T>=this.m1b&&(ia[od]=Pe)}return ja?Ea.a.Fj(ia)?null:ia:this.bIa}S5h(){var ja=0<this.m1b,ia=[];const dc=this.bIa;for(const od in dc){const ae={key:od,value:dc[od]},Pe=ae.value;(!ja||Pe.T>=this.m1b)&&Array.add(ia,ae)}if(ia.length>this.w1b)ia.sort((od,ae)=>ae.value.T-od.value.T),ia=ia.slice(0,this.w1b);else if(!ia.length)return null;ja={};for(const od of ia)ia=od.value,
this.J$f(ia),ja[od.key]=ia;return ja}J$f(ja){ja.M=xa.a.kaa(ja.M,0);ja.T=xa.a.kaa(ja.T,0)}reset(){this.bIa={};this.v1c=0}static generateKey(ja,ia){return ia?ja+" [it]":ja}}Object(u.a)(Pa,"FunctionCallAggregator",null,[450]);class Ka{}Ka.d8g="BatchedOperation";Ka.CGj="Replication";Ka.whk="25";Ka.DGj="9_"+Ka.d8g+"_"+Ka.CGj;Object(u.a)(Ka,"CpuMeterConstants",null,[]);class Bb{}Object(u.a)(Bb,"CpuMeterFrame",null,[]);class xb extends Sys.EventArgs{constructor(ja){super();this.PHf=ja}}Object(u.a)(xb,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);class Ua{}Object(u.a)(Ua,"MiniTaskItemInfo",null,[]);class Jb{}Object(u.a)(Jb,"TaskItemInfo",null,[]);var fc=a(566),ya=a(108);class ob{static Eli(){if(!ob.mYb&&(ob.mYb=new ya.a,n.AFrameworkApplication.da&&n.AFrameworkApplication.da.As("AggregatorIdDisabledList"))){const ja=n.AFrameworkApplication.da.By("AggregatorIdDisabledList");for(let ia=0;ia<ja.length;ia++)ob.mYb.fa(ja[ia],!0)}return ob.mYb}}ob.mYb=null;Object(u.a)(ob,"DisabledAggregatorListStore",null,[]);var Sb=a(271);class Ba{constructor(ja,
ia,dc,od,ae,Pe,Xe){Pe=void 0===Pe?!0:Pe;Xe=void 0===Xe?null:Xe;this.d0=this.Fue=this.Nle=!1;this.Bg=null;if(!ja)throw Sb.a.argument("taskManagerLazy");if(!ae)throw Sb.a.argument("dataAggregator");this.TRg=ja;this.WXc=ia;this._id=dc;this.bke=6E4*od;this.CZb=ae;this.Ore=Pe;this.frb=Xe;ob.Eli().Hd(this._id.toString())&&(this.d0=!0)}get SG(){return this.Bg||(this.Bg=this.TRg.value)}track(ja,ia){ia=void 0===ia?null:ia;this.d0||(this.JHh(),this.oNj(),this.CZb.Mca(ja,ia))}oNj(){!this.Nle&&0<this.bke&&(this.Nle=
!0,this.Bbg())}Bbg(){const ja=new la.a(5,1,this.bke,()=>{this.qPj()},19,this._id.toString());this.SG.Xh(ja)}qPj(){!this.frb||this.frb.AZj()?this.Fcg():this.Ore&&this.CZb.reset();this.Bbg()}Fcg(){const ja=this.CZb.getData();if(ja){const ia=parseInt(String(ja.length));if(isNaN(ia)||0<ia)this.FEc(ja),this.Ore&&this.CZb.reset()}}FEc(ja){x.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:ja})}JHh(){this.Fue||(this.WXc(()=>{this.Fcg()}),this.Fue=!0)}static cQ(ja,ia,
dc,od,ae){return new Ba(new fc.a(()=>n.AFrameworkApplication.Pj),n.AFrameworkApplication.Xjb,ja,ia,dc,od,ae)}static Q8a(ja,ia,dc){return Ba.cQ(ja,ia,dc,!0,null)}}Object(u.a)(Ba,"Aggregator",null,[505]);class Ia{constructor(ja){ja=void 0===ja?null:ja;this.qp=null;this.reset();this.frb=ja}Mca(ja,ia){if(!this.frb||this.frb.AZj())ia in this.qp||(this.qp[ia]=[]),this.qp[ia].push(ja)}getData(){return Ea.a.count(this.qp)?this.qp:null}reset(){this.qp={}}}Object(u.a)(Ia,"NamedValuesAggregator",null,[450]);
var cb=a(224);class Kb{constructor(ja,ia,dc,od,ae){this.xJa=0;this.kH=null;this.j3b=this.pue=0;this.Dse=!1;this.S_a=0;this.Zob=!1;this.eva=null;this.l0b=0;this.vpe=new K.a;this.RRg=[];this.dP=ja;this.QWc=ia;this.NSc=dc;this.Fne=od;n.AFrameworkApplication.da&&n.AFrameworkApplication.da.na("WrapSetTimeoutForTelemetryIsEnabled")&&this.SCd();this.$Ig=ae;this.OSc=new Pa(100);this.ZMg=Ba.Q8a(1,5,new Ia)}PAe(ja){this.vpe.addHandler("OnCpuMeterFrameAvailable",ja)}mgb(ja,ia,dc,od){dc=(od=void 0===od?null:
od)?od.priority:7;const ae=this.dP();this.start(ia,dc);try{ja()}finally{this.stop(ia,od),ja=this.dP()-ae,this.Fne.track(ja,ia)}}IZ(ja,ia){const dc=this.dP();try{ja()}finally{ja=this.dP()-dc,this.NSc.Mca(ja,ia),0<this.xJa&&this.OSc.Mca(ja,ia),this.Fne.track(ja,ia)}}NMd(ja){const ia=new Jb;ia.TN=ja.Btc;ia.TP=ja.priority;this.b1f(1,ia)}ydb(ja){this.l0b|=ja}start(ja,ia){if(!this.xJa){this.OSc.reset();const dc=this.mxf(ja);dc&&this.UGd(1);this.kH=new Jb;this.kH.TN=ja;this.kH.TP=ia;this.kH.ST=(new Date).toISOString();
this.kH.STS=xa.a.kaa(this.dP(),2);dc?this.kH.UI=1:this.pIi(ja)?this.kH.UI=2:this.kH.UI=0}this.xJa++}UGd(ja){this.S_a|=ja}H$c(ja,ia){this.S_a=void 0===ja||ja?0:this.S_a&~(void 0===ia?0:ia)}stop(ja,ia){ia=void 0===ia?null:ia;let dc;this.xJa--;0>=this.xJa&&this.kH&&(dc=this.dP()-this.kH.STS,this.j3b+=dc,this.QWc.Mca(dc,ja),this.mxf(ja)&&this.H$c(!1,1),this.kH.TRT=xa.a.kaa(dc,2),ia&&(this.kH.TQT=xa.a.kaa(ia.jtj,2),this.kH.TDT=xa.a.kaa(ia.Gyf,2)),this.$Ig&&(this.b1f(0,this.kH),this.oHj()),this.xJa=0);
0<=ja.indexOf(Ka.whk)&&this.ydb(2);0<=ja.indexOf(Ka.DGj)&&this.ydb(4);1===(this.S_a&1)&&this.ydb(1);2===(this.S_a&2)&&this.ydb(8)}oHj(){var ja=this.kH.TRT;if(750<ja){let dc=this.OSc.getData();if(dc){const od={};for(const ae in dc){var ia=dc[ae];const Pe=ae;Pe.startsWith("SiOp_")||Pe.endsWith("[it]")||(od[Pe]=Math.round(100*ia.T/ja))}dc=od}ja=Object.assign(new Ua,{B:this.kH.STS,T:ja,S:dc});this.ZMg.track(ja,this.kH.TN)}}A6j(){var ja=this.dP()-this.pue,ia=xa.a.kaa(this.j3b/ja*100,2);ja=new Bb;ja.CP=
ia;ja.II=this.l0b;ia=this.QWc.getData();Ea.a.count(ia)&&(ja.LRT=ia);ia=this.NSc.getData();Ea.a.count(ia)&&(ja.FP=ia);this.vpe.raiseEvent("OnCpuMeterFrameAvailable",new xb(ja));this.kmg()}kmg(){this.QWc.reset();this.NSc.reset();this.j3b=this.xJa=0;this.pue=this.dP();this.l0b=0;this.kH=null}vO(){this.Dse?this.A6j():(this.kmg(),this.Dse=!0);this.eva?this.eva(Object(Oa.a)(this,this.vO,"run"),1E3):window.setTimeout(Object(Oa.a)(this,this.vO,"run"),1E3)}b1f(ja,ia){ja=this.RRg[ja];if(!cb.a.Fj(ja))for(let od=
0;od<ja.length;od++){var dc=ja[od];const ae=dc[0];dc=dc[1];ae&&!ae(ia)||dc(ia)}}SCd(){if(!this.Zob){const ja=window.setTimeout;this.eva=(ia,dc)=>ja(ia,dc);this.Zob=!0}}mxf(ja){return ja.startsWith("key")||ja.startsWith("input")}pIi(ja){return ja.startsWith("click")||ja.startsWith("mouse")||ja.startsWith("pointer")}}Object(u.a)(Kb,"CpuMeter",null,[94]);class db{constructor(ja){this.gnb=null;this.Ym=new oa.a;this.dP=ja}initialize(ja,ia,dc,od){this.gnb||(this.gnb=new Kb(this.dP,ja,ia,dc,void 0===od?
!1:od),this.Ym.setResult(this.gnb));return this.gnb}}Object(u.a)(db,"CpuMeterProvider",null,[506]);class gb{constructor(ja){this.vA=[];this.KZb=[];this._count=void 0===ja?1:ja}wVh(){let ja=0;for(let ia=0;ia<this.vA.length;ia++)this.vA[ia]<this.vA[ja]&&(ja=ia);return ja}Mca(ja,ia){ja=xa.a.kaa(ja,2);if(this.vA.length<this._count)Array.add(this.vA,ja),Array.add(this.KZb,ia);else{var dc=this.wVh();ja>this.vA[dc]&&(this.vA[dc]=ja,this.KZb[dc]=ia)}}getData(){return this.vA.length?{["Vals"]:this.vA,["Desc"]:this.KZb}:
null}reset(){this.vA=[];this.KZb=[]}}Object(u.a)(gb,"MaxDataAggregator",null,[450]);var yb=a(39),Nb=a(81);class qc{get name(){return"Common.App.CpuMeter"}nk(ja){ja.register(db,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").Ve().$e(()=>new db(yb.a.lg));ja.register($a,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").Ve().$e(()=>new $a)}init(){const ja=n.AFrameworkApplication.da;if(ja.na("CpuMeterIsEnabled")){const ia=Nb.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");
J.a.instance.hDe.continueWith(()=>{qc.fxi(ja,ia)})}}dispose(){}static fxi(ja,ia){const dc=Ba.Q8a(10,5,new Pa(ja.eg("TaskManagerLoggingThreshold",0),ja.eg("CpuMeterMaximumEntriesToLog",0)));ia=ia.initialize(new gb(5),new Pa,dc,ja.na("CPUMeterExposeTaskDetailsIsEnabled"));ja.na("WordEditorInteractivePerfDisableCpuMeterFrames")||(ia.vO(),ja.na("CpuMeterMonitorIsEnabled")&&Nb.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(ia,ja.z8("CpuMeterAverageCpuPercentThreshold",80),ja.eg("CpuMeterRollingAverageFramesCount",
15)));nb.a(16827671,306,50,"Initializing CpuMeter")}static main(){z.a.instance.$k(new qc)}}Object(u.a)(qc,"CpuMeterPackage",null,[3,4]);var Gb=a(993);class hb{get name(){return"Common.App.EventsCachePackage"}nk(){}init(){Gb.a.instance.init()}dispose(){}static main(){z.a.instance.$k(new hb)}}Object(u.a)(hb,"EventsCachePackage",null,[3,4]);var qb=a(9),ab=a(233),Mb=a(901),Ib=a(157),fb=a(387),Db=a(216),Za=a(238),sb=a(59),sa=a(91),ba=a(1),ua=a(22),R=a(164),Y=a(766);class La extends Mb.a{constructor(ja,
ia,dc){super(ia,dc);this.Xa=new K.a;this.qti=od=>{if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){const ae=od.Values.m_Origin;n.AFrameworkApplication.wopiHostOriginFromPostMessage||(n.AFrameworkApplication.wopiHostOriginFromPostMessage=ae)}switch(od.MessageId){case Ib.a.Tud:R.a(this.$).xjf(od);break;case Ib.a.FEd:Za.a.ltas(null);break;case Ib.a.Gmc:this.hbj();break;case Ib.a.Xud:this.gbj(od)}};this.$=ja;dc!==Y.a.FM&&this.KS(dc);this.tyi();this.Cxi();ja=this.qti;this.tm(Ib.a.Tud,
ja);this.tm(Ib.a.FEd,ja);this.tm(Ib.a.Gmc,ja);this.tm(Ib.a.Xud,ja)}dispose(){this.$=null;super.dispose()}tyi(){this.yn(Ib.a.dJe);this.yn(Ib.a.Tud);this.yn(Ib.a.Gmc);this.yn(Ib.a.Xud);this.G2a(Ib.a.FEd);this.yn(Ib.a.Wud)}Cxi(){this.JS(Ib.a.usb);this.JS(Ib.a.S1);this.JS("App_CloseTab");this.JS(Ib.a.wZa);this.JS(Ib.a.xZa);this.JS(Ib.a.tmf);this.JS(Ib.a.Dmc);this.JS("App_ModifyURLState")}hbj(){const ja={};ja.hostMessageReceived=(new Date).getTime();x.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");
n.AFrameworkApplication.Xqc=!0;ja.appUnloadStart=(new Date).getTime();ja.sendBeaconFlight=n.AFrameworkApplication.da.na("SendBeaconOnShuttingDownRequestsEnabled");ja.sendBeaconSupported=sb.a.Iha();sb.a.rDe();ja.appUnloadEnd=(new Date).getTime();ja.appMessageSent=(new Date).getTime();this.sendMessage(Ib.a.d4g,ja)}gbj(ja){x.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");ja.Values&&fb.a.OId in ja.Values&&ua.a.equals(ja.Values[fb.a.OId],Db.a.edit,!0)&&!this.$.isEditMode&&(x.ULS.sendTraceTag(537162881,
0,50,`EwaHostMessenger.OnHostSwitchMode: Switching to ${ja.Values[fb.a.OId]}`),ja=new sa.a(-8805455,0,1,0,null),this.$.Ga.Sd(ja))}}Object(u.a)(La,"EwaHostMessenger",Mb.a,[447,241,5]);class Ma extends ab.a{constructor(ja){super();this.hOe=!1;this.$=ja;this.Oe()}create(){const ja=this.$.ia,ia=Nb.a.instance;if(!this.hOe){this.hOe=!0;let dc;dc=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.xa.DocumentHostInfo.PostMessageOrigin||Y.a.FM:n.AFrameworkApplication.cPd||
Y.a.FM;ia.register(La,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").Ve().$e(()=>new La(this.$,window.parent,dc,n.AFrameworkApplication.da.na("HostSendReadyToAcceptPostMessage")))}this.ve(ja.Ja(21)||ja.Va(21,ia.resolve("Postmessage.IHostPostmessenger")))}}Object(u.a)(Ma,"HostMessengerFactory",ab.a,[]);var lb=a(119),pb=a(178),Vb=a(713),Wa=a(382),ka=a(82),Sa=a(145),Xb=a(48),Mc=a(283),jc=a(331),$c=a(330),Jd=a(439),fd=a(6),Kd=a(55),Yd=a(76);class te{constructor(ja,
ia,dc){this.correlations=this.properties=this.operation=null;this.operation=ja;this.properties=ia;this.correlations=dc}static XSh(ja,ia,dc){const od={},ae=Kd.b();switch(ja.command){case -1537138325:od.Action=ia.LabelText;break;case -1104934572:od.PrevTab=ae.Tl(parseInt(ia.OldContextCommand,10));od.NextTab=ae.Tl(parseInt(ia.NewContextCommand,10));break;case 802602464:od.Origin=ia[fd.a.aI];break;case -1027730316:case -1059615499:od.MenuType=ia.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:"SqmControlId"in
ia&&(od.SqmControlId=ia.SqmControlId);break;case 1371713064:case 875133075:Yd.a.qf in ia&&(od.SampleTableId=ia[Yd.a.qf])}od.InputMethod=jc.a[ja.method];od.Location=$c.a[ja.hh];od.Mode=Jd.a[ja.mode];od.ParentName=ja.tabName;od.IsSystemInitiated="IsSystemInitiated"in ia?ia.IsSystemInitiated:!1;od.NoReporting="NoReporting"in ia?ia.NoReporting:!1;"ControlIdToLog"in ia&&(od.ControlId=ia.ControlIdToLog);"TerminalParentControlIdToLog"in ia&&(od.TerminalParentControlId=ia.TerminalParentControlIdToLog);for(const Pe of Object.keys(dc))od[Pe]=
dc[Pe];return od}}Object(u.a)(te,"InteractivityRecord",null,[]);class ve extends te{constructor(ja,ia,dc){super(ja.operation,ja.properties,ja.correlations);this.timeFromNavigationStart=this.timeFromAppInteractive=0;this.timeFromAppInteractive=ia;this.timeFromNavigationStart=dc}}Object(u.a)(ve,"FirstUserInteractivityRecord",te,[]);var qe=a(664);class pc{constructor(){this.commandSurface=this.triggerMethod=lb.a.clb}static txi(){pc.f8a||(pc.f8a=new qe.a(Wa.a.Ei()),pc.f8a.add("InputMethod"),pc.f8a.add("Location"),
pc.f8a.add("Mode"))}}pc.f8a=null;Object(u.a)(pc,"ExcelUserAction",null,[]);var nd=a(225),qd=a(53),tb=a(438),Dc=a(155),Tc=a(142),ub=a(13),Pb=a(105);class ee extends ka.a{constructor(ja){super();this.fpf=0;this.l6e=!1;this.pDd=Array(ee.Cdb);this.tcc=0;this.$=ja;this.Mwf=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");lb.a.odi();this.ifa={};ee.k5b||(ee.k5b=new Vb.a(Wa.a.Ei()),ee.Bwi(ee.k5b));pc.txi();if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(ja=
0;ja<ee.Cdb;ja++)this.pDd[ja]="NA"}dispose(){this.$=this.ifa=null;super.dispose()}A7f(ja,ia,dc){const od=Kd.b().Tl(ja.command),ae=JSON.stringify(ja);od||x.ULS.sendTraceTag(537155555,3,50,`InteractivityLogger.ReportCommand: command name is null or empty. commandName: ${od}, command: ${ja.command}, commandInfo: ${ae}`);ia=te.XSh(ja,ia,dc);dc=!!ia&&(!("IsSystemInitiated"in ia)||!ia.IsSystemInitiated);this.$&&this.$.ea.Gh&&dc&&Gb.a.instance.v2f("OtelUserAction",new tb.a(od,ja.tabName,Date.now()));this.O7f(od,
ia,null,!0,!0)}Lf(ja,ia,dc,od){this.O7f(ja,ia,void 0===dc?null:dc,!1,void 0===od?!1:od)}THc(ja){if(this.ifa){++this.fpf;this.ifa[ja]||(this.ifa[ja]=[]);var ia=this.fpf.toString();this.ifa[ja].push(ia);x.ULS.sendTraceTag(537155553,0,50,`StartInteractivityCorrellation - '${ja}', correlation=${ia}`)}else x.ULS.shipAssertTag(537155554,0,!1,`StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${ja}] == null`)}gIc(ja){if(this.ifa&&this.ifa[ja]){var ia=this.ifa[ja],
dc=ia.pop().toString();ia.length||delete this.ifa[ja];x.ULS.sendTraceTag(537155551,0,50,`StopInteractivityCorrellation - '${ja}', correlation=${dc}`)}else x.ULS.shipAssertTag(537155552,0,!1,`StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[${ja}] == null`)}vT(ja,ia,dc){dc=void 0===dc?!1:dc;return Mc.b(od=>{this.Lf(ja,od(),void 0,dc)},ee.Ebk,this.ma,Xb.a.rAi,!1,!ia)}qVd(){let ja="";for(let ia=0;ia<ee.Cdb;ia++)ja+=this.pDd[(this.tcc+ee.Cdb-ia-1)%ee.Cdb]+
",";x.ULS.sendTraceTag(557188890,0,15,`Last operations ${ja}`)}Llk(ja){ja&&(this.pDd[this.tcc]=ja,this.tcc=(this.tcc+1)%ee.Cdb)}jUi(ja,ia,dc){n.AFrameworkApplication.dfc();const od=ja.operation,ae=ja.properties;void 0!==dc?void Tc.a.resolve(ub.rc,{Oa:0}).then(Pe=>{Pe.rxj(od,ae,dc)}):this.Ghk(ja);this.Hhk(ja);this.Ljj(ia,ae,od)}Ghk(ja){this.E5j(ja)||(this.l6e=!0,ja=new ve(ja,qd.a.instance.Gea(new Date),Object(Pb.b)()),ja=Sys.Serialization.JavaScriptSerializer.serialize(ja),x.ULS.sendTraceTag(458261331,
0,50,`${ja}`))}E5j(ja){const ia=ja.properties;ja=ja.operation;return this.l6e||void 0===ja||null===ja||ja===Sa.a.K2c||ja===Sa.a.SYd||ja===Sa.a.EPd||sb.a.BAd(ja)||!!ia&&"IsSystemInitiated"in ia&&ia.IsSystemInitiated}Hhk(ja){ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.Llk(ja.operation);ja=Sys.Serialization.JavaScriptSerializer.serialize(ja);x.ULS.sendTraceTag(21542793,0,50,`${ja}`)}Ljj(ja,ia,dc){lb.a.gpa()&&(ia?"NoReporting"in ia&&ia.NoReporting||"IsSystemInitiated"in
ia&&ia.IsSystemInitiated||!ja&&!this.Mwf||((ja=lb.a.Kl(ia,ee.k5b,pc.f8a))?(ia=ee.fTh(ia))?pb.a.sendUserActionEvent(lb.a.acc(dc,null,ia.triggerMethod,ia.commandSurface,ja)):x.ULS.sendTraceTag(537155550,0,50,"user action was null"):x.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):x.ULS.sendTraceTag(537155548,0,50,`Not logging action telemetry because adction data was null, actionName: ${dc}`))}O7f(ja,ia,dc,od,ae){const Pe=nd.a(this.$);if(this.Mwf){let vf=null;ua.a.equals(ja,
Sa.a.sEc,!0)&&ia&&"InputMethod"in ia&&(vf=Sa.a.r7e(ja,ia.InputMethod));Pe.FQb(vf||ja,dc)}else ua.a.equals(ja,Sa.a.sEc,!0)&&ia&&"InputMethod"in ia&&(ja=Sa.a.r7e(ja,ia.InputMethod)),Pe.FQb(ja,dc);ia&&(ia.IsCommand=od);let Xe="ActionRelativeTime"in ia?ia.ActionRelativeTime:Object(Pb.b)();Object(Dc.c)(()=>{const vf=new te(ja,ia,this.ifa);this.jUi(vf,ae,Xe)},this.$.ma,50)}static fTh(ja){if(!ja)return null;const ia=new pc;"InputMethod"in ja&&(ia.triggerMethod=ja.InputMethod);"Location"in ja&&(ia.commandSurface=
ja.Location);return ia}static Bwi(ja){ja?(ja.add("Origin",2),ja.add("InputMethod",2),ja.add("ButtonType",2),ja.add("selectedRange",2),ja.add("SelectedRanges",2),ja.add("editRange",2),ja.add("Location",2),ja.add("Mode",2),ja.add("CurrentSelectionMode",2),ja.add("Action",2),ja.add("type",2),ja.add("floatingObjectType",2),ja.add("PrevTab",2),ja.add("NextTab",2),ja.add("DialogName",2),ja.add("dx",3),ja.add("dy",3),ja.add("NumberOfSelectedRanges",3),ja.add("IsCommand",1),ja.add("IsInFormulaBarEdit",1),
ja.add("isLink",1),ja.add("isSheetRef",1),ja.add("isEmptyText",1),ja.add("isFormula",1),ja.add("IsResizingHiddenHeader",1)):x.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")}}ee.Ebk=1E3;ee.Cdb=40;ee.k5b=null;Object(u.a)(ee,"InteractivityLogger",ka.a,[15]);var Ad=a(2);class Ub{constructor(){this.appInfoProperties=this.appState=null}}Object(u.a)(Ub,"CurrentAppInfo",null,[]);const tc=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit cell_text_active_cell_selection_change_entire_row_end_edit formulaBar_active_cell_selection_change_entire_row_end_edit cell_text_active_cell_selection_change_entire_column_end_edit formulaBar_active_cell_selection_change_entire_column_end_edit cell_text_active_cell_selection_change_right_click_end_edit formulaBar_active_cell_selection_change_right_click_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set("cell_text_active_cell_selection_change_entire_row formulaBar_active_cell_selection_change_entire_row cell_text_active_cell_selection_change_entire_column formulaBar_active_cell_selection_change_entire_column cell_text_active_cell_selection_change_right_click formulaBar_active_cell_selection_change_right_click cell_text_active_cell_selection_change formulaBar_active_cell_selection_change".split(" "))},{name:"headers",actions:new Set(["header_resize_start",
"header_resize_autofit"])}].forEach(ja=>{ja.actions.forEach(ia=>{tc.set(ia,ja.name)})});class yc{constructor(){this.value=this.key=null}}Object(u.a)(yc,"AppInfoProperty",null,[]);class Sd{constructor(ja){this.$=ja}getAppState(){const ja=qd.a.instance.Gea(new Date);return-1===ja?"boot":3E4>ja?"postboot":"steady"}isChangeGateEnabled(ja){return ba.EwaSettings.isChangeGateEnabled(ja)}getBooleanFeatureGate(ja,ia){return ba.EwaSettings.getBooleanFeatureGate(ja,ia)}getCurrentAppInfo(){return Object(Ad.a)(new Ub,
{appState:this.getAppState(),appInfoProperties:[Object(Ad.a)(new yc,{key:"coauthCount",value:this.$.ea.gp.length.toString()})]})}sendBeaconTraceTag(ja,ia,dc,od){this.$.sendBeaconTraceTag(ja,ia,dc,od)}getActionBucket(ja){return b(ja)}getAppInfoForReport(){return`${"maxCoauthCount"}: ${this.$.ea.iZi}`}logSlowActionsHandler(){return""}}Object(u.a)(Sd,"InteractivityTrackerCallbacks",null,[406]);class Fd{constructor(){this.events=null;this.durationThresholdInMs=0;this.animationTracking=this.periodicReport=
this.patchTaskScheduling=this.callbacks=null}}Object(u.a)(Fd,"InteractivityTrackerOptions",null,[]);const se=(ja,ia)=>Ko(function*(){return Tc.a.resolve(ub.ab,ia).then(dc=>dc("interactivity"))});Object(Tc.b)(ub.Tb,{nr:"singleton"})(ja=>Ko(function*(){const ia=yield Tc.a.resolve(ub.fb,ja);yield se(ia,ja);const dc=interactivity.InteractivityTrackerFactoryGlobal.create();return new uc(ia,dc)}));class uc{constructor(ja,ia){this.U2=void 0===ia?null:ia;uc.ttf?x.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization."):
(this.initialize(ja),uc.ttf=!0)}initialize(ja){x.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8082961_TrackerAndProfilerServicesWithNewInfra")||(this.U2=interactivity.InteractivityTrackerFactoryGlobal.create());if(this.U2){var ia=new Fd;ba.EwaSettings.aCd()&&uc.EIc.push(X.a.gda);ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7457630_addSupportedEventMouseUpAndTouchStart")&&(uc.EIc.push("mouseup"),uc.EIc.push("touchstart"));
ia.events=uc.EIc;ia.durationThresholdInMs=uc.durationThresholdInMs;ia.callbacks=new Sd(ja);ia.patchTaskScheduling=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);ja=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReport",!1);const dc=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PeriodicReportPassiveTest",!1),od=ba.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.PeriodicReportIntervalMs",6E4);if(ja||dc)ia.periodicReport=
{isPassiveTestEnabled:dc,intervalMs:od};ia=this.U2.start(ia);ia.started?x.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):x.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+ia.failureReason)}else x.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")}OFa(ja,ia,dc){if(this.U2)return this.U2.track(ja,ia,dc);x.ULS.sendTraceTag(524326924,0,50,`InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: ${ia}`)}wSe(){return this.U2?
this.U2.createActionsRetriever():(x.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)}dispose(){this.U2&&(this.U2.stop(),this.U2=null)}addContext(ja,ia,dc){this.U2?this.U2.addContext(ja,ia,dc):x.ULS.sendTraceTag(509445952,0,15,"InteractivityTrackerService.addContext: interactivityTracker not initialized.")}}uc.durationThresholdInMs=100;uc.EIc="click mousedown contextmenu keypress keydown dblclick touchend".split(" ");
uc.ttf=!1;Object(u.a)(uc,"InteractivityTrackerService",null,[306]);var Ra=a(740);class vb extends ab.a{constructor(ja){super();this.$=ja;this.Oe()}create(){ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?void Tc.a.resolve(ub.ab,{Oa:this.$a}).then(ja=>ja("interactivity")).then(()=>{Object(Ra.a)(this.$.ia,443,()=>new uc(this.$))}):this.ve(Object(Ra.a)(this.$.ia,443,()=>new uc(this.$)))}static la(ja){ja.ia.Va(444,new vb(ja))}}Object(u.a)(vb,"InteractivityTrackerServiceFactory",
ab.a,[]);var Gc=a(40),cd=a(734),Cd=a(96),Rd=a(480),Be=a(8),ad=a(52),Qc=a(60);class Zd{constructor(ja){this.k6j=ja}getCustomProperties(ja){const ia=new Map;if(ja.hasOwnProperty("startTimeInMs")&&ja.hasOwnProperty("totalExecutionTimeInMs")){const dc=ja.startTimeInMs;ja=this.k6j.retrieveSlowActionsBetweenTimeRange(dc,dc+ja.totalExecutionTimeInMs);ia.set("actions",Qc.a.ff(ja))}return ia}}Object(u.a)(Zd,"CallTreeCustomPropertiesRetriever",null,[405]);class Tb{constructor(){this.customProperties=new Map}addCustomProperty(ja,
ia){this.customProperties.set(ja,ia)}getCustomProperties(){return this.customProperties}}Object(u.a)(Tb,"CustomPropertiesRetriever",null,[404]);class Yc{isFeatureEnabled(ja,ia){return ba.EwaSettings.getBooleanFeatureGate(ja,ia)}}Object(u.a)(Yc,"ExcelFeatureChecker",null,[403]);class Ob{isProfilingEnabled(){return!0}}Object(u.a)(Ob,"ExcelProfilingFeatureChecker",null,[401]);class kc{constructor(ja,ia){this.Lgj=ja;this.Ngj=ia}onProfilerEvent(ja){switch(ja.eventId){case 1:this.Lgj(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));
break;case 0:this.Ngj();break;default:x.ULS.sendTraceTag(537155529,0,15,`JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId ${ja.eventId}`)}}}Object(u.a)(kc,"JSCPUProfilerObserver",null,[402]);class Kc{constructor(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}}Object(u.a)(Kc,"JSCPUProfilerInitOptions",null,[]);class Wc{constructor(){this.profilerTraceLoggingChunkSize=this.shouldLogRawProfilerTrace=this.shouldRecordFrameCounts=
this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=
this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=
this.appName=null}}Object(u.a)(Wc,"JSCPUProfilingPackageInitOptions",null,[]);class Nd{filter(ja){var ia,dc,od;const ae=!qd.a.instance.TTSI||(null===(ia=ja.serializedFrames[0])||void 0===ia?void 0:ia.startTimeInMs)<qd.a.instance.shk;ia=(null===(dc=ja.propertyBag)||void 0===dc?void 0:dc.actions)&&"[]"!==ja.propertyBag.actions;ja=0<(null===(od=ja.serializedFrames[0])||void 0===od?void 0:od.totalExecutionTimeInMs);return ae&&ja||ia}}Object(u.a)(Nd,"CallTreeCustomFilterer",null,[400]);let Ud=class{constructor(ja,
ia){this.interactivityTrackerService=this.smg=this.BQd=this.ngb=this.CQd=this.u_f=this.w_f=null;this.Lrj=new Set([1,0]);x.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=ja;this.interactivityTrackerService=ia;this.qyi();this.pyi();this.NOi=ba.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingSampleIntervalInMs",16);this.profilingIntervalInMs=ba.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",
1E4);this.dPe=ba.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.hkj=ba.EwaSettings.getStringFeatureGate("Microsoft.Office.Excel.ProfilerName","");this.s8j()}dispose(){x.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");Cd.a.Ma(this.smg);this.BQd=this.$=null;this.CQd.clear();this.ngb.clear()}H7j(){const ja=Math.random()*this.dPe;x.ULS.sendTraceTag(537155526,0,50,`JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: ${ja}`);
this.smg=ad.a.instance.create(()=>{this.fef("ExcelOnlineContinuousSessionProfiler",2).start()},ja,Xb.a.LYj,!0)}U7j(){x.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.fef("ExcelOnlineFullSessionProfiler",3).start()}v_f(ja){return this.ngb.has(ja)}s8j(){ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.U7j():this.H7j()}createProfiler(ja,ia,dc,od,ae,Pe){x.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");
const Xe=new Kc;Xe.samplingIntervalInMs=ia;Xe.maximumNumberOfSamplesToTake=dc;Xe.idleIntervalInMs=od;Xe.profilingIntervalInMs=ae;return this.Jth(ja,Pe,Xe)}pyi(){const ja=new Ob,ia=new Wc;ia.ulsInstance=new Rd.a;ia.deObfuscationEndpoint="ProfilerReporting.ashx";ia.shouldCompressSerializedCallTrees=!1;ia.shouldKeepSamplesOutsideOfProfilingInterval=!1;ia.shouldSendAllCallTreesFromProfileInASingleRequest=!ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",
!1);ia.shouldUseSendBeaconForSendingCallTrees=ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);ia.callTreeFilteringThresholdInMs=ba.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);ia.frameTotalExecutionTimeFilteringThresholdInMs=ba.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerFrameTotalExecutionTimeFilteringThresholdInMs",0);ia.shouldRecordFrameCounts=!1;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8083064_profilerCounters")&&
(ia.callTreeFilteringThresholdInMs=-1,ia.frameTotalExecutionTimeFilteringThresholdInMs=-1,ia.shouldRecordFrameCounts=!0);ia.deObfuscationRequestQueryParamsRetriever=this.xqh();ia.deObfuscationRequestBodyPropertiesRetriever=this.wqh();ia.featureEnabledChecker=new Yc;ia.useMainEventLoopForProfilerTraceProcessing=!1;ia.profilerTraceProcessingWebWorkerSourceURL=this.$.xa.JSProfilerProcessingWebWorkerJsScriptUrl;ia.shouldProcessProfileCapturedWhileUserIsIdle=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");
ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldLogRawProfilerTrace",!1)&&(ia.shouldLogRawProfilerTrace=!0,ia.profilerTraceLoggingChunkSize=ba.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.ProfilerTraceLoggingChunkSize",30));this.BQd=this.w_f.retrievePackage(ja,ia).retrieveProfilerFactory()}xqh(){const ja=new Tb;ja.addCustomProperty(Be.a.c0f,n.AFrameworkApplication.userType);ja.addCustomProperty(n.AFrameworkApplication.rGa,n.AFrameworkApplication.userSessionId);ja.addCustomProperty(Be.a.ZId,
this.$.xa.SkipAuthentication?Be.a.fIf:null);ja.addCustomProperty(Be.a.$Qd,this.$.xa.MachineCluster);return ja}wqh(){const ja=new Tb;ja.addCustomProperty("appName","Excel");ja.addCustomProperty("buildVersion",n.AFrameworkApplication.buildVersion);ja.addCustomProperty("shouldUseSourceMaps","true");ja.addCustomProperty("shouldFilterSensitiveResources","true");ja.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator","false");return ja}Jth(ja,ia,dc){const od=new Tb;od.addCustomProperty("ProfilerName",
ja);this.u_f.set(ja,od);ia=this.BQd.createProfiler(ia,dc,od);this.ngb.set(ja,ia);ja=this.Zrh(ja);ia.subscribeProfilerObserver(ja,this.Lrj);ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7875154_ProcessCallStacksWithActionOrBeforeTTSI")&&(ja=new Nd,ia.subscribeCallTreeCustomFilterer(ja));return ia}Nei(ja){return this.v_f(ja)?this.ngb.get(ja):(x.ULS.shipAssertTag(537155520,0,!1,`JsSelfProfilerManager.GetProfiler: Profiler with such name (${ja}) does not exist`),null)}fef(ja,ia){var dc=void 0===dc?null:
dc;ja=this.hkj||ja;if(this.v_f(ja))return this.Nei(ja);const od=this.NOi;return this.createProfiler(ja,od,null!=dc&&0<od?dc/od:2E6,2===ia?this.dPe:null,0===ia?null:this.profilingIntervalInMs,ia)}Zrh(ja){var ia=this.interactivityTrackerService;if(ia){const dc=ia.wSe();if(dc){ia=this.ngb.get(ja);const od=new Zd(dc);ia.subscribeCallTreeCustomPropertiesRetriever(od);ia=new kc(ae=>{dc.startCollectingSlowActions(ae)},Object(Oa.a)(dc,dc.stopCollectingSlowActions,"stopCollectingSlowActions"));this.CQd.set(ja,
ia);return ia}x.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}x.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");return null}qyi(){this.w_f=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.u_f=new Map;this.CQd=new Map;this.ngb=new Map}};Ud=Object(cd.a)([Object(Tc.d)(ub.Ub),Object(cd.b)(0,Object(ub.fb)()),
Object(cd.b)(1,Object(ub.Tb)()),Object(cd.b)(2,Object(ub.lc)())],Ud);Object(u.a)(Ud,"JsSelfProfilerManager",null,[387,5]);var $d=a(94);class $b extends ab.a{constructor(ja){super();this.$=ja;this.Oe()}create(){x.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");Gc.TaskExtensions.Aa((()=>$d.d(Tc.a.resolve(ub.bb,{Oa:this.$a})))(),ja=>{ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8082961_TrackerAndProfilerServicesWithNewInfra")?void Tc.a.Pu(ub.Tb).then(ia=>
{this.rRe(ja.result,ia)}):this.$.ia.Od(443,ia=>{this.rRe(ja.result,ia)})},this.$.ma,3)}rRe(ja,ia){Gc.TaskExtensions.Aa($d.d(ja.Zv.loadScript("officeOnlineCpuProfiling")),()=>{const dc=Object(Ra.a)(this.$.ia,437,()=>new Ud(this.$,ia));this.ve(dc)},this.$.ma,3)}static la(ja){ja.ia.Va(438,new $b(ja))}}Object(u.a)($b,"JsSelfProfilerManagerFactory",ab.a,[]);class nc{constructor(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}}Object(u.a)(nc,"ActionData",null,[]);class Oc{constructor(){this.hasBlockedActions=
!1;this.blockedActions=[]}}Object(u.a)(Oc,"BlockedEngagementInfo",null,[]);class Hd extends nc{constructor(){super();this.inputMethod=null;this.isCommand=!1}}Object(u.a)(Hd,"SuccessfulActionData",nc,[]);class re{constructor(){this.successfulActions=[]}}Object(u.a)(re,"SuccessfulEngagementInfo",null,[]);var fe=a(46),oc;let Xc=oc=class{constructor(ja){this.cOa=new Set;this.RUb=null;this.k6e=this.Sng=!1;this.efb=(ia,dc)=>{this.avb.hasBlockedActions=!0;ia=this.avb.blockedActions.length;const od=dc.details?
dc.actionName+"_"+dc.details:dc.actionName;dc=Object(Ad.a)(new nc,{order:ia+1,name:od,componentName:dc.componentName,timeFromNavigationStart:dc.timeFromNavigationStart});this.avb.blockedActions.push(dc)};this.ei=()=>{fe.a(this.$).iQb(this.efb);this.ZSi();this.RUb=ad.a.instance.create(()=>{this.QJb()},oc.a$j,Xb.a.QJb)};this.Bf=()=>{this.QJb()};this.nRd=()=>{this.$.rf(2009315810,-1,0,null);this.I1d=!1};this.avb=new Oc;this.avb.hasBlockedActions=!1;this.Zjb=new re;this.zUh();this.$=ja;this.$.ea.el(this.ei);
this.$.Zl(this.Bf);this.d$j=0;this.I1d=!1;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")&&(this.EPe=new Promise(ia=>{this.foh=ia}));fe.a(this.$).K6b(this.efb)}dispose(){this.$.ea&&this.$.ea.to(this.ei);this.$.Rp(this.Bf);Cd.a.Ma(this.RUb);this.$=this.RUb=null}rxj(ja,ia,dc){if(void 0!==ja&&null!==ja&&ia){var od=this.Zjb.successfulActions.length+1,ae="InputMethod"in ia?ia.InputMethod:"",Pe="IsCommand"in ia&&ia.IsCommand;if(this.nNi(ja,ia,ae,Pe)){++this.d$j===
oc.ook?(this.I1d=!0,this.omj=ad.a.instance.create(this.nRd,5E3,Xb.a.nRd)):this.I1d&&this.omj.Vt();if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive1")){const Xe=!Pe&&ja;this.k6e||Xe===Sa.a.vyg||Xe===Sa.a.wyg||Xe===Sa.a.syg||Xe===Sa.a.tyg||(this.k6e=!0,this.foh(void 0))}od>oc.nFf||(ja=Object(Ad.a)(new Hd,{order:od,name:ja,componentName:"Location"in ia?ia.Location:"",timeFromNavigationStart:dc,inputMethod:ae,isCommand:Pe}),this.Zjb.successfulActions.push(ja),
1===od?this.STi():od===oc.nFf&&this.QJb())}}}ZSi(){x.ULS.sendTraceTag(254546634,0,50,`${ha.c(this.avb)}`)}STi(){qd.a.instance.Gea(new Date)>oc.JUh?x.ULS.sendTraceTag(537154758,0,50,`First user interaction was filtered: ${ha.c(this.Zjb.successfulActions[0])}`):x.ULS.sendTraceTag(254563592,0,50,`${ha.c(this.Zjb.successfulActions[0])}`)}QJb(){!this.Sng&&this.Zjb.successfulActions.length&&(this.Sng=!0,Cd.a.Ma(this.RUb),this.RUb=null,this.$.sendBeaconTraceTag(254559496,50,!1,ha.c(this.Zjb)))}zUh(){this.cOa.add(Sa.a.K2c);
this.cOa.add(Sa.a.SYd);this.cOa.add(Sa.a.EPd);this.cOa.add(Sa.a.SYf);this.cOa.add(Sa.a.UYf);this.cOa.add(Sa.a.WYf)}nNi(ja,ia,dc,od){dc=!dc||"unknown"===dc;const ae="IsSystemInitiated"in ia&&ia.IsSystemInitiated;ia="NoReporting"in ia&&ia.NoReporting;const Pe=this.cOa.has(ja);ja=ua.a.equals(ja,Sa.a.sEc,!0)&&dc;return!ae&&!ia&&!Pe&&!ja&&!(od&&dc)}};Xc.nFf=10;Xc.JUh=6E4;Xc.a$j=12E4;Xc.ook=25;Xc=oc=Object(cd.a)([Object(Tc.d)(ub.rc),Object(cd.b)(0,Object(ub.fb)())],Xc);Object(u.a)(Xc,"PageLoadEngagementInfo",
null,[]);Object(Tc.b)(ub.lc)(()=>Ko(function*(){yield Tc.a.resolve(ub.ab,{Oa:0}).then(ja=>ja("officeOnlineCpuProfiling"));return officeOnlineCpuProfiling}));var ud=a(20);const Vd={MergedCell:"MergedCell",WAg:"ConditionalFormat",Comment:"Comment",Formula:"Formula",AutoFilter:"AutoFilter",PivotFilter:"PivotFilter",PivotTable:"PivotTable",Sparkline:"Sparkline",InCellImage:"InCellImage",XCg:"RichText"};let ge=class{constructor(ja){this.Bf=()=>{const ia=JSON.stringify(this.wNe),dc=JSON.stringify(this.vNe);
x.ULS.sendTraceTag(508929763,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToRowColCount": ${ia}}`);x.ULS.sendTraceTag(508826823,0,50,`GridActionTelemetryManager.onWorkBookClosing: {"commandNameToComplexCellInfo": ${dc}}`)};this.$=ja;this.wNe=[];this.vNe=[];ba.EwaSettings.MGb()&&this.$.Zl(this.Bf)}dispose(){this.$=null}gze(ja,ia){this.wNe.push({commandName:ia,rowColCount:ja.toString()})}i3c(ja,ia){if(ja&&0!==ja.length){var dc=[];const od={};for(let ae of ja)ae.gDi()&&(ja=c(ae),
""!==ja&&(od[ja]=od[ja]?od[ja]+1:1));for(let ae of Object.keys(od))dc.push({cellType:ae,count:od[ae]});0!==dc.length&&this.vNe.push({commandName:ia,complexCellTypes:dc})}}mye(ja,ia,dc,od){const ae=ud.h(this.$);var Pe=ae.ya.N9e();let Xe=[],vf=!1;"UnhideColumn"!==ja&&"UnhideRow"!==ja&&"insertColumns"!==ja&&"insertRows"!==ja||(vf=!0);for(let Xf of Pe){{Pe=Xf.xg;var Sf=od,xf=dc,Jg=ia,yg=vf;let Lg=null;if(Sf&&Pe||!ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7990966_GridActionTelemetryBlockRangeFix"))yg?
Pe.If(Sf)&&(Lg=Pe,Jg?Lg.top=Lg.bottom-xf+1:Lg.left=Lg.right-xf+1):Pe.If(Sf)||(Lg=Pe,Jg?Lg.bottom=Lg.top+xf-1:Lg.right=Lg.left+xf-1);Pe=Lg}Pe&&(Pe=ae.ya.o2(Pe))&&(Xe=[...Xe,...Pe])}this.i3c(Xe,ja+"Cascade")}};ge=Object(cd.a)([Object(Tc.d)(ub.Fb),Object(cd.b)(0,Object(ub.fb)())],ge);Object(u.a)(ge,"GridActionTelemetryManager",null,[386,5]);var Je=a(62),Ke=a(56),nf=a(138),uf=a(523),ef=a(37),Ve=a(87),bd=a(430),be=a(38),jb=a(247);class lc extends Sys.EventArgs{constructor(ja){super();this.ZH=ja}}Object(u.a)(lc,
"ErrorDataArgs",Sys.EventArgs,[]);var Zc=a(670),dd=a(123),Qd=a(32);class ue{constructor(ja,ia){this.ZYb=null;this.Pcc=this.Oud=!1;this.Pse=this.Qse=null;this.G$a=this.F$a=0;this.Ibg=ja;this.$pe=ia}get eWf(){return this.$pe}get KRb(){return this.Qse}get Hbg(){return this.Pse}get LOi(){return this.VIe(this.Ibg.getTime())}get Fkj(){return this.VIe(this.Hbg.getTime())}get lig(){return!(this.Pcc||void 0===window.bsqmXLSPageLoadStartTime)}get gad(){try{return this.ZYb||(this.ZYb=dd.toUtc(window.bsqmXLSPageLoadStartTime)),
this.ZYb}catch(ja){return null}}set gad(ja){this.ZYb=ja}cWj(ja){this.Pcc||(this.Qse=ja,this.Pse=dd.toUtc(this.KRb))}wti(ja){if(ja.Values&&(!this.F$a||!this.G$a))try{fb.a.ymf in ja.Values&&(this.F$a=parseInt(ja.Values[fb.a.ymf].toString(),10));fb.a.zmf in ja.Values&&(this.G$a=parseInt(ja.Values[fb.a.zmf].toString(),10));const ia=J.a.instance;0<this.F$a&&(this.QBf(this.F$a,"PageLoadFromHostClick"),ia.txj(this.F$a));0<this.G$a&&(this.QBf(this.G$a,"PageLoadFromHostFrameCreation"),ia.uxj(this.G$a));const dc=
ja.Values[fb.a.zti]||0,od=ja.Values[fb.a.xti]||ja.Values[fb.a.yti]||0;0<od&&ia.axj(od);ia.bxj(dc)}catch(ia){}}RIj(){this.Ibg=this.gad=Qd.a.Jd.Re;this.$pe=0;this.Oud=this.Pcc=!1}VIe(ja){const ia=this.gad.getTime();return ia>=ja?0:ja-ia+this.eWf}QBf(ja,ia){if(ja){const dc=Kd.b();dc.VHc("UserAction",ia,ia,Qd.a.GGd(ja),Zc.EcmaDateClock.instance.appStart);dc.afc(ia,dd.toTimestamp(this.KRb))}}}Object(u.a)(ue,"PageLoadPerfInfo",null,[]);var qa=a(77);class Xa{constructor(ja,ia,dc){this.l0c=ja.keyCode;this.xSb(ja.ctrlKey,
1);this.xSb(ja.shiftKey,2);this.xSb(ja.altKey,4);this.xSb(qa.b(ja),8);this.xSb(dc,16);this.l0c=this.Ojb|ia<<24}get Ojb(){return this.l0c}get keyCode(){return this.Ojb&65535}xSb(ja,ia){ja&&(this.l0c=this.Ojb|ia<<16)}}Object(u.a)(Xa,"ShortcutSqmData",null,[]);class wb{constructor(){this.IFd=null;this.Ujh={["0"]:0,["1"]:1,["2"]:2,["4"]:3,["8"]:4,["16"]:5,["32"]:6};this.c9f()}Oeh(ja,ia,dc){0===dc&&(dc=this.Ujh[ia.toString()]);return wb.jig(ja,dc)&&(ja=new Xa(ja,dc,A.a.isMac),!be.a.$i(this.IFd,ja.Ojb.toString()))?
(this.IFd[ja.Ojb.toString()]=!0,ja):null}c9f(){this.IFd={}}static vGi(ja){return 112<=ja&&123>=ja||61440<=ja&&61451>=ja}static WHi(ja){return 17!==ja&&18!==ja&&16!==ja&&91!==ja&&93!==ja}static jig(ja,ia){let dc=ja.ctrlKey||ja.altKey||qa.b(ja);ja=ja.keyCode;dc=wb.vGi(ja)||dc;dc=wb.WHi(ja)&&dc;return 0!==ia&&dc}}Object(u.a)(wb,"UnhandledShortcutLogger",null,[]);class Rb{constructor(ja){this.sac=[];this.c4g=null;this.sqmManager=ja}Q5b(ja){this.sac.push(ja)}B3(ja,ia,dc){try{if(ia)ia.endTime=dc,this.sqmManager.kye(ia);
else for(let od=0,ae=this.sac.length;od<ae;od++){const Pe=this.sac[od];ja?(Pe.endTime=Pe.startTime,Pe.xNe=0):Pe.endTime=dc;this.sqmManager.kye(Pe)}}catch(od){}finally{this.sac.length=0}}}Object(u.a)(Rb,"UserInteractionPerfInfo",null,[]);var vc=a(36),Nc=a(74),id=a(242);class Id extends ka.a{constructor(ja,ia){super();this.Gtd=this.JQb=!1;this.oig=!0;this.Xa=new ef.a;this.OQc=!1;this.Bf=()=>{const dc=Nc.a(this.$).Pf.activityState,od=be.a.$i(dc,vc.a.Pxe);be.a.$i(dc,vc.a.Lsb)||od||this.upload()};this.$=
ja;this.sCb=ia;this.ea=ja.ea;this.$.Zl(this.Bf);this.etg=new wb;this.gUa=new ue(sb.a.fYd,ja.xa.PageGenerationMetrics.TimeToCompleteFirstFlush);this.$Lc=new Rb(this)}c4c(ja){this.Xa.addHandler("EREK",ja)}aUd(ja){this.Xa.removeHandler("EREK",ja)}get owh(){return this.OQc}get cAi(){return this.$.frame.GU?Be.a.eAi:Be.a.dAi}get workbookContext(){return this.$.workbookContext}get mX(){Id.umb||(Id.umb=this.AZe());Id.k8c||(Id.k8c=!0,this.kof());return Id.umb}set mX(ja){Id.umb=ja;Id.umb||(Id.k8c=!1)}get f7(){return Ve.a(this.$.xa,
3)}dispose(){this.owh&&n.AFrameworkApplication.Up&&n.AFrameworkApplication.Up.disable();this.$&&this.$.Rp(this.Bf);this.$=this.$Lc=this.gUa=this.mX=null;super.dispose()}xjf(ja){this.gUa.wti(ja);this.ZTi()}FZd(ja){this.setDw(9415,ja)}Q5b(ja){this.$Lc.Q5b(ja)}B3(ja,ia,dc){this.$Lc.B3(ja,ia,dc)}fFd(ja){this.f7&&(ja=this.$.isEditMode||ja&&this.ea.workbookContext.Options&512?2:this.ea.Je.inEmbedView?14:1,this.setDw(8721,ja),this.FWh(ja),this.OQc=!1)}fCf(){const ja=this.gUa;this.f7&&ja.lig&&(this.setDw(9450,
ja.eWf),this.setDw(9085,ja.LOi))}gCf(ja){if(!this.JQb){this.JQb=!0;const ia=this.gUa;let dc=0;this.f7&&ia.lig?(ia.cWj(ja),this.$Lc.c4g=ia.Hbg,this.setDw(9086,ia.Fkj),ia.Pcc=!0,dc=this.gUa.KRb.getTime()):dc=ja.getTime();Gc.TaskExtensions.Aa(this.sCb.value,od=>{od.result.sendMessage(Ib.a.X3g,{[fb.a.Y3g]:dc})},this.ma,3)}}kye(ja){this.f7&&ja&&1!==ja.dia&&this.Lka(8327,jb.b(ja),jb.l(ja),jb.a(ja),2,ja.xNe,jb.m(ja),jb.d(ja),jb.e(ja))}mVd(ja,ia){ja&&ja.MessageIdHash&&this.lVd(ja.MessageIdHash,ja.MessageIdName,
ja.MessageId,ja.ErrorCause?ja.ErrorCause:Ke.a.AKc,!1,ia,ja,null)}lVd(ja,ia,dc,od,ae,Pe,Xe,vf){Id.H5c||(Id.H5c=!0,nf.a.get_instance().isCompleted(13)||(nf.a.get_instance().Lv(13),x.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));ja=this.A7a(ja);const Sf=!!Xe,xf={};xf.ErrorName=ia;xf.ErrorHashCode=ja.toString();xf.ErrorId=dc.toString();xf.ErrorCause=od.toString();xf.ErrorType=0===Pe?"ErrorDialog":"BusinessBar";xf.BusinessBarEntryName=vf||"null";xf.ServerCorrelationId=
Sf?Xe.CorrelationId:"null";xf.WebMethodName=Sf?Xe.WebMethodName:"null";xf.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";xf.WfeServerId=Sf?Xe.WfeServerId:"null";ia=Qc.a.ff(xf);this.Xa.raiseEvent("EREK",new lc(xf));x.ULS.sendTraceTag(1881314,0,15,ia);this.f7&&(fa.a.y2f(ja.toString()),this.Lka(9134,ja,od,Ke.a.Y7d),this.ea.Lx||ae||(this.setDw(10459,ja),this.fFd(!0),this.Gtd=!0,this.upload(),this.kof()))}A7a(ja){return 5439488|(ja>>>16^ja&65535)&65535}BFd(ja,ia,
dc){ja=this.etg.Oeh(ja,ia,dc);this.f7&&ja&&this.Lka(11007,ja.Ojb)}upload(){!this.f7||!this.JQb&&!this.Gtd||A.a.Zh&&n.AFrameworkApplication.ij?A.a.Zh&&n.AFrameworkApplication.ij&&x.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.mX.OWb(),this.OQc=!0);n.AFrameworkApplication.Up=this.mX=null;this.gUa.RIj();this.JQb=!1;n.AFrameworkApplication.Up=this.mX=this.AZe();this.etg.c9f()}ZTi(){const ja=this.gUa;if(this.f7&&!ja.Oud){var ia=ja.F$a,dc=ja.G$a,od=ja.KRb.getTime();
n.AFrameworkApplication.RP=ja.KRb;ia&&this.setDw(10324,ia>od?0:od-ia);dc&&this.setDw(10325,dc>od?0:od-dc);ja.Oud=!0}}Lka(ja,...ia){this.f7&&this.mX.Lka(ja,...ia)}setDw(ja,ia){this.f7&&this.mX.setDw(ja,ia)}AZe(){bd.a.ZZe(this.$.xa);return n.AFrameworkApplication.Up}FWh(ja){let ia;try{ia=Object(ca.a)(Object,Qc.a.kl(n.AFrameworkApplication.da.appSettings.SessionStartInfoJson))}catch(dc){x.ULS.sendTraceTag(537151311,0,15,`Couldn't parse SessionStartInfoJson. Message: ${dc.message}`);return}if(ia){let dc=
Object(ca.a)(String,ia.ApplicationModeExtended),od=Object(ca.a)(String,ia.ApplicationMode);dc&&od&&(dc=dc.toUpperCase(),2!==ja&&16!==ja||"VIEW"!==dc&&"UNIFIED"!==dc?1!==ja||"EDIT"!==dc&&"UNIFIED"!==dc||(dc="VIEW",od="View"):(dc="EDIT",od="Edit"),ia.ApplicationModeExtended=dc,ia.ApplicationMode=od,n.AFrameworkApplication.da.appSettings.SessionStartInfoJson=Qc.a.ff(ia))}}kof(){const ja=this.$.xa;this.mX.AQ=!0;this.mX.$Ya(ja.BWsaStartTime);this.setDw(59,83);this.JQb=!1;if(this.f7){const ia=ja.DocumentHostInfo;
this.Vuh();this.setDw(8491,this.$.VG);this.setDw(9236,ja.RequestedUILcid);this.setDw(8473,ja.WacHostId);this.setDw(9902,jb.c(ia.ClusterId));ba.EwaSettings.Fa(398)?this.mX.Ieg(""):this.mX.Ieg(ja.FlightHolder?ja.FlightHolder.FlightId:"");this.FZd(this.ea.Je.inEmbedView?1:0);this.Gtd=!1;this.setDw(9104,jb.c(ia.FileSourceId));this.setDw(10309,this.cAi);this.cYj();n.AFrameworkApplication.Vd.YSd(uf.a.getInstance(!1))}}cYj(){J.a.instance.Hwi(this.mX);if(this.oig){const ja=J.a.instance;ja.Xwj();ja.oxj();
ja.mxj();ja.lxj();ja.gxj();this.oig=!1}}Vuh(){this.createStream(8327,1,id.a.fyh,id.a.A6a);this.createStream(9134,1,3,id.a.A6a);this.createStream(11007,1,1,id.a.A6a)}createStream(ja,ia,dc,od){this.mX.createStream(ja,ia,dc,od)}}Id.umb=null;Id.k8c=!1;Id.H5c=!1;Object(u.a)(Id,"SqmManager",ka.a,[160,397]);var me=a(771);class Wb{constructor(ja,ia){this.entryTypes=null;this.buffered=!1;this.entryTypes=ja;this.buffered=void 0===ia?!1:ia}}Object(u.a)(Wb,"PerformanceObserverInit",null,[]);class Ec extends Sys.EventArgs{constructor(ja){super();
this.b_e=ja}}Object(u.a)(Ec,"LongTaskObservedEventArgs",Sys.EventArgs,[]);class hd extends Sys.EventArgs{constructor(ja){super();this.snc=ja}}Object(u.a)(hd,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);class je{constructor(ja){this.Xa=new ef.a;this.kUc=!1;this.ei=()=>{if(A.a.kq){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(this.gWi)).observe(new Wb([Be.a.MFd])),this.kUc=!0)}catch(ia){this.kUc=!1,x.ULS.sendTraceTag(537153885,
0,10,`Exception related to PerformanceObserver: ${ia}`)}this.Xa.raiseEvent("ltpoiek",new hd(this.snc))}};this.gWi=ia=>{this.Xa.raiseEvent("ltoek",new Ec(ia))};this.$=ja;this.$.ea.Gh?this.ei(this,Sys.EventArgs.Empty):this.$.ea.el(this.ei)}get snc(){return this.kUc}FAe(ja){this.Xa.addHandler("ltoek",ja)}bEj(ja){this.Xa.removeHandler("ltoek",ja)}N_g(ja){this.Xa.addHandler("ltpoiek",ja)}cEj(ja){this.Xa.removeHandler("ltpoiek",ja)}dispose(){this.$.ea.to(this.ei);Cd.a.Ma(this.Xa);this.$=this.Xa=null}}Object(u.a)(je,
"LongTaskPerformanceObserver",null,[5]);var Ee=a(163);class Ge{constructor(ja,ia){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===ja?0:ja;this.longTaskDuration=void 0===ia?0:ia}get PFd(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}LNi(ja){return 100*this.PFd>ja}gYg(ja){this.yze(ja.longTaskDuration);this.P3c(ja.activeSessionDuration)}yze(ja){this.longTaskDuration+=ja}P3c(ja){this.activeSessionDuration+=ja}}Object(u.a)(Ge,
"LongTaskPerformanceData",null,[]);class bf{constructor(ja,ia,dc,od,ae){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=ja;this.entireSessionData=ia;this.worstWindowData=dc;this.postBootWindowData=od;this.maxUsersCount=ae}get reportName(){return"LongTaskPerformance"}static get cGh(){return new bf(!1,new Ge,new Ge,new Ge,0)}}Object(u.a)(bf,"LongTaskPerformanceDataStatistics",null,[459]);class of extends Sys.EventArgs{constructor(ja){super();
this.NFd=ja}}Object(u.a)(of,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var hf=a(392),na=a(301);class S{constructor(ja,ia){this.Xa=new ef.a;this.bSa=this.S9=this.$V=this.wg=null;this.zyf=this.V1d=this.rrc=!1;this.DSa=null;this.maxUsersCount=0;this.cxc=(dc,od)=>{dc=od.b_e.getEntriesByType(Be.a.MFd);for(const ae of dc)this.wg.nG(ae.duration)||n.AFrameworkApplication.IRa||(this.$V.yze(ae.duration),this.Xa.raiseEvent("lttek",new of(ae)),dc={},dc.LongTaskDuration=ae.duration,dc.LongTaskStartTime=ae.startTime,
x.ULS.sendTraceTag(187982418,0,50,JSON.stringify(dc)))};this.ei=()=>{this.V1d=!0;this.GUb()};this.yE=(dc,od)=>{od&&(this.maxUsersCount=Math.max(this.maxUsersCount,od.Jok));this.S9.maxUsersCount=this.maxUsersCount};this.fg=()=>{this.GUb()};this.Bf=()=>{this.JUb()};this.ZPf=(dc,od)=>{od.snc&&this.GUb()};this.JCf=()=>{this.$V.P3c(dd.getElapsedMilliseconds(this.bSa,Qd.a.Jd.Re));this.V3d(!0);var dc=!1;this.S9.postBootWindowData.activeSessionDuration?(!this.zyf&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(Kd.b().R7f(2),Q.Health.instance.recordKpiUsage(na.a.longJsTask,0,hf.a.MOi,null),this.zyf=!0),!this.S9.isVetoSession&&this.$V.LNi(this.gyg)&&(this.S9.isVetoSession=!0,ba.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(Kd.b().S7f(2,this.eWi),Q.Health.instance.recordKpiFailure(na.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),this.S9.worstWindowData.PFd<=this.$V.PFd&&(this.S9.worstWindowData=this.$V),this.S9.entireSessionData.gYg(this.$V)):(this.S9.postBootWindowData=
new Ge(this.$V.activeSessionDuration,this.$V.longTaskDuration),dc=!0);const od={};od.LastWindowScore=this.$V;od.postBootWindow=dc;od.CoauthersNumber=this.$.ea.gp.length;dc=JSON.stringify(od);x.ULS.sendTraceTag(20779346,0,50,dc);this.$V=new Ge};this.Xvc=()=>{this.wg.Cj||n.AFrameworkApplication.IRa||this.V3d(!1)};this.Vvc=()=>{this.$V.P3c(dd.getElapsedMilliseconds(this.bSa,Qd.a.Jd.Re));this.bSa=null;this.DSa.cancel()};this.$=ja;this.gyg=ja.xa.LongTaskPerformanceVetoThreshold;this.eWi="PercentageOver_"+
this.gyg.toString();this.OFd=ja.xa.LongTaskPerformanceWindowDurationInMs;this.DQ=ia;ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Tc.a.resolve(ub.W).then(dc=>{this.wg=dc;this.GUb()}):this.$.ia.Od(291,dc=>{this.wg=dc;this.GUb()});this.$.ea.Gh?this.ei(this,Sys.EventArgs.Empty):this.$.ea.el(this.ei);this.DQ.N_g(this.ZPf);this.$.zn(this.fg);this.$.Zl(this.Bf)}O_g(ja){this.Xa.addHandler("lttek",ja)}dEj(ja){this.Xa.removeHandler("lttek",
ja)}dispose(){this.V1d=!1;this.JUb();this.$.uo(this.fg);this.$.Rp(this.Bf);this.DQ.cEj(this.ZPf);Cd.a.Ma(this.DSa);this.DQ=this.$=this.DSa=null;void 0!==this.wg&&null!==this.wg&&Cd.a.Ma(this.wg)}GUb(){void 0===this.wg||null===this.wg?x.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.DQ.snc?this.rrc?x.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):
this.V1d?(this.rrc=!0,this.S9=bf.cGh,this.$V=new Ge,this.$.ea.Jca(this.yE),this.maxUsersCount=this.$.ea.gp.length,this.DQ.FAe(this.cxc),this.wg.T0(this.Vvc),this.wg.$W(this.Xvc),n.AFrameworkApplication.V3c(this.Vvc),n.AFrameworkApplication.W3c(this.Xvc),this.DSa=ad.a.instance.create(this.JCf,this.OFd,Xb.a.VBf,!1),nd.a(this.$).YW(this.S9),this.wg.Cj||n.AFrameworkApplication.IRa||this.V3d(!0),x.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):x.ULS.sendTraceTag(537153881,
0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):x.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")}JUb(){this.rrc&&(this.rrc=!1,this.$.ea.to(this.ei),this.DQ.bEj(this.cxc),this.$.ea.baa(this.yE),void 0!==this.wg&&null!==this.wg&&(this.wg.CVa(this.Vvc),this.wg.ZDa(this.Xvc)),n.AFrameworkApplication.y5f(this.Vvc),
n.AFrameworkApplication.z5f(this.Xvc),this.DSa.cancel(),this.bSa=this.$V=this.S9=null,this.maxUsersCount=0)}V3d(ja){ja||void 0===this.bSa||null===this.bSa?(this.bSa=Qd.a.Jd.Re,this.DSa=Ee.AsyncMethodContext.Sxb(this.JCf,ja?this.OFd:this.OFd-this.$V.activeSessionDuration,Xb.a.VBf,this.DSa)):x.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")}}Object(u.a)(S,
"LongTaskPerformanceTracker",null,[5]);var Ja=a(29);class rb extends ef.a{constructor(ja,ia){super();this.statusBarManager=this.wg=null;this.$Pf=(dc,od)=>{od.NFd&&od.NFd.duration>=this.hWi&&(this.dDf++,this.Yyf=od.NFd.duration)};this.$=ja;this.$.ia.Od(29,dc=>{this.statusBarManager=dc;dc.BM(this)});ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Tc.a.resolve(ub.W).then(dc=>{this.wg=dc}):this.$.ia.Od(291,dc=>{this.wg=dc});this.Yyf=this.dDf=
0;this.hWi=ja.xa.LongTaskThresholdMs;this.kdb=ia;this.kdb.O_g(this.$Pf)}yt(ja){this.addHandler("LTSCEK",ja)}Ut(ja){this.removeHandler("LTSCEK",ja)}LC(){this.mq("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")}ov(ja,ia){if("QueryLongTasksCount"!==ja)return!1;this.spi(ia);return!0}mq(){return ba.EwaSettings.Fa(505)}dispose(){this.statusBarManager&&(this.statusBarManager.WI(this),this.statusBarManager=null);this.kdb.dEj(this.$Pf);super.dispose()}spi(ja){const ia=`Long Tasks: ${this.dDf} | Last Task Duration: ${Math.round(this.Yyf)}ms`;
Ja.a.mo()?(ja.LabelText=ia,ja.Visible=!0):ja.Value=ia}}Object(u.a)(rb,"LongTasksStatusBarManager",ef.a,[5,298,173]);var ma=a(11);class ib{constructor(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}}Object(u.a)(ib,"NetworkInfoData",null,[]);class Qb extends ef.a{constructor(ja){super();this.statusBarManager=null;this.z3c=!1;this.EIf=()=>{this.raiseEvent("NetworkInformation")};this.$=ja;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry")&&
(this.vL=this.C7d("connection")||this.C7d("mozConnection")||this.C7d("webkitConnection"))&&ba.EwaSettings.Fa(410)&&ja.ia.Od(29,ia=>{this.statusBarManager=ia;ia.BM(this);this.vL.addEventListener("change",this.EIf);this.z3c=!0})}yt(ja){this.addHandler("NetworkInformation",ja)}Ut(ja){this.removeHandler("NetworkInformation",ja)}z9a(){return this.vL?Object(Ad.a)(new ib,{bandwidthMps:this.vL.downlink,rttMs:this.vL.rtt,connectionType:this.vL.type,effectiveConnection:this.vL.effectiveType,downlinkMaxMps:this.vL.downlinkMax}):
null}ov(ja,ia){if("QueryNetworkInformation"!==ja)return!1;this.tpi(ia);return!0}mq(){return this.z3c}dispose(){this.z3c&&(this.statusBarManager&&(this.statusBarManager.WI(this),this.statusBarManager=null),this.vL&&this.vL.removeEventListener("change",this.EIf));this.$=null;super.dispose()}C7d(ja){return ma.HelperMethods.lq(window.navigator,ja)?window.navigator[ja]:null}tpi(ja){const ia="Network: "+this.vL.downlink.toString()+" Mbps, "+this.vL.rtt.toString()+" ms";Ja.a.mo()?(ja.LabelText=ia,ja.Visible=
!0):ja.Value=ia}}Object(u.a)(Qb,"NetworkInformationManager",ef.a,[298,173]);var Fc=a(198);class jd{constructor(ja,ia,dc,od,ae,Pe,Xe,vf,Sf,xf){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===ja?"":ja;this.startTime=void 0===ia?-1:ia;this.startToNextFrame=void 0===dc?-1:dc;this.startToResponseRenderEnd=
void 0===od?-1:od;this.wasHidden=void 0===ae?!1:ae;this.isUserOperation=void 0===Pe?!0:Pe;this.isGroupBreaking=void 0===Xe?!0:Xe;this.operationThatLedToLogging=void 0===Sf?"":Sf;this.startToOperationThatLedToLogging=void 0===xf?-1:xf;this.isPartOfGroup=void 0===vf?!1:vf}}Object(u.a)(jd,"OperationStatisticsData",null,[]);var ke=a(85);class ne{constructor(){this.operationsGroups=null;this.Xvi()}isGroup(ja,ia,dc){const od=new Fc.a;od.addRange(ja);od.addRange(ia);for(let ae=0;ae<this.operationsGroups.count;ae++)if(this.vJi(this.operationsGroups.ka(ae),
od,dc))return x.ULS.sendTraceTag(595194768,1,50,`OperationsGroupDetector: Operation '${dc}' is part of a group ( operationsList: ${this.OVf(ja)} , frameOperationsList: ${this.OVf(ia)})`),!0;x.ULS.sendTraceTag(595194767,1,50,`OperationsGroupDetector: Operation '${dc}' is NOT part of a group.`);return!1}vJi(ja,ia,dc){let od=0;for(let ae=0;ae<ia.count;ae++)if(ia.ka(ae).isGroupBreaking){if(ja.count<=od||!ua.a.equals(ia.ka(ae).name,ja.ka(od),!0))return!1;od++}return ja.count>od&&ua.a.equals(dc,ja.ka(od),
!0)}OVf(ja){ja=ke.select(ja,ia=>ia.name);return`[${ke.toArray(ja).join(", ")}]`}Xvi(){this.operationsGroups=new Fc.a;this.K2a(new Fc.a(["Paste","SelectingRange_unknown"]));this.K2a(new Fc.a(["AutoSum","SelectingRange_unknown"]));this.K2a(new Fc.a(["ChangeSheetDirection","ActiveItemChanged"]));this.K2a(new Fc.a(["InsertSheet","ActiveItemChanged","SelectingRange_unknown"]));this.K2a(new Fc.a(["DeleteSheet","DialogButtonClick","ActiveItemChanged","SelectingRange_unknown"]));this.K2a(new Fc.a(["EditBoxEndEdit",
"SetCell","SelectingRange_keyboard","MoveDownWithinSelectionOrCommitEdit"]))}K2a(ja){this.operationsGroups.add(ja)}}Object(u.a)(ne,"OperationsGroupDetector",null,[]);var Te=a(26);class Hb{constructor(ja,ia,dc,od){this.framePerformanceTracker=this.wQb=this.Y3=this.W4=null;this.bHj=()=>{this.B5c=-1;const ae=ma.HelperMethods.he();this.gnk(ae);this.RRb&&(x.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),this.EWb(this.NH,
ae),this.RRb=!1);this.zpc&&(this.EWb(this.NI,ae),this.RRb||this.EWb(this.NH,ae));window.setTimeout(this.XTi,0)};this.XTi=()=>{var ae=[];const Pe=this.$.xa.OperationToPrevOperationThreshold;for(var Xe=0;Xe<this.NH.count;Xe++){var vf=this.NH.ka(Xe);Xe<Pe&&ae.push(vf);this.NI.add(vf)}ud.h(this.$)&&ud.h(this.$).ya?((Xe=this.sessionStatisticsManager.jod(0))?(vf=JSON.stringify(this.WJb),ae=JSON.stringify(ae),x.ULS.sendTraceTag(237798547,1,50,`DOM count: (${Xe.WZi}, ${Xe.M7g}, ${Xe.MYi}), long tasks: ${vf}, operations count: ${this.NH.count}, operations: ${ae}`)):
x.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),this.NH.count>Pe&&x.ULS.sendTraceTag(537153875,1,50,`More than ${Pe} operations are in the operationsList. count: ${this.NH.count}`),this.NH.clear(),this.WJb.clear()):x.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.cxc=(ae,Pe)=>{this.fWi(Pe.b_e)};this.$=ja;this.QL=ia;this.ik=this.ik||Qd.a.Jd;this.NI=new Fc.a;this.NH=new Fc.a;this.B5c=this.Bcb=-1;this.WJb=new Fc.a;this.operationsGroupDetector=
new ne;this.RRb=this.zpc=!1;this.vwi();this.Zvi();this.Yvi();this.sessionStatisticsManager=dc;this.DQ=od;this.DQ.FAe(this.cxc);this.$.ia.Od(263,ae=>{this.framePerformanceTracker=ae})}FQb(ja,ia){var dc=ma.HelperMethods.he();const od=this.operationsGroupDetector.isGroup(this.NI,this.NH,ja);(this.zpc=this.WIi(ja))&&0<this.NI.count&&!od&&(this.kmk(),this.jmk(ja,dc),this.iXh());this.Bcb=-1;if(ud.h(this.$)&&ud.h(this.$).ya){var ae=!this.W4.contains(ja);dc=new jd(ja,dc,void 0,void 0,void 0,ae,this.zpc,od);
this.NH.add(dc);this.framePerformanceTracker&&this.framePerformanceTracker.j8j(dc.name,ia);!this.RRb&&this.wQb.contains(ja)&&(this.RRb=!0);-1===this.B5c&&(this.B5c=window.requestAnimationFrame(this.bHj))}else x.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")}ECc(){this.Bcb=ma.HelperMethods.he()}LCc(){this.NI.count||this.NH.count?(this.EWb(this.NH,this.Bcb),this.EWb(this.NI,this.Bcb)):x.ULS.sendTraceTag(0,1,50,`ReportOnBlockCacheConsistant when no operations in the list. Last block render time: ${this.Bcb}`);
this.Bcb=-1}WIi(ja){return!this.Y3.contains(ja)&&!ja.includes("Menu")&&!ja.includes("TellMe")}iXh(){for(let ja=0;ja<this.NI.count;ja++){const ia=this.NI.ka(ja);this.QL.VTg(ia);this.CUi(ia)}this.NI.clear()}gnk(ja){for(let ia=0;ia<this.NH.count;ia++)this.NH.ka(ia).startToNextFrame=this.oqd(this.NH.ka(ia).startTime,ja),this.NH.ka(ia).wasHidden=me.a.nG(this.NH.ka(ia).startToNextFrame)}jmk(ja,ia){for(let dc=0;dc<this.NI.count;dc++)-1===this.NI.ka(dc).startToResponseRenderEnd&&(this.NI.ka(dc).operationThatLedToLogging=
ja,this.NI.ka(dc).startToOperationThatLedToLogging=this.oqd(this.NI.ka(dc).startTime,ia))}kmk(){var ja=!1;for(let ia of this.NI)if(ia.isPartOfGroup){ja=!0;break}if(ja)for(ja=0;ja<this.NI.count;ja++)this.NI.ka(ja).isPartOfGroup=this.NI.ka(ja).isGroupBreaking}EWb(ja,ia){for(let dc=0;dc<ja.count;dc++)ja.ka(dc).startToResponseRenderEnd=this.oqd(ja.ka(dc).startTime,ia),ja.ka(dc).wasHidden=me.a.nG(ja.ka(dc).startToResponseRenderEnd)}CUi(ja){ja=JSON.stringify(ja);x.ULS.sendTraceTag(2020372336,1,50,`${ja}`)}oqd(ja,
ia){return-1===ja?-1:-1===ia?-2:ia-ja}fWi(ja){ja=ja.getEntriesByType(Be.a.MFd);for(let ia=0;ia<ja.length;ia++)if(30>this.WJb.count)if(this.NH.count)this.WJb.add(this.mmj(ja[ia]));else{const dc=ja[ia];if(null===dc||void 0===dc?0:dc.attribution)void 0!==dc.attribution.containerSrc&&null!==dc.attribution.containerSrc&&(dc.attribution.containerSrc=""),void 0!==dc.attribution.containerId&&null!==dc.attribution.containerId&&(dc.attribution.containerId=""),void 0!==dc.attribution.containerName&&null!==dc.attribution.containerName&&
(dc.attribution.containerName="");x.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty.")}else{x.ULS.sendTraceTag(537153874,1,50,`More then ${30} long tasks are in the longTaskList. entries length: ${ja.length} First long task: ${this.WJb.ka(0)}`);break}}mmj(ja){return`name:${ja.name}, startTime:${ja.startTime}, duration:${ja.duration}`}vwi(){this.W4||(this.W4=new qe.a(Wa.a.Ei()),this.W4.add("ActiveItemChanged"),this.W4.add(Kd.b().Tl(-1398645260)),
this.W4.add(Kd.b().Tl(722290388)),this.W4.add(Kd.b().Tl(974713501)),this.W4.add(Te.a.fU(Te.a.hac)),this.W4.add(Te.a.fU(Te.a.gac)),this.W4.add(Te.a.fU(Te.a.Mwb)),this.W4.add(Te.a.fU(Te.a.P_f)),this.W4.add(Te.a.fU(Te.a.wra)))}Zvi(){this.Y3||(this.Y3=new qe.a(Wa.a.Ei()),this.Y3.add("PromptEditInBrowser"),this.Y3.add(Kd.b().Tl(-1398645260)),this.Y3.add(Kd.b().Tl(722290388)),this.Y3.add(Kd.b().Tl(974713501)),this.Y3.add(Te.a.fU(Te.a.hac)),this.Y3.add(Te.a.fU(Te.a.gac)),this.Y3.add(Te.a.fU(Te.a.Mwb)),this.Y3.add(Te.a.fU(Te.a.P_f)),
this.Y3.add(Te.a.fU(Te.a.wra)))}Yvi(){this.wQb||(this.wQb=new qe.a(Wa.a.Ei()),this.wQb.add("SelectingRange_keyboard"),this.wQb.add("SelectingRange_mouse"))}}Object(u.a)(Hb,"OperationStatistics",null,[]);var Cc=a(598);class vd{constructor(ja,ia){this.messageIdName=null;this.errorCause=0;this.messageIdName=ja;this.errorCause=ia}}Object(u.a)(vd,"RequestError",null,[]);class le{constructor(ja,ia,dc,od,ae,Pe,Xe,vf,Sf,xf,Jg,yg,Xf,Lg,lg,Kf,Dh){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=
this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=
0;this.requestName=ja;this.isUserTriggeredRequest=le.gai(ja);this.isFullyLoggedKPIRequest=le.Y$h(ja);this.isPromotedUTRRequest=le.$$h(ja);this.requestDuration=ia;this.totalOperationDuration=dc;this.requestTimeInQueue=od;this.requestInvokedTime=ae;this.ecsOperationDuration=Pe.EcsOperationDuration;this.EcsRequestDuration=Pe.EcsRequestDuration;this.WfeRequestDuration=Pe.WfeRequestDuration;this.TimeFromLastEcsFreeze=Pe.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=Pe.DuringLoadOnDemand;this.correlationID=
Xe;this.errors=le.lmh(vf);this.httpStatus=Sf;this.requestResourceTiming=xf;this.communicationErrorRetryCount=Jg;this.successfulCall=yg;this.isDocumentHidden=Xf;this.coauthorsCount=Lg;this.responseSize=lg;this.networkInfoData=Kf;this.responseToCallbackTime=Dh}static lmh(ja){if(!ja)return[];const ia=[];for(const dc of ja)ia.push(new vd(dc.MessageIdName,dc.ErrorCause));return ia}static gai(ja){return!le.W1i.contains(ja)}static Aci(){const ja=new qe.a(Wa.a.Ei());ja.add("CheckPersistedContentUpdate");
ja.add("GetContentBundle");ja.add("GetSessionStatus");ja.add("GetStatusBarAggregates");ja.add("PollSessionStatus");ja.add("UpdatePresenceUsers");ja.add("UploadLatencyTelemetry");return ja}static Y$h(ja){return le.oZh.contains(ja)}static $$h(ja){return le.Srj.contains(ja)}static x9h(){const ja=new qe.a(Wa.a.Ei());ja.add("SetRichTextCell");ja.add("Copy");ja.add("FormatCells");ja.add("PasteRange");ja.add("FindCell");ja.add("ApplyToRangesV2");ja.add("ResizeRowsColumns");ja.add("InsertDeleteCells");ja.add("FillRange");
ja.add("PasteHtmlContent");ja.add("ApplyFilter");ja.add("PasteString");ja.add("Undo");ja.add("LineageUpdateView");ja.add("FindAll");ja.add("ApplyHyperlink");ja.add("AutoFit");ja.add("GetPrintSettings");ja.add("GetEdgeCell");ja.add("Paste");ja.add("MoveAndResizeFloatingObject");ja.add("FindRange");ja.add("SetCustomFilter");ja.add("RenameSheet");ja.add("ApplyThreadedComment");ja.add("SortFilterColumn");ja.add("InsertCopiedCutCells");ja.add("InsertSheet");ja.add("ToggleAutoFilter");ja.add("ReorderSheets");
ja.add("SetOutlineLevel");ja.add("RefreshAll");ja.add("LineageOpenPaneOrChangeFilter");ja.add("ApplySlicerSelection");ja.add("GetCardViewCardByCell");ja.add("AutoSum");ja.add("LineageClosePane");ja.add("Sort");ja.add("ClearAutoFilter");ja.add("DeleteSheet");ja.add("Redo");ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(ja.add("RemovePageBreak"),ja.add("InsertPageBreak"),ja.add("SetPrintArea"),ja.add("ClearPrintArea"));return ja}static aai(){const ja=new qe.a(Wa.a.Ei());
ja.add("DeleteConditionalFormattingRules");ja.add("GetConditionalFormattingRules");ja.add("AddConditionalFormattingRule");ja.add("QuickEditConditionalFormattingRule");ja.add("GetPrintSettings");ja.add("UpdatePresenceUsers");ja.add("GetThemeInfo");ja.add("InsertCopiedCutCells");ja.add("PasteRange");ja.add("FillRange");ja.add("InsertCopiedCutCellsCrossSession");ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(ja.add("LineageOpenPaneOrChangeFilter"),ja.add("LineageUpdateView"),
ja.add("LineageRefreshView"),ja.add("LineageLoadMore"));return ja}}le.W1i=le.Aci();le.oZh=le.x9h();le.Srj=le.aai();Object(u.a)(le,"RequestStatisticsData",null,[]);class De{constructor(ja,ia,dc){this.$=ja;this.QL=ia;this.Mpa=dc}PCc(ja,ia,dc,od,ae,Pe,Xe,vf,Sf,xf,Jg,yg,Xf,Lg){yg=Cc.a(yg);ja=new le(ja,ia,dc,od,ae,Pe,Xe,vf,Sf,yg,xf,Jg,me.a.nG(ia),this.Lpd(null),Xf,this.Mpa.z9a(),Lg);this.PVd(ja)}Uj(ja,ia){ja="UnknownMethodName";var dc=-1;void 0!==ia.context&&null!==ia.context&&(ja=ia.context.methodName,
dc=ia.context.communicationErrorRetryCount);let od,ae={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};ia.Nf?(od=ia.Nf.Errors||[],this.QL.UGj(ia.Nf.EditSessionIsDirty),void 0!==ia.Nf.RequestTelemetryData&&null!==ia.Nf.RequestTelemetryData&&(ae=ia.Nf.RequestTelemetryData)):od=[];const Pe=ia.duration,Xe=Cc.a(ia.url);ja=new le(ja,Pe,ia.totalOperationDuration,ia.a6d,ia.sI,ae,ia.nZd,od,ia.httpStatus,Xe,dc,!0,me.a.nG(Pe),this.Lpd(ia.Nf),
ia.responseSize,this.Mpa.z9a(),ia.responseToCallbackTime);this.PVd(ja);ja.requestResourceTiming&&(dc=ja.requestResourceTiming.totalDuration-ja.WfeRequestDuration,dc>=this.$.xa.LongNetworkTimeTelemetryThresholdInMilliseconds&&ia.responseHeaders&&x.ULS.sendTraceTag(508880928,0,50,`RequestStatistics.onWebMethodSuccess: Slow network time detected: requestName = ${ja.requestName}, requestDuration = ${ja.requestDuration}, networkTime = ${dc},  ServerCorrelation = ${ja.correlationID}, msEdgeHeader = ${Be.a.$Kb in
ia.responseHeaders?ia.responseHeaders[Be.a.$Kb]:""}, backendDatacenter = ${Be.a.OJd in ia.responseHeaders?ia.responseHeaders[Be.a.OJd]:""}, proxyDatacenter = ${Be.a.QJd in ia.responseHeaders?ia.responseHeaders[Be.a.QJd]:""}`))}ip(ja,ia){ja="UnknownMethodName";let dc=-1;void 0!==ia.context&&null!==ia.context&&(ja=ia.context.methodName,dc=ia.context.communicationErrorRetryCount);const od=ia.duration,ae=Cc.a(ia.url);ia=new le(ja,od,ia.totalOperationDuration,ia.a6d,ia.sI,{EcsOperationDuration:-1,EcsRequestDuration:-1,
WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},ia.nZd,ia.errors||[],ia.httpStatus,ae,dc,!1,me.a.nG(od),this.Lpd(null),-1,this.Mpa.z9a(),ia.responseToCallbackTime);this.PVd(ia)}PVd(ja){this.QL.N2g(ja);if(ba.EwaSettings.Fa(212)){var ia=ja.requestName;if(ia!==Be.a.Hza&&"SetCell"!==ia&&"FindRange"!==ia&&"FindAll"!==ia&&"FindCell"!==ia)return}ia=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===ja.requestName||null===ja.requestName)&&ja.isPromotedUTRRequest;
De.$Dh(ja,ia);this.QL.WTg(ja)}Lpd(ja){var ia;if(null===(ia=null===ja||void 0===ja?void 0:ja.CollaborationResult)||void 0===ia?0:ia.Users)return ja.CollaborationResult.Users.length;ja=this.$.ea.gp.length;return 0<ja?ja:1}static $Dh(ja,ia){ia?Kd.b().HEc(388829456,0,15,ja):(ia=Sys.Serialization.JavaScriptSerializer.serialize(ja),x.ULS.sendTraceTag(388829456,0,50,ia));if(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==ja.requestName&&null!==ja.requestName&&ja.isFullyLoggedKPIRequest){ia=
new Map;ia.set("isUserTriggeredRequest",ja.isUserTriggeredRequest.toString());ia.set("requestDuration",ja.requestDuration.toString());ia.set("totalOperationDuration",ja.totalOperationDuration.toString());ia.set("requestTimeInQueue",ja.requestTimeInQueue.toString());ia.set("requestInvokedTime",ja.requestInvokedTime.toString());ia.set("ecsOperationDuration",ja.ecsOperationDuration.toString());ia.set("ecsRequestDuration",ja.EcsRequestDuration.toString());ia.set("wfeRequestDuration",ja.WfeRequestDuration.toString());
ia.set("timeFromLastEcsFreeze",ja.TimeFromLastEcsFreeze.toString());ia.set("duringLoadOnDemand",ja.DuringLoadOnDemand.toString());ia.set("correlationID",ja.correlationID);ia.set("errors",ja.errors.toString());ia.set("httpStatus",ja.httpStatus.toString());if(ja.networkInfoData){var dc=ja.networkInfoData;ia.set("networkInfoData_bandwidthMps",void 0===dc.bandwidthMps||null===dc.bandwidthMps?"NA":dc.bandwidthMps.toString());ia.set("networkInfoData_rttMs",void 0===dc.rttMs||null===dc.rttMs?"NA":dc.rttMs.toString());
ia.set("networkInfoData_effectiveConnection",void 0===dc.effectiveConnection||null===dc.effectiveConnection?"NA":dc.effectiveConnection)}ja.requestResourceTiming&&(dc=ja.requestResourceTiming,ia.set("requestResourceTiming_fetchStart",void 0===dc.downloadDuration||null===dc.downloadDuration?"NA":dc.downloadDuration.toString()));ia.set("communicationErrorRetryCount",ja.communicationErrorRetryCount.toString());ia.set("successfulCall",ja.successfulCall.toString());ia.set("isDocumentHidden",ja.isDocumentHidden.toString());
ia.set("coauthorsCount",ja.coauthorsCount.toString());ia.set("responseSize",ja.responseSize.toString());ia.set("responseToCallbackTime",ja.responseToCallbackTime.toString());Kd.b().MCc(ja.requestName,ja.successfulCall,ia)}}}Object(u.a)(De,"RequestStatistics",null,[]);var Ce=a(217),af=a(58),Cf=a(278);class Jf{constructor(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=
null}}Object(u.a)(Jf,"OperationTypeStatisticsData",null,[]);class Ff{constructor(ja,ia){this.data=new Jf;this.data.operationName=ja;this.data.isUserOperation=ia;this.data.totalCount=0;this.Bmg=[];this.Cmg=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}Lf(ja){this.data.totalCount<Ff.Qgd&&(this.Bmg.push(ja.startToNextFrame),this.Cmg.push(ja.startToResponseRenderEnd));this.data.totalCount++;
this.data.longestStartToNextFrame<ja.startToNextFrame&&(this.data.longestStartToNextFrame=ja.startToNextFrame);this.data.longestStartToResponse<ja.startToResponseRenderEnd&&(this.data.longestStartToResponse=ja.startToResponseRenderEnd)}Hkd(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.pef(this.Bmg),this.data.startToResponsePercentiles=this.pef(this.Cmg))}pef(ja){ja.sort(ma.HelperMethods.HI);let ia;ia="("+me.a.yna(ja,25).toString();ia=ia+", "+me.a.yna(ja,50).toString();ia=ia+
", "+me.a.yna(ja,75).toString();ia=ia+", "+me.a.yna(ja,95).toString();return ia+")"}}Ff.Qgd=1E3;Object(u.a)(Ff,"OperationTypeStatistics",null,[]);class ic{constructor(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=
this.requestDurationPercentile50=this.requestDurationPercentile25=0}}Object(u.a)(ic,"RequestTypeStatisticsData",null,[]);class W{constructor(ja){this.data=new ic;this.data.requestName=ja;this.data.totalCount=0;this.Ehb=[];this.$6d=this.S6d=this.T6d=this.X6d=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=
-1;this.data.requestDurationPercentile95=-1}BHj(ja){this.data.totalCount<W.Qgd&&this.Ehb.push(ja.requestDuration);this.data.totalCount++;this.X6d+=ja.requestDuration;this.T6d+=W.fnd(ja.ecsOperationDuration);this.S6d+=W.fnd(ja.EcsRequestDuration);this.$6d+=W.fnd(ja.WfeRequestDuration);0<ja.TimeFromLastEcsFreeze&&ja.TimeFromLastEcsFreeze<W.bZh&&this.data.callsDuringEcsFreeze++;ja.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;ja.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;
if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<ja.requestDuration)this.data.longestRequest=ja}Hkd(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.X6d/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.T6d/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.S6d/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.$6d/this.data.successfulCalls)):
(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Ehb.sort(ma.HelperMethods.HI),this.data.requestDurationPercentile25=me.a.yna(this.Ehb,25),this.data.requestDurationPercentile50=me.a.yna(this.Ehb,50),this.data.requestDurationPercentile75=me.a.yna(this.Ehb,75),this.data.requestDurationPercentile95=me.a.yna(this.Ehb,95))}static fnd(ja){return 0>ja?0:ja}}W.bZh=3E3;W.Qgd=1E3;Object(u.a)(W,"RequestTypeStatistics",null,[]);class d{constructor(ja,
ia,dc,od,ae,Pe,Xe,vf){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=ja;this.ocsCapable=ia;this.endedBySplashScreen=dc;this.dirtySessionOnLastRecordedRequest=od;this.loadOnDemandCount=ae;this.maxCoauthorsCount=Pe;this.everConnectedToOcs=Xe;ja=[];for(let Sf in vf)ia=vf[Sf],ia.Hkd(),ja.push(ia.data);this.requests=ja}}Object(u.a)(d,"SessionStatisticsData",
null,[]);class Na{constructor(ja){this.dirtySessionOnLastRecordedRequest=this.Q3d=!1;this.FAf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=ja;this.wsb={};this.vsb={};this.Ced={}}Bf(){var ja=this.Tvh();if(sb.a.Iha()){var ia={};ia.xlendJson=ja;this.$.Ira(Ce.a.Zsk,ia,!1)}else af.O(this.$.qa.ua,ja,null,null,null,null,null);ja=this.Uvh();sb.a.Iha()?(ia={},ia.xlenoJson=ja,this.$.Ira(Ce.a.$sk,ia,!1)):x.ULS.sendTraceTag(388776782,0,50,ja);ja=this.tqh();sb.a.Iha()?(ia={},ia.xlencJson=ja,this.$.Ira(Ce.a.Ysk,
ia,!1)):x.ULS.sendTraceTag(388776770,0,50,ja);this.iIj()}wrc(){this.everConnectedToOcs=this.$.ea.icb||this.everConnectedToOcs;Q.Health.instance&&Q.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())}ei(){const ja=new Cf.a;let ia="";const dc=!this.$.isAnonymousUser(),od=ja.li();if(od){if(dc){ja.TSb("UMI_Linkable","true");return}ia=ja.cPa("UMI_Linkable")}dc||x.ULS.sendTraceTag(537153870,0,50,`SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:${od}, UMIIsLinkable:${!!ia}`)}Chb(){this.Q3d=
!0}UGj(ja){this.dirtySessionOnLastRecordedRequest=ja}N2g(ja){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,ja.coauthorsCount);Q.Health.instance&&Q.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())}WTg(ja){if(!(ja.requestName in this.wsb)){const ia=new W(ja.requestName);this.wsb[ja.requestName]=ia}this.wsb[ja.requestName].BHj(ja)}VTg(ja){if(!(ja.name in this.vsb)){const ia=new Ff(ja.name,ja.isUserOperation);this.vsb[ja.name]=ia}this.vsb[ja.name].Lf(ja)}YW(ja){this.Ced[ja.reportName]=
ja}iIj(){this.dirtySessionOnLastRecordedRequest=this.Q3d=!1;this.FAf=this.$.ea.AEd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.wsb={};this.vsb={};this.Ced={}}Tvh(){const ja=new d(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.Q3d,this.dirtySessionOnLastRecordedRequest,this.$.ea.AEd-this.FAf,this.maxCoauthorsCount,this.everConnectedToOcs,this.wsb);return Sys.Serialization.JavaScriptSerializer.serialize(ja)}Uvh(){var ja=new Fc.a;const ia=this.vsb;for(let dc in ia){const od=ia[dc];
od.Hkd();ja.add(od.data)}ja=ja.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(ja)}tqh(){return Sys.Serialization.JavaScriptSerializer.serialize(this.Ced)}}Object(u.a)(Na,"SessionStatistics",null,[]);class Eb extends ka.a{constructor(ja){super();this.sra=this.zqa=null;this.wTe=Array(1);this.PWc=this.QFd=null;this.Uj=(ia,dc)=>{ba.EwaSettings.Fa(39)&&(this.sra=this.sra||new De(this.$,this.QL,this.Mpa),this.sra.Uj(ia,dc))};this.ip=(ia,dc)=>{ba.EwaSettings.Fa(39)&&(this.sra=this.sra||
new De(this.$,this.QL,this.Mpa),this.sra.ip(ia,dc))};this.Bf=(ia,dc)=>{ba.EwaSettings.Fa(39)&&this.QL.Bf(ia,dc)};this.ei=(ia,dc)=>{ba.EwaSettings.Fa(39)&&this.QL.ei(ia,dc)};this.wrc=(ia,dc)=>{ba.EwaSettings.Fa(39)&&this.QL.wrc(ia,dc)};this.$=ja;ba.EwaSettings.Fa(39)&&(me.a.aof(this.$),this.DQ=new je(this.$),this.psh(),ba.EwaSettings.Fa(505)&&this.kdb&&(this.QFd=new rb(this.$,this.kdb)),this.QL=new Na(this.$),this.Mpa=new Qb(this.$),this.$.Zl(this.Bf),this.$.qa.gu(this.Uj),this.$.qa.wA(this.ip),this.$.ea.wAe(this.wrc),
ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.el(this.ei))}get kdb(){return this.PWc}dispose(){this.$&&ba.EwaSettings.Fa(39)&&(this.$.Rp(this.Bf),this.$.qa.Kv(this.Uj),this.$.qa.IB(this.ip),this.$.ea.f6f(this.wrc),ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.to(this.ei));Cd.a.Ma(this.Mpa);Cd.a.Ma(this.kdb);this.PWc=null;Cd.a.Ma(this.DQ);this.DQ=null;Cd.a.Ma(this.QFd);this.$=this.QFd=null;super.dispose()}Chb(){ba.EwaSettings.Fa(39)&&
this.QL.Chb()}PCc(ja,ia,dc,od,ae,Pe,Xe,vf,Sf,xf,Jg,yg,Xf,Lg){ba.EwaSettings.Fa(39)&&(this.sra=this.sra||new De(this.$,this.QL,this.Mpa),this.sra.PCc(ja,ia,dc,od,ae,Pe,Xe,vf,Sf,xf,Jg,yg,Xf,Lg))}FQb(ja,ia){ba.EwaSettings.Fa(39)&&(this.zqa=this.zqa||new Hb(this.$,this.QL,this,this.DQ),this.zqa.FQb(ja,ia))}ECc(){ba.EwaSettings.Fa(39)&&(this.zqa=this.zqa||new Hb(this.$,this.QL,this,this.DQ),this.zqa.ECc())}LCc(){ba.EwaSettings.Fa(39)&&(this.zqa=this.zqa||new Hb(this.$,this.QL,this,this.DQ),this.zqa.LCc())}YW(ja){ba.EwaSettings.Fa(39)&&
this.QL.YW(ja)}jod(ja){return ba.EwaSettings.Fa(39)?this.wTe[ja]:null}peg(ja){ja&&(this.wTe[ja.type]=ja)}z9a(){return this.Mpa.z9a()}psh(){A.a.kq&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.PWc=new S(this.$,this.DQ))}}Object(u.a)(Eb,"SessionStatisticsManager",ka.a,[14]);var ac=a(103),Jc=a(1114),xd=a(137),Xd=a(150);class xe{constructor(ja,ia){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=
!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=ja;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=
this.dialogPromptedOnUnload=!1;this.wacSessionId=ia}s6d(){return Qc.a.ff(this)}}Object(u.a)(xe,"AppUnloadInfo",null,[]);var $e=a(732),Oe=a(124),Re=a(577);class Bf{constructor(ja){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=ja.QMe+ja.Wsg;this.dataLossReason=ja.aJe;this.Mch(ja.d$d)}Mch(ja){const ia=new $e.a(Re.a.wN());let dc=0,od=0;for(const ae of ja)ia.Hd(ae)||ia.fa(ae,0),ja=ia.fa(ae,ia.ka(ae)+1),ja>
dc&&(dc=ja,od=ae);dc>this.mostCommonOperationCount&&(this.mostCommonOperationName=Oe.a(od),this.mostCommonOperationCount=dc)}}Object(u.a)(Bf,"DataLossInfo",null,[]);var Vf=a(66);class Tf{constructor(ja){this.M5c="AppUnloadInfo";this.np=this.$=this.workbookHashedId=this.eC=null;this.Qce=this.rge=!1;this.Uh=null;this.ynf=0;this.zga=(ia,dc)=>{this.ynf=dc.AJc};this.TUf=(ia,dc)=>{dc.d$d.length&&this.$.rQ&&(this.eC.dataLossInfo=new Bf(dc),this.eC.wasDataLostDuringUnload=!0,this.jib())};this.ei=()=>{this.Lcg();
this.$.ea.to(this.ei)};this.qTa=()=>{this.eC.wasUpdatedOnBeforeUnload=!0;this.eC.inactivityDurationBeforeUnloadSeconds=this.Uh.ukb<Tf.dZi?this.ynf:this.Uh.ukb;this.Dvg()};this.jNb=()=>{this.eC.wasUpdatedOnUnload=!0;this.Dvg();Sys.Application.remove_unload(this.jNb)};this.Oxc=()=>{this.eC.lastSilentReopenStartTime=Qd.a.Jd.Re;this.eC.lastSilentReopenEndTime=null;this.jib();this.$.zn(this.$Mb)};this.$Mb=()=>{this.eC.lastSilentReopenEndTime=Qd.a.Jd.Re;this.jib();this.$.uo(this.$Mb)};this.localStorage=
new Cf.a;this.localStorage.li()&&(this.$=ja,this.workbookHashedId=Vf.a(this.$),this.eC=new xe(this.workbookHashedId,this.$.xa.UserSessionId),this.np=Xd.a.instance.WM(),this.np.la("beforeunload",this.qTa),this.$.userOperationManager.F1g(this.TUf),ja.ea.Gh?this.Lcg():this.$.ea.el(this.ei),this.Uh=this.$.ea.Uh,this.Uh.kwa(this.zga),Sys.Application.add_unload(this.jNb),this.$.ea.ztb(this.Oxc))}get dialogPromptedOnUnload(){return this.rge}set dialogPromptedOnUnload(ja){this.rge=ja;this.eC?(this.eC.dialogPromptedOnUnload=
ja,this.jib()):this.localStorage.li()&&x.ULS.sendTraceTag(537151058,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.li()}`)}get apiBeforeCloseNotificationEnabledOnUnload(){return this.Qce}set apiBeforeCloseNotificationEnabledOnUnload(ja){this.Qce=ja;this.eC?(this.eC.apiBeforeCloseNotificationEnabledOnUnload=ja,this.jib()):this.localStorage.li()&&x.ULS.sendTraceTag(537151057,0,10,`AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: ${this.localStorage.li()}`)}dispose(){this.$&&
this.$.userOperationManager&&this.$.userOperationManager.IFj(this.TUf);this.Uh&&(this.Uh.aEa(this.zga),this.Uh=null);this.np.VH();this.$=this.np=null}Dvg(){this.TWj();this.jib()}TWj(){this.eC.wasOfflineDuringUnload=this.$.xh.u9;this.eC.timeFromLastConnectivity=xd.a(Qd.a.Jd,this.$.xh.vzf);this.eC.timeFromLastDisconnectionStart=xd.a(Qd.a.Jd,this.$.xh.xPi);this.eC.disconnectionSource=Enum.toString(Jc.a,this.$.xh.disconnectionSource);this.eC.hadConnectivityIssuesDuringUnload=this.$.xh.Joa;this.eC.timeFromLastStatusCode0=
xd.a(Qd.a.Jd,this.$.xh.uzf)}jib(){this.eC.timestamp=Date.now();this.localStorage.TSb(this.M5c,this.eC.s6d())}Lcg(){const ja=this.localStorage.cPa(this.M5c);if(ja)try{const ia=Qc.a.kl(ja);this.localStorage.R4f(this.M5c);const dc=this.lXi(ia);x.ULS.sendTraceTag(574677456,0,50,dc)}catch(ia){x.ULS.sendTraceTag(537151056,0,15,`AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: ${ia.message}`)}else x.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")}lXi(ja){const ia=
{};ia.WACSessionID=ja.wacSessionId;ia.wasRefreshed=this.Lgh(ja,this.$.xa.MaxAppReloadDurationIndicatingRefresh);ia.closedWithDialogConfirmation=ja.dialogPromptedOnUnload;ia.wasOfflineDuringUnload=ja.wasOfflineDuringUnload;ia.TimeFromLastConnectivityMs=ja.timeFromLastConnectivity;ia.TimeFromLastDisconnectionStart=ja.timeFromLastDisconnectionStart;ia.wasDataLostDuringUnload=ja.wasDataLostDuringUnload;ia.DataLossInfo=ja.dataLossInfo;ia.flushedOnUnload=ja.wasUpdatedOnUnload;ia.flushedOnBeforeUnload=ja.wasUpdatedOnBeforeUnload;
ia.InactivityDurationBeforeUnload=ja.inactivityDurationBeforeUnloadSeconds;ia.DisconnectionSource=ja.disconnectionSource;ia.hadConnectivityIssuesDuringUnload=ja.hadConnectivityIssuesDuringUnload;ia.TimeFromLastStatusCode0=ja.timeFromLastStatusCode0;ia.LastSilentReopenStartTime=ja.lastSilentReopenStartTime;ia.LastSilentReopenEndTime=ja.lastSilentReopenEndTime;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(ia.ApiBeforeCloseNotificationEnabledOnUnload=
ja.apiBeforeCloseNotificationEnabledOnUnload);return ha.c(ia)}Lgh(ja,ia){const dc=window.performance.timing.navigationStart-ja.timestamp;(ja=this.workbookHashedId===ja.workbookHashedId&&dc<ia)&&x.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return ja}static la(ja){ja.ea.Je.inWebPart||ja.ia.Va(410,new Tf(ja))}}Tf.dZi=10;Object(u.a)(Tf,"AppUnloadTelemetryManager",null,[399,5]);var rg=a(12);class bg{constructor(ja){this.iUe=!1;this.kUe=null;this.Qf=
()=>{this.GLj();ud.h(this.$).ga&&ud.h(this.$).ga.s4(this.Qf)};this.Em=(ia,dc)=>{dc.pa&&!this.P5d.has(dc.pa.name)&&(this.P5d.add(dc.pa.name),ud.h(this.$).ga&&(ud.h(this.$).ga.s4(this.Qf),ud.h(this.$).ga.W0(this.Qf)))};this.$=ja;this.ppg=new Set;this.P5d=new Set;this.$.ta&&this.$.ta.pa&&this.P5d.add(this.$.ta.pa.name);ud.h(this.$).ga.W0(this.Qf);this.$.ta.zj(this.Em)}dispose(){this.$=null}GLj(){this.kUe||this.Wch();const ja=ud.d(ud.h(this.$));if(!this.iUe){const ia=rg.a.instance.za(281).split(",");
ja.push(...ia);this.iUe=!0}for(const ia of ja)ia&&!this.ppg.has(ia)&&(this.UTi(ia),this.ppg.add(ia))}UTi(ja){this.eeh(ja)}Wch(){this.kUe=bg.vza("monospace");bg.vza("sans-serif");bg.vza("serif")}eeh(ja){bg.vza(`${ja},${"monospace"}`);bg.vza(`${ja},${"sans-serif"}`);bg.vza(`${ja},${"serif"}`)}static la(ja){if(ba.EwaSettings.Fa(61)){const ia=new bg(ja);ja.ia.Va(210,ia)}}static vza(ja){const ia=document.createElement("div"),dc=document.createElement("div");ia.style.cssText="position: absolute; overflow: auto; visibility: hidden;";
bg.HWj(dc,ja);document.body.appendChild(ia);ia.appendChild(dc);dc.innerText="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";ja=dc.offsetWidth+"x"+dc.offsetHeight;document.body.removeChild(dc.parentNode);return ja}static HWj(ja,ia){ja.style.cssText="display: inline; visibility: hidden;";ja.style.fontSize="100px";ja.style.fontWeight="normal";ja.style.fontStyle="normal";ja.style.letterSpacing="normal";ja.style.lineHeight="normal";ja.style.whiteSpace="nowrap";ja.style.fontFamily=
ia}}Object(u.a)(bg,"FontTelemetryManager",null,[5]);var gh=a(245),xh=a(182),Wg;(function(ja){ja[ja.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";ja[ja.reactSingleLineRibbon=1]="reactSingleLineRibbon";ja[ja.reactMultiLineRibbon=2]="reactMultiLineRibbon";ja[ja.invalid=3]="invalid"})(Wg||(Wg={}));Object(u.b)("RibbonMode",Wg);var Ya=a(115);let Cb=class extends ef.a{constructor(){super();this.kP=!1;this.mme=this.lme=null;this.RKd=()=>{this.pvg()};this.Ldj=()=>{Cd.a.Ma(this.R1);Cd.a.Ma(this.np)};this.R1=
Xd.a.instance.AMa();this.np=Xd.a.instance.WM();this.R1.la("visibilitychange",this.RKd);this.np.la("pagehide",this.Ldj);this.pvg()}get Cj(){return this.kP}get Hyf(){return this.lme}get bsc(){return this.mme}T0(ja){this.addHandler("ekdh",ja)}CVa(ja){this.removeHandler("ekdh",ja)}$W(ja){this.addHandler("ekduh",ja)}ZDa(ja){this.removeHandler("ekduh",ja)}nG(ja){return this.Cj?!0:this.bsc?dd.getElapsedMilliseconds(this.bsc,Qd.a.Jd.Re)<ja:!1}dispose(){Cd.a.Ma(this.R1);Cd.a.Ma(this.np);super.dispose()}pvg(){this.kP=
"hidden"===window.document.visibilityState;this.Cj?(this.raiseEvent("ekdh"),this.lme=Qd.a.Jd.Re):(this.raiseEvent("ekduh"),this.mme=Qd.a.Jd.Re)}};Cb=Object(cd.a)([Object(Tc.d)(ub.W)],Cb);Object(u.a)(Cb,"DocumentVisibilityObserver",ef.a,[385,5]);var cc=a(133);class Rc{constructor(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}}Object(u.a)(Rc,"FramePerformanceData",null,[]);class gd{constructor(ja){this.name=
null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new Rc;this.l2FramePerformanceData=new Rc;this.l3FramePerformanceData=new Rc;this.name=ja}}Object(u.a)(gd,"FramePerformanceDataGroup",null,[]);class Md{constructor(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}get reportName(){return this._reportName}}Object(u.a)(Md,"FramePerformanceSessionEndsReport",null,[459]);class td{constructor(ja){this.sNd={};this.Xka=null;this.olb=(ia,dc)=>
{ia.longFramesOverThresholdOps++;ia.maxLongFrameDuration=Math.max(ia.maxLongFrameDuration,dc)};this.mh=new Md;this.Zsh();ja.ia.Od(276,()=>{nd.a(ja).YW(this.mh)})}Zsh(){this.Xka=new gd("AllGridOperationsData");this.mh.operationsGroups.push(this.Xka);this.Lxb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.Lxb("DragScroll",["DragScroll"]);this.Lxb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.Lxb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.Lxb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])}uHj(ja,ia,dc,od){const ae=this.t9h(ja);ae&&(cc.b(this.mh.operationsGroups,Pe=>ua.a.equals(Pe.name,ae.name,!1))||this.mh.operationsGroups.push(ae),ae.count++,this.wLc(ia,ae),this.sLc(dc,ae),this.Xka.count++,
this.wLc(ia,this.Xka),this.sLc(dc,this.Xka),0<od&&this.Slk(od,ae),0<=ia&&this.elk(ia,ae))}umk(){for(const ja of this.mh.operationsGroups)td.mlk(ja)}Lxb(ja,ia){ja=new gd(ja);for(const dc of ia)this.sNd[dc]=ja}t9h(ja){return ja in this.sNd?this.sNd[ja]:null}elk(ja,ia){30>ja&&this.v8d(dc=>{dc.l1FramePerformanceData.fpsUnderThresholdOps++},ia);15>ja&&this.v8d(dc=>{dc.l2FramePerformanceData.fpsUnderThresholdOps++},ia);5>ja&&this.v8d(dc=>{dc.l3FramePerformanceData.fpsUnderThresholdOps++},ia)}Slk(ja,ia){100<=
ja&&(this.plb(ia.l1FramePerformanceData,ja,this.olb),this.plb(this.Xka.l1FramePerformanceData,ja,this.olb));300<=ja&&(this.plb(ia.l2FramePerformanceData,ja,this.olb),this.plb(this.Xka.l2FramePerformanceData,ja,this.olb));600<=ja&&(this.plb(ia.l3FramePerformanceData,ja,this.olb),this.plb(this.Xka.l3FramePerformanceData,ja,this.olb))}v8d(ja,ia){ia&&(ja(ia),ja(this.Xka))}plb(ja,ia,dc){ja&&dc(ja,ia)}wLc(ja,ia){ia.minFPS=-1===ia.minFPS?ja:Math.min(ia.minFPS,ja)}sLc(ja,ia){ia.maxFPS=Math.max(ia.maxFPS,
ja)}static mlk(ja){td.$8d(ja.l1FramePerformanceData,ja.count);td.$8d(ja.l2FramePerformanceData,ja.count);td.$8d(ja.l3FramePerformanceData,ja.count)}static $8d(ja,ia){ja.fpsUnderThresholdOpsPercentage=100*ja.fpsUnderThresholdOps/ia;ja.longFramesOverThresholdOpsPercentage=100*ja.longFramesOverThresholdOps/ia}}Object(u.a)(td,"FramePerformanceSessionEndsReportManager",null,[]);class Fe{constructor(){this.f=null}}Object(u.a)(Fe,"FpsDataWrapper",null,[]);class Se{constructor(ja,ia){this.duration=this.startSecond=
0;this.startSecond=void 0===ja?-1:ja;this.duration=void 0===ia?-1:ia}}Object(u.a)(Se,"LongFrameData",null,[]);var gf=a(357);class Hf{constructor(ja,ia,dc,od,ae,Pe,Xe,vf,Sf,xf){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===ja?null:ja;this.count=void 0===ia?0:ia;this.start=void 0===dc?-1:dc;this.end=void 0===od?-1:od;this.Avg=void 0===ae?0:ae;this.Max=void 0===Pe?-1:Pe;this.Min=
gf.a.vBg;this.longFrameCount=void 0===Xe?0:Xe;this.coauth=(void 0===vf?-1:vf)||1;this.tfAppInt=void 0===Sf?-1:Sf;this.Props=void 0===xf?null:xf;this.LFrame=null}}Object(u.a)(Hf,"OperationFPSData",null,[]);var Ef=a(43),Lf=a(809);class Wf extends ka.a{constructor(ja){super();this.Utb=-1;this.oDd=0;this.IBa=new Date(0);this.m1=null;this.hma={};this.tya=new Fc.a;this.ZWd=this.Gcb=!1;this.y8a=null;this.nJc=this.ceb=0;this.isSynthetic=!1;this.L7e=()=>{const ia=new Date;var dc=ia.getMinutes();const od=ia.getSeconds();
this.XIb&&ia.getTime()-this.XIb.getTime()>this.Bbk?(this.stop(),this.uld(ia)):(dc!==this.oDd&&(this.uld(ia),this.oDd=dc),this.Gcb&&(this.wg.Cj?this.m1[od]=Wf.Qdc:(this.UVe(od),this.Gcb=!1,this.tya.clear(),this.hma={})),this.m1[od]!==Wf.Qdc&&(this.m1[od]++,dc=ia.getTime()-this.IBa.getTime(),dc>this.$Cf&&this.rUi(this.IBa,dc)),this.Utb=window.requestAnimationFrame(this.L7e),this.IBa=ia)};this.KI=()=>{this.Gcb=!0};this.cKf=()=>{this.pause()};this.dKf=()=>{this.ZWd&&this.resume()};this.Bk=()=>{this.ya.a3()&&
this.amk()};this.XIb=new Date;this.wg=new Cb;this.wg.T0(this.KI);n.AFrameworkApplication.V3c(this.cKf);n.AFrameworkApplication.W3c(this.dKf);this.$=ja;this.$Cf=ja.xa.LongFrameThresholdMs;this.dWi="MoreThan_"+this.$Cf.toString()+"_Ms";this.Abk=ja.xa.ThresholdToEndOperationTrackingSeconds;this.Bbk=ja.xa.ThresholdToStopFPSTrackingMS;this.ya=ud.h(this.$).ya;n.AFrameworkApplication.Ge&&n.AFrameworkApplication.Ge.IsSynthetic&&(this.isSynthetic=ua.a.compare(n.AFrameworkApplication.Ge[Be.a.isSynthetic],"True",
!0)?!1:!0);this.ya.wt(this.Bk);this.oWd()}start(){this.ZWd=!0;this.resume()}stop(){this.ZWd=!1;this.pause()}dispose(){this.stop();this.wg.CVa(this.KI);n.AFrameworkApplication.y5f(this.cKf);n.AFrameworkApplication.z5f(this.dKf);Cd.a.Ma(this.wg);this.ya.ds(this.Bk);super.dispose()}j8j(ja,ia){const dc=ja in this.hma?this.hma[ja]:null;this.XIb=new Date;this.start();const od=this.XIb.getSeconds(),ae=od+this.Abk;dc&&od<=dc.end?(dc.count++,dc.end=ae):(dc&&od>dc.end&&this.tya.add(dc),this.hma[ja]=new Hf(ja,
1,od,ae,void 0,void 0,void 0,this.$.ea.gp.length,qd.a.instance.Gea(this.XIb),ia))}qrh(){this.y8a||(this.uld(new Date),this.y8a=new td(this.$))}resume(){this.hsf()||!this.ya.qR||this.isSynthetic||(this.Gcb=this.wg.Cj,this.IBa=new Date,this.oDd=this.IBa.getMinutes(),this.oWd(),this.UVe(this.IBa.getSeconds()),this.Utb=window.requestAnimationFrame(this.L7e))}hsf(){return 0<=this.Utb}pause(){this.hsf()&&(this.Gcb||(this.VVe((new Date).getSeconds()),x.ULS.sendTraceTag(21280654,0,50,`FPS : ${this.m1.toString()}`)),
window.cancelAnimationFrame(this.Utb),this.Utb=-1)}uld(ja){if(ja.getTime()-this.IBa.getTime()<Wf.RZi&&(this.Gcb&&this.VVe(this.IBa.getSeconds()),this.BGh(),0<this.tya.count&&(ja={},ja.NonEmptyCellsCount=this.ceb,ja.TextCellsCount=this.nJc,ja.xlfpsJson=Object(Ad.a)(new Fe,{f:this.tya.toArray()}),ja.memoryInfo=this.oZi(),ja.zoom=Ef.a(this.$)?Ef.a(this.$).zoom:1,ja.RibbonMode=xh.a(this.$)?Wg[xh.a(this.$).vR]:Wf.invalid,ja.deviceMemory=navigator.deviceMemory||0,ja.hardwareConcurrency=navigator.hardwareConcurrency||
0,ja=JSON.stringify(ja),x.ULS.sendTraceTag(537151044,0,50,`FPS : ${this.m1.toString()}`),!this.isSynthetic))){if(sb.a.Iha()){var ia={};ia.xlfpsJson=ja;this.$.Ira(Ce.a.atk,ia,!1)}else x.ULS.sendTraceTag(388781010,0,50,`${ja}`);for(let dc of this.tya){ia=1E3>=this.ceb?"0_1000":3E3>=this.ceb?"1000_3000":"3000_inf";const od=new Map;od.set("Operation",dc.Op);od.set("BucketOfRenderedCells",ia);Q.Health.instance.recordKpiUsage(na.a.longFrame,0,hf.a.canvas,od);0<dc.longFrameCount&&Q.Health.instance.recordKpiFailure(na.a.longFrame,
"LongFrame",!1,!0,Object(Ad.a)(new ra.a,{extendedProperties:od}));3E4<dc.tfAppInt&&(0<dc.longFrameCount?Kd.b().P7f(0,this.dWi,od):Kd.b().Q7f(0,od))}x.ULS.sendTraceTag(537151043,0,50,`Operations message length: ${ja.length}`)}this.reset()}oZi(){const ja={};if(window.performance){const ia=window.performance.memory;ia&&(ja.jsHeapSizeLimit=ia.jsHeapSizeLimit,ja.usedJSHeapSize=ia.usedJSHeapSize,ja.totalJSHeapSize=ia.totalJSHeapSize)}return ja}reset(){this.tya.clear();this.hma={};this.oWd()}BGh(){var ja=
!0;ja=void 0===ja?!0:ja;if(this.m1){for(const ia of Lf.a(this.hma)){const dc=this.hma[ia];dc.end=Math.min(this.m1.length-1,dc.end);this.tya.add(dc)}this.mdh(this.tya,this.m1,ja)}}mdh(ja,ia,dc){dc=void 0===dc?!0:dc;for(let od of ja){let ae=ja=0;if(od.end<ia.length){for(let Pe=od.start;Pe<=od.end;Pe++){const Xe=ia[Pe];0<=Xe&&(od.Max=Math.round(Math.max(od.Max,Xe)),od.Min=Math.round(Math.min(od.Min,Xe)),ja+=Xe,ae++)}0<ae&&(od.Avg=Math.round(ja/ae));dc&&this.y8a&&this.y8a.uHj(od.Op,od.Min,od.Max,od.LFrame?
od.LFrame.duration:-1);od.Props&&(this.Ogk(od),od.Props=null)}}dc&&this.y8a&&this.y8a.umk()}oWd(){this.m1=Array(60).fill(0)}UVe(ja){ja++;for(let ia=0;ia<ja;ia++)this.m1[ia]=Wf.Qdc}VVe(ja){for(;60>ja;ja++)this.m1[ja]=Wf.Qdc}rUi(ja,ia){ja=ja.getSeconds();var dc=Lf.a(this.hma);if(0<dc.length)for(const od of dc)if(dc=this.hma[od],ja>=dc.start&&ja<dc.end)dc.LFrame?dc.LFrame.duration<ia&&(dc.LFrame.startSecond=ja,dc.LFrame.duration=ia,dc.longFrameCount++):(dc.LFrame=new Se(ja,ia),dc.longFrameCount++)}amk(){this.nJc=
this.ceb=0;for(const ja of ud.h(this.$).Rq){const ia=ja.rZa;for(let dc in ia){const od=this.ya.wk(ia[dc].hashCode);if(null===od||void 0===od?0:od.Nl)this.ceb+=od.qg.NonEmptyCellsCount,this.nJc+=od.qg.TextValueCellsCount}}}Ogk(ja){const ia=ja.Props;if(fd.a.zTb in ia&&ia[fd.a.zTb]&&fd.a.pVb in ia){let dc;(dc=Object(ca.a)(gh.a,ia[fd.a.pVb]))&&dc.continueWith(od=>{Ya.TextEditorTelemetry.instance.qWg(ja.Op,ja.Min,!!ja.LFrame,ja.LFrame?ja.LFrame.duration:0,od.result)})}}}Wf.Qdc=-1;Wf.RZi=6E4;Wf.invalid=
"Invalid";Object(u.a)(Wf,"FramePerformanceTracker",ka.a,[433,5]);class Sg extends ab.a{constructor(ja){super();this.$=ja;this.Oe()}create(){let ja=this.$.ia.Ja(263);ja||(ja=this.$.ia.Va(263,new Wf(this.$)));this.ve(ja)}static la(ja){ja.ia.Va(264,new Sg(ja))}}Object(u.a)(Sg,"FramePerformanceTrackerFactory",ab.a,[]);var Ze=a(1206),kh=a(996);class Eg{Fi(ja,ia){return new kh.a(ja,ia)}xf(ja,ia){ja=this.Fi(ja,ia);ja.start();return ja}}Object(u.a)(Eg,"DefaultStopwatchBuilder",null,[154]);class th{constructor(){this.qua=
new Eg}Fi(ja,ia){return this.qua.Fi(ja,ia)}xf(ja,ia){return this.qua.xf(ja,ia)}}Object(u.a)(th,"StopwatchBuilder",null,[154]);var $h=a(353),zh=a(963),Pf=a(964),eh;(function(ja){ja[ja.actions=0]="actions";ja[ja.correlationStart=1]="correlationStart";ja[ja.reorderSheetOp=2]="reorderSheetOp";ja[ja.formatCellOp=3]="formatCellOp";ja[ja.copyOp=4]="copyOp";ja[ja.pasteOp=5]="pasteOp";ja[ja.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";ja[ja.instantaneousSetData=7]="instantaneousSetData";ja[ja.immediateSetData=
8]="immediateSetData";ja[ja.dependentCellsCalc=9]="dependentCellsCalc";ja[ja.dependentCellsGraphStat=10]="dependentCellsGraphStat";ja[ja.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";ja[ja.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";ja[ja.gridBlockUpdates=13]="gridBlockUpdates";ja[ja.browserAppStart=14]="browserAppStart";ja[ja.linkedObjects=15]="linkedObjects";ja[ja.longFrames=16]="longFrames";ja[ja.task=17]="task";ja[ja.conflictInEditing=18]="conflictInEditing";
ja[ja.incomingPresenceData=19]="incomingPresenceData";ja[ja.editorTableDelay=20]="editorTableDelay";ja[ja.presenceStartup=21]="presenceStartup";ja[ja.presenceDelete=22]="presenceDelete";ja[ja.editorEvent=23]="editorEvent";ja[ja.editorTime=24]="editorTime";ja[ja.gridScreenReaderOps=25]="gridScreenReaderOps";ja[ja.sendPresenceToService=26]="sendPresenceToService";ja[ja.IME=27]="IME";ja[ja.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";ja[ja.customizeStatusBar=29]="customizeStatusBar";ja[ja.clientWebRequests=
30]="clientWebRequests";ja[ja.showCommentTaskPane=31]="showCommentTaskPane";ja[ja.applyThreadedCommentChange=32]="applyThreadedCommentChange";ja[ja.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";ja[ja.findNextOrPreviousComment=34]="findNextOrPreviousComment";ja[ja.goto=35]="goto";ja[ja.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";ja[ja.richApiInvocation=37]="richApiInvocation";ja[ja.fxLibrary=38]="fxLibrary";ja[ja.embeddedApiSession=39]="embeddedApiSession";ja[ja.numberFormattingCalculator=
40]="numberFormattingCalculator";ja[ja.requestDataAfterSend=41]="requestDataAfterSend";ja[ja.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";ja[ja.copy=43]="copy";ja[ja.paste=44]="paste";ja[ja.dragDrop=45]="dragDrop";ja[ja.clearCopyState=46]="clearCopyState";ja[ja.webWorkerRecalcStats=47]="webWorkerRecalcStats";ja[ja.dataValidationEditOpenDialog=48]="dataValidationEditOpenDialog";ja[ja.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";ja[ja.customSort=50]="customSort";
ja[ja.namedSheetViewUserAction=51]="namedSheetViewUserAction";ja[ja.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";ja[ja.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";ja[ja.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";ja[ja.namedSheetViewTempViewSaveDialog=55]="namedSheetViewTempViewSaveDialog";ja[ja.temporaryViewStartedDataRestore=56]="temporaryViewStartedDataRestore";ja[ja.temporaryViewFetchedVersion=57]="temporaryViewFetchedVersion";ja[ja.raiseEventsAndGenerateBlockRequests=
58]="raiseEventsAndGenerateBlockRequests";ja[ja.launchMakerCodeEditor=59]="launchMakerCodeEditor"})(eh||(eh={}));Object(u.b)("UsageTable",eh);var kg=a(432),bh=a(483),jh=a(618),Ih=a(671),Oh=a(284);class Rh extends Sys.EventArgs{constructor(){super();this.l1i=0;this.operation="DOMUpdate";this.sender=this.target=null}}Object(u.a)(Rh,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,[]);class Jh{constructor(ja,ia){this.PXd=void 0===ia?1:ia;this.total=ja}get average(){return this.total/this.PXd}Pjh(ja){return new Jh(this.total+
ja.total,this.PXd+ja.PXd)}static hah(ja,ia){return`${ja}_${ia}`}}Object(u.a)(Jh,"StopwatchAverage",null,[]);var vg;(function(ja){ja[ja.longFrame=0]="longFrame";ja[ja.longGetRange=1]="longGetRange";ja[ja.longJsTask=2]="longJsTask";ja[ja.viewportCalculationLoops=3]="viewportCalculationLoops"})(vg||(vg={}));Object(u.b)("UtrKpiVeto",vg);class Og{static V9a(ja){return Enum.toString(vg,ja)}}Og.sGa="UTR";Object(u.a)(Og,"KpiConstants",null,[]);class wg{}wg.qxg="UTRVetoName";wg.ixg="UTRErrorName";wg.mxg="UTROperationName";
wg.cMc="UTRDuration";wg.oxg="UTREndedInPhase";wg.h$d="UTRMessage";wg.pxg="UtrUnavailabilityType";wg.operationName="OperationName";wg.duration="Duration";wg.message="Message";Object(u.a)(wg,"UtrAdditionalData",null,[]);class cg{}cg.Sqk="VetoLike";cg.TXe="E2EOperationPerf";cg.YHj="RequestPerf";cg.Lhk="UnavailabilityDurations";Object(u.a)(cg,"UtrTypes",null,[]);class Pg{DQb(ja,ia,dc){dc=void 0===dc?null:dc;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(dc=dc?Object(Ad.a)(new ra.a,
{extendedProperties:dc}):null,ja=Og.V9a(ja),Q.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+ja,ia,!1,!0,"",dc))}nSb(ja,ia,dc,od,ae,Pe){Pe[Og.sGa]=cg.Sqk;Pe[wg.qxg]=Og.V9a(od);Pe[wg.ixg]=ae;x.ULS.sendTraceTag(ja,ia,dc,Qc.a.ff(Pe));delete Pe[Og.sGa];delete Pe[wg.qxg];delete Pe[wg.ixg]}}Object(u.a)(Pg,"UtrKpiVetoReporter",null,[]);class sh{IQb(ja,ia){ia=void 0===ia?null:ia;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Q.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+
Og.V9a(ja),0,"",ia)}DQb(ja,ia,dc){dc=void 0===dc?null:dc;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(ja=Og.V9a(ja),Q.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+ja,ia,!1,!0,this.Gcd(dc)))}hHj(ja,ia){ia=void 0===ia?null:ia;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Q.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+Og.V9a(ja),"",this.Gcd(ia))}gHj(ja,ia,dc){dc=void 0===dc?null:dc;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||
(ja=Og.V9a(ja),Q.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+ja,ia,!1,!0,"",this.Gcd(dc)))}Gcd(ja){return ja?Object(Ad.a)(new ra.a,{extendedProperties:ja}):null}}Object(u.a)(sh,"UtrKpiVetoUsageReporter",null,[]);class ji{FCc(ja,ia,dc){dc=void 0===dc?null:dc;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Q.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+ja,"",Object(Ad.a)(new ra.a,{extendedProperties:dc,durationMs:ia}))}MCc(ja,ia,dc){dc=void 0===
dc?null:dc;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(ia?Q.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+ja,"",Object(Ad.a)(new ra.a,{extendedProperties:dc})):Q.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+ja,"",!1,!1,"",Object(Ad.a)(new ra.a,{extendedProperties:dc})))}kSb(ja,ia,dc,od,ae,Pe,Xe,...vf){Xe=String.format(Xe,...vf);vf={};vf[Og.sGa]=cg.TXe;vf[wg.mxg]=od;vf[wg.oxg]=ae;vf[wg.cMc]=Pe;vf[wg.h$d]=Xe;x.ULS.sendTraceTag(ja,ia,dc,Qc.a.ff(vf))}GEc(ja,
ia,dc,od,ae,Pe,Xe){const vf={};vf[Og.sGa]=cg.TXe;vf[wg.mxg]=od;vf[wg.oxg]=ae;vf[wg.cMc]=Pe;vf[wg.h$d]=Xe;x.ULS.sendTraceTag(ja,ia,dc,Qc.a.ff(vf))}mSb(ja,ia,dc,od,ae,Pe){this.zgg(Pe,od,ae);x.ULS.sendTraceTag(ja,ia,dc,Qc.a.ff(Pe));this.ezh(Pe)}lSb(ja,ia,dc,od,ae,Pe,...Xe){Pe=String.format(Pe,...Xe);Xe={};this.zgg(Xe,od,ae,Pe);x.ULS.sendTraceTag(ja,ia,dc,Qc.a.ff(Xe))}HEc(ja,ia,dc,od){od[Og.sGa]=cg.YHj;x.ULS.sendTraceTag(ja,ia,dc,Qc.a.ff(od));delete od[Og.sGa]}zgg(ja,ia,dc,od){od=void 0===od?null:od;
ja[Og.sGa]=cg.Lhk;ja[wg.pxg]=ia;ja[wg.cMc]=dc;od&&(ja[wg.h$d]=od)}ezh(ja){delete ja[Og.sGa];delete ja[wg.pxg];delete ja[wg.cMc]}}Object(u.a)(ji,"UtrOperationPerfReporter",null,[]);class $f extends ef.a{constructor(ja,ia,dc,od,ae,Pe){dc=void 0===dc?null:dc;od=void 0===od?null:od;ae=void 0===ae?null:ae;Pe=void 0===Pe?!1:Pe;super();this.PRh=[fd.a.fHe,fd.a.J_e,fd.a.K_e,fd.a.fnc,fd.a.etc,fd.a.qSi,fd.a.renderCachedContent,fd.a.renderServerContent,fd.a.bcc,fd.a.NMj,fd.a.ebg,fd.a.fbg,fd.a.AQj];this.$qb=this.zHa=
this.QWb=this.Blb=this.vne=this.lGe=this.i1a=this.yue=null;this.XWf=this.dHe=!1;this.lxg=this.kxg=this.nxg=this.aWd=this.Dyg=null;this.xKi=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:7971370_ResourceTimingFontStatus");this.cSf=(Xe,vf)=>{for(Xe=0;Xe<vf.entries.length;Xe++){const yg=vf.entries[Xe];yg.url=D.a.removeParameter(yg.url,n.AFrameworkApplication.tP);var Sf=D.a.p4(yg.url);!ba.EwaSettings.Fa(426)&&this.mKi(yg.url,Sf)&&(yg.behavior=1);if("img"===yg.Zt.initiatorType&&Sf.endsWith(zh.a.Vgd)){var xf=
D.a.H8(yg.url,zh.a.Ugd),Jg=D.a.H8(yg.url,zh.a.Wgd);yg.IX=`${yg.IX}imageID=${xf}, imgStateID=${Jg}`}this.xKi&&"css"===yg.Zt.initiatorType&&"responseStatus"in yg.Zt&&(xf=`responseStatus=${yg.Zt.Vyk}`,yg.IX=yg.IX?`${yg.IX},${xf}`:xf);xf=yg.Zt.transferSize;let Xf;Jg=yg.Zt.decodedBodySize;void 0!==xf&&null!==xf&&void 0!==Jg&&null!==Jg?Xf=0===xf&&0<Jg:void 0!==xf&&null!==xf&&(Xf=0===xf);qd.a.instance.uXg(Sf,Math.round(yg.Zt.fetchStart),Math.round(yg.Zt.responseEnd),Xf,this.ZLi);ua.a.contains(Sf,fd.a.richTextEditor,
!0)&&(Sf=Ya.TextEditorTelemetry.instance,Sf.sH(fd.a.xJj,Math.round(yg.Zt.fetchStart)),Sf.sH(fd.a.zJj,Math.round(yg.Zt.responseEnd)))}};this.KI=()=>{const Xe=this.Naa;for(let vf in Xe)Xe[vf].h=!0};this.userSessionId=ja;this.S5a=dc=dc||new jh.a;this.ik=od||Qd.a.Jd;this.f9j=ae||this;this.ZLi=Pe;this.cUe=dc.wdb();ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",!1)?void Tc.a.resolve(ub.W).then(Xe=>{this.wg=Xe;this.wg.T0(this.KI)}):(this.wg=new Cb,
this.wg.T0(this.KI),ia.Va(291,this.wg))}get Naa(){return this.yue||(this.yue={})}get gTe(){return this.Blb||this.cUe}get rTe(){return this.zHa||$f.eIf}get z4d(){return this.lGe=this.lGe||{}}get Yyc(){return this.i1a||"undefined"===typeof Stw?this.i1a:this.i1a=Stw.swpc}get UCf(){return this.vne=this.vne||{}}get iEa(){return this.$qb||(this.$qb=Nb.a.instance.ie("Common.NetworkTiming.IResourceTimingLogger"))}get jxg(){return this.kxg||(this.kxg=new Pg)}get kZa(){return this.nxg||(this.nxg=new ji)}get dMc(){return this.lxg||
(this.lxg=new sh)}VHc(ja,ia,dc,od,ae){ae=void 0===ae?null:ae;if(this.Naa[dc])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.Naa[dc]=this.BSe(ja,ia,dc,od,ae)}afc(ja,ia){const dc=this.Naa[ja];dc&&(this.eOe(dc,ia),this.Jjk(dc),delete this.Naa[ja])}n5f(ja){delete this.Naa[ja]}Dmg(ja,ia){this.Blb||this.rmg(ja,ia)}mmg(){this.Dmg($f.Osd,this.ik.Og)}sZe(ja,ia){ia=void 0===ia?!1:ia;if(this.Blb){if(this.zHa===$f.LNd||this.zHa===$f.Osd){const dc=J.a.instance;dc.userSessionId=
this.userSessionId;if(this.zHa===$f.LNd){this.dHe||(this.wpa(ja.m,Object(Oa.a)(dc,dc.Wwj,"recordContentFetchEnd")),this.dHe=!0);if(ia){this.XWf||(this.wpa(ja.m,Object(Oa.a)(dc,dc.hxj,"recordPerceivedContentDisplayed")),this.XWf=!0);return}this.wpa(ja.m,Object(Oa.a)(dc,dc.Vwj,"recordContentDisplayed"))}else this.zHa===$f.Osd&&(ia=this.Naa[this.QWb])&&this.wpa(Oh.a(ja,ia.s),Object(Oa.a)(dc,dc.cxj,"recordInteractivityContentDisplayed"),!1)}this.afc(this.QWb,ja);this.QWb=this.zHa=this.Blb=null}}wpa(ja,
ia,dc){dc=void 0===dc?!0:dc;J.a.h1&&Object($h.a)(Ih.PerformanceClock,Qd.a.Jd)&&dc&&(ja+=window.performance.timing.navigationStart);ia(ja)}Tl(ja){return kg.a(ja)}Ih(ja,ia,dc){dc=void 0===dc?!1:dc;try{if(this.UCf[eh[ja]]=!0,dc){var od=x.ULS,ae=od.sendTraceTag;const pd={};let Mg=null;switch(ja){case 0:Mg="Actions";var Pe=ia.a;null!=Pe&&(pd.Id=Pe);var Xe=null==ia.b?null:ia.b;null!=Xe&&(pd.Operation=Xe);var vf=ia.c;null!=vf&&(pd.Target=vf);var Sf=null==ia.d?null:ia.d.toString();null!=Sf&&(pd.StartTime=
Sf);var xf=null==ia.e?null:ia.e.toString();null!=xf&&(pd.Duration=xf);var Jg=ia.f;null!=Jg&&(pd.CorrelationId=Jg);var yg=ia.g;null!=yg&&(pd.ParentAction=yg);var Xf=null==ia.h?null:ia.h.toString();null!=Xf&&(pd.DocumentHidden=Xf);break;case 1:Mg="CorrelationStart";var Lg=ia.a;null!=Lg&&(pd.CorrelationId=Lg);var lg=ia.b;null!=lg&&(pd.UserSessionId=lg);var Kf=ia.c;null!=Kf&&(pd.UserAction=Kf);break;case 2:Mg="ReorderSheetOp";var Dh=ia.a;null!=Dh&&(pd.UserSessionId=Dh);var hh=null==ia.b?null:ia.b.toString();
null!=hh&&(pd.IsDragReorder=hh);var Da=null==ia.c?null:ia.c.toString();null!=Da&&(pd.DocumentUp=Da);var Lb=null==ia.d?null:ia.d.toString();null!=Lb&&(pd.OldIndex=Lb);var rc=null==ia.e?null:ia.e.toString();null!=rc&&(pd.NewIndex=rc);var zc=null==ia.f?null:ia.f.toString();null!=zc&&(pd.TotalSheets=zc);break;case 3:Mg="FormatCellOp";var zd=ia.a;null!=zd&&(pd.UserSessionId=zd);var Wd=null==ia.b?null:ia.b.toString();null!=Wd&&(pd.TaskId=Wd);var we=null==ia.c?null:ia.c.toString();null!=we&&(pd.NumberOfRanges=
we);var He=ia.d;null!=He&&(pd.Ranges=He);var jf=ia.e;null!=jf&&(pd.ActiveCell=jf);var yf=null==ia.f?null:ia.f.toString();null!=yf&&(pd.ActionId=yf);var pg=ia.g;null!=pg&&(pd.CommandParameters=pg);var gg=ia.h;null!=gg&&(pd.UserActionStopwatchId=gg);break;case 4:Mg="CopyOp";var Xg=ia.a;null!=Xg&&(pd.UserSessionId=Xg);var aa=null==ia.b?null:ia.b.toString();null!=aa&&(pd.IsChrome=aa);var Va=null==ia.c?null:ia.c.toString();null!=Va&&(pd.IsIE=Va);var hc=null==ia.d?null:ia.d.toString();null!=hc&&(pd.IsFromUI=
hc);var Bc=null==ia.e?null:ia.e.toString();null!=Bc&&(pd.IsCopyInLoadedRange=Bc);var Td=null==ia.f?null:ia.f.toString();null!=Td&&(pd.IsRepeatedCopy=Td);var V=null==ia.g?null:ia.g.toString();null!=V&&(pd.IsClipboarAccessSupported=V);var bb=null==ia.h?null:ia.h.toString();null!=bb&&(pd.IsClipboarAccessInstallationSupported=bb);var gc=null==ia.i?null:ia.i.toString();null!=gc&&(pd.RibbonCommand=gc);var xc=null==ia.j?null:ia.j.toString();null!=xc&&(pd.CutCopyPasteFlags=xc);var Gd=null==ia.k?null:ia.k.toString();
null!=Gd&&(pd.IsDrag=Gd);var pe=null==ia.l?null:ia.l.toString();null!=pe&&(pd.IsIeBeforeAlowDenyPopUp=pe);var Ne=ia.m;null!=Ne&&(pd.IsPasteMatchCopy=Ne);var We=ia.n;null!=We&&(pd.WaitMessageInClipboard=We);var pf=null==ia.o?null:ia.o.toString();null!=pf&&(pd.CallCount=pf);break;case 5:Mg="PasteOp";var Af=ia.a;null!=Af&&(pd.UserSessionId=Af);var xg=null==ia.b?null:ia.b.toString();null!=xg&&(pd.IsChrome=xg);var lh=null==ia.c?null:ia.c.toString();null!=lh&&(pd.IsIE=lh);var ng=null==ia.d?null:ia.d.toString();
null!=ng&&(pd.IsCopyActive=ng);var sg=null==ia.e?null:ia.e.toString();null!=sg&&(pd.IsFromUI=sg);var fh=null==ia.f?null:ia.f.toString();null!=fh&&(pd.IsClipboarAccessSupported=fh);var Ig=null==ia.g?null:ia.g.toString();null!=Ig&&(pd.IsClipboarAccessInstallationSupported=Ig);var Uf=null==ia.h?null:ia.h.toString();null!=Uf&&(pd.RibbonCommand=Uf);var Di=null==ia.i?null:ia.i.toString();null!=Di&&(pd.CutCopyPasteFlags=Di);var Ei=ia.j;null!=Ei&&(pd.WaitMessageInClipboard=Ei);var Xi=ia.k;null!=Xi&&(pd.PopupDialog=
Xi);var Ki=ia.l;null!=Ki&&(pd.SimplePopupMessage=Ki);var Pi=ia.m;null!=Pi&&(pd.DialogCloseButton=Pi);var lj=ia.n;null!=lj&&(pd.UserPressedInstallLink=lj);var uh=null==ia.o?null:ia.o.toString();null!=uh&&(pd.CallCount=uh);break;case 6:Mg="GetNumberViewModelDataOp";var ej=ia.a;null!=ej&&(pd.UserSessionId=ej);var ki=ia.b;null!=ki&&(pd.NumberFormatOptionsPreviousOutputJson=ki);var Gi=ia.c;null!=Gi&&(pd.NumberFormatOptionsNewInputJson=Gi);break;case 7:Mg="InstantaneousSetData";var ai=ia.a;null!=ai&&(pd.Id=
ai);var $g=null==ia.b?null:ia.b.toString();null!=$g&&(pd.WasEmpty=$g);var ei=null==ia.c?null:ia.c.toString();null!=ei&&(pd.ValueNotChanged=ei);var gi=ia.d;null!=gi&&(pd.Source=gi);var Vh=null==ia.e?null:ia.e.toString();null!=Vh&&(pd.ProcessingCompleted=Vh);break;case 8:Mg="ImmediateSetData";var lf=ia.a;null!=lf&&(pd.ClientStopwatchId=lf);var E=ia.b;null!=E&&(pd.Operation=E);var da=ia.c;null!=da&&(pd.Parameters=da);var Ha=null==ia.d?null:ia.d.toString();null!=Ha&&(pd.WasUpdatedByImmediate=Ha);var Fb=
null==ia.e?null:ia.e.toString();null!=Fb&&(pd.areHtmlElementsEqualClientComparison=Fb);var bc=null==ia.f?null:ia.f.toString();null!=bc&&(pd.WasDecisionMadeByHtmlComparison=bc);var Vc=null==ia.g?null:ia.g.toString();null!=Vc&&(pd.IsNumeric=Vc);var Sc=null==ia.h?null:ia.h.toString();null!=Sc&&(pd.IsDateTime=Sc);var wd=null==ia.i?null:ia.i.toString();null!=wd&&(pd.HasCurrencySymbol=wd);var md=null==ia.j?null:ia.j.toString();null!=md&&(pd.HasPercentSymbol=md);var Ld=null==ia.k?null:ia.k.toString();null!=
Ld&&(pd.IsFunc=Ld);var oe=null==ia.l?null:ia.l.toString();null!=oe&&(pd.DiffInWrappingWhitespace=oe);var Qe=ia.m;null!=Qe&&(pd.ImmediatePattern=Qe);var cf=null==ia.n?null:ia.n.toString();null!=cf&&(pd.TextAlignmentMatch=cf);var sf=null==ia.o?null:ia.o.toString();null!=sf&&(pd.FontColorMatch=sf);var wf=null==ia.p?null:ia.p.toString();null!=wf&&(pd.FormulaTextMatch=wf);var Gf=null==ia.q?null:ia.q.toString();null!=Gf&&(pd.isFormula=Gf);var ld=ia.r;null!=ld&&(pd.FormulaText=ld);var de=ia.s;null!=de&&
(pd.InstantaneousPattern=de);var ug=null==ia.t?null:ia.t.toString();null!=ug&&(pd.AreHtmlInnerTextElementsEqualClientComparison=ug);var Zf=ia.u;null!=Zf&&(pd.HtmlComparisonDecision=Zf);break;case 9:Mg="DependentCellsCalc";var ag=ia.a;null!=ag&&(pd.CalcStatus=ag);var Rf=null==ia.b?null:ia.b.toString();null!=Rf&&(pd.SuccessfullyCalculatedRanges=Rf);var Cg=null==ia.c?null:ia.c.toString();null!=Cg&&(pd.RangesSkipped=Cg);var Yg=null==ia.d?null:ia.d.toString();null!=Yg&&(pd.TotalErrors=Yg);var Ng=null==
ia.e?null:ia.e.toString();null!=Ng&&(pd.Partial=Ng);var Zg=null==ia.f?null:ia.f.toString();null!=Zg&&(pd.Canceled=Zg);var Zh=null==ia.g?null:ia.g.toString();null!=Zh&&(pd.Aggregate=Zh);var Vg=null==ia.h?null:ia.h.toString();null!=Vg&&(pd.Unknown=Vg);var di=null==ia.i?null:ia.i.toString();null!=di&&(pd.UnavailableData=di);var Uh=null==ia.j?null:ia.j.toString();null!=Uh&&(pd.Cycle=Uh);var Wi=null==ia.k?null:ia.k.toString();null!=Wi&&(pd.NotImplemented=Wi);var qg=null==ia.l?null:ia.l.toString();null!=
qg&&(pd.InvalidInput=qg);var wh=null==ia.m?null:ia.m.toString();null!=wh&&(pd.AreDepCells=wh);break;case 10:Mg="DependentCellsGraphStat";var ii=null==ia.a?null:ia.a.toString();null!=ii&&(pd.ParsedFormulas=ii);var vj=null==ia.b?null:ia.b.toString();null!=vj&&(pd.GraphNodes=vj);var wi=null==ia.c?null:ia.c.toString();null!=wi&&(pd.GraphArcs=wi);var mh=null==ia.d?null:ia.d.toString();null!=mh&&(pd.AnalyzedBlocks=mh);var Ri=null==ia.e?null:ia.e.toString();null!=Ri&&(pd.IterationId=Ri);var Kg=ia.f;null!=
Kg&&(pd.UniqueId=Kg);var Ui=null==ia.g?null:ia.g.toString();null!=Ui&&(pd.Aborted=Ui);break;case 11:Mg="DependentCellsGraphSectionStat";var pi=null==ia.a?null:ia.a.toString();null!=pi&&(pd.IterationId=pi);var ci=ia.b;null!=ci&&(pd.BlockHash=ci);var jg=ia.c;null!=jg&&(pd.Functions=jg);var Fh=ia.d;null!=Fh&&(pd.Operators=Fh);var xi=null==ia.e?null:ia.e.toString();null!=xi&&(pd.CrossDocRefs=xi);var Sh=null==ia.f?null:ia.f.toString();null!=Sh&&(pd.CrossSheetRefs=Sh);var Ai=null==ia.g?null:ia.g.toString();
null!=Ai&&(pd.ErrRefs=Ai);var qi=null==ia.h?null:ia.h.toString();null!=qi&&(pd.LargeRanges=qi);var yh=null==ia.i?null:ia.i.toString();null!=yh&&(pd.NameRefs=yh);var li=null==ia.j?null:ia.j.toString();null!=li&&(pd.ParserErrors=li);var Ph=null==ia.k?null:ia.k.toString();null!=Ph&&(pd.RowRefs=Ph);var mi=null==ia.l?null:ia.l.toString();null!=mi&&(pd.ColumnRefs=mi);var Yi=null==ia.m?null:ia.m.toString();null!=Yi&&(pd.TableRefs=Yi);var pj=ia.n;null!=pj&&(pd.UniqueId=pj);var Aj=null==ia.o?null:ia.o.toString();
null!=Aj&&(pd.UnreachableReferences=Aj);break;case 12:Mg="GetRangeContentPrefetchFailures";var Bj=ia.a;null!=Bj&&(pd.UserSessionId=Bj);var Cj=ia.b;null!=Cj&&(pd.ClientStopwatchId=Cj);var ih=null==ia.c?null:ia.c.toString();null!=ih&&(pd.StateId=ih);break;case 13:Mg="GridBlockUpdates";var Mh=ia.a;null!=Mh&&(pd.UserSessionId=Mh);var mj=ia.b;null!=mj&&(pd.CorrelationId=mj);var Bi=ia.c;null!=Bi&&(pd.Operation=Bi);var Gj=null==ia.d?null:ia.d.toString();null!=Gj&&(pd.PerformanceType=Gj);var Ni=ia.e;null!=
Ni&&(pd.BlockHash=Ni);var qj=null==ia.f?null:ia.f.toString();null!=qj&&(pd.DurationInMs=qj);break;case 14:Mg="BrowserAppStart";var fj=null==ia.a?null:Pf.a.nxa(ia.a.getTime());null!=fj&&(pd.ScriptExecutionStart=fj);var Dj=ia.b;null!=Dj&&(pd.UserSessionId=Dj);var gj=ia.c;null!=gj&&(pd.ClockMechanism=gj);var hj=null==ia.d?null:ia.d.toString();null!=hj&&(pd.ScreenDPI=hj);var ij=null==ia.e?null:ia.e.toString();null!=ij&&(pd.NavigationToScriptExecutionDelta=ij);break;case 15:Mg="LinkedObjects";var Th=ia.a;
null!=Th&&(pd.ChildId=Th);var nj=ia.b;null!=nj&&(pd.ParentId=nj);var ph=ia.c;null!=ph&&(pd.ChildTable=ph);var Zi=ia.d;null!=Zi&&(pd.ParentTable=Zi);break;case 16:Mg="LongFrames";var Hi=null==ia.a?null:Pf.a.nxa(ia.a.getTime());null!=Hi&&(pd.StartTime=Hi);var Ii=null==ia.b?null:ia.b.toString();null!=Ii&&(pd.DurationInMs=Ii);break;case 17:Mg="Task";var Oi=ia.a;null!=Oi&&(pd.StopwatchId=Oi);var yi=null==ia.b?null:ia.b.toString();null!=yi&&(pd.Status=yi);var sj=null==ia.c?null:ia.c.toString();null!=sj&&
(pd.CreateTime=sj);var Ci=null==ia.d?null:ia.d.toString();null!=Ci&&(pd.TaskId=Ci);break;case 18:Mg="ConflictInEditing";var $i=ia.a;null!=$i&&(pd.OtherUserState=$i);var Gh=ia.b;null!=Gh&&(pd.UserSessionId=Gh);var Hj=null==ia.c?null:Pf.a.nxa(ia.c.getTime());null!=Hj&&(pd.ConflictTime=Hj);break;case 19:Mg="IncomingPresenceData";var Fi=ia.a;null!=Fi&&(pd.UserSessionId=Fi);var Si=ia.b;null!=Si&&(pd.UserId=Si);var tj=null==ia.c?null:ia.c.toString();null!=tj&&(pd.Disconnected=tj);var uj=null==ia.d?null:
Pf.a.nxa(ia.d.getTime());null!=uj&&(pd.ReceivedTime=uj);break;case 20:Mg="EditorTableDelay";var aj=ia.a;null!=aj&&(pd.UserSessionId=aj);var ri=ia.b;null!=ri&&(pd.UserId=ri);var Nh=null==ia.c?null:ia.c.toString();null!=Nh&&(pd.Received=Nh);var Xh=null==ia.d?null:ia.d.toString();null!=Xh&&(pd.DurationInMs=Xh);var bj=null==ia.e?null:ia.e.toString();null!=bj&&(pd.NotAloneAtLogTime=bj);var jj=null==ia.f?null:Pf.a.nxa(ia.f.getTime());null!=jj&&(pd.Time=jj);break;case 21:Mg="PresenceStartup";var C=ia.a;
null!=C&&(pd.UserSessionId=C);var ea=null==ia.b?null:ia.b.toString();null!=ea&&(pd.EverReceived=ea);var Ta=null==ia.c?null:ia.c.toString();null!=Ta&&(pd.NotAloneOnOpen=Ta);var Yb=null==ia.d?null:ia.d.toString();null!=Yb&&(pd.NotAloneAtLogTime=Yb);var wc=null==ia.e?null:ia.e.toString();null!=wc&&(pd.EditorCount=wc);var Hc=null==ia.f?null:ia.f.toString();null!=Hc&&(pd.WorkbookOpenToFirstReceivedInMs=Hc);break;case 22:Mg="PresenceDelete";var rd=ia.a;null!=rd&&(pd.UserSessionId=rd);var ce=ia.b;null!=
ce&&(pd.UserId=ce);var Le=ia.c;null!=Le&&(pd.Context=Le);var Ue=ia.d;null!=Ue&&(pd.Reason=Ue);var mf=null==ia.e?null:Pf.a.nxa(ia.e.getTime());null!=mf&&(pd.Time=mf);break;case 23:Mg="EditorEvent";var rf=ia.a;null!=rf&&(pd.UserSessionId=rf);var Of=ia.b;null!=Of&&(pd.UserId=Of);var Ag=ia.c;null!=Ag&&(pd.Context=Ag);var tg=null==ia.d?null:Pf.a.nxa(ia.d.getTime());null!=tg&&(pd.Time=tg);break;case 24:Mg="EditorTime";var mg=ia.a;null!=mg&&(pd.UserSessionId=mg);var O=ia.b;null!=O&&(pd.UserId=O);var Qa=
null==ia.c?null:ia.c.toString();null!=Qa&&(pd.DurationInMs=Qa);break;case 25:Mg="GridScreenReaderOps";var mb=ia.a;null!=mb&&(pd.UserSessionId=mb);var mc=ia.b;null!=mc&&(pd.CommandTaskId=mc);var Ac=null==ia.c?null:ia.c.toString();null!=Ac&&(pd.CommandId=Ac);var sd=null==ia.d?null:ia.d.toString();null!=sd&&(pd.ClientSideOnly=sd);var yd=null==ia.e?null:ia.e.toString();null!=yd&&(pd.DurationInMS=yd);var Od=null==ia.f?null:ia.f.toString();null!=Od&&(pd.ReachedMaxReadoutCells=Od);var Uc=null==ia.g?null:
ia.g.toString();null!=Uc&&(pd.RequstedCellCount=Uc);var Dd=null==ia.h?null:ia.h.toString();null!=Dd&&(pd.NonEmptyCellCount=Dd);var ye=null==ia.i?null:ia.i.toString();null!=ye&&(pd.Succeeded=ye);var ie=null==ia.j?null:ia.j.toString();null!=ie&&(pd.Canceled=ie);var ze=ia.k;null!=ze&&(pd.ErrorType=ze);break;case 26:Mg="SendPresenceToService";var Ye=ia.a;null!=Ye&&(pd.UserSessionId=Ye);var tf=null==ia.b?null:ia.b.toString();null!=tf&&(pd.TotalCount=tf);var Qf=null==ia.c?null:ia.c.toString();null!=Qf&&
(pd.SendCount=Qf);break;case 27:Mg="IME";var ig=ia.a;null!=ig&&(pd.UserSessionId=ig);break;case 28:Mg="FreezePaneFloatingObjects";var df=ia.a;null!=df&&(pd.UserSessionId=df);var Nf=null==ia.b?null:ia.b.toString();null!=Nf&&(pd.ObjectType=Nf);var Mf=ia.c;null!=Mf&&(pd.ObjectID=Mf);var Qg=null==ia.d?null:ia.d.toString();null!=Qg&&(pd.SpannedPanesCount=Qg);break;case 29:Mg="CustomizeStatusBar";var Tg=ia.a;null!=Tg&&(pd.UserSessionId=Tg);var Bh=ia.b;null!=Bh&&(pd.UIControlName=Bh);var bi=null==ia.c?null:
ia.c.toString();null!=bi&&(pd.IsControlVisible=bi);break;case 30:Mg="ClientWebRequests";var ni=ia.a;null!=ni&&(pd.Path=ni);var Kh=ia.b;null!=Kh&&(pd.ProxyStopwatchId=Kh);var hi=ia.c;null!=hi&&(pd.RequestStatus=hi);var Gg=null==ia.d?null:ia.d.toString();null!=Gg&&(pd.ResponseSizeInBytes=Gg);var ti=ia.e;null!=ti&&(pd.ClientRequestId=ti);var Ah=null==ia.f?null:ia.f.toString();null!=Ah&&(pd.StateId=Ah);break;case 31:Mg="ShowCommentTaskPane";var If=ia.a;null!=If&&(pd.UserSessionId=If);var dg=null==ia.b?
null:ia.b.toString();null!=dg&&(pd.IsFromKeyboardShortcut=dg);var Dg=null==ia.c?null:ia.c.toString();null!=Dg&&(pd.IsShowPane=Dg);var Yf=null==ia.d?null:ia.d.toString();null!=Yf&&(pd.ShowForDeepLink=Yf);var zg=null==ia.e?null:ia.e.toString();null!=zg&&(pd.DeepLinkFound=zg);break;case 32:Mg="ApplyThreadedCommentChange";var hg=ia.a;null!=hg&&(pd.UserSessionId=hg);var Fg=null==ia.b?null:ia.b.toString();null!=Fg&&(pd.Operation=Fg);var Hh=ia.c;null!=Hh&&(pd.CommentId=Hh);var Wh=null==ia.d?null:ia.d.toString();
null!=Wh&&(pd.CommentsCount=Wh);break;case 33:Mg="UpgradeLegacyCommentsChange";var Li=ia.a;null!=Li&&(pd.UserSessionId=Li);var zi=null==ia.b?null:ia.b.toString();null!=zi&&(pd.OperationSuccessful=zi);break;case 34:Mg="FindNextOrPreviousComment";var Lh=ia.a;null!=Lh&&(pd.UserSessionId=Lh);var oi=null==ia.b?null:ia.b.toString();null!=oi&&(pd.Succeeded=oi);break;case 35:Mg="Goto";var Qi=ia.a;null!=Qi&&(pd.UserSessionId=Qi);var oh=null==ia.b?null:ia.b.toString();null!=oh&&(pd.IsSucceeded=oh);var Eh=null==
ia.c?null:ia.c.toString();null!=Eh&&(pd.IsNOVMode=Eh);break;case 36:Mg="LaunchOfficeAddInDialog";var Hg=ia.a;null!=Hg&&(pd.UserSessionId=Hg);var Rg=ia.b;null!=Rg&&(pd.SourceId=Rg);var fi=ia.c;null!=fi&&(pd.SourceLabel=fi);var ui=ia.d;null!=ui&&(pd.Flight=ui);var Mi=ia.e;null!=Mi&&(pd.Experiment=Mi);var Ti=ia.f;null!=Ti&&(pd.UICultureTag=Ti);var vi=null==ia.g?null:ia.g.toString();null!=vi&&(pd.UICultureTagLcid=vi);var Sj=null==ia.h?null:ia.h.toString();null!=Sj&&(pd.WacHostId=Sj);break;case 37:Mg=
"RichApiInvocation";var Ej=ia.a;null!=Ej&&(pd.UserSessionId=Ej);var wj=null==ia.b?null:ia.b.toString();null!=wj&&(pd.Succeeded=wj);var kj=ia.c;null!=kj&&(pd.ErrorType=kj);var Tj=ia.d;null!=Tj&&(pd.ResultInfo=Tj);var xj=ia.e;null!=xj&&(pd.Source=xj);break;case 38:Mg="FxLibrary";var bk=ia.a;null!=bk&&(pd.EntityName=bk);var ck=null==ia.b?null:ia.b.toString();null!=ck&&(pd.EntryPoint=ck);var dk=null==ia.c?null:ia.c.toString();null!=dk&&(pd.Action=dk);var Ij=null==ia.d?null:ia.d.toString();null!=Ij&&(pd.InsertLocation=
Ij);break;case 39:Mg="EmbeddedApiSession";var ik=ia.a;null!=ik&&(pd.UserSessionId=ik);break;case 40:Mg="NumberFormattingCalculator";var jk=ia.a;null!=jk&&(pd.Id=jk);var kk=ia.b;null!=kk&&(pd.CounterName=kk);var rj=ia.c;null!=rj&&(pd.Values=rj);break;case 41:Mg="RequestDataAfterSend";var tk=ia.a;null!=tk&&(pd.ClientStopwatchId=tk);var ek=ia.b;null!=ek&&(pd.RequestStatus=ek);var lk=null==ia.c?null:ia.c.toString();null!=lk&&(pd.SendDuration=lk);var Uj=null==ia.d?null:ia.d.toString();null!=Uj&&(pd.RequestId=
Uj);break;case 42:Mg="FloatingObjectsStopwatchData";var Mj=ia.a;null!=Mj&&(pd.StopMessage=Mj);var uk=null==ia.b?null:ia.b.toString();null!=uk&&(pd.Type=uk);var fk=ia.c;null!=fk&&(pd.GUID=fk);var Jj=null==ia.d?null:ia.d.toString();null!=Jj&&(pd.Pane=Jj);var Nj=null==ia.e?null:ia.e.toString();null!=Nj&&(pd.IsAboveGrid=Nj);var mk=ia.f;null!=mk&&(pd.StartCorrelation=mk);var Vj=ia.g;null!=Vj&&(pd.LoadImageCorrelation=Vj);var Wj=null==ia.h?null:ia.h.toString();null!=Wj&&(pd.SkippedGetEffectsExtents=Wj);
var nk=null==ia.i?null:ia.i.toString();null!=nk&&(pd.Version=nk);break;case 43:Mg="Copy";var Xj=ia.a;null!=Xj&&(pd.UserSessionId=Xj);var Pj=ia.b;null!=Pj&&(pd.Trigger=Pj);var Yj=ia.c;null!=Yj&&(pd.RibbonCommandName=Yj);var Qj=ia.d;null!=Qj&&(pd.SourceItem=Qj);var ok=null==ia.e?null:ia.e.toString();null!=ok&&(pd.SourceRangeCellCount=ok);var gk=ia.f;null!=gk&&(pd.ClientSideStopwatchId=gk);var hk=ia.g;null!=hk&&(pd.CopyOperationId=hk);var pk=null==ia.h?null:ia.h.toString();null!=pk&&(pd.IsAsync=pk);
var vk=null==ia.i?null:ia.i.toString();null!=vk&&(pd.IsFromCache=vk);var Zj=null==ia.j?null:ia.j.toString();null!=Zj&&(pd.IsSuccessiveCopy=Zj);var qk=null==ia.k?null:ia.k.toString();null!=qk&&(pd.IsSelectionAllowed=qk);var rk=null==ia.l?null:ia.l.toString();null!=rk&&(pd.IsSuccess=rk);var Bg=null==ia.m?null:ia.m.toString();null!=Bg&&(pd.IsExpectedError=Bg);var Oj=ia.n;null!=Oj&&(pd.ExpectedErrorReason=Oj);var M=ia.o;null!=M&&(pd.ErrorMessage=M);var za=null==ia.p?null:ia.p.toString();null!=za&&(pd.ClientSideCopyTimeInMs=
za);var Ab=null==ia.q?null:ia.q.toString();null!=Ab&&(pd.TotalTimeInMs=Ab);var ec=null==ia.r?null:ia.r.toString();null!=ec&&(pd.PlainTextPayloadSize=ec);var Ic=ia.s;null!=Ic&&(pd.CopyPasteTargetType=Ic);var ed=null==ia.t?null:ia.t.toString();null!=ed&&(pd.ShadowWorkbookPayloadSize=ed);var Ed=null==ia.u?null:ia.u.toString();null!=Ed&&(pd.HtmlPayloadSize=Ed);var Pd=null==ia.v?null:ia.v.toString();null!=Pd&&(pd.HtmlSizeExceedsLimit=Pd);var Ae=null==ia.w?null:ia.w.toString();null!=Ae&&(pd.CopyTotalSizeExceedsLimit=
Ae);var Me=null==ia.x?null:ia.x.toString();null!=Me&&(pd.ErrorReason=Me);var zf=ia.y;null!=zf&&(pd.ErrorName=zf);var Df=null==ia.z?null:ia.z.toString();null!=Df&&(pd.IsSucceededWithAlert=Df);var fg=null==ia.ba?null:ia.ba.toString();null!=fg&&(pd.EncounteredDeploymentErrors=fg);var qh=null==ia.bb?null:ia.bb.toString();null!=qh&&(pd.ShadowWorkbookSizeExceedsLimit=qh);var og=ia.bc;null!=og&&(pd.CopyPasteTargetName=og);var ch=ia.bd;null!=ch&&(pd.CCPSliceName=ch);var ah=ia.be;null!=ah&&(pd.SyncClipboardItemsKeys=
ah);var Ch=ia.bf;null!=Ch&&(pd.AsyncClipboardItemsKeys=Ch);var Qh=ia.bg;null!=Qh&&(pd.CopyPasteHandlerName=Qh);var vh=ia.bh;null!=vh&&(pd.SucceededPopulatingSystemClipboardSync=vh);var Yh=ia.bi;null!=Yh&&(pd.SucceededPopulatingSystemClipboardAsync=Yh);var Ji=ia.bj;null!=Ji&&(pd.Location=Ji);var Kj=ia.bk;null!=Kj&&(pd.CopyContextId=Kj);var si=null==ia.bl?null:ia.bl.toString();null!=si&&(pd.ServerRequestTimeInMs=si);var wk=null==ia.bm?null:ia.bm.toString();null!=wk&&(pd.EcsOperationDuration=wk);var zk=
null==ia.bn?null:ia.bn.toString();null!=zk&&(pd.EcsRequestDuration=zk);var sk=null==ia.bo?null:ia.bo.toString();null!=sk&&(pd.WfeRequestDuration=sk);var yj=null==ia.bp?null:ia.bp.toString();null!=yj&&(pd.OriginalSourceRangesCountExceedsLimit=yj);var Rj=null==ia.bq?null:ia.bq.toString();null!=Rj&&(pd.UploadToClipServiceAttempted=Rj);var G=null==ia.br?null:ia.br.toString();null!=G&&(pd.FloatingObjectType=G);break;case 44:Mg="Paste";var pa=ia.a;null!=pa&&(pd.UserSessionId=pa);var kb=ia.b;null!=kb&&(pd.Trigger=
kb);var Zb=ia.c;null!=Zb&&(pd.RibbonCommandName=Zb);var Lc=null==ia.d?null:ia.d.toString();null!=Lc&&(pd.PasteTypeFlagValue=Lc);var Bd=ia.e;null!=Bd&&(pd.PasteOperationId=Bd);var he=ia.f;null!=he&&(pd.CopyOperationId=he);var Ie=ia.g;null!=Ie&&(pd.ClientSideStopwatchId=Ie);var ff=ia.h;null!=ff&&(pd.OriginalDestinationRange=ff);var qf=ia.i;null!=qf&&(pd.ExpandDestinationRange=qf);var eg=ia.j;null!=eg&&(pd.SourceItem=eg);var dh=null==ia.k?null:ia.k.toString();null!=dh&&(pd.SourceRangeCellCount=dh);var nh=
null==ia.l?null:ia.l.toString();null!=nh&&(pd.IsSuccess=nh);var Ug=null==ia.m?null:ia.m.toString();null!=Ug&&(pd.IsExpectedError=Ug);var rh=ia.n;null!=rh&&(pd.ClipboardFormatReadTimeInMs=rh);var oj=ia.o;null!=oj&&(pd.ClipboardFormatReadStatus=oj);var Vi=null==ia.p?null:ia.p.toString();null!=Vi&&(pd.ClipboardReadPermissionPromptShown=Vi);var zj=null==ia.q?null:ia.q.toString();null!=zj&&(pd.AsyncApiReadTimedOut=zj);var cj=ia.r;null!=cj&&(pd.ExpectedErrorReason=cj);var Fj=ia.s;null!=Fj&&(pd.ErrorMessage=
Fj);var dj=null==ia.t?null:ia.t.toString();null!=dj&&(pd.TotalTimeInMs=dj);var Lj=null==ia.u?null:ia.u.toString();null!=Lj&&(pd.PlainTextPayloadSize=Lj);var ak=null==ia.v?null:ia.v.toString();null!=ak&&(pd.ShadowWorkbookPayloadSize=ak);var xk=null==ia.w?null:ia.w.toString();null!=xk&&(pd.HtmlPayloadSize=xk);var yk=ia.x;null!=yk&&(pd.CopyPasteTargetType=yk);var Fk=null==ia.y?null:ia.y.toString();null!=Fk&&(pd.IsLastCopyWasExternal=Fk);var Gk=null==ia.z?null:ia.z.toString();null!=Gk&&(pd.IsClipboardDataContainShadowWorkbook=
Gk);var Hk=null==ia.ba?null:ia.ba.toString();null!=Hk&&(pd.IsShadowWorkbookParsedSuccessfully=Hk);var Ik=ia.bb;null!=Ik&&(pd.ActiveSelectionType=Ik);var Jk=ia.bc;null!=Jk&&(pd.PasteResult=Jk);var Kk=null==ia.bd?null:ia.bd.toString();null!=Kk&&(pd.ErrorReason=Kk);var Lk=ia.be;null!=Lk&&(pd.ErrorName=Lk);var Mk=null==ia.bf?null:ia.bf.toString();null!=Mk&&(pd.IsSucceededWithAlert=Mk);var Nk=null==ia.bg?null:ia.bg.toString();null!=Nk&&(pd.IsAfterCut=Nk);var Ok=null==ia.bh?null:ia.bh.toString();null!=
Ok&&(pd.EncounteredDeploymentErrors=Ok);var Pk=null==ia.bi?null:ia.bi.toString();null!=Pk&&(pd.IsCrossSession=Pk);var Qk=null==ia.bj?null:ia.bj.toString();null!=Qk&&(pd.ShadowWorkbookSizeExceedsLimit=Qk);var Rk=null==ia.bk?null:ia.bk.toString();null!=Rk&&(pd.ClipboardContainXLOPayload=Rk);var Sk=ia.bl;null!=Sk&&(pd.CopyPasteTargetName=Sk);var Tk=ia.bm;null!=Tk&&(pd.ChromeExtensionId=Tk);var Uk=ia.bn;null!=Uk&&(pd.PayloadOrigin=Uk);var Vk=ia.bo;null!=Vk&&(pd.PayloadType=Vk);var Wk=ia.bp;null!=Wk&&
(pd.CCPSliceName=Wk);var Xk=ia.bq;null!=Xk&&(pd.ClipboardItemsKeys=Xk);var Yk=ia.br;null!=Yk&&(pd.CopyPasteHandlerName=Yk);var Zk=null==ia.bs?null:ia.bs.toString();null!=Zk&&(pd.IsSourceItemOriginSameSession=Zk);var $k=ia.bt;null!=$k&&(pd.Location=$k);var al=ia.bu;null!=al&&(pd.ExternalAppSource=al);var bl=ia.bv;null!=bl&&(pd.PasteContextId=bl);var cl=null==ia.bw?null:ia.bw.toString();null!=cl&&(pd.ServerRequestTimeInMs=cl);var dl=null==ia.bx?null:ia.bx.toString();null!=dl&&(pd.IndicationDisplayScheduled=
dl);var el=ia.by;null!=el&&(pd.PasteIndicationDisplayStatus=el);var fl=null==ia.bz?null:ia.bz.toString();null!=fl&&(pd.PasteRecoveryUIDisplayed=fl);var gl=null==ia.ca?null:ia.ca.toString();null!=gl&&(pd.IsFromPasteRecoveryUI=gl);var hl=null==ia.cb?null:ia.cb.toString();null!=hl&&(pd.EcsOperationDuration=hl);var il=null==ia.cc?null:ia.cc.toString();null!=il&&(pd.EcsRequestDuration=il);var jl=null==ia.cd?null:ia.cd.toString();null!=jl&&(pd.WfeRequestDuration=jl);var kl=null==ia.ce?null:ia.ce.toString();
null!=kl&&(pd.OriginalSourceRangesCountExceedsLimit=kl);var ll=ia.cf;null!=ll&&(pd.PasteRecoveryUndoStopwatchId=ll);var ml=null==ia.cg?null:ia.cg.toString();null!=ml&&(pd.PasteRecoveryUndoTimeInMs=ml);var nl=null==ia.ch?null:ia.ch.toString();null!=nl&&(pd.PasteCSEPerformed=nl);var ol=null==ia.ci?null:ia.ci.toString();null!=ol&&(pd.CSEStatus=ol);var pl=null==ia.cj?null:ia.cj.toString();null!=pl&&(pd.IsFromEnterShortcut=pl);var ql=null==ia.ck?null:ia.ck.toString();null!=ql&&(pd.pasteDestinationHasMergedCells=
ql);var rl=ia.cl;null!=rl&&(pd.ArtSourceItemType=rl);break;case 45:Mg="DragDrop";var sl=ia.a;null!=sl&&(pd.UserSessionId=sl);var tl=ia.b;null!=tl&&(pd.Trigger=tl);var ul=ia.c;null!=ul&&(pd.RibbonCommandName=ul);var vl=ia.d;null!=vl&&(pd.OperationId=vl);var wl=ia.e;null!=wl&&(pd.ClientSideStopwatchId=wl);var xl=ia.f;null!=xl&&(pd.SourceRange=xl);var yl=ia.g;null!=yl&&(pd.DestinationRange=yl);var zl=ia.h;null!=zl&&(pd.CutCopyType=zl);var Al=null==ia.i?null:ia.i.toString();null!=Al&&(pd.IsShiftKeyDown=
Al);var Bl=null==ia.j?null:ia.j.toString();null!=Bl&&(pd.IsDragInsert=Bl);var Cl=null==ia.k?null:ia.k.toString();null!=Cl&&(pd.IsSuccess=Cl);var Dl=null==ia.l?null:ia.l.toString();null!=Dl&&(pd.IsExpectedError=Dl);var El=ia.m;null!=El&&(pd.ExpectedErrorReason=El);var Fl=ia.n;null!=Fl&&(pd.ErrorMessage=Fl);var Gl=null==ia.o?null:ia.o.toString();null!=Gl&&(pd.TotalTimeInMs=Gl);var Hl=ia.p;null!=Hl&&(pd.ErrorName=Hl);var Il=null==ia.q?null:ia.q.toString();null!=Il&&(pd.IsSucceededWithAlert=Il);var Jl=
ia.r;null!=Jl&&(pd.CopyPasteTargetType=Jl);var Kl=null==ia.s?null:ia.s.toString();null!=Kl&&(pd.EncounteredDeploymentErrors=Kl);break;case 46:Mg="ClearCopyState";var Ll=ia.a;null!=Ll&&(pd.UserSessionId=Ll);var Ml=ia.b;null!=Ml&&(pd.ClientSideStopwatchId=Ml);var Nl=ia.c;null!=Nl&&(pd.Trigger=Nl);var Ol=null==ia.d?null:ia.d.toString();null!=Ol&&(pd.IsClearClipboard=Ol);var Pl=null==ia.e?null:ia.e.toString();null!=Pl&&(pd.IsExplicit=Pl);var Ql=null==ia.f?null:ia.f.toString();null!=Ql&&(pd.IsSuccess=
Ql);var Rl=ia.g;null!=Rl&&(pd.ErrorMessage=Rl);var Sl=ia.h;null!=Sl&&(pd.ErrorName=Sl);var Tl=null==ia.i?null:ia.i.toString();null!=Tl&&(pd.TotalTimeInMs=Tl);var Ul=ia.j;null!=Ul&&(pd.CopyPasteTargetType=Ul);break;case 47:Mg="WebWorkerRecalcStats";var Vl=null==ia.a?null:ia.a.toString();null!=Vl&&(pd.SuccessCount=Vl);var Wl=null==ia.b?null:ia.b.toString();null!=Wl&&(pd.FailureCount=Wl);var Xl=null==ia.c?null:ia.c.toString();null!=Xl&&(pd.ValueTypeMismatchCount=Xl);var Yl=null==ia.d?null:ia.d.toString();
null!=Yl&&(pd.CellValueMismatchCount=Yl);var Zl=null==ia.e?null:ia.e.toString();null!=Zl&&(pd.IfmtMismatchCount=Zl);var $l=null==ia.f?null:ia.f.toString();null!=$l&&(pd.FormattedTextMismatchCount=$l);var am=null==ia.g?null:ia.g.toString();null!=am&&(pd.CellValueStringMismatchCount=am);var bm=null==ia.h?null:ia.h.toString();null!=bm&&(pd.CellValueNumberMismatchCount=bm);var cm=null==ia.i?null:ia.i.toString();null!=cm&&(pd.CellValueBooleanMismatchCount=cm);var dm=null==ia.j?null:ia.j.toString();null!=
dm&&(pd.CellValueBlankMismatchCount=dm);var em=null==ia.k?null:ia.k.toString();null!=em&&(pd.CellValueErrorMismatchCount=em);var fm=null==ia.l?null:ia.l.toString();null!=fm&&(pd.FormattedTextStringMismatchCount=fm);var gm=null==ia.m?null:ia.m.toString();null!=gm&&(pd.FormattedTextNumberMismatchCount=gm);var hm=null==ia.n?null:ia.n.toString();null!=hm&&(pd.FormattedTextBooleanMismatchCount=hm);var im=null==ia.o?null:ia.o.toString();null!=im&&(pd.FormattedTextBlankMismatchCount=im);var jm=null==ia.p?
null:ia.p.toString();null!=jm&&(pd.FormattedTextErrorMismatchCount=jm);var km=null==ia.q?null:ia.q.toString();null!=km&&(pd.StringMismatchCount=km);var lm=null==ia.r?null:ia.r.toString();null!=lm&&(pd.NumericMismatchCount=lm);var mm=null==ia.s?null:ia.s.toString();null!=mm&&(pd.ErrorMismatchCount=mm);var nm=null==ia.t?null:ia.t.toString();null!=nm&&(pd.StringValuesCount=nm);var om=null==ia.u?null:ia.u.toString();null!=om&&(pd.NumericValuesCount=om);var pm=null==ia.v?null:ia.v.toString();null!=pm&&
(pd.BooleanValuesCount=pm);var qm=null==ia.w?null:ia.w.toString();null!=qm&&(pd.BlankValuesCount=qm);var rm=null==ia.x?null:ia.x.toString();null!=rm&&(pd.ErrorValuesCount=rm);var sm=null==ia.y?null:ia.y.toString();null!=sm&&(pd.NumericValuesDiffAverage=sm);var tm=ia.z;null!=tm&&(pd.NumericEvaluatedValuesMismatchSamples=tm);var um=ia.ba;null!=um&&(pd.NumericFormattedTextMismatchSamples=um);var vm=ia.bb;null!=vm&&(pd.NumericMismatchSamples=vm);var wm=ia.bc;null!=wm&&(pd.CellValueTypeMismatchSamples=
wm);var xm=ia.bd;null!=xm&&(pd.IfmtMismatchSamples=xm);var ym=ia.be;null!=ym&&(pd.BlockHashCode=ym);break;case 48:Mg="DataValidationEditOpenDialog";var zm=ia.a;null!=zm&&(pd.ServerCommand=zm);var Am=null==ia.b?null:ia.b.toString();null!=Am&&(pd.SubDialogOpened=Am);var Bm=ia.c;null!=Bm&&(pd.SubDialogButtonClicked=Bm);var Cm=null==ia.d?null:ia.d.toString();null!=Cm&&(pd.DialogOpened=Cm);var Dm=ia.e;null!=Dm&&(pd.RuleType=Dm);var Em=ia.f;null!=Em&&(pd.ConditionType=Em);var Fm=null==ia.g?null:ia.g.toString();
null!=Fm&&(pd.LowerBoundaryFilled=Fm);var Gm=null==ia.h?null:ia.h.toString();null!=Gm&&(pd.UpperBoundaryFilled=Gm);var Hm=null==ia.i?null:ia.i.toString();null!=Hm&&(pd.IgnoreBlank=Hm);var Im=null==ia.j?null:ia.j.toString();null!=Im&&(pd.InCellDropdown=Im);var Jm=null==ia.k?null:ia.k.toString();null!=Jm&&(pd.ShowInputMessage=Jm);var Km=null==ia.l?null:ia.l.toString();null!=Km&&(pd.InputTitleFilled=Km);var Lm=null==ia.m?null:ia.m.toString();null!=Lm&&(pd.InputMessageFilled=Lm);var Mm=null==ia.n?null:
ia.n.toString();null!=Mm&&(pd.ShowErrorAlert=Mm);var Nm=null==ia.o?null:ia.o.toString();null!=Nm&&(pd.AlertBlocking=Nm);var Om=null==ia.p?null:ia.p.toString();null!=Om&&(pd.AlertTitleFilled=Om);var Pm=null==ia.q?null:ia.q.toString();null!=Pm&&(pd.AlertMessageFilled=Pm);var Qm=ia.r;null!=Qm&&(pd.StopWatchId=Qm);break;case 49:Mg="DataValidationEditSubmitRule";var Rm=ia.a;null!=Rm&&(pd.RuleType=Rm);var Sm=ia.b;null!=Sm&&(pd.ConditionType=Sm);var Tm=null==ia.c?null:ia.c.toString();null!=Tm&&(pd.LowerBoundaryFilled=
Tm);var Um=null==ia.d?null:ia.d.toString();null!=Um&&(pd.UpperBoundaryFilled=Um);var Vm=null==ia.e?null:ia.e.toString();null!=Vm&&(pd.IgnoreBlank=Vm);var Wm=null==ia.f?null:ia.f.toString();null!=Wm&&(pd.InCellDropdown=Wm);var Xm=null==ia.g?null:ia.g.toString();null!=Xm&&(pd.ShowInputMessage=Xm);var Ym=null==ia.h?null:ia.h.toString();null!=Ym&&(pd.InputTitleFilled=Ym);var Zm=null==ia.i?null:ia.i.toString();null!=Zm&&(pd.InputMessageFilled=Zm);var $m=null==ia.j?null:ia.j.toString();null!=$m&&(pd.ShowErrorAlert=
$m);var an=null==ia.k?null:ia.k.toString();null!=an&&(pd.AlertBlocking=an);var bn=null==ia.l?null:ia.l.toString();null!=bn&&(pd.AlertTitleFilled=bn);var cn=null==ia.m?null:ia.m.toString();null!=cn&&(pd.AlertMessageFilled=cn);var dn=null==ia.n?null:ia.n.toString();null!=dn&&(pd.ClearAllPressed=dn);var en=ia.o;null!=en&&(pd.ActionStatus=en);var fn=ia.p;null!=fn&&(pd.Error=fn);var gn=ia.q;null!=gn&&(pd.StopWatchId=gn);var hn=null==ia.r?null:ia.r.toString();null!=hn&&(pd.InsertDropdownButton=hn);break;
case 50:Mg="CustomSort";var jn=ia.a;null!=jn&&(pd.RangeType=jn);var kn=null==ia.b?null:ia.b.toString();null!=kn&&(pd.HasHeaders=kn);var ln=null==ia.c?null:ia.c.toString();null!=ln&&(pd.SortTopToBottom=ln);var mn=null==ia.d?null:ia.d.toString();null!=mn&&(pd.ColumnCount=mn);var nn=null==ia.e?null:ia.e.toString();null!=nn&&(pd.RowCount=nn);var on=null==ia.f?null:ia.f.toString();null!=on&&(pd.RangeLimitExceeded=on);var pn=null==ia.g?null:ia.g.toString();null!=pn&&(pd.CaseSensitive=pn);var qn=null==ia.h?
null:ia.h.toString();null!=qn&&(pd.GetSortInfoDuration=qn);var rn=null==ia.i?null:ia.i.toString();null!=rn&&(pd.LevelCount=rn);var sn=null==ia.j?null:ia.j.toString();null!=sn&&(pd.SortOnValuesCount=sn);var tn=null==ia.k?null:ia.k.toString();null!=tn&&(pd.SortOnCellColorCount=tn);var un=null==ia.l?null:ia.l.toString();null!=un&&(pd.SortOnFontColorCount=un);var vn=null==ia.m?null:ia.m.toString();null!=vn&&(pd.SortOnIconCount=vn);var wn=null==ia.n?null:ia.n.toString();null!=wn&&(pd.CustomOrderCount=
wn);var xn=null==ia.o?null:ia.o.toString();null!=xn&&(pd.AvgCellColorCount=xn);var yn=null==ia.p?null:ia.p.toString();null!=yn&&(pd.MaxCellColorCount=yn);var zn=null==ia.q?null:ia.q.toString();null!=zn&&(pd.AvgFontColorCount=zn);var An=null==ia.r?null:ia.r.toString();null!=An&&(pd.MaxFontColorCount=An);var Bn=null==ia.s?null:ia.s.toString();null!=Bn&&(pd.AvgIconsCount=Bn);var Cn=null==ia.t?null:ia.t.toString();null!=Cn&&(pd.MaxIconsCount=Cn);var Dn=null==ia.u?null:ia.u.toString();null!=Dn&&(pd.Executed=
Dn);break;case 51:Mg="NamedSheetViewUserAction";var En=ia.a;null!=En&&(pd.UserSessionId=En);var Fn=ia.b;null!=Fn&&(pd.UserActionName=Fn);var Gn=null==ia.c?null:ia.c.toString();null!=Gn&&(pd.UserActionSource=Gn);var Hn=ia.d;null!=Hn&&(pd.UserActionData=Hn);var In=ia.e;null!=In&&(pd.OtherData=In);break;case 52:Mg="NamedSheetViewTeachingCallout";var Jn=ia.a;null!=Jn&&(pd.UserSessionId=Jn);var Kn=null==ia.b?null:ia.b.toString();null!=Kn&&(pd.TeachingCalloutSequence=Kn);var Ln=null==ia.c?null:ia.c.toString();
null!=Ln&&(pd.TeachingCalloutIndex=Ln);var Mn=null==ia.d?null:ia.d.toString();null!=Mn&&(pd.UserActionName=Mn);var Nn=ia.e;null!=Nn&&(pd.UserActionData=Nn);var On=null==ia.f?null:ia.f.toString();null!=On&&(pd.DurationInMs=On);break;case 53:Mg="NamedSheetViewTeachingDialog";var Pn=ia.a;null!=Pn&&(pd.UserSessionId=Pn);var Qn=ia.b;null!=Qn&&(pd.UserActionName=Qn);var Rn=ia.c;null!=Rn&&(pd.ButtonClicked=Rn);var Sn=null==ia.d?null:ia.d.toString();null!=Sn&&(pd.DurationInMs=Sn);var Tn=null==ia.e?null:ia.e.toString();
null!=Tn&&(pd.IsNewTeachingDialog=Tn);break;case 54:Mg="NamedSheetViewOptionsDialog";var Un=ia.a;null!=Un&&(pd.UserSessionId=Un);var Vn=null==ia.b?null:ia.b.toString();null!=Vn&&(pd.OptionsAction=Vn);var Wn=ia.c;null!=Wn&&(pd.OptionsActionData=Wn);var Xn=ia.d;null!=Xn&&(pd.OptionsOtherData=Xn);var Yn=null==ia.e?null:ia.e.toString();null!=Yn&&(pd.DurationInMs=Yn);break;case 55:Mg="NamedSheetViewTempViewSaveDialog";var Zn=ia.a;null!=Zn&&(pd.UserSessionId=Zn);var $n=ia.b;null!=$n&&(pd.TriggeredFrom=
$n);var ao=ia.c;null!=ao&&(pd.ButtonClicked=ao);var bo=null==ia.d?null:ia.d.toString();null!=bo&&(pd.NameUpdated=bo);var co=null==ia.e?null:ia.e.toString();null!=co&&(pd.DurationInMs=co);break;case 56:Mg="TemporaryViewStartedDataRestore";var eo=ia.a;null!=eo&&(pd.UserSessionId=eo);var fo=null==ia.b?null:ia.b.toString();null!=fo&&(pd.CountOfTempViews=fo);break;case 57:Mg="TemporaryViewFetchedVersion";var go=ia.a;null!=go&&(pd.UserSessionId=go);var ho=null==ia.b?null:ia.b.toString();null!=ho&&(pd.NumberOfBytes=
ho);break;case 58:Mg="RaiseEventsAndGenerateBlockRequests";var io=null==ia.a?null:ia.a.toString();null!=io&&(pd.ReturnContentStatus=io);var jo=null==ia.b?null:ia.b.toString();null!=jo&&(pd.CacheState=jo);var ko=null==ia.c?null:ia.c.toString();null!=ko&&(pd.FromXhrCallback=ko);var lo=null==ia.d?null:ia.d.toString();null!=lo&&(pd.AreGeneralErrorsPresent=lo);var mo=ia.e;null!=mo&&(pd.BlockCacheItemHash=mo);var no=ia.f;null!=no&&(pd.StopwatchId=no);var oo=ia.g;null!=oo&&(pd.BlockCacheItemProcessingStopwatchId=
oo);var po=null==ia.h?null:ia.h.toString();null!=po&&(pd.StateId=po);var qo=null==ia.i?null:ia.i.toString();null!=qo&&(pd.IsHighPriority=qo);var ro=null==ia.j?null:ia.j.toString();null!=ro&&(pd.CalcComplete=ro);var so=null==ia.k?null:ia.k.toString();null!=so&&(pd.EditedCellsUpdatedByCse=so);var to=null==ia.l?null:ia.l.toString();null!=to&&(pd.DependentCellsUpdatedByCse=to);var uo=null==ia.m?null:ia.m.toString();null!=uo&&(pd.Revision=uo);var vo=null==ia.n?null:ia.n.toString();null!=vo&&(pd.SheetProcessedDataVersion=
vo);var wo=null==ia.o?null:ia.o.toString();null!=wo&&(pd.RefCount=wo);var xo=null==ia.p?null:ia.p.toString();null!=xo&&(pd.ExistsInView=xo);var yo=null==ia.q?null:ia.q.toString();null!=yo&&(pd.ContentSource=yo);break;case 59:Mg="LaunchMakerCodeEditor";var zo=ia.a;null!=zo&&(pd.SessionId=zo);var Ao=ia.b;null!=Ao&&(pd.Command=Ao);var Bo=null==ia.c?null:ia.c.toString();null!=Bo&&(pd.IsPreviewGallery=Bo);var Co=ia.d;null!=Co&&(pd.MenuItemId=Co);var Do=ia.e;null!=Do&&(pd.ScriptId=Do);var Eo=ia.f;null!=
Eo&&(pd.ShareId=Eo);var Fo=null==ia.g?null:ia.g.toString();null!=Fo&&(pd.IsOwner=Fo);var Go=null==ia.h?null:ia.h.toString();null!=Go&&(pd.PublishedScriptCount=Go);var Ho=null==ia.i?null:ia.i.toString();null!=Ho&&(pd.RecentScriptCount=Ho);var Io=null==ia.j?null:ia.j.toString();null!=Io&&(pd.WorkbookScriptCount=Io)}pd.Table=Mg;var Oo=Sys.Serialization.JavaScriptSerializer.serialize(pd);ae.call(od,3704927,0,50,Oo)}}catch(pd){x.ULS.sendTraceTag(3704928,0,10,`Error when serializing usage table: ${ja} exception: ${pd}`)}}Ihd(ja,
ia,dc){if(this.Yyc){const od=this.i1a[ja+ia];od&&(od.e=dc,this.Ikd(od));delete this.i1a[ja+ia]}}REd(ja,ia){eh[ja]in this.UCf||this.Ih(ja,ia)}wmj(){this.ik.appStart&&this.rmg($f.LNd,this.ik.appStart)}FVi(ja){const ia={};ia.a=ja.i;ia.b=ja.o;ia.c=ja.t;ia.d=Oh.a(ja.s,ja.p||this.ik.appStart);ia.e=Oh.a(ja.e,ja.s);ia.f=ja.c;ia.g=ja.a;ia.h=ja.h;this.Ih(0,ia,this.XIi(ia.b,ia.c))}XIi(ja,ia){return["CommandTask","QueuedTask","Task"].includes(ja)&&!this.PRh.includes(ia)?!1:!0}ND(ja,ia,dc,od,ae){if(ja&&ia){const Pe=
{};Pe.a=ja;Pe.b=ia;Pe.c=dc.toString();Pe.d=od.toString();this.Ih(15,Pe,void 0===ae?!0:ae)}}ACf(ja,ia,dc,od){const ae={};ja&&(ae.c=Oh.a(ja,this.ik.appStart));ae.b=ia;ae.a=dc;ae.d=od;this.Ih(17,ae)}dispose(){this.iEa.execute(ja=>{ja.deactivate(!0);ja.cDj(this.cSf)});this.wg&&this.wg.CVa(this.KI);super.dispose()}Jhf(){return this.Dyg=this.Dyg||new th}BSe(ja,ia,dc,od,ae){const Pe={};Pe.o=ja;Pe.t=ia;Pe.p=void 0===ae?null:ae;Pe.s=(void 0===od?null:od)||this.ik.Og;this.pwd(Pe,void 0===dc?null:dc);return Pe}eOe(ja,
ia){ja&&(ja.e=(void 0===ia?null:ia)||this.ik.Og,ja.i=ja.i||this.S5a.wdb(),ja.c=ja.c||this.gTe,ja.a=ja.a||this.rTe,ja.h=void 0!==ja.h&&null!==ja.h?ja.h:this.wg?this.wg.Cj:!1,this.Ikd(ja))}ICf(ja){const ia=ja.context;ja.duration>$f.fEh&&(ia.methodName===Be.a.eDb||ia.methodName===Be.a.Hza)&&this.ICc(1,$f.hfi);if("GetSessionStatus"!==ia.methodName){const dc={};dc.a=ia.methodName;dc.b=ia.stopwatch.id;dc.c=ja.UCc;dc.d=ja.responseSize;dc.e=ia.WLa;dc.f=ja.Nf?ja.Nf.StateId:Be.a.U7d;this.Ih(30,dc,!0);this.ND(dc.b,
ja.Nf.ServerCorrelationId,"clientWebRequests","ServerActions")}}fng(){if(this.Yyc){const ja=this.i1a.LoadingUIShownSplashScreen;ja&&qd.a.instance.CUj(ja.s)}}ICc(ja,ia){this.jxg.DQb(ja,ia,null)}Q7f(ja,ia){this.dMc.hHj(ja,void 0===ia?null:ia)}P7f(ja,ia,dc){this.dMc.gHj(ja,ia,void 0===dc?null:dc)}R7f(ja){this.dMc.IQb(ja,null)}S7f(ja,ia){this.dMc.DQb(ja,ia,null)}FCc(ja,ia,dc){this.kZa.FCc(ja,ia,void 0===dc?null:dc)}MCc(ja,ia,dc){this.kZa.MCc(ja,ia,void 0===dc?null:dc)}kSb(ja,ia,dc,od,ae,Pe,Xe,...vf){this.kZa.kSb(ja,
ia,dc,od,ae,Pe,Xe,...vf)}GEc(ja,ia,dc,od,ae,Pe,Xe){this.kZa.GEc(ja,ia,dc,od,ae,Pe,Xe)}mSb(ja,ia,dc,od,ae,Pe){this.kZa.mSb(ja,ia,dc,od,ae,Pe)}lSb(ja,ia,dc,od,ae,Pe,...Xe){this.kZa.lSb(ja,ia,dc,od,ae,Pe,...Xe)}nSb(ja,ia,dc,od,ae,Pe){this.jxg.nSb(ja,ia,dc,od,ae,Pe)}HEc(ja,ia,dc,od){this.kZa.HEc(ja,ia,dc,od)}Ikd(ja){this.f9j.FVi(ja)}xmj(){if(this.Yyc){Stw.swpc=null;const ja=this.Yyc;for(let ia in ja)this.pwd(ja[ia])}}UUh(){const ja=window[bh.a.namespace];if(ja){const ia=ja[bh.a.hNe];ia&&(delete ja[bh.a.hNe],
ia.forEach(dc=>{this.pwd(dc);this.Ikd(dc)}))}}mKi(ja,ia){if("about:blank"===ja||"renamehandler.ashx"===ia&&"2"===D.a.Ew(ja,"u"))return!0;for(ja=0;ja<this.aWd.length;ja++)if(ia.endsWith(this.aWd[ja]))return!0;return!1}$Si(){this.iEa.execute(ja=>{ja.nk($f.z7g,0);ja.HZg(this.cSf);ja.activate()})}TSi(){const ja={};ja.a=new Date(Zc.EcmaDateClock.instance.appStart.m);ja.b=this.userSessionId;ja.c=this.ik.jqg;ja.d=$f.Hxh*y.devicePixelRatio;ja.e=Qd.a.Jd.appStart.m;this.Ih(14,ja,!0);this.wpa(Qd.a.Jd.appStart.m,
Object(Oa.a)(J.a.instance,J.a.instance.Mwj,"recordAppInitStart"))}rmg(ja,ia){this.Blb=this.S5a.wdb();this.QWb=this.S5a.wdb();this.zHa=ja;this.VHc("UserAction",ja,this.QWb,ia);this.xBf(ja,this.Blb)}Eak(){const ja=window[bh.a.namespace];ja&&!$f.EQe&&(ja[bh.a.d8j]=(ia,dc)=>this.BSe(ia,dc),ja[bh.a.DGh]=ia=>{this.eOe(ia)},$f.EQe=!0)}Jjk(ja){const ia=Jh.hah(ja.o,ja.t),dc=new Jh(Oh.a(ja.e,ja.s)),od=ia in this.z4d?this.z4d[ia].Pjh(dc):dc;this.z4d[ia]=od;if(dc===od||dc.average!==od.average)ja=Object(Ad.a)(new Rh,
{operation:ja.o,target:ja.t,l1i:od.average,sender:this}),this.raiseEvent(ia,ja)}xBf(ja,ia){const dc={};dc.a=ia;dc.b=this.userSessionId;dc.c=ja;this.Ih(1,dc,!0)}oxi(){this.aWd=[Be.a.HAj,Be.a.getSessionStatus,Be.a.Hza,Be.a.Djh,Be.a.vgh,Be.a.ulb,Be.a.Zjc,Be.a.getObjectMetadata,Be.a.Qci,Be.a.setRichTextCell,Be.a.Kza,Be.a.Xnk,Be.a.pollSessionStatus,Be.a.oii,Be.a.pgi,Be.a.R$h]}pwd(ja,ia){ja.i=(void 0===ia?null:ia)||this.S5a.wdb();ja.a=this.rTe;ja.c=this.gTe;ja.h=this.wg?this.wg.Cj:!1}static la(ja){const ia=
new $f(ja.xa.UserSessionId,ja.ia,void 0,void 0,void 0,!0);ia.xBf($f.eIf,ia.cUe);x.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");ia.$Si();ia.Eak();ia.wmj();ia.TSi();ia.UUh();ia.xmj();ia.oxi();$f.cSj(ja);ac.a.Ip.Va(41,ia)}static cSj(ja){const ia=y.devicePixelRatio;1<ia&&ja.Je.My(!0,2<=ia?8388608:4194304)}}$f.eIf="UnassignedUserAction";$f.LNd="PageLoad";$f.Osd="GridUpdateOperation";$f.fEh=5E3;$f.hfi="MoreThan_5000_Ms";$f.Hxh=96;$f.z7g=30;$f.EQe=
!1;Object(u.a)($f,"TelemetryManager",ef.a,[12,13,395,396]);var Aa=a(212),zb=a(113);class sc{constructor(ja,ia,dc){this.qqk=ja;this.eY=ia;this.name=dc}}Object(u.a)(sc,"Validation",null,[]);var Pc;let kd=Pc=class{constructor(ja){this.qeb=()=>{this.cXf(this.y6e)};this.Bk=()=>{this.cXf(this.J8g)};this.$=ja;this.J8g=new Fc.a;this.y6e=new Fc.a;ud.h(this.$).ya.wt(this.Bk);ud.h(this.$).ya.Nze(this.qeb)}t3c(ja,ia,dc,od,ae){if(ja&&od){const Pe=Aa.a.oC(ia,dc);this.V5b(()=>!!zb.a(ja).Mt(Pe),od.StateId,ae)}}V5b(ja,
ia,dc){this.tYg(this.y6e,ja,ia,dc)}tYg(ja,ia,dc,od){ja&&ia&&dc!==Be.a.Gg&&ja.add(new sc(ia,dc,od))}cXf(ja){if(ja){var ia=new Fc.a;for(let dc of ja){if(dc.eY===this.$.ea.Mg)try{dc.qqk()||x.ULS.sendTraceTag(537151010,0,15,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [${dc.name}]`)}catch(od){x.ULS.sendTraceTag(537151009,0,10,`ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [${dc.name}]. Exception: [${od}]`)}ia.add(dc)}for(let dc of ia)ja.remove(dc)}else x.ULS.shipAssertTag(537151011,
0,!!ja,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")}dispose(){ud.h(this.$)&&ud.h(this.$).ya&&(ud.h(this.$).ya.ds(this.Bk),ud.h(this.$).ya.TTd(this.qeb));this.$=null}static la(ja){const ia=new Pc(ja);ja.ia.Va(277,ia)}};kd=Pc=Object(cd.a)([Object(Tc.d)(ub.xd),Object(cd.b)(0,Object(ub.fb)())],kd);Object(u.a)(kd,"ValidationTelemetryManager",null,[383,5]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");F.main();Type.registerNamespace("CNT");
Ga.main();Type.registerNamespace("CACPU");qc.main();Type.registerNamespace("Common.App.EventsCacheManager");hb.main();(()=>{qb.a.Ia(ja=>{ja.ia.Va(137,new Ma(ja))})})();(()=>{qb.a.Ia(ja=>{ja.ia.Va(37,new ee(ja))})})();(()=>{qb.a.Ia(ja=>{ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8082961_TrackerAndProfilerServicesWithNewInfra")||vb.la(ja)})})();(()=>{qb.a.Ia(ja=>{ba.EwaSettings.isChangeGateEnabled("OfficeVSO:8082961_TrackerAndProfilerServicesWithNewInfra")||$b.la(ja)})})();(()=>{qb.a.Ia(ja=>{ja.ia.Va(40,
new Id(ja,new fc.a(()=>Je.GetServiceTaskFactory.create(ja.ia,137,ja.ma,1))))})})();(()=>{qb.a.Ia(ja=>{ja.ia.Va(276,new Eb(ja))})})();(()=>{qb.a.Ia(ja=>{ac.a.Ip.Od(135,()=>{$f.la(ja);bg.la(ja);ba.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateValidationTelemetryManager",!1)||kd.la(ja);Sg.la(ja);Tf.la(ja);Ze.RenderingFidelityTracker.la(ja)})})})();String(e);String(k);String(f);String(h);String(l);String(r);String(v);window.___1692616129281_closurehack=e;window.___1692616129281_closurehack=
k;window.___1692616129281_closurehack=f;window.___1692616129281_closurehack=h;window.___1692616129281_closurehack=l;window.___1692616129281_closurehack=r;window.___1692616129281_closurehack=v},740:function(w,B,a){a.d(B,"a",function(){return b});const b=(c,h,f)=>c.Ja(h)||c.Va(h,f())},766:function(w,B,a){w=a(0);var b=a(5),c=a(65),h=a(30),f=a(33),e=a(181);class k{constructor(t,m){this.message=t;this.Bya=m}}Object(w.a)(k,"CrossDocumentEventArgs",null,[]);var l=a(780),r=a(387),v=a(268),u=a(779);a.d(B,
"a",function(){return x});class x{constructor(t,m,n,A){this._name="";this.Wv={};this.e6=null;this.ackMessageHandler=y=>{y=y.CorrelationId;""!==y&&y in this.Wv&&(u.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.Wv[y],y),this.Wv[y]="ACK_RECEIVED")};this.KKb=y=>{const z=this.QCb(y);if(!z)return!1;if(this.ar[z.MessageId])return this.NJ.yAa(this.ar[z.MessageId],z),!0;if(this.aw[z.MessageId]){const F=this.aw[z.MessageId];y=new k(z,y);this.NJ.JFb(F,y);return!0}return!1};
this.SJ=[];this.HJ=[];this.IJ=[];this.QJ=[];this.Iva=t;this.Gva=m;this.ar={};this.aw={};this.NJ=n;x._id++;A&&A();this.Xq=this.enable()}get targetOrigin(){return this.Gva}get rFa(){return this.Iva}enable(){if(!v.a())return u.a.sendTraceTag(5018251,2,"Not supported for current browser."),!1;this.BFb();u.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.Xq}BFb(){u.a.debugAssertTag(5018253,!!this.NJ,null);this.e6=this.KKb;this.NJ.WKa(this.e6,null)}disable(){this.Xq=!1;this.SJ=[];this.HJ=
[];this.IJ=[];this.QJ=[];this.Iva=null;this.Gva="";this.NJ.bNa(this.e6);this.ar={};this.aw={}}dispose(){this.disable()}YAa(t){return!!this.SJ&&Array.contains(this.SJ,t)||this.XAa(t)}XAa(t){return!!this.HJ&&Array.contains(this.HJ,t)}yn(t){u.a.debugAssertTag(5018259,!!this.SJ,null);Array.add(this.SJ,t);u.a.sendTraceTag(5018260,2,"Allow receiving : {0}",t)}G2a(t){u.a.debugAssertTag(5018261,!!this.HJ,null);Array.add(this.HJ,t);u.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",t)}iHb(t){return!!this.IJ&&
Array.contains(this.IJ,t)}JS(t){u.a.debugAssertTag(5018263,!!this.IJ,null);Array.add(this.IJ,t);u.a.sendTraceTag(5018264,2,"Allow free sending: {0}",t)}rHb(t){t=c.a.vN(t);return!!t&&!!this.QJ&&Array.contains(this.QJ,t)}KS(t){u.a.debugAssertTag(5018265,!!this.QJ,null);if(t===x.FM)return u.a.debugAssertTag(5018266,!1,null),!1;let m=c.a.vN(t);if(!m)return u.a.sendTraceTag(5018267,4,"Get origin fail:{0}",t),!1;b.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.NormalizePostMessageOrigin")&&
(m=f.a.rn(m));Array.add(this.QJ,m);u.a.sendTraceTag(5018268,2,"Add origin:{0}",m);return!0}send(t,m){m=void 0===m?null:m;let n=this.targetOrigin;if(m){m=c.a.vN(m);if(!m)return!1;n=m}return this.taa(t,this.rFa,n)}sendMessage(t,m,n){n=(n=void 0===n?"":n)&&""!==n?n:e.a.create().toString();return this.send(this.z$(t,m,n,b.AFrameworkApplication.userSessionId))}postMessage(t){const m=e.a.create().toString();if(!b.AFrameworkApplication.da.na("RetryablePostMessagingIsEnabled")||!t.Tha)return this.send(this.z$(t.messageId,
t.values,m,t.userSessionId));this.ar[t.K0]||(this.yn(t.K0),this.tm(t.K0,this.ackMessageHandler));this.Wv[m]="";return this.wDa(t,m,1)}wDa(t,m,n){if(""!==m&&m in this.Wv&&"ACK_RECEIVED"===this.Wv[m])return delete this.Wv[m],!0;if(n>t.DI)return u.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',t.K0,m),delete this.Wv[m],!1;u.a.sendTraceTag(40716251,1<n?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',t.DI-n,t.messageId,
m);n++;window.setTimeout(()=>{this.wDa(t,m,n)},t.n2c);t.values[r.a.l2c]=!0;return this.send(this.z$(t.messageId,t.values,m,t.userSessionId))}z$(t,m,n,A){t=new l.a(t);t.CorrelationId=n;m&&(t.Values=m);t.Values.wdUserSession=A;return t}taa(t,m,n){u.a.debugAssertTag(5018269,!!t,null);if(!this.Xq)return!1;u.a.debugAssertTag(5018270,!!m,null);u.a.debugAssertTag(5018271,!!n,null);if(!m||!n)return u.a.debugAssertTag(5018272,!1,null),!1;if(n===x.FM&&!this.iHb(t.MessageId))return u.a.sendTraceTag(5018273,
1,"Got unregistered message {0}",{["id"]:t.MessageId}),!1;t.SendTime=(new Date).getTime();let A="";try{A=Sys.Serialization.JavaScriptSerializer.serialize(t)}catch(y){return u.a.sendTraceTag(5018274,4,"JSON Ser failed {0}",{["Exception"]:y.message}),!1}m=x.sendMessage(m,A,n);u.a.sendTraceTag(5018275,2,"Send {0}. {1}",m?"succeeded":"failed",{["id"]:t.MessageId,["origin"]:n});return m}tm(t,m){u.a.debugAssertTag(5018304,!!m,null);u.a.debugAssertTag(5018305,!!this.ar&&!!this.aw,null);if(!this.Xq)return!1;
if(!this.YAa(t))return u.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:t}),!1;this.ar[t]!==m&&(u.a.debugAssertTag(5018307,!this.ar[t]&&!this.aw[t],null),this.ar[t]=m,delete this.aw[t]);return!0}SV(t){this.Xq&&(this.ar[t]&&delete this.ar[t],this.aw[t]&&delete this.aw[t])}QCb(t){const m=new Date;this.OJb(t);if(!t.origin||!t.source||void 0===t.data||null===t.data)return u.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const n=this.AIb(t.data);if(!n)return null;if(!this.rHb(t.origin)){if(!this.XAa(n.MessageId))return u.a.sendTraceTag(5018309,
1,"{0}",{["id"]:n.MessageId}),null;if(!h.a.PY&&t.source!==this.rFa)return u.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}u.a.debugAssertTag(5018311,!!n.Values,null);n.Values.m_Source=t.source;n.Values.m_Origin=t.origin;n.Values.m_ReceivedTime=m.getTime();return n}AIb(t){if(!t)return null;let m=null;try{m=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0)}catch(y){return 2>x.fua&&(u.a.sendTraceTag(5018312,2,"Deser failed"),x.fua++),null}if(!m)return u.a.debugAssertTag(5018313,
!1,null),null;for(t=0;t<x.wT.length;t++)if(!m[x.wT[t]])return"MessageId"!==x.wT[t]&&u.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",x.wT[t]),null;if(m.Values)try{m.Values}catch(y){return u.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",y.message),null}else u.a.sendTraceTag(41502556,2,"No values in message");t=m.MessageId;if(!this.YAa(t))return u.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:t}),null;const n=m.SendTime,A=(new Date).getTime()-n;if(0>n)return u.a.sendTraceTag(520435660,
2,"{0}",{["t"]:n,["id"]:t}),null;6E4<A&&u.a.sendTraceTag(520435659,2,"{0}",{["t"]:n,["delta"]:A,["id"]:t});-300>A&&u.a.sendTraceTag(520435658,2,"{0}",{["t"]:n,["delta"]:A,["id"]:t});t=new l.a;t.MessageId=m.MessageId;t.SendTime=m.SendTime;t.CorrelationId=m.CorrelationId;m.Values&&(t.Values=m.Values);u.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",t.MessageId,t.SendTime,t.CorrelationId);return t}OJb(t){u.a.sendTraceTag(5018318,1,String.format("Received: {0}",
{["origin"]:t.origin,["data"]:t.data,["source"]:t.source}))}static sendMessage(t,m,n){if(!v.a())return u.a.debugAssertTag(5018319,!1,null),!1;try{return t.postMessage(m,n),!0}catch(A){u.a.sendTraceTag(5018320,4,"{0}",{["exception"]:A.message})}return!1}}x.wT=["MessageId","SendTime"];x.FM="*";x._id=0;x.fua=0;Object(w.a)(x,"CrossDocumentMessenger",null,[5,241])},771:function(w,B,a){a.d(B,"a",function(){return f});w=a(0);var b=a(1),c=a(142),h=a(13);class f{static aof(e){f.$=e;b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertDocumentVisibilityObserverService",
!1)?void c.a.resolve(h.W).then(k=>{f.wg=k}):f.$.ia.Od(291,k=>{f.wg=k})}static yna(e,k){return e[Math.round((e.length-1)*k/100)]}static nG(e){return f.wg?f.wg.nG(e):!1}}f.wg=null;f.$=null;Object(w.a)(f,"SessionStatisticsManagerHelper",null,[])},779:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);class b{static jSb(){}static Byb(){}}b.sendTraceTag=b.jSb;b.debugAssertTag=b.Byb;Object(w.a)(b,"BULS",null,[])},780:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);class b{constructor(c){this.MessageId=
c;this.SendTime=0;this.CorrelationId="";this.Values={}}}Object(w.a)(b,"CrossDocumentMessage",null,[])},809:function(w,B,a){a.d(B,"a",function(){return b});const b=c=>{if(Object.keys)c=Object.keys(c);else{const h=[];for(const f in c)h.push(f);c=h}return c}},901:function(w,B,a){w=a(0);var b=a(16),c=a(766),h=a(566),f=a(5),e=a(15),k=a(114);class l{constructor(x,t,m,n){this.origin=x;this.data=t;this.source=m;this.Da=void 0===n?null:n}}Object(w.a)(l,"MessageEventArgs",null,[]);class r{constructor(x,t){this.w6=
null;this.jOb=m=>this.uS?this.uS(new l(m.origin,m.data,m.source,m.Da)):!1;this.nsb=x;this.Bg=t;this.uS=null}get v_(){return this.nsb.value}get SG(){return this.Bg.value}WKa(x,t){this.uS=x;this.w6=this.jOb;this.v_.addHandler(e.a.message,this.w6,t)}bNa(){this.uS=null;this.v_.removeHandler(e.a.message,this.w6)}yAa(x,t){const m=new k.a(0,1,1,()=>{x(t)},7);this.SG.Xh(m)}JFb(x,t){const m=new k.a(0,1,1,()=>{x(t)},7);this.SG.Xh(m)}static get instance(){return r.ona()}static ona(){return new r(new h.a(()=>
f.AFrameworkApplication.v_),new h.a(()=>f.AFrameworkApplication.Pj))}}Object(w.a)(r,"MessageEventHandler",null,[240]);var v=a(779);a.d(B,"a",function(){return u});class u extends c.a{constructor(x,t,m){super(x,t,(void 0===m?null:m)||r.instance,u.sFb)}static sFb(){v.a.sendTraceTag=u.iSb;v.a.debugAssertTag=u.Ayb}static iSb(x,t,m,...n){b.ULS.sendTraceTag.apply(null,[x,204,u.byb(t),m].concat(n))}static Ayb(){}static byb(x){switch(x){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;
case 3:return 10;default:return 100}}}u.BOb="wdPreviousSession";u.myb="wdUserSession";Object(w.a)(u,"CommonCrossDocumentMessenger",c.a,[])},963:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);class b{}b.Wgd="stid";b.Ugd="iid";b.Vgd="DynamicImageProvider.aspx";Object(w.a)(b,"WebServiceConstants",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.tm.js.map/7a563afc0f0e4dd1dc53d7a6497d830a/EwaTS.tm.js.map