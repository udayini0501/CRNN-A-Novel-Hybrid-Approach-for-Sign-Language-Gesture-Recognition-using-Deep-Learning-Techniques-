/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1272:function(w,B,a){(function(b){a.d(B,"a",function(){return I});var c=a(0),h=a(16),f=a(181),e=a(143),k=a(1278),l=a(37),r=a(263),v=a(45),u=a(383),x=a(202),t=a(58),m=a(91),n=a(12),A=a(20),y=a(41),z=a(1279),F=a(1),D=a(107);class I extends l.a{constructor(H,N,U){super();this.rui=k.a.getTypeName();this.TEb=this.uX=this.Yf=null;this.imageHeight=this.imageWidth=0;this.oQa=this.errorMessage=this.tableData=null;this.fvd=
0;this.m2c=!1;this.ETe=L=>{if(L){var J={};if((()=>{let ca=y.d(this.Bxh(L.data));({Ft:J}=ca);return ca})().returnValue){var P=Object(e.a)(Object,J);if("."===P.DataFromPictureWildcard)if(P.SessionId!==this.oQa)h.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(h.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),
P.CmdType){case "ACK":this.m2c=!0;this.Uog.stop();h.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.HPj();0<this.errorMessage.length?this.Gcg():0<this.tableData.length&&this.Zcg();break;case "insert_html":const ca=this.$.qa.ua,T={};var K=A.h(this.$).ga.ra.Ef.clone();T.PasteId=f.a.create().toString();T.DestinationRanges=v.s(v.v(K,this.$));K=P.Parameters.split("|",3);F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveCCforDataFromPictureXLO",
!1)||h.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${K[0]}|${K[1]}|${K[2]}.`);K=P.Parameters.indexOf("|");K=P.Parameters.indexOf("|",K+1);K=P.Parameters.indexOf("|",K+1);T.SourceHtml=P.Parameters.substring(K+1);T.CopyOperationId=null;const Q=ca.Pa(1,ca.ze());Q.pasteHtmlParameters=T;u.a(this.$.userOperationManager,(fa,ha,Ea)=>t.g(ca,"pasteHtmlContent",Q,fa,ha,Ea,null,64),fa=>new x.a(204,0,fa,1),null);this.fvd++;h.ULS.sendTraceTag(523805135,
0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.fvd.toString()}`);D.b("DataFromPictureCompleted")}}}};this.qui=(L,J)=>{if(L=J.annotation)if(!J.parentPath||1>=J.parentPath.length||J.parentPath[1]!==this.oQa)h.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{h.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");
J=L.errorCode;switch(J){case null:case -1:this.errorMessage=n.a.instance.ha(2273);break;case 1:this.errorMessage=n.a.instance.ha(2274);break;case 2:this.errorMessage=n.a.instance.ha(2275)}0<this.errorMessage.length&&h.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${J?J.toString():"null"}.`);this.SCe.stop();this.tableData=L.html;this.m2c&&(0<this.errorMessage.length?this.Gcg():0<this.tableData.length&&this.Zcg())}else h.ULS.sendTraceTag(523805125,
0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=H;this.mj=N;this.uploaderCreator=U;this.initialize()}dispose(){window.removeEventListener("message",this.ETe,!1);this.mj.unregister("DataFromPicture");super.dispose()}Sgj(H,N){h.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let U=new Image;U.onload=()=>{var L=document.createElement("canvas");L.width=U.width;L.height=U.height;const J=L.getContext("2d");
try{J.drawImage(U,0,0,U.width,U.height)}catch(ca){h.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${ca.message}`);return}let P;try{P=L.toDataURL("image/jpeg")}catch(ca){h.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${ca.message}`);return}L=P.split(",");if(2>L.length)h.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{L=L[1];try{var K=window.self.atob(L)}catch(ca){h.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${ca.message}`);return}28E5<K.length?(h.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),N.R2j()):(this.FLj(this.Yf,this.uX,L,U.width,U.height),URL.revokeObjectURL(U.src),U=null,h.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};
U.src=H}Jpj(H,N,U,L){this.Yf=H;this.uX=L;this.uploaderCreator.sxi(this.$,N,U,L,this)}FLj(H,N,U,L,J){this.oQa=f.a.create().toString();this.fvd=0;this.TEb=U;this.imageWidth=L;this.imageHeight=J;this.errorMessage=this.tableData="";this.m2c=!1;this.Uog=this.$.pe.Fi("LoadResource","DataFromPictureTaskpaneLaunch");this.Uog.start();this.wjj(H,N);this.SCe=this.$.pe.Fi("LoadResource","DataFromPictureAnnotation");this.SCe.start();this.Wnk()}Wnk(){if(this.TEb.length){var H=window.self.atob(this.TEb);var N=new Uint8Array(H.length);
for(let U=0;U<H.length;U++)N[U]=H.charCodeAt(U);this.mj.Vnk(N,this.oQa,this.imageWidth,this.imageHeight)}else h.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}wjj(H,N){N.SessionID=this.oQa;N.DataFromPictureAssetId="FA000000050";N.LoadDataFromPictureTaskpane=!0;H=new m.a(-859308420,H.method,H.mode,H.hh,H.tabName);this.$.Ga.Sd(H,N)}Dhd(H){try{const N=b.from(H,"utf16le").toString("base64");return z.a.vMa(this.oQa,N)}catch(N){return h.ULS.sendTraceTag(523805133,
0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}Bxh(H){try{const N=z.a.vMa(this.oQa,H);return b.from(N,"base64").toString("utf16le")}catch(N){return h.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}HPj(){if(this.TEb.length){var H=r.a(this.$).pea("FA000000050"),N={["DataFromPictureWildcard"]:"."};N.imageData=this.Dhd(this.TEb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",
N,U=>{U&&h.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else h.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}Zcg(){if(this.tableData.length){var H=r.a(this.$).pea("FA000000050"),N={["DataFromPictureWildcard"]:"."};N.tableHtml=this.Dhd(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",N,
U=>{U&&h.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else h.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}Gcg(){if(this.errorMessage.length){var H=r.a(this.$).pea("FA000000050"),N={["DataFromPictureWildcard"]:"."};N.errorMessage=this.Dhd(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(H,"onCustomMessage",
N,U=>{U&&h.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else h.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.ETe,!1);this.mj.register(this.mj.p2().L4("DataFromPicture").J4(()=>{}).activateAnnotation({annotationType:this.rui,uu:!1,XU:this.qui}).build())}}
Object(c.a)(I,"DataFromPictureManager",l.a,[569])}).call(this,a(1273).rAg)},1273:function(w,B,a){(function(b){function c(){try{var L=new Uint8Array(1);L.__proto__={__proto__:Uint8Array.prototype,Zwk:function(){return 42}};return"function"===typeof L.subarray&&0===L.subarray(1,1).byteLength}catch(J){return!1}}function h(L,J){if((f.iS?2147483647:1073741823)<J)throw new RangeError("Invalid typed array length");f.iS?(L=new Uint8Array(J),L.__proto__=f.prototype):(null===L&&(L=new f(J)),L.length=J);return L}
function f(L,J,P){if(!(f.iS||this instanceof f))return new f(L,J,P);if("number"===typeof L){if("string"===typeof J)throw Error("If encoding is specified then the first argument must be a string");return l(this,L)}return e(this,L,J,P)}function e(L,J,P,K){if("number"===typeof J)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&J instanceof ArrayBuffer){J.byteLength;if(0>P||J.byteLength<P)throw new RangeError("'offset' is out of bounds");if(J.byteLength<
P+(K||0))throw new RangeError("'length' is out of bounds");J=void 0===P&&void 0===K?new Uint8Array(J):void 0===K?new Uint8Array(J,P):new Uint8Array(J,P,K);f.iS?(L=J,L.__proto__=f.prototype):L=r(L,J);J=L}else if("string"===typeof J){K=L;L=P;if("string"!==typeof L||""===L)L="utf8";if(!f.Rrf(L))throw new TypeError('"encoding" must be a valid string encoding');P=x(J,L)|0;K=h(K,P);J=K.write(J,L);J!==P&&(K=K.slice(0,J));J=K}else J=v(L,J);return J}function k(L){if("number"!==typeof L)throw new TypeError('"size" argument must be a number');
if(0>L)throw new RangeError('"size" argument must not be negative');}function l(L,J){k(J);L=h(L,0>J?0:u(J)|0);if(!f.iS)for(var P=0;P<J;++P)L[P]=0;return L}function r(L,J){var P=0>J.length?0:u(J.length)|0;L=h(L,P);for(var K=0;K<P;K+=1)L[K]=J[K]&255;return L}function v(L,J){if(f.isBuffer(J)){var P=u(J.length)|0;L=h(L,P);if(0===L.length)return L;J.copy(L,0,0,P);return L}if(J){if("undefined"!==typeof ArrayBuffer&&J.buffer instanceof ArrayBuffer||"length"in J)return(P="number"!==typeof J.length)||(P=J.length,
P=P!==P),P?h(L,0):r(L,J);if("Buffer"===J.type&&H(J.data))return r(L,J.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function u(L){if(L>=(f.iS?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.iS?2147483647:1073741823).toString(16)+" bytes");return L|0}function x(L,J){if(f.isBuffer(L))return L.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(L)||
L instanceof ArrayBuffer))return L.byteLength;"string"!==typeof L&&(L=""+L);var P=L.length;if(0===P)return 0;for(var K=!1;;)switch(J){case "ascii":case "latin1":case "binary":return P;case "utf8":case "utf-8":case void 0:return y(L).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*P;case "hex":return P>>>1;case "base64":return F(L).length;default:if(K)return y(L).length;J=(""+J).toLowerCase();K=!0}}function t(L,J,P){var K=!1;if(void 0===J||0>J)J=0;if(J>this.length)return"";
if(void 0===P||P>this.length)P=this.length;if(0>=P)return"";P>>>=0;J>>>=0;if(P<=J)return"";for(L||(L="utf8");;)switch(L){case "hex":L=J;J=P;P=this.length;if(!L||0>L)L=0;if(!J||0>J||J>P)J=P;K="";for(P=L;P<J;++P)L=K,K=this[P],K=16>K?"0"+K.toString(16):K.toString(16),K=L+K;return K;case "utf8":case "utf-8":return A(this,J,P);case "ascii":L="";for(P=Math.min(this.length,P);J<P;++J)L+=String.fromCharCode(this[J]&127);return L;case "latin1":case "binary":L="";for(P=Math.min(this.length,P);J<P;++J)L+=String.fromCharCode(this[J]);
return L;case "base64":return 0===J&&P===this.length?I.O7e(this):I.O7e(this.slice(J,P));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":J=this.slice(J,P);P="";for(L=0;L<J.length;L+=2)P+=String.fromCharCode(J[L]+256*J[L+1]);return P;default:if(K)throw new TypeError("Unknown encoding: "+L);L=(L+"").toLowerCase();K=!0}}function m(L,J,P,K,ca){if(0===L.length)return-1;"string"===typeof P?(K=P,P=0):2147483647<P?P=2147483647:-2147483648>P&&(P=-2147483648);P=+P;isNaN(P)&&(P=ca?0:L.length-1);0>P&&
(P=L.length+P);if(P>=L.length){if(ca)return-1;P=L.length-1}else if(0>P)if(ca)P=0;else return-1;"string"===typeof J&&(J=f.from(J,K));if(f.isBuffer(J))return 0===J.length?-1:n(L,J,P,K,ca);if("number"===typeof J)return J&=255,f.iS&&"function"===typeof Uint8Array.prototype.indexOf?ca?Uint8Array.prototype.indexOf.call(L,J,P):Uint8Array.prototype.lastIndexOf.call(L,J,P):n(L,[J],P,K,ca);throw new TypeError("val must be string, number or Buffer");}function n(L,J,P,K,ca){function T(Ea,ra){return 1===Q?Ea[ra]:
Ea.cwj(ra*Q)}var Q=1,fa=L.length,ha=J.length;if(void 0!==K&&(K=String(K).toLowerCase(),"ucs2"===K||"ucs-2"===K||"utf16le"===K||"utf-16le"===K)){if(2>L.length||2>J.length)return-1;Q=2;fa/=2;ha/=2;P/=2}if(ca)for(K=-1;P<fa;P++)if(T(L,P)===T(J,-1===K?0:P-K)){if(-1===K&&(K=P),P-K+1===ha)return K*Q}else-1!==K&&(P-=P-K),K=-1;else for(P+ha>fa&&(P=fa-ha);0<=P;P--){fa=!0;for(K=0;K<ha;K++)if(T(L,P+K)!==T(J,K)){fa=!1;break}if(fa)return P}return-1}function A(L,J,P){P=Math.min(L.length,P);for(var K=[];J<P;){var ca=
L[J],T=null,Q=239<ca?4:223<ca?3:191<ca?2:1;if(J+Q<=P)switch(Q){case 1:128>ca&&(T=ca);break;case 2:var fa=L[J+1];128===(fa&192)&&(ca=(ca&31)<<6|fa&63,127<ca&&(T=ca));break;case 3:fa=L[J+1];var ha=L[J+2];128===(fa&192)&&128===(ha&192)&&(ca=(ca&15)<<12|(fa&63)<<6|ha&63,2047<ca&&(55296>ca||57343<ca)&&(T=ca));break;case 4:fa=L[J+1];ha=L[J+2];var Ea=L[J+3];128===(fa&192)&&128===(ha&192)&&128===(Ea&192)&&(ca=(ca&15)<<18|(fa&63)<<12|(ha&63)<<6|Ea&63,65535<ca&&1114112>ca&&(T=ca))}null===T?(T=65533,Q=1):65535<
T&&(T-=65536,K.push(T>>>10&1023|55296),T=56320|T&1023);K.push(T);J+=Q}L=K.length;if(L<=N)K=String.fromCharCode.apply(String,K);else{P="";for(J=0;J<L;)P+=String.fromCharCode.apply(String,K.slice(J,J+=N));K=P}return K}function y(L,J){J=J||Infinity;for(var P,K=L.length,ca=null,T=[],Q=0;Q<K;++Q){P=L.charCodeAt(Q);if(55295<P&&57344>P){if(!ca){if(56319<P){-1<(J-=3)&&T.push(239,191,189);continue}else if(Q+1===K){-1<(J-=3)&&T.push(239,191,189);continue}ca=P;continue}if(56320>P){-1<(J-=3)&&T.push(239,191,
189);ca=P;continue}P=(ca-55296<<10|P-56320)+65536}else ca&&-1<(J-=3)&&T.push(239,191,189);ca=null;if(128>P){if(0>--J)break;T.push(P)}else if(2048>P){if(0>(J-=2))break;T.push(P>>6|192,P&63|128)}else if(65536>P){if(0>(J-=3))break;T.push(P>>12|224,P>>6&63|128,P&63|128)}else if(1114112>P){if(0>(J-=4))break;T.push(P>>18|240,P>>12&63|128,P>>6&63|128,P&63|128)}else throw Error("Invalid code point");}return T}function z(L){for(var J=[],P=0;P<L.length;++P)J.push(L.charCodeAt(P)&255);return J}function F(L){var J=
I,P=J.Sck;L=(L.trim?L.trim():L.replace(/^\s+|\s+$/g,"")).replace(U,"");if(2>L.length)L="";else for(;0!==L.length%4;)L+="=";return P.call(J,L)}function D(L,J,P,K){for(var ca=0;ca<K&&!(ca+P>=J.length||ca>=L.length);++ca)J[ca+P]=L[ca];return ca}var I=a(1275);a(1276);var H=a(1277);B.rAg=f;B.evk=function(L){+L!=L&&(L=0);return f.nCe(+L)};B.muk=50;f.iS=void 0!==b.iS?b.iS:c();B.xxk=f.iS?2147483647:1073741823;f.from=function(L,J,P){return e(null,L,J,P)};f.iS&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=
Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.nCe=function(L){k(L);return h(null,L)};f.c3g=function(L){return l(null,L)};f.isBuffer=function(L){return!(null==L||!L.vLg)};f.compare=function(L,J){if(!f.isBuffer(L)||!f.isBuffer(J))throw new TypeError("Arguments must be Buffers");if(L===J)return 0;for(var P=L.length,K=J.length,ca=0,T=Math.min(P,K);ca<T;++ca)if(L[ca]!==J[ca]){P=L[ca];K=J[ca];break}return P<
K?-1:K<P?1:0};f.Rrf=function(L){switch(String(L).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(L,J){if(!H(L))throw new TypeError('"list" argument must be an Array of Buffers');if(0===L.length)return f.nCe(0);var P;if(void 0===J)for(P=J=0;P<L.length;++P)J+=L[P].length;J=f.c3g(J);var K=0;for(P=0;P<L.length;++P){var ca=L[P];if(!f.isBuffer(ca))throw new TypeError('"list" argument must be an Array of Buffers');
ca.copy(J,K);K+=ca.length}return J};f.byteLength=x;f.prototype.vLg=!0;f.prototype.toString=function(){var L=this.length|0;return 0===L?"":0===arguments.length?A(this,0,L):t.apply(this,arguments)};f.prototype.equals=function(L){if(!f.isBuffer(L))throw new TypeError("Argument must be a Buffer");return this===L?!0:0===f.compare(this,L)};f.prototype.compare=function(L,J,P,K,ca){if(!f.isBuffer(L))throw new TypeError("Argument must be a Buffer");void 0===J&&(J=0);void 0===P&&(P=L?L.length:0);void 0===K&&
(K=0);void 0===ca&&(ca=this.length);if(0>J||P>L.length||0>K||ca>this.length)throw new RangeError("out of range index");if(K>=ca&&J>=P)return 0;if(K>=ca)return-1;if(J>=P)return 1;J>>>=0;P>>>=0;K>>>=0;ca>>>=0;if(this===L)return 0;var T=ca-K,Q=P-J,fa=Math.min(T,Q);K=this.slice(K,ca);L=L.slice(J,P);for(J=0;J<fa;++J)if(K[J]!==L[J]){T=K[J];Q=L[J];break}return T<Q?-1:Q<T?1:0};f.prototype.includes=function(L,J,P){return-1!==this.indexOf(L,J,P)};f.prototype.indexOf=function(L,J,P){return m(this,L,J,P,!0)};
f.prototype.lastIndexOf=function(L,J,P){return m(this,L,J,P,!1)};f.prototype.write=function(L,J,P,K){if(void 0===J)K="utf8",P=this.length,J=0;else if(void 0===P&&"string"===typeof J)K=J,P=this.length,J=0;else if(isFinite(J))J|=0,isFinite(P)?(P|=0,void 0===K&&(K="utf8")):(K=P,P=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ca=this.length-J;if(void 0===P||P>ca)P=ca;if(0<L.length&&(0>P||0>J)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");
K||(K="utf8");for(ca=!1;;)switch(K){case "hex":J=Number(J)||0;K=this.length-J;P?(P=Number(P),P>K&&(P=K)):P=K;K=L.length;if(0!==K%2)throw new TypeError("Invalid hex string");P>K/2&&(P=K/2);for(K=0;K<P;++K){ca=parseInt(L.substr(2*K,2),16);if(isNaN(ca))break;this[J+K]=ca}return K;case "utf8":case "utf-8":return D(y(L,this.length-J),this,J,P);case "ascii":return D(z(L),this,J,P);case "latin1":case "binary":return D(z(L),this,J,P);case "base64":return D(F(L),this,J,P);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":K=
L;ca=this.length-J;for(var T=[],Q=0;Q<K.length&&!(0>(ca-=2));++Q){var fa=K.charCodeAt(Q);L=fa>>8;fa%=256;T.push(fa);T.push(L)}return D(T,this,J,P);default:if(ca)throw new TypeError("Unknown encoding: "+K);K=(""+K).toLowerCase();ca=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.xvk||this,0)}};var N=4096;f.prototype.slice=function(L,J){var P=this.length;L=~~L;J=void 0===J?P:~~J;0>L?(L+=P,0>L&&(L=0)):L>P&&(L=P);0>J?(J+=P,0>J&&(J=0)):J>P&&(J=P);J<L&&(J=L);
if(f.iS)J=this.subarray(L,J),J.__proto__=f.prototype;else{P=J-L;J=new f(P,void 0);for(var K=0;K<P;++K)J[K]=this[K+L]}return J};f.prototype.cwj=function(L){if(0!==L%1||0>L)throw new RangeError("offset is not uint");if(L+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[L]<<8|this[L+1]};f.prototype.copy=function(L,J,P,K){P||(P=0);K||0===K||(K=this.length);J>=L.length&&(J=L.length);J||(J=0);0<K&&K<P&&(K=P);if(K===P||0===L.length||0===this.length)return 0;if(0>J)throw new RangeError("targetStart out of bounds");
if(0>P||P>=this.length)throw new RangeError("sourceStart out of bounds");if(0>K)throw new RangeError("sourceEnd out of bounds");K>this.length&&(K=this.length);L.length-J<K-P&&(K=L.length-J+P);var ca=K-P;if(this===L&&P<J&&J<K)for(K=ca-1;0<=K;--K)L[K+J]=this[K+P];else if(1E3>ca||!f.iS)for(K=0;K<ca;++K)L[K+J]=this[K+P];else Uint8Array.prototype.set.call(L,this.subarray(P,P+ca),J);return ca};f.prototype.fill=function(L,J,P,K){if("string"===typeof L){"string"===typeof J?(K=J,J=0,P=this.length):"string"===
typeof P&&(K=P,P=this.length);if(1===L.length){var ca=L.charCodeAt(0);256>ca&&(L=ca)}if(void 0!==K&&"string"!==typeof K)throw new TypeError("encoding must be a string");if("string"===typeof K&&!f.Rrf(K))throw new TypeError("Unknown encoding: "+K);}else"number"===typeof L&&(L&=255);if(0>J||this.length<J||this.length<P)throw new RangeError("Out of range index");if(P<=J)return this;J>>>=0;P=void 0===P?this.length:P>>>0;L||(L=0);if("number"===typeof L)for(K=J;K<P;++K)this[K]=L;else for(L=f.isBuffer(L)?
L:y((new f(L,K)).toString()),ca=L.length,K=0;K<P-J;++K)this[K+J]=L[K%ca];return this};var U=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1274))},1274:function(w){var B=function(){return this}();try{B=B||(new Function("return this"))()}catch(a){"object"===typeof window&&(B=window)}w.exports=B},1275:function(w,B){function a(f){var e=f.length;if(0<e%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=e);return[f,f===e?0:4-f%4]}B.byteLength=function(f){f=a(f);var e=f[1];
return 3*(f[0]+e)/4-e};B.Sck=function(f){var e=a(f);var k=e[0];e=e[1];var l=new h(3*(k+e)/4-e),r=0,v=0<e?k-4:k,u;for(u=0;u<v;u+=4)k=c[f.charCodeAt(u)]<<18|c[f.charCodeAt(u+1)]<<12|c[f.charCodeAt(u+2)]<<6|c[f.charCodeAt(u+3)],l[r++]=k>>16&255,l[r++]=k>>8&255,l[r++]=k&255;2===e&&(k=c[f.charCodeAt(u)]<<2|c[f.charCodeAt(u+1)]>>4,l[r++]=k&255);1===e&&(k=c[f.charCodeAt(u)]<<10|c[f.charCodeAt(u+1)]<<4|c[f.charCodeAt(u+2)]>>2,l[r++]=k>>8&255,l[r++]=k&255);return l};B.O7e=function(f){for(var e=f.length,k=
e%3,l=[],r=0,v=e-k;r<v;r+=16383){for(var u=l,x=u.push,t,m=f,n=r+16383>v?v:r+16383,A=[],y=r;y<n;y+=3)t=(m[y]<<16&16711680)+(m[y+1]<<8&65280)+(m[y+2]&255),A.push(b[t>>18&63]+b[t>>12&63]+b[t>>6&63]+b[t&63]);t=A.join("");x.call(u,t)}1===k?(f=f[e-1],l.push(b[f>>2]+b[f<<4&63]+"==")):2===k&&(f=(f[e-2]<<8)+f[e-1],l.push(b[f>>10]+b[f>>4&63]+b[f<<2&63]+"="));return l.join("")};var b=[],c=[],h="undefined"!==typeof Uint8Array?Uint8Array:Array;for(w=0;64>w;++w)b[w]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[w],
c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(w)]=w;c[45]=62;c[95]=63},1276:function(w,B){B.read=function(a,b,c,h,f){var e=8*f-h-1;var k=(1<<e)-1,l=k>>1,r=-7;f=c?f-1:0;var v=c?-1:1,u=a[b+f];f+=v;c=u&(1<<-r)-1;u>>=-r;for(r+=e;0<r;c=256*c+a[b+f],f+=v,r-=8);e=c&(1<<-r)-1;c>>=-r;for(r+=h;0<r;e=256*e+a[b+f],f+=v,r-=8);if(0===c)c=1-l;else{if(c===k)return e?NaN:Infinity*(u?-1:1);e+=Math.pow(2,h);c-=l}return(u?-1:1)*e*Math.pow(2,c-h)};B.write=function(a,b,c,h,f,e){var k,
l=8*e-f-1,r=(1<<l)-1,v=r>>1,u=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;e=h?0:e-1;var x=h?1:-1,t=0>b||0===b&&0>1/b?1:0;b=Math.abs(b);isNaN(b)||Infinity===b?(b=isNaN(b)?1:0,h=r):(h=Math.floor(Math.log(b)/Math.LN2),1>b*(k=Math.pow(2,-h))&&(h--,k*=2),b=1<=h+v?b+u/k:b+u*Math.pow(2,1-v),2<=b*k&&(h++,k/=2),h+v>=r?(b=0,h=r):1<=h+v?(b=(b*k-1)*Math.pow(2,f),h+=v):(b=b*Math.pow(2,v-1)*Math.pow(2,f),h=0));for(;8<=f;a[c+e]=b&255,e+=x,b/=256,f-=8);h=h<<f|b;for(l+=f;0<l;a[c+e]=h&255,e+=x,h/=256,l-=8);a[c+e-x]|=
128*t}},1277:function(w){var B={}.toString;w.exports=Array.isArray||function(a){return"[object Array]"==B.call(a)}},1278:function(w,B,a){a.d(B,"a",function(){return c});w=a(0);B=a(767);var b=a(741);class c extends B.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new b.a,{T_:c.getTypeName(),B_:c.getBaseTypes()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(w.a)(c,
"DetectedHtmlTableAnnotation",B.a,[])},1279:function(w,B,a){a.d(B,"a",function(){return b});w=a(0);class b{static vMa(c,h){if(!(c&&h&&c.length&&h.length)||256<c.length)return"";const f=Array(256),e=Array(256);let k,l=0,r=0;let v,u="";for(k=0;256>k;k++)f[k]=k;for(k=0;256>k;k++){var x=c.charCodeAt(k%c.length);if(256<=x)return"";l=(l+f[k]+x)%256;x=f[k];f[k]=f[l];f[l]=x}for(k=0;256>k;k++)e[k]=f[256-k-1];l=k=0;for(c=0;c<h.length;c++){k=(k+1)%256;l=(l+f[k])%256;x=f[k];f[k]=f[l];f[l]=x;x=h.charCodeAt(c);
if(256<=x)return"";v=x^f[(f[k]+f[l])%256];r=(r+e[k])%256;x=e[k];e[k]=e[r];e[r]=x;u+=String.fromCharCode(v^f[(e[k]+e[r])%256])}return u}}Object(w.a)(b,"RC4A",null,[])},1327:function(w,B,a){a.r(B);var b={};a.r(b);a.d(b,"DataFromPictureCommandHandler",function(){return Tf});var c={};a.r(c);a.d(c,"PictureCommandHandler",function(){return jh});var h={};a.r(h);a.d(h,"AriaLiveNotifier",function(){return rc});var f={};a.r(f);a.d(f,"GridHighlightBehaviorEventManager",function(){return gg});var e={};a.r(e);
a.d(e,"GridHighlightsBehaviorManager",function(){return cf});var k={};a.r(k);a.d(k,"EwaAccessibilityManager",function(){return qi});var l={};a.r(l);a.d(l,"SessionReloadActivity",function(){return Yi});var r={};a.r(r);a.d(r,"TableManager",function(){return nj});var v={};a.r(v);a.d(v,"SparklineManager",function(){return ph});var u={};a.r(u);a.d(u,"UploaderCreator",function(){return Nh});var x={};a.r(x);a.d(x,"WorkbookReadoutHandler",function(){return bj});var t={};a.r(t);a.d(t,"EmbeddedWorkbookReadoutHandler",
function(){return jj});var m=a(0),n=a(16),A=a(713),y=a(382),z=a(143),F;(function(C){C[C.Rvk=0]="applicationFeatureHelperHandler";C[C.nwk=1]="cloudPolicySettings";C[C.Kvk=2]="alternateAuthToken"})(F||(F={}));Object(m.b)("ApplicationFeatureHelperRequestType",F);class D{constructor(){this.message=null;this.Y8=0}}Object(m.a)(D,"HttpRequstToPromiseRejectData",null,[]);var I=a(102),H=a(65),N=a(220),U=a(474);class L{constructor(C,ea){this.Qa=C;this.kj=ea}CMa(C,ea,Ta,Yb,wc,Hc,rd,ce){Yb=void 0===Yb?null:Yb;
wc=void 0===wc?null:wc;Hc=void 0===Hc?null:Hc;rd=void 0===rd?null:rd;ce=void 0===ce?null:ce;const Le=F[Ta],Ue=Le+"RequestFailure";I.Health.instance.recordKpiUsage(Ue,0,"jpittsdirects",null);return new Promise((mf,rf)=>{n.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",Le);const Of=null!=rd?rd:this.Qa.eg("ApplicationFeatureHelperRequestQueueTimeout",15E3),Ag=null!=ce?ce:this.Qa.eg("ApplicationFeatureHelperRequestSentTimeout",
3E4);this.kj.I6(C,1,null,this.ECb(Ta,Yb),Hc,!1,1,tg=>{n.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Le);try{if(void 0===tg||null===tg||void 0===tg.data||null===tg.data||void 0===tg.data.Fg||null===tg.data.Fg){I.Health.instance.recordKpiFailure(Ue,"Invalid RequestSucceededEventArgs",!1,!0,null);const O=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
Le);rf(this.MK(O,tg))}else if(tg.data.httpStatus!==N.a.sJ){I.Health.instance.recordKpiFailure(Ue,"HttpStatusCode_"+tg.data.httpStatus.toString(),!1,!0,null);const O=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",tg.data.httpStatus,Le);rf(this.MK(O,tg))}else{void 0!==wc&&null!==wc&&void 0!==tg.data.responseHeaders&&null!==tg.data.responseHeaders&&wc(tg.data.responseHeaders);
var mg=ea(tg.data.Fg);if(mg)n.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",Le),mf(mg);else{I.Health.instance.recordKpiFailure(Ue,"Parse Failure",!1,!0,null);const O=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",Le);rf(this.MK(O,tg))}}}catch(O){I.Health.instance.recordKpiFailure(Ue,"Unexpected Failure",!1,!0,null),mg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
O,Le),rf(this.MK(mg,tg))}},tg=>{if(tg.data){I.Health.instance.recordKpiFailure(Ue,"HttpStatusCode_"+tg.data.httpStatus.toString(),!1,!0,null);var mg=U.a.vPa(tg.data.Fg||"No Data");mg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",tg.data.httpStatus,mg,Le)}else I.Health.instance.recordKpiFailure(Ue,"Invalid RequestFailedEventArgs",!1,!0,null),mg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
Le);rf(this.MK(mg,tg))},null,void 0,void 0,Of,Ag)})}MK(C,ea){const Ta=new D;Ta.message=C;Ta.Y8=ea&&ea.data?ea.data.httpStatus:-1;return Ta}ECb(C,ea){const Ta={};Ta["x-UserDataSignature"]=this.Qa.Ra("UserDataSignature");Ta["x-LicensingIsEnabled"]=this.Qa.na("LicensingIsEnabled").toString();Ta["x-CacheIsEnabled"]=this.Qa.na("LicensingRedisIsEnabled").toString();Ta["x-OcpsIsEnabled"]=this.Qa.na("OcpsIsEnabled").toString();Ta["x-LicensingAADIdIsEnabled"]=this.Qa.na("LicensingAadIdIsEnabled").toString();
0===C&&(Ta["x-LicenseCheckOnTenantEnabled"]="true",Ta["x-SupportUserConsentDependentFeatures"]="true",Ta["x-AFHUserConsentGroupValue"]="0",Ta["x-UseShellServiceForUserConsentGroup"]="true",Ta["x-SMBUserLicensingEnabled"]="true",Ta["x-AFHPIPLComplianceEnabled"]=H.a.Ew(window.location.href,"wd_afhpipl")||"false",Ta["x-ConsumerLicensingSNICertIsEnabled"]=this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ConsumerLicensingSNICertIsEnabled",!1).toString(),Ta["x-MSGraphInLicensingIsEnabled"]=
this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MSGraphInLicensingIsEnabled",!1).toString());if(ea)for(const Yb of ea.keys)Ta[Yb]=ea.ka(Yb);return Ta}}Object(m.a)(L,"HttpRequestToPromiseUtility",null,[]);var J=a(5),P;(function(C){C[C.cWi=0]="loki";C[C.Vvk=1]="augloopACLP"})(P||(P={}));Object(m.b)("AlternateAuthSupportApp",P);var K=a(527),ca=a(41);class T{constructor(){this.Token=null;this.ExpirationTime=0}}Object(m.a)(T,"WacAlternateAuthToken",null,[]);class Q{constructor(C,ea){this.Bdk=
3E5;this.Zkj=Ta=>{let Yb=null;({Ft:Yb}=ca.d(Ta));return Yb};if(void 0===C||null===C||void 0===ea||null===ea)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.Qa=C;this.oYb=new A.a(y.a.Ei());this.Fob=new L(C,ea);void 0!==K.a.KFd&&null!==K.a.KFd&&void 0!==K.a.Ctc&&null!==K.a.Ctc&&0<K.a.Ctc&&(C=new T,C.Token=K.a.KFd,C.ExpirationTime=K.a.Ctc,this.oYb.fa("loki",C))}Z1h(){let C=null;this.oYb.Hd(P[0])&&(C=this.oYb.ka(P[0]));return void 0===C||null===C||this.VBd(C)?this.KTh():Promise.resolve(C.Token)}VBd(C){return C.ExpirationTime-
Date.now()<this.Bdk}KTh(){const C=new A.a(y.a.Ei());C.fa("X-AlternateAuthApp",P[0]);return this.Fob.CMa(this.Aea("/afhs/AlternateAuthHelperHandler.ashx"),this.Zkj,2,C).then(ea=>{n.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",P[0]);this.oYb.fa(P[0],ea);return ea.Token},ea=>{ea=Object(z.a)(D,ea);n.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",ea.message,
ea.Y8);return null})}Aea(C){const ea=this.Qa.na("SuiteOriginForAFHSIsEnabled")?this.Qa.Ra("SuiteOrigin"):this.Qa.Ra("WebServiceBase");return String.format("{0}{1}?{2}",ea,C,J.AFrameworkApplication.fl)}}Object(m.a)(Q,"AlternateAuthHelper",null,[197]);var fa=a(467);class ha{constructor(C,ea,Ta){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=C;this.isEnabled=ea;this.tierName=Ta}}Object(m.a)(ha,"FeatureStateChangeArgs",null,[]);var Ea=a(147),ra=a(266),Z=a(30),wa=a(112),la=a(181),
ta;(function(C){C[C.Enabled=0]="Enabled";C[C.Disabled=1]="Disabled"})(ta||(ta={}));Object(m.b)("FeatureState",ta);var Ca=a(81),Ga=a(26),Oa=a(177);class eb{constructor(C,ea,Ta,Yb,wc){Ta=void 0===Ta?null:Ta;Yb=void 0===Yb?null:Yb;wc=void 0===wc?null:wc;this.Kya=this.b3b=this.Nre=this.Qua=this.e4b=null;this.clj=Hc=>{(Hc=ca.b(Hc))?(n.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),n.ULS.sendTraceTag(50938594,3004,50,"{0}",Hc)):n.ULS.sendTraceTag(50436171,
3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return Hc.Features};this.Hni=()=>{n.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Kya.then(Hc=>{this.g3f(Hc)}).catch(()=>{this.g3f({})})};this.Tqj=Hc=>{try{Hc&&"Date"in Hc&&(this.b3b=new Date(Hc.Date),n.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.b3b.toString()))}catch(rd){n.ULS.sendTraceTag(578863818,
3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",rd)}};this.Fob=new L(C,ea);this.Qa=C;this.IMg=C.eg("LicensingMaxRetryAttempts",0);this.F0b=C.na("IsO365ConsumerHost");this.hVc=C.na("IsO365CommercialHost");this.UUc=C.na("PremiumUpsellIsEnabled");this.r0a=!1;this.nWc=0;this.Pee=Ta;this.ewe=Yb;this.Na=wc;this.Pua=C.na("LicensingIsEnabled");this.QIa=C.na("OcpsIsEnabled")&&this.hVc;this.G1c=C.na("ShowPrivacyDialog")&&!!Yb;this.uUc=C.na("IsAnonymousUser");this.xgc=new Promise(Hc=>
{Hc(!1)});this.TFa=new Promise(Hc=>{Hc(!0)});this.Jya=new A.a(y.a.Ei());this.T4b=!0;this.$me=this.Uai();this.Zzd()&&!this.uUc?(void 0!==J.AFrameworkApplication.sa&&null!==J.AFrameworkApplication.sa&&(this.e4b=J.AFrameworkApplication.sa.XE,void 0!==this.e4b&&null!==this.e4b&&(this.Qua=this.e4b.Fi("WebServiceCall","ApplicationFeatureHelperService"))),this.Kya=this.F7d()):this.Kya=new Promise(Hc=>{Hc({})});this.Kya.catch(Hc=>{Hc=Object(z.a)(D,Hc);n.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",
Hc?Hc.Y8.toString():"Unknown")});this.T4b&&this.isFeatureEnabled("FreemiumUpsell",!0).then(Hc=>{this.r0a=Hc;return null})}Uai(){const C=this.Qa.As("AllLicensedFeatures")?this.Qa.By("AllLicensedFeatures"):[],ea=new fa.a;for(let Ta=0;Ta<C.length;Ta++)ea.add(C[Ta]);return ea}Zzd(){return this.hVc||this.F0b}F7d(C,ea){C=void 0===C?0:C;ea=void 0===ea?!1:ea;n.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",ea);const Ta=Ea.a.mu();Ta&&(Ta.set("retryAttempt",
C.toString()),Ta.set("forceRefresh",ea.toString()),Ta.set("isO365ConsumerHost",this.F0b.toString()),Ta.set("isO365CommercialHost",this.hVc.toString()),Ta.set("isFreemiumUpsellSettingEnabled",this.UUc.toString()));I.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",Ta);I.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",Ta);void 0!==this.Qua&&null!==this.Qua&&this.Qua.start();let Yb=null;ea&&(Yb=new A.a(y.a.Ei()),Yb.fa("x-LicensingForceRefresh",
"true"));this.Nre=new Date;return(this.Pua?this.Fob.CMa(this.Aea("/afhs/ApplicationFeatureHelperHandler.ashx"),this.clj,0,Yb,this.Tqj,["Date"]):Promise.resolve({})).then(wc=>{const Hc=Object.assign(new Oa.a,{durationMs:this.Smg()});Hc.extendedProperties=Ta;Hc.extendedProperties&&wc&&(Hc.extendedProperties.set("featureCount",wa.a.count(wc).toString()),Hc.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in wc).toString()),Hc.extendedProperties.set("msoPremiumBadgeEnabled",
("MsoPremiumBadge"in wc).toString()),"FreemiumUpsell"in wc&&Hc.extendedProperties.set("isFreemiumUpsellEnabled",wc.FreemiumUpsell.toString()),this.b3b&&Hc.extendedProperties.set("fromCache",(this.b3b<this.Nre).toString()));I.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Hc);return wc},wc=>{const Hc=Object.assign(new Oa.a,{durationMs:this.Smg()}),rd=Object(z.a)(D,wc);if(!rd)return n.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),
I.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Hc),new Promise((ce,Le)=>{Le(wc)});Hc.extendedProperties=Ta;Hc.extendedProperties&&Hc.extendedProperties.set("status",rd.Y8.toString());I.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Hc);return 408===rd.Y8&&++C<=this.IMg?this.F7d(C):new Promise((ce,Le)=>{Le(rd)})})}Aea(C){var ea=this.Qa.na("SuiteOriginForAFHSIsEnabled")?this.Qa.Ra("SuiteOrigin"):
this.Qa.Ra("WebServiceBase");ea=String.format("{0}{1}",ea,C);this.Qa.As("ApplicationFeatureHelperHttpCachingEnabled")&&this.Qa.na("ApplicationFeatureHelperHttpCachingEnabled")&&(C=eb.Mjc(this.Qa))&&0<C.length&&(this.T4b&&(C+="ucbf"),ea=new ra.QueryStringBuilder(ea),ea.ul("afhskey",C),ea=ea.toString());return ea}isFeatureEnabled(C,ea){if(!this.QIa&&!this.G1c&&!this.Pua)return this.TFa;n.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
C);if("ConnectedServices"===C){var Ta=this.QIa?this.Pee.vC("ControllerConnectedServicesEnabled"):this.TFa;const Hc=this.G1c?this.ewe.getSettings().then(rd=>2!==rd.tx,()=>ea):this.TFa;return Ta.then(rd=>rd?Hc:this.xgc)}if("FreemiumUpsell"===C&&(!this.UUc||!this.F0b||this.uUc))return this.xgc;Ta=null;Ta=this.QIa?this.Pee.isFeatureEnabled(C):this.TFa;let Yb=null;Yb=this.Pua?this.AFi(C,ea):this.TFa;let wc=null;wc=this.G1c?this.ewe.isFeatureEnabled(C):this.TFa;return Ta.then(Hc=>Hc?wc.then(rd=>rd?Yb:this.xgc):
this.xgc).then(Hc=>{this.HBf(C,Hc,!0);return Hc},()=>{this.HBf(C,ea,!1);return ea})}HBf(C,ea,Ta){n.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",C,ea,Ta)}getFeatureTier(C,ea){if(!this.Pua)return new Promise(Ta=>{Ta(2)});n.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",C);return this.Kya.then(Ta=>this.Mkc(C,Ta,ea),()=>ea)}isFreemiumUpsellEnabled(){if(this.UUc&&this.F0b&&!this.uUc){if(this.r0a&&2!==this.nWc||
!this.r0a&&1!==this.nWc)n.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isFreemiumUpsellFeatureEnabled={0}",this.r0a.toString()),this.nWc=this.r0a?2:1;return this.r0a}return!1}launchUpsellExperience(C,ea){ea=void 0===ea?null:ea;n.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",C));var Ta=Ea.a.mu();Ta&&(Ta.set("experienceId",C),ea&&Ta.set("campaignId",ea));I.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",Ta);(Ta=Ca.a.instance.Ii("Common.IInProductMessagingUIManager"))?Ta.Fzf(C,this.Hni,ea):(n.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),I.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Na.Eg(Ga.a.Shc,2,{["experience"]:C}))}kVa(C,ea){if(!this.Pua)return null;if(!C||!ea)return n.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;const Ta=la.a.create().toString();this.Jya.Hd(C)||this.Jya.fa(C,new A.a(y.a.Ei()));this.Jya.ka(C).add(Ta,ea);n.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Ta,C));return Ta}sTd(C,ea){this.Pua&&(C&&this.Jya.Hd(C)?ea&&la.a.isValid(ea)?this.Jya.ka(C).Hd(ea)?(n.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
ea,C)),this.Jya.ka(C).remove(ea)):n.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",ea,C)):n.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",ea,C)):n.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
C)))}Mkc(C,ea,Ta){return this.T4b?C in ea?ea[C].LicenseTier:Ta:C in ea?this.xlj(ea[C],Ta):Ta}xlj(C,ea){switch(C.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return ea}}g3f(C){n.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const ea=this.F7d(0,!0);ea.then(Ta=>{this.Kya=ea;wa.a.count(Ta)>wa.a.count(C)?I.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):I.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess",
"FeatureCountNotIncreased",!1,!0,null);for(const Yb of this.Jya.keys)if(Yb in Ta){const wc=this.Mkc(Yb,Ta,0);Yb in C?this.Mkc(Yb,C,0)!==wc&&this.uJd(Yb,!0,wc):this.uJd(Yb,!0,wc)}else Yb in C&&this.uJd(Yb,!1,this.Mkc(Yb,C,0))}).catch(Ta=>{I.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);n.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(Ta))})}uJd(C,ea,Ta){n.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
C,ea,Ta);ea=new ha(C,ea,Ta);Ta=this.Jya.ka(C);for(const Yb of Ta)try{Yb.value(ea)}catch(wc){n.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",C,Yb.key,wc.message))}}og(C,ea){if(this.Pua){const Ta=this.$me.contains(C);let Yb=!0,wc="",Hc=!1;return this.Kya.then(rd=>{C in rd?(rd=rd[C],wc=ta[rd.FeatureState],Yb=1!==rd.FeatureState):Yb=!Ta;this.UBf(C,Ta,wc,Hc,ea,
Yb);return Yb},()=>{Hc=!0;Ta&&(Yb=ea);this.UBf(C,Ta,wc,Hc,ea,Yb);return Yb})}return this.TFa}UBf(C,ea,Ta,Yb,wc,Hc){n.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",C,ea,Yb,Ta,wc,Hc)}AFi(C,ea){if(this.T4b)return this.og(C,ea);if(this.Pua){if(this.$me.contains(C))return this.Kya.then(Ta=>C in Ta,()=>ea);n.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",
C)}return this.TFa}Smg(){if(void 0!==this.Qua&&null!==this.Qua){const C=this.Qua.pf;this.Qua.stop();return C}return null}static Mjc(C){try{if(Z.a.x$j){const ea=C.Ra("UserDataSignature").split(".");if(1<ea.length){const Ta=window.self.atob(ea[1]),Yb=JSON.parse(Ta).LocalStorageKey;if(void 0!==Yb&&null!==Yb&&0<Yb.length)return Yb}}}catch(ea){n.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",ea.toString())}return null}}Object(m.a)(eb,"ApplicationFeatureHelper",null,[198]);var nb=
a(198);class $a{constructor(C,ea){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=C.PolicySettings;C=new Date;C.setMinutes(C.getMinutes()+ea);this.ExpirationTime=C.getTime()}}Object(m.a)($a,"CloudPolicySettingsCacheData",null,[]);var oa=a(805),Fa=a(469),X=a(269);class va{static Ykg(){return J.AFrameworkApplication.da.na("SideCarIsEnabled")?va.bEc&&va.qyd?new Promise(C=>{C(!0)}):new Promise((C,ea)=>{va.bEc=X.a.create(J.AFrameworkApplication.da.Ra("SideCarUrl"));Fa.a.uya(va.bEc);
va.bEc.Qka((Ta,Yb)=>{(va.qyd=Yb.succeeded)?C(Yb.succeeded):ea(Yb.succeeded)})}):new Promise(C=>{C(!1)})}}va.qyd=!1;va.bEc=null;Object(m.a)(va,"SideCarLoader",null,[]);class xa{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(m.a)(xa,"CloudPolicySettingsData",null,[]);class Pa{constructor(C,ea){this.TPc=0;this.fac=null;this.dlj=Ta=>{let Yb=null;({Ft:Yb}=ca.d(Ta));Ta=!!Yb;n.ULS.sendTraceTag(50622687,3004,Ta?50:10,"ParseCloudPolicySettingsResponse: Success={0}",
Ta);return Yb};this.Yqj=Ta=>{try{if(void 0!==Ta&&null!==Ta&&"CheckIn-Interval"in Ta){const Yb=parseInt(Ta["CheckIn-Interval"]);void 0!==Yb&&null!==Yb&&0<Yb&&(this.TPc=Yb)}}catch(Yb){n.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Yb)}};this.Fob=new L(C,ea);this.Qa=C;ea=C.Ra("HostAuthType");this.QIa=C.na("OcpsIsEnabled")&&C.na("IsO365CommercialHost")&&!(void 0===ea||null===ea)&&"aad"===ea.toLowerCase();this.ipe=ca.b(C.Ra("OcpsDefaultSettings")||"{}");this.Dpb=
this.Mjc();ea=this.Qa.As("ServicesControlsMicrosoftControllerServicesList")?this.Qa.By("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.qZb=new fa.a;for(let Ta=0;Ta<ea.length;Ta++)this.qZb.add(ea[Ta]);this.QIa&&!C.na("IsAnonymousUser")&&C.na("SideCarIsEnabled")?this.fac=this.Jgk():this.fac=this.Zsa(this.QIa,this.Aea("/afhs/CloudPolicySettings.ashx"),this.dlj);this.fac.then(()=>null).catch(Ta=>{Ta=Object(z.a)(D,Ta);n.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",
Ta?Ta.Y8.toString():"Unknown")})}vC(C,ea,Ta){ea=void 0===ea?!0:ea;Ta=void 0===Ta?!0:Ta;if(!this.QIa){const rd=this;return new Promise(ce=>{ce(rd.VCb(C))})}const Yb=this,wc=this,Hc=this.fac.then(rd=>{try{let ce=null;rd.PolicySettings&&"unknown"in rd.PolicySettings&&(ce=rd.PolicySettings.unknown);if(ce){if(C in ce&&void 0!==ce[C]&&null!==ce[C])return new Promise(Ue=>{Ue("0"!==ce[C])});const Le=C.toLowerCase();if(Le in ce&&void 0!==ce[Le]&&null!==ce[Le])return new Promise(Ue=>{Ue("0"!==ce[Le])});if(Ta)return n.ULS.sendTraceTag(51512667,
3004,50,"Policy"+C+" not found, using default"),new Promise(Ue=>{Ue(Yb.VCb(C))});n.ULS.sendTraceTag(508395746,3004,50,"Policy"+C+" not found, returning PolicyNotConfigured error");return new Promise((Ue,mf)=>{mf("PolicyNotConfigured")})}return new Promise(Le=>{Le(Yb.VCb(C))})}catch(ce){return n.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+C+" policy value. Error Message: {0}",ce.message),Yb.handleError(ce.toString(),ea,Yb.VCb(C))}},rd=>wc.handleError(rd,ea,wc.VCb(C)));Hc.then(rd=>{n.ULS.sendTraceTag(50651667,
3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",C,rd);return null});return Hc}isFeatureEnabled(C,ea){ea=void 0===ea?!0:ea;if(this.Qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.CFi(C,ea);let Ta=new Promise(wc=>{wc(!0)}),Yb="";this.qZb.contains(C)&&(Yb="ControllerConnectedServicesEnabled",Ta=this.vC(Yb,ea));Ta.then(wc=>{n.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
C,wc,Yb);return null});return Ta}CFi(C,ea){ea=void 0===ea?!0:ea;let Ta=new Promise(wc=>{wc(!0)}),Yb="";"mso_sendASmile"===C?Yb="Enabled":"Survey"===C||"FloodgateSurvey"===C?Yb="SurveyEnabled":this.qZb.contains(C)&&(Yb="ControllerConnectedServicesEnabled");""!==Yb&&(Ta=this.vC(Yb,ea));Ta.then(wc=>{n.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",C,wc,Yb);return null});return Ta}handleError(C,ea,Ta){return ea?new Promise(Yb=>
{Yb(Ta)}):new Promise((Yb,wc)=>{wc(C)})}Zsa(C,ea,Ta){if(!C)return Promise.resolve(new xa);let Yb=!1,wc=null;I.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let Hc=this.Kcd("GetCloudPolicySettings");return(new Promise((rd,ce)=>{if(void 0!==this.Dpb&&null!==this.Dpb&&0<this.Dpb.length){const Le=this.vgk();if(void 0!==Le&&null!==Le){Yb=!0;rd(Le);return}}this.Fob.CMa(ea,Ta,1,null,this.Yqj,["CheckIn-Interval"],this.Qa.eg("CloudPolicySettingsRequestQueueTimeout",15E3),
this.Qa.eg("CloudPolicySettingsRequestSentTimeout",3E4)).then(Le=>{n.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.jhk(Le);rd(Le);return Le},Le=>{ce(Le);return null})})).then(rd=>{({stopwatch:Hc,returnValue:wc}=this.dIc(Hc));var ce=Ea.a.mu();ce&&ce.set("FromCache",Yb.toString());ce=Object.assign(new Oa.a,{durationMs:wc,extendedProperties:ce});I.Health.instance.recordKpiSuccess("GetCloudPolicySettings",ce);return rd})}Jgk(){return va.Ykg().then(()=>{n.ULS.sendTraceTag(593282845,
3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Aea(C){const ea=this.Qa.na("SuiteOriginForAFHSIsEnabled")?this.Qa.Ra("SuiteOrigin"):this.Qa.Ra("WebServiceBase");return String.format("{0}{1}",ea,C)}VCb(C){return C in this.ipe?"0"!==this.ipe[C]:!0}vgk(){try{const C=oa.a.instance.getItem(this.Dpb);if(void 0===C||null===C)return n.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),
null;n.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",C);const ea=JSON.parse(C);if(void 0===ea||null===ea)return n.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===ea.ExpirationTime||null===ea.ExpirationTime)return n.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),
null;if((new Date(ea.ExpirationTime)).getTime()<Date.now())return n.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const Ta=new xa;Ta.PolicySettings=ea.PolicySettings;Ta.ControllerConnectedServicesFeatureNames=new nb.a;this.Qa.As("ServicesControlsMicrosoftControllerServicesList")&&this.Qa.By("ServicesControlsMicrosoftControllerServicesList");for(const Yb of this.qZb)Ta.ControllerConnectedServicesFeatureNames.add(Yb);n.ULS.sendTraceTag(51662941,3004,
50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Ta}catch(C){return n.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",C.toString()),null}}jhk(C){try{if(void 0===C||null===C||void 0===C.PolicySettings||null===C.PolicySettings)n.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.TPc)n.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");
else{const ea=new $a(C,this.TPc),Ta=JSON.stringify(ea);n.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Ta);oa.a.instance.setItem(this.Dpb,Ta);n.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(ea){n.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",ea.toString())}}Mjc(){const C=eb.Mjc(this.Qa);return C&&0<C.length?"OCPS"+C:null}Kcd(C){const ea=Ca.a.instance.Ii("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");
return void 0!==ea&&null!==ea?ea.xf("WebServiceCall",C):null}dIc(C){if(void 0!==C&&null!==C){const ea=C.pf;C.stop();return{returnValue:ea,stopwatch:null}}return{returnValue:null,stopwatch:C}}}Object(m.a)(Pa,"CloudPolicySettingsHelper",null,[195]);class Ka{constructor(){this.lXe=this.Ywg=this.tx=0;this.mXe=this.Zwg=this.uMa="";this.m0c=this.Gia=2}clone(){const C=new Ka;C.tx=this.tx;C.Ywg=this.Ywg;C.lXe=this.lXe;C.uMa=this.uMa;C.Zwg=this.Zwg;C.mXe=this.mXe;C.Gia=this.Gia;C.m0c=this.src;return C}get src(){return this.m0c}serialize(C){C=
void 0===C?null:C;const ea={};if(!C||C.contains(Ka.mTa))ea[Ka.mTa]=this.tx;if(!C||C.contains(Ka.PLb))ea[Ka.PLb]=this.uMa;if(!C||C.contains(Ka.QLb))ea[Ka.QLb]=this.Gia;return JSON.stringify(ea)}static create(C,ea){ea=void 0===ea?null:ea;const Ta=new Ka;Ta.m0c=C;void 0!==ea&&null!==ea&&(Ka.mTa in ea&&(Ta.tx=ea[Ka.mTa]),Ka.PLb in ea&&(Ta.uMa=ea[Ka.PLb]),Ka.QLb in ea&&(Ta.Gia=ea[Ka.QLb]));return Ta}static deserialize(C,ea){try{const Ta=JSON.parse(C);if(void 0!==Ta&&null!==Ta)return Ka.create(ea,Ta);n.ULS.sendTraceTag(50860946,
306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",C);throw Error.argument("settingsData");}catch(Ta){throw n.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",Ta.toString()),Ta;}}}Ka.mTa="CCS";Ka.PLb="CCSTime";Ka.QLb="OfficePrivacyRoamedNoticeShown";Object(m.a)(Ka,"UserPrivacySettings",null,[]);var Bb=a(144);class xb{constructor(C,ea){if(void 0===C||null===C||void 0===ea||null===ea)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.Qa=C;this.kj=ea;this.F_c=this.Qg=null}Aea(C){var ea=String.format("{0}RoamingServiceHandler.ashx?action=",this.Qa.appSettings.RoamingServiceHandlerWebServiceBase||"");ea=new Sys.StringBuilder(ea);ea.append(C);ea.append("&");ea.append(J.AFrameworkApplication.fl);return ea.toString()}executeRequest(C,ea,Ta,Yb){return this.kj.O2a(C,ea,void 0===Yb?null:Yb,null,Ta,"33",!1,null,6E4)}saveSettings(C){return new Promise((ea,Ta)=>{try{if(void 0===this.Qg||null===this.Qg||void 0===C||null===C)n.ULS.sendTraceTag(51258443,
3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),Ta("Can't determine setting changes to save");else{var Yb=this.Qg.tx!==C.tx;if(2===this.Qg.src&&Yb)this.EMj(C),ea(!0);else{var wc=this.FQj(C);if(void 0===wc||null===wc||!wc.length)n.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),Ta("No changes to save");else if(1===this.Qg.src)ea(this.xsg(wc));else if(0===this.Qg.src){n.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",
wc);const Hc=this.executeRequest(this.Aea("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",wc);Hc.continueWith(()=>{if(Hc.Yj||Hc.vi)n.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),ea(!1);else{var rd=Hc.result;void 0!==rd.Aj&&null!==rd.Aj&&void 0!==rd.Aj.data&&null!==rd.Aj.data&&rd.Aj.data.httpStatus===N.a.sJ?(n.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),ea(!0)):(n.ULS.sendTraceTag(51258446,3004,
10,"SaveUserPrivacySettings: Roaming Request Failed"),ea(!1))}})}}}}catch(Hc){n.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",Hc.toString()),ea(!1)}})}FQj(C){if(void 0===this.Qg||null===this.Qg||void 0===C||null===C)throw Error.invalidOperation("User Privacy settings have not been initialized");const ea=new nb.a;0===C.src?(this.Qg.tx!==C.tx&&(ea.add(Ka.mTa),ea.add(Ka.PLb)),this.Qg.Gia!==C.Gia&&ea.add(Ka.QLb)):1===C.src&&this.Qg.tx!==C.tx&&ea.add(Ka.mTa);return ea.count?
C.serialize(ea):(n.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)}getSettings(){if(!this.F_c){const C=this;this.F_c=new Promise(ea=>{try{C.Qg?ea(C.Qg.clone()):C.Dgk().then(Ta=>{C.Qg=Ta;ea(C.Qg.clone());return null},()=>{C.Bgk().then(Ta=>{C.Qg=Ta;ea(C.Qg.clone());return null},()=>{C.Cgk().then(Ta=>{C.Qg=Ta;ea(C.Qg.clone());return null},()=>{n.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");
C.Qg=new Ka;ea(C.Qg.clone());return null});return null});return null})}catch(Ta){n.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",Ta.toString()),C.Qg=new Ka,ea(C.Qg.clone())}})}return this.F_c}Dgk(){return new Promise((C,ea)=>{try{const Yb=-1!==window.location.href.indexOf("&wd_pn=2");if(this.Qa.na("PrivacyDialogShouldCheckRoaming")||Yb){var Ta=this.executeRequest(this.Aea("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");Ta.continueWith(()=>{try{if(Ta.Yj||
Ta.vi)n.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const wc=Ta.result;if(wc&&wc.Aj&&wc.Aj.data)if(wc.Aj.data.httpStatus!==N.a.sJ)n.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",wc.Aj.data.httpStatus);else{if(wc.Aj.data.Fg){C(xb.parse(wc.Aj.data.Fg,0));n.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",wc.Aj.data.Fg);
return}n.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else n.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");ea("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(wc){n.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",wc.toString()),ea("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else n.ULS.sendTraceTag(50860933,
3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),ea("Roaming should not be used")}catch(Yb){n.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",Yb.toString()),ea("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}Bgk(){return new Promise((C,ea)=>{try{const Ta=Bb.a.get("WacUPToggleState");let Yb=null;void 0!==Ta&&null!==Ta&&0<Ta.length&&(Yb=decodeURIComponent(Ta));if(void 0!==Yb&&null!==Yb&&0<Yb.length){const wc=xb.parse(Yb,
1);n.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",wc.toString());C(wc)}else{const wc=Ka.create(1),Hc=new nb.a;Hc.add(Ka.mTa);const rd=wc.serialize(Hc);this.xsg(rd)?(n.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",rd),C(wc)):(n.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",rd),ea("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Ta){n.ULS.sendTraceTag(50860941,
3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",Ta.toString()),ea("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}Cgk(){return new Promise(C=>{try{var ea=-1!==window.location.href.indexOf("&wdccsoff=1");const Ta=Ka.create(2);ea?(Ta.tx=2,J.AFrameworkApplication.RVe(),n.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Ta.toString())):(Ta.tx=1,n.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
Ta.toString()));C(Ta)}catch(Ta){n.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",Ta.toString()),ea=Ka.create(2),ea.tx=1,C(ea)}})}EMj(C){n.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===C.tx?J.AFrameworkApplication.RVe():J.AFrameworkApplication.kGh();n.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",C)}xsg(C){try{n.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",
C);const ea=this.Qa.Ra("PrivacyCookieDomain")||"";if(!ea||!ea.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");n.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",C);return Bb.a.b0d("WacUPToggleState",C,Bb.a.lZ,"/",ea)}catch(ea){return n.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",ea.toString()),!1}}isFeatureEnabled(C){return this.getSettings().then(ea=>{const Ta=this.Qa.As("ServicesControlsMicrosoftControllerServicesList")?
this.Qa.By("ServicesControlsMicrosoftControllerServicesList"):[],Yb=new fa.a;for(let wc=0;wc<Ta.length;wc++)Yb.add(Ta[wc]);return Yb.contains(C)?2!==ea.tx:!0},()=>{n.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",C);return!0})}static parse(C,ea){try{return n.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",C,ea),Ka.deserialize(C,ea)}catch(Ta){throw n.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Ta.toString()),
Ta;}}}Object(m.a)(xb,"UserPrivacySettingsHelper",null,[196]);var Ua=a(260);class Jb{constructor(){this.Fd=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}nk(C){this.Fd=C;this.Fd.register(195,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").Ve().$e(()=>new Pa(J.AFrameworkApplication.da,J.AFrameworkApplication.Wf));this.Fd.register(196,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").Ve().$e(()=>new xb(J.AFrameworkApplication.da,
J.AFrameworkApplication.Wf));this.Fd.register(197,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").Ve().$e(()=>new Q(J.AFrameworkApplication.da,J.AFrameworkApplication.Wf));this.Fd.register(198,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").Ve().$e(()=>new eb(J.AFrameworkApplication.da,J.AFrameworkApplication.Wf,this.Fd.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Fd.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
J.AFrameworkApplication.Vd))}init(){J.AFrameworkApplication.da.Jw(()=>{const C=this.Fd.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");J.AFrameworkApplication.da.na("LicensingIsEnabled")&&(C.isFeatureEnabled("LicensingTestFeature",!1).then(ea=>{n.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",ea,J.AFrameworkApplication.da.Ra("IsAnonymousUser"));return null}),C.getFeatureTier("LicensingTestFeature",
0).then(ea=>{n.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",ea,J.AFrameworkApplication.da.Ra("IsAnonymousUser"));return null}));this.Fd.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.Yak()})}dispose(){}Yak(){try{J.AFrameworkApplication.da.na("SideCarIsEnabled")&&va.Ykg().then(C=>{n.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",
C);return C})}catch(C){}}static main(){Ua.a.instance.$k(new Jb)}}Object(m.a)(Jb,"ApplicationFeatureHelperPackage",null,[3,4]);var fc=a(2),ya=a(233),ob=a(33),Sb=a(331),Ba=a(330),Ia=a(24),cb=a(1),Kb=a(37),db=a(384),gb=a(12);class yb extends db.a{constructor(C){super(C);this.Fih=()=>{n.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};n.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");this.ke=0;this.Ke(1,gb.a.instance.ha(2260));
C=gb.a.instance.ha(2258);const ea=this.hG();this.initializeAndShow(C,this.Fih,ea)}get Pe(){return"ClipboardReadPermissionAskDialog"}hG(){const C={};C.id=this.Pe;const ea=gb.a.instance.ha(2259);C.DialogMessage=ea;return C}}Object(m.a)(yb,"ClipboardReadPermissionAskDialog",db.a,[]);var Nb=a(55);const qc=(C,ea,Ta,Yb,wc)=>{const Hc=C.Stopwatch,rd={};rd.a=wc;rd.e=Hc.id;rd.c="RearrangeRowColumn";rd.b="mouse";rd.d=C.OperationId.toString();rd.f=Ta.toString();rd.g=Yb.toString();rd.h=ea.toString();rd.i=C.DragDropIsShiftKeyDown;
rd.j=!0;rd.o=Hc.pf;rd.q=!1;rd.r=C.CopyPasteTargetType.toString();rd.s=C.EncounteredDeploymentErrors;return rd};class Gb{constructor(C,ea){this.ZZh=()=>{const Ta={};Ta.SourceItem=this.toString();return Ta};this.sessionStateId=C;this.sessionId=ea;this.toJSON=this.ZZh}Vrf(C){return C?this.sessionStateId===C.sessionStateId&&this.sessionId===C.sessionId:!1}isFromCurrentSession(C){return this.sessionId===C.xa.UserSessionId}}Object(m.a)(Gb,"SourceItem",null,[]);class hb extends Gb{constructor(C,ea,Ta,Yb,
wc){super(Ta,Yb);this.activeFloatingObjectControlId=C;this.sheetName=ea;this.type=wc}isEqual(C){return C&&Object.getType(C)===hb?this.Vrf(C)&&this.activeFloatingObjectControlId===C.activeFloatingObjectControlId&&this.sheetName===C.sheetName:!1}toString(){return this.type.toString()}}Object(m.a)(hb,"ArtSourceItem",Gb,[]);var qb;(function(C){C[C.valid=0]="valid";C[C.notPairwiseDisjoint=1]="notPairwiseDisjoint";C[C.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";
C[C.notValidForm=3]="notValidForm";C[C.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(qb||(qb={}));Object(m.b)("CopySourceValidationOptions",qb);var ab=a(45);class Mb extends Gb{constructor(C,ea,Ta,Yb,wc){super(Yb,wc);n.ULS.shipAssertTag(537167645,0,!!ea&&0<ea.length,"RangeSourceItem.ctor: ranges should not be null or empty");this.$=C;this.ranges=ea;this.sheetName=Ta}isEqual(C){return C&&Object.getType(C)===Mb?this.Vrf(C)&&ab.R(this.ranges,C.ranges)&&this.sheetName===C.sheetName:!1}toString(){return ab.i(this.ranges,
",",this.$,!1)}}Object(m.a)(Mb,"RangeSourceItem",Gb,[]);const Ib=C=>!!C&&Object.getType(C)===Mb;class fb{}fb.yok="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(m.a)(fb,"ExpectedErrorNames",null,[]);class Db{}Db.plainText="text/plain";Db.html="text/html";Db.png="image/png";Db.shadowWorkbook="data/shadow-workbook";Db.KHi="metadata/is-last-copy-was-external";Db.CDi="metadata/is-last-copy-was-external-XLO-source";Db.ehh="metadata/chrome-extension-id";Db.scd="copyId";Db.a2g="metadata/additional-signature-data-attributes";
Object(m.a)(Db,"ClipboardDataFormat",null,[]);const Za=C=>C.clipboardItems&&(C=C.clipboardItems.getItem(Db.KHi))&&"1"===C?!0:!1,sb=C=>Za(C)&&!(void 0===C.clipboardItems||null===C.clipboardItems)&&!!C.clipboardItems.getItem(Db.png)&&!C.clipboardItems.getItem(Db.plainText),sa=C=>C.clipboardItems&&(C=C.clipboardItems.getItem(Db.CDi))&&"1"===C?!0:!1,ba=C=>C&&(C=C.getCachedMetadata(),null===C||void 0===C?0:C.lastCopy)?C.lastCopy:null;var ua=a(51),R=a(20),Y=a(43);class La{constructor(C,ea,Ta,Yb){this.$=
C;this.originalDestinations=ea;this.kgc=Ta;this.eFg=Yb;this.kPg=this.originalDestinations;this.ZIg=this.kgc;this.EMg="PasteRecoveryUI"}get $1g(){return this.eFg}get Szf(){return this.EMg}get wxj(){return this.kPg}get k4e(){return this.ZIg}pza(){return La.Qlj}$6h(){return this.kgc&&1===this.kgc.length?this.a7h(this.kgc[0]):null}rod(){return"PasteRecoveryUI-Floatie"}a7h(C){var ea=R.h(this.$);const Ta=ea.Gd.xk(C);var Yb=ea.hj(C,Ta);ea=ea.rtl;if(!Yb)return null;C=R.h(this.$).mi(Ta);const wc=C.so;if(!wc.If(Yb))return null;
Yb=wc.Sg(Yb);const Hc=Yb.topLeft.y;var rd=Yb.bottomRight.y;const ce=ea?Yb.bottomRight.x:Yb.topLeft.x;Yb=ea?Yb.topLeft.x:Yb.bottomRight.x;var Le=new ua.a(Yb+(ea?-81:81),rd+38+6);if(wc.Wla(Le))return this.F9a(C,wc,Ta,Yb,rd,ea?12:-3,66);Le=new ua.a(Yb+(ea?-81:81),rd);if(wc.Wla(Le))return this.F9a(C,wc,Ta,Yb,rd,ea?20:3,22);Le=new ua.a(Yb,rd+38+6);if(wc.Wla(Le))return this.F9a(C,wc,Ta,Yb,rd,-81+(ea?18:0),66);Yb=new ua.a(ce+(ea?81:-81),rd);if(wc.Wla(Yb))return this.F9a(C,wc,Ta,ce,rd,-81+(ea?12:-6),22);
rd=new ua.a(ce,Hc-38-6);return wc.Wla(rd)?this.F9a(C,wc,Ta,ce,Hc,ea?15:0,16):this.F9a(C,wc,Ta,ea?wc.topLeft.x:wc.bottomRight.x,wc.bottomRight.y,-81+(ea?15:-6),22)}F9a(C,ea,Ta,Yb,wc,Hc,rd){var ce=R.h(this.$);const Le=ce.rtl;C=Sys.UI.DomElement.getLocation(C.domElement);Yb=new Sys.UI.Point(Yb+(Le?0:C.x)-ea.topLeft.x,wc+C.y-ea.topLeft.y);Le&&(ce=ce.view.visibleArea,Yb.x=ce.bottomRight.x-ce.topLeft.x-Yb.x,2===Ta||4===Ta)&&(Yb.x+=ea.bottomRight.x);Yb=Y.a(this.$).Ina(Yb);return new Sys.UI.Point(Yb.x+Hc,
Yb.y+rd)}}La.Qlj=["PasteRecoveryUI"];Object(m.a)(La,"PasteRecoveryUI",null,[826]);var Ma=a(76),lb=a(525);class pb{}pb.uUg="ActiveSelection";pb.shadowWorkbook="ShadowWorkbook";pb.MBg="GVML";pb.plainText="PlainText";pb.html="Html";pb.B8g="Bitmap";Object(m.a)(pb,"PayloadType",null,[]);class Vb{}Vb.P5j="Slice6";Object(m.a)(Vb,"SliceName",null,[]);class Wa{}Wa.d2i="NotCalled";Wa.success="Success";Wa.failed="Failed";Object(m.a)(Wa,"SucceededPopulatingSystemClipboardOptions",null,[]);var ka=a(346);const Sa=
(C,ea)=>C?ea&&ea.xa?C.sessionId!==ea.xa.UserSessionId:(n.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(n.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1),Xb=C=>{switch(C){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}},Mc=C=>{if(!C)return"null";const ea=[];for(const Ta of C.get())ea.push(`${Ta.clipboardDataFormat}(${Ta.data.length})`);ea.sort();return ea.join(",")};var jc;(function(C){C[C.valid=0]="valid";C[C.destinationRangesIsEmpty=
1]="destinationRangesIsEmpty";C[C.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";C[C.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";C[C.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";C[C.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";C[C.sourceAndDestinationAreOverlapping=
6]="sourceAndDestinationAreOverlapping";C[C.copySourceNotValid=7]="copySourceNotValid";C[C.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";C[C.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";C[C.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";C[C.unknown=100]="unknown"})(jc||(jc={}));Object(m.b)("PasteValidationOptions",jc);var $c=a(62),Jd=a(161),fd=a(40),Kd=a(174),Yd=a(356),te=a(34),ve=a(283),qe=a(11),pc=a(22),nd=a(136),
qd=a(135),tb=a(578),Dc=a(108),Tc=a(63),ub=a(94);class Pb extends Sys.EventArgs{constructor(C,ea,Ta){super();this.command=C;this.destinationRange=ea;this.sourceRange=Ta}}Object(m.a)(Pb,"PasteCSERenderedEventArgs",Sys.EventArgs,[]);var ee=a(131),Ad=a(142),Ub=a(13);class tc extends La{constructor(C,ea,Ta,Yb){super(C,ea,Ta,Yb);this.AQi="DragRecoveryUI"}get Szf(){return this.AQi}pza(){return tc.KDh}rod(){return"DragRecoveryUI-Floatie"}}tc.KDh=["DragRecoveryUI"];Object(m.a)(tc,"DragFillRecoveryUI",La,[]);
var yc=a(654);class Sd extends db.a{constructor(C,ea,Ta){super(C);this.ke=0;this.initializeAndShow(gb.a.instance.ha(1060),ea,Ta)}get Pe(){return"CopyPasteShortcutReactDialog"}}Object(m.a)(Sd,"CopyPasteShortcutReactDialog",db.a,[]);var Fd=a(385);class se{constructor(C){this.NM=null;this.Lwb=ea=>{this.NM(1===ea?se.qad:yc.a[ea],!1);se.zUa=!1};this.$=C}showDialog(C,ea,Ta,Yb){this.NM=Yb;lb.a.uzd&&(se.aHb=Z.a.isMac||Z.a.Dj);this.NM||(this.NM=()=>{});se.zUa?Yb(se.pad,!1):(se.zUa=!0,ea={},C?(ea.forwardElementText=
gb.a.instance.ha(1061),ea.cutText=se.aHb?gb.a.instance.ha(1050):gb.a.instance.ha(1062),ea.copyText=se.aHb?gb.a.instance.ha(1051):gb.a.instance.ha(1063),ea.pasteText=se.aHb?gb.a.instance.ha(1052):gb.a.instance.ha(1064),ea.pasteTextOnly=se.aHb?gb.a.instance.ha(1055):gb.a.instance.ha(1065)):(ea.forwardElementText=gb.a.instance.ha(1066),ea.cutText=gb.a.instance.ha(1067)),new Sd(this.$,this.Lwb,{[Fd.a.kv]:se.id,["bodyControls"]:ea}))}}se.zUa=!1;se.aHb=!1;se.pad="notOpened";se.qad="ok";se.id="CopyPasteShortcutDialog";
Object(m.a)(se,"CopyPasteShortcutDialog",null,[825]);var uc=a(39);class Ra extends db.a{constructor(C,ea,Ta){super(C);this.ke=0;this.Ke(1,gb.a.instance.ha(1054));this.K4(1);this.initializeAndShow(gb.a.instance.ha(1046),ea,Ta)}get Pe(){return"CopyPasteInstallReactDialog"}}Object(m.a)(Ra,"CopyPasteInstallReactDialog",db.a,[]);class vb{constructor(C){this.NM=null;this.Lwb=ea=>{1===ea?(n.ULS.sendTraceTag(508359137,0,50,"User clicked the install button"),this.Lph(),this.toj(),this.NM(vb.qad,!0)):(n.ULS.sendTraceTag(508359136,
0,50,"User clicked the cancel button"),this.NM(yc.a[ea],!1));vb.zUa=!1};this.$=C}showDialog(C,ea,Ta,Yb){this.NM=Yb=void 0===Yb?()=>{}:Yb;ea=Z.a.isMac||Z.a.Dj;vb.zUa?Yb(vb.pad,!1):(vb.zUa=!0,Yb={},C&&(Yb.extensionStartText=Yb.extensionStartText=Z.a.$pc?gb.a.instance.ha(1048):gb.a.instance.ha(1047),Yb.extensionLink=null,Yb.extensionEndText=null,Yb.shortcutsMessageText=gb.a.instance.ha(1049),Yb.cutText=ea?gb.a.instance.ha(1050):gb.a.instance.ha(1062),Yb.copyText=ea?gb.a.instance.ha(1051):gb.a.instance.ha(1063),
Yb.pasteText=ea?gb.a.instance.ha(1052):gb.a.instance.ha(1064),Yb.pasteTextOnly=ea?gb.a.instance.ha(1055):gb.a.instance.ha(1065)),new Ra(this.$,this.Lwb,{[Fd.a.kv]:vb.id,["bodyControls"]:Yb}))}Lph(){void Ad.a.resolve(Ub.p,{Oa:0}).then(C=>{C.ej(68,null)})}toj(){const C=this.$.xa;uc.a.rh(`${C.ChromeClipboardAccessExtensionLink}${Z.a.$pc?C.ChromeClipboardAccessExtensionId:C.OfficeOnlineChromeExtensionId}`,"_blank",void 0,"ChromeCCPInstallDialog")}}vb.zUa=!1;vb.pad="notOpened";vb.qad="ok";vb.id="CopyPasteInstallDialog";
Object(m.a)(vb,"CopyPasteInstallDialog",null,[825]);class Gc extends Sys.EventArgs{constructor(C,ea){super();this.zzh=C;this.No=ea}}Object(m.a)(Gc,"PasteSucceededEventArgs",Sys.EventArgs,[]);var cd=a(155),Cd;(function(C){C[C.source=0]="source";C[C.destination=1]="destination"})(Cd||(Cd={}));Object(m.b)("RangeType",Cd);class Rd extends Kb.a{constructor(C,ea,Ta,Yb,wc,Hc,rd,ce,Le){Le=void 0===Le?null:Le;super();this.pasteShortcutManager=this.tzb=null;this.Xd=cb.EwaSettings.Xd();this.Hpg=this.Ipg=this.Jpg=
null;this.Qbb=!1;this.hWe=()=>{var Ue;(null===(Ue=this.tzb)||void 0===Ue?0:Ue.kvf())&&!ab.R(R.h(this.$).ga.ra.selectedRanges,this.tzb.qsc)&&(this.tzb.sma(),this.tzb=null);this.gridView.ga.es(this.hWe)};this.ILd=Ue=>{this.GZj(Ue)&&(this.Et.rud(),n.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};this.wVi=(Ue,mf)=>{n.ULS.sendTraceTag(537167768,0,50,`CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [${Ue}]. userPressedExtensionLink=${mf}`);
this.gridView.focus()};this.fg=(Ue,mf)=>{mf.zQ||mf.pj||this.At("OnWorkbookOpened",!1).catch(()=>{})};this.Em=(Ue,mf)=>{Ue=ba(this.wG);const rf=this.Et.L9a(Ue);rf&&(mf.pa&&mf.pa.sheetName===rf.sheetName&&rf.isFromCurrentSession(this.$)?this.Et.cmf(rf.ranges,Ue.commandParameters.commandType):this.Et.rud())};this.Vwc=(Ue,mf)=>{Ue=ba(this.wG);(Ue=this.Et.L9a(Ue))&&mf.item&&mf.item.sheetName===Ue.sheetName&&Ue.isFromCurrentSession(this.$)&&this.At("OnItemDeleting",!1).catch(()=>{})};this.aDa=(Ue,mf)=>
{cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8125150_ClearClipboardEndEdit")?this.Xd?this.Ipg():this.RTf():this.Xd?this.Jpg(Ue,mf):this.STf()};this.TQ=()=>{this.Xd?this.Hpg():this.fNf()};this.aV=(Ue,mf)=>{1===mf.Bu&&mf.ni.operation.flags&2&&this.At("OnQueueItemChanged/ItemRemoved",!1).catch(()=>{})};this.$=C;this.Mh=Ta;this.gridView=R.h(C);this.Et=wc;this.pzi=Hc;this.wG=ea;this.sxb=Yb;this.getStringifiedError=Le||copyPasteInfra.getStringifiedError;this.Wig=1===ce;this.Zk();rd||(n.ULS.sendTraceTag(537167824,
0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),rd=Rd.pyh);this.userHash=ob.a.hz(rd);this.IZi="CultureTag: "+gb.a.instance.ddc+" HASH: ";this.wG.addMetadataChangeListener(Rd.mGf,this.ILd);this.UYi=this.$.xa.CCPPastePlainTextLimit;this.yKb=this.$.xa.CCPCopyPasteHtmlLimit;C.ia.Od(478,Ue=>{this.pasteShortcutManager=Ue});this.Xd&&(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8125150_ClearClipboardEndEdit")?(this.Ipg=ve.b(()=>{this.RTf()},1,this.$.ma,"CopyPasteInfrastructure.OnStartEditInternal",
!0),this.Hpg=ve.b(()=>{this.fNf()},1,this.$.ma,"CopyPasteInfrastructure.onEndEditInternal",!0)):this.Jpg=ve.b(()=>{this.STf()},1,this.$.ma,"CopyPasteInfrastructure.OnStartEditInternal",!0))}sec(){var C=ba(this.wG);return C?(C=C.sourceItem)&&!C.isFromCurrentSession(this.$)?(n.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1}get pasteIndicationManager(){return this.$.ia.Ja(373)}p0g(C){this.addHandler(Rd.LMd,
C)}tEj(C){this.removeHandler(Rd.LMd,C)}M6b(C){this.addHandler(Rd.wNc,C)}AEj(C){this.removeHandler(Rd.wNc,C)}copy(C){C.stopwatch=this.$.pe.xf("UserAction",Nb.b().Tl(C.ribbonCommandInfo.command)+"ClientSide");const ea=$c.GetServiceTaskFactory.je(this.$.ia,478,479,0);fd.TaskExtensions.Aa(ea,()=>{this.pasteShortcutManager=ea.result},this.ma,3);const Ta=!!ba(this.wG);cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Z.a.oE&&(this.Qbb=!1);this.At("Copy/before/"+
Sb.a[C.ribbonCommandInfo.method],!1,void 0,!0,C.copyPasteTargetType).catch(()=>{});var Yb=-1985798686===C.ribbonCommandInfo.command;if(1===this.gridView.eh&&(Yb=this.Et.erf(this.gridView.ga.ra.selectedRanges,Yb),0!==Yb)){const rd=Rd.pnh(Yb);this.vDa(rd,qb[Yb],!1);return Promise.reject(!1)}C.userHash=this.userHash;C.id=la.a.create().toString();let wc=this,Hc=this;return this.sxb.onCopy(C).then(rd=>{rd.isAsyncCopy||C.stopwatch.stop();wc.pasteIndicationManager.qXe();const ce=ka.d(C);n.ULS.sendTraceTag(24150883,
0,50,`CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. ${ce}`);wc.pTi(rd,Ta);rd=1===C.copyPasteTargetType;!C.isFormatPainter&&rd&&(wc.pasteShortcutManager?wc.pasteShortcutManager.rGh():n.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},rd=>{let ce=!1,Le="none",Ue=Rd.Fyb,mf=!0,rf=-1,Of=Rd.copyErrorName+Rd.FNa,Ag=!1,tg=null;if(rd){tg=rd.copyContext;rf=rd.reason;Of+=Rd.WOa(rd);rd.message&&(Ue=rd.message);var mg=Rd.onh(rd);if(mg)if(3===
mg.copyErrorName)ce=!0,Ue=Le="Async Copy canceled by the user.",mf=!1;else if(te.a.xs(mg.ewaErrors))if(Ue=Hc.kjc(mg.ewaErrors),te.a.Jj(mg.ewaErrors,Rd.operationSucceededWithAlert))Ag=ce=!0;else if(te.a.Jj(mg.ewaErrors,Rd.pasteDataLimitHit)||te.a.Jj(mg.ewaErrors,Rd.copyThrottlingError))ce=!0;13===rd.reason?(ce=!0,mf=!1):11===rd.reason&&(mf=!1)}mg=rd?Hc.getStringifiedError(rd):"null";ce?(mg=ka.d(C),n.ULS.sendTraceTag(36304157,0,15,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: ${mf}, Friendly message: ${Le}, Error Message: ${Ue}, CommandParameters: ${mg}`)):
n.ULS.sendTraceTag(24150912,0,10,`CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: ${mf}, Error Message: ${mg}, CommandParameters: ${ka.d(C)}`);mf&&Hc.At("Copy/fail/"+Sb.a[C.ribbonCommandInfo.method],!0,void 0,void 0,C.copyPasteTargetType).catch(()=>{});Hc.oTi(C,ce,Ue,Of,rf,Ag,tg);return Promise.reject(rd)})}gmj(C){if(this.sec())return ub.a(this.wnc(C.commandType,C.ribbonCommandInfo));let ea;ea=ab.d(this.gridView.ga.ra.selectedRanges);C.originalDestinations=
ea;C.expandDestinations=this.D9b(C.originalDestinations,C.commandType);if(this.P9b(C.commandType,C.expandDestinations)||this.lJe())C.userHash=this.userHash,C.id=la.a.create().toString(),this.sxb.onPaste(C).then(()=>Promise.resolve(!0),Ta=>Promise.reject(Ta));return Promise.resolve(!0)}rNf(C){if(C.method){var ea=new tc(this.$,ab.d(this.gridView.ga.ra.selectedRanges),ab.d(this.gridView.ga.ra.selectedRanges),{});(Ta=>{const Yb=$c.GetServiceTaskFactory.je(this.$.ia,406,405,0);fd.TaskExtensions.Aa(Yb,
()=>{C.method&&Ta(Yb.result)},this.ma,8)})(Ta=>{Ta.L7c(ea);Ta.N2d(C.method);this.tzb=Ta});n.ULS.sendTraceTag(508680074,0,50,"CopyPasteInfrastructure.OnFill: Drag Copy Fill Floatie");this.gridView.ga.Kr(this.hWe)}}paste(C){C.stopwatch=this.$.pe.xf("UserAction",Nb.b().Tl(C.ribbonCommandInfo.command)+"ClientSide");cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Z.a.oE&&(n.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),
this.Qbb=!1,C.clipboardPicklingApiDataFormatsToRead=[Db.shadowWorkbook]);R.h(this.$).Vi&&R.h(this.$).Vi.T4(this.qqd(C.ribbonCommandInfo.command),C.stopwatch.id);if(C.isPasteCommandFromRecoveryUI){var ea=this.$.ia.Ja(406);var Ta=ab.d(ea.qsc);if(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8063983_ResolveWhenRecoveryRangeEmpty")&&!Ta)return n.ULS.sendTraceTag(508699777,0,20,"RecoveryUI paste destinations must not be null or undefined"),Promise.resolve(!0);ea=ea.eDd;C.pasteRecoveryCachedClipboardItems=
ea?ea[Rd.PWf]:null}else Ta=ab.d(this.gridView.ga.ra.selectedRanges);C.originalDestinations=Ta;C.expandDestinations=this.D9b(C.originalDestinations,C.commandType);if(this.P9b(C.commandType,C.expandDestinations)||this.lJe())return C.userHash=this.userHash,C.id=la.a.create().toString(),cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!Z.a.oE&&(C.clipboardReadPermissionPromptShown=!1,C.clipboardAsyncApiDataFormatsToRead=[Db.plainText+"Async"],this.sxb.shouldShowClipboardReadPermissionDialog().then(Yb=>
{Yb&&(C.clipboardReadPermissionPromptShown=!0,new yb(this.$));return Promise.resolve(!0)},()=>Promise.resolve(!0))),this.sxb.onPaste(C).then(Yb=>this.vxc(Yb,C),Yb=>this.NMb(C,Yb));this.$.rf(927125067,Ma.a.Td,30,null);Ta=ab.i(C.expandDestinations,",",this.$,!1);n.ULS.sendTraceTag(24150913,0,15,`CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: ${Ta}, CommandType: ${C.commandType}, copyPasteTargetType="${C.copyPasteTargetType}"`);
return Promise.resolve(!0)}qqd(C){switch(C){case 1804571062:return 6;case -185374993:return 7;case 1766348718:return 8;case -875588320:return 19;default:return 3}}lJe(){return!!R.h(this.$).ga.Ta.activeFloatingObjectControlId&&this.$.fv(null,!1,470)}Icb(){const C=ba(this.wG);return C&&C.commandParameters?C.commandParameters.copyPasteTargetType:0}JHi(){return!!ba(this.wG)&&Sa(ba(this.wG),this.$)}At(C,ea,Ta,Yb,wc){Ta=void 0===Ta?!1:Ta;Yb=void 0===Yb?!1:Yb;wc=void 0===wc?0:wc;try{this.pasteShortcutManager&&
this.pasteShortcutManager.Pdc();let Hc=wc;const rd=this.wPi();if(!Yb&&2===rd)return n.ULS.sendTraceTag(537167821,0,50,`CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '${ea}', isExplicit = '${Ta}', isForce = '${Yb}', Current CCP operation copyPasteTargetType = '${wc}', LastCopyPasteTargetType = '${rd}'`),Promise.reject(null);0===Hc&&(Hc=rd);const ce=this.$.pe.xf("UserAction","ClearCopyState"),Le=ce.id;n.ULS.sendTraceTag(537167820,
0,50,`CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '${ea}', isExplicit = '${Ta}', isForce = '${Yb}', Current CCP operation copyPasteTargetType = '${wc}', LastCopyPasteTargetType = '${rd}'`);this.Et.rud();this.yuj();return this.sxb.onCancelCopy(ea).then(()=>{ea&&cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Z.a.oE&&(this.Qbb=!1);ce.stop();this.wBf(C,Le,!0,Ta,ea,"","",ce.pf,Hc);return Promise.resolve(!0)},Ue=>{var mf=
Ue?this.getStringifiedError(Ue):"null";n.ULS.sendTraceTag(24150915,0,15,`CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: ${mf}`);ce.stop();mf=Rd.yeh+Rd.FNa;let rf=Rd.Fyb;Ue&&(mf+=Rd.WOa(Ue),Ue.message&&(rf=Ue.message));this.wBf(C,Le,!1,Ta,ea,rf,mf,ce.pf,Hc);return Promise.reject(Ue)})}catch(Hc){return Promise.reject(null)}}Y$c(C,ea,Ta,Yb){var wc=void 0;wc=void 0===wc?!1:wc;Ta=void 0===Ta?!1:Ta;Yb=void 0===Yb?0:Yb;return Ta||this.sec()?this.At(C,ea,wc,
Ta,Yb):(n.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))}vDa(C,ea,Ta){n.ULS.sendTraceTag(590705172,0,50,`CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: ${ea}`);const Yb=new Dc.a;Yb.fa("reason",ea);tb.a(nd.a.discontinuousSelectionBlocking,[Ta?qd.a.Jlj:qd.a.poh],
!0,!0,!1,!1,Yb);C=te.a.Mf(1,1,751,C,0,371863010,"DiscontinuousSelectionBlocking");cb.EwaSettings.AC()?new Yd.a(this.$,C):(C=new Kd.ErrorDialog(this.$,C),C.initialize(),C.Zi())}wPi(){const C=ba(this.wG);return C&&C.sourceItem?Object.getType(C.sourceItem)===hb?2:1:0}JDh(C,ea,Ta,Yb,wc){wc=void 0===wc?!1:wc;C.stopwatch=this.$.pe.xf("UserAction","DragDropReplaceClientSide");C.isDragDrop=!0;this.Y$c("DragDropReplace/before/"+Sb.a[C.ribbonCommandInfo.method],!1,void 0,C.copyPasteTargetType).catch(()=>{});
const Hc=wc?2:1;let rd=0;rd=wc?4:Yb?256:128;const ce={encounteredDeploymentErrors:!1};ce.commandParameters=C;C.isDragInsert=!1;C.userHash=this.userHash;C.id=la.a.create().toString();return this.Et.pasteRange(C.ribbonCommandInfo,ab.q(ea,this.$),ab.q(Ta,this.$),Hc,rd,[C.stopwatch],ce,!1,()=>{n.ULS.sendTraceTag(537167816,0,50,`CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="${C.copyPasteTargetType}"`);this.BBf(C,Hc,ea,Ta,ce)},Le=>this.CMf(Le,C,Hc,ea,Ta,ce)).then(()=>{this.gridView.ga.selectionType=
-1;return Promise.resolve(!0)},Le=>Promise.reject(Le))}IDh(C,ea,Ta,Yb,wc){wc=void 0===wc?!1:wc;C.stopwatch=this.$.pe.xf("UserAction","DragDropInsertClientSide");this.Y$c("DragDropInsert/before/"+Sb.a[C.ribbonCommandInfo.method],!1,void 0,C.copyPasteTargetType).catch(()=>{});const Hc=wc?2:1,rd=ab.L(this.D9b([Ta],Hc));var ce=this.$.ea.pa.sheetName;const Le=this.$.ea.pa.sheetName,Ue=ab.v(ea,this.$);Ue.SheetName=ce;ce=ab.v(rd,this.$);ce.SheetName=Le;Yb=rd.isRow||ea.isRow||Yb?1:0;const mf={encounteredDeploymentErrors:!1};
C.isDragInsert=!0;mf.commandParameters=C;C.userHash=this.userHash;C.id=la.a.create().toString();wc=this.Et.MDh(mf,Ue,ce,wc,Yb,C.ribbonCommandInfo,()=>{n.ULS.sendTraceTag(537167814,0,50,`CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="${C.copyPasteTargetType}"`);this.BBf(C,Hc,ea,Ta,mf)},rf=>{this.CMf(rf,C,Hc,ea,Ta,mf)});return ub.d(wc.then(()=>{this.gridView.ga.selectionType=-1;return Promise.resolve(!0)},rf=>Promise.reject(rf))).hv(()=>!0)}wnc(C,ea,Ta,Yb,wc,Hc){var rd=ba(this.wG);
if(!rd)return n.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),Tc.Task.Ua(!1);if(!Ib(rd.sourceItem))return n.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),Tc.Task.Ua(!1);var ce=rd.sourceItem;if(!ce)return n.ULS.shipAssertTag(537167810,0,!!ce,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),Tc.Task.Ua(!1);if(!ce.isFromCurrentSession(this.$)&&!cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8196445_InsertCopiedCutCellsCrossSessionCG"))return n.ULS.sendTraceTag(537167809,
0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),Tc.Task.Ua(!1);if(1<ce.ranges.length)return n.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.vDa(2192,"InsertCopiedCutCells",!0),Tc.Task.Ua(!1);rd=ab.L(ce.ranges);var Le=this.gridView.ga.ra.Ef.clone();C=ab.L(this.D9b([Le],C));const Ue=this.ezf();ce=ce.sheetName;Le=this.$.ea.pa.sheetName;const mf=ab.v(rd,this.$);mf.SheetName=ce;const rf=ab.v(C,this.$);rf.SheetName=Le;ce=
this.gridView.ga.ra.activeRange;const Of=()=>{n.ULS.sendTraceTag(508929747,0,50,"InsertCopiedCutCellsCrossSession Succeeded")},Ag=()=>{n.ULS.sendTraceTag(508929746,0,50,"InsertCopiedCutCellsCrossSession Failed")};return(C.Wi||rd.Wi||this.Et.y0j(this.$,rd,ce)?Tc.Task.Ua(0):C.isRow||rd.isRow||this.Et.z0j(this.$,rd,ce)?Tc.Task.Ua(1):this.pzi.Abc(this.$,R.h(this.$).rtl)).hv(tg=>!this.sec()&&cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8196445_InsertCopiedCutCellsCrossSessionCG")?this.Et.executeInsertCopiedCutCellsAcrossSession(mf,
rf,Ue,tg.result,ea,Of,Ag,Ta,Yb,wc,Hc):this.Et.executeInsertCopiedCutCellsOperation(mf,rf,Ue,tg.result,ea,null,null)).continueWith(()=>{this.At("InsertCopiedCutCells/success/"+Sb.a[ea.method],!0)})}VGb(){const C=ba(this.wG),ea=this.gridView.ga.ra.Zj;return!!C&&Ib(C.sourceItem)&&ea&&1===C.sourceItem.ranges.length}ezf(){return this.fzf(-911352779)}nBd(){var C,ea;const Ta=ba(this.wG);return Ta?(null===(C=Ta.asyncClipboardItemsKeys)||void 0===C?void 0:C.includes(Db.shadowWorkbook))||(null===(ea=Ta.syncClipboardItemsKeys)||
void 0===ea?void 0:ea.includes(Db.shadowWorkbook))||3!==Ta.copyStatus:!1}psc(){return this.fzf(-1985798686)}P9b(C,ea){var Ta=new Jd.a(this.$.ta),Yb=36===C;const wc=Ta.og(4);C=2===this.Icb()&&Ta.og(1);Yb=Yb&&wc;Ta=!Ta.yk||!this.psc()||!Jd.a.iec(ea,R.h(this.$));return Yb||C||this.$.fv(ea,!0)&&Ta}IGb(C,ea){return this.Et.IGb(C,ea)}dispose(){super.dispose();this.Hk();this.wG.removeMetadataChangeListener(Rd.mGf)}rgd(C,ea,Ta,Yb,wc,Hc){if(!this.nih(C.commandParameters.ribbonCommandInfo.command))return C.cseStatus=
2,!1;if(Hc&&ea.If(Yb))return C.cseStatus=4,!1;if(Ta!==wc)return C.cseStatus=6,!1;if(Yb.width%ea.width||Yb.height%ea.height)return C.cseStatus=16,!1;Ta=Yb.Sg(this.gridView.Rl);Yb=null===ea.Sg(this.gridView.Rl);wc=C.commandParameters.ribbonCommandInfo.command;if(Yb&&1804571062!==wc&&-185374993!==wc||!Ta)return C.cseStatus=7,!1;Yb=this.OGe(this.gridView,C.commandParameters.ribbonCommandInfo.command,ea,Cd.source);if(0!==Yb)return C.cseStatus=Yb,!1;Yb=this.OGe(this.gridView,C.commandParameters.ribbonCommandInfo.command,
Ta,Cd.destination);if(0!==Yb)return C.cseStatus=Yb,!1;Yb=ab.v(ea,this.$);Yb=this.Mh.Nlj(this.gridView,Yb,ab.v(Ta,this.$),C.commandParameters.ribbonCommandInfo.command,C.commandParameters.stopwatch);1===Yb&&(Hc&&(this.Mh.P$c(ea,!1),this.Mh.P$c(ea,!0)),ea=new Pb(C.commandParameters.ribbonCommandInfo.command,Ta,ea),R.h(this.$).N0f(ea),this.pasteIndicationManager.mmc(C.commandParameters.id,!0),this.WRb(C.commandParameters.expandDestinations,C.commandParameters.isPasteCommandFromRecoveryUI),this.X$c("DoPasteClientEstimation/"+
Sb.a[C.commandParameters.ribbonCommandInfo.method],C));C.cseStatus=Yb;return 1===Yb}OGe(C,ea,Ta,Yb){const wc=new ee.a("CopyPasteInfrastructure.blockCseForPaste",C,Ta);try{for(;wc.moveNext();){let Hc=wc.get_current().cell;if(Hc.qB)return 8;if(237279923===ea||-185374993===ea){if(Hc.hS)return 18;if(Hc.gQ)return 19}if(Yb===Cd.source&&(237279923===ea||1804571062===ea)&&this.XJi(C,Ta))return 20}}finally{wc&&wc.dispose()}return 0}dYf(){(lb.a.uzd&&(Z.a.kq||Z.a.$pc||Z.a.Qqf)?new vb(this.$):new se(this.$)).showDialog(!0,
!1,!1,this.wVi)}aVi(C,ea,Ta,Yb){C=qc(C,ea,Ta,Yb,this.$.xa.UserSessionId);C.k=!0;Nb.b().Ih(45,C,!0)}Iej(C,ea,Ta,Yb,wc){var Hc=!1,rd=!1,ce=Rd.Fyb,Le=Rd.sXe+Rd.FNa;C&&(Le+=Rd.WOa(C),te.a.xs(C.ewaErrors)?(ce=this.kjc(C.ewaErrors),te.a.Jj(C.ewaErrors,[-103190598])&&(Hc=!0)):C.message&&(ce=C.message));rd||(rd=this.Kyd(C));ea=qc(ea,Ta,Yb,wc,this.$.xa.UserSessionId);ea.k=!1;ea.l=rd;ea.n=ce;ea.p=Le;ea.q=Hc;Nb.b().Ih(45,ea,!0);return Promise.reject(C)}XJi(C,ea){const Ta=C.Lm("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",
new Ia.Range(ea.top,ea.right,ea.bottom,ea.right,!0,!0));for(;Ta.$$mn();){let Yb=Ta.$$cu();if(Yb&&Yb.bAa())return n.ULS.sendTraceTag(509436432,0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),!0}for(C=C.Lm("CopyPasteInfrastructure.isRangeWithBottomOrRightBorder",new Ia.Range(ea.bottom,ea.left,ea.bottom,ea.right,!0,!0));C.$$mn();)if((ea=C.$$cu())&&ea.Xza())return n.ULS.sendTraceTag(509436431,0,50,"CopyPasteInfrastructure.ShowInstantaneousFormattingFromRange: no instantaneous."),
!0;return!1}Z6g(C,ea,Ta){C.cseStatus=0;C.cseStatus=this.wFi(C.commandParameters.ribbonCommandInfo.command,Ta,this.gridView,ea);if(0!==C.cseStatus)return!1;C.cseStatus=this.Mh.Olj(this.gridView,ea,Ta,C.commandParameters.stopwatch);ea=new Pb(C.commandParameters.ribbonCommandInfo.command,Ta,null);1===C.cseStatus&&(R.h(this.$).N0f(ea),this.pasteIndicationManager.mmc(C.commandParameters.id,!0),this.WRb(C.commandParameters.expandDestinations,C.commandParameters.isPasteCommandFromRecoveryUI),this.X$c("AttemptExternalPlainTextPasteClientEstimation/"+
Sb.a[C.commandParameters.ribbonCommandInfo.method],C));return 1===C.cseStatus}wFi(C,ea,Ta,Yb){if(-875588320!==C&&-185374993!==C&&237279923!==C)return 2;if(Ta.Ud.hHb(ea))return 8;if(Ta.Ud.bOi(ea))return 18;if(Ta.Ud.m3(ea))return 11;if(this.Mh.aXe(ea))return 12;C=this.Xch(ea,Yb);return R.j(this.gridView,C)?0:7}Xch(C,ea){var Ta=ea.indexOf("\r");Ta=-1!==Ta?"\n"===ea[Ta+1]?ea.split("\r\n"):ea.split("\r"):ea.split("\n");ea=Ta.length;Ta=Ta[0].split("\t").length;return new Ia.Range(C.top,C.left,C.top+ea-
1,C.left+Ta-1,!0,!0)}nih(C){switch(C){case 237279923:case 808159687:case -185374993:case 1804571062:return!0;default:return!1}}fzf(C){const ea=ba(this.wG);if(!ea)return!1;const Ta=ea.sourceItem;return cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8196445_InsertCopiedCutCellsCrossSessionCG")||!Ta||Ta.isFromCurrentSession(this.$)?ea.commandParameters.ribbonCommandInfo.command===C:(n.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),
!1)}GZj(C){return C&&C.lastCopy?Sa(C.lastCopy,this.$):!0}Eaf(C,ea,Ta,Yb,wc){const Hc={};Hc.a=this.$.xa.UserSessionId;Hc.e=C.stopwatch.id;Hc.c=Nb.b().Tl(C.ribbonCommandInfo.command);Hc.b=Sb.a[C.ribbonCommandInfo.method];Hc.d=C.id;Hc.f=Ta.toString();Hc.g=Yb.toString();Hc.h=ea.toString();Hc.o=C.stopwatch.pf;Hc.q=!1;Hc.r=C.copyPasteTargetType.toString();Hc.s=wc.encounteredDeploymentErrors;Hc.i=wc.commandParameters.dragDropIsShiftKeyDown;Hc.j=wc.commandParameters.isDragInsert;return Hc}BBf(C,ea,Ta,Yb,
wc){C=this.Eaf(C,ea,Ta,Yb,wc);C.k=!0;Nb.b().Ih(45,C,!0)}xTi(C,ea,Ta,Yb,wc,Hc,rd,ce,Le){C=this.Eaf(C,ea,Ta,Yb,Le);C.k=!1;C.l=wc;C.n=Hc;C.p=rd;C.q=ce;Nb.b().Ih(45,C,!0)}wBf(C,ea,Ta,Yb,wc,Hc,rd,ce,Le){const Ue={};Ue.a=this.$.xa.UserSessionId;Ue.b=ea;Ue.c=C;Ue.f=Ta;Ue.e=Yb;Ue.d=wc;Ue.g=Hc;Ue.h=rd;Ue.i=ce;Ue.j=Le.toString();Nb.b().Ih(46,Ue,!0)}pTi(C,ea){C=this.aaf(C.commandParameters,C);C.l=!0;C.j=ea;Nb.b().Ih(43,C,!0)}oTi(C,ea,Ta,Yb,wc,Hc,rd){C=this.aaf(C,rd);C.l=!1;C.m=ea;C.o=Ta;C.y=Yb;C.x=wc;C.z=Hc;
Nb.b().Ih(43,C,!0);n.ULS.sendTraceTag(537167776,0,15,`CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName=${C.y},ErrorReason=${C.x},IsExpectedError=${C.m},IsSucceededWithAlert=${C.z},ErrorMessage=${C.o}`)}aaf(C,ea){const Ta={};Ta.a=this.$.xa.UserSessionId;Ta.f=C.stopwatch.id;Ta.g=C.id;Ta.c=Nb.b().Tl(C.ribbonCommandInfo.command);Ta.b=Sb.a[C.ribbonCommandInfo.method];Ta.q=C.stopwatch.pf;Ta.bd=Rd.zic();Ta.bg=C.copyPasteHandlerName;Ta.bj=void 0===C.ribbonCommandInfo.hh||null===C.ribbonCommandInfo.hh?
null:Ba.a[C.ribbonCommandInfo.hh];Ta.bq=C.uploadToClipService;Ta.br=C.floatingObjectType;Ta.s=C.copyPasteTargetType.toString();Ta.bc=Xb(C.copyPasteTargetType);Ta.z=!1;if(ea){Ta.bk=ea.id;Ta.bl=ea.serverRequestTimeInMs;ea.requestTelemetryData&&(Ta.bm=ea.requestTelemetryData.EcsOperationDuration,Ta.bn=ea.requestTelemetryData.EcsRequestDuration,Ta.bo=ea.requestTelemetryData.WfeRequestDuration);Ta.d=ea.sourceItem?ea.sourceItem.toString():null;Ta.e=-1;if(Ib(ea.sourceItem)){Ta.e=0;C=ea.sourceItem.ranges;
for(const Yb of C)Ta.e+=Yb.ny}Ta.h=ea.isAsyncCopy;Ta.i=ea.isFromCache;Ta.k=ea.isSelectionAllowed;Ta.r=ea.plainTextPayloadSize;Ta.u=ea.htmlPayloadSize;Ta.v=ea.htmlSizeExceedsLimit;Ta.w=ea.copyTotalSizeExceedsLimit;Ta.t=ea.shadowWorkbookPayloadSize;Ta.p=ea.clientSideCopyTime;Ta.ba=ea.encounteredDeploymentErrors;Ta.bb=ea.shadowWorkbookSizeExceedsLimit;Ta.be=ea.syncClipboardItemsKeys;Ta.bf=ea.asyncClipboardItemsKeys;Ta.bh=this.APe(ea.succeededPopulatingSystemClipboardSync);Ta.bi=this.APe(ea.succeededPopulatingSystemClipboardAsync)}return Ta}WRb(C,
ea){ea=void 0===ea?!1:ea;if(!this.gridView.Kd&&!this.gridView.Al){var Ta=this.gridView.ga.ra,Yb=!ea&&1===C.length&&ab.R(C,Ta.selectedRanges),wc=Yb?Ta.activeCell:C[0].topLeft;C[0].contains(wc)||(n.ULS.shipAssertTag(537167775,0,!1,`CopyPasteInfrastructure.SelectPastedRange: SelectedRanges ${Ta.selectedRanges}, IndexOfActiveRange ${Ta.Ot}, ActiveCell ${Ta.activeCell}, calculatedDestinationRanges ${C}, keepThePreviousActiveCell ${Yb}, newActiveCell ${wc}, isPasteCommandFromRecoveryUI ${ea}`),wc=C[0].topLeft);
this.gridView.ga.bJ(C,0,wc,0,void 0,"CopyPasteInfrastructure.SelectPastedRange")}}nef(C,ea){const Ta={};Ta.a=this.$.xa.UserSessionId;Ta.g=C.stopwatch.id;Ta.t=C.stopwatch.pf;Ta.bz=!1;ea&&(Ta.bv=ea.id,Ta.bw=ea.serverRequestTimeInMs,Ta.n=ea.commandParameters.clipboardFormatReadTimes,Ta.o=ea.commandParameters.clipboardFormatReadStatus,Ta.p=ea.commandParameters.clipboardReadPermissionPromptShown,Ta.q=ea.commandParameters.asyncApiReadTimedOut,ea.requestTelemetryData&&(Ta.cb=ea.requestTelemetryData.EcsOperationDuration,
Ta.cc=ea.requestTelemetryData.EcsRequestDuration,Ta.cd=ea.requestTelemetryData.WfeRequestDuration));Ta.x=C.copyPasteTargetType.toString();Ta.bl=Xb(C.copyPasteTargetType);Ta.br=C.copyPasteHandlerName;Ta.i=ab.i(C.expandDestinations,",",this.$,!1);Ta.h=ab.i(C.originalDestinations,",",this.$,!1);Ta.e=C.id;Ta.d=C.commandType;Ta.c=Nb.b().Tl(C.ribbonCommandInfo.command);Ta.b=Sb.a[C.ribbonCommandInfo.method];Ta.bf=!1;Ta.bg=!1;Ta.bp=Rd.zic();Ta.bt=void 0===C.ribbonCommandInfo.hh||null===C.ribbonCommandInfo.hh?
null:Ba.a[C.ribbonCommandInfo.hh];Ta.cj=C.isPasteCommandFromEnterShortcut;if(Ta.ca=C.isPasteCommandFromRecoveryUI)Ta.cf=C.pasteRecoveryUndoStopwatch.id,Ta.cg=C.pasteRecoveryUndoStopwatch.pf;if(ea){if((C=ea.copyContextSnapshot)&&!ea.wasLastCopyExternal){Ta.f=C.commandParameters.id;Ta.j=C.sourceItem.toString();Ta.k=-1;if(Ib(C.sourceItem)){Ta.k=0;const Yb=C.sourceItem.ranges;for(const wc of Yb)Ta.k+=wc.ny}Ta.bg=1===C.commandParameters.commandType}else ea.clipboardItems?Ta.f=ea.clipboardItems.getItem(Db.scd):
n.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");Ta.bz=ea.pasteRecoveryUIDisplayed;Ta.ci=ea.cseStatus}else n.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Ta}IUi(C,ea,Ta,Yb,wc,Hc,rd,ce,Le){C=this.nef(C,ce);C.l=!1;C.m=ea;C.s=Ta;C.bc=Yb;C.be=wc;C.bd=Hc;C.bf=rd;if(ce){if(C.y=Za(ce)||!ce.copyContextSnapshot,C.bi=!C.y&&Sa(ce.copyContextSnapshot,this.$),C.bj=ce.shadowWorkbookSizeExceedsLimit,
C.v=ce.shadowWorkbookPayloadSize,C.w=ce.htmlPayloadSize,C.bq=Mc(ce.clipboardItems),C.bb=ce.activeSelectionType,C.bs=ce.isSameSession,C.bn=ce.payloadOrigin,C.bo=ce.payloadType,C.bu=ce.externalAppSource,C.bx=ce.indicationDisplayScheduled,C.by=ce.pasteIndicationDisplayStatus,C.ck=ce.pasteDestinationHasMergedCells,cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))C.cl=
ce.ArtSourceItemType}else C.bi=Sa(Le,this.$);Nb.b().Ih(44,C,!0);n.ULS.sendTraceTag(537167772,0,15,`CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName=${C.be},ErrorReason=${C.bd},IsExpectedError=${C.m},IsSucceededWithAlert=${C.bf},ErrorMessage=${C.s}`)}JUi(C){const ea=this.nef(C.commandParameters,C);ea.y=C.wasLastCopyExternal;ea.l=!0;ea.u=C.plainTextPayloadSize;ea.v=C.shadowWorkbookPayloadSize;ea.w=C.htmlPayloadSize;ea.z=C.isClipboardDataContainShadowWorkbook;ea.ba=C.isShadowWorkbookParsedSuccessfully;
ea.bb=C.activeSelectionType;ea.bc=C.pasteResult;ea.bh=C.encounteredDeploymentErrors;ea.bj=C.shadowWorkbookSizeExceedsLimit;ea.bk=sa(C);ea.bq=Mc(C.clipboardItems);ea.bs=C.isSameSession;ea.bn=C.payloadOrigin;ea.bo=C.payloadType;ea.bu=C.externalAppSource;ea.bx=C.indicationDisplayScheduled;ea.by=C.pasteIndicationDisplayStatus;ea.ck=C.pasteDestinationHasMergedCells;ea.bm=C.clipboardItems?C.clipboardItems.getItem(Db.ehh):null;ea.bi=!C.isSameSession&&!C.wasLastCopyExternal;ea.ci=C.cseStatus;if(cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",
!1)||cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))ea.cl=C.ArtSourceItemType;Nb.b().Ih(44,ea,!0)}Zk(){this.$.ta.zj(this.Em);this.$.ta.w_g(this.Vwc);this.$.userOperationManager.xt(this.aV);this.$.zn(this.fg);R.h(this.$).me.Yp(this.aDa);R.h(this.$).me.Nka(this.TQ)}Hk(){this.$&&this.$.ta&&(this.$.ta.dk(this.Em),this.$.ta.LDj(this.Vwc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.ur(this.aV);this.gridView&&this.gridView.me&&(this.gridView.me.Qp(this.aDa),
this.gridView.me.DVa(this.TQ))}NMb(C,ea){var Ta=null;let Yb=!1;var wc=null;let Hc="UnknownFailure",rd=-1,ce=Rd.Fyb,Le=Rd.pasteErrorName+Rd.FNa,Ue=!1;this.pasteIndicationManager.mmc(C.id,!1);this.pasteDestinationHasMergedCells(C.expandDestinations)&&(ea.pasteContext.pasteDestinationHasMergedCells=!0);const mf=ba(this.wG);(C.clearStateOnFinish||C.clearSystemClipboard)&&this.At("Paste/fail/"+Sb.a[C.ribbonCommandInfo.method],!0,void 0,void 0,C.copyPasteTargetType).catch(()=>{});if(ea){rd=ea.reason;Le+=
Rd.WOa(ea);ea.message&&(ce=ea.message);if(Ta=Rd.Dnh(ea))if(1===Ta.pasteErrorName)Yb=!0,Hc="CopyPasteLengthTooLongPopup",ce=wc="The pasted content is too long. Popup a dialog to the user.",n.ULS.sendTraceTag(25216992,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${wc}, copyPasteTargetType="${C.copyPasteTargetType}"`),Ta=te.a.Mf(1,0,26,690,0,1306609195,"CopyPasteOversizeError"),cb.EwaSettings.AC()?new Yd.a(this.$,Ta):(Ta=new Kd.ErrorDialog(this.$,Ta),Ta.initialize(),Ta.Zi());else if(7===Ta.pasteErrorName)Yb=
!0,Hc="No-Op",ce=wc="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",n.ULS.sendTraceTag(33948251,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${wc}, copyPasteTargetType="${C.copyPasteTargetType}"`);else if(8===Ta.pasteErrorName)Yb=!0,Hc="UseShortcutsPopup",ce=wc="Unable to paste content from the system clipboard. Popup dialog to the user.",n.ULS.sendTraceTag(25216994,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${wc}, copyPasteTargetType="${C.copyPasteTargetType}"`),
this.dYf();else if(18===Ta.pasteErrorName){Yb=!0;Hc="PasteExternalNotSupportMultipleSelectionPopup";ce="Paste external not support multiple selection.";wc="Unknown";var rf=2192;100!==Ta.validationFailureReason&&(wc=jc[Ta.validationFailureReason],rf=Rd.sPe(Ta.validationFailureReason));this.vDa(rf,wc,!0)}else 20===Ta.pasteErrorName||19===Ta.pasteErrorName?(Yb=!0,20===Ta.pasteErrorName?(Hc="PasteAcrossSessionNotSupportMultipleSelectionPopup",ce="Paste across session does not support multiple selection."):
(Hc="PasteInSameSessionNotSupportMultipleSelectionPopup",ce="This kind of multiple selection is not supported for same session paste."),wc="Unknown",rf=2192,100!==Ta.validationFailureReason&&(wc=jc[Ta.validationFailureReason],rf=Rd.sPe(Ta.validationFailureReason)),Ta=6===Ta.validationFailureReason,this.P9b(C.commandType,C.expandDestinations)&&Ta&&this.WRb(C.expandDestinations),this.vDa(rf,wc,!0)):6===Ta.pasteErrorName?(Yb=!0,Hc="No-Op",ce=wc="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
n.ULS.sendTraceTag(36263241,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${wc}, copyPasteTargetType="${C.copyPasteTargetType}"`)):17===Ta.pasteErrorName?(Yb=!0,Hc="No-Op",ce=wc="Paste text on Art is not yet a supported operation",n.ULS.sendTraceTag(0,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${wc}, copyPasteTargetType="${C.copyPasteTargetType}"`)):16===Ta.pasteErrorName?(Yb=!0,Hc="No-Op",ce=wc="Paste has failed because the previous copy has failed",Ta=this.getStringifiedError(Ta),n.ULS.sendTraceTag(537167771,
0,15,`CopyPasteInfrastructure.OnPasteFailed: ${wc}, copyPasteTargetType="${C.copyPasteTargetType}", error=${Ta}`)):te.a.xs(Ta.ewaErrors)?(te.a.Zca(Ta.ewaErrors)||te.a.Jj(Ta.ewaErrors,te.a.blc())?(Yb=!0,Hc="CommunicationError",wc=te.a.Me(Ta.ewaErrors),n.ULS.sendTraceTag(36304159,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${ce} copyPasteTargetType="${C.copyPasteTargetType}"`)):te.a.Jj(Ta.ewaErrors,Rd.RMj)?(Yb=!0,Hc="SavingWorkbookError",wc=te.a.Me(Ta.ewaErrors),n.ULS.sendTraceTag(36304160,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${ce} copyPasteTargetType="${C.copyPasteTargetType}"`)):
te.a.Jj(Ta.ewaErrors,Rd.operationSucceededWithAlert)&&(Ue=Yb=!0,Hc="OperationSucceededWithAlert",wc=te.a.Me(Ta.ewaErrors),n.ULS.sendTraceTag(36304161,0,15,`CopyPasteInfrastructure.OnPasteFailed: ${ce} copyPasteTargetType="${C.copyPasteTargetType}"`)),Yb||(ce=this.kjc(Ta.ewaErrors),Yb=this.Kyd(ea))):11===Ta.pasteErrorName&&(Yb=!0,Hc="No-Op",ce="Paste has failed because user try copy cross-session oart object");15===ea.reason&&(Yb=!0,Hc="No-Op",ce="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
pc.a.equals(Le,fb.yok,!1)&&(Yb=!0,Hc="No-Op",ce="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}Yb||(Ta=ea?this.getStringifiedError(ea):"null",n.ULS.sendTraceTag(24150916,0,10,`CopyPasteInfrastructure.OnPasteFailed: ${Ta}, copyPasteTargetType="${C.copyPasteTargetType}"`));this.IUi(C,Yb,ce,Hc,Le,rd,Ue,ea.pasteContext,mf);return Promise.reject(ea)}vxc(C,ea){var Ta;n.ULS.sendTraceTag(24150917,0,50,`CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="${ea.copyPasteTargetType}"`);
this.pasteIndicationManager.mmc(ea.id,!0);if(this.Tlj(ea.copyPasteTargetType,C)){cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Z.a.oE&&C.wasLastCopyExternal&&C.payloadType===pb.shadowWorkbook&&(this.Qbb=!0);let Yb=null;(null===(Ta=C.pastedRange)||void 0===Ta?0:Ta.Ranges)&&0<C.pastedRange.Ranges.length?Yb=ab.g(C.pastedRange.Ranges):C.wasLastCopyExternal||(Yb=ea.expandDestinations);this.KOj(C,Yb);if(this.V0j(C,Yb)){let wc;Ta=ab.d(ea.originalDestinations);
wc=1028===ea.commandType?ab.d(ea.expandDestinations):ab.d(Yb);let Hc=null;C.wasLastCopyExternal&&(ea.isKeyboardEvent||ea.isPasteCommandFromRecoveryUI)&&(Hc={[Rd.PWf]:C.clipboardItems});this.pasteDestinationHasMergedCells(ea.expandDestinations)&&(C.pasteDestinationHasMergedCells=!0);C.pasteRecoveryUIDisplayed=!0;const rd=new La(this.$,Ta,wc,Hc),ce=$c.GetServiceTaskFactory.je(this.$.ia,406,405,0);cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8156277_PwcwRecoveryUiPositionFix")&&264209770===ea.ribbonCommandInfo.command?
this.gridView.ya.DTa(()=>{fd.TaskExtensions.Aa(ce,()=>{const Le=ce.result;Le.L7c(rd);Le.N2d(ea.ribbonCommandInfo.method)},this.ma,8)}):fd.TaskExtensions.Aa(ce,()=>{const Le=ce.result;Le.L7c(rd);Le.N2d(ea.ribbonCommandInfo.method)},this.ma,8)}this.J7i(C,Yb)}this.X$c("Paste/success/"+Sb.a[ea.ribbonCommandInfo.method],C);this.JUi(C);this.Wig&&(!ea.isKeyboardEvent||sa(C))&&this.$.ea.Qj.get(66)&&(n.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),
this.Wig=!1,this.lph());cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8156831_RaisePasteSucceededEvent")&&(C=new Gc(ea.expandDestinations,C.commandParameters.ribbonCommandInfo.command),this.euj(C));return Promise.resolve(!0)}J7i(C,ea){fd.TaskExtensions.Aa($c.GetServiceTaskFactory.je(this.$.ia,534,535,1),Ta=>{Ta.result.Hfk(C,ea)},this.$.ma,3)}V0j(C,ea){return!ea||1!==ea.length||C.commandParameters.clearSystemClipboard||C.commandParameters.clearStateOnFinish||C.commandParameters.skipClipboardAccess?
!1:Za(C)&&(ea=C.clipboardItems.getItem(Db.plainText),C=C.clipboardItems.getItem(Db.html),void 0===ea||null===ea||ea.length>this.UYi||void 0===C||null===C||C.length>this.yKb)?(n.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0}Tlj(C,ea){return 1===C||ea.payloadType===pb.plainText||ea.payloadType===pb.html||cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Z.a.oE&&
ea.payloadType===pb.shadowWorkbook}pasteDestinationHasMergedCells(C){const ea=R.h(this.$).ya.yy();if(!ea||!ea.length)return!1;for(const Ta of ea)if(Ta.Dw(C[0]))return!0;return!1}X$c(C,ea){let Ta;(()=>{let Yb=this.zDi(ea);({VLa:Ta}=Yb);return Yb})().returnValue&&this.At(C,Ta,void 0,void 0,ea.commandParameters.copyPasteTargetType).catch(()=>{})}CMf(C,ea,Ta,Yb,wc,Hc){const rd=C?this.getStringifiedError(C):"null";let ce=!1,Le=!1,Ue=!1,mf=Rd.Fyb,rf=Rd.sXe+Rd.FNa;C&&(rf+=Rd.WOa(C),te.a.xs(C.ewaErrors)?
(mf=this.kjc(C.ewaErrors),te.a.Jj(C.ewaErrors,Rd.operationSucceededWithAlert)&&(ce=!0),te.a.Jj(C.ewaErrors,Rd.dragDropNonEmptyRange)&&(Le=Ue=!0)):C.message&&(mf=C.message));Ue||(Ue=this.Kyd(C));Le?this.gridView.ga.selectionType=-1:this.Et.Dxj(wc);Ue||n.ULS.sendTraceTag(24150918,0,10,`CopyPasteInfrastructure.OnDragAndDropCellsFailed: ${rd}, copyPasteTargetType="${ea.copyPasteTargetType}`);this.xTi(ea,Ta,Yb,wc,Ue,mf,rf,ce,Hc)}D9b(C,ea){let Ta=C;const Yb=this.Gai();if(null===Yb||void 0===Yb?0:Yb.ranges)Ta=
this.Et.odh(ea,Yb.ranges,C);return Ta}Gai(){const C=ba(this.wG);return C&&Ib(C.sourceItem)?C.sourceItem:null}yuj(){this.raiseEvent(Rd.LMd,null)}euj(C){Object(cd.b)(()=>{this.raiseEvent(Rd.wNc,C)})}KOj(C,ea){const Ta=C.commandParameters.originalDestinations;ea&&(ab.R(this.gridView.ga.ra.selectedRanges,Ta)?(this.WRb(ea),C=qe.HelperMethods.xub(ea),n.ULS.sendTraceTag(537167767,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: ${C}`)):C.commandParameters.isPasteCommandFromRecoveryUI?
(this.WRb(ea,!0),n.ULS.sendTraceTag(537167766,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: ${ea}, active cell: ${ea[0].topLeft}`)):(C=qe.HelperMethods.xub(Ta),n.ULS.sendTraceTag(537167765,0,50,`CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: ${C}`)))}zDi(C){if(C.isPlainTextPaste||C.isHtmlPaste||sb(C)||C.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,
VLa:!1};var ea=C.copyContextSnapshot;if(C.commandParameters.clearStateOnFinish)return{returnValue:!0,VLa:!0};if(ea&&Ib(ea.sourceItem)){var Ta=ea.sourceItem;if(!Ta.isFromCurrentSession(this.$))return{returnValue:!1,VLa:!0};ea=-1985798686===ea.commandParameters.ribbonCommandInfo.command;if(!(1<Ta.ranges.length||1<C.commandParameters.expandDestinations.length)){const Yb=ab.L(Ta.ranges);C=ab.L(C.commandParameters.expandDestinations);const wc=this.$.ea.pa.sheetName;Ta=Ta.sheetName;if(Ta===wc&&C.equals(Yb))return{returnValue:!1,
VLa:!0};if(Ta===wc&&C.Sg(Yb))return{returnValue:!0,VLa:!1}}return{returnValue:ea,VLa:!0}}return{returnValue:!1,VLa:!0}}STf(){var C=ba(this.wG);(C=this.Et.L9a(C))&&C.isFromCurrentSession(this.$)&&this.At("OnStartEdit",!1).catch(()=>{})}RTf(){ba(this.wG)&&this.At("OnStartEdit",!1).catch(()=>{})}fNf(){ba(this.wG)&&this.At("OnEndEdit",!0).catch(()=>{})}kjc(C){C=te.a.T7h(C,Rd.FNa);return this.IZi+ob.a.hz(C).toString()}Kyd(C){C=Rd.WOa(C);return!!C&&pc.a.Qzb(C,Rd.HZi)}lph(){const C=te.a.Mf(1,2,327,328,Z.a.kq?
329:Z.a.pG?330:331,530046625,"ActivateLocalStorage"),ea=Object(ub.d)(Ad.a.resolve(Ub.p,{Oa:0}));fd.TaskExtensions.Aa(ea,()=>{ea.result.ej(43,C)},this.ma,3)}APe(C){return void 0===C||null===C?Wa.d2i:C?Wa.success:Wa.failed}static Dnh(C){const ea=C.innerError;return ea&&0!==ea.pasteErrorName?C.innerError:null}static onh(C){const ea=C.innerError;return ea&&0!==ea.copyErrorName?C.innerError:null}static WOa(C){let ea="";if(!C)return Rd.gUe;C.errorName&&(ea=C.errorName,C.innerError&&(ea+=Rd.FNa+Rd.WOa(C.innerError)));
ea||(ea=C&&C.name?C.name:Rd.gUe);return ea}static zic(){Rd.Za||(Rd.Za=Vb.P5j);return Rd.Za}static sPe(C){switch(C){case 7:case 1:return 2199;case 5:return 2196;case 6:return 2195;case 8:case 3:case 2:case 4:case 9:case 10:return 2192;default:return n.ULS.shipAssertTag(537167764,0,!1,`CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = ${C}`),2199}}static pnh(C){switch(C){case 3:return 2193;case 1:return 2194;case 2:case 4:return 2192;default:return n.ULS.shipAssertTag(537167763,
0,!1,`CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = ${C}`),2199}}}Rd.mGf="EwaJsMetadataChangeListenerId";Rd.LMd="cpiOSC";Rd.wNc="cpiPS";Rd.pyh="cpiDID";Rd.Fyb="Unknown";Rd.gUe="UnknownError";Rd.FNa="_";Rd.sXe="DragAndDropError";Rd.pasteErrorName="PasteError";Rd.yeh="CancelError";Rd.copyErrorName="CopyError";Rd.HZi="MergedCellOverlap";Rd.PWf="PasteRecoveryCachedClipboardItems";Rd.RMj=[1352631530,1679665408];Rd.operationSucceededWithAlert=[-103190598];
Rd.pasteDataLimitHit=[1306609195];Rd.copyThrottlingError=[-386183710];Rd.dragDropNonEmptyRange=[563945982];Rd.Za=null;Object(m.a)(Rd,"CopyPasteInfrastructure",Kb.a,[702,703,5]);class Be{constructor(){this.r5a=this.uMe=null}}Object(m.a)(Be,"ClipboardPlatformInitializationResult",null,[]);var ad=a(664),Qc=a(224),Zd=a(124),Tb=a(8),Yc=a(6),Ob=a(58),kc=a(29);const Kc=(C,ea,Ta,Yb,wc,Hc,rd,ce)=>{ce=void 0===ce?null:ce;rd=C.Pa(1,rd);rd.pasteHtmlParameters=ea;return Ob.g(C,"PasteHtmlContent",rd,Ta,Yb,wc,Hc,
64,ce)},Wc=(C,ea,Ta,Yb,wc,Hc,rd,ce,Le,Ue)=>{Ue=void 0===Ue?null:Ue;const mf=C.Pa(9,Le);if(kc.a.trc()){Le="PasteStringV2";const rf={};rf.DestinationRange=ea;rf.Source=Ta;rf.AutoAdjustColumnsOn=Yb;mf.pasteStringParameters=rf}else Le="PasteString",mf.destinationRange=ea,mf.source=Ta;return Ob.g(C,Le,mf,wc,Hc,rd,ce,64,Ue)},Nd=(C,ea,Ta,Yb,wc,Hc,rd,ce)=>{ce=void 0===ce?null:ce;rd=C.Pa(1,void 0===rd?null:rd);rd.copyParameters=ea;return Ob.g(C,"Copy",rd,Ta,Yb,wc,Hc,0,ce)},Ud=(C,ea,Ta,Yb,wc,Hc,rd,ce)=>{ce=
void 0===ce?null:ce;rd=C.Pa(1,void 0===rd?null:rd);rd.pasteParameters=ea;return Ob.g(C,"Paste",rd,Ta,Yb,wc,Hc,64,ce)};class $d{constructor(C,ea,Ta){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=C;this.destinationRange=ea;this.pasteFlags=Ta}}Object(m.a)($d,"MacroRecorderPasteRangePayload",null,[129]);class $b{constructor(C,ea){this.content=this.destinationRange=null;this.destinationRange=C;this.content=ea}getContent(){return this.content}}Object(m.a)($b,"MacroRecorderPasteStringPayload",
null,[129]);var nc=a(73);class Oc{constructor(C){this.pasteParameters=null;this.pasteParameters=C}}Object(m.a)(Oc,"MacroRecorderPastePayload",null,[129]);var Hd=a(605),re;(function(C){C[C.none=0]="none";C[C.copyPasteLengthTooLong=1]="copyPasteLengthTooLong";C[C.applyLinkFailed=2]="applyLinkFailed";C[C.pasteHtmlFailed=3]="pasteHtmlFailed";C[C.pasteStringFailed=4]="pasteStringFailed";C[C.pasteRangeFailed=5]="pasteRangeFailed";C[C.pasteFromClipboardIsNotValidForFormattingAndTranspose=6]="pasteFromClipboardIsNotValidForFormattingAndTranspose";
C[C.asyncCopyFailedToPopulateClipboard=7]="asyncCopyFailedToPopulateClipboard";C[C.clipboardIsInaccessible=8]="clipboardIsInaccessible";C[C.pasteArtFailed=9]="pasteArtFailed";C[C.noArtSourceItem=10]="noArtSourceItem";C[C.blockedCrossSessionArtPaste=11]="blockedCrossSessionArtPaste";C[C.failedToParseShadowWorkbookJson=12]="failedToParseShadowWorkbookJson";C[C.invalidShadowWorkbook=13]="invalidShadowWorkbook";C[C.failedToStringifyShadowWorkbook=14]="failedToStringifyShadowWorkbook";C[C.failedToPasteExternalImage=
15]="failedToPasteExternalImage";C[C.lastAsyncSerializeFailed=16]="lastAsyncSerializeFailed";C[C.pasteOnArtIsNotValidForText=17]="pasteOnArtIsNotValidForText";C[C.pasteFromExternalNotSupportDiscontinuousSelection=18]="pasteFromExternalNotSupportDiscontinuousSelection";C[C.pasteFromSameSessionNotSupportDiscontinuousSelection=19]="pasteFromSameSessionNotSupportDiscontinuousSelection";C[C.pasteFromCrossSessionNotSupportDiscontinuousSelection=20]="pasteFromCrossSessionNotSupportDiscontinuousSelection";
C[C.insertCopiedCutCellsFailed=21]="insertCopiedCutCellsFailed";C[C.rearrangeRowColumnFailed=22]="rearrangeRowColumnFailed"})(re||(re={}));Object(m.b)("PasteErrorType",re);class fe{constructor(C,ea){this.errorName=this.innerError=null;this.errorName=C;this.innerError=void 0===ea?null:ea}}Object(m.a)(fe,"CCPError",null,[]);class oc extends fe{constructor(C,ea){ea=void 0===ea?null:ea;super(te.a.Me(void 0===C?null:C,"_"),ea)}}Object(m.a)(oc,"EwaCCPError",fe,[]);class Xc extends fe{constructor(C,ea,Ta,
Yb,wc){ea=void 0===ea?null:ea;Ta=void 0===Ta?null:Ta;Yb=void 0===Yb?"":Yb;wc=void 0===wc?100:wc;super(re[C]);this.pasteErrorName=0;this.ewaErrors=this.message=null;this.validationFailureReason=0;this.pasteErrorName=C;this.ewaErrors=ea;this.validationFailureReason=wc;this.innerError=ea?new oc(ea,Ta):Ta;this.message=Yb}}Object(m.a)(Xc,"PasteInnerError",fe,[]);var ud=a(202),Vd=a(219),ge=a(127),Je=a(249),Ke=a(354);class nf{constructor(C){this.parameters=null;this.parameters=C}getParameters(){return this.parameters}}
Object(m.a)(nf,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[129]);var uf=a(383);class ef{constructor(C,ea){this.$rc=this.dSa=null;this.uoc=cb.EwaSettings.getBooleanFeatureGate(lb.a.cyb,!1);this.exd=!1;this.gX=null;this.VC=(Ta,Yb)=>{if(2===Yb.Bu)this.Iy.clear(),this.dSa=null;else if(1===Yb.Bu&&this.Iy&&this.Iy.contains(Yb.ni)){Ta=Zd.a(Yb.ni.operation.operationName);const wc=Yb.ni.dequeueUtcTime.getTime()-Yb.ni.enqueueUtcTime.getTime();n.ULS.sendTraceTag(526758673,0,50,`CopyPasteUtils.OnQueueChanged: web method ${Ta} returned, it took ${wc} milliseconds to complete.`);
this.Iy.remove(Yb.ni);this.dSa=null}};this.$=C;this.gridView=ea;this.exd&&(this.$.userOperationManager.xt(this.VC),this.Iy=new nb.a);kc.a.Coa()&&void Ad.a.resolve(Ub.k,{Oa:1}).then(Ta=>{this.gX=Ta})}get yKb(){return this.$.xa.CCPCopyPasteHtmlLimit}get rFf(){return this.$.xa.CCPPastePlainTextLimit}copy(C,ea,Ta,Yb,wc){Yb=void 0===Yb?null:Yb;wc=void 0===wc?null:wc;const Hc=this.$.qa.ua.ze();this.exd&&this.H0();this.$rc=Hc.ClientRequestId;var rd=new ud.a(505,0,(ce,Le,Ue)=>{const mf={CopyPasteTargetType:1};
mf.SourceRanges=C;mf.CopyOperationId=ea.id;return this.dSa=Nd(this.$.qa.lz,mf,Je.b(ce,Ta),Yb?Je.a(Le,Yb):Le,Ue,ea.ribbonCommandInfo,Hc,wc)},80);rd=this.$.userOperationManager.enqueueOperation(rd,ea.ribbonCommandInfo);this.exd&&this.Iy.add(rd)}OWf(C,ea,Ta,Yb,wc,Hc){return new Promise((rd,ce)=>{var Le;const Ue=Hc.commandParameters.stopwatch.pf;let mf=2;20===Hc.commandParameters.commandType&&(mf=16);36===Hc.commandParameters.commandType&&(mf=32);68===Hc.commandParameters.commandType&&(mf=64);kc.a.xCd(this.$)&&
1028===Hc.commandParameters.commandType&&(mf=1024);cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PasteWithColumnWidthsEnabled",!1)&&4100===Hc.commandParameters.commandType&&(mf=4096);let rf=null;if(null===(Le=Hc.copyContextSnapshot)||void 0===Le?0:Le.commandParameters)rf=Hc.copyContextSnapshot.commandParameters.id;ef.gZd(this.$,C,Yb,ea,Ta,null,Of=>{ef.Alc(Of,Hc,rd,ce,Ue,this.$,null,!0,null,null)},Of=>{Hc.serverRequestTimeInMs=Hc.commandParameters.stopwatch.pf-Ue;Of=ge.a.kh(Of.data);
ce(new Xc(5,Of))},wc,mf,rf,Hc.commandParameters.id)})}pasteRange(C,ea,Ta,Yb,wc,Hc,rd,ce,Le,Ue){return new Promise((mf,rf)=>{const Of=rd.commandParameters.stopwatch.pf;ef.RPj(this.$,C,ea,Ta,Yb|-5&wc,Ag=>{ef.Alc(Ag,rd,mf,rf,Of,this.$,null,!0,Le,Ue)},Ag=>{rd.serverRequestTimeInMs=rd.commandParameters.stopwatch.pf-Of;Ag=ge.a.kh(Ag.data);Ag=new Xc(5,Ag);null===Ue||void 0===Ue?void 0:Ue(Ag);rf(Ag)},Hc,ce)})}rrj(C,ea,Ta,Yb,wc,Hc,rd){return new Promise((ce,Le)=>{if(ea)if(ea.length>this.yKb){var Ue=rd.clipboardItems.getItem(Db.plainText);
let mf=-1;void 0!==Ue&&null!==Ue&&(mf=Ue.length);n.ULS.sendTraceTag(42071712,0,15,`CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: ${ea.length}, MaxHtmlImportLength: ${this.yKb}, PlainTextLength: ${mf}`);Le(new Xc(1))}else Ue=new ud.a(204,0,(mf,rf,Of)=>{this.$.JB();const Ag=rd.commandParameters.stopwatch.pf;mf=Je.b(mf,Qa=>{ef.Alc(Qa,rd,ce,Le,Ag,this.$,ea,!1,null,null)});rf=Je.a(rf,Qa=>{rd.serverRequestTimeInMs=rd.commandParameters.stopwatch.pf-Ag;Qa=ge.a.kh(Qa.data);
Le(new Xc(3,Qa))});const tg=this.$.qa.ua.ze(),mg=ab.v(C,this.$),O={};O.SourceHtml=ea;O.DestinationRanges=mg?ab.s(mg):null;O.CopyOperationId=Ta;O.PasteId=Yb;O.AutoAdjustColumnsOn=this.zF();return Kc(this.$.qa.lz,O,mf,rf,Of,null,tg,Hc)},65),this.$.userOperationManager.enqueueOperation(Ue,wc);else ce("")})}zF(){return null==this.gX?!1:this.gX.zF}srj(C,ea,Ta,Yb,wc){return new Promise((Hc,rd)=>{n.ULS.sendTraceTag(537167754,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id=${wc.id}`);
ea&&(ea=pc.a.trimEnd(ea,"\n","\r"));n.ULS.sendTraceTag(537167753,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id=${wc.id}`);if(ea)if(ea.length>this.rFf)n.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",ea.length,this.rFf),rd(new Xc(1));else{let Le,Ue;const mf=ab.v(C,this.$);n.ULS.sendTraceTag(537167752,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id=${wc.id}`);
var ce=!this.$.ea.isNamedObjectViewMode&&!ea.includes("\n")&&!ea.includes("\t");n.ULS.sendTraceTag(537167751,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id=${wc.id}. treatAsLink=${ce}`);ce=ce&&pc.a.Jtf(ea);n.ULS.sendTraceTag(537167750,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id=${wc.id}. treatAsLink=${ce}`);const rf=this.$.qa.ua.ze();if(ce){Ue=526;n.ULS.sendTraceTag(537167749,0,
50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id=${wc.id}`);const Of=Vd.a.nld(ea);n.ULS.sendTraceTag(537167748,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id=${wc.id}`);const Ag=ab.s(mf);ce=(tg,mg,O)=>{const Qa=wc.commandParameters.stopwatch.pf;tg=Je.b(tg,mb=>{n.ULS.sendTraceTag(537167747,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id=${wc.id}`);
wc.requestTelemetryData=mb.RequestTelemetryData;wc.serverRequestTimeInMs=wc.commandParameters.stopwatch.pf-Qa;mb.Errors&&0<mb.Errors.length?rd(new Xc(2,mb.Errors)):Hc(ea)});mg=Je.a(mg,mb=>{wc.serverRequestTimeInMs=wc.commandParameters.stopwatch.pf-Qa;mb=ge.a.kh(mb.data);rd(new Xc(2,mb))});this.$.JB();n.ULS.sendTraceTag(537167746,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id=${wc.id}`);return Ob.b(this.$.qa.ua,Ag,ea,Of,!1,!1,63,tg,mg,O,C,rf,
Yb)};Le=()=>new Hd.a(Ag,ea,Of)}else Ue=180,ce=(Of,Ag,tg)=>{this.$.JB();const mg=wc.commandParameters.stopwatch.pf;Of=Je.b(Of,O=>{n.ULS.sendTraceTag(537167745,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id=${wc.id}`);ef.Alc(O,wc,Hc,rd,mg,this.$,ea,!1,null,null)});Ag=Je.a(Ag,O=>{wc.serverRequestTimeInMs=wc.commandParameters.stopwatch.pf-mg;O=ge.a.kh(O.data);rd(new Xc(4,O))});n.ULS.sendTraceTag(537167744,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id=${wc.id}`);
return Wc(this.$.qa.lz,mf,ea,this.zF(),Of,Ag,tg,null,rf,Yb)},Le=()=>new $b(mf,ea);n.ULS.sendTraceTag(537167715,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserWebMethodOperation. pasteContext.Id=${wc.id}`);ce=new ud.a(Ue,0,ce,65,Le);n.ULS.sendTraceTag(537167714,0,50,`CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id=${wc.id}`);this.$.userOperationManager.enqueueOperation(ce,Ta)}else Hc("")})}cmf(C,ea){ea=[1===ea?4:5];this.gridView.ee.jD(Ke.a.FFa(nc.d(this.$.pa),
C),ea,!0);this.gridView.ee.Iu(ea);this.gridView.ee.update(!0)}rud(){const C=[4,5];this.gridView.ee.cn(C,!1,!1);this.gridView.ee.Yn(null,C,!1);1===this.gridView.ga.eh&&this.gridView.Iu(!1,!1);this.gridView.ee.update(!1,!1)}odh(C,ea,Ta){const Yb=[];for(const wc of Ta)Yb.push(this.vdh(C,ea,wc));return Yb}H0(){if(this.Iy)for(let C of this.Iy)if(this.$&&this.$.userOperationManager){if(C.operation){const ea=Zd.a(C.operation.operationName);n.ULS.sendTraceTag(526758675,0,50,`CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation ${ea}.`)}this.weh();
this.$.userOperationManager.Wxa(C)}}weh(){if(this.dSa){const C=this.dSa.ox;n.ULS.sendTraceTag(526758674,0,15,`Cancelling pending copy request with Id=${C}`);ge.a.cy(C);!cb.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.$rc&&Ob.h(this.$.qa.ua,this.$rc,null,null,null);this.$rc=this.dSa=null}}vdh(C,ea,Ta){n.ULS.shipAssertTag(537167713,0,!!ea,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");n.ULS.shipAssertTag(537167712,0,0<ea.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");
let Yb=0,wc=0;var Hc=new Set;const rd=new Set;for(const ce of ea){ea=`${ce.left}_${ce.right}`;const Le=`${ce.top}_${ce.bottom}`;rd.has(ea)||(rd.add(ea),wc+=ce.width);Hc.has(Le)||(Hc.add(Le),Yb+=ce.height)}if(36===C)return Ta.isSingle?ef.h4e(wc,Yb,Ta):Ta.clone();516===C&&(C=Yb,Yb=wc,wc=C);C=!(Ta.width%wc)&&!(Ta.height%Yb);Hc=Ta.XY&&!(Ta.height%Yb);Ta.r3&&!(Ta.width%wc)||Hc?Ta=ef.h4e(wc,Yb,Ta):C?Ta=Ta.clone():(Ta=Ta.clone(),Ta.bottom=Math.min(Tb.a.Bh,Ta.top+Yb-1),Ta.right=Math.min(Tb.a.Ah,Ta.left+wc-
1));return Ta}A5g(C,ea,Ta,Yb,wc,Hc,rd,ce,Le,Ue,mf){if(!Yb||!Yb.length)return 1;if(1<Yb.length){if(!this.uoc&&Hc)return 3;if(Ue)return 0;if(ce)return 9;if(Le)return 8;if(mf)return 2;if(1<ea.length)return 4;const rf=ea[0];if(!rd&&!Qc.a.all(Yb,Of=>Of.isSingle||!(Of.width%rf.width)&&!(Of.height%rf.height)))return 5;if((!this.uoc||!Hc)&&pc.a.equals(C,Ta,!0))for(const Of of wc)if(Of.If(rf)&&!Of.equals(rf))return 6}else if(ea&&0<ea.length){if(0!==this.erf(ea,Le))return 7;if(1<ea.length){if(!this.uoc&&Hc)return 3;
if((!this.uoc||!Hc)&&pc.a.equals(C,Ta,!0))for(const rf of ea)if(C=wc[0],rf.If(C)&&!rf.equals(C))return 6}}return 0}erf(C,ea){if(!C||1>=C.length)return 0;if(ea)return 2;if(!ab.T(C))return 1;ea=new ad.a(y.a.Ei());for(const Ta of C)for(const Yb of C){const wc=Ta.top===Yb.top&&Ta.bottom===Yb.bottom,Hc=Ta.left===Yb.left&&Ta.right===Yb.right,rd=Math.max(Ta.left,Yb.left)<Math.min(Ta.right,Yb.right);if(Math.max(Ta.top,Yb.top)<Math.min(Ta.bottom,Yb.bottom)&&!wc||rd&&!Hc)return 3;ea.add(`${Ta.top}-${Ta.bottom}-${Yb.left}-${Yb.right}`);
ea.add(`${Yb.top}-${Yb.bottom}-${Ta.left}-${Ta.right}`)}for(const Ta of C)ea.remove(`${Ta.top}-${Ta.bottom}-${Ta.left}-${Ta.right}`);return 0<ea.count?3:0}Dxj(C){const ea=this.gridView.ga;ea.updateSelection(C,C.topLeft,0);ea.selectionType=-1}L9a(C){if(null===C||void 0===C?0:C.sourceItem){if(!Ib(C.sourceItem))return null;if((C=C.sourceItem)&&ab.db(C.ranges,!0))return C}return null}IGb(C,ea){n.ULS.shipAssertTag(537167711,0,!!C,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");
return ea&&Yc.a.PG in ea||C.tabName?!1:1===C.method}static RPj(C,ea,Ta,Yb,wc,Hc,rd,ce,Le){const Ue=C.qa.ua.ze(Le?{Epa:!0,voa:1}:{Epa:!1,voa:0});Le=new ud.a(506,0,(mf,rf,Of)=>{C.JB();var Ag=C.qa.ua;mf=Je.b(mf,Hc);rf=Je.a(rf,rd);var tg=ce;tg=void 0===tg?null:tg;const mg=Ag.Pa(9,Ue);mg.sourceRanges=Ta;mg.destinationRanges=Yb;mg.flags=wc;return Ob.g(Ag,"PasteRange",mg,mf,rf,Of,null,64,tg)},65,()=>new $d(Ta,Yb,wc));C.userOperationManager.enqueueOperation(Le,ea)}static Alc(C,ea,Ta,Yb,wc,Hc,rd,ce,Le,Ue){rd=
void 0===rd?null:rd;n.ULS.sendTraceTag(537167710,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id=${ea.id}`);ea.requestTelemetryData=C.RequestTelemetryData;ea.serverRequestTimeInMs=ea.commandParameters.stopwatch.pf-wc;te.a.Ph(C.Errors)?te.a.$ka(C.Errors)?(ea&&(ea.encounteredDeploymentErrors=!0),C=te.a.Me(C.Errors),n.ULS.sendTraceTag(537167707,0,15,`CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${C}`)):
(C=new Xc(5,C.Errors),null===Ue||void 0===Ue?void 0:Ue(C),Yb(C)):C.Result?(Yb=!!C&&!!C.RequestTelemetryData,R.h(Hc).Vi.bga(ea.commandParameters.stopwatch.id,C.StateId,Yb?C.RequestTelemetryData.EcsOperationDuration:0,Yb?C.RequestTelemetryData.EcsRequestDuration:0,Yb?C.RequestTelemetryData.WfeRequestDuration:0),Yb=C.Result,ea.pastedRange=Yb.SheetMultiRange,n.ULS.sendTraceTag(537167708,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id=${ea.id}`),
null===Le||void 0===Le?void 0:Le(),Ta(!0),cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&ce&&!ea.commandParameters.isDragDrop?(ea=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)?Ad.a.rg(Ub.pc):Hc.ia.Ja(465))&&ea.Xaa(6,C):kc.a.Coa()&&Yb.AutoAdjustedColumns&&void Ad.a.resolve(Ub.k,{Oa:1}).then(mf=>{mf.rKf("Paste")})):(n.ULS.sendTraceTag(537167709,0,50,`CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id=${ea.id}`),
Ta(rd||!0))}static gZd(C,ea,Ta,Yb,wc,Hc,rd,ce,Le,Ue,mf,rf){const Of=C.qa.ua.ze(),Ag=ef.XRe(Ta,Yb,wc,Ue,mf,rf);Ta=new ud.a(503,0,(tg,mg,O)=>{C.JB();return Ud(C.qa.ua,Ag,Je.b(tg,rd),Je.a(mg,ce),O,Hc,Of,Le)},65,()=>new Oc(Ag));C.userOperationManager.enqueueOperation(Ta,ea)}static XRe(C,ea,Ta,Yb,wc,Hc){const rd={};rd.ShadowWorkbookBase64=C.shadowWorkbookBase64;rd.SourceRanges={};rd.SourceRanges.Ranges=Array(1);rd.SourceRanges.Ranges[0]={};rd.SourceRanges.Ranges[0].FirstRow=C.rangeRowStart;rd.SourceRanges.Ranges[0].LastRow=
C.rangeRowEnd;rd.SourceRanges.Ranges[0].FirstColumn=C.rangeColumnStart;rd.SourceRanges.Ranges[0].LastColumn=C.rangeColumnEnd;cb.EwaSettings.getBooleanFeatureGate(lb.a.cyb,!1)?Ta?rd.DestinationRanges=ab.u(Ta.SheetName,Ta.NamedObjectName,ab.g(Ta.Ranges)):(n.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),rd.DestinationRanges=null):rd.DestinationRanges=ea?ab.s(ea):null;rd.CopyPasteTargetType=1;rd.PasteType=Yb;rd.CopyOperationId=wc;rd.PasteId=
Hc;rd.SourceClientPath=C.sourceClientPath;rd.SourceSheetName=C.sourceSheetName;rd.SourceWorkbookName=C.sourceWorkbookName;if(!C.originalSourceRangesCountExceedsLimit&&C.originalSourceRanges&&0<C.originalSourceRanges.length&&1024===Yb){rd.OriginalSourceMultiRange={};ea=Array(C.originalSourceRanges.length);for(Ta=0;Ta<ea.length;++Ta)ea[Ta]={},ea[Ta].FirstRow=C.originalSourceRanges[Ta][0],ea[Ta].FirstColumn=C.originalSourceRanges[Ta][1],ea[Ta].LastRow=C.originalSourceRanges[Ta][2],ea[Ta].LastColumn=
C.originalSourceRanges[Ta][3];rd.OriginalSourceMultiRange.Ranges=ea}return rd}static h4e(C,ea,Ta){Ta=Ta.clone();Ta.height<ea&&(Ta.bottom=Math.min(Tb.a.Bh,Ta.top+ea-1));Ta.width<C&&(Ta.right=Math.min(Tb.a.Ah,Ta.left+C-1));return Ta}z0j(C,ea,Ta){return(C=R.h(C).Ud.Di(Ta))?ea.width===C.usedRange.width&&Ta.left===C.usedRange.left||Ta.left===C.usedRange.left&&Ta.right===C.usedRange.right&&0===Ta.width%ea.width:!1}y0j(C,ea,Ta){return(C=R.h(C).Ud.Di(Ta))?ea.height===C.usedRange.height&&Ta.top===C.usedRange.top||
Ta.top===C.usedRange.top&&Ta.bottom===C.usedRange.bottom&&0===Ta.height%ea.height:!1}executeInsertCopiedCutCellsOperation(C,ea,Ta,Yb,wc,Hc,rd){Hc=void 0===Hc?null:Hc;rd=void 0===rd?null:rd;const ce={};ce.InsertDirection=Yb;ce.SourceRange=C;ce.DestRange=ea;ce.CopyCutOperation=Ta?0:1;const Le=this.$.qa.ua,Ue=this.$.qa.ua.ze(),mf=()=>new nf(ce);return uf.a(this.$.userOperationManager,(rf,Of,Ag)=>{rf=Hc?Je.b(rf,Hc):rf;Of=rd?Je.a(Of,rd):Of;const tg=Le.Pa(41,null);tg.insertCopiedCutCellsParameters=ce;return Ob.g(Le,
"InsertCopiedCutCellsV2",tg,rf,Of,Ag,Ue,0)},rf=>new ud.a(104,0,rf,void 0,mf),wc)}MDh(C,ea,Ta,Yb,wc,Hc,rd,ce){return new Promise((Le,Ue)=>{this.executeInsertCopiedCutCellsOperation(ea,Ta,Yb,wc,Hc,mf=>{C.requestTelemetryData=mf.RequestTelemetryData;if(mf.Errors&&0<mf.Errors.length){const rf=new Xc(21,mf.Errors);null===ce||void 0===ce?void 0:ce(rf);Ue(new Xc(21,mf.Errors))}else null===rd||void 0===rd?void 0:rd(),Le(!0)},mf=>{mf=ge.a.kh(mf.data);mf=new Xc(21,mf);null===ce||void 0===ce?void 0:ce(mf);Ue(mf)})})}executeInsertCopiedCutCellsAcrossSession(C,
ea,Ta,Yb,wc,Hc,rd,ce,Le,Ue,mf){Hc=void 0===Hc?null:Hc;rd=void 0===rd?null:rd;let rf={};rf.PasteParameters=ef.XRe(Ue,ce,Le,2,mf.copyContextSnapshot.commandParameters.id,mf.commandParameters.id);rf.InsertDirection=Yb;rf.SourceRange=C;rf.DestRange=ea;rf.CopyCutOperation=Ta?0:1;const Of=this.$.qa.ua,Ag=this.$.qa.ua.ze(),tg=()=>new nf(rf);return uf.a(this.$.userOperationManager,(mg,O,Qa)=>{mg=Hc?Je.b(mg,Hc):mg;O=rd?Je.a(O,rd):O;const mb=Of.Pa(41,null);mb.insertCopiedCutCellsParameters=rf;return Ob.g(Of,
"InsertCopiedCutCellsCrossSession",mb,mg,O,Qa,Ag,0)},mg=>new ud.a(106,0,mg,void 0,tg),wc)}}Object(m.a)(ef,"CopyPasteUtils",null,[701]);var Ve=a(439),bd;(function(C){C[C.range=0]="range";C[C.art=1]="art"})(bd||(bd={}));Object(m.b)("SourceItemType",bd);var be=a(91);class jb{constructor(C){this.sng={["SourceItemType.Range"]:0,["SourceItemType.Art"]:1};this.yUb={};this.nng={["FloatingObjectType.Unknown"]:99,["FloatingObjectType.CardView"]:6,["FloatingObjectType.Chart"]:0,["FloatingObjectType.Group"]:7,
["FloatingObjectType.Image"]:1,["FloatingObjectType.Ink"]:8,["FloatingObjectType.InteractiveReport"]:4,["FloatingObjectType.ModernOfficeExtension"]:3,["FloatingObjectType.Shape"]:5,["FloatingObjectType.Slicer"]:2,["FloatingObjectType.Unsupported"]:100};this.D6c={["99"]:"FloatingObjectType.Unknown",["6"]:"FloatingObjectType.CardView",["0"]:"FloatingObjectType.Chart",["7"]:"FloatingObjectType.Group",["1"]:"FloatingObjectType.Image",["8"]:"FloatingObjectType.Ink",["4"]:"FloatingObjectType.InteractiveReport",
["3"]:"FloatingObjectType.ModernOfficeExtension",["5"]:"FloatingObjectType.Shape",["2"]:"FloatingObjectType.Slicer",["100"]:"FloatingObjectType.Unsupported"};this.rng={["RibbonCommand.Copy"]:-911352779,["RibbonCommand.Cut"]:-1985798686};this.jXd={["-911352779"]:"RibbonCommand.Copy",["-1985798686"]:"RibbonCommand.Cut"};this.qng={["InputManager.InputMethod.NotDefined"]:-1,["InputManager.InputMethod.Unknown"]:0,["InputManager.InputMethod.Keyboard"]:1,["InputManager.InputMethod.Mouse"]:2,["InputManager.InputMethod.Touch"]:3,
["InputManager.InputMethod.CrossSlide"]:9};this.soa={};this.ong={["FrameMode.None"]:0,["FrameMode.Reading"]:1,["FrameMode.Edit"]:2};this.x8a={};this.tng={["UILocation.Unknown"]:0,["UILocation.UpperRibbon"]:1,["UILocation.Ribbon"]:2,["UILocation.QAT"]:3,["UILocation.Jewel"]:4,["UILocation.NavigationPane"]:5,["UILocation.KeyboardShortcut"]:6,["UILocation.StatusBar"]:7,["UILocation.Dialog"]:8,["UILocation.Floatie"]:9,["UILocation.NotificationBar"]:10,["UILocation.StandaloneCuiRoot"]:11,["UILocation.TaskPane"]:12,
["UILocation.HeroDock"]:13,["UILocation.SingleLineRibbon"]:14,["UILocation.MultilineRibbon"]:15,["UILocation.Overflow"]:16,["UILocation.TellMe"]:17,["UILocation.FarPeripheralControls"]:18,["UILocation.ContextMenu"]:19,["UILocation.DialogMenu"]:20,["UILocation.Header"]:21,["UILocation.FileMenu"]:22,["UILocation.Toolbar"]:26,["UILocation.Canvas"]:30};this.Mu={};this.$=C;this.soa.notDefined="InputManager.InputMethod.NotDefined";this.soa.unknown="InputManager.InputMethod.Unknown";this.soa.keyboard="InputManager.InputMethod.Keyboard";
this.soa.mouse="InputManager.InputMethod.Mouse";this.soa.touch="InputManager.InputMethod.Touch";this.soa.crossSlide="InputManager.InputMethod.CrossSlide";this.x8a.none="FrameMode.None";this.x8a.reading="FrameMode.Reading";this.x8a.edit="FrameMode.Edit";this.Mu.unknown="UILocation.Unknown";this.Mu.upperRibbon="UILocation.UpperRibbon";this.Mu.ribbon="UILocation.Ribbon";this.Mu.QAT="UILocation.QAT";this.Mu.jewel="UILocation.Jewel";this.Mu.navigationPane="UILocation.NavigationPane";this.Mu.keyboardShortcut=
"UILocation.KeyboardShortcut";this.Mu.statusBar="UILocation.StatusBar";this.Mu.dialog="UILocation.Dialog";this.Mu.floatie="UILocation.Floatie";this.Mu.notificationBar="UILocation.NotificationBar";this.Mu.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.Mu.taskPane="UILocation.TaskPane";this.Mu.heroDock="UILocation.HeroDock";this.Mu.singleLineRibbon="UILocation.SingleLineRibbon";this.Mu.multilineRibbon="UILocation.MultilineRibbon";this.Mu.overflow="UILocation.Overflow";this.Mu.tellMe="UILocation.TellMe";
this.Mu.farPeripheralControls="UILocation.FarPeripheralControls";this.Mu.header="UILocation.Header";this.Mu.fileMenu="UILocation.FileMenu";this.Mu.contextMenu="UILocation.ContextMenu";this.Mu.dialogMenu="UILocation.DialogMenu";this.Mu.toolbar="UILocation.Toolbar";this.Mu.canvas="UILocation.Canvas";this.yUb.range="SourceItemType.Range";this.yUb.art="SourceItemType.Art"}serializeSourceItem(C){const ea={};if(C&&Object.getType(C)===Mb)ea.sheetName=C.sheetName,ea.topArray=Qc.a.map(C.ranges,Ta=>Ta.top),
ea.leftArray=Qc.a.map(C.ranges,Ta=>Ta.left),ea.bottomArray=Qc.a.map(C.ranges,Ta=>Ta.bottom),ea.rightArray=Qc.a.map(C.ranges,Ta=>Ta.right),ea.sessionStateId=C.sessionStateId,ea.sessionId=C.sessionId,ea.sourceItemType=this.cdg(0);else if(C&&Object.getType(C)===hb)ea.activeFloatingObjectControlId=C.activeFloatingObjectControlId,ea.sheetName=C.sheetName,ea.sessionStateId=C.sessionStateId,ea.sessionId=C.sessionId,ea.floatingObjectType=this.uQj(C.type),ea.sourceItemType=this.cdg(1);else return n.ULS.shipAssertTag(537167705,
0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(ea)}serializeCommandParameters(C){if(!C)return n.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;const ea={};ea.id=C.id;ea.commandType=C.commandType;ea.copyPasteTargetType=C.copyPasteTargetType;C.ribbonCommandInfo&&(ea.ribbonCommandName=this.EQj(C.ribbonCommandInfo.command),ea.inputMethodName=this.yQj(C.ribbonCommandInfo.method),
ea.frameModeName=this.wQj(C.ribbonCommandInfo.mode),ea.uiLocationName=this.IQj(C.ribbonCommandInfo.hh),ea.tabName=C.ribbonCommandInfo.tabName);return JSON.stringify(ea)}deserializeSourceItem(C){if(!C)return null;try{const ea=JSON.parse(C);if(!ea)return n.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;let Ta=null;switch(this.wzh(ea.sourceItemType)){case 0:Ta=new Mb(this.$,this.tzh(ea),ea.sheetName,ea.sessionStateId,ea.sessionId);
break;case 1:Ta=new hb(ea.activeFloatingObjectControlId,ea.sheetName,ea.sessionStateId,ea.sessionId,this.qzh(ea.floatingObjectType))}return Ta}catch(ea){return n.ULS.sendTraceTag(537167702,0,10,`EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: ${C?C.length:0}, errror: ${ea}`),null}}deserializeCommandParameters(C){if(!C)return null;try{const ea=JSON.parse(C);if(!ea)return n.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),
null;const Ta=ka.a();Ta.id=ea.id;Ta.ribbonCommandInfo=this.vzh(ea);Ta.commandType=ea.commandType;Ta.copyPasteTargetType=ea.copyPasteTargetType;return Ta}catch(ea){return n.ULS.sendTraceTag(537167700,0,10,`EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: ${C?C.length:0}, errror: ${ea}`),null}}tzh(C){const ea=[];n.ULS.shipAssertTag(537167699,0,!!C.topArray&&0<C.topArray.length,`EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be ${C.topArray?
"empty":"null"}.`);n.ULS.shipAssertTag(537167698,0,!!C.leftArray&&0<C.leftArray.length,`EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be ${C.leftArray?"empty":"null"}.`);n.ULS.shipAssertTag(537167697,0,!!C.bottomArray&&0<C.bottomArray.length,`EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be ${C.bottomArray?"empty":"null"}.`);n.ULS.shipAssertTag(537167696,0,!!C.rightArray&&0<C.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be ${C.rightArray?
"empty":"null"}.`);if(!(C.topArray&&C.leftArray&&C.bottomArray&&C.rightArray))return ea;n.ULS.shipAssertTag(537167695,0,C.topArray.length===C.bottomArray.length&&C.topArray.length===C.leftArray.length&&C.topArray.length===C.rightArray.length,`EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray(${C.topArray.length}), BottomArray(${C.bottomArray.length}), LeftArray(${C.leftArray.length}), RightArray(${C.rightArray.length}) should be the same.`);const Ta=Math.min(C.topArray.length,
C.bottomArray.length,C.leftArray.length,C.rightArray.length);for(let Yb=0;Yb<Ta;Yb++)ea.push(new Ia.Range(C.topArray[Yb],C.leftArray[Yb],C.bottomArray[Yb],C.rightArray[Yb],!1,!1));return ea}vzh(C){return new be.a(this.uzh(C.ribbonCommandName),this.szh(C.inputMethodName),this.rzh(C.frameModeName),this.yzh(C.uiLocationName),C.tabName)}EQj(C){return void 0!==C&&null!==C&&C.toString()in this.jXd?this.jXd[C.toString()]:(n.ULS.shipAssertTag(537167694,0,!1,`EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${C}`),
this.jXd["-911352779"])}uzh(C){return C&&C in this.rng?this.rng[C]:(n.ULS.shipAssertTag(537167693,0,!1,`EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy(${-911352779}) or RibbonCommand.Cut(${-1985798686}) but got ${C}`),-911352779)}yQj(C){return void 0!==C&&null!==C&&Sb.a[C]in this.soa?this.soa[Sb.a[C]]:(n.ULS.shipAssertTag(537167692,0,!1,`EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value ${C}`),this.soa.unknown)}szh(C){return C&&
C in this.qng?this.qng[C]:(n.ULS.shipAssertTag(537167691,0,!1,`EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value ${C}`),0)}wQj(C){return void 0!==C&&null!==C&&Ve.a[C]in this.x8a?this.x8a[Ve.a[C]]:(n.ULS.shipAssertTag(537167690,0,!1,`EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value ${C}`),this.x8a.edit)}rzh(C){return C&&C in this.ong?this.ong[C]:(n.ULS.shipAssertTag(537167689,0,!1,`EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value ${C}`),
2)}cdg(C){return void 0!==C&&null!==C&&bd[C]in this.yUb?this.yUb[bd[C]]:(n.ULS.shipAssertTag(537167688,0,!1,`EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value ${C}`),this.yUb.range)}wzh(C){return C&&C in this.sng?this.sng[C]:(n.ULS.shipAssertTag(537167687,0,!1,`EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value ${C}`),0)}uQj(C){return void 0!==C&&null!==C&&C.toString()in this.D6c?this.D6c[C.toString()]:(n.ULS.shipAssertTag(537167686,0,!1,`EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value ${C}`),
this.D6c["99"])}qzh(C){return C&&C in this.nng?this.nng[C]:(n.ULS.shipAssertTag(537167685,0,!1,`EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value ${C}`),99)}IQj(C){return void 0!==C&&null!==C&&Ba.a[C]in this.Mu?this.Mu[Ba.a[C]]:(n.ULS.shipAssertTag(36229129,0,!1,`EnvironmentSerializationHelper.SerializeUILocation: got unexpected value ${C}`),this.Mu.ribbon)}yzh(C){return C&&C in this.tng?this.tng[C]:(n.ULS.shipAssertTag(537167684,0,!1,`EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value ${C}`),
2)}}Object(m.a)(jb,"EnvironmentSerializationHelper",null,[]);class lc{}lc.yag="SameSession";lc.bed="CrossSession";lc.Uzf="LegacyCrossSession";lc.external="External";Object(m.a)(lc,"PayloadOrigin",null,[]);const Zc=C=>C?C.shadowWorkbookSizeExceedsLimit&&void 0!==C.shadowWorkbookBlockedSize&&null!==C.shadowWorkbookBlockedSize?C.shadowWorkbookBlockedSize:C.shadowWorkbookBase64?C.shadowWorkbookBase64.length:0:0,dd=C=>C.shadowWorkbookSizeExceedsLimit?!0:Zc(C)>Tb.a.ouc;var Qd=a(64),ue=a(168),qa=a(107);
class Xa{constructor(C,ea,Ta){Ta=void 0===Ta?null:Ta;this.xKa=!1;this._name=ea;this.$=C;this.qn=gb.a.instance;this.Et=new ef(C,R.h(C));this.lbc=Ta}get name(){return this._name}get F6c(){return this.qn.za(5)}shouldWaitForCopyToComplete(){return!1}onDeferredPasteStarted(){}onDeferredPasteCompleted(){}beforePaste(){}Tgk(C){let ea;ea=null;try{const Ta=C.getItem(Db.shadowWorkbook);if(!Ta)return{returnValue:!1,l_:ea};ea=JSON.parse(Ta);return{returnValue:this.DNi(ea),l_:ea}}catch(Ta){return n.ULS.sendTraceTag(537167835,
0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+Ta),{returnValue:!1,l_:ea}}}DNi(C){return!!C&&(!!C.shadowWorkbookBase64||C.shadowWorkbookSizeExceedsLimit)&&void 0!==C.rangeRowStart&&void 0!==C.rangeRowEnd&&void 0!==C.rangeColumnStart&&void 0!==C.rangeColumnEnd}Pyc(C){C.wasLastCopyExternal=!0;cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SetDefaultPaste",!1)&&C.commandParameters.isPasteDefault&&this.$.shortcutKeyManager&&(C.commandParameters.commandType=
-185374993===this.$.shortcutKeyManager.adc?20:4);if(cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Z.a.oE&&516!==C.commandParameters.commandType&&1028!==C.commandParameters.commandType){let ea=null;if((()=>{let Ta=this.Tgk(C.clipboardItems);({l_:ea}=Ta);return Ta})().returnValue)return C.isShadowWorkbookParsedSuccessfully=!0,this.Klj(C,ea)}if(516!==C.commandParameters.commandType&&36!==C.commandParameters.commandType&&4100!==C.commandParameters.commandType){if(20!==
C.commandParameters.commandType){const ea=C.clipboardItems.getItem(Db.html),Ta=!(void 0===ea||null===ea)&&!!ea&&ea.trim()!==this.F6c&&(ea.startsWith("<")||Z.a.Zh&&ea.startsWith("\n<")),Yb=C.clipboardItems.getItem(Db.scd),wc=ue.f(C.clipboardItems.getItem(Db.plainText));return!Ta||!Yb&&wc?(wc&&n.ULS.sendTraceTag(508863578,0,50,"BaseCopyPasteHandler.pasteFromExternal: Pasting a formula as plaintext"),this.YNd(C)):this.Ilj(C,ea,void 0===Yb?null:Yb)}return this.YNd(C)}return Promise.reject(new Xc(6))}Klj(C,
ea){n.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");C.pasteResult="SystemClipboardShadowWorkbookPaste";C.payloadType=pb.shadowWorkbook;C.payloadOrigin=lc.external;C.shadowWorkbookPayloadSize=Zc(ea);C.shadowWorkbookSizeExceedsLimit=dd(ea);let Ta=null,Yb=null;const wc=C.commandParameters.originalDestinations;cb.EwaSettings.getBooleanFeatureGate(lb.a.cyb,!1)?Ta=ab.r(wc,this.$):Yb=ab.v(ab.L(wc),this.$);ea.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&
(C.originalSourceRangesCountExceedsLimit=ea.originalSourceRangesCountExceedsLimit);if(C.shadowWorkbookSizeExceedsLimit)return n.ULS.sendTraceTag(537167833,0,15,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length(${C.shadowWorkbookPayloadSize}) is over the limit(${Tb.a.ouc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${ea.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new Xc(1));n.ULS.sendTraceTag(537167832,0,50,`BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId=${C.commandParameters.id}`);
return this.Et.OWf(C.commandParameters.ribbonCommandInfo,Yb,Ta,ea,[C.commandParameters.stopwatch],C)}YNd(C){var ea=C.clipboardItems.getItem(Db.plainText);if(void 0!==ea&&null!==ea&&ea.trim()===this.F6c)return Promise.reject(new Xc(7));void 0!==ea&&null!==ea&&(C.plainTextPayloadSize=ea.length);let Ta=!1;cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8205865_ExtPlainTextPasteCseEnabled")&&null!==this.lbc&&(Ta=this.lbc.Z6g(C,pc.a.trimEnd(ea,"\n","\r"),ab.L(C.commandParameters.originalDestinations)));
Ta&&R.h(this.$).Vi.GR(C.commandParameters.stopwatch.id,Qd.BasicTelemetryCalculator.pQ);this.xKa||(this.xKa=!0,qa.b("AutoAdjustColumnWidthTriggered"));C.isPlainTextPaste=!0;C.pasteResult="SystemClipboardPaste";C.payloadOrigin=sa(C)?lc.Uzf:lc.external;C.payloadType=pb.plainText;n.ULS.sendTraceTag(537167831,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id=${C.id}, PasteOperationId=${C.commandParameters.id}`);ea=this.Et.srj(ab.L(C.commandParameters.originalDestinations),
ea,C.commandParameters.ribbonCommandInfo,[C.commandParameters.stopwatch],C);n.ULS.sendTraceTag(537167830,0,50,`BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id=${C.id}`);return ea}Ilj(C,ea,Ta){this.xKa||(this.xKa=!0,qa.b("AutoAdjustColumnWidthTriggered"));C.htmlPayloadSize=ea.length;C.isHtmlPaste=!0;C.pasteResult="SystemClipboardHtmlPaste";C.payloadType=pb.html;C.payloadOrigin=sa(C)?lc.Uzf:lc.external;n.ULS.sendTraceTag(42071711,0,50,`BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId=${C.commandParameters.id}`);
return this.Et.rrj(ab.L(C.commandParameters.originalDestinations),ea,Ta,C.commandParameters.id,C.commandParameters.ribbonCommandInfo,[C.commandParameters.stopwatch],C)}rSe(C){const ea={};C&&(ea.shadowWorkbookBase64=C.ShadowWorkbookBase64,ea.shadowWorkbookSizeExceedsLimit=C.ShadowWorkbookSizeExceedsLimit,ea.originalSourceRangesCountExceedsLimit=C.OriginalSourceRangesCountExceedsLimit,ea.originalSourceRangesCount=C.OriginalSourceRangesCount,ea.shadowWorkbookBlockedSize=C.ShadowWorkbookBlockedSize);
return ea}Cxg(C,ea){const Ta=Za(C),Yb=32===(C.commandParameters.commandType&32),wc=1024===(C.commandParameters.commandType&1024);let Hc=!1,rd=null,ce=null,Le=!1;if(!Ta){Hc=-1985798686===C.commandParameters.ribbonCommandInfo.command;var Ue=C.copyContextSnapshot;if(ea)Le=!Ue.sourceItem.isFromCurrentSession(this.$);else if(Ue=this.Et.L9a(Ue))rd=Ue.ranges,ce=Ue.sheetName,Le=!C.isSameSession}return this.Et.A5g(ce,rd,this.$.pa.sheetName,C.commandParameters.originalDestinations,C.commandParameters.expandDestinations,
Le,Yb,wc,Hc,ea,Ta)}}Object(m.a)(Xa,"BaseCopyPasteHandler",null,[781,782,783]);class wb{constructor(C){this.clipboardItems=this.key=null;this.xda=C}Nza(C){return this.key&&this.key.isEqual(C)?this.createClipboardItems(this.clipboardItems):null}setValue(C,ea){this.key=C;this.clipboardItems=this.createClipboardItems(ea)}createClipboardItems(C){const ea=this.xda.create();var Ta=C.getItem(Db.plainText);Ta&&ea.setItem(Db.plainText,Ta);(Ta=C.getItem(Db.shadowWorkbook))&&ea.setItem(Db.shadowWorkbook,Ta);
(C=C.getItem(Db.html))&&ea.setItem(Db.html,C);return ea}}Object(m.a)(wb,"CopyCache",null,[]);class Rb extends Xa{constructor(C,ea,Ta,Yb,wc){wc=void 0===wc?null:wc;super(C,Yb,ea);this.lbc=ea;this.xda=Ta;this.rcd=wc||new wb(this.xda);this.gridView=R.h(C);this.ga=this.gridView.ga;this.clipboardRangeFactory=C.ia.Ja(169)}getSourceItem(){const C=ab.d(this.gridView.ga.ra.selectedRanges);return new Mb(this.$,C,this.$.ea.pa.sheetName,this.$.ea.Mg,this.$.xa.UserSessionId)}beforeSerialize(C){C.isSelectionAllowed=
!1;C.isAsyncCopy=!1;C.isFromCache=!1;C.encounteredDeploymentErrors=!1;C.plainTextPayloadSize=0;C.shadowWorkbookPayloadSize=0;C.htmlPayloadSize=0;C.clientSideCopyTime=0;const ea=new Jd.a(this.$.ta),Ta=C.sourceItem;C.isSelectionAllowed=Qc.a.all(Ta.ranges,Yb=>this.isSelectionAllowed(ea,Yb));C.isSelectionAllowed&&this.Et.cmf(Ta.ranges,C.commandParameters.commandType)}tRa(C){return this.gridView.ya.a3()&&R.j(this.gridView,C)}jmj(C,ea,Ta,Yb){let wc=!1,Hc=1===ea.commandParameters.commandType,rd=Yb[0].ny;
1===Ta.ranges.length&&1===Yb.length?cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&Hc&&1!==rd&&rd!==Ta.ranges[0].ny?C.cseStatus=17:wc=this.lbc.rgd(C,ab.L(Ta.ranges),Ta.sheetName,ab.L(C.commandParameters.expandDestinations),this.$.ea.pa.sheetName,Hc):C.cseStatus=5;wc&&R.h(this.$).Vi.GR(C.commandParameters.stopwatch.id,Qd.BasicTelemetryCalculator.pQ);return this.Rlj(C,Ta,ab.u(this.$.pa.sheetName,null,Yb),ea.commandParameters.commandType,wc)}isSelectionAllowed(C,ea){return C.WHb(ea,
this.gridView)}Rlj(C,ea,Ta,Yb,wc){ea=ab.u(ea.sheetName,null,ea.ranges);C.pasteResult="SameSessionPaste";C.payloadOrigin=lc.yag;C.payloadType=pb.uUg;n.ULS.sendTraceTag(537167829,0,50,`BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId=${C.commandParameters.id}`);return this.Et.pasteRange(C.commandParameters.ribbonCommandInfo,ea,Ta,Yb,C.commandParameters.commandType,[C.commandParameters.stopwatch],C,wc,null,null)}}Object(m.a)(Rb,"BaseRangeCopyPasteHandler",Xa,[]);
var vc=a(38);class Nc{constructor(C){this.NX=new vc.a(!0);this.$=C}onDeferredPasteStarted(C){this.NX.Hd(C.id)||this.NX.add(C.id,!0);if(0<this.NX.count){const ea=Object(ub.d)(Ad.a.resolve(Ub.p,{Oa:0}));fd.TaskExtensions.Aa(ea,()=>{ea.result.ej(28,null)},this.$.ma,3)}}onDeferredPasteCompleted(C){const ea=0<this.NX.count;this.NX.Hd(C.id)&&this.NX.remove(C.id);if(ea&&!this.NX.count){const Ta=Object(ub.d)(Ad.a.resolve(Ub.p,{Oa:0}));fd.TaskExtensions.Aa(Ta,()=>{Ta.result.removeEntry(28)},this.$.ma,3)}}}
Object(m.a)(Nc,"DeferredPasteTracker",null,[]);var id;(function(C){C[C.none=0]="none";C[C.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";C[C.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";C[C.asyncCopyCanceled=3]="asyncCopyCanceled";C[C.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(id||(id={}));Object(m.b)("CopyErrorType",id);class Id extends fe{constructor(C,ea){ea=void 0===ea?null:ea;super(id[C]);this.copyErrorName=0;this.ewaErrors=
null;this.copyErrorName=C;this.ewaErrors=ea;if(null===ea||void 0===ea?0:ea.length)this.innerError=new oc(ea,null)}}Object(m.a)(Id,"CopyInnerError",fe,[]);var me=a(133);class Wb extends Rb{constructor(C,ea,Ta,Yb){super(C,ea,Ta,"AcrossSessionRangeCopyPasteHandler",void 0===Yb?null:Yb);this.NX=new Nc(C)}serialize(C){const ea=C.sourceItem,Ta={};let Yb=this.rcd.Nza(ea);if(Yb)Ta.synchronousResult=Yb,C.isFromCache=!0,C.clientSideCopyTime=C.commandParameters.stopwatch.pf;else{let Hc=null;var wc=ab.G(ea.ranges);
if(!kc.a.ctf()&&this.tRa(wc)){n.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");wc=this.clipboardRangeFactory.create(wc);try{Hc=wc.toString(),Yb=this.xda.create(),Yb.setItem(Db.plainText,Hc),this.rcd.setValue(ea,Yb),Ta.synchronousResult=Yb,C.clientSideCopyTime=C.commandParameters.stopwatch.pf}finally{wc&&wc.dispose()}}else C.isAsyncCopy=!0,Ta.synchronousResult=this.xda.create(),Ta.synchronousResult.setItem(Db.plainText,
this.F6c);Ta.asynchronousResult=this.eod(C,ea,Hc)}C.syncClipboardItemsKeys=Mc(Ta.synchronousResult);return Ta}shouldWaitForCopyToComplete(C){if(!C||!C.copyContextSnapshot)return n.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;n.ULS.shipAssertTag(537167906,0,!!this.$.xa,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");
if(C.copyContextSnapshot.sessionId===this.$.xa.UserSessionId)return n.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;n.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(C){this.NX.onDeferredPasteStarted(C)}onDeferredPasteCompleted(C){this.NX.onDeferredPasteCompleted(C)}deserialize(C){C.isClipboardDataContainShadowWorkbook=
!(void 0===C.clipboardItems.getItem(Db.shadowWorkbook)||null===C.clipboardItems.getItem(Db.shadowWorkbook));if(R.h(this.$).ga.eh&326)return Za(C)&&(C.wasLastCopyExternal=!0),Promise.reject(new Xc(17));var ea=this.Cxg(C,!1);if(0!==ea)return Promise.reject(new Xc(Za(C)?18:C.isSameSession?19:20,void 0,void 0,void 0,ea));var Ta=C.copyContextSnapshot,Yb=this.Et.L9a(Ta);if(Za(C))return this.Pyc(C);ea=C.commandParameters.originalDestinations;if(Yb&&C.isSameSession)return this.jmj(C,Ta,Yb,ea);if(516!==C.commandParameters.commandType){let wc=
null;if((()=>{let Hc=this.ssg(C.clipboardItems);({l_:wc}=Hc);return Hc})().returnValue)return C.isShadowWorkbookParsedSuccessfully=!0,Yb=Ta=null,cb.EwaSettings.getBooleanFeatureGate(lb.a.cyb,!1)?Ta=ab.r(ea,this.$):Yb=ab.v(ab.L(ea),this.$),this.Glj(C,Yb,Ta,wc);if(C.isClipboardInaccessible)return Promise.reject(new Xc(8));if(36!==C.commandParameters.commandType)return this.YNd(C)}return Promise.reject(new Xc(6))}beforePaste(C){this.$.ia.Ja(373).lNj(C);C.indicationDisplayScheduled=!0}mgk(C){let ea;if(!(C&&
C.SourceRanges&&C.SourceRanges.Ranges&&C.SourceRanges.Ranges.length&&(C.OriginalSourceRangesCountExceedsLimit||C.OriginalSourceMultiRange&&C.OriginalSourceMultiRange.Ranges&&C.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,l_:null};var Ta=C.SourceRanges.Ranges[0];if(!C.ShadowWorkbookBase64&&!C.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,l_:null};ea=this.rSe(C);ea.rangeRowStart=Ta.FirstRow;ea.rangeRowEnd=Ta.LastRow;ea.rangeColumnStart=Ta.FirstColumn;ea.rangeColumnEnd=Ta.LastColumn;
ea.sourceClientPath=C.SourceClientPath;ea.sourceSheetName=C.SourceSheetName;ea.sourceWorkbookName=C.SourceWorkbookName;if(!C.OriginalSourceRangesCountExceedsLimit)for(C=C.OriginalSourceMultiRange.Ranges,ea.originalSourceRanges=Array(C.length),Ta=0;Ta<C.length;++Ta)ea.originalSourceRanges[Ta]=[C[Ta].FirstRow,C[Ta].FirstColumn,C[Ta].LastRow,C[Ta].LastColumn];return{returnValue:!0,l_:ea}}ssg(C){let ea;ea=null;C=C.getItem(Db.shadowWorkbook);if(!C)return{returnValue:!1,l_:ea};ea=JSON.parse(C);return{returnValue:this.CNi(ea),
l_:ea}}CNi(C){return!!C&&(!!C.shadowWorkbookBase64||C.shadowWorkbookSizeExceedsLimit)&&void 0!==C.rangeRowStart&&void 0!==C.rangeRowEnd&&void 0!==C.rangeColumnStart&&void 0!==C.rangeColumnEnd}Glj(C,ea,Ta,Yb){n.ULS.shipAssertTag(537167903,0,!!Yb,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");C.pasteResult="CrossSessionPaste";C.payloadOrigin=lc.bed;C.payloadType=pb.shadowWorkbook;C.shadowWorkbookPayloadSize=Zc(Yb);C.shadowWorkbookSizeExceedsLimit=
dd(Yb);Yb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(C.originalSourceRangesCountExceedsLimit=Yb.originalSourceRangesCountExceedsLimit);if(C.shadowWorkbookSizeExceedsLimit)return n.ULS.sendTraceTag(34415003,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length(${C.shadowWorkbookPayloadSize}) is over the limit(${Tb.a.ouc}). reject the paste request. ShadowWorkbookSizeExceedsLimit: ${Yb.shadowWorkbookSizeExceedsLimit}`),Promise.reject(new Xc(1));if(1028===
C.commandParameters.commandType&&C.originalSourceRangesCountExceedsLimit)return n.ULS.sendTraceTag(572617859,0,15,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count(${Yb.originalSourceRangesCount}) is over the limit(${Tb.a.yYi}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: ${Yb.originalSourceRangesCountExceedsLimit}`),Promise.reject(new Xc(1));n.ULS.sendTraceTag(537167902,0,50,`AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId=${C.commandParameters.id}`);
return this.Et.OWf(C.commandParameters.ribbonCommandInfo,ea,Ta,Yb,[C.commandParameters.stopwatch],C)}eod(C,ea,Ta){n.ULS.shipAssertTag(537167901,0,!!C,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");const Yb=C.commandParameters.stopwatch.pf,wc=ab.u(ea.sheetName,null,ea.ranges);return new Promise((Hc,rd)=>{n.ULS.sendTraceTag(26035421,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: ${C.id}`);
this.Et.copy(wc,C.commandParameters,ce=>{C.requestTelemetryData=ce.RequestTelemetryData;C.serverRequestTimeInMs=C.commandParameters.stopwatch.pf-Yb;if(te.a.Ph(ce.Errors))if(te.a.$ka(ce.Errors))C.encounteredDeploymentErrors=!0,ce=te.a.Me(ce.Errors),n.ULS.sendTraceTag(537167898,0,15,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${ce}. copy Id: ${C.id}`);else{var Le=te.a.Me(ce.Errors),Ue=[-591377245];
if(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8205880_copyMaxCellCountExceededErrorWithRangeInfo")&&te.a.Jj(ce.Errors,Ue)&&(Ue=this.Cy(wc))){Ue=String.format(this.qn.Qd(218),Ue.toLocaleUpperCase());var mf=me.d(ce.Errors,Ag=>-591377245===Ag.MessageId);ce.Errors[mf].Description=Ue;n.ULS.sendTraceTag(509125507,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Added range string to CopyMaxCellCountExceededError. copy Id: ${C.id}`)}n.ULS.sendTraceTag(26035419,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Le}. copy Id: ${C.id}`);
rd(new Id(2,ce.Errors))}else if(n.ULS.sendTraceTag(537167900,0,50,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: ${C.id}`),C.markForCancellation)rd(new Id(3,ce.Errors));else{var rf=ce.Result;Ue=rf.PlainTextResult;void 0!==Ta&&null!==Ta&&(Ue=Ta);void 0!==Ue&&null!==Ue&&(C.plainTextPayloadSize=Ue.length);Le=this.xda.create();var Of;(()=>{let Ag=this.mgk(rf);({l_:Of}=Ag);return Ag})().returnValue&&(C.shadowWorkbookPayloadSize=Zc(Of),C.shadowWorkbookSizeExceedsLimit=
dd(Of),C.originalSourceRangesCountExceedsLimit=rf.OriginalSourceRangesCountExceedsLimit,mf=JSON.stringify(Of),Le.setItem(Db.shadowWorkbook,mf));Le.setItem(Db.plainText,Ue);kc.a.ctf()&&(Ue=rf.HtmlResult,C.htmlSizeExceedsLimit=rf.HtmlSizeExceedsLimit,void 0!==Ue&&null!==Ue&&(C.htmlPayloadSize=Ue.length),Le.setItem(Db.html,Ue));C.copyTotalSizeExceedsLimit=rf.CopyTotalSizeExceedsLimit;Le.setItem(Db.scd,C.commandParameters.id);this.rcd.setValue(ea,Le);C.asyncClipboardItemsKeys=Mc(Le);Hc(Le);cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!1)&&(Le=1===C.commandParameters.commandType?8:7,(Ue=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2OptimizeWorkbookManager",!1)?Ad.a.rg(Ub.pc):this.$.ia.Ja(465))&&Ue.Xaa(Le,ce))}},ce=>{C.serverRequestTimeInMs=C.commandParameters.stopwatch.pf-Yb;ce=ge.a.kh(ce.data);const Le=te.a.Me(ce);n.ULS.sendTraceTag(537167897,0,10,`AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${Le}. copy Id: ${C.id}`);rd(new Id(2,ce))},[C.commandParameters.stopwatch])})}Cy(C){return null==
C||null==C.Ranges||0===C.Ranges.length?(n.ULS.sendTraceTag(509125506,0,15,"AcrossSessionRangeCopyPasteHandler.GetRangeString sourceRange is null"),null):(1===C.Ranges.length?ab.C(C.Ranges[0]):ab.G(ab.g(C.Ranges))).toString()}}Object(m.a)(Wb,"AcrossSessionRangeCopyPasteHandler",Rb,[]);var Ec=a(1044);class hd{constructor(C,ea,Ta,Yb,wc,Hc,rd){this.floatingObjectId=C;this.commandParameters=ea;this.jJ=Ta;this.Awh=Yb;this.Qma=void 0===Hc?null:Hc;this.W9d=void 0===rd?null:rd;this.hoh=wc}}Object(m.a)(hd,
"CopyArtRequest",null,[]);class je{constructor(C,ea,Ta,Yb,wc,Hc,rd,ce,Le){this.promise=null;this.ribbonCommandInfo=C;this.destination=ea;this.bVe=Ta;this.W9d=wc;this.l_=Hc;this.item=rd;this.pasteContext=ce;this.FSa=Ta||ea.FirstRow+"_"+ea.FirstColumn;this.Btf=!0;this.rMe=Le}}Object(m.a)(je,"PasteArtRequest",null,[]);class Ee{constructor(C,ea){this.KQb=new Dc.a;this.M3a=C;this.$=ea;this.Yrj=Ta=>Promise.resolve(Ta);this.NMb=Ta=>Promise.reject(Ta)}Jpi(C){if(this.fJi(C.FSa)){n.ULS.sendTraceTag(537167681,
5,50,`PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: ${C.FSa}`);const ea=this.KQb.ka(C.FSa);this.KQb.fa(C.FSa,C);const Ta=ea.promise;ea.Btf=!1;return this.UGh(C,Ta)}this.KQb.fa(C.FSa,C);return this.tQi(C)}fJi(C){return this.KQb.Hd(C)}tQi(C){return new Promise((ea,Ta)=>{C.promise=this.M3a.KWf(C).then(Yb=>{ea(null);return this.vxc(C,Yb)},Yb=>{Ta(null);return this.NMb(Yb)})})}UGh(C,ea){return new Promise((Ta,Yb)=>{C.promise=ea.then(wc=>{this.qmk(C,
wc);return this.M3a.KWf(C).then(Hc=>{Ta(null);return this.vxc(C,Hc)},Hc=>{Yb(null);return this.NMb(Hc)})},wc=>this.NMb(wc))})}vxc(C,ea){C.Btf&&(this.Nhh(C.FSa),this.JYd(C,ea));return this.Yrj(ea)}Nhh(C){this.KQb.remove(C)}JYd(C,ea){const Ta=this.Ugi();C.FSa===Ta&&this.M3a.JYd(C.destination,ea,C.item.type)}Ugi(){var C=R.h(this.$).ga.Ta.activeFloatingObjectControlId;C||(C=ab.v(R.h(this.$).ga.ra.activeCell,this.$),C=C.FirstRow+"_"+C.FirstColumn);return C}qmk(C,ea){C.destination=null;C.bVe=ea}}Object(m.a)(Ee,
"PasteArtRequestManager",null,[]);var Ge=a(212),bf=a(134),of=a(113);class hf extends Xa{constructor(C,ea,Ta,Yb,wc){wc=void 0===wc?null:wc;super(C,"ArtCopyPasteHandler");this.Gih="XLO";this.Hih="3";this.NX=new Nc(C);this.xda=ea;this.M3a=Ta;this.ga=R.h(C).ga;this.qcd=wc||new wb(this.xda);this.Hlj=new Ee(Ta,C);this.yub=Yb}getSourceItem(){n.ULS.shipAssertTag(537167896,0,!!this.ga.Ta.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");n.ULS.sendTraceTag(537167895,
0,50,`ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[${this.ga.Ta.activeFloatingObjectControlId}]`);return new hb(this.ga.Ta.activeFloatingObjectControlId,this.$.ea.pa.sheetName,this.$.ea.Mg,this.$.xa.UserSessionId,this.ga.Ta.Fe.floatingObject.type)}beforeSerialize(C){C&&C.commandParameters?(C?(C.isAsyncCopy=!1,C.isSelectionAllowed=!1,C.isFromCache=!1,C.plainTextPayloadSize=0,C.shadowWorkbookPayloadSize=0,C.htmlPayloadSize=0,C.htmlSizeExceedsLimit=!1,C.clientSideCopyTime=
0,C.encounteredDeploymentErrors=!1,C.shadowWorkbookSizeExceedsLimit=!1,C.originalSourceRangesCountExceedsLimit=!1,C.copyTotalSizeExceedsLimit=!1):n.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),C.commandParameters.copyPasteTargetType=2):n.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")}serialize(C){const ea=C.sourceItem,Ta={};if(!ea)return n.ULS.sendTraceTag(537167893,
0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Ta;if(!this.nMi())return n.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),Ta;n.ULS.sendTraceTag(537167892,0,50,`ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[${ea.activeFloatingObjectControlId}]`);this.qPd();let Yb=this.qcd.Nza(ea);if(Yb)Ta.synchronousResult=Yb,C.isFromCache=!0,C.isAsyncCopy=!1,C.clientSideCopyTime=
C.commandParameters.stopwatch.pf,1===C.commandParameters.commandType&&this.$.rf(2045211913,C.commandParameters.ribbonCommandInfo.method,C.commandParameters.ribbonCommandInfo.hh,null);else{C.isFromCache=!1;C.isAsyncCopy=!0;Yb=this.xda.create();if(C.commandParameters.uploadToClipService){const wc={};wc["data-clipservice-ccpid"]=C.commandParameters.id;wc["data-pkey"]=C.commandParameters.pKey;wc["data-clipservice-type"]=C.commandParameters.clipServiceDataType;wc["data-clipservice-count"]=C.commandParameters.objectCount.toString();
wc["data-clipservice-dc"]=C.commandParameters.clipServiceDataCenter;wc["data-clipservice-client"]=this.Gih;wc["data-TimeStamp"]=(new Date).toUTCString();wc["data-clipservice-version"]=this.Hih;Yb.setItem(Db.a2g,JSON.stringify(wc))}Ta.synchronousResult=this.lWg(Yb);Ta.asynchronousResult=this.eod(C,ea,Yb)}C.syncClipboardItemsKeys=Mc(Ta.synchronousResult);return Ta}lWg(C){n.ULS.shipAssertTag(537167891,0,!!this.ga.Ta.Fe,"Expecting a floating object to be currently selected for copy");C||(C=this.xda.create());
const ea=this.ga.Ta.Fe.FBb();ea&&C.setItem(Db.html,`<img src='${ea}'>`);return C}qPd(){const C=this.ga.Ta.Fe;this.yub.qPd(bf.a.Gwb(C.floatingObject),bf.a.Jih(C.It))}shouldWaitForCopyToComplete(){n.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0}onDeferredPasteStarted(C){this.NX.onDeferredPasteStarted(C)}onDeferredPasteCompleted(C){this.NX.onDeferredPasteCompleted(C)}deserialize(C){var ea=Za(C),Ta=null;let Yb=null;var wc=!1;if(!ea){Ta=C.copyContextSnapshot;
Yb=Ta.sourceItem;if(!Yb)return Promise.reject(new Xc(10));wc=Yb.isFromCurrentSession(this.$)}var Hc=this.Cxg(C,!0);if(0!==Hc)return Promise.reject(new Xc(ea?18:wc?19:20,void 0,void 0,void 0,Hc));if(ea)return this.Pyc(C);if(!wc&&!hf.kEi(Yb))return C=`User attempted to paste art of type [${Yb.type}] between sessions.`,n.ULS.sendTraceTag(537167889,0,50,C),Promise.reject(new Xc(11,void 0,void 0,C));if(Ta.isAsyncSerializeFailed)return Promise.reject(new Xc(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));
let rd;try{const ce=C.clipboardItems.getItem(Db.shadowWorkbook);rd=JSON.parse(ce)}catch(ce){return C=copyPasteInfra.getStringifiedError(ce),n.ULS.sendTraceTag(537167888,0,10,`ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: ${C}`),Promise.reject(new Xc(12,void 0,ce))}rd.floatingObjectId!==Yb.activeFloatingObjectControlId?n.ULS.sendTraceTag(537167887,0,10,`ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${Yb.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${rd.floatingObjectId}]`):
n.ULS.sendTraceTag(537167886,0,50,`ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[${Yb.activeFloatingObjectControlId}], shadowWorkbookPayload.FloatingObjectId=[${rd.floatingObjectId}]`);if(!rd||!rd.shadowWorkbookBase64)return Promise.reject(new Xc(13,void 0,void 0,`shadowWorkbookPayload is null = ${!rd}`));C.isShadowWorkbookParsedSuccessfully=!0;C.shadowWorkbookPayloadSize=Zc(rd);C.shadowWorkbookSizeExceedsLimit=dd(rd);C.payloadOrigin=wc?lc.yag:lc.bed;
C.payloadType=pb.MBg;if(dd(rd))return C=`Shadow workbook size [${C.shadowWorkbookPayloadSize}] is over the limit [${Tb.a.ouc}]. ShadowWorkbookSizeExceedsLimit: ${rd.shadowWorkbookSizeExceedsLimit}`,n.ULS.sendTraceTag(36304156,0,15,`ArtCopyPasteHandler.Deserialize: ${C}`),Promise.reject(new Xc(1,void 0,void 0,C));Ta=ea=null;R.h(this.$).ga.eh&326?Ta=R.h(this.$).ga.Ta.activeFloatingObjectControlId:ea=this.$.pa&&this.$.pa.activeCell?ab.v(this.$.pa.activeCell,this.$):ab.v(ab.L(C.commandParameters.originalDestinations),
this.$);wc||!cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&!cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1)||(C.ArtSourceItemType=Ec.a[Yb.type],n.ULS.sendTraceTag(508422155,0,20,`User is attempting to paste art of type [${Yb.type}] between sessions.`));wc=null;if(this.yub.tig(Yb))try{wc=this.yub.rgd()}catch(ce){Hc=copyPasteInfra.getStringifiedError(ce),n.ULS.sendTraceTag(537167885,0,10,`ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: ${Hc}`)}return this.Hlj.Jpi(new je(C.commandParameters.ribbonCommandInfo,
ea,Ta,C.commandParameters.commandType,[C.commandParameters.stopwatch],rd,Yb,C,wc))}Pyc(C){C.wasLastCopyExternal=!0;if(C.clipboardItems.getItem("image/png")){const ea=C.commandParameters.stopwatch.pf;C.payloadType=pb.B8g;return ub.c(this.$.rf(1403967063,C.commandParameters.ribbonCommandInfo.method,C.commandParameters.ribbonCommandInfo.hh,{["dataUrl"]:C.clipboardItems.getItem("image/png")})).then(Ta=>{C.serverRequestTimeInMs=C.commandParameters.stopwatch.pf-ea;return Ta?Promise.resolve(null):Promise.reject(new Xc(15))},
()=>{C.serverRequestTimeInMs=C.commandParameters.stopwatch.pf-ea;return Promise.reject(new Xc(15))})}n.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return super.Pyc(C)}nMi(){const C=R.h(this.$).ga;return C.Ta.activeFloatingObjectControlId&&C.Ta.Fe&&C.Ta.Fe.floatingObject?C.Ta.Fe.floatingObject.V4d():!1}eod(C,ea,Ta){return new Promise((Yb,wc)=>{const Hc=C.commandParameters.stopwatch.pf;n.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");
this.M3a.loh(new hd(ea.activeFloatingObjectControlId,C.commandParameters,rd=>{C.requestTelemetryData=rd.RequestTelemetryData;C.serverRequestTimeInMs=C.commandParameters.stopwatch.pf-Hc;if(te.a.Ph(rd.Errors))if(te.a.$ka(rd.Errors))C.encounteredDeploymentErrors=!0,rd=te.a.Me(rd.Errors),n.ULS.sendTraceTag(537167879,0,15,`ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${rd}`);else{var ce=te.a.Me(rd.Errors);n.ULS.sendTraceTag(36229122,
0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ce}`);wc(new Id(4,rd.Errors))}else if(n.ULS.sendTraceTag(537167883,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[${ea.activeFloatingObjectControlId}].`),C.markForCancellation)wc(new Id(3,rd.Errors));else{if(te.a.xs(rd.Errors)){var Le=te.a.Me(rd.Errors);n.ULS.sendTraceTag(537167882,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: ${Le}`)}if(Le=
rd.Result){Le=this.rSe(Le);Le.floatingObjectId=ea.activeFloatingObjectControlId;C.shadowWorkbookPayloadSize=Zc(Le);C.shadowWorkbookSizeExceedsLimit=dd(Le);try{ce=JSON.stringify(Le)}catch(Ue){wc(new Xc(14,void 0,Ue,`Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [${C.shadowWorkbookPayloadSize}], shadowWorkbookPayload.FloatingObjectId: [${Le.floatingObjectId}]`));return}n.ULS.shipAssertTag(537167881,0,!!Ta,"Expecting syncClipboardItems to be defined");Ta.setItem(Db.shadowWorkbook,
ce);1===C.commandParameters.commandType&&(this.Cpj(ea.type,ea.activeFloatingObjectControlId,rd.StateId),this.deleteFloatingObject(ea.activeFloatingObjectControlId,ea.type));this.qcd.setValue(ea,Ta);C.asyncClipboardItemsKeys=Mc(Ta);Yb(Ta)}else n.ULS.sendTraceTag(537167880,0,50,`ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: ${ea.activeFloatingObjectControlId}`),Yb(this.qcd.Nza(ea))}},C.commandParameters.commandType,ea.type,rd=>{C.serverRequestTimeInMs=
C.commandParameters.stopwatch.pf-Hc;rd=ge.a.kh(rd.data);1===C.commandParameters.commandType&&this.M3a.Whk(ea.type,ea.activeFloatingObjectControlId);const ce=te.a.Me(rd);n.ULS.sendTraceTag(537167878,0,10,`ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: ${ce}`);wc(new Id(4,rd))},[C.commandParameters.stopwatch]))})}deleteFloatingObject(C,ea){C=Ge.a.oC(ea,C);if(C=of.a(this.$).Mt(C))of.a(this.$).deleteFloatingObject(C,14,!0),R.h(this.$).ga.Ta.XD=null}Cpj(C,ea,Ta){const Yb=
cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateValidationTelemetryManager",!1)?Ad.a.rg(Ub.xd):this.$.ia.Ja(277);if(Yb){let Hc=null;C=Ge.a.oC(C,ea);C=of.a(this.$).Mt(C);if(null===C||void 0===C?0:C.wl)Hc=C.wl.block;if(Hc){var wc=C.floatingObject.oj();Yb.V5b(()=>!Hc.Ek.Hd(wc),Ta,"CutArt")}}}static kEi(C){return 1===C.type||5===C.type||cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)&&0===C.type||cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",
!1)&&8===C.type}}Object(m.a)(hf,"ArtCopyPasteHandler",Xa,[]);var na=a(60);class S extends Oc{constructor(C,ea,Ta,Yb){super(C);this.isFromCurrentSession=!1;this.left=this.top=0;this.isFromCurrentSession=ea;this.top=Ta;this.left=Yb}}Object(m.a)(S,"MacroRecorderPasteArtPayload",Oc,[]);class Ja{constructor(C,ea){this.$=C;this.yub=ea}vvi(C,ea,Ta,Yb,wc,Hc,rd){Hc=void 0===Hc?null:Hc;rd=void 0===rd?null:rd;const ce=this.$.qa.ua.ze();let Le=null;const Ue={CopyPasteTargetType:2};Ue.FloatingObjectId=C;Ue.CopyOperationId=
Ta.id;Ta.floatingObjectType=ea;Ue.UploadToClipService=Ta.uploadToClipService;Ue.PKey=Ta.pKey;Ue.ClipServiceDataCenter=Ta.clipServiceDataCenter;let mf=0;2===wc?(wc=505,mf=16,Le=(rf,Of,Ag)=>Nd(this.$.qa.ua,Ue,Je.b(rf,Yb),Hc?Je.a(Of,Hc):Of,Ag,Ta.ribbonCommandInfo,ce,rd)):(wc=179,Le=(rf,Of,Ag)=>{this.ICh(ea,C);this.$.JB();var tg=this.$.qa.ua;rf=Je.b(rf,Yb);Of=Hc?Je.a(Of,Hc):Of;var mg=Ta.ribbonCommandInfo,O=rd;O=void 0===O?null:O;const Qa=tg.Pa(1,void 0===ce?null:ce);Qa.copyParameters=Ue;return Ob.g(tg,
"Cut",Qa,rf,Of,Ag,mg,0,O)});this.$.userOperationManager.enqueueOperation(new ud.a(wc,0,Le,mf|64),Ta.ribbonCommandInfo)}ICh(C,ea){var Ta=Ge.a.oC(C,ea);(Ta=of.a(this.$).Mt(Ta))?(R.h(this.$).ga.Ta.wK(Ta),Ta.isVisible=!1):n.ULS.sendTraceTag(537167876,0,50,`ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : ${C}, FloatingObjectId: ${ea}`)}Whk(C,ea){C=Ge.a.oC(C,ea);if(C=of.a(this.$).Mt(C))C.isVisible=!0}loh(C){this.vvi(C.floatingObjectId,C.hoh,C.commandParameters,
C.jJ,C.Awh,C.Qma,C.W9d)}bwi(C,ea,Ta,Yb,wc,Hc,rd,ce,Le){ce=void 0===ce?null:ce;Le=void 0===Le?!0:Le;return new Promise((Ue,mf)=>{const rf=Hc.commandParameters.stopwatch.pf;this.gZd(C,wc,ea,Ta,Of=>{Hc.requestTelemetryData=Of.RequestTelemetryData;Hc.serverRequestTimeInMs=Hc.commandParameters.stopwatch.pf-rf;if(te.a.$ka(Of.Errors))Hc&&(Hc.encounteredDeploymentErrors=!0),Of=te.a.Me(Of.Errors),n.ULS.sendTraceTag(537167875,0,15,`ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: ${Of}`);
else if(te.a.Ph(Of.Errors)){var Ag=te.a.Me(Of.Errors);n.ULS.sendTraceTag(36459652,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${Ag}`);mf(new Xc(9,Of.Errors))}else Of.Result?(Ag=Of.Result,n.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded."),this.Opj(rd,Ag.FloatingObjectId,Of.StateId),Ue(Ja.zvd(Ag.FloatingObjectId))):(n.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),mf(new Xc(9,Of.Errors)))},
Of=>{Hc.serverRequestTimeInMs=Hc.commandParameters.stopwatch.pf-rf;Of=ge.a.kh(Of.data);n.ULS.sendTraceTag(537167872,0,10,`ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: ${te.a.Me(Of)}`);mf(new Xc(9,Of))},Yb,ce,Le)})}Opj(C,ea,Ta){const Yb=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateValidationTelemetryManager",!1)?Ad.a.rg(Ub.xd):this.$.ia.Ja(277);if(Yb){const wc=Ge.a.oC(C,Ja.zvd(ea));Yb.V5b(()=>!!of.a(this.$).Mt(wc),Ta,"PasteArt")}}W7d(C,ea){ea&&this.yub.W7d(C,Ge.a.oC(C.type,
ea))}KWf(C){return this.bwi(C.ribbonCommandInfo,C.destination,C.bVe,C.W9d,C.l_,C.pasteContext,C.item.type,C.rMe,C.item.isFromCurrentSession(this.$)).then(ea=>ea,ea=>{this.W7d(C.item,C.rMe);return Promise.reject(ea)})}JYd(C,ea,Ta){C||(C=ab.v(R.h(this.$).ga.ra.activeCell,this.$));R.h(this.$).uqc(ab.E(C),1)?of.a(this.$).maa(Ta,ea,!0):R.h(this.$).ga.Ta.RLa(C,ea,Ta).continueWith(Yb=>{Yb.result?n.ULS.sendTraceTag(537167843,5,50,`ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [${ea}]`):
n.ULS.sendTraceTag(537167842,5,10,`ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [${ea}]`)})}gZd(C,ea,Ta,Yb,wc,Hc,rd,ce,Le){Le=void 0===Le?!0:Le;const Ue=this.$.qa.ua.ze(),mf={};mf.ShadowWorkbookBase64=ea.shadowWorkbookBase64;mf.FloatingObjectId=Yb;mf.DestinationRanges=Ta?ab.s(Ta):null;mf.CopyPasteTargetType=2;mf.ClientEstimationFloatingObjectId=ce;Ta=new ud.a(503,0,(rf,Of,Ag)=>{ce||this.$.JB();return Ud(this.$.qa.ua,mf,Je.b(rf,wc),Je.a(Of,Hc),Ag,null,Ue,rd)},
void 0,()=>{if(Le){let rf;rf=na.a.kl(na.a.ff(mf));rf.FloatingObjectId=ea.floatingObjectId;mf.DestinationRanges||(rf.DestinationRanges=ab.p(this.$.ta.pa.sheetName,"",0,0,0,0));return new S(rf,Le,0,0)}return new S(mf,Le,0,0)});Ta.flags=65;this.$.userOperationManager.enqueueOperation(Ta,C)}static zvd(C){return`${C.length+2}.{${C.toUpperCase()}}`}}Object(m.a)(Ja,"ArtCopyPasteUtils",null,[827]);var rb=a(205);class ma{constructor(C){this.ncd=this.oxa=null;this.Dfb=15;this.$=C}qPd(C,ea){this.oxa=C;this.ncd=
ea}rgd(){if(!this.oxa||!this.ncd)return n.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),"";const C=bf.a.Gwb(new Ge.a(this.oxa));C.Id=Ja.zvd(la.a.create().toString());C.Version=-1;C.Name="";C.IsClientEstimation=!0;var ea=this.vxi(C);if(!ea)return null;const Ta=new Ge.a(C);ea.block.Ek.add(Ta);Ta.Lhb();const Yb=of.a(this.$);Yb.ybc(Ta,ea);ea=Yb.Mt(Ge.a.$9h(C));!ea||
ea.floatingObject.QAa||ea.floatingObject.CRa||ea.MWa(this.ncd);Yb.maa(C.Type,C.Id,!0);return C.Id}tig(C){return cb.EwaSettings.Fa(205)&&C.isFromCurrentSession(this.$)&&!R.h(this.$).rtl&&!R.h(this.$).Gd.Xk}W7d(C,ea){this.tig(C)&&(C=of.a(this.$).Mt(ea))&&(n.ULS.sendTraceTag(537167840,5,50,`ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [${ea}] of type [${C.floatingObject.type}]`),of.a(this.$).deleteFloatingObject(C,15,!0),C.wl&&
C.ghb(C.wl,!1))}vxi(C){if(!C)return n.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;if(R.h(this.$).ga.Ta.activeFloatingObjectControlId){var ea=R.h(this.$).ga.Ta.XD.floatingObject;C.OriginDeltaX=ea.offsetX+this.Dfb;C.OriginDeltaY=ea.offsetY+this.Dfb;C.AbsoluteLeft+=this.Dfb;C.AbsoluteTop+=this.Dfb;C.AbsoluteRight+=this.Dfb;C.AbsoluteBottom+=this.Dfb;C.ZOrder=ea.eF+1;return R.h(this.$).ga.Ta.XD.wl}if(!this.$.pa||
!this.$.pa.activeCell)return n.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),null;var Ta=this.$.pa.activeCell;ea=R.h(this.$).XV(Ta);if(!ea)return n.ULS.sendTraceTag(537167837,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range ${Ta.toString()} is null.`),null;const Yb=qe.HelperMethods.mqd(ea.domElement,ea.$l.domElement);Ta=ea.gridView.hj(Ta,
2);if(!Yb||!Ta)return n.ULS.sendTraceTag(537167836,0,15,`ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: ${!Yb}. cellPositionRelativeToGridOrigin is null: ${!Ta} .`),null;C.OriginDeltaX=Ta.topLeft.x-Yb.x;C.OriginDeltaY=Ta.topLeft.y-Yb.y;C.AbsoluteLeft=Ta.topLeft.x;C.AbsoluteTop=Ta.topLeft.y;C.AbsoluteRight=C.AbsoluteLeft+Math.abs(this.oxa.AbsoluteRight-this.oxa.AbsoluteLeft);C.AbsoluteBottom=C.AbsoluteTop+Math.abs(this.oxa.AbsoluteBottom-this.oxa.AbsoluteTop);
C.ZOrder=this.oxa.ZOrder+100;return new rb.a(ea.gridView.ya.wk(ea.hashCode),ea.hashCode)}}Object(m.a)(ma,"ArtPasteClientEstimation",null,[828]);class ib{create(){const C=window.clipboardPlatform;return C?C.createClipboardItems():null}}Object(m.a)(ib,"ClipboardItemsFactory",null,[829]);class Qb{}Qb.undefined="Undefined";Object(m.a)(Qb,"CCPTelemetryConsts",null,[]);class Fc{}Fc.cells="Cells";Fc.floatingObject="FloatingObject";Fc.unknown="Unknown";Object(m.a)(Fc,"ActiveSelection",null,[]);class jd{}
jd.SBh="DisplayNotInvoked";jd.kgd="Displayed";jd.Wpj="PrerequisitesNotReady";Object(m.a)(jd,"PasteIndicationDisplayStatus",null,[]);class ke extends Wb{constructor(C,ea,Ta,Yb){super(C,ea,Ta,void 0===Yb?null:Yb);this.pxa=null}beforePaste(){n.ULS.sendTraceTag(509162378,0,50,"AcrossSessionInsertCopiedCutCellsHandler is called")}deserialize(C){C.isClipboardDataContainShadowWorkbook=!(void 0===C.clipboardItems.getItem(Db.shadowWorkbook)||null===C.clipboardItems.getItem(Db.shadowWorkbook));this.Et.L9a(C.copyContextSnapshot);
const ea=C.commandParameters.originalDestinations;if(!C.isClipboardDataContainShadowWorkbook)return Promise.resolve(!0);let Ta=null;if((()=>{let Yb=this.ssg(C.clipboardItems);({l_:Ta}=Yb);return Yb})().returnValue){C.isShadowWorkbookParsedSuccessfully=!0;let Yb=null,wc=null;cb.EwaSettings.getBooleanFeatureGate(lb.a.cyb,!1)?Yb=ab.r(ea,this.$):wc=ab.v(ab.L(ea),this.$);return this.emj(C,wc,Yb,Ta)}return C.isClipboardInaccessible?Promise.reject(new Xc(8)):Promise.reject(new Xc(6))}get copyPasteInfrastructure(){var C;
null!==(C=this.pxa)&&void 0!==C?C:this.pxa=this.$.ia.Ja(254,!0);return this.pxa}ozi(C,ea,Ta,Yb){return this.copyPasteInfrastructure?ub.a(this.copyPasteInfrastructure.wnc(null,Yb.commandParameters.ribbonCommandInfo,C,ea,Ta,Yb)):Promise.reject(new Xc(0))}emj(C,ea,Ta,Yb){C.pasteResult="CrossSessionPaste";C.payloadOrigin=lc.bed;C.payloadType=pb.shadowWorkbook;C.shadowWorkbookPayloadSize=Zc(Yb);C.shadowWorkbookSizeExceedsLimit=dd(Yb);Yb.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(C.originalSourceRangesCountExceedsLimit=
Yb.originalSourceRangesCountExceedsLimit);return C.shadowWorkbookSizeExceedsLimit?Promise.reject(new Xc(1)):1028===C.commandParameters.commandType&&C.originalSourceRangesCountExceedsLimit?Promise.reject(new Xc(1)):this.ozi(ea,Ta,Yb,C)}}Object(m.a)(ke,"AcrossSessionInsertCopiedCutCellsHandler",Wb,[]);class ne{constructor(C){this.nUc=this.NOc=this.gZc=null;this.$=C}get tRd(){if(!this.gZc){const C=this.$.ia.Ja(254,!0);C&&(this.gZc=new Wb(this.$,C,new ib))}return this.gZc}get rzi(){if(!this.nUc){const C=
this.$.ia.Ja(254,!0);C&&(this.nUc=new ke(this.$,C,new ib))}return this.nUc}get C6c(){if(!this.NOc&&this.$.ia.Ja(254,!0)){const C=new ma(this.$);this.NOc=new hf(this.$,new ib,new Ja(this.$,C),C)}return this.NOc}getCopyFlowHandler(C){const ea=this.G5h(R.h(this.$).eh);C.commandParameters.copyPasteHandlerName=ea.name;return ea}getPasteFlowHandler(C){var ea=C.copyContextSnapshot;switch(C.commandParameters.ribbonCommandInfo.command){case -160032004:case -1065525230:return C=this.rzi;default:return ea=sb(C)?
this.C6c:Za(C)?this.tRd:(null===ea||void 0===ea?0:ea.sourceItem)&&Object.getType(ea.sourceItem)===hb?this.C6c:this.tRd,C.commandParameters.copyPasteHandlerName=ea.name,ea}}initializePasteContext(C){if(C){C.isSameSession=!1;C.isShadowWorkbookParsedSuccessfully=!1;C.pasteResult=Qb.undefined;C.payloadOrigin=Qb.undefined;C.payloadType=Qb.undefined;C.encounteredDeploymentErrors=!1;C.shadowWorkbookSizeExceedsLimit=!1;C.originalSourceRangesCountExceedsLimit=!1;C.activeSelectionType=this.r1h();C.indicationDisplayScheduled=
!1;C.pasteDestinationHasMergedCells=!1;C.cseStatus=0;C.pasteIndicationDisplayStatus=jd.SBh;if(cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionChartPasteEnabled",!1)||cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossSessionInkPasteEnabled",!1))C.ArtSourceItemType=Qb.undefined;if(C.copyContextSnapshot){var ea=C.copyContextSnapshot;const rd=Ib(ea.sourceItem);var Ta=ea.sourceItem;var Yb=!!Ta&&Object.getType(Ta)===hb;Ta=0;var wc=!1;rd?(wc=ea.sourceItem,C.isSameSession=
wc.isFromCurrentSession(this.$),Ta=1,wc=this.hJi(wc,C)):Yb&&(C.isSameSession=ea.sourceItem.isFromCurrentSession(this.$),Ta=2);if(C.copyContextSnapshot.commandParameters){const ce=-1985798686===ea.commandParameters.ribbonCommandInfo.command;Yb=C.commandParameters;var Hc=this.$;ea?Hc&&Hc.xa?ea=ea.sessionId===Hc.xa.UserSessionId:(n.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),ea=!1):(n.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),ea=!1);Yb.clearSystemClipboard=
ea&&ce&&rd&&!wc;C.commandParameters.copyPasteTargetType=Ta}}}}getSessionId(){return this.$.xa.UserSessionId}hJi(C,ea){const Ta=me.b(C.ranges,Yb=>Yb.Wi)&&me.b(ea.commandParameters.originalDestinations,Yb=>1!==Yb.top);return me.b(C.ranges,Yb=>Yb.isRow)&&me.b(ea.commandParameters.originalDestinations,Yb=>1!==Yb.left)||Ta}G5h(C){switch(C){case 1:return this.tRd;case 64:case 4:case 2:case 256:return this.C6c;default:throw Error.invalidOperation("Unsupported selection");}}r1h(){return R.h(this.$).ga.eh&
470?Fc.floatingObject:1===R.h(this.$).ga.eh?Fc.cells:Fc.unknown}getDialogResponse(){}}Object(m.a)(ne,"ExcelCopyPasteApplicationHost",null,[700]);var Te=a(180);class Hb extends db.a{constructor(C,ea){super(C);this.xw=null;this.qzi=(Ta,Yb)=>{1===Ta?(Ta=Hb.$Ah[Yb[Hb.ZAh]],n.ULS.sendTraceTag(537167683,0,50,`InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = ${0===Ta?"Horizontal":"Vertical"}`),this.xw.setResult(Ta)):(n.ULS.sendTraceTag(537167682,
0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),this.xw.Uw())};this.Ni(ea)}get Pe(){return"InsertCopiedCutCellsDialog"}Ni(C){this.xw=new Te.a;const ea=gb.a.instance.ha(16);C=this.hG(C);this.initializeAndShow(ea,this.qzi,C)}hG(C){return{[Hb.kv]:this.Pe,[Hb.RKi]:C}}}Hb.ZAh="direction";Hb.RKi="isRtl";Hb.$Ah={["Vertical"]:1,["Horizontal"]:0};Object(m.a)(Hb,"InsertCopiedCutCellsDialog",db.a,[]);class Cc{Abc(C,ea){return(new Hb(C,ea)).xw.task}}Object(m.a)(Cc,"InsertCopiedCutCellsDialogFactory",
null,[699]);var vd=a(96),le=a(52),De=a(48),Ce=a(430),af=a(32),Cf=a(284),Jf=a(750);class Ff{constructor(C){this.ucc="";this.yL=this.qw=null;this.Cfb=new Map;this.z6=null;this.Dzc=!1;this.Hlf=(ea,Ta)=>{this.hide(void 0===ea?null:ea,void 0===Ta?null:Ta)};this.$=C;this.gridView=R.h(C);this.gridView.ga.Kr(this.Hlf)}qXe(){this.Dzc||(n.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.LK(C=>{C.u8(0).then(()=>{this.Dzc=!0})}))}lNj(C){const ea=
C.commandParameters.id;n.ULS.sendTraceTag(537167651,0,50,`PasteIndicationManager.ScheduleDisplay: pasteCommandId = ${ea}, cancelCtx is null = ${!this.qw}, PrerequisitesDownloaded = ${this.Dzc}`);this.qXe();this.ucc=ea;const Ta=!this.UHf();if(!this.qw||Ta)this.BJe(),this.qw=le.a.instance.create(()=>{this.RBh(C)},void 0===C.timeoutToShowSpinnerInMs||null===C.timeoutToShowSpinnerInMs?100:C.timeoutToShowSpinnerInMs,De.a.Llj);this.z6=C.commandParameters.originalDestinations;lb.a.RWf&&this.sNj(ea)}RBh(C){this.Dzc?
(this.display(C.commandParameters.originalDestinations),C.pasteIndicationDisplayStatus=jd.kgd):(n.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),C.pasteIndicationDisplayStatus=jd.Wpj)}sNj(C){this.Cfb.set(C,af.a.Jd.Og);le.a.instance.create(()=>{this.cCh(C)},this.$.xa.PasteToastNotificationDelayTime,De.a.Mlj)}cCh(C){this.Cfb.has(C)&&(this.yL?this.yL.displayTimeoutSeconds+=this.$.xa.PasteToastNotificationDefaultDisplayDuration:
(C=gb.a.instance.ha(2341),this.yL=Ce.a.aC.YU.z1(C,!1),this.yL.image=5,this.yL.mU=Jf.a.Gxj,this.yL.displayTimeoutSeconds=this.$.xa.PasteToastNotificationDefaultDisplayDuration,Ce.a.aC.YU.MD(this.yL)))}V8(C){C&&this.yL&&(C=gb.a.instance.ha(2342),this.yL.mLc(C),this.yL.image=5,this.yL.mU=Jf.a.pLe);setTimeout(()=>{this.YBj()},3E3)}YBj(){this.yL&&(Ce.a.aC.YU.removeEntry(this.yL),this.yL=null)}display(C){n.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.ee.jD(Ke.a.FFa(nc.d(this.gridView.$.pa),
C),Ff.Qyc,!0);this.gridView.ee.Iu(Ff.Qyc)}mmc(C,ea){ea=void 0===ea?!0:ea;n.ULS.sendTraceTag(537167648,0,50,`PasteIndicationManager.HideForPasteId: pasteCommandId = ${C}, currentPasteCommandId = ${this.ucc}`);C&&pc.a.equals(C,this.ucc,!1)&&this.hide();if(lb.a.RWf&&C&&this.Cfb.has(C)){const Ta=Cf.a(af.a.Jd.Og,this.Cfb.get(C));6E4<Ta&&n.ULS.sendTraceTag(508839751,0,50,`PasteIndicationManager.hideForPasteId: large paste. CommandId (${C}), scheduleDisplayToHideDurationInMs (${Ta}))`);this.Cfb.delete(C);
null!=this.yL&&0===this.Cfb.size&&this.V8(ea)}}hide(C){this.z6&&(void 0===C?0:C)&&this.UHf()&&n.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.ucc="";this.BJe();this.z6=null;0!==this.gridView.ee.knd([30]).length&&(this.gridView.ee.cn(Ff.Qyc),this.gridView.ee.Yn(null,Ff.Qyc))}UHf(){return ab.R(this.gridView.ga.ra.selectedRanges,this.z6)}BJe(){this.qw&&(vd.a.Ma(this.qw),
this.qw=null)}dispose(){this.hide();this.yL&&this.V8(!1);this.gridView.ga.es(this.Hlf)}}Ff.Qyc=[30];Object(m.a)(Ff,"PasteIndicationManager",null,[698,5]);var ic=a(1132),W=a(54),d=a(740);class Na extends ya.a{constructor(C){super();this.uGf=79;this.$=C;this.qn=gb.a.instance;this.pxd=lb.a.pxd&&!this.$.isMobileMode;this.qxd=lb.a.qxd&&this.$.isMobileMode&&this.$.isEditMode;this.Oe()}create(){const C=W.a.fZ([73,74],4,this.$a,void 0,void 0,void 0,Na.Ora),ea=Object(ub.d)(Ad.a.resolve(Ub.qb,{Oa:this.$a}));
fd.TaskExtensions.Aa(fd.TaskExtensions.Tg([ea,C],this.ma),()=>{const Ta=new ic.a;let Yb=null;this.Alh(Ta).then(wc=>{Yb=wc.uMe;const Hc=copyPasteInfra.createCopyPasteInfra(Yb,new ne(this.$),Ta,{isChangeGateEnabled:cb.EwaSettings.isChangeGateEnabled});n.ULS.shipAssertTag(537167762,0,!!this.$.xa,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");n.ULS.shipAssertTag(537167761,0,!!this.$.xa&&!!this.$.xa.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");
const rd=Yb.getMetadataManager();var ce=Object(d.a)(this.$.ia,254,()=>new Rd(this.$,rd,ea.result,Hc,new ef(this.$,R.h(this.$)),new Cc,this.$.xa.DocumentHostInfo.UserId,Yb.getInitializationError()));this.ve(ce);if(wc.r5a){ce=Rd.zic();const Le=JSON.stringify(wc.r5a.dataClipboardCapabilities),Ue=wc.r5a.clipboardStrategiesToInitialize[0].clipboardStrategyType===wc.r5a.dataClipboardStrategyType,mf=void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString();
n.ULS.sendTraceTag(41731933,0,50,`CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName=${ce}, StrategyType=${wc.r5a.dataClipboardStrategyType}, StrategyCapabilities=${Le}, IsBestStrategyTypeInitialized=${Ue}, InfraLoadTimeMS=${mf}`)}else n.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},wc=>{const Hc=Rd.zic();wc=wc?copyPasteInfra.getStringifiedError(wc):"null";n.ULS.shipAssertTag(38847436,
0,!1,`CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: ${Hc} error: ${wc}`)})},this.ma,3)}dispose(){super.dispose()}Alh(C){let ea=null;var Ta=window.clipboardPlatform;Ta&&(ea=Ta.getClipboardPlatformEnvironment());if(!ea)return n.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),
Promise.reject(null);Ta=this.$.xa;const Yb=[Ta.OfficeOnlineChromeExtensionId,Ta.ChromeClipboardAccessExtensionId],wc=this.qn.za(5);var Hc=this.$.Kg.get(57);let rd=!Hc&&this.$.Kg.get(5);var ce=this.$.ea.Je;ce&&(ce.inWebPart||ce.inViewerFromWebPart||ce.isDivSyndicated)&&(rd=!1);ce=()=>{var Le=navigator.userAgentData;if(Le)for(let Ue=0;Ue<Le.brands.length;Ue++){if("Microsoft Edge"===Le.brands[Ue].brand&&parseFloat(Le.brands[Ue].version)>=this.uGf)return!0}else if(navigator.userAgent&&(Le=navigator.userAgent.match(/(Edg|EdgiOS|EdgA)\/(\d+)/i))&&
parseFloat(Le[2])>=this.uGf)return!0;return!1};(ce=(this.pxd||this.qxd)&&!Hc&&!!(navigator&&navigator.clipboard&&navigator.clipboard.read&&navigator.clipboard.write&&ce()))&&n.ULS.sendTraceTag(508703874,0,50,"CopyPasteInfrastructureFactory.configureClipboardPlatformEnvironment: Async System Clipboard is allowed");Hc=this.H4h(rd,!Hc,ce);n.ULS.shipAssertTag(537167758,0,!!Ta.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");
return ea.init({isChangeGateEnabled:cb.EwaSettings.isChangeGateEnabled},C,Yb,Ta.SharedClipboardHostingApp,Ta.SharedClipboardHostingApps,Ta.SharedClipboardHostingEnvironments,Ta.SharedClipboardOverrideOrigin,Ta.SharedClipboardSchemaVersion,Ta.SharedClipboardExpirationInMinutes,Ta.ClipboardPromiseTimeoutInMinutes,wc,Ta.MachineCluster,new jb(this.$),Hc,Ta.DocumentHostInfo.UserId,Ta.ClipboardTtlInMS,cb.EwaSettings.Fa(273),Ta.UserSessionId,Ta.BulsEndpointUrl).then(Le=>Object(fc.a)(new Be,{uMe:ea,r5a:Le}),
Le=>Promise.reject(Le))}H4h(C,ea,Ta){const Yb=[];C&&Ta&&Yb.push(this.DSe(9));C&&ea&&Yb.push(this.DSe(6));ea&&(Yb.push(this.Tdd(7)),Yb.push(this.Tdd(0)));C&&Yb.push(this.vRe());Yb.push({clipboardStrategyType:4});Ta=Yb?Yb.map(wc=>JSON.stringify(wc)).join(","):"[]";n.ULS.sendTraceTag(39978242,0,50,`CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed=${C}, isSystemClipboardAllowed=${ea}, result = ${Ta}`);return Yb}vRe(){const C=
this.$.xa,ea={clipboardStrategyType:5};ea.sessionId=C.UserSessionId;ea.useSharedClipboardIframe=!0;ea.sharedClipboardHostingApp=C.SharedClipboardHostingApp;ea.sharedClipboardHostingApps=C.SharedClipboardHostingApps;ea.sharedClipboardHostingEnvironments=C.SharedClipboardHostingEnvironments;ea.sharedClipboardOverrideOrigin=C.SharedClipboardOverrideOrigin;ea.sharedClipboardSchemaVersion=C.SharedClipboardSchemaVersion;ea.sharedClipboardExpirationInMinutes=C.SharedClipboardExpirationInMinutes;ea.wacCluster=
C.MachineCluster;return ea}DSe(C){const ea={};ea.clipboardStrategyType=C;ea.localStorageStrategyParameters=this.vRe();ea.systemClipboardStrategyParameters=this.Tdd(0);return ea}Tdd(C){const ea={};ea.clipboardStrategyType=C;ea.skipFilesIfPlainTextExists=!0;return ea}static la(C){C.ia.Va(373,new Ff(C));C.ia.Va(Na.Ora,new Na(C))}}Na.Ora=255;Object(m.a)(Na,"CopyPasteInfrastructureFactory",ya.a,[]);var Eb=a(9),ac=a(121),Jc=a(15);class xd extends Kb.a{constructor(C,ea,Ta){super();this.statusBarManager=
null;this.YVe=()=>{this.Pdc()};this.hBh=()=>{this.Pdc()};this.XVe=Yb=>{10===Yb&&this.Pdc()};this.onKeyDown=Yb=>13===Yb.Da.keyCode?(Yb=new be.a(237279923,1,2,6,null),this.$.Ga.Sd(Yb,{[Yc.a.skipClipboardAccess]:!0,[Yc.a.$Ze]:!0}),!0):!1;this.$=C;this.vu=ea;this.np=Ta;this.eid=!1;this.$.ia.Od(29,Yb=>{this.statusBarManager=Yb;Yb.BM(this)})}dispose(){this.Hk();this.np=this.vu=this.$=null;this.statusBarManager&&(this.statusBarManager.WI(this),this.statusBarManager=null)}mq(){return!0}ov(C,ea){if("QueryPasteShortcutEnabledLabel"!==
C&&!xd.P8j.includes(C))return!1;const Ta=this.xI();"QueryPasteShortcutEnabledLabel"===C?(ea.Visible=Ta,n.ULS.sendTraceTag(537167636,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${Ta} for commandId ${C}`)):(ea.Visible=!Ta,n.ULS.sendTraceTag(537167635,0,100,`PasteShortcutManager.ExecuteRootCommand: Setting visible to ${!Ta} for commandId ${C}`));return!0}rGh(){this.Zk();this.raiseEvent("pasteShortcutStatusChanged")}Pdc(){this.Hk();this.raiseEvent("pasteShortcutStatusChanged")}xI(){return this.eid}yt(C){this.addHandler("pasteShortcutStatusChanged",
C)}Ut(C){this.removeHandler("pasteShortcutStatusChanged",C)}Zk(){if(!this.xI()){this.eid=!0;R.h(this.$).il.Yp(this.YVe);this.np.la("blur",this.hBh);const C=this.$.ia.Ja(65);C&&C.u7&&C.u7.registerForCommentEvents(this.XVe);this.vu.Rw(Jc.a.Ne,this.$.QA,this.onKeyDown,!0)}}Hk(){if(this.xI()){this.eid=!1;R.h(this.$).il.Qp(this.YVe);this.np.detach("blur");const C=this.$.ia.Ja(65);C&&C.u7&&C.u7.unregisterForCommentEvents(this.XVe);this.vu.Yw(Jc.a.Ne,this.$.QA,this.onKeyDown,!0)}}}xd.P8j=["QuerySheetNumberButton",
"QueryWorkbookStatisticsButton"];Object(m.a)(xd,"PasteShortcutManager",Kb.a,[697,298,173,5]);var Xd=a(150);class xe extends ya.a{constructor(C){super();this.$=C;this.Oe()}create(){const C=this.$;this.ve(C.ia.Ja(478)||this.$.ia.Va(478,new xd(C,ac.KeyInputManager.instance,Xd.a.instance.WM())))}static la(C){C.ia.Va(479,new xe(C))}}Object(m.a)(xe,"PasteShortcutManagerFactory",ya.a,[]);var $e=a(737),Oe=a(734),Re=a(110),Bf=a(1272),Vf=a(199);let Tf=class{constructor(C,ea,Ta){this.wyb=null;this.$=C;ea?(n.ULS.sendTraceTag(537163346,
0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.wyb=new Bf.a(C,ea,Ta)):n.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}hf(){return!1}executeCommand(C,ea,Ta){C=!1;switch(ea.command){case 73979048:this.wyb&&this.wyb.Jpj(ea,Re.a.instance,J.AFrameworkApplication.da,Ta),C=!0}return C?Tc.Task.Ua(!0):Vf.a(ea.command)}Ue(C,ea){return 73979048===ea.command&&cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)}mf(){return!1}dispose(){this.wyb&&this.wyb.dispose()}};Tf=Object(Oe.a)([Object(Ad.d)(Ub.P),Object(Oe.b)(0,Object(Ub.fb)()),Object(Oe.b)(1,Object(Ub.j)()),Object(Oe.b)(2,Object(Ub.wd)())],Tf);Object(m.a)(Tf,"DataFromPictureCommandHandler",null,[169,5]);class rg extends $e.a{constructor(C){super(C)}yg(){const C=Object(ub.d)(Ad.a.resolve(Ub.j,{Oa:1})),ea=Object(ub.d)(Ad.a.resolve(Ub.wd,{Oa:this.$a}));fd.TaskExtensions.Aa(fd.TaskExtensions.Tg([C,ea],this.$.ma),()=>{this.vg([new Tf(this.$,C.result,
ea.result)])},this.$.ma,3)}static la(C){$e.a.dh(452,new rg(C))}}Object(m.a)(rg,"DataFromPictureCommandHandlerFactory",$e.a,[]);var bg=a(519),gh=a(1162),xh=a(327),Wg=a(829),Ya=a(154);class Cb extends gh.a{constructor(C,ea,Ta){super(C,ea,Ta);this.p2b=this.Ova=null}get JR(){return J.AFrameworkApplication.sa.XE}Qaf(C){switch(C){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}Axg(C){return Cb.Kia(C,this.Pki())}Pki(){return Cb.hwe}Kia(C,
ea){ea=void 0===ea?null:ea;C=this.Axg(C);return 0!==C?(ea&&ea.tye(),2===C&&this.ol(0,this.Qaf(C)),!1):!0}finalizeUpload(C,ea){n.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.SMd=ea;this.x3j();xh.a.mark(5576);this.p2b=this.JR.xf("LoadResource","PictureUploadTime")}ol(C,ea){const Ta=new Ya.StandardDialog;Ta.ke=0;Ta.mD(C,CommonUIStrings.l_ImageUploadFailedTitle,ea,null)}lNb(){n.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.lNb();this.p2b&&(this.p2b.stop(),
this.p2b=null);this.Tih()}x3j(){this.Ova=(new Wg.a).create();this.Ova.message=CommonUIStrings.l_ImageUploadWait;this.Ova.ke=5;this.Ova.Gw=!1;this.Ova.ZEa(null,null,null)}Tih(){this.Ova&&(this.Ova.close(),this.Ova=null)}static Jri(C,ea){C=ob.a.rn(C);for(let Ta=0;Ta<ea.length;++Ta)if(C.endsWith(ea[Ta]))return!0;return!1}static Kia(C,ea){ea=void 0===ea?null:ea;ea||(ea=Cb.hwe);return C?Cb.Jri(C,ea)?0:2:1}}Cb.hwe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(m.a)(Cb,"PictureUploader",gh.a,[]);
var cc=a(569),Rc=a(323),gd=a(234),Md=a(153),td=a(178),Fe=a(95),Se=a(101),gf=a(157),Hf=a(195),Ef;(function(C){C[C.unknown=0]="unknown";C[C.bing=1]="bing";C[C.M365=2]="M365"})(Ef||(Ef={}));Object(m.b)("InsertMediaProviders",Ef);var Lf=a(97),Wf=a(901);class Sg extends Wf.a{constructor(C,ea){super(C,H.a.vN(ea))}xPb(C,ea){this.isEnabled()&&this.KS(this.targetOrigin)&&(this.yn(C),this.tm(C,ea))}}Object(m.a)(Sg,"InsertMediaCrossDocumentMessenger",Wf.a,[621,241,5]);class Ze{}Object(m.a)(Ze,"OnlineMediaSearchResult",
null,[]);var kh=a(325),Eg=a(868),th=a(355),$h;(function(C){C[C.OK=0]="OK";C[C.cancel=1]="cancel";C[C.error=2]="error";C[C.open=3]="open"})($h||($h={}));Object(m.b)("HubbleAction",$h);var zh=a(71);class Pf extends Md.a{constructor(C,ea,Ta,Yb,wc,Hc){super();this.upc=!1;this.correlationId=this.fEd=this.EE=this.rAa=null;this.I5i=()=>{this.Iya(this.v4a);this.DEc(1)};this.WCd=rd=>{rd.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==rd.target.id||rd.shiftKey?"KeepFocusStartDiv"===rd.target.id&&rd.shiftKey&&(rd.preventDefault(),
document.getElementById("KeepFocusDiv").focus()):(rd.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};this.kcj=()=>{this.$tb&&(this.$tb.launchUpsellExperience("stockimages"),n.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};this.Jdj=rd=>{rd&&rd.Values&&(rd=rd.Values,delete rd.m_Origin,delete rd.m_Source,delete rd.m_ReceivedTime,n.ULS.sendTraceTag(508953229,0,50,"Received OTel event: "+rd.eventName||!1),td.a.sendOtelEvent(Object.assign(new Eg.a,
{otelEvent:rd})))};this.Om=Hc;this.$=C;this.Rof=ea;this.$tb=Ta;this.oaa=[];this.Ddb=Yb;this.DAh=wc;this.yCe=this.$.xa.InsertOnlinePictureMaxCountOfImagesToInsert;this.ti=this.Wrh()}p3j(C){this.upc=!1;this.showDialog(this.Om,null);this.rAa=document.getElementById(this.qk("InsertMediaFrame"));if(!this.rAa)throw this.Iya(this.v4a),Error.invalidOperation("Couldn't get InsertMediaIframe.");var ea=document.getElementById(this.qk("WACDialogPanel"));ea&&ea.setAttribute(Fe.a.pg,Fe.a.vub);ea=document.createElement("div");
ea.id="KeepFocusStartDiv";ea.tabIndex=0;ea.className="keep-focus-start";this.rAa.parentNode.insertBefore(ea,this.rAa.parentNode.firstChild);ea=document.createElement("div");ea.id="KeepFocusDiv";ea.tabIndex=0;ea.className="keep-focus";this.correlationId=la.a.create();this.rAa.parentNode.appendChild(ea);$addHandler(this.dNa,"keydown",this.WCd);this.rAa.src=this.Rof;this.rAa.frameBorder="0";ea=document.getElementById(this.qk("WACDialogButtonPanel"));if(!ea)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");
ea.className="display-none";ea=document.getElementById(this.qk("WACDialogTitleText"));if(!ea)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");ea.className="display-none";2===this.Ddb&&(document.getElementById(this.qk("WACDialogTitlePanel")).className="display-none",document.getElementById(this.qk("WACDialogBodyPanel")).className="padding-zero");Se.FocusManager.instance().bU().scope.ZY=!0;this.EE=new Sg(this.rAa.contentWindow,this.Rof);this.EE.KS("https://osiziwuspersimmon002.blob.core.windows.net");
this.EE.KS("https://osizewuspersimmon001.blob.core.windows.net");this.EE.KS("https://osizpscuspersimmon000.blob.core.windows.net");this.EE.KS("https://cdn.hubblecontent.msit.osi.office.net");this.EE.KS("https://cdn.hubblecontent.osi.office.net");this.EE.xPb(gf.a.rWg,Ta=>{this.u4i(Ta,C.eba)});this.EE.xPb(gf.a.insert,()=>{this.Abj(C.eba)});this.EE.xPb(gf.a.m9c,this.I5i);this.EE.xPb(gf.a.SWg,Ta=>{this.Jdj(Ta)});2===this.Ddb&&0===this.DAh&&(this.EE.xPb(gf.a.kQi,this.kcj),this.fEd=this.$tb.kVa("MsoPremiumStockImages",
Ta=>{n.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");Ta.isEnabled?this.EE.sendMessage(gf.a.Pnk,{["LicenseTier"]:Ta.toString()}):n.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}));this.DEc(3)}dispose(){this.oaa=null;this.$tb&&this.fEd&&this.$tb.sTd("MsoPremiumStockImages",this.fEd);this.EE&&(this.EE.dispose(),this.EE=null);super.dispose()}hide(){super.hide();Lf.a.oFc(this.$)}get s8(){return Hf.a.xdc+
"/InsertMediaDialog"}get n1(){return!1}u4i(C,ea){C=C&&C.Values?(C=C.Values)?Object(fc.a)(new Ze,{Action:C.action||"",Caption:C.caption||"",ContentType:C.contentType||"",FileExtension:C.extension||"",PageUrl:C.pageUrl||"",SourceUrl:C.sourceUrl||"",ThumbnailUrl:C.thumbnailUrl||"",LicenseUrl:C.licenseUrl||"",LicenseDisplayName:C.licenseDisplayName||"",Height:C.height||0,Width:C.width||0}):null:null;C&&(this.oaa.push(C),this.upc&&(n.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),
ea(this.oaa),this.upc=!1,this.Iya(this.v4a)))}Abj(C){this.oaa&&0<this.oaa.length?this.oaa.length<=this.yCe?(C(this.oaa),this.DEc(0),this.Iya(this.v4a)):(this.mD(),n.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),this.oaa.length=0,this.DEc(2)):this.upc=!0}Wrh(){const C=document.createElement("div");C.id="InsertMediaDialog";C.className=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":
"insert-media-dialog-old";const ea=document.createElement("div");ea.id="InsertMediaPanel";ea.className=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";const Ta=document.createElement("iframe");Ta.id="InsertMediaFrame";Ta.className="insert-media-frame";C.appendChild(ea);ea.appendChild(Ta);return kh.b(C)}mD(){const C=te.a.Mf(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");C.Description=
String.format(gb.a.instance.Qd(206),this.yCe.toLocaleString());cb.EwaSettings.AC()?new Yd.a(this.$,C):(new Kd.ErrorDialog(this.$,C)).Zi()}tbi(){return 2===this.Ddb?"M365":"bing"}DEc(C){var ea,Ta;if(2===this.Ddb||1===this.Ddb){const wc=J.AFrameworkApplication.da.Ra("InsertMediaDialogAriaTenantNameSpace");if(wc&&""!==wc){var Yb=[];Array.add(Yb,Object.assign(new zh.a,{name:"DialogMode",string:this.tbi()}));Array.add(Yb,Object.assign(new zh.a,{name:"Provider",string:Ef[this.Ddb]}));Array.add(Yb,Object.assign(new zh.a,
{name:"InsertedFiles",int64:null===(ea=this.oaa)||void 0===ea?void 0:ea.length}));Yb.push(Object.assign(new zh.a,{name:"MediaDetails",string:this.oaa?JSON.stringify(this.oaa.map(Hc=>Hc.SourceUrl)):null}));Array.add(Yb,Object.assign(new zh.a,{name:"DialogResult",string:$h[C]}));Array.add(Yb,Object.assign(new zh.a,{name:"CorrelationId",string:null===(Ta=this.correlationId)||void 0===Ta?void 0:Ta.toString()}));td.a.sendTelemetryEvent(Object.assign(new th.a,{name:String.format("{0}.{1}",wc,"InsertOnlineImages"),
dataFields:Yb}))}}}}Object(m.a)(Pf,"InsertMediaDialog",Md.a,[]);var eh=a(392),kg=a(301);class bh extends Cb{constructor(C,ea,Ta,Yb,wc,Hc){super(null,Ta,Yb);this.jDf=0;this.eba=rd=>{if(rd){var ce=Array(rd.length);for(var Le=0;Le<rd.length;Le++){const rf=rd[Le];ce[Le]={};ce[Le].SourceUrl=rf.SourceUrl;ob.a.WAa(rf.LicenseUrl)&&ob.a.WAa(rf.PageUrl)&&(ce[Le].LicenseUrl=rf.LicenseUrl,ce[Le].LicenseDisplayName=rf.LicenseDisplayName,ce[Le].PageUrl=rf.PageUrl);ce[Le].AltText=-2053056795===this.Yf.command?rf.Caption:
"";ce[Le].IsCellPicture=15735758===this.Yf.command||570484235===this.Yf.command}var Ue=-2009825598===this.Yf.command?"bing":"M365";Le=R.h(this.$);var mf=ab.o(Le.ga.ra.activeCell,this.$);uf.a(this.$.userOperationManager,(rf,Of,Ag)=>Rc.u(this.$.qa.ua,mf,ce,Ue,Je.b(rf,this.bej),Je.a(Of,this.aej),Ag,null),rf=>new ud.a(595,0,rf),this.Yf);qe.HelperMethods.h3?(Le=new Map,Le.set("MediaProvider",Ue),Le.set("ImagesCount",rd.length.toString()),Le.set("TimeTakenToOpenDialog",this.jDf.toString()),I.Health.instance.recordKpiUsage(kg.a.zzi,
1,eh.a.cpg,Le)):n.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.lNb()}else n.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};this.bej=rd=>{if(gd.a(rd))n.ULS.sendTraceTag(537155799,0,10,`OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: ${te.a.Me(rd.Errors)}`);else{n.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded.");
const ce=this.Yf.command;15735758!==ce&&570484235!==ce&&(rd.Result?of.a(this.$).maa(1,rd.Result):n.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))}};this.aej=()=>{n.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};this.$=C;this.Yf=ea;this.ZL=Hc;this.gDe=Ca.a.instance.ie("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.showDialog()}dispose(){this.$=null}showDialog(){let C=
null;C=this.$.pe.xf("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Yf.command){case -2009825598:case 15735758:this.B2j();break;case -2053056795:case 570484235:this.gDe.execute(ea=>{ea.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Ta=>n.ULS.sendTraceTag(557200643,0,10,`OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: ${Ta}`)).then(Ta=>{this.C2j(Ta);return null})})}C.stop();this.jDf=C.pf}B2j(){let C=this.$.xa.BingPictureEndpoint;
const ea=cc.a.sN(J.AFrameworkApplication.lcid),Ta=la.a.create();C?(C=0<C.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(C,1,1):String.format(C,1,J.AFrameworkApplication.lcid,ea?ea.name:"en-us",J.AFrameworkApplication.buildVersion,Ta.toString(),1,this.$.xa.DocumentHostInfo.LoggableUserId),this.Abc(C,1,-1,gb.a.instance.ha(1764))):(n.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.ZL.setException(Error.create("Failed to access the Bing service endpoint")))}C2j(C){var ea=
this.$.xa.M365PictureEndpoint,Ta=la.a.create();if(ea){var Yb=this.$.xa.DocumentHostInfo.UserId;Yb=Yb?ob.a.hz(Yb).toString():"0";var wc=this.gDe.instance.isFreemiumUpsellEnabled();C=C?1:wc?0:-1;Ta=Ta.toString();wc=cc.a.sN(J.AFrameworkApplication.lcid).name;ea=String.format(ea,J.AFrameworkApplication.lcid,wc,J.AFrameworkApplication.buildVersion,Ta,1,Yb,C,1);this.Abc(ea,2,C,gb.a.instance.ha(1763))}else n.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),
this.ZL.setException(Error.create("Failed to access the M365 service endpoint"))}Abc(C,ea,Ta,Yb){try{(new Pf(this.$,C,Ca.a.instance.Ii("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),ea,Ta,Yb)).p3j(this),this.ZL.setResult(!0)}catch(wc){n.ULS.sendTraceTag(537155802,0,10,`OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : ${wc}] [MediaProvider : ${ea}] [DialogLicenseTier : ${Ta}]`),this.ZL.setException(wc)}}}Object(m.a)(bh,"OnlinePictureUploaderWrapper",Cb,[5]);let jh=
class{constructor(C,ea){this.$=C;this.uploaderCreator=ea}executeCommand(C,ea,Ta){C=ea.command;switch(C){case 1403967063:case -2060689045:if(Ta&&"dataUrl"in Ta)return ea=new Te.a,this.uploaderCreator&&this.uploaderCreator.hxi(this.$,Re.a.instance,J.AFrameworkApplication.da,Ta,Ta.dataUrl,ea),ea.task;this.uploaderCreator&&this.uploaderCreator.jyi(this.$,ea,Re.a.instance,J.AFrameworkApplication.da,Ta);return Tc.Task.Ua(!0);case -2053056795:case -2009825598:case 570484235:case 15735758:return C=new Te.a,
new bh(this.$,ea,Re.a.instance,J.AFrameworkApplication.da,Ta,C),C.task;default:return Vf.a(C)}}Ue(C,ea){let Ta=this.$.isEditMode;if(Ta)switch(ea.command){case 1403967063:Ta=!0;break;case -2053056795:Ta=!0;break;case -2009825598:Ta=!0;break;case -2060689045:case 15735758:case 570484235:Ta=kc.a.WGb()&&1===C;break;default:Ta=!1}return Ta}mf(){return!1}hf(){return!1}};jh=Object(Oe.a)([Object(Ad.d)(Ub.Qb),Object(Oe.b)(0,Object(Ub.fb)()),Object(Oe.b)(1,Object(Ub.wd)())],jh);Object(m.a)(jh,"PictureCommandHandler",
null,[169]);class Ih extends $e.a{constructor(C){super(C)}yg(){fd.TaskExtensions.Aa(Object(ub.d)(Ad.a.resolve(Ub.wd,{Oa:this.$a})),C=>{this.vg([new jh(this.$,C.result)])},this.$.ma,3)}static la(C){$e.a.dh(90,new Ih(C))}}Object(m.a)(Ih,"PictureCommandHandlerFactory",$e.a,[]);var Oh=a(397),Rh=a(47);class Jh{constructor(){this.dha=this.U8e=null}}Object(m.a)(Jh,"GestureAdapterInfo",null,[]);class vg{constructor(){this.fRc=null}JRi(){if(!this.fRc){var C="hammer.min.js";J.AFrameworkApplication.da.As("IsServerFlavorDebug")&&
(C=J.AFrameworkApplication.da.na("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");C=J.AFrameworkApplication.xV(String.format("{0}",C),5);C=X.a.create(C,null,null);Fa.a.uya(C);this.fRc=C.adb}return this.fRc}static get instance(){vg.La||(vg.La=new vg);return vg.La}}vg.La=null;Object(m.a)(vg,"HammerJsDependencyLoader",null,[830]);var Og;(function(C){C[C.none=-1]="none";C[C.ezc=0]="pinch";C[C.pan=1]="pan";C[C.j5d=2]="swipe"})(Og||(Og={}));Object(m.b)("GestureEvent",Og);var wg=a(83);class cg extends wg.a{constructor(C,
ea,Ta,Yb,wc,Hc,rd,ce){super(C,Ta,Yb,Hc);this.Nmb=ea;this.fka=rd;this.$_=ce;this.OJg=wc}get shiftKey(){return this.fka}get ctrlKey(){return this.$_}get clientPoint(){return this.Nmb}get dza(){return this.OJg}static create(C,ea,Ta,Yb,wc,Hc){if(Ta.rawEvent)if(Hc){var rd=Ta.rawEvent;rd=new Sys.UI.Point(rd.clientX,rd.clientY)}else rd=wg.a.aCb(Ta);else rd=new Sys.UI.Point(Ta.clientX,Ta.clientY);return new cg(C,rd,ea,Ta,Yb,wc,Ta.shiftKey,Ta.ctrlKey,Hc)}}Object(m.a)(cg,"GestureEventArgs",wg.a,[]);class Pg{constructor(){this.srcEvent=
this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(m.a)(Pg,"GestureManagerData",null,[]);class sh{}sh.eDg=2;sh.fDg=4;sh.gDg=8;sh.hDg=8;Object(m.a)(sh,"HammerConstants",null,[]);
var ji=a(99),$f=a(207),Aa=a(85);class zb extends Rh.a{constructor(C,ea){super();this.Dua=Oh.a.Z0h;this.QYc=!!window.PointerEvent;this.vve=window.hasOwnProperty("ontouchstart");this.d0a=this.kqb=null;this.Rba=!1;this.zW=new Dc.a;this.Eqb=new Dc.a;this.PJg=new nb.a;this.$ta=null;this.f_a=this.cTc=this.yee=this.SPc=this.HWc=this.Pre=this.Eee=this.jsb=!1;this.Ppb=-1;this.curRecognizer=this.element=this.handlers=this.session=this.u0c=null;this.bDa=(Ta,Yb,wc)=>{Ta=this.ucf(Ta);Yb=this.M$h(wc);Hammer.inputHandler(this,
Ta,Yb);this.Rba&&wc.preventDefault();return this.Rba};this.ETa=(Ta,Yb,wc)=>{var Hc=wc.rawEvent.pointerType.toString();const rd=wc.rawEvent.pointerId.toString();if("touch"!==Hc)return!1;Ta=this.ucf(Ta);if(1!==Ta&&!this.zW.Hd(rd))return!1;this.Eee&&1===Ta&&wc.rawEvent.isPrimary&&this.zW.count&&(n.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.W9b());this.jsb?this.OWg(rd,Yb,wc):this.zW.fa(rd,wc);this.HWc&&2===Ta&&(!this.SPc||this.SPc&&"function"===typeof wc.rawEvent.getCoalescedEvents)&&
(Yb=wc.rawEvent.getCoalescedEvents())&&this.gkf()&&(this.Ppb=Math.max(this.Ppb,Yb.length));this.Pre&&(this.Rba=!1);Hc=this.L$h(this.zW,wc,Hc);Hammer.inputHandler(this,Ta,Hc);if(4===Ta||8===Ta)this.jsb?this.d5f(rd):this.zW.remove(rd),this.zW.count||(this.session=null,this.HWc&&-1!==this.Ppb&&(n.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Ppb),this.Ppb=-1));this.Rba&&wc.preventDefault();return this.Rba};this.kxc=()=>!1;this.sg=ji.EventHandlerManager.instance;this.QYc?
(n.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.kqb=this.ETa,this.d0a=Jc.a.a1h):this.vve?(n.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.kqb=this.bDa,this.d0a=Jc.a.OVb):(n.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.kqb=this.kxc,this.d0a=Jc.a.$0h);this.hk=ea;this.fja=C;J.AFrameworkApplication.da&&(this.jsb=J.AFrameworkApplication.da.na("UsePointerCaptureIsEnabled"),this.Eee=J.AFrameworkApplication.da.na("ClearCacheOnPrimaryPointerIsEnabled"),this.Pre=
J.AFrameworkApplication.da.na("ResetHandledBeforeInputHandlerIsEnabled"),this.HWc=J.AFrameworkApplication.da.na("LogCoalescedEventsIsEnabled"),this.SPc=J.AFrameworkApplication.da.na("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.yee=J.AFrameworkApplication.da.na("CheckIfHammerExistsAfterDownloadIsEnabled"),this.cTc=J.AFrameworkApplication.da.na("HammerJsPerformanceTimersIsEnabled"),this.f_a=this.jsb&&J.AFrameworkApplication.da.na("CancelDragFromGestureInputManagerIsEnabled")&&J.AFrameworkApplication.da.na("UseGestureInputManagerPointerCacheIsEnabled"))}H9h(){return this.QYc?
0:this.vve?1:2}hq(C){super.hq(C);this.sg.qoa(this.d0a,C,0,this.kqb)}Xo(C){super.Xo(C);this.sg.ZMa(C,this.d0a)}Pyj(C,ea,Ta){Ta=void 0===Ta?null:Ta;var Yb=void 0===Yb?null:Yb;J.AFrameworkApplication.Mpc()?vg.instance.JRi().continueWith(wc=>{this.p8j();if(wc.vi||wc.Yj)n.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",wc.status);else{n.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",wc.status);if(this.yee){wc=window.Hammer;if("undefined"===typeof wc){n.ULS.sendTraceTag(590901389,
310,10,"Hammer does not exist");this.kIc();return}if("undefined"===typeof wc.inputHandler){n.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.kIc();return}}if(!C)throw this.kIc(),Error.argumentNull("source element can not be null");wc=$f.a.Cza(C,this.Dua);if(void 0===wc||null===wc)wc=new Dc.a,$f.a.Qib(C,this.Dua,wc),this.Qyj(C);var Hc=null;if(!wc.Hd(Og[0])){Hc=Object;var rd=Hc.assign,ce=new Jh,Le=Og[0],Ue=Yb;Ue=void 0===Ue?null:Ue;if(void 0===this||null===this)throw n.ULS.sendTraceTag(42256258,
310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let mf=null;switch(Le){case Jc.a.ezc:mf=new Hammer.Pinch(Ue);break;case Jc.a.pan:mf=new Hammer.Pan(Ue)}mf&&(mf.manager=this);Hc=rd.call(Hc,ce,{dha:mf,U8e:ea});wc.add(Og[0],Hc)}if(void 0!==Ta&&null!==Ta)for(rd=0;rd<Ta.length;rd++)wc.Hd(Og[Ta[rd]])&&(ce=wc.ka(Og[Ta[rd]]),Hc.dha.recognizeWith(ce.dha))}this.kIc()}):n.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}p8j(){this.cTc&&
(this.hk?this.u0c=this.hk.xf("Task","RegisterGestureAdapterAfterLoad"):n.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}kIc(){this.cTc&&(this.u0c?this.u0c.stop():n.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}Qyj(C){this.PJg.add(C);this.sg.qoa(this.d0a,C,0,this.kqb)}recognize(C){var ea=Array(C.pointers.length);for(var Ta=0;Ta<C.pointers.length;Ta++)ea[Ta]=C.pointers[Ta].target;Ta=null;for(this.$ta=this.lbi(ea);void 0!==this.$ta&&null!==
this.$ta&&(Ta=$f.a.Cza(this.$ta,this.Dua),void 0===Ta||null===Ta);this.$ta=this.$ta.parentNode);if(void 0!==Ta&&null!==Ta){this.curRecognizer&&this.curRecognizer.state===sh.hDg&&(this.curRecognizer=null);ea=Ta.keys;for(const Yb of ea){ea=Ta.ka(Yb);void 0!==ea&&null!==ea&&void 0!==ea.dha&&null!==ea.dha&&(void 0===this.curRecognizer||null===this.curRecognizer||ea.dha===this.curRecognizer||ea.dha.canRecognizeWith(this.curRecognizer))&&ea.dha.recognize(C);const wc=ea.dha.state;this.curRecognizer||sh.eDg!==
wc&&sh.fDg!==wc&&sh.gDg!==wc||(this.curRecognizer=ea.dha)}}}emit(C,ea){if("hammer.input"!==C){this.Rba=!1;ea=cg.create(C,this.$ta,ea.srcEvent,ea,3,this.QYc);var Ta=$f.a.Cza(this.$ta,this.Dua);if(this.nJi(C))var Yb=0;else if(this.cJi(C))Yb=1;else if(this.sMi(C))Yb=2;else{n.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:Ta}=Ta.Jf(Og[Yb]));void 0!==Ta&&null!==Ta&&((Ta=Ta.U8e,Ta.AGi())?C.endsWith("start")?this.Rba=Ta.W9i(ea):C.endsWith("end")?(Ta.U9i(ea),
this.Rba=!0):C.endsWith("cancel")?(Ta.T9i(ea),this.Rba=!0):C.endsWith("move")&&(this.Rba=Ta.V9i(ea)):n.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",C))}}get(C){return Object(z.a)(Hammer.Recognizer,C)}lbi(C){if(1>C.length)return null;if(1===C.length)return C[0];var ea=C[0],Ta=!0;for(let Yb=1;Yb<C.length;Yb++){if(!C[Yb])return null;if(ea!==C[Yb]){Ta=!1;break}}if(Ta)return ea;ea=this.l9e(C[0]);Ta=0;for(const Yb of C){C=this.l9e(Yb);if(ea.ka(ea.count-1)!==C.ka(C.count-
1))return null;for(let wc=ea.count-2,Hc=C.count-2;wc>=Ta&&0<=Hc;wc--,Hc--)if(ea.ka(wc)!==C.ka(Hc)){Ta=wc+1;break}}return ea.ka(Ta)}l9e(C){const ea=new nb.a;for(;void 0!==C&&null!==C;C=C.parentNode)ea.add(C);return ea}ucf(C){switch(C){case Jc.a.ji:case Jc.a.gda:return 1;case Jc.a.wj:case Jc.a.rla:return 2;case Jc.a.Wg:case Jc.a.kLa:return 4;case Jc.a.XJc:case Jc.a.f8c:return 8}return 0}gkf(){return 1<this.zW.count}W9b(){n.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.jsb)for(const C of this.zW)this.d5f(C.key);
else this.zW=new Dc.a;this.session=null}OWg(C,ea,Ta){n.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",C);if(!this.Eqb.Hd(C)){try{ea.setPointerCapture(C)}catch(Yb){n.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",Yb)}this.Eqb.add(C,ea)}this.zW.fa(C,Ta);this.f_a&&1<this.zW.count&&this.fja&&!this.fja.Svb&&(this.fja.Svb=!0)}d5f(C){n.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",C);if(this.Eqb.Hd(C)){try{this.Eqb.ka(C).releasePointerCapture(C)}catch(ea){n.ULS.sendTraceTag(594055956,
310,10,"Exception: {0}",ea)}this.Eqb.remove(C)}else n.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",C);this.zW.remove(C);this.f_a&&1>=this.zW.count&&this.fja&&this.fja.Svb&&(this.fja.Svb=!1)}M$h(C){const ea=new Pg;var Ta=C.rawEvent;const Yb=Ta.touches;Ta=Ta.changedTouches;ea.pointers=Array.clone(Yb);ea.pointers=Array.clone(0<Yb.length?Yb:Ta);ea.changedPointers=Array.clone(Ta);ea.srcEvent=C;ea.pointerType="touch";return ea}L$h(C,ea,Ta){const Yb=new Pg;
Yb.pointers=Aa.toArray(C.values);Yb.changedPointers=[ea];Yb.pointerType=Ta;Yb.srcEvent=ea;return Yb}nJi(C){return ob.a.startsWith(C,Jc.a.ezc)}cJi(C){return ob.a.startsWith(C,Jc.a.pan)}sMi(C){return ob.a.startsWith(C,Jc.a.j5d)}}Object(m.a)(zb,"GestureInputManager",Rh.a,[693,694]);var sc=a(293);class Pc{constructor(){this.Fd=null;this.oA=!1}get name(){return"Common.App.GestureInputManager"}nk(C){C.register(zb,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Ve().$e(()=>
new zb(sc.a.instance,J.AFrameworkApplication.sa.XE));this.Fd=C}init(){this.oA||(this.Fd.resolve("Common.App.GestureManager.GestureInputManager"),this.oA=!0)}dispose(){}static main(){Ua.a.instance.$k(new Pc)}}Object(m.a)(Pc,"GestureInputManagerPackage",null,[3,4]);var kd=a(106);class ja extends kd.a{constructor(){super()}static instance(){return ja.La||(ja.La=new ja)}}ja.mhj="OnTextSelectionHighlightChangeEvent";ja.La=null;Object(m.a)(ja,"TextSelectionHighlightChangeEvent",kd.a,[]);class ia extends Md.a{constructor(C,
ea){super(!1,!1,!0);this.UJj=(Ta,Yb)=>{1===Ta&&(this.TGa.dvd=Yb.tooltipPersistenceEnabled,J.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",!1)&&(Ta=Yb.textSelectionChangeEnabled,this.TGa.qVb!==Ta&&this.gSg.raiseEvent(ja.mhj),this.TGa.qVb=Ta))};this.TGa=C;this.gSg=ea}start(){const C={["tooltipPersistenceEnabled"]:this.TGa.dvd};J.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.SelectionHighlightChangeEnabled",
!1)&&(C.textSelectionChangeEnabled=this.TGa.qVb);this.initializeAndShow("",this.UJj,{["id"]:"AccessibilitySettingsDialog",["bodyControls"]:C})}}Object(m.a)(ia,"AccessibilitySettingsDialog",Md.a,[]);var dc=a(118);class od{constructor(C,ea){this.P1j=()=>{(new ia(this.TGa,ja.instance())).start();return 32};this.Na=C;this.TGa=ea}Oj(){this.Na.xe(Ga.a.O1j,dc.a.frame,this.P1j)}}Object(m.a)(od,"AccessibilitySettingsDialogActor",null,[692]);const ae=C=>{const ea=new Te.a;J.AFrameworkApplication.Wf.zp(Xe(C),
1,null,null,!0,2,Ta=>{200===Ta.data.httpStatus?ea.setResult("true"===Ta.data.Fg.toLowerCase()):ea.setResult(!1)},()=>{ea.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return ea.task},Pe=(C,ea)=>{J.AFrameworkApplication.Wf.zp(Xe(C),2,ea.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8")},Xe=C=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",J.AFrameworkApplication.da.appSettings.RoamingServiceHandlerWebServiceBase||"",C,J.AFrameworkApplication.fl);
var vf=a(149);class Sf{constructor(){this.c2a=this.j0a=null}get dvd(){return!!this.j0a}set dvd(C){C!==this.j0a&&(this.j0a=C,vf.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(C),this.Kqc()&&Pe("saveHoverableRibbonTooltipIsEnabled",C))}get qVb(){return!!this.c2a}set qVb(C){C!==this.c2a&&(this.c2a=C,this.Kqc()&&Pe("saveTextSelectionHighlightChangeIsEnabled",C))}PRi(){const C=new Te.a;if(this.j0a)C.setResult(this.j0a);else if(this.Kqc()){const ea=ae("getHoverableRibbonTooltipIsEnabled");
ea.continueWith(()=>{this.j0a=ea.result;vf.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ea.result);C.setResult(ea.result)},8)}else C.setResult(!1)}lSi(){const C=new Te.a;if(this.c2a)C.setResult(this.c2a);else if(this.Kqc()){const ea=ae("getTextSelectionHighlightChangeIsEnabled");ea.continueWith(()=>{this.c2a=ea.result;C.setResult(ea.result)},8)}else C.setResult(!1)}Kqc(){const C=J.AFrameworkApplication.da.na("IsRoamingServiceEnabled"),ea=J.AFrameworkApplication.da.na("IsAnonymousUser");
return C&&!ea}}Object(m.a)(Sf,"AccessibilitySettingsInfo",null,[691]);var xf=a(116);class Jg{constructor(){this.Fd=null}get name(){return"Common.App.AccessibilitySettings"}nk(C){this.Fd=C;this.Fd.register(Sf,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").$e(()=>new Sf).Ve();this.Fd.register(od,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").$e(()=>
new od(J.AFrameworkApplication.Vd,this.Fd.Ii("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).Ve()}init(){const C=this.Fd.Ii("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ea=this.Fd.Ii("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");C&&ea?(ea.Oj(),C.PRi(),C.lSi(),xf.a(508827098,200,50,"Text Selection Highlight Change Setting value on boot: {0}",C.qVb)):xf.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){Ua.a.instance.$k(new Jg)}}
Object(m.a)(Jg,"AccessibilitySettingsPackage",null,[3,4]);var yg=a(35),Xf=a(14),Lg=a(253);class lg{constructor(C){this.IDc=C||""}static get SYe(){return lg.lhe||(lg.lhe=new lg(""))}static get LFd(){return lg.Ane||(lg.Ane=lg.pY(2).IDc)}static qOa(C){C=ob.a.Bm(C||"");return new lg(C)}static kna(C){return lg.qOa(gb.a.instance.ha(C))}static pY(C){return new lg(gb.a.instance.za(C))}static mmd(C,...ea){return lg.fZh(gb.a.instance.Qd(C),...ea)}static fZh(C,...ea){const Ta=ea.length,Yb=Array(Ta);for(let wc=
0;wc<Ta;wc++)Yb[wc]=(ea[wc]||lg.SYe).IDc;return new lg(String.format(C,Yb))}}lg.lhe=null;lg.Ane=null;Object(m.a)(lg,"SafeHtml",null,[573]);const Kf=(C,ea)=>{ea&&(C.append(ea),C.append(lg.LFd))};var Dh=a(119),hh=a(781),Da=a(226);class Lb{constructor(C,ea){this.l4=this.lV=this.jO=null;this.fna=ea;this.auh(C);this.Dpj();cb.EwaSettings.Xd()&&C.ia.Va(244,this)}get isActive(){return!!this.fna&&document.activeElement===this.fna}readText(C){C=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:7663175_RemoveGridBeingReadoutInFocusBasedReadout")?
C:String.format(gb.a.instance.Qd(30),C);this.jO.setAttribute(Yc.a.nx,C);this.lV.setAttribute(Yc.a.nx,C);this.O$j()}dispose(){this.l4&&this.l4.parentNode&&this.l4.parentNode.removeChild(this.l4);this.lV=this.jO=this.l4=this.fna=null}auh(C){var ea=C.He+"readoutElementWrapper";const Ta=C.He+"readoutElement1",Yb=C.He+"readoutElement2";this.l4=document.getElementById(ea);this.l4||(this.l4=document.createElement(Da.a.div),this.l4.id=ea,this.jO=document.createElement(Da.a.label),this.jO.id=Ta,this.jO.setAttribute(Yc.a.pg,
Yc.a.K3a),this.jO.setAttribute("aria-roledescription",""),this.jO.setAttribute("aria-multiline",!1),this.lV=document.createElement(Da.a.label),this.lV.id=Yb,this.lV.setAttribute(Yc.a.pg,Yc.a.K3a),this.lV.setAttribute("aria-roledescription",""),this.lV.setAttribute("aria-multiline",!1),this.jO.style.width="0px",this.jO.style.height="0px",this.lV.style.width="0px",this.lV.style.height="0px",this.jO.tabIndex=-1,this.lV.tabIndex=-1,this.l4.appendChild(this.jO),this.l4.appendChild(this.lV),C=C.He+Yc.a.Xac,
ea=document.getElementById(C),n.ULS.shipAssertTag(537153942,3,!!ea,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${C}`),ea&&ea.appendChild(this.l4))}Dpj(){this.fna&&this.jO&&this.lV&&(this.fna.setAttribute(Yc.a.Q6,this.jO.id),this.fna.setAttribute(Yc.a.i8b,`${this.jO.id} ${this.lV.id}`))}O$j(){if(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.isActive){let C="";Xf.DOMElementExtensions.hasAttribute(this.fna,Yc.a.Q6)&&
(C=this.fna.getAttribute(Yc.a.Q6).toString());this.fna.setAttribute(Yc.a.Q6,C===this.jO.id?this.lV.id:this.jO.id)}this.isActive||n.ULS.sendTraceTag(537153941,0,50,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static NAa(){if(null==Lb.jBb)if(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8104883_ActiveDescendantGridReadout")&&!Z.a.BRa)Lb.jBb=!0;else if(Lb.jBb=!1,Z.a.pG||Z.a.Zh)Lb.jBb=!0;return Lb.jBb}static la(C){Lb.NAa()&&C.ia.Va(244,new Lb(C,R.h(C).cellTextEditBox.Ha.sh))}}Lb.jBb=
null;Object(m.a)(Lb,"FocusBasedReadout",null,[563,5]);let rc=class{constructor(C,ea,Ta,Yb){Ta=void 0===Ta?C.QA:Ta;Yb=void 0===Yb?C.Yh:Yb;this.FLf=(wc,Hc)=>{this.PRd(Hc.Yf.command)};this.Dcg=()=>{if(!this.$.ea.Ee){var wc={["AriaLiveOffCount"]:this.gde,["AriaLivePoliteCount"]:this.hde,["AriaLiveAssertiveCount"]:this.fde,["AriaLiveRudeCount"]:this.ide,["ScreenReaderDivCount"]:this.Nse,["AlertScreenReaderDivCount"]:this.Nce,["AuxScreenReaderDivCount"]:this.qde,["AriaAlertCount"]:this.dde,["ReadCommandOnCompletionCount"]:this.ure,
["TotalAriaLiveRegionUpdates"]:this.uve};td.a.sendTelemetryEvent(Object(fc.a)(new th.a,{name:"Office.Excel.Online.Accessibility.AriaLiveNotifier",dataFields:Dh.a.Kl(wc)}))}};this.$=C;this.De=void 0===ea?null:ea;this.nba=document.createElement("div");this.nba.setAttribute(Yc.a.S6,Yc.a.Bn);this.nba.className=yg.a.Sid;Ta.insertBefore(this.nba,Yb);this.oca=document.createElement("div");this.oca.setAttribute(Yc.a.S6,Yc.a.Bn);this.oca.className=yg.a.Sid;Ta.insertBefore(this.oca,this.nba);this.YMg=gb.a.instance.za(2);
this.U6=document.createElement("div");this.U6.setAttribute(Yc.a.pg,Yc.a.cla);this.U6.setAttribute(Yc.a.dla,Yc.a.SKa);this.U6.className=yg.a.Sid;Ta.insertBefore(this.U6,this.oca);this.uve=this.ure=this.dde=this.qde=this.Nce=this.Nse=this.ide=this.fde=this.hde=this.gde=0;this.register();cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||this.$.ia.Va(211,this)}get ESa(){return this.YMg}get isActive(){return!0}get R2g(){return this.nba}get yNj(){return this.oca}get activeCell(){return R.h(this.$).Zd(null)}get eGb(){return cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConfirmationForFreewayScenarios",
!1)}dispose(){this.$&&this.unregister();Xf.DOMElementExtensions.xi(this.U6);Xf.DOMElementExtensions.xi(this.nba);Xf.DOMElementExtensions.xi(this.oca);this.oca=this.nba=this.U6=this.$=null}setEnabled(C){this.yeg(this.oca,C)}TSj(){this.yeg(this.nba,!0)}readText(C){this.Mgb(lg.qOa(C),!0)}aha(C){this.Mgb(lg.qOa(C),!1)}Y1f(C,ea){if(1>ea||!C)n.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var Ta=new Sys.StringBuilder;C=String.format(gb.a.instance.Qd(34),ea,C);Kf(Ta,C);Kf(Ta,
gb.a.instance.ha(857));this.Mgb(lg.qOa(Ta.toString()),!1)}}Qvj(C,ea,Ta){if(1>Ta||1>ea||ea>Ta||!C)n.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Yb=new Sys.StringBuilder;Kf(Yb,C);Yb.append(String.format(gb.a.instance.Qd(55),ea,Ta));this.Mgb(lg.qOa(Yb.toString()),!1)}}PRd(C){this.eGb||(C=this.lgi(C),this.Mgb(C,!1))}Ovj(C){this.eGb&&(C=this.kgi(C),this.Mgb(C,!1,!0))}Mgb(C,ea,Ta){Ta=void 0===Ta?!1:Ta;if(C=C?C.IDc:null)ea=ea?this.oca:this.nba,pc.a.equals(ea.innerHTML,C,!1)&&
(C+=lg.LFd),this.crg(ea,Ta),this.De.dl(ea,C)}XUa(C,ea){this.U6.getAttribute(Yc.a.dla)!==ea&&this.U6.setAttribute(Yc.a.dla,ea);C=C?lg.qOa(C).IDc:"";this.crg(this.U6);this.De.dl(this.U6,C)}Rvj(C,ea,Ta,Yb){var wc=!0;wc=void 0===wc?!1:wc;const Hc=gb.a.instance.Qd(54);n.ULS.shipAssertTag(537153949,0,!(void 0===C||null===C));n.ULS.shipAssertTag(537153948,0,!(void 0===ea||null===ea));n.ULS.shipAssertTag(537153947,0,!(void 0===Ta||null===Ta));n.ULS.shipAssertTag(537153946,0,!(void 0===Yb||null===Yb));n.ULS.shipAssertTag(537153945,
0,!(void 0===Hc||null===Hc));C=String.format(Hc,C||"",ea||"",Ta||"",Yb||"");wc?this.XUa(C,Yc.a.Awa):this.readText(C)}Hjk(C){var ea=this.oca.style;C?(C=Lg.a.g9b(C.cell,ea),ea=C.OB,ea.top=ea.left=ea.bottom=ea.right=null,C.fX()):ea.cssText=""}lgi(C){if(this.eGb)return null;switch(C){case -1985798686:return lg.kna(12);case -911352779:return lg.kna(11);case 237279923:return lg.kna(13);case -1502853784:return lg.pY(81);case -111689794:return lg.pY(78);case -287251124:return this.$qd(1333,ea=>ea.bold);case -1925065947:return this.$qd(1334,
ea=>ea.italic);case 1764140053:return this.$qd(1335,ea=>ea.underline)}return null}kgi(C){if(!this.eGb||6!==C.hh)return null;const ea=this.activeCell;if(!ea)return null;switch(C.command){case -1985798686:return lg.kna(12);case -911352779:return lg.kna(11);case 237279923:return lg.kna(13);case -1502853784:return lg.pY(81);case -111689794:return lg.pY(78);case 368460465:C=R.h(this.$).Ud.Di(ea.range,!0);if(null!==C)return this.rPa(2291,!C.hasAutoFilter,!1);C=this.$.ta.pa;if(!C)break;return this.rPa(2291,
null===C.HV,!1);case -1522760979:return this.rPa(1150,R.h(this.$).isFormulaView,!1);case 1941920197:return lg.kna(836);case 1051390410:return lg.pY(589);case 1542466017:return lg.pY(591);case -706918724:return lg.pY(590);case 369708605:return lg.pY(592);case -1215659745:return lg.pY(523);case 1783960667:return lg.pY(521);case -1355155015:return lg.pY(554);case -1158102843:return lg.pY(522);case -287251124:return C=this.apc(C.command,ea),null===C?null:this.rPa(1333,C);case -1925065947:return C=this.apc(C.command,
ea),null===C?null:this.rPa(1334,C);case 1764140053:return C=this.apc(C.command,ea),null===C?null:this.rPa(1335,C);case -1590502662:return C=this.apc(C.command,ea),null===C?null:this.rPa(1336,C);case 862890474:case 963349338:if(C=this.vza(ea),null!==C)return C=lg.qOa(String(C)),lg.mmd(214,C)}return null}register(){n.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(n.ULS.shipAssertTag(537153943,0,!!this.$.Ga,"Can't register to CommandHandlerManager's event"),
this.$.Ga&&this.$.Ga.Mka(this.FLf),this.$.ea&&this.$.ea.OD(this.Dcg))}unregister(){this.$&&(this.$.Ga.nha(this.FLf),this.$.ea.KE(this.Dcg))}yeg(C,ea){const Ta=C===this.nba;ea?(Ta&&Lb.NAa()||C.setAttribute(Yc.a.dla,Yc.a.Awa),Ta&&C.setAttribute(Yc.a.pg,Yc.a.cla),C.setAttribute(Yc.a.S6,Yc.a.mx),C.removeAttribute(Yc.a.S6),this.De.dl(C,C.innerHTML+" ")):(C.removeAttribute(Yc.a.dla),Ta&&C.removeAttribute(Yc.a.pg),C.setAttribute(Yc.a.S6,Yc.a.Bn))}$qd(C,ea){const Ta=this.activeCell;if(!Ta)return null;const Yb=
cb.EwaSettings.isChangeGateEnabled("OfficeVSO:7150857_FlipRibbonCommandStateAriaDescription"),wc=[7,8];ea=ea(Ta)?!0:!1;return lg.mmd(Yb?wc[+ea]:wc[+!ea],lg.kna(C))}crg(C,ea){ea=void 0===ea?!1:ea;switch(C.getAttribute(Yc.a.dla)){case Yc.a.TEe:++this.gde;break;case Yc.a.Awa:++this.hde;break;case Yc.a.SKa:++this.fde;break;case Yc.a.Q5g:++this.ide}switch(C){case this.yNj:++this.Nse;break;case this.R2g:++this.Nce;break;case this.U6:++this.qde}C.getAttribute(Yc.a.pg)===Yc.a.cla&&++this.dde;ea&&++this.ure;
this.uve++}rPa(C,ea,Ta){Ta=void 0===Ta?!0:Ta;return this.eGb?lg.mmd(ea?Ta?7:216:Ta?8:217,lg.kna(C)):null}apc(C,ea){return R.h(this.$).ga.Ta.isFloatingObjectSelected?this.aGi(C):this.bGi(C,ea)}aGi(C){const ea={};switch(C){case -287251124:C="QueryBold";break;case -1925065947:C="QueryItalics";break;case 1764140053:C="QueryUnderline";break;case -1590502662:C="QueryStrikethrough";break;default:return!1}const Ta=of.a(this.$);return Ta?(Ta.PPa(C,ea),ea[hh.a.On]):!1}bGi(C,ea){if(!ea)return null;var Ta=R.h(this.$);
ea=ue.a(ea);cb.EwaSettings.Xd()&&Ta.Kd&&(ea.Font=Ta.il.wza(ea.Font));Ta=ea.Font;switch(C){case -287251124:return Ta.Bold;case -1925065947:return Ta.Italic;case 1764140053:return Ta.Underline;case -1590502662:return Ta.Strikethrough}return!1}vza(C){if(!C)return null;let ea=R.h(this.$);if(ea.ga.Ta.isFloatingObjectSelected)return null;C=ue.a(C);cb.EwaSettings.Xd()&&ea.Kd&&(C.Font=ea.il.wza(C.Font));return C.Font.FontSize}};rc=Object(Oe.a)([Object(Ad.d)(Ub.g),Object(Oe.b)(0,Object(Ub.fb)()),Object(Oe.b)(1,
Object(Ub.Mb)())],rc);Object(m.a)(rc,"AriaLiveNotifier",null,[562,563,5]);class zc extends ya.a{constructor(C){super();this.$=C;this.Oe()}create(){const C=Object(ub.d)(Ad.a.resolve(Ub.Mb,{Oa:this.$a}));fd.TaskExtensions.Aa(fd.TaskExtensions.Tg([C],this.$.ma),()=>{this.ve(this.$.ia.Ja(211)||new rc(this.$,C.result,this.$.QA,this.$.Yh))},this.ma,3)}static la(C){C.ia.Va(212,new zc(C))}}Object(m.a)(zc,"AriaLiveNotifierFactory",ya.a,[]);class zd extends ya.a{constructor(C){super();this.$=C;this.Oe()}create(){Lb.NAa()?
R.h(this.$).cellTextEditBox.Ha.fT(()=>{const C=this.$.ia.Ja(244)||new Lb(this.$,R.h(this.$).cellTextEditBox.Ha.sh);this.ve(C)}):this.ve(null)}static la(C){C.ia.Va(315,new zd(C))}}Object(m.a)(zd,"FocusBasedReadoutFactory",ya.a,[]);const Wd=C=>{switch(C){case 1:return 1457;case 2:return 1458;case 3:return 1459;case 4:return 1460;case 5:return 1461;case 6:return 1462;case 7:return 1463;case 8:return 1464;case 9:return 1465;case 10:return 1466;case 11:return 1467;case 12:return 1468;case 13:return 1469;
case 14:return 1470;case 15:return 1471;case 16:return 1472;case 17:return 1473;case 18:return 1474;case 19:return 1475;case 20:return 1476;case 21:return 1477;case 22:return 1480;case 23:return 1478;case 24:return 1479;case 25:return 1481;case 26:return 1482;case 27:return 1483;case 28:return 1484;default:return 1485}};var we=a(214);class He{static get Muj(){return He.lre||(He.lre=RegExp("([A-Z]+)","g"))}static get Luj(){return He.kre||(He.kre=RegExp("([A-Z])","g"))}static get Kgh(){return He.zee||
(He.zee=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static Pqd(C){return He.Ref(C.toString())}static Ref(C){return He.Kgh.test(C)?C.replace(He.Muj,"$1 ").replace(He.Luj,' "$1"').trim():C}static uGj(C){const ea=C.lastIndexOf("!");return C.substring(0,-1<ea?ea+1:0)+He.Ref(C.substring(-1<ea?ea+1:0,C.length))}}He.lre=null;He.kre=null;He.zee=null;Object(m.a)(He,"RangeAriaExtensions",null,[]);class jf{constructor(){this.activeItemName=
null;this.Wvf=!1;this.tableName=null;this.v5a=0;this.SIc=!1}}Object(m.a)(jf,"SelectionReadoutState",null,[]);class yf{constructor(C,ea,Ta,Yb,wc){this.gridReadoutNotifier=null;this.Ggb=!1;this.Swa=this.Aub=null;this.$ga=()=>{cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?n.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):R.h(this.$).Kd&&!R.h(this.$).inRangePicker||this.l8b.Vt()};this.q4i=()=>{if(!R.h(this.$).ga.Ta.iAd){var Hc,
rd=(()=>{let ce=this.o1h();({activeCell:Hc}=ce);return ce})().returnValue;this.readText(rd,Hc)}};this.wE=()=>{const Hc=this.activeCell;this.readText("Editing",Hc);cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||Hc&&Hc.Tlc&&!R.h(this.$).qkf||this.l8b.cancel()};this.Qf=()=>{cb.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?n.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(this.$ga(),this.Ggb&&R.h(this.$).inRangePicker&&1===Ma.a.Td&&(null===this.Aub?this.Aub=le.a.instance.create(this.URd,yf.p5b,"readSelectedRanges"):this.Aub.Vt()))};this.$=ea;this.ariaLiveNotifier=C;this.zUb=Yb;this.gg=Ta;this.HG=new jf;this.NAa=Lb.NAa();this.Ggb=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.NAa&&(cb.EwaSettings.Xd()?this.gridReadoutNotifier=wc:this.gridReadoutNotifier=ea.ia.Ja(244),n.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),cb.EwaSettings.isChangeGateEnabled("OfficeVSO:7945213_removeActiveCellDelayForBraille")?yf.p5b=0:yf.p5b=700);this.l8b=le.a.instance.create(this.q4i,yf.p5b,De.a.bPj,!1);this.Zk()}get activeCell(){return R.h(this.$).Zd(null)}dispose(){this.$&&this.Hk();vd.a.Ma(this.l8b);this.zUb=this.$=this.l8b=null}Cnd(C,ea,Ta){Ta=void 0===Ta?!0:Ta;if(null!==this.$.Rd.vj&&"FindAndReplaceDialog"===this.$.Rd.vj.Pe||!C)return"";var Yb=this.$.ia;const wc=
new Sys.StringBuilder;this.A4g(wc,C,ea);if(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var Hc=this.gg.Hna(C.range);(null===Hc||void 0===Hc?0:Hc.j2d)&&this.wDe(wc,Hc);Hc=this.gg.ru(C.range);(null===Hc||void 0===Hc?0:Hc.doa)&&this.wDe(wc,Hc)}Hc=C.Q8?this.jcf(C):C.text;Kf(wc,Hc);Hc=this.$.activeItemName;this.HG.activeItemName!==Hc&&(Kf(wc,Hc),this.HG.activeItemName=Hc);Hc=1===ea.length?ab.L(ea).isSingle?"":gb.a.instance.ha(853):String.format(gb.a.instance.Qd(31),ea.length);
Kf(wc,Hc);for(var rd of ea)Hc=this.NAa?rd.toString():He.Pqd(rd),Kf(wc,Hc),1===ea.length&&yf.$Mi(rd)&&(Hc=R.h(this.$).ya.Kt(rd.bottomRight),void 0!==Hc&&null!==Hc&&Hc.text&&(Hc=Hc.Q8?this.icf(Hc,Hc.text):Hc.text,Kf(wc,Hc)));rd=C.cell;rd=this.udi(rd.iLj,rd.Ljh);Kf(wc,rd);this.l4g(wc,C);Ta&&(C.vbb?Kf(wc,gb.a.instance.ha(841)):C.pRa&&Kf(wc,gb.a.instance.ha(842)));if(C.hasAutoFilter||C.Qea)this.B4g(wc,C.hasAutoFilter?C.cell.autoFilterType:C.cell.Kmj),Ta&&Kf(wc,gb.a.instance.ha(844));we.d(this.$,C.range)&&
Kf(wc,gb.a.instance.ha(848));this.i4g(wc,C);Ta=(Ta=Yb.Ja(14))?Ta.o2h():"";Kf(wc,Ta);C.xz&&(Ta=R.h(this.$).ya.Kt(C.range),Ta=!!Ta&&Ta.hasIgnorableError,yf.pZj(C)?yf.j4g(wc,C):cb.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&Ta?Kf(wc,gb.a.instance.ha(846)):Kf(wc,gb.a.instance.ha(845)));C.gQ&&(Kf(wc,gb.a.instance.ha(847)),C.YDb&&Kf(wc,String.format(gb.a.instance.Qd(16),C.Xwh)),Kf(wc,C.iconName));C.hasRichValueIcon&&(rd=this.$.ia.Ja(271),Ta="",rd&&C.cell.rEd&&(rd=rd.RX(C.cell.rEd))&&
rd.DomainId.Id!==yf.dsk&&(Ta=rd.Name),C.cell.hCi?(Kf(wc,String.format(gb.a.instance.Qd(187),Ta)),Kf(wc,gb.a.instance.ha(1812))):(Kf(wc,String.format(gb.a.instance.Qd(185),Ta)),Kf(wc,gb.a.instance.ha(1811))));this.$qi(C)&&Kf(wc,yf.u9h(C));(Yb=Yb.Ja(231))&&Kf(wc,Yb.ycf(ea,!0));1===ea.length&&ea[0].isSingle&&yf.oZj(C,ea[0],this.$)&&(ea=this.$.ia.Ja(271))&&Kf(wc,ea.B2h());C.IVb&&C.JVb&&Kf(wc,C.JVb);(ea=C.cell.T9c)&&Kf(wc,ea);this.h4g(wc,C);C.nRa&&C.ZNb&&(C=C.rOd)&&(Kf(wc,gb.a.instance.ha(1985)),Kf(wc,
C));return wc.toString()}xIe(C){this.Swa=this.HG;this.HG=Object(fc.a)(new jf,{activeItemName:this.Swa.activeItemName,SIc:C?this.Swa.SIc:!1,tableName:C?this.Swa.tableName:"",v5a:C?this.Swa.v5a:-1})}G9f(){this.Swa&&(this.HG=this.Swa,this.Swa=null)}udi(C,ea){return 2===C||2===ea?gb.a.instance.ha(875):1===C||1===ea?gb.a.instance.ha(876):""}jcf(C){return this.icf(C.cell,C.text)}A4g(C,ea,Ta){if(Ta&&1===Ta.length&&Ta[0].isSingle){Ta="";var Yb=this.gg.Hna(ea.range);if(Yb){Ta=Yb.pivotTableName;this.O5c(C,
Ta);var wc=Yb.Noc?gb.a.instance.ha(835):"";cb.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(wc+=(Yb.altText?Yb.altText+" . ":"")+(Yb.altTextSummary?Yb.altTextSummary:""));this.yDe(C,!0,Ta,wc);Kf(C,this.gg.LKi(Yb,ea.range)?gb.a.instance.ha(838):"");Kf(C,this.gg.MDi(Yb,ea.range)?gb.a.instance.ha(837):"")}else if(Yb=this.gg.ru(ea.range)){Ta=(wc=R.h(this.$).Ud.Di(ea.range))?wc.name:"";this.O5c(C,Ta);let Hc="";wc&&(Hc=(wc.jYa?wc.jYa+" . ":"")+(wc.kYa?wc.kYa:
""));this.yDe(C,!1,Ta,Hc);Kf(C,this.gg.Ssf(Yb,ea.range)?gb.a.instance.ha(837):"")}else this.O5c(C,Ta),this.HG.tableName="",this.HG.v5a=-1}}O5c(C,ea){ea!==this.HG.tableName&&this.HG.tableName&&(C.append(gb.a.instance.ha(this.HG.SIc?834:833)),Kf(C," "+this.HG.tableName))}yDe(C,ea,Ta,Yb){Ta!==this.HG.tableName&&(C.append(gb.a.instance.ha(ea?832:831)),Kf(C," "+Ta),Kf(C,Yb),this.HG.tableName=Ta,this.HG.SIc=ea,this.HG.v5a=-1)}wDe(C,ea){const Ta=R.h(this.$).ga.ra.activeCell;if(Ta.top!==ea.top&&Ta.left!==
this.HG.v5a){C.append(gb.a.instance.ha(837));ea=new Ia.Range(ea.top,Ta.left,ea.top,Ta.left,!0,!0);Kf(C,He.Pqd(ea));if(ea=R.h(this.$).Zd(ea))ea=ea.Q8?this.jcf(ea):ea.text,Kf(C,ea);this.HG.v5a=Ta.left}}icf(C,ea){const Ta=C.JEb;return C.o$a?String.format(gb.a.instance.Qd(14),ea,Ta):String.format(gb.a.instance.Qd(13),ea,He.uGj(Ta))}Zk(){n.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var C=R.h(this.$);n.ULS.shipAssertTag(537153929,0,!!C,"Can't register to grid's events");
C&&(C.me.Yp(this.wE),C.ya.wt(this.$ga),C.tH(this.$ga),this.Ggb&&C.me.yq(this.rj.bind(this)),C=C.ga,n.ULS.shipAssertTag(537153928,0,!!C,"Can't register to selectionManager's events"),C&&(C.Kr(this.Qf),C.add_activeCellChanged(this.$ga),C.Ta.cK(this.$ga),this.Ggb&&(this.URd=this.URd.bind(this))))}}Hk(){if(this.$){var C=R.h(this.$);C&&(C.me.Qp(this.wE),C.ya.ds(this.$ga),C.XI(this.$ga),this.Ggb&&C.me.Pp(this.rj),C=C.ga)&&(C.es(this.$ga),C.remove_activeCellChanged(this.$ga),C.Ta.pR(this.$ga))}}readText(C,
ea){this.NAa&&this.gridReadoutNotifier&&(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8194559_StaleValueReadoutFixEnabled")||this.gridReadoutNotifier.isActive)?this.gridReadoutNotifier.readText(C):(this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(C),this.Ggb&&!ea||this.ariaLiveNotifier.Hjk(ea))}rj(){this.Aub&&this.Aub.cancel()}URd(){this.readText(this.Xgi())}Xgi(){let C="";R.h(this.$).ga.rangePicker.gO.forEach(()=>{C+=void 0});return C+=" selected"}o1h(){let C;C=null;var ea=R.h(this.$).ga;
if(1!==ea.eh&&!ea.Ta.Fe)return n.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${ea.eh} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:C};switch(ea.eh){case 2:return{returnValue:this.t4h(ea),activeCell:C};case 64:var Ta=ea.Ta.Fe.floatingObject;let Yb="";if(ea=ea.Ta.Fe.Tv||ea.Ta.Fe.ig)Yb=(ea=ea.firstChild)?Xf.DOMElementExtensions.getTextContent(ea):"";return{returnValue:String.format(gb.a.instance.Qd(53),yf.hic(Ta.altText,Ta.altTextDescription,
Ta.name),Yb,Ta.altTextDescription),activeCell:C};case 4:return{returnValue:yf.q3g(ea.Ta.Fe.floatingObject),activeCell:C};case 512:return{returnValue:bf.a.Haf(ea.Ta.Fe.floatingObject.Ygd),activeCell:C};case 8:return Ta=ea.Ta.Fe.floatingObject,{returnValue:String.format(gb.a.instance.Qd(51),Ta?Ta.name:""),activeCell:C};case 1:return C=this.activeCell,Ta=ea.ra.selectedRanges,R.h(this.$).inRangePicker?this.lfi(ea,C):{returnValue:this.Cnd(C,Ta),activeCell:C}}return{returnValue:"",activeCell:C}}lfi(C,ea){C=
C.rangePicker.gO.map(Yb=>Yb.range);const Ta=R.h(this.$).Zd(C[0]);return{returnValue:this.Cnd(Ta,C),activeCell:ea}}t4h(C){const ea=new Sys.StringBuilder;ea.append(yf.bgh(C));const Ta=this.$.ia.Ja(231);Ta&&Kf(ea,Ta.ycf(C.Ta.Fe.floatingObject,!1));return ea.toString()}$qi(C){C=C.Iqf();let ea=!1;this.HG.Wvf!==C&&(this.HG.Wvf=C,ea=!0);return ea}l4g(C,ea){if(ea.v$a)if(ea=this.zUb.aii(ea)){var Ta=gb.a.instance,Yb=Ta.ha;a:switch(ea.type){case 0:var wc=828;break a;case 1:wc=829;break a;default:wc=830}Ta=Yb.call(Ta,
wc);Kf(C,String.format(gb.a.instance.Qd(25),Ta));ea=String.format(gb.a.instance.Qd(24),He.Pqd(ea.W6j));Kf(C,ea)}else n.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),Kf(C,String.format(gb.a.instance.Qd(25),""))}B4g(C,ea){switch(ea){case 1:case 11:Kf(C,gb.a.instance.ha(849));break;case 6:Kf(C,gb.a.instance.ha(849));Kf(C,gb.a.instance.ha(851));break;case 7:Kf(C,gb.a.instance.ha(849));Kf(C,gb.a.instance.ha(852));break;case 2:Kf(C,gb.a.instance.ha(850));Kf(C,
gb.a.instance.ha(851));break;case 3:Kf(C,gb.a.instance.ha(850));Kf(C,gb.a.instance.ha(852));break;default:Kf(C,gb.a.instance.ha(850))}}i4g(C,ea){var Ta;const Yb=this.$.ia.Ja(65);ea=Yb?Yb.LOa(ea.range):null;let wc="";const Hc=Object(z.a)(688,ea);if(ea)wc=!ea.cbb&&Hc&&Hc.wMi?String.format(gb.a.instance.Qd(29),Hc.Hak):String.format(gb.a.instance.Qd(23),ea.author);else if(null===(Ta=null===Yb||void 0===Yb?void 0:Yb.Mp)||void 0===Ta?0:Ta.jI)wc=String.format(gb.a.instance.Qd(28),Yb.Mp.MQ.author);Kf(C,wc)}h4g(C,
ea){const Ta=this.$.ia.Ja(286);Ta&&(ea=Ta.q2h(nc.d(this.$.pa),ea.range))&&0<ea.length&&(ea=String.format(gb.a.instance.Qd(1===ea.length?220:221),ea[0]),Kf(C,ea))}static q3g(C){return String.format(gb.a.instance.Qd(52),yf.hic(C.altText,C.altTextDescription,C.name),C.altTextDescription)}static u9h(C){return gb.a.instance.ha(C.Iqf()?839:840)}static hic(C,ea,Ta){return C||ea?C:Ta}static bgh(C){var ea=C.Ta.Fe;C=ea.floatingObject;const Ta=C.Af,Yb=Ta.ChartTitle,wc=C.altText,Hc=C.altTextDescription,rd=!!(Ta.Attributes&
4);return(ea=ea.getSelectionDescription())?ea:Ta.DataRangeForDisplay?String.format(gb.a.instance.Qd(rd?49:47),yf.hic(wc,Hc,C.name),Hc,Yb,gb.a.instance.ha(Wd(Ta.ChartCategory)),Ta.DataRangeForDisplay):String.format(gb.a.instance.Qd(rd?50:48),yf.hic(wc,Hc,C.name),Hc,Yb,gb.a.instance.ha(Wd(Ta.ChartCategory)))}static pZj(C){return cb.EwaSettings.Fa(101)&&(C.sGb||C.Joc)}static j4g(C,ea){ea.RXa?ea.sGb?Kf(C,String.format(gb.a.instance.Qd(26),ea.RXa.topLeft.toString())):ea.Joc&&(ea=ea.RXa.WR(),Kf(C,String.format(gb.a.instance.Qd(27),
(ea.LastColumn-ea.FirstColumn+1).toString(),(ea.LastRow-ea.FirstRow+1).toString()))):n.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static oZj(C,ea,Ta){return C.xz||!cb.EwaSettings.Fa(131)?!1:(C=Ta.ia.Ja(271))?C.moc(ea):!1}static $Mi(C){return C.top===C.bottom&&C.left+1===C.right||C.top+1===C.bottom&&C.left===C.right}}yf.dsk=268435712;yf.p5b=500;Object(m.a)(yf,"SelectionReadoutHandler",
null,[689,5]);class pg extends ya.a{constructor(C){super();this.$=C;this.Oe()}create(){const C=this.$.ia,ea=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)?Object(ub.d)(Ad.a.resolve(Ub.g,{Oa:this.$a})):$c.GetServiceTaskFactory.je(C,211,212,this.$a),Ta=Object(ub.d)(Ad.a.resolve(Ub.pd,{Oa:this.$a})),Yb=Object(ub.d)(Ad.a.resolve(Ub.md,{Oa:this.$a}));let wc=Tc.Task.Ua(null);cb.EwaSettings.Xd()&&(wc=$c.GetServiceTaskFactory.je(C,244,315,this.$a));fd.TaskExtensions.Aa(fd.TaskExtensions.Tg([ea,
Ta,Yb,wc],this.ma),()=>{const Hc=Object(d.a)(this.$.ia,226,()=>new yf(ea.result,this.$,Ta.result,Yb.result,wc.result));this.ve(Hc)},this.$.ma,3)}static la(C){C.ia.Va(227,new pg(C))}}Object(m.a)(pg,"SelectionReadoutHandlerFactory",ya.a,[]);let gg=class extends Kb.a{constructor(C){super();cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightBehaviorEventManager",!1)||C.ia.Va(376,this)}q1g(C){this.addHandler("TAF",C)}uFj(C){this.removeHandler("TAF",C)}Itj(){this.raiseEvent("TAF")}};
gg=Object(Oe.a)([Object(Ad.d)(Ub.Gb),Object(Oe.b)(0,Object(Ub.fb)())],gg);Object(m.a)(gg,"GridHighlightBehaviorEventManager",Kb.a,[565,5]);class Xg extends ya.a{constructor(C){super();this.$=C;this.Oe()}create(){this.ve(this.$.ia.Ja(376)||new gg(this.$))}static la(C){C.ia.Va(377,new Xg(C))}}Object(m.a)(Xg,"GridHighlightBehaviorEventManagerFactory",ya.a,[]);var aa=a(82),Va=a(251),hc=a(175),Bc=a(129);class Td extends Sys.EventArgs{constructor(C,ea){super();this.start=C;this.Y$a=ea}}Object(m.a)(Td,"MarqueeResizeStartedOrEndedEventArgs",
Sys.EventArgs,[]);class V extends Kb.a{constructor(C){super();this.juc=[3];this.xua=void 0;this.gridView=C;this.Fsg=kc.a.pE();this.vQ=kc.a.pE()}get coloredReferencesManager(){const C=this.gridView.$.ia.Ja(281);C||n.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return C}get vy(){if(this.xua)return this.xua;
const C=this.gridView.$.ia.Ja(464);C||n.ULS.sendTraceTag(510255179,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");C.vy||n.ULS.sendTraceTag(510255178,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.xua=C.vy}Q_g(C){this.addHandler("mrek",C)}PZ(C,ea,Ta){for(const Yb of this.gridView.Rq)Va.a.instance.va(Jc.a.Io,
Yb.domElement,C);Va.a.instance.va(Jc.a.tj,document.documentElement,ea);this.gridView.cellTextEditBox.Uec(!0);Ta&&Va.a.instance.va(Jc.a.CE,this.gridView.Qn,ea)}i8d(C,ea,Ta){for(const Yb of this.gridView.Rq)Va.a.instance.Ca(Jc.a.Io,Yb.domElement,C);Va.a.instance.Ca(Jc.a.tj,document.documentElement,ea);this.gridView.cellTextEditBox.Uec(!1);Ta&&Va.a.instance.Ca(Jc.a.CE,this.gridView.Qn,ea)}Vyj(C,ea){for(const Ta of this.gridView.Rq)hc.a.instance.va(Jc.a.wj,Ta.domElement,C);hc.a.instance.va(Jc.a.Wg,document.documentElement,
ea)}Fik(C,ea){for(const Ta of this.gridView.Rq)hc.a.instance.Ca(Jc.a.wj,Ta.domElement,C);hc.a.instance.Ca(Jc.a.Wg,document.documentElement,ea)}OQe(C,ea,Ta,Yb){const wc=document.createElement("div");wc.className=ea;for(const Hc of Ta)wc.classList.add(Hc);C.appendChild(wc);Va.a.instance.va(Jc.a.Cf,wc,Yb);return wc}Off(C){C=C.Be.parentNode;if(!C)return n.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;C=parseInt(C.getAttribute(Yc.a.Y$a),
10);return isNaN(C)?(n.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.ee.JK(3,1,C)}VSb(C,ea,Ta){C=(void 0===Ta?!0:Ta)&&(this.vQ?!!this.vy&&this.vy.aIi(C):!!this.coloredReferencesManager&&this.coloredReferencesManager.$Hi(C));for(const Yb of ea)Xf.DOMElementExtensions.setVisible(Yb,C)}jic(){return this.gridView.Ls?Bc.a(this.gridView.$):this.gridView.me}m2f(){if(this.vQ){var C=this.jic();
C&&this.vy?this.Fsg?C.UG(null):this.vy.Ykb(C,null):(n.ULS.sendTraceTag(510255177,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.ee.cn(this.juc),this.gridView.ee.Yn(null,this.juc))}else this.wwj()}wwj(){const C=this.jic();C&&this.coloredReferencesManager?this.Fsg?C.UG(null):this.coloredReferencesManager.UG(C,null):(n.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),
this.gridView.ee.cn(this.juc),this.gridView.ee.Yn(null,this.juc))}F0f(C,ea){this.raiseEvent("mrek",new Td(C,ea))}}Object(m.a)(V,"BehaviorHelperMethods",Kb.a,[]);var bb=a(100);class gc extends bb.a{constructor(C,ea){super(C,void 0===ea?null:ea)}m3a(){}}Object(m.a)(gc,"HighlightFlyweightBehavior",bb.a,[]);var xc=a(18),Gd=a(433),pe=a(128),Ne=a(235),We=a(250),pf=a(68);class Af extends We.a{constructor(C,ea,Ta){super(document.createElement("div"));this.vcc=null;this.tXb=!1;this.onPointerDown=Yb=>{Yb=Y.a(this.$)?
Y.a(this.$).Xg(Yb):Yb;this.tXb=!1;if(3===(Ma.a.Td=Yb.de)){const wc=Yb.Da.rawEvent,Hc=wc.srcElement||wc.target;Xf.DOMElementExtensions.Sj(this.domElement,Hc)&&Xf.DOMElementExtensions.Sj(wc.currentTarget,Hc)&&(this.tXb=!0,this.vcc=Yb.clientPoint)}return!1};this.Mj=Yb=>{Yb=Y.a(this.$)?Y.a(this.$).Xg(Yb):Yb;this.raiseEvent("GrPointerUp",Yb);return this.tXb=!1};this.fm=Yb=>{Yb=Y.a(this.$)?Y.a(this.$).Xg(Yb):Yb;3===Yb.de&&this.tXb&&this.mri(Yb.clientPoint)&&(this.raiseEvent("GrDrag"),this.tXb=!1);return!1};
this.Of=Yb=>{Y.a(this.$)&&Y.a(this.$).Xg(Yb);return!0};this.$=Ta;this.domElement.classList.add(pf.a.e3e);this.domElement.classList.add(pf.a.bgc);C.appendChild(this.domElement);Xf.DOMElementExtensions.setVisible(this.domElement,!1);this.MPa=document.createElement("div");this.MPa.classList.add(pf.a.agc);this.MPa.style.borderColor=ea;this.domElement.appendChild(this.MPa);Va.a.instance.va(Jc.a.Cf,this.domElement,this.onPointerDown);Va.a.instance.va(Jc.a.tj,this.domElement,this.Mj);hc.a.instance.va(Jc.a.Wg,
this.domElement,this.Mj);Va.a.instance.va(Jc.a.Io,this.domElement,this.fm);hc.a.instance.va(Jc.a.wj,this.domElement,this.fm);Ne.a.instance.va(Jc.a.click,this.domElement,this.Of)}uAe(C){this.addHandler("GrDrag",C)}d6f(C){this.removeHandler("GrDrag",C)}tAe(C){this.addHandler("GrContxt",C)}c6f(C){this.removeHandler("GrContxt",C)}vAe(C){this.addHandler("GrPointerUp",C)}e6f(C){this.removeHandler("GrPointerUp",C)}dispose(){Rh.a.VDa(this.domElement);super.dispose()}Gdg(){this.domElement.classList.remove(pf.a.bgc);
this.MPa.classList.remove(pf.a.agc);this.MPa.classList.add(cb.EwaSettings.xQ?pf.a.g3e:pf.a.f3e)}Qtg(){this.MPa.classList.remove(cb.EwaSettings.xQ?pf.a.g3e:pf.a.f3e);this.MPa.classList.add(pf.a.agc);this.domElement.classList.add(pf.a.bgc)}mri(C){return!!this.vcc&&(3<Math.abs(C.x-this.vcc.x)||3<Math.abs(C.y-this.vcc.y))}static $Bb(C){C=Y.a(C.$)?Y.a(C.$).zoom:Tb.a.N3;return Math.round(9/Math.max(C,1))}}Af.OGd=0;Object(m.a)(Af,"TouchGrippie",We.a,[]);class xg extends gc{constructor(C,ea,Ta,Yb){super(ea);
this.$Bd=this.lub=!1;this.t9b=null;this.sfa=this.WBd=!1;this.Nz=()=>{this.lub&&this.WBd?this.nsa():this.U8()};this.GOf=Hc=>{3===Hc.de&&(this.WBd=!0,this.nsa());return!1};this.HOf=Hc=>{if(3===Hc.de){if(!Hc.Be||this.pFi(Hc))return!1;this.WBd=!1;this.U8()}return!1};this.fi=()=>{this.sfa&&this.m8d();this.nsa();this.$Bd=!1};this.Ev=()=>{this.U8();this.$Bd=!0};this.YCa=(Hc,rd)=>{rd.X8===this.X8&&(rd.visible?this.$Bd||this.nsa():this.U8())};this.vUf=()=>{this.IOf(this.QV.domElement,!1)};this.LKf=()=>{this.IOf(this.aT.domElement,
!0)};this.Owc=(Hc,rd)=>{this.ga.Vqa(rd)};this.Pwc=(Hc,rd)=>{this.ga.Vqa(Gd.b(rd))};this.AMb=()=>{3===Ma.a.Td?this.nsa():this.U8();this.sfa&&1===Ma.a.Td&&this.m8d()};this.wUf=()=>{this.BRj()};this.XXe=()=>{this.U8()};this.oq=()=>{this.ga.Ta.Fe&&this.U8()};this.xKf=()=>{this.U8()};this.zOf=(Hc,rd)=>{this.m8d();3===rd.de?this.nsa():this.U8()};this.xAc=()=>{this.lub&&(this.U8(),this.nsa())};const wc=Ta.$;this.dw=Ta;this.ga=Ta.ga;this.SK=C;this.WOj=ea;this.paneType=Yb;C=this.domElement.currentStyle;ea=
"#000000";C&&(ea=C.borderTopColor);this.QV=new Af(this.K5e(),ea,wc);this.aT=new Af(this.K5e(),ea,wc);this.QV.uAe(this.vUf);this.QV.tAe(this.Owc);this.QV.vAe(this.Pwc);this.aT.uAe(this.LKf);this.aT.tAe(this.Owc);this.aT.vAe(this.Pwc);for(const Hc of this.gridView.Rq)hc.a.instance.va(Jc.a.ji,Hc.domElement,this.HOf),hc.a.instance.va(Jc.a.Wg,Hc.domElement,this.GOf);Ta.view.fu(this.Nz);Ta.me.Yp(this.XXe);Ta.ee.xtb(this.YCa);Ta.p6b(this.xKf);wc.cC(this.xAc);Ta.$u(this.xAc);this.ga.Ska(this.fi);this.ga.Tka(this.Ev);
Ta.tH(this.oq);this.ga.u6b(this.zOf);Ma.a.CAe(this.AMb);fd.TaskExtensions.Aa(cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightBehaviorEventManager",!1)?Object(ub.d)(Ad.a.resolve(Ub.Gb,{Oa:0})):$c.GetServiceTaskFactory.je(wc.ia,376,377,0),Hc=>{Hc.result.q1g(this.wUf)},wc.ma,3)}get gridView(){return this.dw}dispose(){vd.a.df([this.QV,this.aT]);this.QV.d6f(this.vUf);this.QV.c6f(this.Owc);this.QV.e6f(this.Pwc);this.aT.d6f(this.LKf);this.aT.c6f(this.Owc);this.aT.e6f(this.Pwc);
for(var C of this.gridView.Rq)hc.a.instance.Ca(Jc.a.ji,C.domElement,this.HOf),hc.a.instance.Ca(Jc.a.Wg,C.domElement,this.GOf);this.gridView.view.Vs(this.Nz);this.gridView.me.Qp(this.XXe);this.gridView.ee.nQb(this.YCa);this.gridView.LBc(this.xKf);this.gridView.$.JE(this.xAc);this.gridView.Vx(this.xAc);this.ga.aaa(this.fi);this.ga.pha(this.Ev);this.gridView.XI(this.oq);this.ga.RBc(this.zOf);Ma.a.k6f(this.AMb);this.sfa&&n.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");
(C=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightBehaviorEventManager",!1)?Ad.a.rg(Ub.Gb):this.gridView.$.ia.Ja(376))&&C.uFj(this.wUf);super.dispose()}oXa(){if(!this.SK.range||!this.SK.range.equals(this.sib))return!1;const C=!this.gridView.oRa();return this.gridView.Kd&&C&&(this.sib.isRow||this.sib.Wi)?!1:this.sfa?!0:3===Ma.a.Td}U8(){this.lub&&(this.QV.set_visible(!1),this.aT.set_visible(!1),this.lub=!1)}nsa(){if(this.oXa()){var C=Xf.DOMElementExtensions.getBoundingClientRect(this.t9b);
C||n.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. GridView.ContainerElement: {0}, Freezepanes: {1}",this.gridView.Qn,this.gridView.Gd.Xk);var ea=Xf.DOMElementExtensions.getBoundingClientRect(this.WOj),Ta=new Sys.UI.Bounds(ea.x-C.x,ea.y-C.y,ea.width,ea.height),Yb=this.sib,wc=Yb.topLeft,Hc=Yb.bottomRight,rd=Yb.isRow||Yb.Wi;if(Yb.Wi){var ce=this.sVh();Yb=Ta.x-2*Af.$Bb(this.gridView);var Le=ce;var Ue=Ta.x+ea.width}else Yb.isRow?(Yb=Ue=this.rVh(),Le=Ta.y-2*Af.$Bb(this.gridView),ce=Ta.y+
ea.height):(Le=Ta.y,ce=Ta.y+ea.height,this.gridView.rtl?(Yb=Ta.x+ea.width,Ue=Ta.x):(Yb=Ta.x,Ue=Ta.x+ea.width));ea=Af.OGd+(rd?0:Af.$Bb(this.gridView));this.QV.style.left=qe.HelperMethods.yf(Yb-ea);this.QV.style.top=qe.HelperMethods.yf(Le-ea);this.aT.style.left=qe.HelperMethods.yf(Ue-ea);this.aT.style.top=qe.HelperMethods.yf(ce-ea);this.QV.set_visible(this.Rsf(Le,Yb,wc,rd,C));this.aT.set_visible(this.Rsf(ce,Ue,Hc,rd,C));this.lub=!0}}Rsf(C,ea,Ta,Yb,wc){const Hc=Xf.DOMElementExtensions.getBoundingClientRect(this.gridView.mi(this.paneType).domElement);
wc=new Sys.UI.Bounds(Hc.x-wc.x-3,Hc.y-wc.y-3,Hc.width+6,Hc.height+6);return(this.gridView.Gd.xk(Ta)===this.paneType||Yb)&&uc.a.RY(wc,new Sys.UI.Point(ea,C))}sVh(){return(this.gridView.view.visibleArea.height+this.gridView.Gd.height+Af.OGd-Af.$Bb(this.gridView))/2}rVh(){return(this.gridView.view.visibleArea.width+this.gridView.Gd.width+Af.OGd-Af.$Bb(this.gridView))/2}CSf(){this.nsa()}pFi(C){return Xf.DOMElementExtensions.hib(C.Be,xc.a.bB)&&(this.JGi(C)||this.KGi(C))}KGi(C){if(this.gridView.rtl)C=C.clientPoint.x;
else{const ea=Xf.DOMElementExtensions.getBoundingClientRect(C.Be);C=C.clientPoint.x-(ea.x+ea.width-pe.a.Ly)}return 0<C&&C<=pe.a.Ly}JGi(C){const ea=Xf.DOMElementExtensions.getBoundingClientRect(C.Be);C=C.clientPoint.y-(ea.y+ea.height-pe.a.Ly);return 0<C&&C<=pe.a.Ly}IOf(C,ea){this.sfa&&n.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ga.y9c(C,ea,this.sfa);this.U8()}BRj(){this.sfa||(n.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),
this.sfa=!0,this.QV.Gdg(),this.aT.Gdg(),this.gridView.ga.sourceRange=this.gridView.ga.ra.Ef,this.nsa())}m8d(){this.sfa&&(n.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.sfa=!1,this.QV.Qtg(),this.aT.Qtg())}K5e(){this.t9b||(this.t9b=this.gridView.Qn);return this.t9b}}Object(m.a)(xg,"SelectionTouchGrippiesBehaviorBase",gc,[]);class lh extends xg{constructor(C,ea,Ta,Yb){super(C,ea,Ta,Yb)}get X8(){return 19}get sib(){return this.gridView.ga.ra.activeRange}oXa(){const C=
this.gridView.Al||this.gridView.Kd;return!this.gridView.ga.ra.Zj&&!C&&super.oXa()}}Object(m.a)(lh,"DiscontinuousSelectionTouchGrippiesBehavior",xg,[]);class ng extends gc{constructor(C){super(C);const ea=document.createElement("div");ea.className=pf.a.wQh;C.appendChild(ea)}}Object(m.a)(ng,"SelectionBorderBehavior",gc,[]);class sg{}sg.o3e="ewr-selection-draghandle-grab";sg.pQh="ewr-selection-draghandle-top-enhanced";sg.mQh="ewr-selection-draghandle-bottom-enhanced";sg.nQh="ewr-selection-draghandle-left-enhanced";
sg.oQh="ewr-selection-draghandle-right-enhanced";sg.qQh="ewr-selection-dragtooltip-updated";sg.p3e="ewr-selection-draghandle-reduced";sg.FQh="ewr_selection_rearrangeleft";sg.GQh="ewr_selection_rearrangeright";sg.HQh="ewr_selection_rearrangetop";sg.EQh="ewr_selection_rearrangebottom";sg.selecting="selecting";sg.IQh="ewr-selection-resizemarqueehandle";sg.LQh="ewr-selection-resizemarqueehandle-topleft";sg.MQh="ewr-selection-resizemarqueehandle-topright";sg.JQh="ewr-selection-resizemarqueehandle-bottomleft";
sg.KQh="ewr-selection-resizemarqueehandle-bottomright";sg.cQh="ewr-marquee-thick";sg.gQh="ewr-resizemarqueehandle-thick";Object(m.a)(sg,"CssClassNames",null,[]);var fh=a(263);class Ig extends ng{constructor(C,ea,Ta,Yb){super(C);this.YXa=!1;this.sxe=this.txe=null;this.I$d=this.Lud=this.r7=this.Aca=0;this.EZ=this.fe=this.sourceRange=this.Qqa=null;this.Mj=wc=>{wc=Y.a(this.$).Xg(wc);return this.pRf(wc)};this.onPointerDown=wc=>{wc=Y.a(this.$).Xg(wc);if(!this.DGc())return!1;if(2===wc.de&&wc.Oq===Sys.UI.MouseButton.leftButton&&
!this.YXa){var Hc=this.krd(wc);if(!Hc)return n.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.fe=Hc.clone();this.sourceRange=this.fe.clone();this.Qqa=this.fe;if(Hc=this.Sbi(wc))return this.hr=5,this.I$d=Hc.top-this.sourceRange.top,this.Lud=Hc.left-this.sourceRange.left,R.h(this.$).Xj.Fu(Ig.vzb),this.aMd(wc),this.YXa=!0,fh.b(this.$,!0),!0}return!1};this.fm=wc=>{wc=Y.a(this.$).Xg(wc);if(this.bMd(wc))return!0;if(wc=this.ga.Us(wc.clientPoint,
wc.Be,5,void 0,void 0,!0)){wc=this.Kvb(wc);if(this.fe.equals(wc))return!0;this.fe=wc;if(!this.D_())return n.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.ugc(!0),!1}return!0};this.fg=(wc,Hc)=>{Hc.zQ||this.jFc(this.$.isEditMode)};this.WH=[];this.$=ea;this.ga=R.h(this.$).ga;this.paneType=Ta;this.Mr=Yb;this.ucg=[sg.pQh,sg.mQh,sg.nQh,sg.oQh];this.$.zn(this.fg)}get ee(){return R.h(this.$).ee}get hr(){return this.ga.selectionType}set hr(C){this.ga.selectionType=
C}dispose(){this.WH.forEach(C=>{Va.a.instance.Ca(Jc.a.Cf,C,this.onPointerDown)});this.WH.length=0;this.Qqa=this.sourceRange=this.fe=null;n.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.Aca}, EwaControl is null : ${!this.$}`);this.$&&(this.$.uo(this.fg),1===this.Aca&&(n.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.mT(this.sxe,this.txe,!1)));super.dispose()}pRf(C){if(5!==
this.hr)return!1;(C=this.HTa(C))||this.ugc(!1);fh.b(this.$,!1);return C}PZ(C,ea){n.ULS.shipAssertTag(537159377,0,!this.Aca,`DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected but got ${this.Aca}`);this.Aca+=1;this.sxe=C;this.txe=ea;this.Mr.PZ(C,ea,this.j7d())}Kvb(C){if(!C||!this.fe)return n.ULS.shipAssertTag(537159376,0,!!C,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),n.ULS.shipAssertTag(537159375,0,!!this.fe,
"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const ea=this.fe.clone();1!==this.r7&&(ea.left=Math.max(C.left-this.Lud,1),ea.right=ea.left+this.sourceRange.width-1);2!==this.r7&&(ea.top=Math.max(C.top-this.I$d,1),ea.bottom=ea.top+this.sourceRange.height-1);return this.Itb(ea)}mT(C,ea,Ta,Yb){Ta=void 0===Ta?!0:Ta;Yb=void 0===Yb?!0:Yb;n.ULS.shipAssertTag(537159374,0,1===this.Aca,`DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration but got ${this.Aca}`);
--this.Aca;this.Mr.i8d(C,ea,this.j7d());Ta&&this.DLe(Yb);this.r7=0;this.YXa=!1}Itb(C){var ea=R.h(this.$);let Ta=C;if(ea.Gd.iQ){if(!ea.Zd(C.topLeft)){ea=ea.Lm("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ea.YT,this.Qqa.top!==C.top?1:2);try{ea.an=this.Qqa.top<C.top||this.Qqa.left<C.left,ea.Gy(C.topLeft),Ta=ea.$$cu().range}finally{ea&&ea.dispose()}}Ta.right=Math.min(Ta.left+C.width-1,Tb.a.Ah);Ta.bottom=Math.min(Ta.top+C.height-1,Tb.a.Bh)}return this.Qqa=Ta}jFc(C){this.WH.forEach(ea=>{Xf.DOMElementExtensions.setVisible(ea,
C)})}Sbi(C){const ea=C.Be;C=C.clientPoint;if(!ea||!C)return n.ULS.shipAssertTag(537159373,0,!!ea,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),n.ULS.shipAssertTag(537159372,0,!!C,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;C.y+=ea===this.WH[Ig.Jgd]?2:ea===this.WH[Ig.vXe]?-2:0;C.x+=ea===this.WH[Ig.wXe]?2:ea===this.WH[Ig.Igd]?-2:0;return this.ga.Us(C,ea,5,void 0,void 0,!0)}}Ig.IPe="copy";Ig.vzb="grabbing";Ig.Jgd=0;Ig.vXe=1;Ig.wXe=2;Ig.Igd=
3;Object(m.a)(Ig,"DragSelectionClickBehaviorBase",ng,[]);class Uf extends Ig{constructor(C,ea,Ta,Yb,wc,Hc){super(C,ea,Ta,wc);this.gf=this.ZI=null;this.yjf=()=>{this.ugc(!0)};for(const rd of this.ucg)ea=this.Mr.OQe(C,rd,[sg.o3e],this.onPointerDown),this.WH.push(ea);this.jFc(this.$.isEditMode);this.gridView=R.h(this.$);this.CI=Yb;this.coloredReferencesManager=this.$.ia.Ja(281);n.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
if(this.vQ=kc.a.pE())C=this.$.ia.Ja(464),n.ULS.shipAssertTag(512312961,0,!!C,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.vy=C.vy;for(const rd of this.WH)Va.a.instance.va(Jc.a.FZ,rd,this.CI.Imf),Va.a.instance.va(Jc.a.CE,rd,this.CI.Jmf);this.m3a(Hc)}m3a(C){this.Mr.VSb(C,this.WH);this.CI.sR()}aMd(C){n.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");
this.gridView.pQa=!0;this.gf.AH(!1);this.hr=5;this.CI.yXe(C.Be);this.gf.Ha.removeSelection();this.gf.D6b(this.yjf);this.PZ(this.fm,this.Mj);this.r7=this.sourceRange.isRow?1:this.sourceRange.Wi?2:0}HTa(){const C=this.i_();this.hr=-1;this.mT(this.fm,this.Mj);return C}DLe(){this.gridView.pQa=!1;this.CI.zXe(this.WH[0]);this.gf.Ha.setCaretPositionToEnd();this.gf.aCc(this.yjf);this.Mr.m2f()}ugc(C){n.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");
C&&this.mT(this.fm,this.Mj)}krd(C){this.gf=this.Mr.jic();this.ZI=this.Mr.Off(C);return this.gf&&this.ZI&&this.ZI.range?this.ZI.range:(n.ULS.shipAssertTag(537159388,0,!!this.gf,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),n.ULS.shipAssertTag(537159387,0,!!this.ZI,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),n.ULS.shipAssertTag(537159386,0,!!this.ZI.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}i_(){return this.ZI?
this.vQ?this.vy.WKb(this.gf,this.ZI,this.fe):this.coloredReferencesManager.WKb(this.gf,this.ZI,this.fe):(n.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)}D_(){return this.i_()}j7d(){return!0}bMd(){return!1}DGc(){return!0}}Object(m.a)(Uf,"DragMarqueeClickBehavior",Ig,[]);var Di=a(92),Ei=a(353),Xi=a(753),Ki=a(237),Pi=a(46),lj=a(339);class uh extends Ig{constructor(C,
ea,Ta,Yb,wc){super(C,ea,Ta,wc);this.Dk=null;this.Wi=this.isRow=!1;this.fi=()=>{this.domElement.classList.remove(sg.selecting);if(uh.Cxj&&this.ga.ra.FU){const Hc=this.Zd(this.ga.ra.Ef);null!==Hc&&(Hc.hasAutoFilter?this.domElement.classList.add(sg.p3e):this.domElement.classList.remove(sg.p3e))}};this.Ev=()=>{this.domElement.classList.add(sg.selecting)};this.Qf=()=>{if(this.$.isEditMode){const Hc=this.DGc();this.jFc(Hc)}};this.gg=Yb;this.gridView=R.h(this.$);this.syd=!1;if(0===uh.cec[Ta].length)for(const Hc of this.ucg)ea=
document.createElement("div"),ea.className=Hc,ea.classList.add(sg.o3e),uh.cec[Ta].push(ea);for(const Hc of uh.cec[Ta])C.appendChild(Hc),Va.a.instance.va(Jc.a.Cf,Hc,this.onPointerDown),this.WH.push(Hc);this.jFc(this.$.isEditMode);this.dt={};this.gridView.tQ=!1;this.ga.Tka(this.Ev);this.ga.Ska(this.fi)}dispose(){this.ga&&(this.ga.pha(this.Ev),this.ga.aaa(this.fi));if(this.dt)for(var C=1;4>=C;C++)Xf.DOMElementExtensions.xi(this.dt[C.toString()]);for(C=1;4>=C;C++)uh.cec[C].length=0;this.dt=this.Dk=null;
super.dispose()}DLe(C){C&&(R.h(this.$).Xj.Fu(Yc.a.H2),ac.KeyInputManager.instance.Ca(Jc.a.Ne,this.domElement.ownerDocument.body,this.onKeyDown),this.gridView.tQ=!1);for(C=1;4>=C;C++){const ea=this.dt[C.toString()];ea&&ea.parentNode.removeChild(ea);this.dt[C.toString()]=null}this.Dk=null}krd(){return this.ga.ra.Ef}i_(){this.ga.updateSelection(this.fe,this.fe.topLeft,0);return!0}D_(C){C=void 0===C?!1:C;this.ee.Yn(this.fe,uh.hya);this.ee.Iu(uh.hya);this.fJ(C);return!0}eta(C){C=void 0===C?!1:C;this.ee.Yn(this.fe,
this.Dk);this.ee.Iu(this.Dk);this.fJ(C)}Zd(C){return(C=this.gridView.ya.Kt(C))?new lj.a(C,this.gridView):null}ugc(){n.ULS.sendTraceTag(508908561,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}j7d(){return!1}Zra(C,ea,Ta,Yb){Yb=void 0===Yb?!1:Yb;var wc=Xf.DOMElementExtensions.getBoundingClientRect(ea);let Hc=ea===this.WH[Ig.Jgd]||ea===this.WH[Ig.vXe];var rd=ea===this.WH[Ig.wXe]||ea===this.WH[Ig.Igd];this.isRow&&rd||this.Wi&&Hc?rd="100px":
(Hc=this.isRow||Hc,rd=(Hc?Yb?uh.Ndk:uh.Qdk:Yb?uh.Mdk:uh.Odk)+"px");ea=Hc?ea===this.WH[Ig.Jgd]?"top":"bottom":ea===this.WH[Ig.Igd]?"right":"left";C=100*(Hc?C.x-wc.x:C.y-wc.y)/(Hc?wc.width:wc.height);for(wc=1;4>=wc;wc++){var ce=document.createElement("div"),Le=document.createElement("div");const Ue=document.createElement("div");ce.appendChild(Le);ce.appendChild(Ue);Yb&&(Le=document.createElement("div"),ce.appendChild(Le),Ue.style.fontWeight="bold");ce.className=sg.qQh;this.dt[wc.toString()]=ce;this.ee.JK(Ta,
wc).zh.appendChild(ce);if(ce=this.dt[wc.toString()])ce.style[ea]=rd,ce.style[Hc?"left":"top"]=C+"%"}}Cvg(C,ea,Ta){const Yb=R.h(this.$),wc=Yb.hj(C);var Hc=Yb.mi(this.paneType);Ta=Xi.a.gA(Hc.view.ql,this.domElement.parentNode,Ta,Yb.rtl);Hc=!1;let rd=2;ea&&Ta.y-wc.topLeft.y>wc.height/2?(Hc=!0,rd=1):!ea&&Ta.x-wc.topLeft.x>wc.width/2&&(Hc=!0);if(Hc){ea=Yb.Lm("DragSelectionClickBehavior.updateMouseSelectionRange",Yb.YT,rd);try{ea.Gy(C),ea.$$mn(),ea.$$cu()}finally{ea&&ea.dispose()}}}nwb(C){this.ee.cn(this.Dk);
this.mT(this.FTa,this.ITa,void 0,C)}rX(C){this.ee.cn(uh.hya);this.mT(this.fm,this.Mj,void 0,C)}Bw(){return uh.hya}Dab(C){return C.Da.keyCode===Di.a.lZa||Z.a.isMac&&C.Da.keyCode===Di.a.XWb}DFb(C){C=R.h(this.$).getRangeInformation(C);for(let ea=0,Ta=C.length;ea<Ta;++ea)if(Object(Ei.a)(Ki.PivotTableRange,C[ea]))return C=te.a.Mf(1,0,902,901,0,2105176604,"InsDelCellsPivotTable"),Pi.a(this.$).Vw([C]),!0;return!1}Tye(){this.syd||(this.ga.eBe(this.BMd),this.syd=!0)}vVa(){this.ga&&(this.ga.A6f(this.BMd),this.syd=
!1)}}uh.Odk=-85;uh.Qdk=-40;uh.Mdk=-120;uh.Ndk=-50;uh.hya=[48];uh.cec=[[],[],[],[],[],[]];uh.Cxj=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8196440_ReduceDragAreaIfAutoFilter");Object(m.a)(uh,"DragSelectionClickBehavior",Ig,[]);class ej{constructor(C,ea){this.destinationRange=this.sourceRange=null;this.sourceRange=C;this.destinationRange=ea}}Object(m.a)(ej,"MacroRecorderTableRowColumnRearrangedPayload",null,[129]);class ki extends uh{constructor(C,ea,Ta,Yb,wc){super(C,ea,Ta,Yb,wc);this.aia=null;
this.Az=this.JU=!1;this.yyf=0;this.jXa=this.nNa=null;this.vK=0;this.yec=gb.a.instance.ha(2269);this.AXe=gb.a.instance.ha(2270);this.fGc=gb.a.instance.ha(2271);this.Fhg=gb.a.instance.ha(2272);this.onKeyDown=Hc=>this.Dab(Hc)||Hc.Da.keyCode===Di.a.nZa?(this.gRa||(ac.KeyInputManager.instance.va(Jc.a.tg,this.domElement.ownerDocument.body,this.onKeyUp),this.gRa=!0),!this.pfa&&this.Dab(Hc)&&(R.h(this.$).Xj.Fu(Ig.IPe),this.pfa=!0),this.JY||Hc.Da.keyCode!==Di.a.nZa||(R.h(this.$).Xj.Fu(Ig.vzb),this.JY=!0,2===
this.vK?(n.ULS.shipAssertTag(509159443,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),n.ULS.sendTraceTag(509150300,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rX(!1),this.r7=0,this.Dk=this.Az?[11]:[12],this.JU=this.Az,this.PSd(),n.ULS.shipAssertTag(509159442,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.eta()):3===this.vK?(n.ULS.shipAssertTag(509159441,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
n.ULS.sendTraceTag(509150299,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.mwb(!1),this.r7=this.isRow?1:2,this.bra(),n.ULS.shipAssertTag(509159440,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.D_()):1===this.vK&&(n.ULS.shipAssertTag(509159439,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),n.ULS.sendTraceTag(509150298,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),
this.nwb(!1),this.bra(),n.ULS.shipAssertTag(509159438,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.D_())),!0):!1;this.onKeyUp=Hc=>this.Dab(Hc)||Hc.Da.keyCode===Di.a.nZa?(this.yyf=this.Dab(Hc)?0:1,this.gridView.tQ&&R.h(this.$).Xj.Fu(Ig.vzb),Hc.Da.keyCode===Di.a.nZa&&(2===this.vK?(n.ULS.shipAssertTag(509159437,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),n.ULS.sendTraceTag(509150297,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),
this.mwb(!1),this.r7=0,this.bra(!0),n.ULS.shipAssertTag(509159436,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.D_(!0)):3===this.vK?(n.ULS.shipAssertTag(509159435,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),n.ULS.sendTraceTag(509150296,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rX(!1),this.r7=this.isRow?1:2,this.Dk=this.isRow?[11]:[12],this.PSd(!0),n.ULS.shipAssertTag(509159434,
0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.eta(!0)):1===this.vK&&(n.ULS.shipAssertTag(509159433,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),n.ULS.sendTraceTag(509150295,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rX(!1),this.Dk=this.Az?[11]:[12],this.yPb(!0),n.ULS.shipAssertTag(509159432,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),
this.eta(!0))),this.dWb(this.yyf),!0):!1;this.ITa=Hc=>{Hc=Y.a(this.$).Xg(Hc);this.vVa();5===this.hr?this.pRf(Hc):(this.gridView.tQ=!1,n.ULS.shipAssertTag(509159430,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.ee.cn(this.Dk),!this.$.fv([this.fe],!1)||this.uwj()||this.luf()||(this.ga.sourceRange=this.sourceRange.clone(),this.urj(),this.Az?this.fe.top>this.sourceRange.top&&(Hc=this.fe.height,this.fe.top-=Hc,this.fe.bottom-=Hc):this.fe.left>this.sourceRange.left&&
(Hc=this.fe.width,this.fe.left-=Hc,this.fe.right-=Hc),this.i_()));n.ULS.sendTraceTag(509150292,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.mT(this.FTa,this.ITa);this.tableRange=null;this.hr=-1;this.aia=null;this.vK=0;return!0};this.PMb=()=>{this.gridView.tQ=!1;this.vVa();this.vK=0;n.ULS.shipAssertTag(509159429,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.ee.cn(this.Dk);if(!this.$.fv([this.fe],!1))return n.ULS.sendTraceTag(509150291,
0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.mT(this.OMb,this.PMb),this.hr=-1,!0;if(!(this.ga.ra.Ef.equals(this.fe)||this.DFb(this.fe)||this.DFb(this.sourceRange)||this.luf()||(this.i_(),this.ga.sourceRange=this.sourceRange.clone(),this.$.rf(-694765314,2,30,{[Yc.a.c7a]:this.pfa,[Yc.a.Hgd]:!0,[Yc.a.Kgd]:this.JU,[Yc.a.xma]:this.ga.sourceRange,[Yc.a.wma]:this.ga.ra.Ef,[Yc.a.rzb]:this.JY}),this.pfa))){if(this.fe.top>this.sourceRange.top&&(this.isRow||this.fe.left===
this.sourceRange.left&&this.JU)){var Hc=this.fe.height;this.fe.top-=Hc;this.fe.bottom-=Hc}else this.fe.left>this.sourceRange.left&&(this.Wi||this.fe.top===this.sourceRange.top&&!this.JU)&&(Hc=this.fe.width,this.fe.left-=Hc,this.fe.right-=Hc);this.i_()}n.ULS.sendTraceTag(509150290,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.mT(this.OMb,this.PMb);this.aia=this.tableRange=null;this.hr=-1;this.JU=!1;return!0};this.FTa=Hc=>{Hc=Y.a(this.$).Xg(Hc);var rd=Hc.clientPoint;
this.EZ=Hc;if(Hc=this.ga.Us(rd,Hc.Be,5,void 0,void 0,!0)){if(this.tableRange.contains(Hc.topLeft)){if(this.Cvg(Hc,this.Az,rd),this.fe=this.zLa(Hc),this.ga.sourceRange=this.fe,this.ee.Yn(this.fe,this.Dk),n.ULS.shipAssertTag(509159428,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.ee.Iu(this.Dk),n.ULS.shipAssertTag(509159427,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.ee.cn(uh.hya),6!==this.hr){for(rd=1;4>=rd;rd++)if(Hc=
this.dt[rd.toString()])Hc.parentNode.removeChild(Hc),this.ee.JK(this.Az?11:12,rd).zh.appendChild(Hc);this.hr=6}}else this.fe=this.Kvb(Hc),this.Zif(!1);this.fJ()}return!0};this.OMb=Hc=>{Hc=Y.a(this.$).Xg(Hc);var rd=Hc.clientPoint;this.EZ=Hc;var ce=this.ga.Us(rd,Hc.Be,5,void 0,void 0,!0);if(ce){if(this.Bkf(ce))return this.fe=this.Kvb(ce),this.Yif(!1),!0;var Le=R.h(this.$),Ue=Le.hj(ce),mf=Le.mi(this.paneType);rd=Xi.a.gA(mf.view.ql,this.domElement.parentNode,rd,Le.rtl);mf=!1;let rf=2;this.JU=!1;if(this.isRow||
this.Wi){this.isRow&&rd.y-Ue.topLeft.y>Ue.height/2?(mf=!0,rf=1):this.Wi&&rd.x-Ue.topLeft.x>Ue.width/2&&(mf=!0);if(mf){Hc=Le.Lm("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",Le.YT,rf);try{Hc.Gy(ce),Hc.$$mn(),ce=Hc.$$cu().range}finally{Hc&&Hc.dispose()}}this.fe=this.Kvb(ce)}else{rd.x-Ue.topLeft.x===Ue.width?(this.JU=!1,mf=!0):rd.y-Ue.topLeft.y>Ue.height/2&&(this.JU=mf=!0,rf=1);this.aia&&(this.JU=this.Az);if(mf){Le=Le.Lm("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",
Le.YT,rf);try{Le.Gy(ce),Le.$$mn(),ce=Le.$$cu().range}finally{Le&&Le.dispose()}}n.ULS.shipAssertTag(509159424,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.ee.cn(this.Dk);this.Dk=this.JU?[11]:[12];for(Le=1;4>=Le;Le++)(Ue=this.dt[Le.toString()])&&Ue.parentNode.removeChild(Ue),this.dt[Le.toString()]=null;this.Zra(Hc.clientPoint,Hc.Be,this.JU?11:12);this.fe=this.zLa(ce)}this.ga.sourceRange=this.fe;this.ee.Yn(this.fe,this.Dk);n.ULS.shipAssertTag(509159395,0,
!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null");this.ee.Iu(this.Dk);n.ULS.shipAssertTag(509159394,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");this.ee.cn(uh.hya);if(6!==this.hr){for(ce=1;4>=ce;ce++)if(Hc=this.dt[ce.toString()])Hc.parentNode.removeChild(Hc),this.ee.JK(this.isRow||this.JU?11:12,ce).zh.appendChild(Hc);this.hr=6}this.fJ()}return!0};this.BMd=()=>{this.gridView.tQ&&5<=this.hr&&(this.tableRange?this.JY?(n.ULS.shipAssertTag(509159381,
0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),n.ULS.sendTraceTag(509150281,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rX(!0)):(n.ULS.shipAssertTag(509159380,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),n.ULS.sendTraceTag(509150280,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.nwb(!0)):this.JY?this.isRow||this.Wi?(n.ULS.shipAssertTag(509159385,
0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),n.ULS.sendTraceTag(509150285,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rX(!0)):(n.ULS.shipAssertTag(509159384,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),n.ULS.sendTraceTag(509150284,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.mwb(!0)):this.isRow||this.Wi?(n.ULS.shipAssertTag(509159383,0,!!this.Dk,
"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),n.ULS.sendTraceTag(509150283,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.mwb(!0)):(n.ULS.shipAssertTag(509159382,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),n.ULS.sendTraceTag(509150282,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rX(!0)));this.pfa&&this.dWb();this.JY&&this.dWb(1);this.vK=0;this.hr=-1;this.vVa()};
this.tableRange=null;this.gRa=this.pfa=this.JY=!1}dispose(){this.pfa&&this.dWb();this.JY&&this.dWb(1);super.dispose()}aMd(C){this.EZ=C;this.aia=null;this.Az=this.isRow=this.Wi=this.JU=!1;ac.KeyInputManager.instance.va(Jc.a.Ne,this.domElement.ownerDocument.body,this.onKeyDown);this.Tye();this.gridView.tQ=!0;(this.tableRange=this.wdh(this.gg.ru(this.sourceRange.topLeft)))&&!this.tableRange.equals(this.sourceRange)?(this.aia=this.tableRange,this.vK=1,this.Dk=(this.Az=this.tableRange.left===this.sourceRange.left&&
this.tableRange.right===this.sourceRange.right)?[11]:[12],this.hr=6,n.ULS.sendTraceTag(509150305,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.PZ(this.FTa,this.ITa),this.nNa=this.yec,this.jXa=this.fGc,this.Zra(C.clientPoint,C.Be,this.Az?11:12,!0),n.ULS.shipAssertTag(509159447,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.eta(!0)):(this.tableRange=null,this.isRow=this.sourceRange.isRow,this.Wi=this.sourceRange.Wi,this.isRow||
this.Wi?(this.vK=3,this.r7=this.isRow?1:2,this.hr=6,this.Dk=this.isRow?[11]:[12],n.ULS.sendTraceTag(509150303,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),this.PZ(this.OMb,this.PMb),this.nNa=this.yec,this.jXa=this.fGc,this.Zra(C.clientPoint,C.Be,this.isRow?11:12,!0),n.ULS.shipAssertTag(509159446,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.eta(!0)):(this.vK=2,this.r7=0,n.ULS.sendTraceTag(509150302,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler"),
this.PZ(this.fm,this.Mj),this.nNa=this.AXe,this.jXa=this.Fhg,this.Zra(C.clientPoint,C.Be,48,!0),n.ULS.shipAssertTag(509159445,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.D_(!0)))}HTa(){this.gridView.tQ=!1;this.vVa();this.vK=0;n.ULS.shipAssertTag(509159431,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null");this.ee.cn(uh.hya);if(!this.$.fv([this.fe],!1))return n.ULS.sendTraceTag(509150294,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),
this.mT(this.fm,this.Mj),this.hr=-1,!0;this.ga.ra.Ef.equals(this.fe)||this.DFb(this.fe)||this.DFb(this.sourceRange)?this.hr=-1:(this.i_(),this.ga.sourceRange=this.sourceRange.clone(),this.$.rf(-694765314,2,30,{[Yc.a.c7a]:this.pfa,[Yc.a.xma]:this.ga.sourceRange,[Yc.a.wma]:this.ga.ra.Ef,[Yc.a.rzb]:this.JY}));n.ULS.sendTraceTag(509150293,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler");this.mT(this.fm,this.Mj);return!0}bMd(C){const ea=this.ga.Us(C.clientPoint,C.Be,5,void 0,
void 0,!0);this.EZ=C;return this.Bkf(ea)?(this.fe=this.zLa(ea),this.Yif(!0),!0):this.Pqi(ea)?(this.fe=this.Kvb(ea),this.Zif(!0),!0):!1}fJ(C){C=void 0===C?!1:C;const ea=this.fe.toString();for(let Ta=1;4>=Ta;Ta++){const Yb=this.dt[Ta.toString()];Yb&&Yb.childNodes&&0<Yb.childNodes.length&&(Yb.childNodes[0].innerText=ea,Yb.childNodes[1].innerText=this.nNa,C&&(Yb.childNodes[2].innerText=this.jXa))}}Bkf(C){return!!this.aia&&1!==this.vK&&!!C&&this.aia.contains(C.topLeft)}Pqi(C){return!!this.aia&&1===this.vK&&
!!C&&!this.aia.contains(C.topLeft)}Yif(C){this.tableRange=this.aia;this.vK=1;const ea=!this.JY;C?(n.ULS.shipAssertTag(509159393,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),n.ULS.sendTraceTag(509150289,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rX(!1),this.Dk=this.Az?[11]:[12],this.yPb(ea),n.ULS.shipAssertTag(509159392,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.eta(ea)):
(n.ULS.shipAssertTag(509159391,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),n.ULS.sendTraceTag(509150288,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.mwb(!1),this.bra(ea),n.ULS.shipAssertTag(509159390,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.D_(ea))}Zif(C){this.tableRange=null;this.vK=2;const ea=!this.JY;C?(n.ULS.shipAssertTag(509159389,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),
n.ULS.sendTraceTag(509150287,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),this.rX(!1),this.Dk=this.Az?[11]:[12],this.JU=this.Az,this.PSd(ea),n.ULS.shipAssertTag(509159388,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),this.eta(ea)):(n.ULS.shipAssertTag(509159387,0,!!this.Dk,"DragSelectionClickBehaviorCellRangeAndTable: currentHighlight is null"),n.ULS.sendTraceTag(509150286,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Cleaning up mouse handler"),
this.nwb(!1),this.bra(ea),n.ULS.shipAssertTag(509159386,0,!!this.Bw(),"DragSelectionClickBehaviorCellRangeAndTable: getDragHighlight is null"),this.D_(ea))}DGc(){if(!R.h(this.$).ga.ra.Zj)return!1;const C=R.h(this.$).getRangeInformation(this.ga.ra.Ef);for(const ea of C)if(Object(Ei.a)(Ki.PivotTableRange,ea))return!1;return!0}wdh(C){if(C&&C.contains(this.sourceRange)&&!C.equals(this.sourceRange)){if(C.doa&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===C.top){const ea=new Ia.Range(this.sourceRange.top,
this.sourceRange.left,C.bottom,this.sourceRange.right,!1,!1);if(!ea.equals(C))return this.sourceRange=ea,this.ga.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),C}this.Az=C.left===this.sourceRange.left&&C.right===this.sourceRange.right;if(C.top===this.sourceRange.top&&C.bottom===this.sourceRange.bottom||this.Az)return C}return null}zLa(C){const ea=C.clone();this.Az?ea.left=Math.max(C.left-this.Lud,1):ea.top=Math.max(C.top-this.I$d,1);ea.right=ea.left+this.sourceRange.width-1;ea.bottom=
ea.top+this.sourceRange.height-1;return this.Itb(ea)}luf(){const C=this.fe.topLeft.If(this.sourceRange);return!C&&this.tableRange?this.Az?this.fe.top===this.sourceRange.bottom+1:this.fe.left===this.sourceRange.right+1:C}uwj(){if(this.Az&&this.fe.left!==this.tableRange.left||!this.Az&&this.fe.top!==this.tableRange.top){const C=te.a.Mf(1,1,0,918,0,2065438552,"RearrangeInvalidDest");Pi.a(this.$).Vw([C]);return!0}return!1}urj(){const C=this.$.pe.xf("UserAction","RearrangeRowColumnClientSide"),ea={["CopyPasteTargetType"]:1,
["OperationId"]:la.a.create().toString(),["Stopwatch"]:C,["DragDropIsShiftKeyDown"]:this.JY,["EncounteredDeploymentErrors"]:!1},Ta=this.pfa?2:1,Yb=this.$.ia.Ja(254);(new Promise((wc,Hc)=>{this.jSh(rd=>{rd.Errors&&0<rd.Errors.length?Hc(new Xc(22,rd.Errors)):wc(!0)},rd=>{rd=ge.a.kh(rd.data);Hc(new Xc(22,rd))})})).then(()=>{n.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');Yb&&Yb.aVi(ea,Ta,this.sourceRange,this.fe);return Promise.resolve(!0)},
wc=>{n.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${wc?copyPasteInfra.getStringifiedError(wc):"null"}, copyPasteTargetType="${1}"`);return Yb?Yb.Iej(wc,ea,Ta,this.sourceRange,this.fe):Promise.reject(wc)})}jSh(C,ea){C=void 0===C?null:C;ea=void 0===ea?null:ea;const Ta={};this.Az?(Ta.FirstRow=this.fe.top-1,Ta.FirstColumn=0,Ta.DeltaColumn=0,Ta.DeltaRow=this.fe.bottom-this.fe.top+1):(Ta.FirstRow=0,Ta.FirstColumn=this.fe.left-1,Ta.DeltaColumn=this.fe.right-
this.fe.left+1,Ta.DeltaRow=0);Ta.LastRow=Tb.a.vB;Ta.LastColumn=Tb.a.Dz;Ta.SheetName=this.$.ta.pa?this.$.ta.pa.name:this.$.ue.getItemByName(this.$.ue.pa.name).sheetName;const Yb=ab.v(this.sourceRange,this.$);this.$.userOperationManager.enqueueOperation(new ud.a(514,0,(wc,Hc,rd)=>{var ce=this.$.qa.ua;wc=C?Je.b(wc,C):wc;Hc=ea?Je.a(Hc,ea):Hc;const Le=ce.Pa(41,null);Le.sourceRange=Yb;Le.destinationRange=Ta;return Ob.g(ce,"RearrangeRowColumn",Le,wc,Hc,rd,null,0)},64,()=>new ej(Yb,Ta)),null)}dWb(C){C=void 0===
C?0:C;0===C?this.pfa=!1:1===C&&(this.JY=!1);this.pfa||this.JY||(ac.KeyInputManager.instance.Ca(Jc.a.tg,this.domElement.ownerDocument.body,this.onKeyUp),this.gRa=!1)}bra(C){C=void 0===C?!1:C;this.hr=5;n.ULS.sendTraceTag(509150277,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.PZ(this.fm,this.Mj);this.nNa=this.AXe;this.jXa=this.Fhg;this.Zra(this.EZ.clientPoint,this.EZ.Be,48,C)}PSd(C){C=void 0===C?!1:C;this.hr=6;n.ULS.sendTraceTag(509150276,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");
this.PZ(this.OMb,this.PMb);this.nNa=this.yec;this.jXa=this.fGc;this.Zra(this.EZ.clientPoint,this.EZ.Be,this.isRow||this.Az?11:12,C)}yPb(C){C=void 0===C?!1:C;this.hr=6;n.ULS.sendTraceTag(509150275,0,50,"DragSelectionClickBehaviorCellRangeAndTable: Registering mouse handler");this.PZ(this.FTa,this.ITa);this.nNa=this.yec;this.jXa=this.fGc;this.Zra(this.EZ.clientPoint,this.EZ.Be,this.Az?11:12,C)}mwb(C){this.ee.cn(this.Dk);this.mT(this.OMb,this.PMb,void 0,C)}}Object(m.a)(ki,"DragSelectionClickBehaviorCellRangeAndTable",
uh,[]);var Gi=a(391);class ai extends uh{constructor(C,ea,Ta,Yb,wc){super(C,ea,Ta,Yb,wc);this.BMd=()=>{this.gridView.tQ&&(n.ULS.shipAssertTag(509159371,0,!!this.Dk,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),n.ULS.sendTraceTag(509150340,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.nwb(!0));5===this.hr&&(n.ULS.shipAssertTag(509159370,0,!!this.Bw(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),n.ULS.sendTraceTag(509150339,
0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.rX(!0));this.vVa()};this.ITa=Hc=>{Y.a(this.$).Xg(Hc);this.gridView.tQ=!1;this.vVa();n.ULS.shipAssertTag(509159369,0,!!this.Dk,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.ee.cn(this.Dk);this.ga.sourceRange=this.sourceRange.clone();this.mwf?this.$.rf(927125067,Ma.a.Td,30,null):this.HAa?(this.i_(),this.ga.sourceRange=this.sourceRange.clone(),this.$.rf(-694765314,2,30,{[Yc.a.c7a]:!0,[Yc.a.xma]:this.ga.sourceRange,
[Yc.a.wma]:this.ga.ra.Ef,[Yc.a.rzb]:!1}),n.ULS.sendTraceTag(509617280,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerUpRearrange: dragDropCells"),R.h(this.$).Xj.Fu(Yc.a.H2),this.HAa=!1):this.lrj();n.ULS.sendTraceTag(509150338,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.mT(this.FTa,this.ITa);this.hr=-1;return!0};this.FTa=Hc=>{Hc=Y.a(this.$).Xg(Hc);const rd=Hc.clientPoint;this.EZ=Hc;let ce=this.ga.Us(rd,Hc.Be,5,void 0,void 0,!0);if(ce){if(!this.FAd(ce))return this.Jni(Hc),
!0;this.Cvg(ce,this.isRow,rd);if(this.isRow||this.Wi)this.fe=this.zLa(ce);this.ga.sourceRange=this.fe;this.ee.Yn(this.fe,this.Dk);n.ULS.shipAssertTag(509159368,0,!!this.Dk,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");this.ee.Iu(this.Dk);n.ULS.shipAssertTag(509159367,0,!!this.Bw(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null");this.ee.cn(uh.hya);this.fJ()}return!0};this.onKeyDown=Hc=>this.Dab(Hc)?(this.gRa||(ac.KeyInputManager.instance.va(Jc.a.tg,this.domElement.ownerDocument.body,
this.onKeyUp),this.gRa=!0),this.HAa||(R.h(this.$).Xj.Fu(Ig.IPe),this.HAa=!0),!0):!1;this.onKeyUp=Hc=>{this.Dab(Hc)&&(ac.KeyInputManager.instance.Ca(Jc.a.tg,this.domElement.ownerDocument.body,this.onKeyUp),this.gRa=!1,this.gridView.tQ?R.h(this.$).Xj.Fu(Ig.vzb):R.h(this.$).Xj.Fu(Yc.a.H2),this.HAa=!1);return!0};this.vQf=Hc=>{Hc.Errors&&0<Hc.Errors.length?(n.ULS.sendTraceTag(521410185,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${te.a.Me(Hc.Errors)}]`),this.fe.left=
this.sourceRange.left,this.fe.right=this.sourceRange.right,this.fe.top=this.sourceRange.top,this.fe.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.fe.top&&this.sourceRange.bottom>=this.fe.top-1?(this.fe.top=this.sourceRange.top,this.fe.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.fe.top||(this.fe.top-=this.sourceRange.height),this.fe.bottom=this.fe.top+this.sourceRange.height-1):this.sourceRange.left<=this.fe.left&&this.sourceRange.right>=this.fe.left-1?(this.fe.left=
this.sourceRange.left,this.fe.right=this.sourceRange.right):(this.sourceRange.left>this.fe.left||(this.fe.left-=this.sourceRange.width),this.fe.right=this.fe.left+this.sourceRange.width-1);this.i_();this.hr=-1};this.uQf=Hc=>{Hc=ge.a.kh(Hc.data);n.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${te.a.Me(Hc)}]`)};this.HAa=this.gRa=!1}dispose(){super.dispose()}aMd(C){this.EZ=C;this.isRow=this.Wi=!1;this.Tye();this.r7=null!=this.fe?this.fe.isRow?
1:this.fe.Wi?2:0:0;this.gridView.tQ=!0;ac.KeyInputManager.instance.va(Jc.a.Ne,this.domElement.ownerDocument.body,this.onKeyDown);this.ye=this.gg.Hna(this.sourceRange);this.Xqf=this.UJi(this.fe);this.ye||n.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.mwf=(new Jd.a(this.$.ta)).yk;R.h(this.$).Xj.Fu(Ig.vzb);this.FAd(this.fe)?(this.isRow=this.NKi(),this.Wi=this.NDi(),this.isRow||this.Wi?(this.rbb=
!1,this.yPb(C),this.fe=this.zLa(this.fe),n.ULS.shipAssertTag(509159377,0,!!this.Dk,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null"),this.eta()):(this.rbb=!0,this.bra(C),n.ULS.shipAssertTag(509159376,0,!!this.Bw(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),this.D_())):(this.rbb=!0,this.bra(C),n.ULS.shipAssertTag(509159375,0,!!this.Bw(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),this.D_())}HTa(){this.gridView.tQ=!1;this.vVa();
return this.mwf?(this.$.rf(927125067,Ma.a.Td,30,null),n.ULS.shipAssertTag(509159374,0,!!this.Bw(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),n.ULS.sendTraceTag(509150343,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.rX(!0),this.rbb=!1,this.hr=-1,!0):this.HAa||this.Xqf?(this.i_(),this.ga.sourceRange=this.sourceRange.clone(),this.$.rf(-694765314,2,30,{[Yc.a.c7a]:this.HAa,[Yc.a.xma]:this.ga.sourceRange,[Yc.a.wma]:this.ga.ra.Ef,[Yc.a.rzb]:!1}),
n.ULS.sendTraceTag(509617281,0,50,`DragSelectionClickBehaviorPivotTableRange.onPointerUpInternal: dragDropCells with isCopyOperation="${this.HAa}"`),R.h(this.$).Xj.Fu(Yc.a.H2),n.ULS.shipAssertTag(509159373,0,!!this.Bw(),"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),n.ULS.sendTraceTag(509150342,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.rX(!0),this.rbb=!1,this.hr=-1,this.Xqf=!1,!0):5===this.hr?(n.ULS.shipAssertTag(509159372,0,!!this.Bw(),
"DragSelectionClickBehaviorPivotTableRange: getDragHighlight is null"),n.ULS.sendTraceTag(509150341,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler"),this.rX(!0),this.rbb=!1,this.H2j(),this.hr=-1,!0):!1}bMd(C){const ea=this.ga.Us(C.clientPoint,C.Be,5,void 0,void 0,!0);this.EZ=C;return this.rbb?!1:this.FAd(ea)?(this.Kni(C),!0):!1}fJ(){let C=new Ia.Range(this.fe.top,this.fe.left,this.fe.bottom,this.fe.right,!1,!0);6===this.hr&&(this.isRow?(--C.top,C.bottom=C.top+this.fe.height-
1):(--C.left,C.right=C.left+this.fe.width-1));for(let ea=1;4>=ea;ea++){const Ta=this.dt[ea.toString()];Ta&&Ta.childNodes&&0<Ta.childNodes.length&&(Ta.childNodes[0].innerText=C.toString())}}DGc(){if(!R.h(this.$).ga.ra.Zj)return!1;var C=R.h(this.$).getRangeInformation(this.ga.ra.Ef);for(var ea of C)if(Object(Ei.a)(Ki.PivotTableRange,ea)&&(C=this.gg.Hna(ea)))return ea=!C.isOlap||!C.gcb(!0),n.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",
C),C.isActionable&&ea;return!1}zLa(C){C=C.clone();this.isRow?(C.left=this.sourceRange.left,C.right=this.ye.right,C.bottom=C.top+this.sourceRange.height-1):this.Wi?(C.top=this.sourceRange.top,C.bottom=this.ye.fD?this.ye.fD.bottom:this.ye.bottom,C.right=C.left+this.sourceRange.width-1):n.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.Itb(C)}lrj(){const C={},ea=ab.v(this.sourceRange,this.$);R.h(this.$).getRangeInformation(this.fe);
if(this.isRow){ea.FirstColumn=C.FirstColumn=this.fe.left-1;ea.LastColumn=C.LastColumn=this.fe.right-1;if(this.sourceRange.top<=this.fe.top&&this.sourceRange.bottom>=this.fe.top-1){n.ULS.sendTraceTag(520176345,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.fe.top?C.LastRow=C.FirstRow=this.fe.top-1:(C.FirstRow=this.fe.top-this.sourceRange.height-1,C.LastRow=C.FirstRow+this.sourceRange.height-1)}else{C.FirstRow=Math.min(this.fe.top,this.fe.bottom-
1);C.LastRow=this.fe.bottom-1;if(this.sourceRange.left<=this.fe.left&&this.sourceRange.right>=this.fe.left-1){n.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}C.LastColumn=this.sourceRange.left>this.fe.left?C.FirstColumn=this.fe.left-1:C.FirstColumn=this.fe.left-this.sourceRange.width-1}const Ta={};Ta.SheetName=this.$.ta.pa?this.$.ta.pa.name:this.$.ue.getItemByName(this.$.ue.pa.name).sheetName;Ta.Ranges=Array(2);Ta.Ranges[0]=ea;Ta.Ranges[1]=
C;this.eSh(Ta)}eSh(C){this.$.userOperationManager.enqueueOperation(new ud.a(265,0,(ea,Ta,Yb)=>{var wc=this.$.qa.ua;ea=this.vQf?Je.b(ea,this.vQf):ea;Ta=this.uQf?Je.a(Ta,this.uQf):Ta;const Hc=wc.Pa(1,null);Hc.moveRange=C;return Ob.g(wc,"MoveLineItems",Hc,ea,Ta,Yb,null,0)},64),null)}FAd(C){return null!==this.ye&&null!==C&&this.MHi(C)&&this.HKi(C)&&this.ZMi(C)&&this.KCi(C)}MHi(C){return this.ye.fD?C.left>=this.ye.fD.left:this.ye.MA?C.left>=this.ye.MA.left:C.left>=this.ye.left}HKi(C){return this.ye.MA?
C.right<=this.ye.MA.right:this.ye.fD?C.right<=this.ye.fD.right:C.right<=this.ye.right}ZMi(C){return this.isRow?null!==this.ye.fD&&C.top>=this.ye.fD.top:this.Wi?null!==this.ye.MA&&C.top>=this.ye.MA.top:null===this.ye.top||C.top>=this.ye.top}KCi(C){return this.ye.fD?C.bottom<=this.ye.fD.bottom:this.ye.MA?C.bottom<=this.ye.MA.bottom:C.bottom<=this.ye.bottom}UJi(C){return null!==this.ye&&this.ye.left>=C.left&&this.ye.right<=C.right&&this.ye.top>=C.top&&this.ye.bottom<=C.bottom}NKi(){return null!==this.ye&&
null!==this.ye.fD&&this.ye.fD.top<=this.fe.top&&this.ye.fD.left<=this.fe.left&&this.ye.fD.right>=this.fe.left}NDi(){return null!==this.ye&&null!==this.ye.MA&&this.ye.MA.top===this.fe.top&&this.ye.MA.left<=this.fe.left&&this.ye.MA.right>=this.fe.right}yPb(C){this.hr=6;this.Dk=this.isRow?[11]:[12];n.ULS.sendTraceTag(509150337,0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");this.PZ(this.FTa,this.ITa);this.Zra(C.clientPoint,C.Be,this.isRow?11:12,!1)}bra(C){this.hr=5;n.ULS.sendTraceTag(509150336,
0,50,"DragSelectionClickBehaviorPivotTableRange: Registering mouse handler");this.PZ(this.fm,this.Mj);this.Zra(C.clientPoint,C.Be,48,!1)}Kni(C){n.ULS.shipAssertTag(509159366,0,!!this.Bw(),"DragSelectionClickBehaviorPivotTableRange.handleDragWithinPivotTable: getDragHighlight is null");n.ULS.sendTraceTag(509150307,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.rX(!1);this.yPb(C);this.fe=this.zLa(this.fe);n.ULS.shipAssertTag(509159365,0,!!this.Dk,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");
this.eta()}Jni(C){n.ULS.shipAssertTag(509159364,0,!!this.Dk,"DragSelectionClickBehaviorPivotTableRange: currentHighlight is null");n.ULS.sendTraceTag(509150306,0,50,"DragSelectionClickBehaviorPivotTableRange: Cleaning up mouse handler");this.nwb(!1);this.bra(C);n.ULS.shipAssertTag(509159363,0,!!this.Bw(),"DragSelectionClickBehaviorPivotTableRange.handleDragOutsidePivotTable: getDragHighlight is null");this.D_()}H2j(){if((null==this.sourceRange||null==this.fe||this.sourceRange.Cy(!1)!==this.fe.Cy(!1))&&
!this.DFb(this.fe)){var C=te.a.Mf(1,0,904,903,0,2069074184,"PivotTableInvalidMove");C.HelpTopicId=Gi.a.F6j;C.HelpDescription=gb.a.instance.ha(913);Pi.a(this.$).Vw([C])}}}Object(m.a)(ai,"DragSelectionClickBehaviorPivotTableRange",uh,[]);var $g=a(386);class ei extends ng{constructor(C,ea){super(C);this.fi=()=>{this.domElement.classList.remove(sg.selecting);$g.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Ev=()=>{this.domElement.classList.add(sg.selecting)};this.onPointerDown=
Ta=>{2===Ta.de&&Ta.Oq===Sys.UI.MouseButton.leftButton&&(this.gridView.ga.selectionType=4,this.gridView.ga.sourceRange=this.gridView.ga.ra.Ef,$g.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};this.sga=()=>{this.gridView.$.rf(1983983164,2,30,null);return!0};this.fg=()=>{Xf.DOMElementExtensions.setVisible(this.mea,this.gridView.$.isEditMode)};this.fDa=()=>{Xf.DOMElementExtensions.setVisible(this.mea,!1)};this.eDa=()=>{Xf.DOMElementExtensions.setVisible(this.mea,!0)};this.BOf=
()=>{Xf.DOMElementExtensions.setVisible(this.mea,!1)};this.AOf=()=>{Xf.DOMElementExtensions.setVisible(this.mea,!0)};this.iMb=(Ta,Yb)=>{Xf.DOMElementExtensions.setVisible(this.mea,!Yb.vxe)};this.gridView=ea;ea=document.createElement("div");ea.className=cb.EwaSettings.xQ()?pf.a.vQh:pf.a.uQh;this.mea=ea;this.fg(null,null);C.appendChild(ea);Va.a.instance.va(Jc.a.Cf,this.mea,this.onPointerDown);Ne.a.instance.va(Jc.a.Pm,this.mea,this.sga);this.gridView.$.zn(this.fg);this.gridView.$.Rd.U4c(this.fDa);this.gridView.$.Rd.T4c(this.eDa);
this.gridView.Wze(this.iMb);this.gridView.cellTextEditBox.Yp(this.BOf);this.gridView.cellTextEditBox.yq(this.AOf)}dispose(){Va.a.instance.Ca(Jc.a.Cf,this.mea,this.onPointerDown);Ne.a.instance.Ca(Jc.a.Pm,this.mea,this.sga);this.gridView.$&&(this.gridView.ga.pha(this.Ev),this.gridView.ga.aaa(this.fi),this.gridView.$.uo(this.fg),this.gridView.$.Rd.NUd(this.fDa),this.gridView.$.Rd.MUd(this.eDa),this.gridView.K5f(this.iMb),this.gridView.cellTextEditBox.Qp(this.BOf),this.gridView.cellTextEditBox.Pp(this.AOf));
super.dispose()}}Object(m.a)(ei,"FillHandleClickBehavior",ng,[]);class gi{constructor(C){this.Imf=ea=>{this.cLc(ea.Be,1);return!0};this.Jmf=ea=>{this.cLc(ea.Be,-1);return!0};this.fi=()=>{this.tzd=!1};this.Ev=()=>{this.tzd=!0};this.gridView=C;this.H$a=0;this.tzd=this.spc=!1;this.I9=Number.NaN;this.gridView.ga.Tka(this.Ev);this.gridView.ga.Ska(this.fi);this.gridView.ga.eBe(this.fi)}dispose(){this.gridView.ga.pha(this.Ev);this.gridView.ga.aaa(this.fi);this.gridView.ga.A6f(this.fi)}sR(){this.H$a=0;this.spc=
!1;this.I9=Number.NaN}yXe(C){this.spc=!0;this.cLc(C,1)}zXe(C){this.spc=!1;this.cLc(C,-1)}cLc(C,ea){if(C)if(C.parentNode)if(this.tzd)isNaN(this.I9)||(this.rLc(this.I9,!1),this.I9=Number.NaN);else if(C=parseInt(C.parentNode.getAttribute(Yc.a.Y$a),10),isNaN(C))n.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.I9)&&C!==this.I9){if(this.spc)return;this.rLc(this.I9,!1)}if(isNaN(this.I9)||C!==this.I9)this.I9=
C,this.H$a=0;!this.H$a&&0<ea&&this.rLc(C,!0);this.H$a=Math.max(this.H$a+ea,0);!this.H$a&&0>ea&&(this.rLc(C,!1),this.I9=Number.NaN)}else n.ULS.shipAssertTag(537159367,0,!!C.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else n.ULS.shipAssertTag(537159368,0,!!C,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}rLc(C,ea){var Ta=this.gridView.Gd.FMc;for(const Yb of Ta)for(Ta=this.gridView.ee.JK(3,Yb,C).zh,Xf.DOMElementExtensions.toggleCssClass(Ta,sg.cQh,
ea),Ta=Ta.firstChild;Ta;Ta=Ta.nextSibling)pc.a.contains(Ta.className,"resizemarqueehandle",!0)&&Xf.DOMElementExtensions.toggleCssClass(Ta,sg.gQh,ea)}}Object(m.a)(gi,"MarqueeHoveringManager",null,[]);var Vh=a(183),lf=a(869),E=a(1191);class da extends gc{constructor(C,ea){super(C);this.Nlc=!1;this.yxc=()=>{if(!this.uv)return n.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;this.uv.xuj(this.Vea);this.uv.NGh(this.Wea);if(3===this.uv.model.state)return!0;
this.uv.avd(!0);return!0};this.yga=()=>{if(!this.uv)return!1;this.uv.s0f(!1);this.uv.sWd(this.Wea,!1);if(3===this.uv.model.state)return!0;this.uv.avd(!1);return!0};this.onPointerDown=Ta=>this.uv?2===Ta.de&&Ta.Oq===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.GMb=()=>{if(!this.uv)return!1;this.uv.sWd(this.Wea,!0);this.uv.avd(!1);this.uv.S6a();return!0};this.onDoubleClick=Ta=>{if(Ta.Da)return Ta.Da.stopPropagation(),!0;n.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");
return!0};this.container=C;this.uv=Object(z.a)(E.a,ea.metadata);this.Eig(ea)&&this.Nof(ea.isVisible)}dispose(){this.x4f();this.uv=null;super.dispose()}m3a(C){this.uv=Object(z.a)(E.a,C.metadata);this.Eig(C)?this.Nof(C.isVisible):this.x4f();!cb.EwaSettings.isChangeGateEnabled("OfficeVSO:7800556_DisableRangeHighlightAdjustBehaivor")&&C.isVisible!==C.JBa&&this.uv&&(this.uv.dXj(C.isVisible?1:0),Xf.DOMElementExtensions.setVisible(this.Wea,C.isVisible))}Nof(C){this.Nlc||(this.Nlc=!0,this.Wea=document.createElement("div"),
this.Wea.id=`${this.container.id}-${Yc.a.jKe}`,this.Wea.className=lf.a.cfh,this.Vea=document.createElement("div"),this.Vea.id=`${this.container.id}-${Yc.a.K9c}`,this.Vea.className=lf.a.K9c,this.lU=document.createElement("div"),this.lU.appendChild(this.Vea),this.lU.className=lf.a.bfh,this.Wea.appendChild(this.lU),this.container.appendChild(this.Wea),n.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created."),
Va.a.instance.va(Jc.a.FZ,this.lU,this.yxc),Va.a.instance.va(Jc.a.CE,this.lU,this.yga),Va.a.instance.va(Jc.a.Cf,this.lU,this.onPointerDown),Vh.a.instance.va(Jc.a.click,this.lU,this.GMb),Vh.a.instance.va(Jc.a.Pm,this.lU,this.onDoubleClick),Xf.DOMElementExtensions.setVisible(this.lU,C))}x4f(){this.Nlc&&(this.Nlc=!1,Va.a.instance.Ca(Jc.a.FZ,this.lU,this.yxc),Va.a.instance.Ca(Jc.a.CE,this.lU,this.yga),Va.a.instance.Ca(Jc.a.Cf,this.lU,this.onPointerDown),Vh.a.instance.Ca(Jc.a.click,this.lU,this.GMb),Vh.a.instance.Ca(Jc.a.Pm,
this.lU,this.onDoubleClick),Xf.DOMElementExtensions.xi(this.Vea),this.Vea=null,Xf.DOMElementExtensions.xi(this.Wea),this.Wea=null)}Eig(C){C=new Ke.a(C.range,C.sheetId);return!!this.uv&&this.uv.Znc(C)}}Object(m.a)(da,"RangeCatchUpActivityHighlightBehavior",gc,[]);class Ha extends xg{constructor(C,ea,Ta,Yb){super(C,ea,Ta,Yb)}get X8(){return 16}get sib(){return this.gridView.ga.rangePicker.bnd(!1)}oXa(){return(this.gridView.inRangePicker||this.gridView.Al)&&super.oXa()}}Object(m.a)(Ha,"RangePickerTouchGrippiesBehavior",
xg,[]);class Fb extends gc{constructor(C,ea){super(C);const Ta=document.createElement("div"),Yb=document.createElement("div");Ta.className=ea?sg.FQh:sg.HQh;Yb.className=ea?sg.GQh:sg.EQh;C.appendChild(Ta);C.appendChild(Yb)}}Object(m.a)(Fb,"RearrangeHighlightBehavior",gc,[]);var bc;(function(C){C[C.topLeft=0]="topLeft";C[C.topRight=1]="topRight";C[C.bottomLeft=2]="bottomLeft";C[C.bottomRight=3]="bottomRight";C[C.error=4]="error"})(bc||(bc={}));Object(m.b)("Corner",bc);class Vc extends gc{constructor(C,
ea,Ta,Yb,wc){super(C);this.gf=this.ZI=null;this.E7=0;this.fe=this.sourceRange=null;this.YXa=!1;this.onPointerDown=Hc=>{Hc=Y.a(this.$).Xg(Hc);if(this.eig(Hc)&&!this.YXa){this.xCf();this.gf=this.Mr.jic();this.ZI=this.Mr.Off(Hc);if(!this.gf||!this.ZI||!this.ZI.range)return n.ULS.shipAssertTag(537159361,0,!!this.gf,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),n.ULS.shipAssertTag(537159360,0,!!this.ZI,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),n.ULS.shipAssertTag(537159331,
0,!!this.ZI.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.fe=this.ZI.range.clone();this.sourceRange=this.fe.clone();this.E7=this.hbf(Hc);if(4===this.E7)return n.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const rd=this.odf(Hc,!0);if(!rd)return n.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),
!1;if(!this.HRe(rd))return n.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.pQa=!0;this.gf.AH(!1);this.CI.yXe(Hc.Be);this.Mr.F0f(!0,this.SK.sX);this.gf.Ha.removeSelection();this.gf.D6b(this.zjf);this.M3f();this.YXa=!0;fh.b(this.$,!0)}return!0};this.fm=Hc=>{Hc=Y.a(this.$).Xg(Hc);Hc=this.odf(Hc,!1);if(!Hc)return!0;Hc=this.HRe(Hc);if(!Hc)return n.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),
this.fhc(!0),!1;if(this.fe.equals(Hc))return!0;this.fe=Hc;Hc=this.D_();Hc||(n.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.fhc(!0));return Hc};this.Mj=Hc=>{Y.a(this.$).Xg(Hc);Hc=this.i_();n.ULS.shipAssertTag(537159325,0,Hc,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.fhc(!Hc);return Hc};this.zjf=()=>{this.fhc(!0)};this.gridView=ea;this.$=ea.$;this.sO=[];this.ga=this.gridView.ga;this.CI=Ta;this.Mr=Yb;this.SK=
wc;this.coloredReferencesManager=this.$.ia.Ja(281);n.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.vQ=kc.a.pE())ea=this.$.ia.Ja(464),n.ULS.shipAssertTag(510255176,0,!!ea,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.vy=ea.vy;for(const Hc of this.m9f())ea=this.Mr.OQe(C,
Hc,this.DBe(),this.onPointerDown),this.sO.push(ea);for(const Hc of this.sO)Va.a.instance.va(Jc.a.FZ,Hc,this.CI.Imf),Va.a.instance.va(Jc.a.CE,Hc,this.CI.Jmf);this.m3a(wc)}dispose(){this.sO.forEach(C=>{Va.a.instance.Ca(Jc.a.Cf,C,this.onPointerDown)});this.sO.length=0;super.dispose()}m3a(C){this.SK=C;this.MBe(C);this.Mr.VSb(C,this.sO,this.P1d());this.CI.sR()}odf(C,ea){const Ta=C.Be;C=C.clientPoint;if(!Ta||!C)return n.ULS.shipAssertTag(537159324,0,!!Ta,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),
n.ULS.shipAssertTag(537159323,0,!!C,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ea&&(C=this.QGf(C));ea=this.ga.Us(C,Ta,0,!0,!1,!0);ea||(C=this.QGf(C),ea=this.ga.Us(C,Ta,0,!0,!1,!0));return ea}QGf(C){C.y+=0===this.E7||1===this.E7?2:-2;C.x+=0===this.E7||2===this.E7?2:-2;return C}HRe(C){if(!C||!this.sourceRange)return n.ULS.shipAssertTag(537159322,0,!!C,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),n.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),
null;if(0===this.E7)return new Ia.Range(C.top,C.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.E7)return new Ia.Range(C.top,this.sourceRange.left,this.sourceRange.bottom,C.right,!0,!1);if(2===this.E7)return new Ia.Range(this.sourceRange.top,C.left,C.bottom,this.sourceRange.right,!0,!1);if(3===this.E7)return new Ia.Range(this.sourceRange.top,this.sourceRange.left,C.bottom,C.right,!0,!1);n.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${bc[this.E7]}`);
return null}i_(){return this.vQ?this.vy.WKb(this.gf,this.ZI,this.fe):this.coloredReferencesManager.WKb(this.gf,this.ZI,this.fe)}D_(){return this.i_()}fhc(C){C&&n.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.CI.zXe(this.sO[0]);this.Mr.F0f(!1,this.SK.sX);this.gf.Ha.setCaretPositionToEnd();this.gf.aCc(this.zjf);this.Htg();this.YXa=this.gridView.pQa=!1;fh.b(this.$,!1);this.Mr.m2f()}}
Object(m.a)(Vc,"ResizeMarqueeBehaviorBase",gc,[]);class Sc extends Vc{constructor(C,ea,Ta,Yb,wc){super(C,ea,Ta,Yb,wc)}m9f(){return[sg.LQh,sg.MQh,sg.JQh,sg.KQh]}DBe(){return[sg.IQh]}hbf(C){C=C.Be;if(C===this.sO[0])return 0;if(C===this.sO[1])return 1;if(C===this.sO[2])return 2;if(C===this.sO[3])return 3;n.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}M3f(){this.Mr.PZ(this.fm,this.Mj,!0)}Htg(){this.Mr.i8d(this.fm,this.Mj,
!0)}eig(C){return 2===(Ma.a.Td=C.de)&&C.Oq===Sys.UI.MouseButton.leftButton}P1d(){return!0}xCf(){n.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}MBe(C){for(const ea of this.sO)ea.style.backgroundColor=C.zh.style.borderColor}}Object(m.a)(Sc,"ResizeMarqueeMouseBehavior",Vc,[]);class wd extends Vc{constructor(C,ea,Ta,Yb,wc){super(C,ea,Ta,Yb,wc);this.AMb=()=>{const Hc=3===Ma.a.Td;this.mDd&&!Hc?this.Mr.VSb(this.SK,this.sO,
!1):!this.mDd&&Hc&&this.Mr.VSb(this.SK,this.sO,!0);this.mDd=Hc};this.Zej=(Hc,rd)=>{rd.Y$a===this.SK.sX&&this.Mr.VSb(this.SK,this.sO,!rd.start&&this.P1d())};Ma.a.CAe(this.AMb);this.mDd=3===Ma.a.Td;this.Mr.Q_g(this.Zej)}dispose(){Ma.a.k6f(this.AMb);super.dispose()}m9f(){return[pf.a.WPh,pf.a.VPh]}DBe(){return[pf.a.e3e,pf.a.bgc,pf.a.agc]}hbf(C){C=C.Be;if(C===this.sO[0])return 0;if(C===this.sO[1])return 3;n.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4}M3f(){Z.a.qG?this.Mr.PZ(this.fm,this.Mj,!1):this.Mr.Vyj(this.fm,this.Mj)}Htg(){Z.a.qG?this.Mr.i8d(this.fm,this.Mj,!1):this.Mr.Fik(this.fm,this.Mj)}eig(C){return 3===(Ma.a.Td=C.de)}P1d(){return 3===Ma.a.Td}xCf(){n.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}MBe(){}}Object(m.a)(wd,"ResizeMarqueeTouchBehavior",Vc,[]);class md extends gc{constructor(C,ea){super(C);md.Fxb(C,xc.a.lQh+" "+pf.a.Fya,null===ea||void 0===
ea?void 0:ea.horizontal);md.Fxb(C,xc.a.kQh+" "+pf.a.Fya,null===ea||void 0===ea?void 0:ea.vertical);md.Fxb(C,xc.a.hQh+" "+pf.a.Fya,null===ea||void 0===ea?void 0:ea.horizontal);md.Fxb(C,xc.a.jQh+" "+pf.a.Fya,null===ea||void 0===ea?void 0:ea.vertical);md.Fxb(C,pf.a.iQh)}static Fxb(C,ea,Ta){const Yb=document.createElement("div");Yb.className=ea;Ta&&(Yb.style.backgroundImage=`url("${Ta}")`);C.appendChild(Yb)}}Object(m.a)(md,"SelectionCutCopyBehavior",gc,[]);class Ld extends gc{constructor(C){super(C);
appChrome.renderSpinner(C)}}Object(m.a)(Ld,"SelectionPasteBehavior",gc,[]);class oe extends gc{constructor(C,ea){super(C);oe.Xxb(C,xc.a.BQh+" "+pf.a.Fya,null===ea||void 0===ea?void 0:ea.horizontal);oe.Xxb(C,xc.a.AQh+" "+pf.a.Fya,null===ea||void 0===ea?void 0:ea.vertical);oe.Xxb(C,xc.a.xQh+" "+pf.a.Fya,null===ea||void 0===ea?void 0:ea.horizontal);oe.Xxb(C,xc.a.zQh+" "+pf.a.Fya,null===ea||void 0===ea?void 0:ea.vertical);oe.Xxb(C,pf.a.yQh)}static Xxb(C,ea,Ta){const Yb=document.createElement("div");Yb.className=
ea;Ta&&(Yb.style.backgroundImage=`url("${Ta}")`);C.appendChild(Yb)}}Object(m.a)(oe,"SelectionRangePickerBehavior",gc,[]);class Qe extends xg{constructor(C,ea,Ta,Yb){super(C,ea,Ta,Yb)}get X8(){return 0}get sib(){return this.gridView.ga.ra.Ef}oXa(){const C=this.gridView.Al||this.gridView.Kd;return this.gridView.ga.ra.Zj&&!C&&super.oXa()}}Object(m.a)(Qe,"SelectionTouchGrippiesBehavior",xg,[]);let cf=class extends aa.a{constructor(C,ea){super();this.Gub=(Ta,Yb)=>{Ta=Yb.X8;const wc=this.gridView;Yb=Yb.fti;
const Hc=Yb.zh,rd=Yb.c1;switch(Ta){case 24:Yb.c1.push(new da(Hc,Yb));break;case 0:Yb.c1.push(new ei(Hc,wc));Z.a.Xr||(rd.push(new ki(Hc,this.gridView.$,Yb.paneType,this.gg,this.Mr)),rd.push(new ai(Hc,this.gridView.$,Yb.paneType,this.gg,this.Mr)));rd.push(new Qe(Yb,Hc,wc,Yb.paneType));break;case 3:rd.push(new ng(Hc));Z.a.Xr||(rd.push(new Uf(Hc,this.gridView.$,Yb.paneType,this.CI,this.Mr,Yb)),rd.push(new Sc(Hc,this.gridView,this.CI,this.Mr,Yb)),rd.push(new wd(Hc,this.gridView,this.CI,this.Mr,Yb)));break;
case 4:case 5:rd.push(new md(Hc,this.$Ce));break;case 30:rd.push(new Ld(Hc));break;case 16:rd.push(new oe(Hc,this.$Ce));rd.push(new Ha(Yb,Hc,wc,Yb.paneType));break;case 11:case 12:rd.push(new Fb(Hc,11===Ta));break;case 17:rd.push(new ng(Hc));break;case 19:rd.push(new ng(Hc)),rd.push(new lh(Yb,Hc,wc,Yb.paneType))}Yb.E8b=!0};this.$=C;this.gridView=R.h(C);this.gg=ea;this.CI=new gi(this.gridView);this.Mr=new V(this.gridView);this.gridView.ee&&(this.gridView.ee.j_g(this.Gub),this.gridView.ee.update(!1));
cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightsBehaviorManager",!1)||C.ia.Va(64,this)}get $Ce(){cb.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&!this.ZCe&&(this.ZCe={vertical:W.a.current.Jq(103),horizontal:W.a.current.Jq(104)});return this.ZCe}dispose(){this.gridView.ee.zDj(this.Gub);this.CI&&(this.CI.dispose(),this.CI=null);super.dispose()}};cf=Object(Oe.a)([Object(Ad.d)(Ub.Hb),Object(Oe.b)(0,Object(Ub.fb)()),Object(Oe.b)(1,Object(Ub.pd)())],
cf);Object(m.a)(cf,"GridHighlightsBehaviorManager",aa.a,[]);class sf extends ya.a{constructor(C){super();this.$=C;this.Oe()}create(){void Ad.a.resolve(Ub.pd,{Oa:this.$a}).then(C=>{this.ve(this.$.ia.Ja(64)||new cf(this.$,C))})}static la(C){C.ia.Va(149,new sf(C))}}Object(m.a)(sf,"GridHighlightsBehaviorManagerFactory",ya.a,[]);var wf=a(125),Gf=a(566);class ld{constructor(){this.TNc={}}fUg(C){this.TNc[C.id.toString()]=C}p2i(C){const ea=this.TNc;for(const Ta in ea)ea[Ta].notify(C,!1);this.TNc={}}ysj(C,
ea){ea&&this.fUg(ea);return this.eSf(C,ea)}xhd(C){this.p2i(C)}OYe(C,ea){C.notify(ea,!0)}}Object(m.a)(ld,"AEventEmitter",null,[685]);var de;(function(C){C[C.ayk=0]="notStarted";C[C.waiting=1]="waiting";C[C.Tha=2]="shouldRetry";C[C.complete=3]="complete"})(de||(de={}));Object(m.b)("EventResultState",de);class ug{constructor(){this._state=0}get state(){return this._state}set state(C){n.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:de[this._state],["NewState"]:de[C]},
"ResultType",this.pff());this._state=C}}Object(m.a)(ug,"AEventResult",null,[845]);class Zf extends ug{constructor(){super();this.v0c=this.Cqb=null;this.state=0;this.rUc=this.Zje=!1}get gV(){return this.Cqb}get wsa(){return this.v0c}get Zzi(){return this.Zje}pff(){return"GetMoreInfo Result"}}Object(m.a)(Zf,"GetMoreInfoResult",ug,[844,845]);var ag=a(715),Rf=a(387),Cg=a(668),Yg=a(588);class Ng{constructor(C,ea,Ta,Yb,wc,Hc,rd,ce){this.openUrlInNewTab=(Le,Ue,mf,rf,Of)=>{Of&&Of.MenuItemId&&(n.ULS.sendTraceTag(5849678,
202,50,"Opening new tab {0}",{["Id"]:Of.SourceControlId,["AppType"]:Yg.a[this.JQ]}),uc.a.rh(Of.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};this.YTa=(Le,Ue,mf,rf,Of)=>{if(Of&&Of.MenuItemId){const Ag=J.AFrameworkApplication.da.na("WacInTabOpenMRUIsEnabledForUiHost"),tg=J.AFrameworkApplication.da.na("UiHostSupportsDocRebootFeatures");n.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Ag,tg);if(Ag&&
tg){n.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:Of.SourceControlId,["AppType"]:Yg.a[this.JQ]});Le=Of.MenuItemId.toString();const mg={};mg[Rf.a.$Ua]="1";mg[Rf.a.documentUrl]=Le;mg[Rf.a.reason]=Cg.a.open;n.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");J.AFrameworkApplication.xN().execute(O=>{O.sendMessage(gf.a.S1,mg)})}else this.openUrlInNewTab(Le,Ue,mf,rf,Of)}return 32};this.qec=()=>{this.ZBf();return 32};this.Na=C;this.kj=ea;this.zFg=
Ta;this.y5=Yb;this.Bg=wc;this.USc=Hc;this.nKg=rd;this.l4b=ce}syj(){this.Xdb.xe(Ga.a.openUrlInNewTab,dc.a.frame,this.openUrlInNewTab);this.Xdb.xe(Ga.a.YTa,dc.a.frame,this.YTa);J.AFrameworkApplication.RP?this.ZBf():this.Xdb.uh(Ga.a.qec,dc.a.frame,this.qec,96)}Ufa(C,ea,Ta){Ta=void 0===Ta?"":Ta;if(ea&&ea.sI){const Yb=ag.a[ea.status];ea=ea.sI.getTime();const wc=this.pz()-ea;n.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:C,["RequestStatus"]:Yb,["ElapsedMs"]:wc,["StartTime"]:ea,
["Notes"]:Ta})}else n.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:C})}ZBf(){var C=J.AFrameworkApplication.da.na("QPGVCI"),ea=H.a.Ew(document.URL,"wdNewAndOpenCt",C);if(ea){ea=parseInt(ea);var Ta=H.a.Ew(document.URL,"wdPreviousSession",C);C=H.a.Ew(document.URL,"wdPreviousCorrelation",C);var Yb=J.AFrameworkApplication.da.na("NAOPLP");if(J.AFrameworkApplication.RP){var wc=J.AFrameworkApplication.RP.getTime();!ea||ea>wc?n.ULS.sendTraceTag(5849682,
202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:ea,["DocumentLoadedTime"]:wc,["SessionId"]:Ta,["Correlation"]:C}):n.ULS.sendTraceTag(5849683,202,Yb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:wc-ea,["ClickTimestamp"]:ea,["SessionId"]:Ta,["Correlation"]:C})}else n.ULS.sendTraceTag(5849681,202,Yb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:ea,["SessionId"]:Ta,["Correlation"]:C})}}get Xdb(){return this.Na.value}get oLb(){return this.kj.value}get NHf(){return this.zFg.value}get JQ(){return this.y5.value}get kvc(){return this.Bg.value}get pz(){return this.USc}get nZ(){return this.nKg.value}get supportsGetMoreInfoForPersonalStorage(){return this.l4b.value}static get instance(){return Ng.La||(Ng.La=Ng.cQ())}static cQ(){return new Ng(new Gf.a(()=>J.AFrameworkApplication.Vd),new Gf.a(()=>J.AFrameworkApplication.Wf),new Gf.a(()=>
J.AFrameworkApplication.sa),new Gf.a(()=>J.AFrameworkApplication.sa.Sa.Hj),new Gf.a(()=>J.AFrameworkApplication.Pj),()=>(new Date).getTime(),new Gf.a(()=>J.AFrameworkApplication.sa.Sa.nZ),new Gf.a(()=>J.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}Ng.La=null;Object(m.a)(Ng,"NewAndOpenCommonHelpers",null,[684]);var Zg=a(114);class Zh{constructor(C,ea,Ta){this.v3b=this.tl=null;this.MZc=0;this.jQg=C;this.Bg=ea;this.jge=Ta}x2g(){this.MZc=this.Uhb+1}wWd(C){this.tl&&(this.Bg.Rr(this.tl),
this.tl=null);C&&(this.MZc=0)}g8j(C){const ea=this.Fck;0<=ea?(this.x2g(),this.wWd(!1),this.tl=new Zg.a(4,1,ea,C,107),this.Bg.Xh(this.tl)):(this.wWd(!0),n.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.jge}))}get Uhb(){return this.MZc}get Fck(){return this.Uhb>=this.idg.length?-1:this.idg[this.Uhb]}get idg(){if(!this.v3b){const C=(this.jQg.value||"0").split(",");this.v3b=[];for(let ea=0;ea<C.length;ea++){const Ta=parseInt(C[ea]);isNaN(Ta)?n.ULS.sendTraceTag(5849677,202,15,
"Retry interval list contains non-number element {0}",{["Action"]:this.jge,["Entry"]:C[ea]}):Array.add(this.v3b,Ta)}}return this.v3b}}Object(m.a)(Zh,"RetryHelper",null,[]);class Vg extends ld{constructor(C,ea){super();this.i6=C;this.brb=new Zh(ea,this.QKb.kvc,"GetMoreInfo");this.Fr=new Zf}iXi(){this.IGd("Document opened")}rsh(C){return()=>{this.IGd(C,!0)}}eSf(C,ea){ea=void 0===ea?null:ea;n.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:C});3===this.Fr.state?
(ea&&this.OYe(ea,this.Fr),n.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:C})):this.IGd(C);return this.Fr}IGd(C,ea){this.brb.wWd(!(void 0===ea?0:ea));1===this.Fr.state?n.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:C,["RetryIndex"]:this.brb.Uhb}):(n.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:C,["RetryIndex"]:this.brb.Uhb}),this.Fr.state=1,ea=String.format("{0}GetMoreInfoHandler.ashx?{1}",
this.QKb.nZ,J.AFrameworkApplication.fl),this.QKb.oLb.I6(ea,1,null,null,[Vg.vqe,Vg.zue],!1,5,this.urh(),this.trh(C),null))}urh(){return C=>{var ea=!1;let Ta=!1;var Yb=!1,wc;if(J.AFrameworkApplication.da.na("GetMoreInfoDataFromResponseBody"))if(C.data.Fg){let Hc=ca.d(C.data.Fg);({Ft:wc}=Hc);Hc.returnValue?wc?(Yb=!0,this.Fr.v0c=wc.StorageServiceDisplayName,this.Fr.Cqb=Vg.rxf(wc.PersonalFileStorageUrl)?wc.PersonalFileStorageUrl:"",""===this.Fr.gV&&"SharePointOnlineConsumer"===J.AFrameworkApplication.da.Ra("FileSource")&&
(this.Fr.Cqb=H.a.p4(J.AFrameworkApplication.breadcrumbFolderUrl)),ea=""===this.Fr.gV&&""!==this.Fr.wsa):n.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):n.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else n.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");
Yb||((wc=C.data.responseHeaders)?(this.Fr.v0c=(wc[Vg.zue]||"").toString(),ea=(wc[Vg.vqe]||"").toString(),this.Fr.Cqb=Vg.rxf(ea)?ea:"",""===this.Fr.gV&&"SharePointOnlineConsumer"===J.AFrameworkApplication.da.Ra("FileSource")?(this.Fr.Cqb=H.a.p4(J.AFrameworkApplication.breadcrumbFolderUrl),ea=""===this.Fr.gV&&""!==this.Fr.wsa):ea=""===ea&&""!==this.Fr.wsa):(n.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Ta=!0));Yb=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.brb.Uhb,Ta,ea,Yb);this.QKb.Ufa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",C.data,Yb);this.zdg(3,ea,Ta)}}trh(C){return ea=>{this.QKb.Ufa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",ea.data,"Failure");this.zdg(2);this.brb.g8j(this.rsh(C))}}zdg(C,ea,Ta){this.Fr.state=C;this.Fr.Zje=void 0===ea?!1:ea;this.Fr.rUc=void 0===Ta?!1:Ta;this.xhd(this.Fr)}get QKb(){return this.i6.value}static get instance(){return Vg.La||(Vg.La=Vg.cQ())}static cQ(){return new Vg(new Gf.a(()=>
Ng.instance),new Gf.a(()=>J.AFrameworkApplication.Pbi))}static rxf(C){if(!C)return n.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(ob.a.rn(C).startsWith("https://"))return!0;n.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Vg.vqe="PersonalFileStorageUrl";Vg.zue="StorageServiceDisplayName";Vg.La=null;Object(m.a)(Vg,"GetMoreInfoActor",ld,[]);class di{constructor(C,ea,Ta,Yb,wc){this.TKg=6E4;this.xnf="inactive";
this.lxe="active";this.tS=!0;this.Bg=C;this.VJg=ea;this.USc=Ta;this.B4b=Yb;this.$b=new kd.a;wc&&this.Y7j();this.fme=this.Kcf()}cye(C){this.$b.addHandler(this.lxe,C)}NWg(C){this.$b.addHandler(this.xnf,C)}Y7j(){const C=new Zg.a(5,2,this.TKg,Object(wf.a)(this,this.Fui,"inactiveLoop"),108);this.Gui.Xh(C)}Fui(){const C=this.Kcf(),ea=this.pz()-C;ea>this.DJc&&this.tS&&(n.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:ea}),this.tS=!1,this.$b.raiseEvent(this.xnf));C-this.fme>
this.DJc&&(this.tS=!0,this.$b.raiseEvent(this.lxe));this.fme=C}get Gui(){return this.Bg.value}get Kcf(){return this.VJg}get pz(){return this.USc}get DJc(){return this.B4b.value}static get instance(){return di.La||(di.La=di.cQ())}static cQ(){return new di(new Gf.a(()=>Re.a.instance),()=>J.AFrameworkApplication.IDd.getTime(),()=>(new Date).getTime(),new Gf.a(()=>J.AFrameworkApplication.DJc),!0)}}di.La=null;Object(m.a)(di,"InactivityManager",null,[]);var Uh=a(970);class Wi extends ug{constructor(){super();
this.roe=this.toe=this.soe=null;this.state=this.qve=0;this.rUc=!1}get cId(){return this.soe}get UGf(){return this.toe}get bId(){return this.roe}get Kck(){return this.qve}pff(){return"MruActor Result"}}Object(m.a)(Wi,"MruResult",ug,[846,845]);class qg{constructor(C,ea,Ta){this.task=null;this.Kwi=C;this.ZYi=ea;this.SG=Ta;this.retryCount=this.CFb=0;this.YYc=this.TIb=null}kJi(C,ea){return C===N.a.Pld||20===ea||18===ea||3===ea}CKi(C){return 3===C||5===C||6===C||7===C||9===C||10===C||11===C||12===C||13===
C||14===C||15===C||16===C||23===C||26===C||27===C||28===C}get Pzc(){return this.YYc}reset(){this.CFb=this.retryCount=0;this.YYc=this.TIb=null;this.task&&(this.SG.Rr(this.task),this.task=null)}bzi(C,ea,Ta,Yb){this.YYc=String.format("{0}_{1}",Ta,Yb);if(this.retryCount>=this.ZYi)return n.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.kJi(Ta,Yb))return n.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.CKi(Yb)&&1<=this.CFb)return this.TIb=
Ta,!1;ea=Math.max(ea,this.Kwi*Math.pow(2,this.CFb));if(26===Yb)ea=Math.max(ea,3E4);else if(27===Yb||28===Yb)ea=Math.max(ea,6E4);9===Yb||412===Ta&&(null==this.TIb||412!==this.TIb)?ea=500:this.CFb+=1;this.TIb=Ta;this.retryCount+=1;this.task&&this.SG.Rr(this.task);n.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",ea);this.task=new Zg.a(2,1,ea,C,107);this.SG.Xh(this.task);return!0}}Object(m.a)(qg,"RetryManager",null,[]);class wh{constructor(){this.mruItemId=this.app=this.documentExt=
this.documentName=this.folderName=this.documentUrl=null}}Object(m.a)(wh,"WriteOptions",null,[]);class ii extends ld{constructor(C,ea,Ta,Yb,wc,Hc,rd){super();this.Ssk=ce=>{this.Ejf(ce.data)};this.Svh=ce=>{if(ce.data.httpStatus===N.a.e6a)this.Ejf(ce.data);else{var Le=ce.data.httpStatus===N.a.mOb,Ue=Ea.a.mu();this.Rjf(this.Tva,ce,this.Dvh(),Ue);Ue&&(Ue.set("StatusCode",ce.data.httpStatus.toString()),Le||this.l3c(ce.data,Ue));I.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",
ce.data.httpStatus),Le,!1,Object.assign(new Oa.a,{extendedProperties:Ue}))}};this.$bi=ce=>{this.rdf(ce)};this.Zbi=ce=>{this.rdf(ce,!0)};this.Wbi=ce=>{this.qdf(ce)};this.Vbi=ce=>{this.qdf(ce,!0)};this.i6=C;this.RMg=ea;this.pva=new qg(J.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),J.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.Oz.kvc);this.Tva=new qg(J.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),J.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.Oz.kvc);this.iPg=Ta;this.Iwe=Yb;this.yTg={};this.xW=new Wi;this.RJg=wc;this.F1b="";this.Wy=Hc;this.ohe=rd;this.jPg=J.AFrameworkApplication.da.eg("WordRecentLinksCount",25)}get ZMc(){return this.yTg}sAj(){this.Oz.Xdb.xe(Ga.a.renameMostRecentlyUsedFileEntry,dc.a.frame,Object(wf.a)(this,this.NFj,"renameMruEntry"))}NFj(){return this.Jae("Rename")}sXi(){this.REf("File Opened")}tXi(){this.REf("IntervalUpdate")}REf(C){n.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:C});this.Jae(C)}A8(C){(C=ob.a.A8(C))&&C.startsWith(".")&&(C=C.substring(1,C.length));return C}uic(){switch(this.Oz.JQ){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}Oki(C){var ea=this.RJg();if(!ea)return null;const Ta=new wh;Ta.documentUrl=this.ohe.value?encodeURI(ea):ea;Ta.mruItemId=this.F1b;Ta.app=this.uic();if(ea=this.Wy())Ta.folderName=ea.breadcrumbFolderName,
ea=ea.$p,Ta.documentName=ob.a.Ds(ea),Ta.documentExt=this.A8(ea);C&&(Ta.documentName?Ta.documentName.length?255<=Ta.documentName.length?C.set("DocumentNameLength","Long"):2084<=Ta.documentName.length&&C.set("DocumentNameLength","VeryLong"):C.set("DocumentNameLength","0"):C.set("DocumentNameLength","Null"));return JSON.stringify(Ta)}Jae(C,ea){ea=void 0===ea?!1:ea;if(4===this.Oz.JQ&&!J.AFrameworkApplication.eya)return 2;var Ta=Ea.a.mu();Ta&&(Ta.set("Trigger",C),Ta.set("IsRetry",ea?"true":"false"),Ta.set("MruIdSent",
this.F1b?"true":"false"),Ta.set("URLEncoded",this.ohe.value?"true":"false"));I.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",Ta);C=this.Oki(Ta);if(!C)return ea=!J.AFrameworkApplication.webEditingEnabled,Ta&&(Ta.set("WebEditingIsEnabled",J.AFrameworkApplication.webEditingEnabled?"true":"false"),Ta.set("ProtectedFile",J.AFrameworkApplication.bAc?"true":"false")),I.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",ea,!1,Object.assign(new Oa.a,{extendedProperties:Ta})),2;this.Tva&&
!ea&&this.Tva.reset();Ta=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.Oz.nZ,this.localeName);this.Iwe?this.ZMc["X-FileId"]=J.AFrameworkApplication.fl:Ta+=String.format("&{0}",J.AFrameworkApplication.fl);J.AFrameworkApplication.Ge&&(this.ZMc["X-Office-AudienceGroup"]=Object(z.a)(String,J.AFrameworkApplication.Ge.AudienceGroup)||"");this.ZMc["X-Timeout"]=15E3;return this.Oz.oLb.zp(Ta,2,C,this.ZMc,!0,5,this.Ssk,this.Svh,null,void 0,void 0,void 0,void 0,"4")}Ejf(C){const ea=Ea.a.mu();this.Tva&&
(ea&&this.Tva.Pzc&&(ea.set("LastError",this.Tva.Pzc),ea.set("NumRetries",this.Tva.retryCount.toString())),this.Tva.reset());const Ta=Uh.c(C.Fg);Ta&&Ta.diagnostics_data&&(this.F1b=Ta.diagnostics_data.mru_id);C=+C.u1-+C.sI;ea&&ea.set("RequestDuration",C.toString());I.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Oa.a,{extendedProperties:ea}))}Dvh(){return()=>{this.Jae("Retry",!0)}}Ybi(){this.buc("Polling")}Xbi(){this.buc("Retry",!0)}kXi(){this.buc("Open")}jXi(){this.buc("Activity")}buc(C,
ea){ea=void 0===ea?!1:ea;var Ta=void 0===Ta?!1:Ta;n.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:C});const Yb=Ea.a.mu();Yb&&(Yb.set("Trigger",C),Yb.set("IsRetry",ea?"true":"false"),Ta&&Yb.set("RecentLinks","true"));I.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Yb);this.pva&&!ea&&this.pva.reset();Ta?this.iRe(this.Zbi,this.Vbi,!0):this.iRe(this.$bi,this.Wbi)}l3c(C,ea){C&&C.responseHeaders&&(C=C.responseHeaders["X-CorrelationId"])&&ea.set("ServerCorrelationId",C)}YTi(C,
ea){C&&(ea&&ea.set("RequestDuration",(+C.u1-+C.sI).toString()),I.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Oa.a,{extendedProperties:ea})))}rdf(C,ea){ea=void 0===ea?!1:ea;var Ta="";let Yb=null,wc=null,Hc=null;const rd=Uh.c(C.data.Fg);rd&&(Yb=rd.places?rd.places.items:[],wc=rd.documents?rd.documents.items:[],(Hc=Uh.a(rd,ea))&&(Ta=ca.c(Hc)));J.AFrameworkApplication.sa&&J.AFrameworkApplication.sa.Sa.p3&&vf.c()&&!ea&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Ta,!0));
Ta=Ea.a.mu();this.pva&&(Ta&&this.pva.Pzc&&(Ta.set("LastError",this.pva.Pzc),Ta.set("NumRetries",this.pva.retryCount.toString())),this.pva.reset());ea&&Ta&&Ta.set("RecentLinks","true");Hc||Yb||wc?(ea?this.Oz.Ufa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",C.data,"Success"):this.Oz.Ufa("MruActor.GetMruV2FromServerSuccessCallback",C.data,"Success"),this.xLc(3,Hc,Yb,wc),this.YTi(C.data,Ta)):(ea?this.Oz.Ufa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",C.data,"Failure: Invalid JSON"):
this.Oz.Ufa("MruActor.GetMruV2FromServerSuccessCallback",C.data,"Failure: Invalid JSON"),Ta&&this.l3c(C.data,Ta),I.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new Oa.a,{extendedProperties:Ta})),this.xLc(3,null,null,null,!0));this.xhd(this.xW)}Rjf(C,ea,Ta,Yb){let wc=0,Hc=0;const rd=Uh.c(ea.data.Fg);rd&&(null!=rd.response_code&&(wc=rd.response_code,Yb&&Yb.set("MruResponseCode",wc.toString()),9===wc&&(this.F1b="")),rd.error_data&&null!=rd.error_data.retry_after_ms&&
(Hc=rd.error_data.retry_after_ms,Yb&&Yb.set("ExpectedRetryAfter",Hc.toString())));C&&(ea=C.bzi(Ta,Hc,ea.data.httpStatus,wc),Yb&&(Yb.set("CurrentRetryCount",C.retryCount.toString()),Yb.set("RetryScheduled",ea?"true":"false")))}qdf(C,ea){ea=void 0===ea?!1:ea;const Ta=C.data.httpStatus===N.a.mOb,Yb=Ea.a.mu();Yb&&(Yb.set("StatusCode",C.data.httpStatus.toString()),ea&&Yb.set("RecentLinks","true"),Ta||this.l3c(C.data,Yb));ea?this.Oz.Ufa("MruActor.GetMruForRecentLinksFromServerFailureCallback",C.data,"Failure"):
this.Oz.Ufa("MruActor.GetMruFromServerFailureCallback",C.data,"Failure");this.xLc(2);this.Rjf(this.pva,C,Object(wf.a)(this,this.Xbi,"getMruFromServerRetryTask"),Yb);I.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",C.data.httpStatus),Ta,!1,Object.assign(new Oa.a,{extendedProperties:Yb}));this.xhd(this.xW);J.AFrameworkApplication.sa&&J.AFrameworkApplication.sa.Sa.p3&&vf.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),ea||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}xLc(C,ea,Ta,Yb,wc){if(3!==this.xW.state||3===C)this.xW.soe=void 0===ea?null:ea,this.xW.toe=void 0===Ta?null:Ta,this.xW.roe=void 0===Yb?null:Yb,this.xW.state=C,this.xW.rUc=void 0===wc?!1:wc,this.xW.qve=this.Oz.pz()}eSf(C,ea){n.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:C,["ResultState"]:this.xW.state});ea&&3===this.xW.state&&this.OYe(ea,this.xW);return this.xW}iRe(C,ea,Ta){Ta=void 0===Ta?!1:Ta;this.xLc(1);let Yb;const wc={};Yb=Ta?String.format(this.Oz.nZ+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.jPg,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.Oz.nZ+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.uic(),this.localeName);this.iPg.value||(Yb+="&entity=docs");J.AFrameworkApplication.Ge&&(wc["X-Office-AudienceGroup"]=Object(z.a)(String,J.AFrameworkApplication.Ge.AudienceGroup)||"");Ta&&(wc["X-Office-Application"]="147");this.Iwe?wc["X-FileId"]=J.AFrameworkApplication.fl:Yb+=String.format("&{0}",J.AFrameworkApplication.fl);this.Oz.oLb.zp(Yb,1,null,wc,
!0,5,C,ea,null)}get Oz(){return this.i6.value}get localeName(){return this.RMg.value}static get instance(){return ii.La||(ii.La=ii.cQ())}static cQ(){return new ii(new Gf.a(()=>Ng.instance),new Gf.a(()=>cc.a.sN(J.AFrameworkApplication.lcid).name),new Gf.a(()=>J.AFrameworkApplication.sa.Sa.Fy),J.AFrameworkApplication.da.na("MruWriteFileIdInHeader"),()=>J.AFrameworkApplication.sa.Sa.gv,()=>J.AFrameworkApplication.Yo,new Gf.a(()=>J.AFrameworkApplication.da.na("OICEncodeUrlIsEnabled")))}}ii.La=null;Object(m.a)(ii,
"MruActor",ld,[]);class vj{constructor(){this.isb=this.wre=this.Fd=null;this.vp=!1;this.Uyh=()=>{Re.a.instance.Rr(this.WGf)};this.Hye=()=>{Re.a.instance.Xh(this.WGf)}}get name(){return"Common.App.NewAndOpen.Core"}nk(C){this.Fd=C;C.register(684,"Common.INewAndOpenCommonHelpers").Ve().$e(()=>Ng.instance);C.register(685,"Common.IEventEmitter<Common.IGetMoreInfoResult>").Ve().$e(()=>Vg.instance);C.register(685,"Common.IEventEmitter<Common.IMruResult>").Ve().$e(()=>ii.instance)}init(){J.AFrameworkApplication.da.Jw(()=>
{this.kFb()})}kFb(){this.Fd.resolve("Common.INewAndOpenCommonHelpers");this.Fd.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Fd.resolve("Common.IEventEmitter<Common.IMruResult>");var C=!1;Ng.instance.syj();J.AFrameworkApplication.Opa&&(C=!0);J.AFrameworkApplication.X1f&&(ii.instance.kXi(),0<J.AFrameworkApplication.VGf&&this.Hye(),this.eYj(),C=!0);J.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&C&&Vg.instance.iXi();J.AFrameworkApplication.Wlk&&(C=ii.instance,C.sAj(),
C.sXi(),Re.a.instance.Xh(this.Xlk))}eYj(){di.instance.cye(Object(wf.a)(ii.instance,ii.instance.jXi,"makeGetMruRequestActivityTrigger"));di.instance.cye(this.Hye);di.instance.NWg(this.Uyh)}get WGf(){return this.wre||(this.wre=new Zg.a(5,2,J.AFrameworkApplication.VGf,Object(wf.a)(ii.instance,ii.instance.Ybi,"getMruFromServerTask"),109))}get Xlk(){return this.isb||(this.isb=new Zg.a(2,2,6E4*J.AFrameworkApplication.da.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),
Object(wf.a)(ii.instance,ii.instance.tXi,"makeUpdateMruTask"),197))}dispose(){this.vp||(this.vp=!0,this.isb&&(Re.a.instance.Rr(this.isb),this.isb=null))}}Object(m.a)(vj,"CorePackageManager",null,[3,4,5]);var wi=a(808);class mh{constructor(C,ea){this.P_c=this.O_c=null;this.P1a=new Te.a;this.cNb=Ta=>{let Yb=null;Yb&&Yb.length||!Ta||!Ta.data||(Yb=Ta.data.Fg);if(Yb&&Yb.length)try{const wc=ca.a(Yb);this.O_c=wc.NavBarDataJson;n.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");
this.O_c?(()=>{let Hc=ca.d(wc.NavBarDataJson);({Ft:this.P_c}=Hc);return Hc})().returnValue?(this.AUi(this.P_c),this.P1a.setResult(this.P_c)):(n.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:wi.a.Vkb(this.O_c)}),this.P1a.Uw()):(n.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.P1a.Uw())}catch(wc){n.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.P1a.Uw()}else n.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")};
this.oMb=()=>{this.P1a.Uw();n.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")};this.kj=C;this.QJa=ea.appSettings[mh.Qrk]||""}get eZj(){return this.P1a.task}get p7(){return this.kj.value}bIj(){const C={};C[mh.Eqi]=J.AFrameworkApplication.fl;C["Content-Type"]="application/json; charset=utf-8";n.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const ea=H.a.Zm(this.QJa+mh.fZj,mh.M3i,J.AFrameworkApplication.sa.Sa.Hj.toString());
this.p7.zp(ea,1,"",C,!0,2,this.cNb,this.oMb,null,void 0,void 0,void 0,void 0,"20")}AUi(C){try{const ea={};ea.FlightName=C.FlightName;ea.SessionID=C.SessionID;n.ULS.sendTraceTag(594883776,215,50,ca.c(ea))}catch(ea){n.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}static get instance(){return mh.La||(mh.La=mh.ona())}static ona(){return new mh(new Gf.a(()=>J.AFrameworkApplication.Wf),J.AFrameworkApplication.da,J.AFrameworkApplication.sa.Sa.Hj)}}mh.Eqi="X-qs";mh.M3i="at";mh.fZj="O365ShellServiceProxy.ashx";
mh.La=null;mh.Qrk="ShellWebServiceBase";Object(m.a)(mh,"O365ShellActor",null,[601]);class Ri{constructor(){this.Fd=null;this.xE=()=>{J.AFrameworkApplication.useO365ShellService&&J.AFrameworkApplication.sa.Sa.zv&&this.Fd.resolve("Common.App.O365Shell.O365ShellActor").bIj()}}get name(){return"Common.App.O365Shell"}nk(C){this.Fd=C;this.Fd.register(mh,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").Ve().$e(()=>new mh(new Gf.a(()=>J.AFrameworkApplication.Wf),J.AFrameworkApplication.da,
J.AFrameworkApplication.sa.Sa.Hj))}init(){J.AFrameworkApplication.da.Jw(this.xE)}dispose(){}static main(){Ua.a.instance.$k(new Ri)}}Object(m.a)(Ri,"PackageManager",null,[3,4]);var Kg=a(261),Ui=a(669),pi=a(277),ci=a(182),jg=a(87),Fh=a(77),xi=a(586);class Sh extends bb.a{constructor(C,ea){super(C);this.wW=[];this.ame=null;this.ZQb=Ta=>{let Yb="forward";Ta.Values[Rf.a.direction]?Yb=Ta.Values[Rf.a.direction].toLowerCase():n.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");Ta=
0;let wc=!0;"backward"===Yb?(Ta=this.ZCd.length-1,wc=!1):"forward"===Yb?(Ta=0,wc=!0):n.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${Yb}`);this.OGf(wc,Ta,!1)};this.yPf=()=>{this.wW=[]};this.ATa=Ta=>{-411645385===this.$.shortcutKeyManager.Lt(Ta)&&this.ztf()&&(this.$.Ga.Sd(new be.a(-411645385,1,this.$.Ie,6,null),{["event"]:Ta},Ta),Ta.stopPropagation())};this.Zbj=Ta=>{this.kqa(Ta)};this.Pd=ea;this.dw=R.h(this.Pd);this.uf.la("keydown",this.Zbj);this.uf.la("keyup",this.ATa);
pi.a(ea).X0g(this.yPf);jg.a(ea.xa,27)&&fd.TaskExtensions.Aa($c.GetServiceTaskFactory.je(ea.ia,21,137,1),Ta=>{Ta=Ta.result;Ta.yn(gf.a.omf);Ta.tm(gf.a.omf,this.ZQb)},ea.ma)}get $(){return this.Pd}get ZCd(){this.wW.length||(this.wW=this.Fcf());return this.wW}get mpa(){return this.ame}set mpa(C){this.ame=C;this.wW=this.Fcf()}dispose(){this.$&&pi.a(this.$).aFj(this.yPf);this.Pd=null;this.wW.length=0;super.dispose()}drj(C){this.kqa(C)}OGf(C,ea,Ta,Yb){Yb=void 0===Yb?null:Yb;var wc=this.I$j(C,ea,void 0===
Ta?!0:Ta,Yb);if(!wc){Ta=ea;var Hc=C?1:-1,rd=this.ZCd;do{wc=!1;if(jg.a(this.$.xa,27)){if(Ta+=Hc,Ta>=rd.length||0>Ta)wc=!0}else Ta=(Ta+Hc+rd.length)%rd.length;if(wc){this.kWi(C,ea,Yb);break}else if(wc=this.rog(C,ea,Ta,!1,Yb))break}while(Ta!==ea)}}I$j(C,ea,Ta,Yb){Yb=void 0===Yb?null:Yb;let wc=null;0<=ea&&(wc=this.wW[ea]);return(null===wc||void 0===wc?0:wc.uk)&&wc.nl(C,void 0===Ta?!0:Ta)?(Yb&&Fh.g(Yb),n.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${wc.Zg} into a sub region`),
wc.Vn(),!0):!1}rog(C,ea,Ta,Yb,wc){wc=void 0===wc?null:wc;Ta=this.wW[Ta];if(cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const Hc=pi.a(this.Pd).sz(Kg.a.Tya),rd=pi.a(this.Pd).sz(Kg.a.FDb),ce=this.dw.ga.Ta.isFloatingObjectSelected;if(Ta===rd&&ce||Ta===Hc&&!Yb&&!ce)return!1}if((null===Ta||void 0===Ta?0:Ta.uk)&&Ta.nl(C,!1)){wc&&Fh.g(wc);Ta.Vn();if(C=this.wW[ea])C.ap(),n.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${C.Zg} to ${Ta.Zg}`);return!0}return!1}kWi(C,
ea,Ta){(Ta=void 0===Ta?null:Ta)&&Fh.g(Ta);if(ea=this.wW[ea])ea.ap(),n.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${ea.Zg}`);fd.TaskExtensions.Aa($c.GetServiceTaskFactory.je(this.$.ia,21,137,0),Yb=>{Yb.result.sendMessage(gf.a.usb,{[Rf.a.direction]:C?"forward":"backward"})},this.$.ma)}kqa(C){var ea=this.$.isEditMode?ci.a(this.$):null;if(!this.$.Rd.$Aa||Sh.kHi(ea))if(117===C.keyCode&&(C.ctrlKey||Fh.b(C))){ea=this.Lff(C.target);var Ta=!C.shiftKey;n.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${ea}`);
if(cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var Yb=pi.a(this.Pd).sz(Kg.a.eRb);Yb=this.wW.indexOf(Yb);J.AFrameworkApplication.sa.Sa.sB&&this.$.EU&&-1!==Yb&&ea===Yb&&Ui.ShyRibbon.JM(this.$.Ejb,0)}else J.AFrameworkApplication.sa.Sa.sB&&this.$.EU&&1===ea&&Ui.ShyRibbon.JM(this.$.Ejb,0);this.OGf(Ta,ea,!0,C)}else 117!==C.keyCode||Sh.C4e?-411645385===this.$.shortcutKeyManager.Lt(C)?this.ztf()&&(this.$.Ga.Sd(new be.a(-411645385,1,this.$.Ie,6,null),{["event"]:C},C),
C.stopPropagation()):1588554917===this.$.shortcutKeyManager.Lt(C)?0===this.mode?(xi.a(this.$)||this.$.Ga.Sd(new be.a(1588554917,1,this.$.Ie,6,null),{["event"]:C},C),C.preventDefault(),C.stopPropagation()):3===this.mode&&(C.preventDefault(),C.stopPropagation()):-1966746939===this.$.shortcutKeyManager.Lt(C)?(C.preventDefault(),C.stopPropagation()):cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)&&1058684758===this.$.shortcutKeyManager.Lt(C)?(ea=this.Lff(C.target),Yb=
pi.a(this.Pd).sz(Kg.a.eRb),Ta=pi.a(this.Pd).sz(Kg.a.Tya),Yb=this.wW.indexOf(Yb),Ta=this.wW.indexOf(Ta),J.AFrameworkApplication.sa.Sa.sB&&this.$.EU&&-1!==Yb&&ea===Yb&&1===this.$.Ejb&&Ui.ShyRibbon.JM(1,0),-1!==Ta&&ea!==Ta&&this.rog(!0,ea,Ta,!0,C)):cb.EwaSettings.isChangeGateEnabled("OfficeVSO:8198803_AddingScopeToShortcuts")&&1===this.$.shortcutKeyManager.Jhi(C)?(ea=this.$.shortcutKeyManager.Lt(C),n.ULS.sendTraceTag(508342917,0,50,`AccessibilityManager.OnKeyDownHandler : RibbonCommand ${ea} fired in ${this.mode} mode`),
0===this.mode&&(this.$.Ga.Sd(new be.a(ea,1,this.$.Ie,6,null)),C.preventDefault(),C.stopPropagation())):this.coi(C):(C=Ce.a.aC.YU.z1(Fe.a.c8h(),!1),C.image=kc.a.DHb()?3:0,Ce.a.aC.YU.MD(C),Sh.C4e=!0)}Lff(C){const ea=this.ZCd;for(let Ta=0,Yb=ea.length;Ta<Yb;++Ta){const wc=ea[Ta];if(wc&&wc.Il(C))return Ta}return-1}Fcf(){const C=[];for(let ea=0,Ta=this.mpa.length;ea<Ta;ea++){const Yb=pi.a(this.$).sz(this.mpa[ea]);Yb&&C.push(Yb)}return C}ztf(){return 0===this.mode||4===this.mode}static kHi(C){return C?
C.inKeytipMode:!1}}Sh.C4e=!1;Object(m.a)(Sh,"AccessibilityManager",bb.a,[583,5]);var Ai=a(170);let qi=class extends Sh{constructor(C){super(document.documentElement,C);this.rF=0;this.a8g=[Kg.a.FPe,Kg.a.qJd,Kg.a.fmc,Kg.a.J6d,Kg.a.eRb,Kg.a.E8c,Kg.a.amd,Kg.a.vif,Kg.a.K7c,Kg.a.C5d,Kg.a.L5j,Kg.a.FDb,Kg.a.J7e,Kg.a.G9c,Kg.a.Tya,Kg.a.V0d,Kg.a.M9c,Kg.a.Lmg,Kg.a.qAf,Kg.a.d8c];this.Oqk=[Kg.a.fmc,Kg.a.ayg,Kg.a.$xg,Kg.a.byg];this.Eqj=[Kg.a.fmc,Kg.a.EZf,Kg.a.FZf,Kg.a.IZf];this.nfh=[Kg.a.z7e,Kg.a.uif,Kg.a.y7e,Kg.a.w7e,
Kg.a.MTe];this.fqj=[Kg.a.FPe,Kg.a.qJd,Kg.a.E8c,Kg.a.amd,Kg.a.K7c,Kg.a.C5d,Kg.a.FDb,Kg.a.G9c,Kg.a.Tya,Kg.a.V0d,Kg.a.$Yf,Kg.a.M9c,Kg.a.d8c];this.tqj=[Kg.a.FDb,Kg.a.cmd];const ea=gb.a.instance.za(253);this.xTj=this.$.shortcutKeyManager.DCb(ea);this.mode=0;cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateEwaAccessibilityManager",!1)||C.ia.Va(15,this);fd.TaskExtensions.Aa($c.GetServiceTaskFactory.je(C.ia,21,137,1),Ta=>{Ta=Ta.result;Ta.yn(gf.a.usb);Ta.tm(gf.a.usb,this.ZQb)},C.ma)}get mode(){return this.rF}set mode(C){this.rF=
C;switch(C){case 0:this.mpa=this.a8g;break;case 2:this.mpa=this.Oqk;break;case 3:this.mpa=this.Eqj;break;case 4:this.mpa=this.nfh;break;case 5:this.mpa=this.fqj;break;case 6:this.mpa=this.tqj;break;default:n.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}kqa(C){this.$.hg&65536&&super.kqa(C)}coi(C){if(pc.a.equals(this.xTj,this.$.shortcutKeyManager.mpd(C),!1)){const ea=Ai.b(this.$);if(null===ea||void 0===ea?0:ea.uk)Fh.g(C),ea.nl(!0,!1)}}};qi=Object(Oe.a)([Object(Ad.d)(Ub.eb),
Object(Oe.b)(0,Object(Ub.fb)())],qi);Object(m.a)(qi,"EwaAccessibilityManager",Sh,[]);class yh extends ya.a{constructor(C){super();this.$=C;this.Oe()}create(){this.ve(this.$.ia.Ja(15)||new qi(this.$))}static la(C){C.ia.Va(157,new yh(C))}}Object(m.a)(yh,"AccessibilityManagerFactory",ya.a,[]);var li=a(7),Ph=a(130),mi=a(36);let Yi=class extends Ph.a{constructor(C,ea){C=void 0===C?li.a.EWa:C;ea=void 0===ea?li.a.LA:ea;super(C,ea)}execute(C){const ea=Object(z.a)(8,C.Yg);n.ULS.shipAssertTag(537153921,0,te.a.mub(C.errors),
"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");ea.RI(!0,!0);C.activityState[mi.a.F5b]=ea.ea.sessionId;C.activityState[mi.a.Lsb]=!0;C.activityState[mi.a.L5b]=!0;n.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}};Yi=Object(Oe.a)([Object(Ad.d)(Ub.Wc)],Yi);Object(m.a)(Yi,"SessionReloadActivity",Ph.a,[]);class pj extends ya.a{constructor(){super();this.Oe()}create(){this.ve(new Yi(li.a.EWa,li.a.LA))}static la(C){C.ia.Va(142,
new pj)}}Object(m.a)(pj,"SessionReloadActivityFactory",ya.a,[]);var Aj=a(285),Bj=a(53),Cj=a(259),ih=a(132);class Mh extends Ph.a{constructor(C,ea,Ta,Yb,wc){super(C,ea);Mh.yGd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];Mh.xGd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];Mh.CEf=[-1468309555,611268539,-1750576502,61029505,-658377927];Mh.BEf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-658377927,-1337545025];
this.mHc=Ta;this.i5j=Yb;this.$dk=wc}execute(C){var ea=Object(z.a)(8,C.Yg);C.activityState[mi.a.bwa]=!0;var Ta=Mh.Shi(C);if(Mh.DZj(C,Ta))return Mh.$Xi(C),Ta=50,0<C.errors.length&&(Ta=15),n.ULS.sendTraceTag(537153891,0,Ta,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${te.a.Me(C.errors)}`),C.activityState[mi.a.bwa]=!1,this.uj(li.a.idle),3;switch(Ta){case 1:case 3:this.dzi(C,Ta);break;case 2:this.czi(C);break;case 0:C.activityState[mi.a.F2a]=null}n.ULS.sendTraceTag(21837003,
0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${Ta}. activityName:${this.activityName}. NextActivityName:${this.L3}. TimeFromLastStatefulResponse:${ea.ea.x_}.`);var Yb=vc.a.$i(C.activityState,ih.a.Rkb);n.ULS.shipAssertTag(40502925,0,!Yb||Yb&&(1===Ta||3===Ta),`triggerSilentReloadAfterTokenRefresh: ${Yb}, silentReloadType: ${Ta}`);ea=ea.Jn.reloadCount;return 0!==Ta&&0<ea?(Yb=Aj.a.qPa(ea,200),n.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${Ta}] retryNum [${ea}] delayInMs [${Yb}] activityName [${this.activityName}]`),
le.a.instance.create(()=>{Mh.qK(C)},Yb,De.a.aRj),1):3}dzi(C,ea){n.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const Ta=Object(z.a)(8,C.Yg);C.activityState[mi.a.Lsb]=!0;Ta.$nc||Bj.a.instance.vl("ReopenOnLoad");!Mh.isEditMode(C)&&te.a.mub(C.errors)&&(n.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),C.activityState[mi.a.F5b]=Ta.ea.sessionId,C.activityState[mi.a.L5b]=
!0);C.PGd();3===ea?(Ta.ea.pj()||Ta.ea.N2i(),Ta.RI(!0,!0),this.uj(this.$dk),C.activityState[mi.a.Lxe]=Ta.workbookContext.CalcMode):(cb.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===ea&&Ta.RI(!0,!0),C.activityState[mi.a.V2c]=!1,this.uj(this.mHc))}czi(C){n.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");C.activityState[mi.a.F2a]=null;C.PGd();this.uj(this.i5j);C=Object(z.a)(8,C.Yg);C.$nc||(Bj.a.instance.vl("RefreshOnLoad"),
C.BQb())}static qK(C){C.qK()}static Shi(C){const ea=Object(z.a)(8,C.Yg),Ta=ea.ea,Yb=Mh.isEditMode(C);var wc=te.a.Jj(C.errors,Yb?Mh.xGd:Mh.yGd);const Hc=te.a.Jj(C.errors,Yb?Mh.BEf:Mh.CEf),rd=ea.sU,ce=ea.Jn.reloadCount,Le=ea.xa.MaxConsecutiveSilentReloadAllowed,Ue=ea.Jn.Lkf(),mf=te.a.Me(C.errors),rf=te.a.Me(C.DDa),Of=0<te.a.YP(O=>!O.triggerSilentReopenOnly,C.errors).length;let Ag=wc;const tg=vc.a.$i(C.activityState,ih.a.Rkb);tg&&(Ag=!0);const mg={name:"SessionReloadSilentActivity.GetSilentReloadType"};
mg.editMode=Yb;mg.isSilentReopenError=wc;mg.isSilentRefreshError=Hc;mg.reloadSequenceCount=ea.Jn.qVa;mg.reloadCount=ce;mg.maxReloads=Le;mg.stopSilentReloads=Ue;mg.errorNames=mf;mg.processedErrorNames=rf;mg.isClientDirty=rd;mg.errorsForSilentReopenOnly=Of;mg.triggerSilentReloadAfterTokenRefresh=tg;mg.IsReopenDisabled=ea.xRa;wc=na.a.ff(mg);n.ULS.sendTraceTag(21837004,0,50,wc);if(!Ue){if(Ag&&(Yb?Mh.uZj(C):Mh.wZj(C)))return Cj.a.Phg(C,ea)?3:ea.xRa?2:1;if(Hc&&(Yb||!Ta.Ogb))return 2}return 0}static DZj(C,
ea){for(const Ta of C.errors)if(-1337545025===Ta.MessageId||-238814601===Ta.MessageId)return!1;return te.a.YP(Ta=>!Ta.triggerSilentReopenOnly,C.errors).length?3!==ea:!1}static $Xi(C){const ea=te.a.YP(Ta=>!Ta.triggerSilentReopenOnly,C.errors);for(const Ta of ea)C.aga(Ta)}static isEditMode(C){const ea=Object(z.a)(8,C.Yg);return ea.ea.Ee?ea.Ks&&!!(ea.hg&64):vc.a.$i(C.activityState,mi.a.Wu)}static wZj(C){const ea=Object(z.a)(8,C.Yg),Ta=te.a.j8(C.errors,Mh.yGd);if(me.b(Ta,Yb=>Yb.ForceVersionUpgrade))return!1;
C=te.a.mub(C.errors);return!ea.ea.Ogb||C?!0:!1}static uZj(C){C=te.a.j8(C.errors,Mh.xGd);return!me.b(C,ea=>ea.ForceVersionUpgrade)}}Mh.yGd=null;Mh.xGd=null;Mh.CEf=null;Mh.BEf=null;Object(m.a)(Mh,"SessionReloadSilentActivity",Ph.a,[]);class mj extends ya.a{constructor(C,ea){super();this.activityName=C;this.aN=ea;this.Oe()}create(){this.ve(new Mh(this.activityName,this.aN,li.a.LA,li.a.Yk,li.a.MVb))}static la(C){C.ia.Va(143,new mj(li.a.Rra,li.a.Qub));C.ia.Va(144,new mj(li.a.TEc,li.a.ZTa));C.ia.Va(145,
new mj(li.a.UEc,li.a.iNd));C.ia.Va(154,new mj(li.a.Eib,li.a.dS))}}Object(m.a)(mj,"SessionReloadSilentActivityFactory",ya.a,[]);var Bi=a(487),Gj=a(533),Ni=a(184),qj=a(191);class fj extends bb.a{constructor(C,ea,Ta,Yb){super(C);this.Hog=[6];this.Dog=[26];this.zt=null;this.kHb=this.qrc=!1;this.xv=this.Oea=null;this.onPointerDown=wc=>{if(1!==this.$.Ga.FK())return!0;wc=Y.a(this.$).Xg(wc);if(this.rE)return!0;var Hc=Pi.a(this.$).qzd||Pi.a(this.$).Wr();if(this.lBd||Hc)return this.Ghb(),!0;this.xv=this.Tp;
this.rTd();this.Fud();Hc=2===wc.de&&wc.Oq===Sys.UI.MouseButton.leftButton;const rd=3===wc.de;if(Hc||rd)wc=this.ga.Us(wc.clientPoint,wc.Be,5,void 0,void 0,!0),wc||(wc=this.xv),this.kHb=Hc,this.qrc=rd,this.xv=this.shf(wc),this.Fud(),Hc?this.rzj():rd&&this.iAj(),fh.b(this.$,!0);return!0};this.fm=wc=>{wc=Y.a(this.$).Xg(wc);if(!this.rE)return!1;let Hc=this.kHb?this.ga.Us(wc.clientPoint,wc.Be,5,void 0,void 0,!0):this.ga.Us(wc.clientPoint,wc.Be,5,!0,!1,!0);Hc||(Hc=this.ga.kub(wc.clientPoint,wc.Be,5));Hc&&
(wc=this.shf(this.Itb(Hc)),this.Y8b(wc.bottomRight),this.xv.equals(wc)||(this.xv=wc,this.QPb(!1),this.rTd(!1),this.Fud(!1),this.$si(),this.ee.update(!1)),this.xkk(this.xv));return!0};this.Mj=wc=>{Y.a(this.$).Xg(wc);if(!this.rE)return!1;this.resizeTable();this.Ghb();return!0};this.hNb=wc=>{Y.a(this.$).Xg(wc);if(!this.rE)return n.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.Ghb();return!0};this.yga=wc=>
{Y.a(this.$).Xg(wc);this.Ghb();return!0};this.XKf=()=>{this.rE&&this.Ghb()};this.gridView=ea;this.$=ea.$;this.gg=Yb;this.ga=ea.ga;this.ee=ea.ee;this.parentElement=C;this.mbh();Z.a.Xr||Z.a.i3||Va.a.instance.va(Jc.a.Cf,this.Oea,this.onPointerDown);this.Tp=Ta;this.zVc=this.lBd=!1;this.gg.aZg(this.XKf)}get rE(){return this.kHb||this.qrc}get Gwf(){return this.zVc}dispose(){this.Ghb();this.gg.zCj(this.XKf);this.Gwf||Z.a.Xr||Z.a.i3||Va.a.instance.Ca(Jc.a.Cf,this.Oea,this.onPointerDown);if(this.rE){fh.b(this.$,
!1);try{this.Ry()}catch(C){n.ULS.sendTraceTag(537151236,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${C}`)}}this.parentElement&&this.parentElement.contains(this.Oea)&&this.parentElement.removeChild(this.Oea);this.Oea=this.parentElement=null;super.dispose()}shf(C){const ea=C.bottom-this.Tp.topLeft.bottom-1;return 0<=C.right-this.Tp.topLeft.right+1&&0<=ea&&C.bottom>=this.Tp.top&&C.right>=this.Tp.left?new Ia.Range(this.Tp.top,this.Tp.left,C.bottom,C.right,!1,!1):
this.xv}Fud(C){this.rFc([this.xv],6,void 0===C?!0:C);this.ee.Iu(this.Hog)}QPb(C){C=void 0===C?!0:C;this.ee.cn(this.Hog);this.rFc([null],6,C)}rTd(C){C=void 0===C?!0:C;this.ee.cn(this.Dog);this.rFc([null],26,C)}$si(){var C=!1;C=void 0===C?!0:C;const ea=this.sak();0<ea.length&&(this.rFc(ea,26,C),this.ee.Iu(this.Dog))}sak(){const C=[];this.Tp.contains(this.xv)&&(this.Tp.right!==this.xv.right&&C.push(new Ia.Range(this.Tp.top,this.xv.right+1,this.xv.bottom,this.Tp.right,!1,!1)),this.Tp.bottom!==this.xv.bottom&&
C.push(new Ia.Range(this.xv.bottom+1,this.Tp.left,this.Tp.bottom,this.Tp.right,!1,!1)));return C}resizeTable(){if(!this.xv.equals(this.Tp)){const C=new Ia.Range(this.Tp.top,this.Tp.left,this.xv.bottom,this.xv.right,!1,!1);this.Efk(C);this.lBd=!0}}onKeyDown(C){Y.a(this.$).Xg(C);return!0}VKd(){this.Gwf&&(Z.a.Xr||Z.a.i3||(Va.a.instance.va(Jc.a.Cf,this.Oea,this.onPointerDown),this.Oea.classList.remove("ewr-table-resize-default-cursor"),this.zVc=this.Oea.disabled=!1),this.zVc=!1)}mbh(){const C=document.createElement("div");
C.className="ewr-table-resize-handle";const ea=document.createElement("div");ea.className="ewr-table-resize-fillhandle-higher";const Ta=document.createElement("div");Ta.className="ewr-table-resize-fillhandle-broader";C.appendChild(ea);C.appendChild(Ta);this.Oea=C;this.parentElement.appendChild(this.Oea)}Y8b(C){let ea=60;const Ta=this.xv.contains(C);let Yb=C.top,wc=C.bottom,Hc=C.left,rd=C.right,ce=null;if(Ta){if(this.gridView.yI(this.Tp.topLeft)&&!this.Tp.cFa)return;C.bottom<this.xv.bottom?(Yb=Math.max(1,
wc-2,this.Tp.top),ea=16):(Hc=Math.max(1,rd-2,this.Tp.left),ea=4);wc=Yb;rd=Hc;ce=new Ia.Range(Yb,Hc,Yb,Hc,!1,!1)}else C.right>=this.Tp.right?(rd+=2,ea=8):C.bottom>=this.Tp.bottom&&(wc+=2,ea=32),Yb=wc,Hc=rd,ce=new Ia.Range(wc,rd,wc,rd,!1,!1),ea=16;this.gridView.yI(ce)||(this.zt?this.zt.ep||(this.zt=le.a.instance.create(()=>{this.gridView.uz(ce,ea,"TableResizeBehavior.BringRangeIntoView")},40,De.a.Fog)):this.zt=le.a.instance.create(()=>{this.gridView.uz(ce,ea,"TableResizeBehavior.BringRangeIntoView")},
40,De.a.Fog))}Itb(C){let ea=C;if(this.gridView.Gd.iQ){if(!this.gridView.Zd(C.topLeft)){const Ta=this.gridView.Lm("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.YT,this.xv.top!==C.top?1:2);try{Ta.an=this.xv.top<C.top||this.xv.left<C.left,Ta.Gy(C.topLeft),ea=Ta.$$cu().range}finally{Ta&&Ta.dispose()}}ea.right=ea.left+C.width-1;ea.bottom=ea.top+C.height-1}return ea}rFc(C,ea,Ta){Ta=void 0===Ta?!0:Ta;const Yb=[];for(const wc of C)Yb.push(new Ke.a(wc,nc.d(this.$.pa)));this.ee.jD(Yb,[ea],!0,void 0,
Ta)}rzj(){Va.a.instance.va(Jc.a.Io,document.documentElement,this.fm);for(const C of this.gridView.Rq)Va.a.instance.va(Jc.a.Io,C.domElement,this.fm);Va.a.instance.va(Jc.a.tj,document.documentElement,this.Mj);this.WVe()}iAj(){hc.a.instance.va(Jc.a.wj,document.documentElement,this.fm);for(const C of this.gridView.Rq)hc.a.instance.va(Jc.a.wj,C.domElement,this.fm);hc.a.instance.va(Jc.a.Wg,document.documentElement,this.hNb);this.WVe()}Ry(){this.kHb&&this.Kik();this.qrc&&this.Vik()}Kik(){Va.a.instance.Ca(Jc.a.Io,
document.documentElement,this.fm);for(const C of this.gridView.Rq)Va.a.instance.Ca(Jc.a.Io,C.domElement,this.fm);Va.a.instance.Ca(Jc.a.tj,document.documentElement,this.Mj);this.V2f()}Vik(){hc.a.instance.Ca(Jc.a.wj,document.documentElement,this.fm);for(const C of this.gridView.Rq)hc.a.instance.Ca(Jc.a.wj,C.domElement,this.fm);hc.a.instance.Ca(Jc.a.Wg,document.documentElement,this.hNb);this.V2f()}WVe(){this.gridView.cellTextEditBox.Uec(!0)}V2f(){this.gridView.cellTextEditBox.Uec(!1)}Efk(C){this.$.rf(-1400250766,
Ma.a.Td,30,{["ResizeTableRange"]:C,["OriginalTableRange"]:this.Tp})}xkk(C){if(!this.Tp.contains(C)){C=this.rak();for(const ea of C)if(this.gg.NBd(ea)){this.gridView.Xj.Fu(Yc.a.c2i);return}}this.gridView.rtl?this.gridView.Xj.Fu(Yc.a.h1i):this.gridView.Xj.Fu(Yc.a.z3i)}Ghb(){if(this.rE){fh.b(this.$,!1);try{this.Ry()}catch(C){n.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${C}`)}}this.zt&&(this.zt.cancel(),this.zt.dispose());this.qrc=this.kHb=
!1;this.QPb();this.rTd();fh.b(this.$,!1);this.gridView.Xj.Fu(Yc.a.H2)}rak(){const C=[];this.Tp.right!==this.xv.right&&C.push(new Ia.Range(this.Tp.top,this.Tp.right+1,this.xv.bottom,this.xv.right,!1,!1));this.Tp.bottom!==this.xv.bottom&&C.push(new Ia.Range(this.Tp.bottom+1,this.Tp.left,this.xv.bottom,this.Tp.right,!1,!1));return C}static createInstance(C,ea,Ta,Yb){if(!ea)return null;const wc=C.ee;wc.jD(Ta,[27],!0);wc.Iu(fj.lak);Ta=wc.JK(27,C.Gd.xk(ea.bottomRight),fj.b7h(ea,Ta)).zh;return new fj(Ta,
C,ea,Yb)}static b7h(C,ea){var Ta;for(let Yb=0;Yb<ea.length;Yb++)if((null===(Ta=ea[Yb])||void 0===Ta?0:Ta.range)&&ea[Yb].range.equals(C))return Yb;return 0}}fj.lak=[27];Object(m.a)(fj,"TableResizeBehavior",bb.a,[]);class Dj{}Dj.sNh="ewa-ttrd-buttonarea";Object(m.a)(Dj,"CssClassNames",null,[]);var gj=a(145),hj=a(146),ij=a(282);class Th extends We.a{constructor(C){super(document.createElement("div"));this.E2c=this.tyd=this.wWf=this.kU=!1;this.NYd=null;this.gh=()=>{we.d(this.$,this.gridView.ga.ra.activeCell)?
(this.DQa=!0,this.Axb(!1)):(this.d3=this.DQa=!1,this.Vtg())};this.Dv=()=>{this.DQa?this.Axb(!0):this.d3=!1};this.k$=()=>{this.E2c=!0;this.DQa&&(this.d3=!1)};this.onContentReady=()=>{this.$.isEditMode?we.d(this.$,this.gridView.ga.ra.activeCell)&&(this.DQa=!0,this.Axb(!1)):this.d3=!1};this.ZU=()=>{this.E2c=!1;this.DQa?this.Axb(!1):this.d3=!1};this.ph=(ea,Ta)=>{this.DQa&&(ea=this.gridView.xfb(Ta.Gf.block.Cg.BlockCachePosition.PaneType).cF(Ta.Gf.hash))&&(ea.JUd(this.ilf),ea.S4c(this.ilf))};this.ilf=()=>
{this.e7f()};this.$=C;this.gridView=R.h(this.$);this.parentElement=this.domElement;this.parentElement.className=Dj.sNh;this.IPa=this.gridView.Qn;this.mld=cb.EwaSettings.isChangeGateEnabled("OfficeVSO:7603637_LocalizeSubtotalOfTotalRow");this.DQa=!0;this.Gxi();this.mld&&this.rvi();this.C6g();this.Axb(!1);n.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get d3(){return this.tyd}set d3(C){this.tyd!==C&&(this.tyd=this.isVisible=C)}get iIb(){return!!(this.$.hg&16)}get IHi(){const C=
this.gridView.ga.ra.activeCell;return C.right===C.maxColumns}get Esb(){const C=this.gridView.Zd(null);return C&&this.gridView.zfa(C.range)?this.Dza(C):(C&&n.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.Izh();this.$=this.gridView=this.parentElement=this.IPa=null;super.dispose()}U4h(C){const ea=this.Xji(this.gridView.Zd(null).range);return ea?this.mld?`=${this.Kgf()}(${C}${this.$.listSeparator}${ea})`:
`=SUBTOTAL(${C},${ea})`:null}Kgf(){var C,ea,Ta;return null!==(Ta=null===(ea=null===(C=this.Hg)||void 0===C?void 0:C.localeInfo)||void 0===ea?void 0:ea.getWorksheetFuncName(344))&&void 0!==Ta?Ta:"SUBTOTAL"}Xji(C){var ea=R.h(this.$).Ud.Di(C);if(!ea)return null;ea=qj.a(ea,!1);ea.right=ea.left=C.left;return ea.toString()}Gxi(){Th.EM={};Th.EM["100"]=gb.a.instance.ha(1105);Th.EM["101"]=gb.a.instance.ha(1108);Th.EM["102"]=gb.a.instance.ha(1107);Th.EM["103"]=gb.a.instance.ha(1112);Th.EM["104"]=gb.a.instance.ha(1109);
Th.EM["105"]=gb.a.instance.ha(1110);Th.EM["109"]=gb.a.instance.ha(1106);Th.EM["107"]=gb.a.instance.ha(1113);Th.EM["110"]=gb.a.instance.ha(1115);Th.EM["111"]=gb.a.instance.ha(1166)}rvi(){void Ad.a.resolve(Ub.r).then(C=>this.Hg=C)}Xkj(){var C=this.gridView.Zd(null);if(C&&(C=C.xz?C.formulaBarText:null))if(this.mld){const ea="="+this.Kgf()+"(",Ta=ea.length;if(C.toUpperCase().startsWith(ea)){if(C=C.substring(Ta,Ta+3),C in Th.EM)return C}else return"111"}else if("=SUBTOTAL("===C.substring(0,10)){if(C=C.substring(10,
13),C in Th.EM)return C}else return"111";return"100"}C6g(){this.gridView.ya.Zu(this.ph);this.gridView.ga.add_activeCellChanged(this.gh);this.gridView.$u(this.onContentReady);this.gridView.cellTextEditBox.Yp(this.k$);this.gridView.cellTextEditBox.yq(this.ZU)}Izh(){this.gridView&&(this.gridView.ga&&(this.gridView.ga.remove_activeCellChanged(this.gh),this.gridView.ya.Tt(this.ph)),this.gridView.Vx(this.onContentReady),this.gridView.cellTextEditBox&&(this.gridView.cellTextEditBox.Qp(this.k$),this.gridView.cellTextEditBox.Pp(this.ZU)),
this.Vtg())}Axb(C){this.Jkk(C);this.iIb&&(this.N9j(),this.Esb?(this.wWf||this.N6g(),this.E2c?this.d3=!1:(this.d3=!0,this.e7f())):(n.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.d3=!1))}e7f(){appChrome.renderTableTotalRowOptions(this.parentElement,Th.EM,Th.EM[this.Xkj()].toString(),Math.round(Y.a(this.$).mk(17)),C=>{n.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${C}`);
let ea={["SelectedOption"]:Th.EM[C],["FunctionKeyCode"]:C,["Location"]:"canvas"};hj.b(this.$).Lf(gj.a.wak,ea,null,!0);if("111"===C)return this.eBi(),!0;if("100"!==C){this.NYd=this.U4h(C);if(!this.NYd)return n.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.IWa(this.NYd)}else this.IWa("");Xf.DOMElementExtensions.setFocus(this.gridView.me.Ha.domElement);return!0})}eBi(){n.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
const C=new be.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ga.Sd(C)}Dza(C){if(!C)return null;var ea=this.gridView.cellTextEditBox.Ha.domElement;var Ta=0<Xf.DOMElementExtensions.getHeight(ea)&&0<Xf.DOMElementExtensions.getWidth(ea)&&0<=ea.offsetTop&&0<=ea.offsetLeft;if(Ta)ea=Xf.DOMElementExtensions.Dza(ea,this.gridView.Qn);else{ea=this.gridView.getCellBounds(C.cell);var Yb=Xf.DOMElementExtensions.getBoundingClientRect(this.gridView.Qn);ea=new Sys.UI.Bounds(ea.x-Yb.x,ea.y-Yb.y,ea.width,ea.height)}if(ea)if(Ta)2<
ea.height&&2<ea.height&&(ea.x+=1,ea.y+=1,ea.height-=2,ea.width-=2);else if(Ta=R.h(this.$).qN(C.cell))Ta=Ta.width,Yb=pc.a.equals(Lg.a.gCb(C.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&Yb&&(ea.x=ea.x+ea.width-Ta),C.fpa&&this.gridView.rtl===Yb&&(ea.width=Ta);else return null;return ea}Jkk(C){var ea=this.Esb;if(ea){var Ta=17>=ea.height?ea.y:ea.y+ea.height-17-2;ea=this.IHi?this.gridView.rtl?ea.x:ea.x+ea.width-(17<ea.height?17:ea.height):this.gridView.rtl?ea.x-(17<ea.height?17:ea.height):ea.x+
ea.width;var Yb=Y.a(this.$).Ina(new Sys.UI.Point(ea,Ta));this.parentElement.style.top=qe.HelperMethods.yf(Yb.y);this.parentElement.style.left=qe.HelperMethods.yf(Yb.x);Y.a(this.$).$Uj(this.parentElement);C&&(this.d3=this.gridView.Erc(new ua.a(ea,Ta)))}else this.d3=!1}N6g(){this.IPa.insertBefore(this.parentElement,this.IPa.firstChild);this.wWf=!0}N9j(){this.kU||(this.gridView.view.fu(this.Dv),this.kU=!0)}Vtg(){this.kU&&this.gridView.view&&(this.gridView.view.Vs(this.Dv),this.kU=!1)}IWa(C){const ea=
this.gridView.me,Ta=this.gridView.Zd(null);Ta&&(C=Object(fc.a)(new ij.a,{Text:C}),this.gridView.setCell(C,Ta.range,0,127,null),ea.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}Th.vak="TableTotalRowDropDownIconButtonId";Th.EM=null;Object(m.a)(Th,"TableTotalRowOptions",We.a,[5]);let nj=class extends Bi.a{constructor(C){super(R.h(C));this.Ivb=this.Y4=this.WIc=this.Gvb=null;this.dDe=!1;this.eme=null;this.AZb=0;this.Ccc=null;this.v8b=()=>{const ea={},Ta=this.Tqd();for(let wc in Ta){const Hc=Ta[wc];
if(!Hc)continue;const rd=this.Vii(Hc);if(rd){if(rd in this.ZJa){var Yb=this.ZJa[rd];if(Yb.rE){Yb.Tp.equals(Hc)||(Yb.Tp=Hc);delete this.ZJa[rd];ea[rd]=Yb;continue}}(Yb=fj.createInstance(R.h(this.$),Hc,this.O1h(),this))?ea[rd]=Yb:n.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${Hc.Cy(!1)}`)}}this.F$b(null,null);this.dYb=ea};this.F$b=()=>{const ea=this.ZJa;for(let wc in ea){var Ta=wc,Yb=ea[wc];Yb&&(Yb.dispose(),delete this.ZJa[Ta])}this.dYb=
{}};this.q1f=()=>{this.F$b(null,null);this.v8b(null,null)};this.onFocus=()=>{this.eme=R.h(this.$).ga.ra.activeCell};this.i$=()=>{this.$.isEditMode&&this.gh(null,null)};this.gh=()=>{!this.dDe&&we.d(this.$,this.gridView.ga.ra.activeCell)&&this.bSi()};this.NC=()=>{this.qFb(1);this.$.ea.to(this.NC)};this.hOb=()=>{this.dDe=!0;this.WIc=new Th(this.$)};this.$=C;this.gridView=R.h(this.$);this.dYb={};this.v8b(null,null);this.$.ta&&this.$.ta.zj(this.q1f);this.C4c(this.v8b);this.$.ea.R0(this.i$);this.gridView.ga.add_activeCellChanged(this.gh);
this.$.isEditMode&&this.gh(null,null)}C4c(C){this.addHandler(Bi.a.Dgb,C)}xUd(C){this.removeHandler(Bi.a.Dgb,C)}aZg(C){this.addHandler("tce",C)}zCj(C){this.removeHandler("tce",C)}get ZJa(){return this.dYb}get dDd(){return this.eme}get TMa(){return this.AZb}get Cq(){const C=R.h(this.$);return C.Ud.Di(C.ga.ra.activeCell,!1)}get aQd(){return this.dDd?R.h(this.$).Ud.Di(this.dDd,!1):null}NBd(C){return!!this.kef(C)}ru(C){return this.kfi(this.Uef(C))}PBb(C){return this.Uef(C)}fAj(C){C?(this.Ivb?this.Ivb!==
C&&(vd.a.Ma(this.Y4),this.Y4=null,this.Ivb=C):this.Ivb=C,this.Y4||(this.Y4=Xd.a.instance.Lg(this.Ivb)),this.Y4.jl("focusin")||this.Y4.la("focusin",this.onFocus)):n.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}Ssf(C,ea){return C?C.doa&&C.top===ea.top:(n.ULS.shipAssertTag(537151244,0,!!C,"autofilterRange can't be null"),!1)}Hna(C){C=this.Gvb?ab.J(C,this.Gvb):this.view.getRangeInformation(C);return 0<C.length&&Object(Ei.a)(Ki.PivotTableRange,
C[0])?C[0]:null}MDi(C,ea){return C?!C.Noc&&!!C.MA&&C.MA.If(ea):(n.ULS.shipAssertTag(537151243,0,!!C,"Pivot table can't be null"),!1)}LKi(C,ea){return C?!C.Noc&&!!C.fD&&C.fD.If(ea):(n.ULS.shipAssertTag(537151242,0,!!C,"Pivot table can't be null"),!1)}g6b(C){super.g6b(C);if((C=qe.HelperMethods.vef(C))&&0<C.length){this.Gvb=Array(C.length);for(let ea=0;ea<C.length;ea++)this.Gvb[ea]=Ni.a.XT(C[ea])}}KPb(){super.KPb();this.Gvb=null}Boh(C,ea){let Ta;Ta=!1;if(!C||!ea)return{returnValue:!1,d1:Ta};C=C.clone();
C.right+=1;C.left=C.right;if(!C.tB)return{returnValue:!1,d1:Ta};if(C.top<ea.Gd.Vk){const Yb=C.clone();Yb.bottom>=ea.Gd.Vk&&(Yb.bottom=ea.Gd.Vk-1);if(!(()=>{let wc=this.VPe(Yb,ea);({d1:Ta}=wc);return wc})().returnValue)return{returnValue:!1,d1:Ta}}if(C.bottom>=ea.Gd.Vk){const Yb=C.clone();Yb.top<=ea.Gd.Vk&&(Yb.top=ea.Gd.Vk);if(!(()=>{let wc=this.VPe(Yb,ea);({d1:Ta}=wc);return wc})().returnValue)return{returnValue:!1,d1:Ta}}return{returnValue:!0,d1:Ta}}Gog(C){(C=this.ru(C.topLeft))&&C.toString()in this.ZJa&&
(this.ZJa[C.toString()].lBd=!1)}utj(){this.raiseEvent("tce")}cm(C,ea){if(!this.WIc)return!1;switch(ea){case -569786022:case 541421805:if(this.WIc.d3){const Ta=document.getElementById(Th.vak);Ta&&le.a.instance.create(()=>{Xf.DOMElementExtensions.Lnc(Ta,null)},0,De.a.oak,!0,!0)}return!0;default:return!1}}dispose(){this.F$b(null,null);this.xUd(this.v8b);this.$.ta.dk(this.q1f);this.$.Rp(this.F$b);this.dYb=null;this.$.ea&&this.$.ea.q4(this.i$);this.gridView.ga.remove_activeCellChanged(this.gh);this.WIc=
null;this.Y4&&(vd.a.Ma(this.Y4),this.Y4=null);super.dispose()}pqi(C,ea,Ta,Yb){var wc=this.gridView.Ud.Di(new Ia.Range(ea,Ta,ea,Ta,!1,!1));if(this.Ccc=wc){var Hc=wc.usedRange,rd=C.ctrlKey||Z.a.isMac&&Fh.b(C);wc=!C.shiftKey&&rd;C=C.shiftKey&&!rd;R.h(this.$).ga.selectionType=3;switch(Yb){case 0:this.AZb=0;ea=this.Vdd(C,Hc.top,Ta,Hc.bottom,Ta);this.U_d(ea,wc,C);break;case 1:this.AZb=1;ea=this.Vdd(C,ea,Hc.left,ea,Hc.right);this.U_d(ea,wc,C);break;case 2:this.AZb=2;ea=this.Vdd(C,Hc.top,Hc.left,Hc.bottom,
Hc.right);this.U_d(ea,wc,C);break;default:n.ULS.shipAssertTag(537151240,0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${Yb.toString()}`);return}R.h(this.$).ga.selectionType=3;n.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else n.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}PZj(C){const ea=this.Ccc.usedRange;
return this.avf(C)||1!==this.TMa&&this.avf(new Ia.Range(ea.top,C.left,ea.bottom,C.right,!1,!1))?!0:!1}uRd(C){return C.Autofilters}VPe(C,ea){let Ta;Ta=!1;const Yb=ea.Gd.xk(C),wc=ea.mi(Yb).Rl;if(!wc)return n.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${Yb}`),{returnValue:!1,d1:Ta};if(!wc.Sg(C))return{returnValue:!0,d1:Ta};C=ea.Lm("TableManager.CouldExpandImpl",C,2);try{for(;C.$$mn();){if(C.$$cu().text||C.zo.s$a)return Ta=!0,{returnValue:!1,d1:Ta};if(C.$$cu().bL)return{returnValue:!1,
d1:Ta}}}finally{C&&C.dispose()}return{returnValue:!0,d1:Ta}}kfi(C){if(!C)return null;const ea=new Gj.AutofilterRange(C.top,C.left,C.bottom,C.right,null,null,null,C.id,C.doa);ea.cFa=C.cFa;const Ta=this.gridView.Ud.Di(C,!0);if(!Ta)return null;for(let Yb=0,wc=this.rangeList.length;Yb<wc;Yb++){const Hc=this.rangeList[Yb],rd=this.gridView.Ud.Di(Hc,!0);rd&&rd.name===Ta.name&&Hc!==C&&this.MJi(Hc)&&(ea.union(Hc),Hc.cFa&&(ea.cFa=!0))}return ea}MJi(C){return!!R.h(this.$).Ud.Di(C)}O1h(){const C=[];for(const ea of this.rangeList){const Ta=
new Ke.a(this.ru(ea.topLeft),nc.d(this.$.pa));C.push(Ta)}return C}Tqd(){const C={};for(const ea of this.rangeList){if(!ea)continue;const Ta=this.ru(ea.topLeft);Ta&&(C[Ta.toString()]=this.ru(ea.topLeft))}return C}bSi(){this.$.ea.Gh?this.qFb(0):this.$.ea.el(this.NC)}qFb(C){this.$.LK(ea=>{ea.u8(C).then(this.hOb)})}Vii(C){const ea=this.gridView.Ud.Di(C);return ea?ea.name:C.toString()}U_d(C,ea,Ta){C&&(Ta=Ta?R.h(this.$).ga.ra.activeCell:C.topLeft,ea?this.gridView.ga.updateSelection(C,Ta,0,1):this.gridView.ga.bJ([C],
0,Ta,0))}Vdd(C,ea,Ta,Yb,wc){const Hc=qj.d(this.Ccc),rd=qj.g(this.Ccc),ce=ea+(1!==this.TMa&&Hc?1:0),Le=Yb-(1!==this.TMa&&rd?1:0),Ue=this.gridView.inRangePicker||this.gridView.Al;if(C){var mf=Ue&&!Ke.a.Wbc(this.gridView.ga.rangePicker.gO).length?new Ia.Range(ce,Ta,Le,wc,!1,!1):Ue?this.gridView.ga.rangePicker.activeCell:this.gridView.ga.ra.activeCell;mf=new Ia.Range(mf.top<ce?mf.top:ce,mf.left<Ta?mf.left:Ta,mf.bottom>Le?mf.bottom:Le,mf.right>wc?mf.right:wc,!1,!1)}else mf=new Ia.Range(ce,Ta,Le,wc,!1,
!1);if(1!==this.TMa&&(Hc||rd)&&(!C||C&&this.mbd(mf,ce,Ta,Le,wc))){C=Ue?Ke.a.Wbc(this.gridView.ga.rangePicker.gO):this.gridView.ga.ra.selectedRanges;for(const rf of C)if(this.mbd(rf,ce,Ta,Le,wc)){mf.top=ea;mf.bottom=Yb;break}}return mf}avf(C){const ea=this.gridView.inRangePicker||this.gridView.Al?Ke.a.Wbc(this.gridView.ga.rangePicker.gO):this.gridView.ga.ra.selectedRanges;for(const Ta of ea)if(this.mbd(Ta,C.top,C.left,C.bottom,C.right))return!0;return!1}mbd(C,ea,Ta,Yb,wc){return!!C&&C.top===ea&&C.bottom===
Yb&&C.left===Ta&&C.right===wc}};nj=Object(Oe.a)([Object(Ad.d)(Ub.pd),Object(Oe.b)(0,Object(Ub.fb)())],nj);Object(m.a)(nj,"TableManager",Bi.a,[564,5]);let ph=class extends Bi.a{constructor(C){super(Object(R.h)(C))}aii(C){for(const ea of this.rangeList)if(C.range.contains(ea))return ea;return null}uRd(C){return C.GridBlockModel&&(C=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(C.GridBlockModel))?C.getSparklineRanges():null}};ph=Object(Oe.a)([Object(Ad.d)(Ub.md),Object(Oe.b)(0,Object(Ub.fb)())],
ph);Object(m.a)(ph,"SparklineManager",Bi.a,[566]);var Zi=a(660),Hi=a(563),Ii=a(1163);class Oi extends Md.a{constructor(C,ea){ea=void 0===ea?!0:ea;super(!1,!1,Oi.ey);this.p1a=null;this.Qhe=!1;this.Xp=[];this.Rk=null;this.N9i=Ta=>{this.pQg&&(this.Rk=this.Bgg(Ta,this.N4b))};this.Zhj=()=>{this.Rk&&this.Rk.eE&&(this.Qhe||(this.Rk.xzj(this.ZKd),this.Qhe=!0),this.Rk.Y4e())};this.ZKd=Ta=>{this.p1a.uploadStatusLabel=Ta;this.aGa(this.titleText,Object(wf.a)(this,this.xnc,"insertDialogHandler"),this.p1a)};this.TMd=
()=>{this.g_f()};this.onKeyDown=Ta=>{4!==Se.FocusManager.instance().j_f(Ta)&&Ta.preventDefault()};this.N4b=C;this.pQg=ea;this.nA=this.Rue=!1;this.rka=null;this.gSc=!1;this.ti=this.CAh;this.Rg="InsertFileDialog";this.Ke(1,this.e5b);Oi.ey?(this.p1a={["id"]:this.Rg,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,["onExecute"]:this.Zhj}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:this.N9i},this.initializeAndShow(this.titleText,Object(wf.a)(this,
this.xnc,"insertDialogHandler"),this.p1a),this.TZb=!0):(this.showDialog(this.titleText,Object(wf.a)(this,this.xnc,"insertDialogHandler")),ea&&this.Cgg(),(C=this.pN(1))&&this.Xp.push(C),(C=this.pN(0))&&this.Xp.push(C),this.wvg(),this.TZb=!1)}get $nk(){return this.N4b}validate(){this.Rk.eE||n.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Rk.eE.value?!0:(Oi.mD(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}xnc(C){1===C&&this.isEnabled()?Oi.ey&&this.Rk.eE&&!this.Rk.eE.value?
(this.p1a.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.aGa(this.titleText,Object(wf.a)(this,this.xnc,"insertDialogHandler"),this.p1a)):(this.z$a(),this.N4b.finalizeUpload(this.Rk,Object(wf.a)(this,this.dispose,"dispose"))):0===C&&this.hide()}Cgg(){this.gSc=!1;this.Rk=this.Bgg(document.getElementById("uploadFrameContainer"),this.N4b);J.AFrameworkApplication.da.na("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.rka=this.TMd,Rh.a.addHandler(this.Rk.ivd,"load",this.rka));this.Rk.eE||
n.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.g_f()}g_f(){if(this.Rk&&!this.gSc){var C=this.Rk.eE;C&&(Rh.a.addHandler(C,Jc.a.Ne,this.onKeyDown),C=[C],this.Xp=C.concat.apply(C,this.Xp),this.wvg(),this.gSc=!0)}}dispose(){if(this.Rk&&!Oi.ey){const C=this.Rk.eE;C&&Rh.a.removeHandler(C,Jc.a.Ne,this.onKeyDown);this.rka&&Rh.a.removeHandler(this.Rk.ivd,"load",this.rka)}this.Rk=null;super.dispose()}wvg(){if(0<this.Xp.length){const C=new Ii.a(this.Xp),ea=Se.FocusManager.instance().bU();
ea&&(this.Xp[0].focus(),ea.$j=C,ea.T9=!0)}}static get ey(){return J.AFrameworkApplication.sa.Sa.Fy&&J.AFrameworkApplication.sa.Sa.fvf}static mD(C){const ea=document.getElementById("errorText");ea.innerText=C;ea.style.display="inline-block"}}Object(m.a)(Oi,"InsertFileDialog",Md.a,[]);class yi{static get ti(){return Md.a.Gq(yi.Rn,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}yi.Rn="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(m.a)(yi,"InsertImageDialogHtml",null,[]);class sj extends Oi{constructor(C,ea){super(C,void 0===ea?!0:ea)}get e5b(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get CAh(){return yi.ti}validate(){this.Rk.eE||n.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");const C=Object(z.a)(Cb,this.$nk),ea=C.Axg(this.Rk.eE.value);return 0!==ea?(Oi.mD(C.Qaf(ea)),!1):!0}}Object(m.a)(sj,"InsertImageDialog",Oi,[]);var Ci=
a(567),$i=a(1291);class Gh extends $i.a{constructor(C,ea,Ta,Yb,wc,Hc,rd,ce){ce=void 0===ce?!1:ce;super(C,ea,Ta,Yb,wc,"UploadFrame",Hc.ea.sessionId,"image/*",!1,null,void 0===rd?!1:rd);this.$=Hc;this.Owg=!0;this.hDi=ce;this.uwd()}ha(C){return C}Adg(C){n.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");ge.a.Q5c(C,this.$.xa);C.H6(Tb.a.sessionId,this.sessionId);var ea=R.h(this.$).ga;ea=ab.o(ea.ra.r8,this.$);C.H6(Tb.a.rsj,this.$.ta.pa.name);C.H6(Tb.a.qsj,ea.FirstRow.toString());
C.H6(Tb.a.psj,ea.FirstColumn.toString());C.H6(Tb.a.Dzi,this.hDi.toString())}dkf(){this.A9f("ServerUploadError")}VTa(C){this.A9f(C)}static xFi(C){return!C||pc.a.equals(C,"ServerUploadError",!1)}}Object(m.a)(Gh,"UploadFrameWrapper",$i.a,[]);class Hj extends sj{constructor(C,ea,Ta,Yb){super(C,!1);this.bY=null;this.lFa=!1;this.De=null;this.rwc=()=>{this.J8d("");this.IKc();return!1};this.$=ea;this.OLc=C;this.nU=Ci.a.instance;this.da=Ta;this.De=Yb;this.Cgg();this.jwd();this.$.Rd.uB=!0}Bgg(C,ea){return new Gh(C,
Object(wf.a)(ea,ea.UTa,"onUploadFrameInitialized"),Object(wf.a)(ea,ea.eba,"uploadResponseReceived"),this.da,!0,this.$)}dispose(){this.IKc();this.nU=this.OLc=null;super.dispose()}hide(){super.hide();this.$.Rd.uB=!1}validate(){var C=this.OLc.cXb(this.Rk.eE.value,this.OLc.asg(this.Rk));return 0!==C?(C=this.OLc.God(C).Description,this.J8d(C),this.L4d(),!1):!0}isEnabled(){return!0}J8d(C){var ea;null===(ea=this.De)||void 0===ea?void 0:ea.Ceg(this.bY,C)}jwd(){this.bY=document.getElementById("errorText");
this.bY.style.display="inline-block";this.lFa=!1;this.J8d("");this.dNa.style.maxWidth=this.dNa.currentStyle.minWidth}L4d(){this.nU.va(Jc.a.click,this.Rk.eE,this.rwc);this.nU.va(Jc.a.Ne,this.Rk.eE,this.rwc);this.lFa=!0}IKc(){this.lFa&&(this.nU.Ca(Jc.a.click,this.Rk.eE,this.rwc),this.nU.Ca(Jc.a.Ne,this.Rk.eE,this.rwc),this.lFa=!1)}}Object(m.a)(Hj,"InsertImageDialogWrapper",sj,[]);class Fi extends Cb{constructor(C,ea,Ta,Yb,wc){wc=void 0===wc?!0:wc;super(null,ea,Ta);this.Pma=this.jJ=null;this.Kxd=this.ccb=
!1;this.tOd=null;this.eba=Hc=>{this.oae.stop();this.p8b.cancel();if(Gh.xFi(Hc))this.y_?this.bjf(4):(Hc=new Zi.a(0,2,null,null,!1,null,null,null),Hc.status=8,this.l7d(new Hi.a(Hc),null,"InsertPictureWebMethod")),n.ULS.sendTraceTag(526399121,0,50,`Http Error occurred, isTimeoutError: ${this.y_}`);else{const rd=Fi.jqk(Hc);0!==rd?(n.ULS.sendTraceTag(526399122,0,50,`Server returned error, response: ${Hc}`),this.bjf(rd)):this.kqi(Hc)}this.lNb();this.dispose()};this.Y8i=Hc=>{this.Kia(Hc,this.Rk)&&this.finalizeUpload(this.Rk,
null)};this.UTa=Hc=>{n.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");this.Rk=Hc;if(!this.Yxa){if(this.RLc){if(this.kJe()||this.eTa&&Z.a.DC){Hc.fzb(this.Y8i);return}const rd=Hc.fzb(null);if(!this.Kia(rd,Hc))return}this.finalizeUpload(Hc,null)}};this.whj=()=>{this.y_=!0};this.Pd=C;this.oae=C.pe.Fi("WebServiceCall","InsertPictureOperation");this.p8b=le.a.instance.create(this.whj,1E5,De.a.b8g,!1);this.y_=!1;this.kuc=this.$.xa.InsertPictureMaxFileSizeBytes;Yb&&(this.ccb="TestOnly"in Yb);
Yb&&(this.Kxd="IsCellPicture"in Yb);wc&&this.showDialog()}get $(){return this.Pd}get oYi(){return this.kuc/1024/1024}dispose(){vd.a.Ma(this.p8b);this.Rk&&this.Rk.tye();this.Rk=this.p8b=this.Pd=null}Zvj(C){if(!this.$)return n.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),Tc.Task.Ua(!0);if(!this.$.p9)return Tc.Task.Ua(!0);const ea=new Te.a,Ta=new FileReader;C=C.eE.files[0];const Yb=()=>{ea.Qy(!0)};Ta.onload=()=>{this.tOd=Ta.result;ea.Qy(!0)};Ta.onerror=Yb;Ta.onabort=
Yb;Ta.readAsDataURL(C);return ea.task}asg(C){let ea=-1;C=C.eE;(null===C||void 0===C?0:C.files)&&0<C.files.length&&(ea=C.files[0].size);return ea}cXb(C,ea){let Ta=Fi.$nh(Cb.Kia(C));0===Ta?-1!==ea&&(n.ULS.sendTraceTag(526399118,0,50,`Validating picture, pictureSize: ${ea}, maxAllowedSize: ${this.kuc}, remainingWorkbookSize: ${this.$.ea.kzf}`),ea>this.kuc?Ta=3:ea>this.$.ea.kzf&&(Ta=7)):6===Ta&&this.TVi(C);n.ULS.sendTraceTag(526399117,0,50,`Validated file on client, validation result: ${Ta}`);return Ta}Kia(C,
ea){C=this.cXb(C,this.asg(ea));return 0!==C?(this.Yxa||1===C||this.x2d(C),!1):!0}srg(C){C.K9j()}God(C){let ea=0,Ta=1,Yb=-1100324317,wc="InsertPictureUnknownError",Hc=null;switch(C){case 1:ea=1758;Ta=0;Yb=940870981;wc="InsertPictureNoFileSelected";break;case 3:Ta=0;Yb=1250467391;wc="InsertPicturePictureTooBig";Hc=String.format(gb.a.instance.Qd(181),this.oYi.toLocaleString());break;case 6:ea=1762;Ta=0;Yb=1380041209;wc="InsertPictureUnsupportedFormat";break;case 7:ea=1759;Ta=0;Yb=-903115058;wc="InsertPictureExceedWorkbookSize";
break;case 4:ea=1760;Ta=0;Yb=1218352119;wc="InsertPictureUploadTimeout";break;case 5:ea=1761,Ta=0,Yb=1979899005,wc="InsertPictureServiceNonDeterministicError"}C=Fi.Mf(ea,Ta,Yb,wc);Hc&&(C.Description=Hc);return C}showDialog(){if(this.kJe())this.Yxa=!1,this.Rk=new Gh(this.$.domElement,this.UTa,this.eba,this.da,!1,this.$,!0,this.Kxd);else if(n.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.ccb&&(Z.a.qG||Z.a.DC&&72>Z.a.vLe))this.Yxa=!1,this.Rk=new Gh(this.$.domElement,this.UTa,
this.eba,this.da,!1,this.$);else{this.Yxa=!0;const C=Object(ub.d)(Ad.a.resolve(Ub.Mb,{Oa:0}));fd.TaskExtensions.Aa(C,()=>{this.Rk=(new Hj(this,this.$,this.da,C.result)).Rk},this.$.ma,3)}}kqi(C){let ea={};try{if(ea=na.a.kl(C),Nb.b().ND(this.oae.id,ea.ServerCorrelationId,"actions","ServerActions"),!te.a.Ph(ea.Errors)&&ea.Result&&(this.$.ea.E_(ea.StateId,"BasePictureUploaderWrapper.UploadResponseReceived"),!this.Kxd)){const Ta=ea.Result;of.a(this.$).maa(1,Ta);const Yb=cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateValidationTelemetryManager",
!1)?Ad.a.rg(Ub.xd):this.$.ia.Ja(277);Yb&&Yb.t3c(this.$,1,ea.Result,ea,"InsertPicture");n.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(Ta){n.ULS.sendTraceTag(526399113,0,50,`BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: ${C?C.length:-1}, errror: ${Ta}`)}this.gKc(ea,null,"InsertPictureWebMethod")}bjf(C){C=this.God(C);const ea={};ea.Errors=[C];this.gKc(ea,null,"InsertPictureWebMethod")}gKc(C,ea,Ta){this.jJ(C,
ea,Ta)}l7d(C,ea,Ta){this.Pma(C,ea,Ta)}x2d(C){C=this.God(C);cb.EwaSettings.AC()?new Yd.a(this.$,C):(new Kd.ErrorDialog(this.$,C)).Zi()}TVi(C){const ea=this.$.xa.InsertPicturUnsupportedExtensionsForLogging;C=ob.a.rn(C);for(let Ta=0;Ta<ea.length;++Ta)if(C.endsWith(ea[Ta])){n.ULS.sendTraceTag(526399112,0,50,`Insert picture blocked invalid extension: ${ea[Ta]}`);break}}static jqk(C){return!C||pc.a.equals(C,Tb.a.insertPictureUnknownError,!0)?2:pc.a.equals(C,Tb.a.insertPictureNoFileSelectedError,!0)?1:pc.a.equals(C,
Tb.a.Czi,!0)?3:pc.a.equals(C,Tb.a.Fzi,!0)?5:0}static Mf(C,ea,Ta,Yb){return te.a.Mf(1,0,0,C,ea,Ta,Yb)}static $nh(C){switch(C){case 1:return 1;case 2:return 6}return 0}kJe(){return this.ccb||void 0===window.self.FormData||null===window.self.FormData?!1:!0}}Object(m.a)(Fi,"BasePictureUploaderWrapper",Cb,[5]);class Si extends Fi{constructor(C,ea,Ta,Yb,wc,Hc){Hc=void 0===Hc?!0:Hc;super(C,ea,Ta,Yb,!1);this.fUh=wc;this.Qgc=C.pe.Fi("LoadResource","FileReaderUploaderLoadResource");Hc&&this.showDialog()}R2j(){this.kuc=
28E5;this.x2d(3)}Jkd(C){n.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");const ea=new FileReader;C=C.eE.files;if(0==C.length)n.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var Ta=C[0];ea.onload=()=>{this.Qgc.stop();this.fUh.Sgj(ea.result,this);n.ULS.sendTraceTag(526399109,0,50,`FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:${Ta.type}, Size:${Ta.size.toString()}`)};
ea.onerror=()=>{this.Qgc.stop();n.ULS.sendTraceTag(526399108,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:${Ta.type}, Size:${Ta.size.toString()}`)};ea.onabort=()=>{this.Qgc.stop();n.ULS.sendTraceTag(526399107,0,10,`FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:${Ta.type}, Size:${Ta.size.toString()}`)};this.Qgc.start();ea.readAsDataURL(Ta)}}finalizeUpload(C,ea){this.Jkd(C,ea)}}Object(m.a)(Si,"FileReaderUploaderWrapper",Fi,[582]);class tj{constructor(C,
ea){this.dataUri=this.sheetName=null;this.sheetName=C;this.dataUri=ea}getSheetName(){return this.sheetName}}Object(m.a)(tj,"MacroRecorderPictureInsertedPayload",null,[129]);class uj extends Fi{constructor(C,ea,Ta,Yb,wc,Hc){Hc=void 0===Hc?!0:Hc;super(C,Ta,Yb,wc,!1);this.Yf=ea;Hc&&this.showDialog()}Jkd(C,ea){super.finalizeUpload(C,ea);uf.a(this.$.userOperationManager,(Ta,Yb)=>{this.jJ=Ta;this.Pma=Yb;this.oae.start();this.p8b.Vt();this.y_=!1;this.srg(C);return this.Zvj(C)},Ta=>{const Yb={};this.$.Am(Yb);
const wc=Yb.SheetName;Ta=new ud.a(510,0,Ta,72,()=>new tj(wc,this.tOd?this.tOd:""));Ta.KEa(()=>!0);Ta.Yf=this.Yf;return Ta},this.Yf)}finalizeUpload(C,ea){this.Jkd(C,ea)}}Object(m.a)(uj,"PictureUploaderWrapper",Fi,[]);class aj{constructor(C,ea){this.filename=C;this.blob=ea}}Object(m.a)(aj,"UploadBlobParameters",null,[]);class ri extends uj{constructor(C,ea,Ta,Yb,wc,Hc,rd){super(C,ea,Ta,Yb,wc,!1);this.RLc=!1;this.ZL=rd;this.Qmc=ri.l_h(Hc);C=this.cXb(this.Qmc.name,this.Qmc.size);0!==C?(this.x2d(C),this.ZL.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),
this.dispose()):this.Rk=new Gh(this.$.domElement,this.UTa,this.eba,Yb,!1,this.$)}l7d(C,ea,Ta){super.l7d(C,ea,Ta);this.ZL.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))}gKc(C,ea,Ta){super.gKc(C,ea,Ta);te.a.Ph(C.Errors)?this.ZL.setException(Error.create(`DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: ${te.a.Me(C.Errors)}`)):this.ZL.setResult(!0)}srg(C){const ea=new aj(this.Qmc.name,this.Qmc);C.Eng(ea)}static l_h(C){var ea=
C.split(",");C=ea[0].includes("base64")?window.self.atob(ea[1]):window.self.decodeURI(ea[1]);ea=ea[0].split(":")[1].split(";")[0];const Ta=new Uint8Array(C.length);for(let Yb=0;Yb<C.length;Yb++)Ta[Yb]=C.charCodeAt(Yb);C=new Blob([Ta],{type:ea});C.name="Image.png";return C}}Object(m.a)(ri,"DataUrlUploaderWrapper",uj,[]);let Nh=class{constructor(){}jyi(C,ea,Ta,Yb,wc){-2060689045===ea.command&&(wc.IsCellPicture=!0);new uj(C,ea,Ta,Yb,wc,!0)}hxi(C,ea,Ta,Yb,wc,Hc){new ri(C,null,ea,Ta,Yb,wc,Hc)}sxi(C,ea,
Ta,Yb,wc){new Si(C,ea,Ta,Yb,wc,!0)}};Nh=Object(Oe.a)([Object(Ad.d)(Ub.wd)],Nh);Object(m.a)(Nh,"UploaderCreator",null,[561]);class Xh{constructor(C,ea){this.$=ea;this.ariaLiveNotifier=C}c2f(){const C=this.r2h();this.ariaLiveNotifier.XUa(C,Yc.a.SKa)}r2h(){const C=new Sys.StringBuilder;this.$.workbookContext&&Kf(C,this.$.workbookContext.WorkbookFileName);Kf(C,gb.a.instance.ha(855));Kf(C,this.t2h());Kf(C,this.s2h());Kf(C,gb.a.instance.ha(856));return C.toString()}t2h(){return this.$.isEditMode?gb.a.instance.ha(860):
gb.a.instance.ha(861)}s2h(){var C=this.mrk();const ea=this.$.ta.pa;C=1!==C?String.format(gb.a.instance.Qd(32),C):gb.a.instance.ha(854);C=new Sys.StringBuilder(C);ea&&ea.sheetName&&(C.append(lg.LFd),C.append(String.format(gb.a.instance.Qd(33),ea.sheetName)));return C.toString()}mrk(){let C=0;for(const ea of this.$.ta.items)ea.visible&&C++;return C}}Object(m.a)(Xh,"WorkbookReadout",null,[]);let bj=class{constructor(C,ea){this.tZ=()=>{this.mg||this.UCe()};this.mg=!1;this.H1=ea.BX;this.ariaLiveNotifier=
C;this.Cae=new Xh(C,ea);this.H1&&this.H1.tU?this.UCe():this.Zk()}dispose(){this.Hk();this.ariaLiveNotifier=this.H1=null;this.mg=!0}Zk(){if(this.H1){this.H1.$u(this.tZ);this.H1.ya.wt(this.tZ);this.H1.tH(this.tZ);var C=Object(z.a)(174,this.H1);C&&(C.me.Yp(this.tZ),C.ga.Kr(this.tZ),C.ga.add_activeCellChanged(this.tZ),C.ga.Ta.cK(this.tZ))}else n.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}Hk(){if(this.H1){this.H1.ya.ds(this.tZ);this.H1.XI(this.tZ);
const C=Object(z.a)(174,this.H1);C&&(C.me.Qp(this.tZ),C.ga.es(this.tZ),C.ga.remove_activeCellChanged(this.tZ),C.ga.Ta.pR(this.tZ))}}UCe(){this.Cae.c2f();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.TSj();this.dispose()}};bj=Object(Oe.a)([Object(Ad.d)(Ub.Ad),Object(Oe.b)(0,Object(Ub.g)()),Object(Oe.b)(1,Object(Ub.fb)())],bj);Object(m.a)(bj,"WorkbookReadoutHandler",null,[5]);let jj=class{constructor(C,ea,Ta){this.APf=()=>{this.Cae.c2f();this.ariaLiveNotifier.setEnabled(!0)};this.$=ea;
this.ariaLiveNotifier=C;this.Cae=new Xh(C,ea);this.yhc=Ta.tqd(this.$);this.yhc.D_g(this.APf)}dispose(){this.yhc&&this.yhc.SDj(this.APf);this.yhc=this.ariaLiveNotifier=this.$=null}};jj=Object(Oe.a)([Object(Ad.d)(Ub.cb),Object(Oe.b)(0,Object(Ub.g)()),Object(Oe.b)(1,Object(Ub.fb)()),Object(Oe.b)(2,Object(Ub.Zc)())],jj);Object(m.a)(jj,"EmbeddedWorkbookReadoutHandler",null,[5]);Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Jb.main();Type.registerNamespace("Common.App.InsertFile");
Type.registerNamespace("Common.App.InsertPicture");(()=>{Eb.a.Ia(C=>{Na.la(C)})})();(()=>{Eb.a.Ia(C=>{xe.la(C)})})();(()=>{Eb.a.Ia(C=>{cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateDataFromPictureCommandHandler",!1)||rg.la(C)})})();bg.a.Pk(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
(()=>{Eb.a.Ia(C=>{cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateInsertPictureCommandHandler",!1)||Ih.la(C)})})();Type.registerNamespace("Common.App.GestureManager");Pc.main();Type.registerNamespace("Common.App.AccessibilitySettings");Jg.main();(()=>{Eb.a.Ia(C=>{cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMigrate2AriaLiveNotifier",!1)||zc.la(C);cb.EwaSettings.Xd()?
zd.la(C):Lb.la(C);pg.la(C)})})();bg.a.Pk(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-top-updated{border-top:1px solid transparent;top:-2px;left:-2px;right:-2px;height:calc(3.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-updated{border-top:.75px solid transparent;right:0;left:-2px;bottom:-2px;height:calc(2.5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-updated{border-left:1.25px solid transparent;top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-updated{border-right:1.25px solid transparent;top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-top-enhanced,.ewr-selection-draghandle-reduced .ewr-selection-draghandle-top{height:calc(3px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-reduced .ewr-selection-draghandle-bottom-enhanced,.ewr-selection-draghandle-reduced .ewr-selection-draghandle-bottom{height:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right-enhanced,.ewa-root-ltr .ewr-selection-draghandle-reduced .ewr-selection-draghandle-right{width:calc(3px/var(--zoom-level-canvas,1))}.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left-enhanced,.ewa-root-rtl .ewr-selection-draghandle-reduced .ewr-selection-draghandle-left{width:calc(3px/var(--zoom-level-canvas,1))}.ewr_selection_rearrangeleft{border-left:3px solid #107c41;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #107c41;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #107c41;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #107c41;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#107c41;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}");
(()=>{Eb.a.Ia(C=>{cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightsBehaviorManager",!1)||sf.la(C)});Eb.a.Ia(C=>{cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Migrate2GridHighlightBehaviorEventManager",!1)||Xg.la(C)})})();Type.registerNamespace("Common.App.NewAndOpen.Core");Ua.a.instance.$k(new vj);Type.registerNamespace("Common.App.O365Shell");Ri.main();bg.a.Pk(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
(()=>{Eb.a.Ia(C=>{cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateEwaAccessibilityManager",!1)||yh.la(C)})})();(()=>{Eb.a.Ia(C=>{cb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateSessionReloadActivity",!1)||pj.la(C);mj.la(C)})})();String(c);String(b);String(r);String(v);String(f);String(e);String(h);String(l);String(k);String(u);String(x);String(t);window.___1692616129199_closurehack=c;window.___1692616129199_closurehack=b;window.___1692616129199_closurehack=
r;window.___1692616129199_closurehack=v;window.___1692616129199_closurehack=f;window.___1692616129199_closurehack=e;window.___1692616129199_closurehack=h;window.___1692616129199_closurehack=l;window.___1692616129199_closurehack=k;window.___1692616129199_closurehack=u;window.___1692616129199_closurehack=x;window.___1692616129199_closurehack=t}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.frs.js.map/c77168184ea2566d4d26893ab1f90731/EwaTS.frs.js.map