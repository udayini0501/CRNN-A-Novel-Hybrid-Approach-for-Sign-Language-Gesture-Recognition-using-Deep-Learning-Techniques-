'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[48],{1360:function(w,B,a){function b(pb){const Vb=f(pb),Wa=[];if(0===Vb&&1===pb.length)return Wa.push({destination:pb[0],source:null,qqc:!1}),Wa;for(let ka=0;ka<=Vb;ka++){const Sa=pb.filter(Xb=>Xb.w8().topLeft.Y===ka);for(let Xb=0;Xb+1<Sa.length;Xb+=1)Wa.push({destination:Sa[Xb],source:Sa[Xb+1],qqc:!1})}Q.ULS.sendTraceTag(509658E3,0,50,`GridInstantaneousAction.getBlockPairsInViewport parameter = blockPairsLength, value=${Wa.length}`);
return Wa}function c(pb,Vb,Wa){let ka,Sa=0;Sa=ta.EwaSettings.Yab()?Ga.HelperMethods.VN(()=>{ka=gridRenderer.CanvasRendererGlobals.hideMultipleRowCols(pb,Vb,Wa,!1)}):Ga.HelperMethods.VN(()=>{ka=gridRenderer.CanvasRendererGlobals.hideRowCols(pb,Vb,!1)});e("HideRowCols",Sa);return ka}function h(pb,Vb,Wa,ka,Sa){pb=ta.EwaSettings.Yab()?gridRenderer.CanvasRendererGlobals.performModelCascadeForMultipleRowCols(pb,Vb,Wa,ka,Sa):gridRenderer.CanvasRendererGlobals.performModelCascade(pb,Vb,Wa,Sa);pb.PZi&&e("ModelCascade",
pb.PZi.Fzk);return pb}function f(pb){let Vb=-1;for(let Wa=0;Wa<pb.length;Wa++){const ka=pb[Wa].w8().topLeft.Y;ka>Vb&&(Vb=ka)}return Vb}function e(pb,Vb){Q.ULS.sendTraceTag(509723719,0,50,`GridInstantaneousAction: Time taken to complete operation=${pb} is time=${Vb}`)}function k(pb,Vb){for(const Wa of Vb)return Vb=Wa.destination.xg,ta.EwaSettings.qpc()&&!Vb?(v("isFirstRowColOfNextBlockHidden"),!0):(pb=pb.c9e(Vb))&&pb.IsFirstColOfNextBlockHidden;return!1}function l(pb,Vb,Wa){if(Wa)return!1;for(const ka of Vb){if(ta.EwaSettings.RGi()&&
(!ka||!ka.source))return Q.ULS.sendTraceTag(508339915,0,50,"GridInstantaneousAction.isSelectedRangeAcrossBlocks: blockPair or sourceBlock is null"),!0;if(ta.EwaSettings.qpc()){Vb=ka.source.xg;if(!Vb)return v("isSelectedRangeAcrossBlocks"),!0;if(Vb.If(pb))return!0}else if(ka.source.xg.If(pb))return!0}return!1}function r(pb,Vb,Wa,ka){return ta.EwaSettings.Yab()?gridRenderer.CanvasRendererGlobals.canMultipleRowColHideOrCascade(pb,Vb,Wa,ka):gridRenderer.CanvasRendererGlobals.canRowColHideOrCascade(pb,
Vb,ka)}function v(pb){Q.ULS.sendTraceTag(508347672,0,50,`GridInstantaneousAction: BlockRange was null in the method = ${pb}`)}function u(){return Y}function x(){Y={dispose(){}}}a.r(B);w={};a.r(w);a.d(w,"GridInstantaneousAction",function(){return La});a.d(w,"testableGetBlockPairsInViewport",function(){return b});a.d(w,"testablePerformHideColumnOperation",function(){return c});a.d(w,"testablePerformModelCascade",function(){return h});a.d(w,"testableGetPartialInteractivityState",function(){return u});
a.d(w,"testableInitPartialInteractivityState",function(){return x});a.d(w,"testableIsFirstRowColOfNextBlockHidden",function(){return k});a.d(w,"testableIsSelectedRangeAcrossBlocks",function(){return l});B=a(519);var t=a(9),m=a(0),n=a(233),A=a(8),y=a(18),z=a(70),F=a(72),D=a(6),I=a(35);class H{}H.DMh="ewa-resizehdr-row-hidden";H.CMh="ewa-resizehdr-col-hidden";Object(m.a)(H,"CssClassNames",null,[]);var N=a(251),U=a(15),L=a(175),J=a(653),P=a(30),K=a(235),ca=a(5),T=a(224),Q=a(16),fa=a(76),ha=a(145),Ea=
a(45),ra=a(24),Z=a(54),wa=a(14),la=a(77),ta=a(1),Ca=a(100),Ga=a(11),Oa=a(12),eb=a(264),nb=a(146),$a=a(386),oa=a(46),Fa=a(43);class X{constructor(pb,Vb,Wa,ka,Sa,Xb,Mc){this.eAa=pb;this.RKb=Vb;this.Vpa=Wa;this.gud=ka;this.Phb=Sa;this.cxf=Xb;this.Qqi=Mc}}Object(m.a)(X,"HeaderEventCachedInfo",null,[]);class va{constructor(pb){this.Rgd=pb}vPe(pb){pb=Ga.HelperMethods.AOd(pb);return Math.max(0,Math.min(va.FFf,pb))}iPe(pb){return this.cnj(pb)}Hjh(pb){return Math.round(this.Rgd*pb+2*this.Gaf()+1)}cnj(pb){return Math.max(0,
Math.min(va.iFf,(Math.max(0,Math.min(A.a.muc,pb))-2*this.Gaf()-1)/this.Rgd))}Gaf(){return Math.floor(Math.max((this.Rgd+3)/4,2))}Rjc(pb,Vb){return Vb?pb?va.FFf:A.a.aHd:pb?va.iFf:A.a.muc}}va.FFf=409;va.iFf=255;Object(m.a)(va,"ResizeHeadersConverter",null,[]);var xa=a(188);class Pa extends Ca.a{constructor(pb,Vb){super(Vb.domElement);this.o0=this.q9f=!1;this.Vj=this.Ccb=this.fFa=null;this.eWd=!0;this.Hqc=!1;this.GRb=this.Dn=this.offset=0;this.kQ=this.qV=this.X4=null;this.csi="headerResizeTooltip";this.qJ=
this.pFd=null;this.n7c=this.Z5=this.gEa=!1;this.SVf=this.kfb=A.a.xAa;this.vXb=!1;this.Jz=Wa=>{if(this.grid.Fk)return!1;Wa=Fa.a(this.grid.$).Xg(Wa);if(3===Wa.de&&!this.dxf(Wa.Da)||!this.LYf(Wa,!1))return!1;Q.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const ka=this.gHc();this.Pmd(Wa.clientPoint,ka,!0);this.gEa||(N.a.instance.va(U.a.Io,this.domElement.ownerDocument.body,this.zeb),L.a.instance.va(U.a.wj,this.domElement.ownerDocument.body,this.zeb),this.gEa=
!0);this.o0&&this.knf(Wa);return!1};this.jMb=Wa=>{Wa=Fa.a(this.grid.$).Xg(Wa);this.n7c&&this.knf(Wa);if(!Wa.Da.type.includes("touch")&&Wa.Da.button!==Sys.UI.MouseButton.leftButton||!this.JHb)return!1;la.g(Wa.Da);this.oZe();Wa=this.grid.Fk?this.kfb:A.a.xAa;if(this.grid.Fk&&this.Vj){var ka=Wa!==this.Dn;!ka&&this.vXb&&(this.Ng.removeRowColFromModel(this.Vj.qsb,this.Vj.g4f),this.Ng.zia(this.grid.ga.ra.selectedRanges),this.Ng.vr("HeaderResizeBehavior::onDocumentMouseUp"))}else this.Vj&&(Wa=this.Z5?this.yod():
this.Vj.D8()),ka=Wa!==this.Dn;if(this.fFa&&ka&&Wa!==A.a.xAa){Wa=this.grid;var Sa=this.Zqd(Wa);ka={};ka.SheetMultiRange=Ea.r(Sa,Wa.$);Pa.I_d(ka,this.isRow,this.Dn);if(this.grid.Fk){Sa=this.Vj?this.Vj.qsb:-1;const Xb=ka.SheetMultiRange.Ranges[0],Mc=Pa.fRa()&&0===this.Dn?20:50;Q.ULS.sendTraceTag(509694147,2,Mc,`HeaderResizeBehavior.OnDocumentMouseUp: cellAbsoluteIndex=${Sa}, isResizingHiddenHeader=${this.Z5}, headerViewBlockHashCode=${this.Ng.hashCode},
          rangeFirstRow=${Xb.FirstRow}, rangeFirstColumn=${Xb.FirstColumn}, rangeLastRow=${Xb.LastRow}, rangeLastColumn=${Xb.LastColumn},`)}this.VGh(ka);Wa.V$j=!0}else this.fi(null,null),this.TPb();return this.vXb=this.Z5=!1};this.sga=Wa=>{if(this.grid.Fk)return!1;Wa=J.a.create(Wa.eventName,Wa.Be,Wa.Da,Wa.de);Wa=Fa.a(this.grid.$).Xg(Wa);if(!this.LYf(Wa,!0))return!1;Wa=this.grid;var ka=this.Zqd(Wa);ka=Ea.r(ka,Wa.$);Wa.ee.cn([this.isRow?13:14]);Wa.ee.$Ea();this.TPb();Wa.$.rf(this.isRow?146338636:1391094586,
fa.a.Td,30,{["autoFitRanges"]:ka});return!1};this.KOf=Wa=>{this.o0?(this.Z5&&!this.vXb&&(this.fWg(),this.Ng.vr("HeaderResizeBehavior::onHeaderResizeChanged")),this.Hqc||this.yof(),Wa=new Sys.UI.DomEvent(Wa),Wa=J.a.create(U.a.rla,this.domElement,Wa,2),Wa=Fa.a(this.grid.$).Xg(Wa),this.nLd(Wa.clientPoint)):Q.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.Vj?this.Vj.qsb:-1}, isRow = ${this.isRow}`)};this.LOf=Wa=>{Wa=
new Sys.UI.DomEvent(Wa);Wa=J.a.create(U.a.rla,this.domElement,Wa,2);this.jMb(Wa)};this.$aj=Wa=>{Pa.fRa()&&!this.Vj?Q.ULS.sendTraceTag(508368662,2,15,`HeaderResizeBehavior.onHeaderResizeTouchStart: cellBeingResized is not set and we don't know which cell needs to be resized. this.isRow=${this.isRow}, this.viewBlock.hashCode=${this.Ng.hashCode}`):this.NCa(Wa,this.Vj,!1)};this.zeb=Wa=>{Wa=Fa.a(this.grid.$).Xg(Wa);la.g(Wa.Da);return this.nLd(Wa.clientPoint)};this.AL=Wa=>{if(this.grid.Fk)return!1;Wa=Fa.a(this.grid.$).Xg(Wa);
let ka;if(!this.grid.isResizeAllowed(this.isRow)||-1!==this.grid.ga.selectionType)return oa.a(this.grid.$).Wr()&&(ka=this.qpd(Wa))&&(ka.eAa.style.cursor=""),!1;if(this.o0)return this.yof(),!1;ka=this.qpd(Wa);if(!ka)return!1;ka.eAa.style.cursor=!this.grid.Kd&&this.zCd(ka)?this.isRow?"row-resize":"col-resize":"";la.g(Wa.Da);return!0};this.Ev=()=>{this.TPb()};this.fi=()=>{if((3===fa.a.Td||P.a.Xr)&&this.grid.ga.ra.Zj){var Wa=this.grid.ga.ra.Ef;if(!(!Wa.isRow&&!Wa.Wi||!this.domElement||Wa.isRow&&this.isRow&&
!this.Ng.Dx.includes(Wa.top)||Wa.Wi&&!this.isRow&&!this.Ng.Dx.includes(Wa.left))){var ka=this.grid.hj(Wa,this.Ng.$l.paneType);if(ka){if(this.grid.Fk){const Sa=this.isRow?Wa.bottom:Wa.right;this.Vj=this.Ng.rv(ra.Range.ef(Wa.bottom,Wa.right));if(!this.Vj){Q.ULS.sendTraceTag(522826880,2,Pa.fRa?15:50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${Sa}, is row ${this.isRow}`);return}}this.qJ||this.svh();Wa.isRow&&this.isRow?(wa.DOMElementExtensions.setVisible(this.qJ,
!0),this.qJ.style.top=ka.bottomRight.y-this.qJ.offsetHeight/2+"px"):Wa.isRow||this.isRow||(wa.DOMElementExtensions.setVisible(this.qJ,!0),eb.c(this.qJ.style,this.grid.rtl,ka.bottomRight.x-this.qJ.offsetWidth/2+"px"))}}}};this.$Q=(Wa,ka)=>{ta.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&Q.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${ka.HS}`);ka.HS&&this.Vvb()};this.Ng=
Vb;this.isRow=Vb.isRow;this.rtl=Vb.$l.rtl;this.grid=pb;this.kFf=this.isRow?A.a.aHd:A.a.muc;this.Yri=Oa.a.instance.ha(436);this.gsi=Oa.a.instance.ha(435);this.asi=Oa.a.instance.ha(437);nb.a(this.grid.$,Wa=>{this.pFd=Wa.vT(ha.a.iJj,!1)});this.Eyj();this.grid.ga.eK(this.fi);this.grid.ga.Tka(this.Ev);this.grid.$u(this.fi);oa.a(this.grid.$).Pi.Rka(this.$Q)}get JHb(){return this.o0}get kJj(){this.EHh();return Pa.Qhb}NCa(pb,Vb,Wa){var ka=new Sys.UI.DomEvent(pb);ka=J.a.create(U.a.rla,this.domElement,ka,2);
ka=Fa.a(this.grid.$).Xg(ka);this.KYf(Vb,ka.clientPoint.x,ka.clientPoint.y,!1,Wa,pb);pb=this.gHc();this.Pmd(this.fFa,pb,!0);this.gEa||(pb=this.domElement.ownerDocument.body,pb.addEventListener(U.a.rla,this.KOf),pb.addEventListener(U.a.kLa,this.LOf),this.gEa=!0)}Xaj(pb,Vb,Wa){this.KYf(Vb,pb.clientX,pb.clientY,!0,Wa,pb);pb=this.grid;Vb=this.Zqd(pb);Vb=Ea.r(Vb,pb.$);pb.ee.cn([this.isRow?13:14]);pb.ee.$Ea();this.TPb();pb.$.rf(this.isRow?146338636:1391094586,fa.a.Td,30,{["autoFitRanges"]:Vb})}dispose(){this.Q$c("dispose");
this.grid.ga&&(this.grid.ga.YI(this.fi),this.grid.ga.pha(this.Ev));this.grid.Vx(this.fi);oa.a(this.grid.$)&&oa.a(this.grid.$).Pi.lra(this.$Q);K.a.instance.Ca(U.a.Pm,this.domElement,this.sga);N.a.instance.Ca(U.a.tj,this.domElement.ownerDocument.body,this.jMb);L.a.instance.Ca(U.a.Wg,this.domElement.ownerDocument.body,this.jMb);P.a.Xr||(N.a.instance.Ca(U.a.Cf,this.domElement,this.Jz),N.a.instance.Ca(U.a.Io,this.domElement,this.AL));this.gEa&&(N.a.instance.Ca(U.a.Io,this.domElement.ownerDocument.body,
this.zeb),L.a.instance.Ca(U.a.wj,this.domElement.ownerDocument.body,this.zeb),this.gEa=!1);this.qJ&&(N.a.instance.Ca(U.a.Cf,this.qJ,this.Jz),K.a.instance.Ca(U.a.Pm,this.qJ,this.sga),Pa.fRa()||this.Q$c(""),this.qJ=null);this.q9f&&(wa.DOMElementExtensions.xi(Pa.Qhb),Pa.Qhb=null);this.Ng=null;super.dispose()}Eyj(){K.a.instance.va(U.a.Pm,this.domElement,this.sga);N.a.instance.va(U.a.tj,this.domElement.ownerDocument.body,this.jMb);L.a.instance.va(U.a.Wg,this.domElement.ownerDocument.body,this.jMb);P.a.Xr||
(N.a.instance.va(U.a.Cf,this.domElement,this.Jz),N.a.instance.va(U.a.Io,this.domElement,this.AL))}EHh(){if(!Pa.Qhb){document.getElementById(Pa.p9f);this.q9f=!0;var pb=Pa.Qhb=document.createElement("div");this.grid.$.frame.zea().appendChild(pb);pb.id=Pa.p9f;pb.className=I.a.EMh;wa.DOMElementExtensions.setVisible(pb,!1)}}oZe(){if(this.gEa){const pb=this.domElement.ownerDocument.body;this.grid.Fk?(pb.removeEventListener(U.a.rla,this.KOf),pb.removeEventListener(U.a.kLa,this.LOf)):(N.a.instance.Ca(U.a.Io,
pb,this.zeb),L.a.instance.Ca(U.a.wj,pb,this.zeb));this.gEa=!1}this.o0=!1;this.VBj();$a.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}kKj(){this.grid.ee.cn([this.isRow?13:14]);this.grid.ee.$Ea()}fWg(){this.Ng.addRowColToModel(this.Vj.qsb-1,this.Vj.g4f);this.vXb=!0}nLd(pb){if(!this.o0)return!1;const Vb=this.isRow;if(!this.grid.Fk&&!this.X4){this.X4=document.createElement("div");this.X4.style.cssText="position: relative; width: inherit; height: inherit;"+(Vb?"top: 0px; ":this.rtl?"right: 0px:":
"left: 0px:");for(var Wa=this.Vj.gI();Wa.nextSibling;)this.X4.appendChild(Wa.nextSibling);Wa.parentNode.appendChild(this.X4)}Wa=Vb?pb.y-this.Ccb.y:(this.rtl?-1:1)*(pb.x-this.Ccb.x);const ka=Vb?pb.y-this.fFa.y:(this.rtl?-1:1)*(pb.x-this.fFa.x),Sa=this.grid.Fk?this.kfb:this.Vj.D8();if(Sa===A.a.xAa)return!1;Wa&&(0<this.Dn||0<Sa+ka)&&Sa+ka<=this.kFf&&(this.Dn=this.gHc(ka),this.Pmd(pb,this.Dn,!1),this.grid.Fk?this.Dn>=Pa.mlf?(this.eWd=!0,this.Vj.setCellExtent(this.Dn)):this.eWd&&(this.eWd=!1,this.Vj.setCellExtent(Pa.mlf)):
(wa.DOMElementExtensions.fta(this.Vj.gI(),!Vb,Math.max(this.GRb+ka,0)),this.X4.style[Vb?"top":this.rtl?"right":"left"]=Math.max(ka,-this.GRb)+"px"),Wa=(this.grid.Fk?this.SVf:Vb?this.Vj.Ng.AF:this.Vj.Ng.BF)+Math.max(ka,this.grid.Fk?-this.kfb+Pa.jlc:-this.GRb),wa.DOMElementExtensions.fta(this.Vj.Ng.domElement,!Vb,Wa),this.grid.Fk&&this.Vj.Ng.GRj(Wa),this.Ccb=new Sys.UI.Point(pb.x,pb.y),wa.DOMElementExtensions.setVisible(this.qJ,!1));return!0}D8(){return this.Vj?this.Z5?Pa.nsi:this.Vj.D8():A.a.xAa}Pmd(pb,
Vb,Wa){this.kQ&&Wa&&(Q.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.i5f());this.kQ||Wa||Q.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.pFd&&this.pFd(()=>({["Location"]:"canvas"}));this.kQ?this.O8e(Vb):(this.kQ=document.createElement("div"),this.kQ.id=this.csi,this.O8e(Vb),this.kQ.className=
I.a.GLh,Vb=document.getElementById(this.grid.$.He+D.a.cHf),Vb.insertBefore(this.kQ,Vb.firstChild),pb=Fa.a(this.grid.$).Ina(pb),this.kQ.style.left=(this.rtl?Math.max(pb.x-this.kQ.offsetWidth,0):pb.x-Math.max(pb.x+this.kQ.offsetWidth-Vb.offsetWidth,0)).toString()+"px",Vb=document.getElementById(D.a.uwa),this.kQ.style.top=(pb.y-(ca.AFrameworkApplication.sa&&ca.AFrameworkApplication.sa.Sa.qj?0:Vb.offsetHeight)-this.kQ.offsetHeight).toString()+"px")}i5f(){wa.DOMElementExtensions.xi(this.kQ);this.kQ=null}O8e(pb){var Vb=
new va(this.grid.$.workbookContext.DxDigitNormal);Vb=this.isRow?Vb.vPe(pb).toFixed(2):Vb.iPe(pb).toFixed(2);this.kQ.innerText=`${this.isRow?this.Yri:this.gsi} ${Vb} (${pb.toString()} ${this.asi})`}LYf(pb,Vb){let Wa;const ka=this.grid.isResizeAllowed(this.isRow);if(-1!==this.grid.ga.selectionType||2===pb.de&&pb.Da.button!==Sys.UI.MouseButton.leftButton||!this.zCd(Wa=this.qpd(pb))||!ka)return!1;la.g(pb.Da);this.fFa=this.Ccb=new Sys.UI.Point(pb.clientPoint.x,pb.clientPoint.y);this.zch(Wa,Vb);if(!this.Vj)return!1;
this.o0=!0;this.vKi(this.Vj,Wa)&&this.lwi();this.GRb=this.yod();return this.MYf(pb.Da.rawEvent,Vb)}KYf(pb,Vb,Wa,ka,Sa,Xb){this.o0=!0;this.Z5=Sa;this.Vj=pb;this.ECf("prepareResizeOperation");this.Hqc=!1;this.fFa=this.Ccb=new Sys.UI.Point(Vb,Wa);pb=this.Vj.getRange();this.qV=Sa?this.TBe(pb):pb;this.kfb=this.D8();this.SVf=this.isRow?this.Vj.Ng.AF:this.Vj.Ng.BF;this.MYf(Xb,ka)}MYf(pb,Vb){const Wa=this.grid.Fk?{["IsResizingHiddenHeader"]:this.Z5,["IsAutoFitting"]:Vb,["NumberOfSelectedRanges"]:this.grid.ga.ra.zG,
["Location"]:"canvas",["ResizeRange"]:this.qV,["ResizedCellAbsoluteIndex"]:this.Vj.qsb,["HeaderViewBlockHashCode"]:this.Ng.hashCode}:{["IsResizingHiddenHeader"]:this.Z5,["IsAutoFitting"]:Vb,["NumberOfSelectedRanges"]:this.grid.ga.ra.zG,["Location"]:"canvas"};nb.b(this.grid.$).Lf(ha.a.$Ij,Wa);this.grid.t1j&&(Vb=Vb?"header_resize_autofit":"header_resize_start",xa.b(this.grid.$).OFa(pb,Vb,void 0));this.offset=this.Vj.Jea();this.Dn=this.grid.Fk?this.kfb:this.Vj.D8();if(this.Dn===A.a.xAa)return!1;$a.c(this.grid.$,
!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}vKi(pb,Vb){var Wa=this.Vj.gI();if(!Wa)return Q.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Wa=Wa.nextSibling;if(!Wa)return!1;pb=pb.getRange();Wa=this.Ng.nza(Wa).getRange();if(!pb||!Wa)return Q.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;pb=this.isRow?pb.bottom:pb.right;Wa=this.isRow?Wa.bottom:Wa.right;return pb+1!==Wa&&pb!==Wa&&this.zCd(Vb,!0)}lwi(){var pb=this.Vj.gI();
const Vb=this.Ng.nza(pb.nextSibling);Pa.wKi(Vb,this.isRow)?(this.Vj=Vb,this.qV=this.Vj.getRange()):(this.gWg(pb),this.Vj=Vb,pb=this.Vj.getRange(),this.qV=this.TBe(pb),this.Z5=!0)}TBe(pb){return this.isRow?new ra.Range(pb.top-1,pb.left,pb.top-1,pb.right,!1,!0):new ra.Range(pb.top,pb.left-1,pb.bottom,pb.left-1,!1,!0)}gWg(pb){const Vb=this.Ng.nza(pb.nextSibling),Wa=Pa.Grh(Vb,this.isRow,this.rtl);Wa&&pb.parentNode.insertBefore(Wa,Vb.gI())}Zqd(pb){const Vb=this.qV,Wa=pb.ga.ra.selectedRanges;if(pb.ga.ra.lzb(Vb))if(this.isRow){if(T.a.all(Wa,
ka=>ka.isRow))return Wa}else if(T.a.all(Wa,ka=>ka.Wi))return Wa;return[Vb]}getCellExtent(){return this.Vj.getCellExtent()}yod(){const pb=this.Vj.gI().style;return Math.max(0,Math.min(this.kFf,0|parseInt(this.isRow?pb.height:pb.width,10)))}gHc(pb=0){const Vb=this.grid;var Wa=this.Ng.$l.paneType;let ka;ka=this.isRow?3===Wa?[3,2]:[1,4]:4===Wa?[2,4]:[1,3];var Sa=Math.max(this.grid.Fk?this.kfb:this.Vj.D8(),0);pb=this.Z5&&!this.grid.Fk?Math.max(this.yod(),0):Math.max(Sa+pb,0);Wa=Vb.pbi(Wa,this.isRow);Wa=
this.isRow?new F.a(0,this.offset,Wa,pb):new F.a(this.offset,0,pb,Wa);Sa=[this.isRow?13:14];Vb.ee.Yn(new ra.Range(1,1,A.a.Bh,A.a.Ah,!1,!0),Sa,!1);Vb.ee.Iu(Sa,Wa,ka);return pb}Q$c(pb){this.qV=this.fFa=this.Ccb=null;if(this.X4){const Vb=this.X4.parentNode;if(Vb)for(Vb.removeChild(this.X4);this.X4.firstChild;)Vb.appendChild(this.X4.firstChild);this.X4=null}Pa.fRa()?this.Vj&&(this.Vj=null,this.ECf("clearResizeState::"+pb)):this.Vj=null;this.o0=!1}VBj(){this.Hqc=!1;this.i5f();wa.DOMElementExtensions.setVisible(Pa.Qhb,
!1);wa.DOMElementExtensions.setVisible(this.qJ,!1);this.kKj()}qpd(pb){if(wa.DOMElementExtensions.oG(pb.Be,"a"))return null;const Vb=this.dxf(pb.Da);if(Vb&&this.grid.ga.ra.Zj){var Wa=this.grid.ga.ra.Ef;Wa=this.Ng.rv(ra.Range.ef(Wa.bottom,Wa.right))}else Wa=this.Ng.nza(pb.Be);if(!Wa)return null;const ka=Wa.gI(),Sa=new Sys.UI.Bounds(ka.offsetLeft,ka.offsetTop,ka.offsetWidth,ka.offsetHeight);var Xb=wa.DOMElementExtensions.getBoundingClientRect(pb.Be);Xb=new Sys.UI.Point(pb.clientPoint.x-Xb.x,pb.clientPoint.y-
Xb.y);this.isRow&&!Vb&&(Xb.y+=Ga.HelperMethods.fG(pb.Be,ka,this.rtl).y);return new X(ka,Xb,Sa,Wa.getRange(),Math.max(Pa.YZi,Math.min(Pa.YYi,(this.isRow?Sa.height:Sa.width)*Pa.jJj)),Vb,!this.isRow&&0<ka.getElementsByTagName("input").length)}zCd(pb,Vb=!1){if(!pb||this.grid.Kd)return!1;if(pb.cxf)return!0;var Wa=pb.Vpa;const ka=pb.Phb;var Sa=this.Ng.$l.paneType,Xb=this.grid.mi(Sa).Rl,Mc=!!Xb&&Xb.top===pb.gud.top,jc=!!Xb&&Xb.left===pb.gud.left;Sa=!!Xb&&Xb.bottom===pb.gud.bottom&&(3===Sa||2===Sa);this.isRow?
(jc=pb.RKb.y,pb=jc<=ka&&!Mc,Wa=jc>=Wa.height-ka-(Sa?Pa.cZh:0),Vb=Vb?pb:Wa||pb):(Sa=pb.Qqi,Mc=this.rtl,Xb=pb.RKb.x,pb=Xb<=ka&&(!jc||Mc)&&(!Sa||!Mc),Wa=Xb>=Wa.width-ka&&(!Mc||!jc)&&(!Sa||Mc),Vb=Vb?Mc?Wa:pb:pb||Wa);return Vb}zch(pb,Vb){const Wa=this.isRow;if(pb.cxf)this.Vj=this.Ng.nza(pb.eAa);else if(Wa&&pb.RKb.y<=pb.Phb&&pb.Vpa.height>pb.Phb||!Wa&&pb.Vpa.width>pb.Phb&&(!this.rtl&&pb.RKb.x<=pb.Phb||this.rtl&&pb.RKb.x>=pb.Vpa.width-pb.Phb)){if(this.Vj=pb.eAa.previousSibling?this.Ng.nza(pb.eAa.previousSibling):
this.Dai(),Vb&&pb.eAa.classList.contains(Wa?I.a.z3e:I.a.y3e)&&(pb=this.Ng.nza(pb.eAa)))pb=pb.getRange(),this.qV=Wa?new ra.Range(pb.top-1,pb.left,pb.top-1,pb.right,!1,!0):new ra.Range(pb.top,pb.left-1,pb.bottom,pb.left-1,!1,!0)}else this.Vj=this.Ng.nza(pb.eAa);!this.qV&&this.Vj&&(this.qV=this.Vj.getRange())}Dai(){var pb=this.isRow?1:0;return(pb=this.Ng.$l.cF(this.Ng.$l.ya.oj(this.grid.$.pa,z.a.UM(this.Ng.position.X+pb-1,this.Ng.position.Y-pb,this.Ng.position.PaneType))))?pb.Cai():null}yof(){this.Hqc=
!0;const pb=this.kJj;wa.DOMElementExtensions.setVisible(pb,!0);pb.style.cursor=this.isRow?I.a.W0e:I.a.S_e;this.gHc()}VGh(pb){this.grid.$.rf(this.isRow?745189930:-445963340,fa.a.Td,30,{["resizeRowColumnParameters"]:pb})}svh(){const pb=document.createElement("div");pb.className=I.a.rNh;const Vb=document.createElement("div");Vb.className=y.a.MM;pb.appendChild(Vb);const Wa=document.createElement("img");Wa.src=Z.a.Bj(0);Wa.className=this.isRow?y.a.BMh:y.a.wMh;Vb.appendChild(Wa);this.Ng.DA.domElement.parentNode.insertBefore(pb,
this.Ng.DA.domElement);this.grid.Fk?pb.addEventListener(U.a.gda,this.$aj):(N.a.instance.va(U.a.Cf,pb,this.Jz),K.a.instance.va(U.a.Pm,pb,this.sga));wa.DOMElementExtensions.setVisible(pb,!1);this.qJ=pb}ECf(pb){Pa.fRa()&&!this.Vj&&Q.ULS.sendTraceTag(508368661,2,20,`HeaderResizeBehavior.logUndefinedCellBeingResized: Cell being resized is undefined. caller: ${pb}`)}TPb(){this.grid.Fk&&Pa.fRa()&&!this.Vj||this.Q$c("removeResizer");this.qJ&&(this.Ng.DA.domElement.parentNode.removeChild(this.qJ),this.qJ=
null)}dxf(pb){return wa.DOMElementExtensions.Sj(this.qJ,pb.target)}Vvb(){this.o0&&(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.Fk&&this.nLd(this.fFa),this.oZe(),this.grid.Fk||wa.DOMElementExtensions.fta(this.Vj.gI(),!this.isRow,this.GRb),this.TPb(),this.vXb=this.Z5=!1)}knf(pb){(pb=pb.Da.rawEvent)&&pb.detail===Pa.lOj&&(pb.type===U.a.$r?(this.o0=!1,this.n7c=!0):pb.type===U.a.tL&&(this.o0=!0,this.n7c=!1))}static Erh(pb,Vb){return new Pa(pb,Vb)}static I_d(pb,
Vb,Wa){if(Vb){pb.ColumnWidth=-1;pb.RowHeight=Wa;for(const ka of pb.SheetMultiRange.Ranges)ka.FirstColumn=0,ka.LastColumn=0}else{pb.RowHeight=-1;pb.ColumnWidth=Wa;for(const ka of pb.SheetMultiRange.Ranges)ka.FirstRow=0,ka.LastRow=0}}static wKi(pb,Vb){if(!pb||!pb.gI())return Q.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const Wa=pb.getRange();pb=pb.gI().style;if(!Wa||!pb)return Q.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;pb=Vb?pb.height:pb.width;
return(Vb?Wa.top:Wa.left)===(Vb?A.a.Bh:A.a.Ah)&&pb===Pa.Bzg}static Grh(pb,Vb,Wa){if(!pb)return Q.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var ka=pb.gI();if(!ka||!ka.style)return Q.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;pb=document.createElement("div");const Sa=ka.style;pb.style.top=Vb?Sa.top:Pa.Bzg;Vb||(Wa?pb.style.right=Sa.right:pb.style.left=Sa.left);pb.classList.add(Vb?H.DMh:H.CMh);pb.classList.add(Vb?I.a.tAb:I.a.sAb);Wa=
document.createElement("div");Wa.classList.add(Vb?I.a.m3e:I.a.Gjd);ka=Vb?Number.parseInvariant(ka.innerText):ra.Range.w5a(ka.innerText);Wa.innerText=Vb?(ka-1).toString():ra.Range.qT(ka-1);pb.appendChild(Wa);return pb}static fRa(){return ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8165839_JSCrash_during_touch_resize")}}Pa.YZi=0;Pa.YYi=5;Pa.jlc=1;Pa.mlf=1;Pa.nsi=0;Pa.cZh=3;Pa.jJj=.1;Pa.p9f="ewa-rszrbg";Pa.Bzg="0px";Pa.lOj=2;Pa.Qhb=null;Object(m.a)(Pa,"HeaderResizeBehavior",Ca.a,[713]);class Ka extends n.a{constructor(){super();
this.Oe()}create(){this.ve(Pa.Erh)}static la(pb){pb.ia.Va(136,new Ka)}}Object(m.a)(Ka,"HeaderResizeBehaviorFactory",n.a,[]);var Bb=a(63),xb=a(737),Ua=a(62),Jb=a(40),fc=a(181),ya=a(432),ob=a(383),Sb=a(202),Ba=a(161),Ia=a(234),cb=a(249),Kb=a(64),db=a(20);class gb{constructor(pb,Vb){this.isRow=!1;this.autoFitRange=null;this.isRow=pb;this.autoFitRange=Vb}}Object(m.a)(gb,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[129]);class yb{constructor(pb){this.resizeParameters=null;this.resizeParameters=
pb}}Object(m.a)(yb,"MacroRecorderSheetRowsColumnsResizedPayload",null,[129]);var Nb=a(143);Ca=a(384);var qc=a(22),Gb=a(57);class hb extends Ca.a{constructor(pb,Vb){super(pb);this.$Oa=Wa=>{Wa=this.Dpd(Wa);return this.Fmd(Wa)};this.aJj=(Wa,ka)=>{var Sa=this.Wbb=ka[hb.CEi];1===Wa?(Wa=ka[hb.o5j],Sa=this.uhf(Wa,Sa),Q.ULS.shipAssertTag(537153996,0,Sa!==hb.jfa,`ResizeHeadersDialogHandler - invalid size input, size = ${Wa}`),Wa=Sa!==this.ewd,Q.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",
this.isRow,this.Wbb,Sa,Wa),Wa&&this.hph(Sa)):Q.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=2040891415===Vb.command;this.gridView=db.h(this.$);this.YCc=new va(this.$.workbookContext.DxDigitNormal);this.ewd=this.idh();pb=this.Pnh(this.ewd);Vb=this.Rnh(this.ewd);this.Om=Oa.a.instance.ha(this.isRow?478:479);pb=this.hG(pb,Vb);this.initializeAndShow(this.Om,this.aJj,pb);Q.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get Pe(){return"ResizeHeadersDialog"}get Wbb(){return hb.Fle}set Wbb(pb){hb.Fle=
pb}hG(pb,Vb){return{[hb.UK]:this.Pe,[hb.MKi]:this.isRow,[hb.Mwi]:pb,[hb.Lwi]:Vb,[hb.nHi]:this.Wbb,[hb.Cpd]:this.$Oa}}idh(){const pb=this.q1h();try{return this.X5h(pb)}finally{pb&&pb.dispose()}}hph(pb){const Vb={};Vb.SheetMultiRange=Ea.r(this.gridView.ga.ra.selectedRanges,this.$);hb.I_d(Vb,this.isRow,pb);this.$.rf(this.isRow?745189930:-445963340,fa.a.Td,8,{["resizeRowColumnParameters"]:Vb})}uhf(pb,Vb){return qc.a.t9(pb)?Vb?this.Onh(pb):this.Qnh(pb):hb.jfa}Qnh(pb){return Math.floor(parseFloat(pb))}Onh(pb){pb=
parseFloat(pb);return 0>pb?hb.jfa:pb?this.isRow?Ga.HelperMethods.nnj(pb):this.YCc.Hjh(pb):0}Rnh(pb){return pb===hb.jfa?"":this.isRow?this.YCc.vPe(pb).toString():this.YCc.iPe(pb).toFixed(2)}Pnh(pb){return pb===hb.jfa?"":pb.toString()}X5h(pb){if(!pb||!pb.$$mn()||!pb.zo)return hb.jfa;var Vb=Object(Nb.a)(798,pb.zo);if(!Vb)return hb.jfa;for(Vb=this.isRow?Vb.oFb:Vb.cwd;pb.$$mn();){const Wa=Object(Nb.a)(798,pb.zo);if(Wa&&(this.isRow?Wa.oFb:Wa.cwd)!==Vb)return hb.jfa}return Vb}q1h(){const pb=[];for(const Wa of this.gridView.ga.ra.selectedRanges){const ka=
Wa.clone();var Vb=this.gridView.mi(this.gridView.Gd.xk(ka));Vb=ka.Sg(Vb.Rl);if(!Vb)return null;this.isRow?ka.right=ka.left=Vb.left:ka.top=ka.bottom=Vb.top;pb.push(ka)}return pb.length?this.gridView.B7("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",pb):null}Dpd(pb){if(!qc.a.t9(pb))return 1;pb=this.uhf(pb,this.Wbb);if(0===pb){const Vb=this.gridView.ga.ra.selectedRanges,Wa=this.gridView.Wk("ResizeHeaderDialog");if(Object(Gb.d)(Wa)){if(!Wa.value.hJe(Vb,this.isRow))return 3}else if(this.uKi())return 3}return this.INi(pb)?
0:2}uKi(){const pb=this.gridView.ga.ra.selectedRanges;return this.isRow&&Ea.Q(pb)||!this.isRow&&Ea.P(pb)}Fmd(pb){let Vb="";switch(pb){case 0:Vb="";break;case 1:Vb=Oa.a.instance.ha(767);break;case 2:Vb=String.format(Oa.a.instance.Qd(99),0,this.Rjc(this.Wbb));break;case 3:Vb=Oa.a.instance.ha(768)}return Vb}INi(pb){return 0<=pb&&pb<=this.Rjc(!1)}Rjc(pb){return this.YCc.Rjc(pb,this.isRow)}static I_d(pb,Vb,Wa){if(Vb){pb.ColumnWidth=hb.jfa;pb.RowHeight=Wa;for(const ka of pb.SheetMultiRange.Ranges)ka.FirstColumn=
0,ka.LastColumn=0}else{pb.RowHeight=hb.jfa;pb.ColumnWidth=Wa;for(const ka of pb.SheetMultiRange.Ranges)ka.FirstRow=0,ka.LastRow=0}}}hb.UK="id";hb.MKi="isRow";hb.Mwi="initialSizeInPx";hb.Lwi="initialSizeInDefaultUnits";hb.nHi="isInitialUnitsDefaultUnits";hb.Cpd="getInputErrorIfInvalid";hb.o5j="size";hb.CEi="isDefaultUnits";hb.jfa=-1;hb.Fle=!0;Object(m.a)(hb,"ResizeHeadersDialog",Ca.a,[]);var qb=a(58);const ab=(pb,Vb,Wa,ka,Sa,Xb,Mc=null)=>{Mc=pb.Pa(41,Mc);Mc.resizeRowColumnParameters=Vb;return qb.g(pb,
"ResizeRowsColumns",Mc,Wa,ka,Sa,Xb,0)};var Mb=a(296),Ib=a(155),fb=a(34),Db=a(356);class Za{constructor(pb,Vb,Wa,ka){this.Xej=(Sa,Xb)=>{if(!Ia.a(Sa)&&Xb){const Mc=!!Sa&&!!Sa.RequestTelemetryData;db.h(this.$).Vi.bga(Xb,Sa.StateId,Mc?Sa.RequestTelemetryData.EcsOperationDuration:0,Mc?Sa.RequestTelemetryData.EcsRequestDuration:0,Mc?Sa.RequestTelemetryData.WfeRequestDuration:0)}};this.N6i=(Sa,Xb)=>{Jb.TaskExtensions.Aa(Ua.GetServiceTaskFactory.je(this.$.ia,534,535,1),Mc=>{Mc.result.Gfk(Xb)},this.$.ma,3)};
this.$=pb;this.Mh=Vb;this.gridInstantaneousAction=Wa;this.grid=db.h(this.$);this.EDb=ka}hf(pb,Vb){pb=!0;switch(Vb){case -445963340:case 1391094586:pb=this.og(8);break;case 745189930:case 146338636:pb=this.og(16)}return!pb}executeCommand(pb,Vb,Wa){var ka=db.h(this.$);const Sa=Vb.command;var Xb=fc.a.create().toString();let Mc=Jb.TaskExtensions.Wl();switch(Sa){case 1391094586:case 146338636:pb=1391094586===Sa;(Xb=Wa.autoFitRanges)&&Xb.Ranges&&Xb.Ranges.length||(Xb=Ea.r(ka.ga.ra.selectedRanges,this.$));
Mc=this.ECh(pb?1:0,Xb,Vb);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:pb=-445963340===Sa||-706918724===Sa||369708605===Sa;(ta.EwaSettings.RAa()||ta.EwaSettings.Yab())&&-706918724===Sa&&ka.Vi.T4(18,Xb,ya.a(Sa));if(-445963340===Sa||745189930===Sa){var jc=ya.a(Vb.command);ka.Vi.T4(16,Xb,jc);ka=Wa.resizeRowColumnParameters}else{Wa=ka.ga.ra.selectedRanges;let fd=0,Kd=!1,Yd="",te=!1;const ve=ta.EwaSettings.MGb();ve&&(Yd=ya.a(Vb.command),Kd=1<Wa.length?
!0:!1);for(var $c of Wa){if(ve&&this.EDb){var Jd=this.grid.ya.o2($c);this.EDb.i3c(Jd,Yd)}if(-706918724===Sa||369708605===Sa)Jd=$c.right-$c.left+1,fd+=0<Jd?Jd:-1*Jd;else if(1542466017===Sa||1051390410===Sa)te=!0,fd+=$c.bottom-$c.top+1}ve&&this.EDb&&(this.EDb.gze(fd,Yd),this.EDb.mye(Yd,te,fd,Wa[0]));369708605===Sa||1542466017===Sa?Q.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${fd}, isDiscontinuous=${Kd}`):(-706918724===Sa||1051390410===Sa)&&Q.ULS.sendTraceTag(520938757,
0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${fd}, isDiscontinuous=${Kd}`);if(!Object(Gb.d)(ka.Wk("ResizeCmdHandler"))){if(-706918724===Sa&&6===Vb.hh&&Ea.P(Wa)){Q.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===Sa&&6===Vb.hh&&Ea.Q(Wa)){Q.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");
break}}$c=369708605===Sa||1542466017===Sa?-2:0;ka={};ka.SheetMultiRange=Ea.r(Wa,this.$);if(pb)for(jc of ka.SheetMultiRange.Ranges)jc.FirstRow=0,jc.LastRow=0;else for(const qe of ka.SheetMultiRange.Ranges)qe.FirstColumn=0,qe.LastColumn=0;ka.RowHeight=pb?-1:$c;ka.ColumnWidth=pb?$c:-1}Mc=this.$Ch(ka,Vb,Xb,pb);break;case 957527587:case 2040891415:new hb(this.$,Vb)}return Mc}Ue(pb,Vb,Wa,ka){if(pb=!!Wa&&!!ka&&1===ka.IA)switch(Vb.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;
default:pb=!1}return pb}mf(){return!1}hUi(pb){Q.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Object(Mb.c)(pb)}. Reason: ${Object(Mb.c)(pb)?void 0:pb.reason}.`)}og(pb){return(new Ba.a(this.$.ta)).og(pb)}ECh(pb,Vb,Wa){const ka=this.$.qa.ua.ze(),Sa=0===pb,Xb=()=>new gb(Sa,Vb);return ob.a(this.$.userOperationManager,(Mc,jc,$c)=>{var Jd=this.$.qa.ua;Mc=cb.b(Mc,this.N6i);var fd={LDi:!Sa,Z3a:Vb};const Kd=Jd.Pa(41,ka);Kd.isRow=Sa;Kd.autoFitRanges=
Vb;return qb.g(Jd,"AutoFit",Kd,Mc,jc,$c,fd,0)},Mc=>new Sb.a(135,0,Mc,void 0,Xb),Wa)}$Ch(pb,Vb,Wa,ka){const Sa=Vb.command,Xb=db.h(this.$),Mc=Ea.g(pb.SheetMultiRange.Ranges);if(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:7428186_HideLastRowCol")){var jc=1051390410===Sa||745189930===Sa&&0===pb.RowHeight;const Kd=-706918724===Sa||-445963340===Sa&&0===pb.ColumnWidth,Yd=Xb.Wk("ResizeCmdHandler");if((jc||Kd)&&Object(Gb.d)(Yd)&&!Yd.value.hJe(Mc,!ka))return this.LBh(ka),Jb.TaskExtensions.Wl()}let $c;jc=
(ta.EwaSettings.RAa()||ta.EwaSettings.Yab())&&-706918724===Sa;if(745189930===Sa||-445963340===Sa||jc)Q.ULS.shipAssertTag(537154002,0,this.$.activeItemName===pb.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),jc?(this.gridInstantaneousAction.exj(),Object(Ib.c)(()=>{Xb.Vi.huc();this.gridInstantaneousAction.$6g(Sa)},this.$.ma,0)):($c=this.Mh.w2d(Xb,Mc,ka?pb.ColumnWidth:pb.RowHeight,!ka),this.hUi($c),Object(Mb.c)($c)&&Xb.Vi.GR(Wa,Kb.BasicTelemetryCalculator.pQ));
const Jd=this.$.qa.ua.ze({Epa:!0,voa:3});ka=(Kd,Yd,te)=>{this.$.JB();Ea.i(Mc,",",this.$,!1);return ab(this.$.qa.ua,pb,cb.b(Kd,this.Xej),Yd,te,Wa,Jd)};const fd=()=>new yb(pb);return $c&&Object(Mb.c)($c)?ob.a(this.$.userOperationManager,ka,Kd=>new Sb.a(136,0,Kd,64,fd),Vb):ob.a(this.$.userOperationManager,ka,Kd=>new Sb.a(136,0,Kd,void 0,fd),Vb)}LBh(pb){pb=fb.a.Mf(1,0,pb?769:771,pb?770:772,0,pb?-2037763134:503471870,pb?"HideAllColumnsError":"HideAllRowsError");new Db.a(this.$,pb)}}Object(m.a)(Za,"ResizeCommandHandler",
null,[169]);var sb=a(94),sa=a(142),ba=a(13);class ua extends xb.a{constructor(pb){super(pb)}yg(){const pb=Object(sb.d)(sa.a.resolve(ba.qb,{Oa:this.$a}));let Vb;Vb=ta.EwaSettings.RAa()?ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateGridInstantaneousAction",!1)?Object(sb.d)(sa.a.resolve(ba.Ib,{Oa:this.$a})):Ua.GetServiceTaskFactory.je(this.$.ia,528,529,this.$a):Bb.Task.Ua(null);let Wa;Wa=ta.EwaSettings.MGb()?Object(sb.d)(sa.a.resolve(ba.Fb,{Oa:this.$a})):Bb.Task.Ua(null);Jb.TaskExtensions.Aa(Jb.TaskExtensions.Tg([pb,
Wa],this.ma),()=>{this.vg([new Za(this.$,pb.result,Vb.result,Wa.result)])},this.ma,3)}static la(pb){xb.a.dh(113,new ua(pb))}}Object(m.a)(ua,"ResizeCommandHandlerFactory",xb.a,[]);Ca=a(734);var R=a(96);let Y=null,La=class{constructor(pb){this.Bk=()=>{Y&&(R.a.Ma(Y),Y=null);this.KGb&&(this.$.fzd=!1)};this.$=pb;this.gridView=db.h(this.$);this.ya=this.gridView.ya;this.AHb=!1;this.ied=this.$.ea.Mg;this.TQb={};this.d9={};this.KGb=ta.EwaSettings.getBooleanFeatureGate("isGlobalStylesSlice1Enabled",!1);this.ya.wt(this.Bk)}dispose(){this.gridView=
this.$=null;this.d9={};this.AHb=!1;this.TQb={};this.ya.ds(this.Bk)}$6g(pb){if(this.AHb)Q.ULS.sendTraceTag(509658009,0,15,`GridInstantaneousAction.attemptInstantaneousGridAction command=${pb}, parameter = isProcessing, value=true, reason = AttemptInstantaneousGridAction is still processing, isRow=false`);else{var Vb=this.ya.N9e(),Wa=b(Vb);this.d9={};this.tHi(pb,Vb,Wa)?(this.AHb=!0,this.$.fzd=!0,this.i_f(pb,!1,Wa,Vb)):this.gridView.Vi.huc(!1)}}exj(){this.ied=this.$.ea.Mg}tHi(pb,Vb,Wa){const ka=this.gridView;
if(-706918724!==pb||ka.rtl)return!1;if(ka.Gd.iQ)return Q.ULS.sendTraceTag(508958784,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = hasPanes, value=true, isRow=false`),!1;var Sa=ka.Wk("GridInstantaneousAction");if(!Object(Gb.d)(Sa))return Q.ULS.sendTraceTag(509658008,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = ActiveSheetProcessedData, value=null, isRow=false`),!1;var Xb=ka.ga.ra.selectedRanges,Mc=Xb[0],jc=Xb.length;
if(1<jc)return Q.ULS.sendTraceTag(509658007,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = SelectedRanges, value=${jc}, reason = Discontinuous selection, isRow=false`),!1;if(Sa.value.qbb(Mc))return Q.ULS.sendTraceTag(509658006,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = isPartOfRangeHidden, value=true, isRow=false`),!1;Sa=Mc.right-Mc.left+1;a:{if(ta.EwaSettings.Yab()){if(Sa>ta.EwaSettings.nYi()){jc=!0;break a}}else if(Sa>
ta.EwaSettings.mYi()){jc=!0;break a}jc=!1}if(jc)return Q.ULS.sendTraceTag(508409418,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = ColumnCount, value=${Sa}, reason = ColCount is higher than the limit, isRow=false`),!1;if(l(Mc,Wa,!1))return Q.ULS.sendTraceTag(508404044,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = isSelectedRangeAcrossBlocks, value=true, isRow=false`),!1;Vb=Vb.length;if(Vb>ta.EwaSettings.lYi())return Q.ULS.sendTraceTag(509658004,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = BlocksInViewport, value=${Vb}, reason = Blocks in viewport limit exceeded, isRow=false`),!1;a:{Vb=Sa-1;for($c of Wa){if(!$c||!$c.source||!$c.destination){Q.ULS.sendTraceTag(509649925,0,50,"GridInstantaneousAction.canRowColHideOrCascade: blockPair or sourceBlock or destinationBlock is null");var $c=!1;break a}Sa=$c.source.qg.GridBlockModel;if(!r(Sa,Sa.ColumnNumbers[0],Vb,!1)){$c=!1;break a}}$c=!0}if(!$c)return Q.ULS.sendTraceTag(509658003,
0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = canRowColCascade, value=false, reason = Model has complex cells, isRow=false`),!1;a:{$c=Mc.left;Vb=Mc.right-Mc.left;Mc=this.ya.EOa(Mc,this.$.activeItemName);for(Jd of Mc)if(!r(Jd.qg.GridBlockModel,$c,Vb,!1)){var Jd=!1;break a}Jd=!0}if(!Jd)return Q.ULS.sendTraceTag(509084812,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = canRowColHideOrCascade, value=false, reason = Selected row or Col has complex cells, isRow=false`),
!1;a:{Xb=Xb[0];Jd=0;for(fd of Wa){Mc=fd.destination.xg;if(!Mc&&ta.EwaSettings.qpc()){v("getTransitionCount");var fd=ta.EwaSettings.eFf()+1;break a}(Mc=Mc.If(Xb))||(Mc=Xb,$c=fd.destination.xg,ta.EwaSettings.qpc()&&!$c?(v("shouldPerformTransitions"),Mc=!1):Mc=$c.left>Mc.right);Mc&&(Jd+=1)}fd=Jd}if(fd>ta.EwaSettings.eFf())return Q.ULS.sendTraceTag(509658002,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = TransitionCount, value=${fd}, reason = Transition count limit exceeded, isRow=false`),
!1;if(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:8043178_HideColumnBugFixes")&&k(ka,Wa))return Q.ULS.sendTraceTag(508564123,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = isFirstRowColOfNextBlockHidden, value=true, isRow=false`),!1;Q.ULS.sendTraceTag(509658001,0,50,`GridInstantaneousAction.isInstantaneousGridActionPossible command=${pb}, parameter = isInstantaneousGridActionPossible, value=true, reason = isInstantaneousGridActionPossible successful, isRow=false`);
return!0}i_f(pb,Vb,Wa,ka){try{const Sa=Ga.HelperMethods.he(),Xb=ta.EwaSettings.pYi(),Mc=Wa.filter(Jd=>!Jd.qqc),jc=this.gridView.ga.ra.selectedRanges[0],$c=Vb?jc.bottom-jc.top:jc.right-jc.left;for(const Jd of Mc){if(this.Owe("WebServiceResponseReceivedInProcessGridAction",ka,pb))return;const fd=Jd.destination.xg.right;if(fd<jc.left){Jd.qqc=!0;Q.ULS.sendTraceTag(509657999,0,50,`GridInstantaneousAction.processGridAction command=${pb}, parameter = BlockRangeLessThanSelectedRange, selectedRangeLeftValue=${jc.left}, blockRangeRightMostValue=${fd}, hashCode=${Jd.destination.Vf}, isRow=false`);
continue}const Kd=Vb?jc.topLeft.top:jc.topLeft.left,Yd=this.W9e("SourceModel",Jd.source),te=this.W9e("DestinationModel",Jd.destination),ve=Jd.destination.Vf;if(Jd.destination.xg.If(jc)){if(!c(te,Kd,$c)){this.Uva();Q.ULS.sendTraceTag(509657998,0,15,`GridInstantaneousAction.processGridAction command=${pb}, parameter = isHideColumnSuccessful, value=false, reason = "HideRowColOperation was failure", hashCode=${ve}, isRow=${Vb}, rowColNumber=${Kd}`);return}Q.ULS.sendTraceTag(509657997,0,50,`GridInstantaneousAction.processGridAction command=${pb}, parameter = isHideColumnSuccessful, value=true, reason = "HideRowColOperation was successful", hashCode=${ve}, isRow=${Vb}, rowColNumber=${Kd}`)}const qe=
Yd.ColumnNumbers[0],pc=Jd.source.Vf;if(h(Yd,te,qe,$c,Vb).isSuccess)Jd.qqc=!0,Q.ULS.sendTraceTag(509657996,0,50,`GridInstantaneousAction.processGridAction command=${pb}, parameter = cascadeResult.isSuccess, value=true, reason = "CascadeResult was successful", hashCode=${pc}, isRow=${Vb}, rowColNumber=${qe}`);else{this.Uva();Q.ULS.sendTraceTag(509657995,0,15,`GridInstantaneousAction.processGridAction command=${pb}, parameter = cascadeResult.isSuccess, value=false, reason = "CascadeResult was failure", hashCode=${pc}, isRow=${Vb}, rowColNumber=${qe}`);
return}this.q9j(te,Yd,Jd);if(Ga.HelperMethods.he()-Sa>Xb){this.rNj(pb,Vb,Mc,ka);return}}this.Ckh(Vb,pb,ka);e("ProcessGridAction",Ga.HelperMethods.he()-Sa)}catch(Sa){this.noi(Sa)}}Ckh(pb,Vb,Wa){if(!this.Owe("CommitGridInstantaneousActionResults",Wa,Vb)){var ka=Ga.HelperMethods.he();if(this.d9&&0!==Object.keys(this.d9).length)if(this.Gnj(Wa),this.GDg(Vb,Wa)){var Sa=fc.a.create().toString(),Xb=this.gridView.Wk("GridInstantaneousAction");Object(Gb.d)(Xb)?(Xb.value.q9d(this.gridView.ga.ra.selectedRanges,
0,pb),Vb=Object.keys(this.d9),this.ya.n0f(Vb,Sa,pb?"row":"column",!0),this.AHb=!1,Y=oa.a(this.$).Pi.XJa(6,"GridInstantaneousAction.commitGridInstantaneousActionResults",void 0,Oa.a.instance.ha(2188)),e("CommitGridInstantaneousActionResults",Ga.HelperMethods.he()-ka)):(this.E9f(Wa),this.Uva(),Q.ULS.sendTraceTag(509645768,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Vb}, parameter = ActiveSheetProcessedData, value=null, isRow=${pb}`))}else this.E9f(Wa),this.Uva();else this.Uva(),
Q.ULS.sendTraceTag(509657994,0,50,`GridInstantaneousAction.commitGridInstantaneousActionResults command=${Vb}, parameter = interimModels, value=false, reason = "InterimModels was null", isRow=${pb}`)}}W9e(pb,Vb){let Wa=this.d9[Vb.Vf];if(!Wa){const ka=Ga.HelperMethods.VN(()=>{Wa=Vb.I4h()});e(pb,ka)}return Wa}Gnj(pb){for(const Vb of pb)pb=Vb.Vf,this.TQb[pb]||(this.TQb[pb]=Vb.qkc())}E9f(pb){for(const Vb of pb){pb=Vb.Vf;const Wa=this.TQb[pb];if(Wa&&!Vb.u7f(Wa)){Q.ULS.sendTraceTag(509653846,0,15,`GridInstantaneousAction.restoreBlockModels parameter = isModelRestored, value=false, hashCode=${pb}`);
this.Uva();break}}}GDg(pb,Vb){for(const Wa of Vb)if(Vb=Wa.Vf,this.d9[Vb]&&!Wa.u7f(this.d9[Vb]))return Q.ULS.sendTraceTag(509657993,0,15,`GridInstantaneousAction.UpdateModelsInBlockCacheSuccessful command=${pb}, parameter = isModelUpdated, value=false, reason = "Response Model not updated", hashCode=${Vb}, isRow=false`),!1;return!0}rNj(pb,Vb,Wa,ka){window.setTimeout(()=>{this.i_f(pb,Vb,Wa,ka)},0)}iNi(pb){for(const Vb of pb)if(Vb.qg.Information.Revision>this.ied)return!0;return!1}Owe(pb,Vb,Wa){return this.iNi(Vb)?
(this.ied=this.$.ea.Mg,this.Uva(),Q.ULS.sendTraceTag(509657992,0,50,`GridInstantaneousAction.abortIfServerResponseReceived command=${Wa}, parameter = ${pb}, value=true, reason = "Server response received before completing client side estimation", isRow=false`),!0):!1}Uva(){this.d9={};this.AHb=!1;this.TQb={};this.gridView.Vi.huc(!1)}noi(pb){this.Uva();Q.ULS.sendTraceTag(509723721,0,10,`${"GridInstantaneousAction.ProcessGridAction"} encountered exception ${pb}.`)}q9j(pb,Vb,Wa){this.d9[Wa.destination.Vf]=
pb;this.d9[Wa.source.Vf]=Vb}};La=Object(Ca.a)([Object(sa.d)(ba.Ib),Object(Ca.b)(0,Object(ba.fb)())],La);Object(m.a)(La,"GridInstantaneousAction",null,[671]);var Ma=a(740);class lb extends n.a{constructor(pb){super();this.$=pb;this.Oe()}create(){this.ve(Object(Ma.a)(this.$.ia,528,()=>new La(this.$)))}static la(pb){pb.ia.Va(529,new lb(pb))}}Object(m.a)(lb,"GridInstantaneousActionFactory",n.a,[]);B.a.Pk(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");
(()=>{t.a.Ia(pb=>{Ka.la(pb);ua.la(pb)})})();(()=>{t.a.Ia(pb=>{ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateGridInstantaneousAction",!1)||lb.la(pb)})})();String(w);window.___1692616129258_closurehack=w}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.rsz.js.map/19da12e7caae5cf572866ae486e6a22d/EwaTS.rsz.js.map