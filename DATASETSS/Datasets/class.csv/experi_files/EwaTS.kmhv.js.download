'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[36],{1341:function(w,B,a){a.r(B);var b={};a.r(b);a.d(b,"CreateNewCommandHandler",function(){return Jb});var c={};a.r(c);a.d(c,"OpenFromMruCommandHandler",function(){return Db});var h={};a.r(h);a.d(h,"NamedSheetViewPublic",function(){return Oc});var f={};a.r(f);a.d(f,"NamedSheetViewTeachingCallout",function(){return Ke});var e={};a.r(e);a.d(e,"TryOfficeThroughTellMeCommandHandler",function(){return nf});var k={};
a.r(k);a.d(k,"SheetOptionsToggleCommandHandler",function(){return Qd});var l={};a.r(l);var r={};a.r(r);a.d(r,"SortFilterManager",function(){return ue});var v=a(0),u=a(566),x=a(16),t=a(125),m=a(858),n=a(33),A=a(152);class y{static wGh(qa){return y.$He("New",qa)}static xGh(qa){return y.$He("Open",qa)}static LHe(qa,Xa){return y.tla("LoadingMenuSection",y.uSi,qa,y.ovb("lblLoading",Xa))}static pvb(qa,Xa,wb,Rb){return y.tla("MessageMenuSection",y.TGf,Xa,y.ovb("lblMessage",qa,void 0===wb?null:wb,void 0===
Rb?null:Rb))}static uah(qa){return y.LHe(qa,CommonUIStrings.l_VoicedLoadingText)}static vah(qa,Xa){return y.pvb(CommonUIStrings.l_NewCreationLocationMessage,qa.zk,Xa.gV,Xa.wsa)}static tah(qa,Xa){return y.pvb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,Xa.wsa,"\n\n"),qa.zk)}static NHe(qa){return y.pvb(CommonUIStrings.l_NewGenericErrorMessage,qa.zk)}static rah(qa,Xa,wb){return y.tla("menuNewBlank",y.Vri,wb?qa.zk:null,y.ivb(qa.jlf,qa.klf,qa.llf,null,qa.P2,qa.REb,Xa,"blank"))}static qbh(){return y.ovb("lblTemplatesLoading",
CommonUIStrings.l_VoicedLoadingText)}static YHe(){return y.ovb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static rbh(qa,Xa){return y.tla("menuNewTemplates",qa,null,Xa)}static pah(qa,Xa){return y.tla("menuNewMoreTemplates",y.f7e,null,y.ivb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,qa,Xa))}static s$g(qa,Xa,wb){let Rb="";wb&&Xa&&(Rb=y.tla("BrowseMoreMenuSection",y.f7e,null,y.ivb("btnBrowseMore",Xa,Xa,null,null,
null,qa||"1959943459",wb)));return Rb}static ovb(qa,Xa,wb,Rb){wb=void 0===wb?null:wb;let vc=Rb=void 0===Rb?null:Rb;Xa&&0<Xa.length&&(vc=y.SHf.azc(Xa).trimEnd(),vc=0<=vc.indexOf("{0}")?String.format(vc,Rb):String.format("{0} {1}",vc,Rb));wb=wb&&Rb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',n.a.Vh(wb),n.a.Vh(Rb),n.a.Vh(vc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
n.a.Vh(qa||""),y.SHf.azc(n.a.Vh(Xa||"")),wb)}static ivb(qa,Xa,wb,Rb,vc,Nc,id,Id){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',n.a.Vh(qa||""),n.a.Vh(Xa||""),n.a.Vh(wb||""),Rb||"32by32",n.a.Vh(vc||""),n.a.Vh(Nc||""),id,n.a.Vh(Id||""))}static $He(qa,Xa){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
qa,Xa)}static tla(qa,Xa,wb,Rb){wb=wb?String.format('Title="{0}"',n.a.Vh(wb)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',n.a.Vh(qa||""),n.a.Vh(Xa||""),wb,Rb)}}y.TGf="MenuMru";y.uSi="MenuLoading";y.Vri="MenuHeader";y.f7e="MenuFooter";y.SHf=A.a.SA("\n","&#10;");Object(v.a)(y,"NewAndOpenXmlUtilities",
null,[]);var z=a(5),F=a(102),D=a(107),I=a(149);class H{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(v.a)(H,"HostInformation",null,[]);var N=a(114),U=a(39),L=a(387),J=a(157),P=a(668),K=a(588),ca=a(118),T=a(26),Q=a(71);class fa{constructor(qa,Xa,wb,Rb,vc,Nc){this.Urb=this.Wq=this.NYb=null;this.S3b=this.a0c=!1;this.Xne=0;this.nVc=!1;this.tzc=(id,Id,me,Wb,Ec)=>{if(1===me)return 32;2!==me||this.nVc||(this.Xne=(new Date).getTime(),x.ULS.sendTraceTag(5849602,202,50,
"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.FGc,["CachedNewMenuXmlExists"]:!!this.NYb,["ShouldCallGetMoreInfo"]:this.xB.supportsGetMoreInfoForPersonalStorage}));return this.boj(Ec)};this.i6=qa;this.cob=Xa;this.dIa=new u.a(()=>new m.a(wb.value,Object(t.a)(this,this.RCb,"getMoreInfoEventReceived")));this.qNg=Rb;this.bva=vc;this.HQg=Nc;this.vrb=this.FGc;this.P0b=!!z.AFrameworkApplication.da&&z.AFrameworkApplication.da.na("GateTemplateRenderingByGetMoreInfoResponse");this.mMg=
!!z.AFrameworkApplication.da&&z.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment1",!1);this.Lle=!!z.AFrameworkApplication.da&&z.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.TemplatesForUserRetentionTreatment2",!1)}get zP(){switch(this.xB.JQ){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Oj(){const qa=this.xB.Xdb;qa.xe(T.a.newDocument,ca.a.frame,
Object(t.a)(this,this.newDocument,"newDocument"));qa.xe(T.a.tzc,ca.a.frame,this.tzc)}newDocument(qa,Xa,wb,Rb,vc){if(1===wb)return 32;if(2===wb&&vc){if(z.AFrameworkApplication.da.na("BackstagePremiumTemplateExperienceEnabled")&&vc.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),z.AFrameworkApplication.Vd.qh(T.a.qpj,2);if(vc.MenuItemId&&vc.SourceControlId)return"NewDocumentHome"===vc.SourceControlId&&D.a("NewDocumentFromHomeTab"),this.$5a(vc.MenuItemId,vc.SourceControlId)}return 8}$5a(qa,
Xa){var wb=this.nvc.tdd;if(null===wb)return 8;var Rb=z.AFrameworkApplication.da.na("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const vc=z.AFrameworkApplication.Dfa;"blank"===qa&&this.EIi()&&(x.ULS.sendTraceTag(508687196,202,50,"Updating blank document id with new template id for appId={0}",this.zP),qa="blankNew");if(vc&&Rb){x.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Nc={};Nc[L.a.mpg]=qa;Nc[L.a.zP]=this.zP;Nc[L.a.lcid]=
z.AFrameworkApplication.lcid.toString();Nc[L.a.reason]=P.a.createNew;Nc[L.a.uiCulture]=z.AFrameworkApplication.uiCulture;Nc[L.a.dataCulture]=z.AFrameworkApplication.dataCulture;z.AFrameworkApplication.xN().execute(id=>{id.sendMessage(J.a.$5a,Nc)})}else Rb=(new Date).getTime(),Xa=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",wb,n.a.Dh(this.Opa),n.a.Dh(qa),n.a.Dh(this.zP),n.a.Dh(z.AFrameworkApplication.lcid.toString()),n.a.Dh(Rb.toString()),
n.a.Dh(Xa),n.a.Dh(z.AFrameworkApplication.IM),z.AFrameworkApplication.fl),(wb=z.AFrameworkApplication.da.Ra("ScenarioId"))&&""!==wb&&(Xa+="&wdscenarioid="+n.a.Dh(wb)),Xa+="&"+z.AFrameworkApplication.xkc(),z.AFrameworkApplication.Soa&&(Xa+="&"+z.AFrameworkApplication.Njc()),(wb=this.Wq?this.Wq.gV:null)?Xa+="&DestinationUrl="+n.a.Dh(wb):3===this.xB.JQ&&this.xB.supportsGetMoreInfoForPersonalStorage&&x.ULS.sendTraceTag(508928088,202,10,"CreateNewDocument: getMorInfoResult is null or PersonalFileStorageUrl is empty"),
U.a.rh(Xa,"_blank",void 0,"CreateNewDocument");2!==this.xB.JQ&&3!==this.xB.JQ||x.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:K.a[this.xB.JQ],["Template"]:qa});z.AFrameworkApplication.da&&z.AFrameworkApplication.da.isChangeGateEnabled("Microsoft.Office.Excel.ChangeGate.ConsumerTemplateTelemetry")&&1===this.xB.JQ&&("blank"===qa||"blankNew"===qa?D.b("ConsumerTemplateNewBlank"):(qa=[Object.assign(new Q.a,{name:"TemplateId",string:qa})],D.b("ConsumerTemplateNew",
null,0,!0,0,qa)));return 32}EIi(){let qa=!1;switch(this.xB.JQ){case 3:qa=z.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.WordOnline.DefaultsUpdate",!1);break;case 2:qa=z.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PPTODefaultThemeChange",!1);break;case 1:qa=z.AFrameworkApplication.da.getBooleanFeatureGate("Microsoft.Office.Excel.NewDefaultTemplate",!1)}return qa}KVi(qa){let Xa=Number.MAX_VALUE,wb=Number.MIN_VALUE;const Rb=window.performance;
if(Rb&&"undefined"!==typeof Rb.getEntriesByName){for(let Nc=0;Nc<qa.length;Nc++){var vc=Rb.getEntriesByName(qa[Nc]);vc&&0<vc.length&&(vc=vc[0],Xa=Math.min(parseInt(String(vc.fetchStart)),Xa),wb=Math.max(parseInt(String(vc.responseEnd)),wb))}wb>Xa&&x.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:wb-Xa,["MinFetchStart"]:Xa,["MaxResponseEnd"]:wb})}}boj(qa){qa&&(this.NYb?qa.PopulationXML=this.NYb:(this.xB.supportsGetMoreInfoForPersonalStorage&&!this.Wq&&
this.v1i.z2("Opened New menu",!0),qa.PopulationXML=this.X0h(this.iji())));return 32}jvf(){return!this.xB.supportsGetMoreInfoForPersonalStorage||!!this.Wq&&3===this.Wq.state&&!!this.Wq.wsa&&!!this.Wq.gV}HAd(){return z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Sa.p3&&!this.P0b?!0:this.jvf()}iji(){if(!this.FGc&&!this.P0b&&!this.HAd())return null;if(this.vrb&&!this.S3b){let Xa=!1;var qa="9";const wb=z.AFrameworkApplication.da.appSettings;"NumberOfTemplatesInBackstage"in wb&&(qa=wb.NumberOfTemplatesInBackstage);
let Rb=this.zP;"TemplateCollectionId"in wb&&(Rb=wb.TemplateCollectionId);this.mMg&&(Rb="WordConsumerWAC",qa="10");this.Lle&&(Rb="WordConsumerWAC",qa="10",Xa=!0);qa=String.format(this.xB.nZ+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",n.a.Dh(z.AFrameworkApplication.lcid.toString()),n.a.Dh(Rb),qa);Boolean.parse(wb.AppendOriginQueryParam||"false")&&(qa+="&org=backstage");Boolean.parse(wb.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in wb&&(qa+="&templateTier="+wb.TemplateTier);
this.Lle&&(qa+="&col=officetemplateswordonlinestartexp2");qa=Xa?qa+"&p=1":qa+"&p=0";qa+="&"+z.AFrameworkApplication.xkc();z.AFrameworkApplication.Soa&&(qa+="&"+z.AFrameworkApplication.Njc());this.xB.oLb.zp(qa,1,null,null,!1,2,vc=>{this.xB.Ufa("CreateNewActor.GetTemplateListJson",vc.data);this.Xak(vc.data.Fg)},vc=>{this.xB.Ufa("CreateNewActor.GetTemplateListJson",vc.data);this.Wak()},null,void 0,void 0,void 0,void 0,"5");this.vrb=!1}return this.Urb}Xak(qa){this.Urb=qa;this.vrb=!1;this.rPb();this.P0b?
this.HAd()?this.egd():this.Wq&&(x.ULS.sendTraceTag(508867410,202,10,"GetMoreInfo Received but info is missing"),this.dgd()):this.egd()}egd(){if(z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Sa.p3&&I.c()){const qa=z.AFrameworkApplication.da.na("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC"),Xa=z.AFrameworkApplication.Dfa;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.Urb,!0,qa&&Xa));3===this.xB.JQ&&x.ULS.sendTraceTag(508867409,202,15,"DispatchSuccessTemplateListJson")}}Wak(){this.S3b=
this.vrb=!0;this.rPb();this.dgd();F.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}dgd(){z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Sa.p3&&I.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1)),3===this.xB.JQ&&x.ULS.sendTraceTag(508867408,202,15,"DispatchFailureTemplateListJson"))}vji(qa){var Xa=0;for(var wb=0;wb<qa.length;wb++)if("ST"===qa[wb].ImageType){Xa=wb;break}const Rb=qa.length?qa[Xa]:null;
qa=Rb?Rb.Url||"":"";var vc;let Nc=wb=Xa=!1;if(Rb&&(vc=Rb.AspectRatio))vc=parseFloat(vc),1>vc?Xa=!0:1.5<vc?wb=!0:1===vc&&(Nc=!0);else switch(x.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:qa}),this.xB.JQ){case 3:Xa=!0;break;case 2:wb=!0;break;case 5:Nc=!0}return{returnValue:qa,oui:Xa?"95by123":wb?"123by69":Nc?"100by100":"123by95"}}X0h(qa){let Xa;const wb=this.nvc.rLa||"1056925771",Rb=(()=>{let vc=this.sah(qa,this.nvc,wb);({hGc:Xa}=vc);return vc})().returnValue;if(Xa){this.NYb=
Rb;const vc=(new Date).getTime()-this.Xne;x.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:vc})}return Rb}RCb(qa,Xa){x.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Wq||3!==qa.state?2===qa.state&&(x.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.a0c=!0,this.rPb()):(this.Wq=qa,Xa||this.rPb(),z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Sa.p3&&I.c()&&I.d("setFileMenuHostInformation")&&
(qa=Object.assign(new H,{hostUrl:this.Wq.gV,hostName:this.Wq.wsa,folderUrl:z.AFrameworkApplication.breadcrumbFolderUrl,folderName:z.AFrameworkApplication.breadcrumbFolderName}),x.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(qa)),this.P0b&&this.Urb&&this.Urb.length&&(this.HAd()?this.egd():this.dgd(),x.ULS.sendTraceTag(508867407,202,15,"Dispatched on GetMoreInfoReceived"))))}sah(qa,Xa,wb){let Rb;Rb=!1;const vc=
this.jvf();let Nc="";this.xB.supportsGetMoreInfoForPersonalStorage&&(this.a0c?(Nc=y.NHe(Xa),this.a0c=!1,x.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Wq?vc?Nc=y.vah(Xa,this.Wq):this.Wq.Zzi?(Rb=!0,this.vrb=!1,Nc=y.tah(Xa,this.Wq),x.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(Rb=!0,Nc=y.NHe(Xa),x.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",
{["PersonalFileStorageUrlIsSet"]:!!this.Wq.gV,["StorageServiceDisplayNameIsSet"]:!!this.Wq.wsa})):(Nc=y.uah(Xa.zk),x.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));vc&&(Nc+=y.rah(Xa,wb,!Nc)+(()=>{let id=this.pbh(qa,wb);({hGc:Rb}=id);return id})().returnValue);return{returnValue:y.wGh(Nc),hGc:Rb}}pbh(qa,Xa){let wb;wb=!1;if(!this.FGc)return wb=!0,x.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",hGc:wb};let Rb="",
vc="",Nc="MenuTemplate";if(this.S3b)Rb=y.YHe(),this.S3b=!1,x.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(qa){try{const id=Sys.Serialization.JavaScriptSerializer.deserialize(qa,!0);Rb=this.obh(id,Xa);x.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");z.AFrameworkApplication.THf&&"OneDrive"===this.Opa&&(vc=y.pah(this.w1i,z.AFrameworkApplication.THf))}catch(id){x.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
{["JsonToConvert"]:qa}),Rb=y.YHe()}wb=!0}else Nc="MenuLoading",Rb=y.qbh(),x.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:y.rbh(Nc,Rb)+vc,hGc:wb}}obh(qa,Xa){let wb="";const Rb=[];for(let Nc=0;Nc<qa.length;Nc++){var vc=qa[Nc];let id="";if(vc){const Id=vc.Title,me=vc.AssetId;vc=vc.Thumbnails;me&&Id&&vc&&({oui:vc,returnValue:id}=this.vji(vc),wb+=y.ivb("jbtnNewTemplate"+Nc,Id,null,vc,null,id,Xa,me))}Rb[Nc]=id}qa=new N.a(4,1,5E3,()=>{this.KVi(Rb)},
106);this.xB.kvc.Xh(qa);return wb}rPb(){this.nVc=!0;this.xB.NHf.iA(this.nvc.gBb);this.nVc=!1}get xB(){return this.i6.value}get nvc(){return this.cob.value}get v1i(){return this.dIa.value}get w1i(){return this.qNg.value}get Opa(){return this.bva.value}get FGc(){return this.HQg.value}}Object(v.a)(fa,"CreateNewActor",null,[]);var ha=a(1251);class Ea extends ha.a{constructor(){super()}sze(){this.ZW(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.ZW(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.ZW(2,
CommonUIStrings.l_Open);this.ZW(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.ZW(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.ZW(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Ea.La||(Ea.La=new Ea)}static rjj(qa){return Ea.instance.ha(qa)}}Ea.La=null;Object(v.a)(Ea,"MruActorIntlHelper",ha.a,[]);var ra;(function(qa){qa[qa.success=0]="success";qa[qa.failure=1]="failure";qa[qa.spinner=2]="spinner";qa[qa.none=3]="none"})(ra||(ra={}));Object(v.b)("DisplayState",ra);var Z=a(41);
class wa{constructor(qa,Xa,wb,Rb,vc,Nc,id,Id){this.DPc=null;this.S1c=!0;this.MYb="";this.vSg=0;this.M0a=null;this.bWc=3;this.szc=(me,Wb,Ec,hd,je)=>1!==Ec&&je?this.Ynj(je):32;this.Qa=Id;this.i6=qa;this.rA=Xa;this.lJg=wb;this.pGg=Rb;this.oGg=vc;this.dIa=new u.a(()=>new m.a(Nc.value,null));this.XJg=new u.a(()=>new m.a(id.value,Object(t.a)(this,this.f0i,"mruEventResultReceived")));this.Qa.na("WacInTabOpenMRUIsEnabledForUiHost");this.Qa.na("UiHostSupportsDocRebootFeatures")}f0i(qa,Xa){this.M0a=qa;Xa||
this.i3f()}Nzj(){this.Oz.Xdb.uh(T.a.szc,ca.a.frame,this.szc,96)}Ynj(qa){this.eHh();this.dHh();qa.PopulationXML=y.xGh(this.MYb+this.DPc);return 32}eHh(){let qa=3,Xa=!1;if(this.MYb&&this.vSg===this.M0a.Kck)x.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),qa=this.bWc;else{x.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var wb=this.Oz.pz();this.M0a=this.e0i.z2("File Open opened",
!0);if(this.MYb&&2!==this.bWc&&3!==this.M0a.state)Xa=!0;else{const Rb=this.ehi(this.M0a);z.AFrameworkApplication.sa&&z.AFrameworkApplication.sa.Sa.p3&&I.c()&&Rb&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Rb,!0));this.MYb=(()=>{let vc=this.Y0h(this.M0a);({n1i:qa}=vc);return vc})().returnValue}wb=this.Oz.pz()-wb;x.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:wb})}2!==qa&&(wb={["DisplayState"]:ra[qa]},
1!==qa&&(wb.IsStale=Xa),x.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",wb));this.bWc=qa}ehi(qa){let Xa;try{Xa=Z.c(qa.cId)}catch(wb){Xa=null,x.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",wb)}return Xa}dHh(){this.S1c?(x.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.DPc=(()=>{let qa=this.eXi();({Krk:this.S1c}=qa);return qa})().returnValue):x.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
x.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.S1c,["NotDisplayingLink"]:!this.DPc})}Y0h(qa){let Xa;1===qa.state||0===qa.state?(x.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),qa=2,Xa=y.LHe(this.Rna(2),this.Rna(5))):3===qa.state&&qa.cId?(Xa=this.qah(qa.cId),qa=0):(x.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),Xa=y.pvb(this.Rna(1),this.Rna(2)),qa=1);return{returnValue:Xa,
n1i:qa}}qah(qa){let Xa;const wb=this.EKb.rLa||"2155708348";if(qa.length){Xa=y.ovb("lblRecentDocuments",this.Rna(3));let Rb=0;for(let vc=0;vc<qa.length;vc++){const Nc=qa[vc];"FileName"in Nc&&"DocumentUrl"in Nc&&"Path"in Nc&&(Xa+=y.ivb("MruButton"+vc,Nc.FileName.toString(),Nc.Path.toString(),null,this.EKb.P2,this.EKb.REb,wb,Nc.DocumentUrl.toString()),Nc.IsPinned&&Rb++)}Xa=y.tla("RecentDocumentsMenuSection",y.TGf,this.Rna(2),Xa);x.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",
["TotalDocuments"]:qa.length,["NumPinnedDocuments"]:Rb})}else Xa=y.pvb(this.Rna(0),this.Rna(2)),x.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return Xa}eXi(){let qa;qa=!0;let Xa=this.M9g;var wb=this.L9g;if(Xa&&wb||!this.Oz.supportsGetMoreInfoForPersonalStorage)qa=!1;else{const Rb=this.Tjc.z2("File Open",!1);3===Rb.state&&(Xa=Rb.gV,wb=Rb.wsa,qa=!1)}wb=wb?String.format(this.Rna(4),wb):null;return{returnValue:y.s$g(this.EKb.rLa,wb,Xa),Krk:qa}}i3f(){this.Oz.NHf.iA(this.EKb.gBb)}get Oz(){return this.i6.value}get Rna(){return this.rA.value}get EKb(){return this.lJg.value}get M9g(){return this.pGg.value}get L9g(){return this.oGg.value}get Tjc(){return this.dIa.value}get e0i(){return this.XJg.value}}
Object(v.a)(wa,"MruRenderer",null,[]);var la=a(220),ta=a(808);class Ca{constructor(qa,Xa,wb,Rb,vc,Nc,id){this.Wq=null;this.Use=!1;this.uua=this.bee=0;this.RCb=Id=>{if(!this.Wq&&3===Id.state)this.Wq=Id;else if(2===Id.state){this.Use?x.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Tjc.z2("NewDocumentFromStream",!0),this.Use=!0);return}this.ERe()};this.q1i=Id=>{if(Id&&Id.data&&Id.data.Fg){let Wb=Z.d(Id.data.Fg);({Ft:me}=Wb);if(Wb.returnValue)if(Id=me,Id.StatusCode!==
la.a.sJ&&Id.StatusCode!==la.a.e6a)x.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.zP,this.uua,Id.StatusCode),this.a1a(null);else if(Id.NewDocumentUrl&&""!==Id.NewDocumentUrl){var me=(new Date).getTime()-this.bee;x.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.zP,this.uua,me);this.xNg(Id.NewDocumentUrl)}else x.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",
this.zP,this.uua),this.a1a(null);else x.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.zP,this.uua,{["ResponseData"]:ta.a.Vkb(Id.data.Fg)}),this.a1a(null)}else x.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.zP,this.uua),this.a1a(null)};this.p1i=Id=>{Id&&Id.data&&x.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",
this.zP,this.uua,Id.data.status);this.a1a(null)};this.xNg=qa;this.a1a=Xa;this.H1b=wb;this.cob=Rb;this.bva=vc;this.i6=Nc;this.dIa=new u.a(()=>new m.a(id.value,this.RCb))}$5a(){!this.Wq&&this.HId.supportsGetMoreInfoForPersonalStorage?this.Tjc.z2("NewDocumentFromStream",!0):this.ERe()}ERe(){this.bee=(new Date).getTime();var qa=this.dUh.tdd;if(null===qa)this.a1a(null);else{var Xa=this.H1b.menuItemId,wb=this.H1b.PG,Rb=this.H1b.v9j,vc=this.H1b.iUh;this.uua="streamBase64"===Rb?vc.length/1024:0;x.ULS.sendTraceTag(35156358,
202,50,"FileType:{0}, FileSize:{1}",this.zP,this.uua);var Nc=(new Date).getTime();qa=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",qa,n.a.Dh(this.Opa),n.a.Dh(Xa),n.a.Dh(this.zP),n.a.Dh(z.AFrameworkApplication.lcid.toString()),n.a.Dh(Nc.toString()),n.a.Dh(wb),n.a.Dh(z.AFrameworkApplication.IM),z.AFrameworkApplication.fl,n.a.Dh(Rb));qa+="&"+z.AFrameworkApplication.xkc();z.AFrameworkApplication.Soa&&(qa+="&"+z.AFrameworkApplication.Njc());
(Xa=this.Wq?this.Wq.gV:null)&&(qa+="&DestinationUrl="+n.a.Dh(Xa));this.HId.oLb.zp(qa,2,vc,{"Content-Type":"application/json; charset=utf-8"},!0,2,this.q1i,this.p1i,null,void 0,void 0,void 0,void 0,"31")}}get zP(){switch(this.HId.JQ){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get dUh(){return this.cob.value}get Opa(){return this.bva.value}get HId(){return this.i6.value}get Tjc(){return this.dIa.value}}Object(v.a)(Ca,"NewDocumentFromStreamOperation",
null,[]);class Ga{constructor(qa,Xa,wb,Rb){this.cob=qa;this.bva=Xa;this.i6=wb;this.WJg=Rb}create(qa,Xa,wb){return new Ca(qa,Xa,wb,this.cob,this.bva,this.i6,this.WJg)}}Object(v.a)(Ga,"NewDocumentFromStreamOperationFactory",null,[229]);var Oa=a(81),eb=a(528),nb=a(63);class $a{get name(){return"Common.App.NewAndOpen.UX"}nk(qa){qa.register(Ga,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Ve().$e(()=>new Ga(new u.a(()=>
z.AFrameworkApplication.sa.Sa.Ood()),new u.a(()=>z.AFrameworkApplication.Opa),new u.a(()=>qa.Ii("Common.INewAndOpenCommonHelpers")),new u.a(()=>qa.Ii("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){z.AFrameworkApplication.da.Jw(()=>{this.kFb()})}kFb(){const qa=eb.a.Ar(Oa.a.instance.ie("Common.INewAndOpenCommonHelpers")),Xa=eb.a.Ar(Oa.a.instance.ie("Common.IEventEmitter<Common.IGetMoreInfoResult>"));z.AFrameworkApplication.Opa&&nb.Task.WAA.call(null,qa,Xa).continueWith(()=>{const wb=new fa(new u.a(()=>
qa.result),new u.a(()=>z.AFrameworkApplication.sa.Sa.Ood()),new u.a(()=>Xa.result),new u.a(()=>z.AFrameworkApplication.sa.Sa.Pod().rLa||"1959943459"),new u.a(()=>z.AFrameworkApplication.Opa),new u.a(()=>z.AFrameworkApplication.GIi));wb.Oj();wb.rPb()});if(z.AFrameworkApplication.X1f){const wb=eb.a.Ar(Oa.a.instance.ie("Common.IEventEmitter<Common.IMruResult>"));nb.Task.WAA.call(null,qa,Xa,wb).continueWith(()=>{const Rb=new wa(new u.a(()=>qa.result),new u.a(()=>Ea.rjj),new u.a(()=>z.AFrameworkApplication.sa.Sa.Pod()),
new u.a(()=>z.AFrameworkApplication.qjj),new u.a(()=>z.AFrameworkApplication.pjj),new u.a(()=>Xa.result),new u.a(()=>wb.result),z.AFrameworkApplication.da);Rb.Nzj();Rb.i3f()})}}dispose(){}}Object(v.a)($a,"UXPackageManager",null,[3,4,5]);var oa=a(260),Fa=a(1),X=a(9),va=a(737),xa=a(62),Pa=a(40),Ka=a(734),Bb=a(199),xb=a(13),Ua=a(142);let Jb=class{constructor(qa){this.Hl=qa}hf(){return!1}executeCommand(qa,Xa,wb){return 2!==this.Hl.Eg(T.a.newDocument,2,wb)?nb.Task.Ua(!0):Bb.a(Xa.command)}Ue(qa,Xa){return 1056925771===
Xa.command}mf(qa,Xa,wb){qa=!0;switch(Xa){case "PopulateNewMenu":this.Hl&&(Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:6883546_ConsumerTemplatesFileNewTrigger")&&z.AFrameworkApplication.CQ("XLS-ConsumerTemplates-Treatment;XLS-ConsumerTemplates-Control"),Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8202919_ConsumerTemplateCG")&&z.AFrameworkApplication.da.na("IsO365ConsumerHost")&&(z.AFrameworkApplication.da.appSettings.TemplateCollectionId="ExcelConsumerWAC",z.AFrameworkApplication.da.appSettings.NumberOfTemplatesInBackstage=
"23"),this.Hl.Eg(T.a.tzc,2,wb));break;default:qa=!1}return qa}};Jb=Object(Ka.a)([Object(Ua.d)(xb.I),Object(Ka.b)(0,Object(xb.c)()),Object(Ka.b)(1,Object(xb.E)()),Object(Ka.b)(2,Object(xb.gc)())],Jb);Object(v.a)(Jb,"CreateNewCommandHandler",null,[169]);var fc=a(94);class ya extends va.a{constructor(qa){super(qa)}yg(){const qa=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(fc.d)(Ua.a.resolve(xb.E,{Oa:this.$a})):xa.GetServiceTaskFactory.create(this.$.ia,
155,this.ma,this.$a),Xa=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateNewAndOpenUX",!1)?Object(fc.d)(Ua.a.resolve(xb.gc,{Oa:this.$a})):xa.GetServiceTaskFactory.create(this.$.ia,165,this.ma,this.$a);Pa.TaskExtensions.Aa(Pa.TaskExtensions.Tg([qa,Xa],this.ma),()=>{this.vg([new Jb(z.AFrameworkApplication.Vd)])},this.ma,3)}static la(qa){va.a.dh(87,new ya(qa))}}Object(v.a)(ya,"CreateNewCommandHandlerFactory",va.a,[]);var ob=a(519),Sb=a(93),Ba=a(202),Ia=a(11),cb=a(22),Kb=a(249),db=
a(468);class gb{}gb.create="Create";gb.activate="Activate";gb.close="Close";gb.remove="Delete";gb.duplicate="Duplicate";Object(v.a)(gb,"Actions",null,[]);var yb=a(34),Nb=a(46);class qc extends nb.Task{constructor(qa){super();this.Uae=null;this.Wae=0;this.zYb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.b1a=this.b1a()}catch(Xa){this.dispose(),this.MEa(Xa),this._state=3}};this.cx=qa;this.b1a=this.hNc;this.moveNext()}hNc(){this.Uae=yb.a.Mf(3,2,0,1667,0,-1244327602,
"MsFormDeleteConfirmation");this.zYb=Nb.a(this.cx.$).ol(this.Uae).G();this.zYb.isCompleted||(this._state=2,this.zYb.xeb(this.moveNext));return this.Szg}Szg(){this.Wae=this.zYb.z2();0===this.Wae&&(this.cx.$.workbookContext.Options=Ia.HelperMethods.DR(!1,this.cx.$.workbookContext.Options,2048),this.cx.deleteMsFormMetaDataSheet());this._state=3;this.JWa(!0)}dispose(){}}Object(v.a)(qc,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",nb.Task,[5]);class Gb{}Gb.action=
"Action";Gb.HWh="FlexPane";Gb.Ihc="formId";Gb.id="id";Gb.title="Title";Gb.JXb="XlWorkbookId";Gb.KYh="Fragment";Gb.host="Host";Gb.Ydk="TopView";Gb.accountType="auth_pvr";Object(v.a)(Gb,"Parameters",null,[]);var hb=a(58);const qb=(qa,Xa,wb,Rb,vc,Nc,id)=>{id=qa.Pa(9,void 0===id?null:id);id.sheetName=Xa;id.confirmationChoice=!0;return hb.g(qa,"DeleteSheet",id,wb,Rb,vc,Nc,0)};class ab{constructor(qa){this.Eq="Excel";this.$=qa;this.lY=db.a.current}get hasMsForm(){return Sb.c(this.$.ih)}get Zuc(){return this.$.workbookContext.MsFormId}get GXb(){return this.$.workbookContext.MsFormDocUrl}get accountType(){return cb.a.contains(this.$.fC.DocumentHostInfo.FileSource,
"onedrive",!0)?"MSA":"OrgId"}hf(qa,Xa){switch(Xa){case -105284469:return!Sb.k(this.$.ih)||this.hasMsForm||Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8155542_MsFormsRibbonAndDisconnectionSupport")&&this.$.workbookContext.HasMsFormsExcelDataSync;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm||Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8155542_MsFormsRibbonAndDisconnectionSupport")&&this.$.workbookContext.HasMsFormsExcelDataSync}return!1}executeCommand(qa,
Xa){qa=Pa.TaskExtensions.Wl();Xa=Xa.command;switch(Xa){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:qa=this.deleteMsForm();break;default:qa=Bb.a(Xa)}return qa}Ue(qa,Xa){if(!this.$.ea.Qj.get(61))return!1;qa=!1;switch(Xa.command){case -105284469:qa=Sb.k(this.$.ih)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:qa=this.hasMsForm}return qa}mf(){return!1}insertMsForm(){const qa=
n.a.Ds(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),Xa={},wb={};Xa[Gb.action]=gb.create;Xa[Gb.accountType]=this.accountType;wb[Gb.action]=gb.create;wb[Gb.JXb]=encodeURIComponent(this.GXb);wb[Gb.host]=this.Eq;wb[Gb.title]=encodeURIComponent(qa);this.rKb(Xa,wb);this.$.workbookContext.Options=Ia.HelperMethods.DR(!1,this.$.workbookContext.Options,2048)}editMsForm(){const qa={},Xa={};qa[Gb.accountType]=this.accountType;Xa[Gb.Ihc]=this.Zuc;Xa[Gb.JXb]=encodeURIComponent(this.GXb);Xa[Gb.host]=
this.Eq;this.rKb(qa,Xa)}previewMsForm(){const qa={},Xa={};qa[Gb.accountType]=this.accountType;Xa[Gb.Ihc]=this.Zuc;Xa[Gb.JXb]=encodeURIComponent(this.GXb);Xa[Gb.host]=this.Eq;Xa[Gb.Ydk]="Preview";this.rKb(qa,Xa)}sendMsForm(){const qa={},Xa={};qa[Gb.accountType]=this.accountType;Xa[Gb.Ihc]=this.Zuc;Xa[Gb.HWh]="SendForm";Xa[Gb.JXb]=encodeURIComponent(this.GXb);Xa[Gb.host]=this.Eq;this.rKb(qa,Xa)}deleteMsForm(){return new qc(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.YH(new Ba.a(158,
0,(qa,Xa,wb)=>qb(this.$.qa.Gz,this.lY.oBb,Kb.b(qa,()=>{this.Yyh()}),Xa,wb,null)))}Yyh(){const qa={},Xa={};qa[Gb.action]=gb.remove;qa[Gb.accountType]=this.accountType;Xa[Gb.action]=gb.remove;Xa[Gb.host]=this.Eq;Xa[Gb.Ihc]=encodeURIComponent(this.Zuc);Xa[Gb.JXb]=encodeURIComponent(this.GXb);this.rKb(qa,Xa)}rKb(qa,Xa){const wb=this.$.xa.MsFormBaseUrl+"/Pages/DesignPage.aspx";let Rb="";var vc="";if(Xa){for(let Id in Xa){var Nc=Id,id=Xa[Id];vc+=vc.length?"&":"";vc+=Nc+"="+id}qa||(qa={});qa[Gb.KYh]=encodeURIComponent(vc)}if(qa)for(let Id in qa)Xa=
Id,vc=qa[Id],Rb+=Rb.length?"&":"?",Rb+=Xa+"="+vc;window.open(wb+Rb,"_blank")}}Object(v.a)(ab,"MsFormCommandHandler",null,[169]);class Mb extends va.a{constructor(qa){super(qa)}yg(){const qa=xa.GetServiceTaskFactory.create(this.$.ia,203,this.ma,this.$a);Pa.TaskExtensions.Aa(Pa.TaskExtensions.Tg([qa],this.ma),()=>{this.vg([new ab(this.$)])},this.ma,3)}static la(qa){qa.ea.Qj.get(61)&&va.a.dh(215,new Mb(qa))}}Object(v.a)(Mb,"MsFormCommandHandlerFactory",va.a,[]);var Ib=a(233);class fb extends Ib.a{constructor(qa){super();
this.$=qa;this.Oe()}create(){Pa.TaskExtensions.Aa(Object(fc.d)(Ua.a.resolve(xb.fc,{Oa:this.$a})),()=>{this.ve(new $a)},this.ma,3)}}Object(v.a)(fb,"NewAndOpenUXFactory",Ib.a,[]);let Db=class{constructor(qa,Xa){this.Hl=Xa;this.$=qa}executeCommand(qa,Xa,wb){qa=2;switch(Xa.command){case T.a.openUrlInNewTab:qa=this.Hl.Eg(T.a.openUrlInNewTab,2,wb);break;case T.a.YTa:qa=this.Hl.Eg(T.a.YTa,2,wb)}return 2!==qa?nb.Task.Ua(!0):Bb.a(Xa.command)}Ue(qa,Xa){return Xa.command===T.a.openUrlInNewTab||Xa.command===
T.a.YTa}mf(qa,Xa,wb){return"PopulateMruMenu"===Xa?(this.Hl.Eg(T.a.szc,2,wb),!0):!1}hf(){return!1}};Db=Object(Ka.a)([Object(Ua.d)(xb.nc),Object(Ka.b)(0,Object(xb.fb)()),Object(Ka.b)(1,Object(xb.c)()),Object(Ka.b)(2,Object(xb.E)()),Object(Ka.b)(3,Object(xb.gc)())],Db);Object(v.a)(Db,"OpenFromMruCommandHandler",null,[169]);class Za extends va.a{constructor(qa){super(qa)}yg(){const qa=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCommonUiStrings",!1)?Object(fc.d)(Ua.a.resolve(xb.E,
{Oa:this.$a})):xa.GetServiceTaskFactory.create(this.$.ia,155,this.ma,this.$a),Xa=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateNewAndOpenUX",!1)?Object(fc.d)(Ua.a.resolve(xb.gc,{Oa:this.$a})):xa.GetServiceTaskFactory.create(this.$.ia,165,this.ma,this.$a);Pa.TaskExtensions.Aa(Pa.TaskExtensions.Tg([qa,Xa],this.ma),()=>{this.vg([new Db(this.$,z.AFrameworkApplication.Vd)])},this.ma,3)}static la(qa){va.a.dh(88,new Za(qa))}}Object(v.a)(Za,"OpenFromMruCommandHandlerFactory",va.a,[]);
var sb=a(181),sa=a(30),ba=a(245),ua=a(192),R=a(238),Y=a(73),La=a(59),Ma=a(219),lb=a(607),pb=a(91),Vb=a(20),Wa=a(262),ka=a(223),Sa=a(14);class Xb extends ka.a{constructor(qa,Xa,wb,Rb){super(qa,wb,2,void 0===Rb?null:Rb);this.JTc=null;this.Lz=()=>{const vc=this.v$h();this.hQa.setAttribute("width",vc.x.toString());this.hQa.setAttribute("height",vc.y.toString());this.Bkk(vc);this.sLd()};this.xUe=Xa;this.$.cC(this.Lz);this.kmc()}get hQa(){return this.JTc}initialize(){const qa=this.$.He+"iframeDialog_frame",
Xa=this.$.He+"iframeDialog";this.Ce.style.margin=Ia.HelperMethods.yf(0);this.Ce.style.marginBottom=Ia.HelperMethods.yf(-2);const wb=document.createElement("iframe");wb.id=qa;wb.frameBorder="0";wb.scrolling="auto";wb.src=this.Dbf(Xa);this.Ce.appendChild(wb);this.JTc=document.getElementById(qa);this.domElement.id=Xa;this.Lz(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.JE(this.Lz);super.dispose()}setFocus(){Sa.DOMElementExtensions.setFocus(this.hQa)}onHide(){this.hQa.contentWindow.close();
Sa.DOMElementExtensions.xi(this.hQa);this.JTc=null;super.onHide()}Bkk(qa){const Xa=this.domElement.style;Xa.width=Ia.HelperMethods.yf(qa.x);Xa.marginLeft=Ia.HelperMethods.yf(-qa.x/2)}v$h(){const qa=Sa.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*qa.width),this.xUe.x),Math.min(Math.floor(.9*qa.height),this.xUe.y))}}Object(v.a)(Xb,"IFrameDialog",ka.a,[]);var Mc=a(6),jc=a(12);class $c extends Xb{constructor(qa){super(qa,new Sys.UI.Point(960,680),jc.a.instance.ha(1264));
this.name=Mc.a.NYe}get Pe(){return"EmbeddingDialog"}Dbf(qa){const Xa=new Sys.StringBuilder(this.$.xa.EmbedConfiguratorUrl);Ma.a.Zp(Xa,Mc.a.yJh,qa);return Xa.toString()}onShow(){x.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(v.a)($c,"EmbeddingDialog",Xb,[]);var Jd=a(901),fd=a(96),Kd=a(65),Yd=a(780);class te{}te.khg="FrameDialog_ShareFromEdit";te.view="FrameDialog_View";te.AMe="FrameDialog_CloseAndRefresh";te.vYj="FrameDialog_ShareFromView";
te.edit="FrameDialog_Edit";te.Sxj="FrameDialog_RefreshGrid";te.Uih="FrameDialog_CloseMe";te.GMe="FrameDialog_CloseMeError";te.ready="FrameDialog_Ready";te.jnj="FrameDialog_PleaseClose";te.yN="GotoRange";Object(v.a)(te,"PostMessageConstants",null,[]);var ve=a(323),qe=a(127),pc=a(234);class nd{constructor(){this.yN=null;this.dPd=1461300262}}Object(v.a)(nd,"SessionUpdateContext",null,[]);class qd extends Xb{constructor(qa,Xa,wb){super(qa,new Sys.UI.Point(qd.syh,qd.Rxh),jc.a.instance.ha(Xa?1269:1268));
this.f6a=null;this.cVc=!1;this.ayc=Rb=>{const vc=this.$,Nc=new nd;Nc.yN=Rb.Values[te.yN];let id=!1;switch(Rb.MessageId){case te.khg:this.qy();id=!0;Nc.dPd=1334518759;break;case te.view:this.Nsa=jc.a.instance.ha(1269);this.hwg(!0);break;case te.AMe:this.qy(),id=!0}Rb=new Ba.a(140,0,(Id,me,Wb)=>ve.p(vc.qa.ua,Kb.b(Id,this.Xfj),me,Wb,Nc));Rb.flags=id?16:80;vc.userOperationManager.enqueueOperation(Rb,this.Yf)};this.y8i=()=>{const Rb=this.$;Rb.xa.SurveyRedirectUrl?(this.qy(),Rb.rf(1305810481,0,8,null)):
(this.Nsa=jc.a.instance.ha(1268),this.hwg(!1))};this.kgj=()=>{const Rb=this.$;this.qy();Rb.rf(1334518759,0,8,null)};this.iwc=Rb=>{const vc=this.$;this.qy();Rb.MessageId===te.GMe&&vc.ea.Vld()};this.Gej=()=>{this.cVc=!0;this.raiseEvent(qd.hEd)};this.Xfj=(Rb,vc)=>{if(!pc.a(Rb)){Rb=this.$;if(vc.yN){const Nc=Rb.ea.ta;if(Nc.contains(vc.yN.SheetName))this.Wwc(vc);else{let id=null;id=()=>{Nc.jra(id);this.Wwc(vc)};Nc.Oka(id)}}1461300262!==vc.dPd&&Rb.rf(vc.dPd,0,8,null)}};this.Uba=Xa;this.Yf=wb}I_g(qa){this.addHandler(qd.hEd,
qa)}YDj(qa){this.removeHandler(qd.hEd,qa)}get Pe(){return"FormDialog"}get Htf(){return this.cVc}get xbb(){return this.Uba}dispose(){fd.a.Ma(this.f6a);this.f6a=null;super.dispose()}initialize(){super.initialize();const qa=Kd.a.vN(this.$.xa.FormLightBoxUrl),Xa=this.f6a=new Jd.a(this.hQa.contentWindow,qa);Xa.isEnabled()&&Xa.KS(qa)&&(this.cra(te.khg,this.ayc),this.cra(te.view,this.ayc),this.cra(te.AMe,this.ayc),this.cra(te.vYj,this.kgj),this.cra(te.edit,this.y8i),this.cra(te.Sxj,this.ayc),this.cra(te.ready,
this.Gej),this.cra(te.Uih,this.iwc),this.cra(te.GMe,this.iwc))}close(qa){qa===this.oT&&this.Htf&&this.f6a.send(new Yd.a(te.jnj))||super.close(qa)}Dbf(){return this.bRe(this.xbb)}bRe(qa){const Xa=this.$.xa,wb=new Sys.StringBuilder(Xa.FormLightBoxUrl);Ma.a.Zp(wb,Mc.a.tYh,this.$.ea.sessionId);Ma.a.Zp(wb,Mc.a.rYh,qa?Mc.a.sYh:Mc.a.qYh);qe.a.cub(wb,Xa);return wb.toString()}hwg(qa){this.cVc=!1;this.hQa.src=this.bRe(qa);this.Uba=qa}cra(qa,Xa){this.f6a.yn(qa);this.f6a.tm(qa,Xa)}Wwc(qa){const Xa=this.$.ea.ta.getItemByName(qa.yN.SheetName);
Xa&&0===Xa.lD&&Vb.h(this.$).Wj(qa.yN,null,null,null,20,"FormDialog.OnItemInserted")}}qd.syh=900;qd.Rxh=1200;qd.hEd="lightBoxReady";Object(v.a)(qd,"FormDialog",Xb,[172]);var tb;(function(qa){qa[qa.comment=10]="comment";qa[qa.range=12]="range";qa[qa.table=13]="table";qa[qa.chart=14]="chart";qa[qa.sheet=15]="sheet";qa[qa.namedSheetView=16]="namedSheetView"})(tb||(tb={}));Object(v.b)("NavigationType",tb);var Dc=a(1034),Tc=a(140),ub=a(18),Pb=a(572),ee=a(1E3),Ad=a(297),Ub=a(794),tc=a(54);class yc extends Ub.a{constructor(qa,
Xa,wb,Rb,vc,Nc,id){Nc=void 0===Nc?0:Nc;super(qa,jc.a.instance.ha(Xa),!1);this.De=null;this.message=wb;this.e4i=Rb;this.kae=vc;this.operationFlags=Nc;this.De=id}get Pe(){return"WebMethodConfirmationDialog"}get bF(){return 1005}get iMa(){return this.operationFlags}initialize(){let qa="<div class='"+Tc.a.nv+"'>\r\n\t<div class='"+Tc.a.c0e+"'>\r\n\t\t<div class='"+ub.a.tMe+"'>\r\n\t\t\t<img src='{0}' class='"+ub.a.K2e+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+Tc.a.e0e+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";
qa=String.format(qa,tc.a.Bj(13),jc.a.instance.ha(25),jc.a.instance.ha(this.message));this.De.dl(this.Ce,qa);this.addButton(0,this.e4i);this.addButton(1);super.initialize()}jK(){return this.kae}}Object(v.a)(yc,"WebMethodConfirmationDialog",Ub.a,[]);class Sd extends Dc.a{constructor(qa,Xa){super(qa,jc.a.instance.ha(1271));this.De=this.SYa=this.uWa=this.Ha=null;this.GUf=()=>{const wb=this.$;this.qy();const Rb=new yc(wb,1274,1275,1276,(vc,Nc,id)=>{var Id=wb.qa.ua.ze(),me=wb.qa.ua;Id=me.Pa(1,Id);return hb.g(me,
"UnshareForm",Id,vc,Nc,id,null,0)},16,this.De);Rb.initialize();Rb.Zi()};this.De=Xa}get Pe(){return"ShareFormDialog"}dispose(){this.SYa&&this.SYa.X$(this.GUf);fd.a.df([this.Ha,this.uWa,this.SYa]);this.SYa=this.uWa=this.Ha=null;super.dispose()}initialize(){let qa="<div class='"+Tc.a.nv+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+Tc.a.zfc+"'>\r\n\t<input type='text' id='{1}' class='"+Tc.a.hN+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
qa=String.format(qa,jc.a.instance.ha(1272),"sfd_input","sfd_unshare",ub.a.rC,jc.a.instance.ha(1273));this.De.dl(this.Ce,qa);this.Ha=new Ad.a(this.getElementById("sfd_input"));this.uWa=new ee.a(this.Ha.domElement);this.SYa=Pb.a.create(this.getElementById("sfd_unshare"));this.SYa.S0(this.GUf);this.Ha.text=jc.a.instance.ha(736);this.Ha.enabled=!1;this.Ha.readOnly=!sa.a.Dj;this.addButton(1,10);super.initialize()}A4a(){return(qa,Xa,wb)=>{var Rb=this.$.qa.ua.ze(),vc=this.$.qa.ua;qa=this.$8a(qa);Xa=this.HOa(Xa);
Rb=vc.Pa(1,Rb);return hb.g(vc,"ShareForm",Rb,qa,Xa,wb,null,0)}}R3(qa,Xa,wb){this.Ha.text=qa.Result;this.Ha.enabled=!0;Sa.DOMElementExtensions.setVisible(this.SYa.domElement,!0);super.R3(qa,Xa,wb)}setFocus(){if(this.Ha&&this.Ha.enabled)try{this.Ha.focus();return}catch(qa){}super.setFocus()}}Object(v.a)(Sd,"ShareFormDialog",Dc.a,[]);var Fd=a(259),se=a(7),uc=a(88),Ra=a(265),vb=a(74),Gc=a(643),cd=a(159),Cd=a(435),Rd=a(268),Be=a(17),ad=a(266),Qc=a(29);class Zd extends ua.a{constructor(qa,Xa,wb){super();
this.eJe=this.fJe=!1;this.Y7a=0;this.Oma=!1;this.G5i=()=>{this.fJe=!0;this.wjg()};this.$=qa;this.Wa=Xa;this.tN=wb;vb.a(this.$).JSd(new cd.a(se.a.Ztg,se.a.idle,Zd.Jfh),new Fd.a(se.a.FMe,se.a.mZ,null,se.a.dS,se.a.idle))}get WMc(){return Sb.b(this.$.ih)}get VXd(){return this.$.isEditMode&&(this.$.ea.CEh||this.$.sU)}hf(qa,Xa){switch(Xa){case 353606613:case -1099009678:case 192430811:return!Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||this.n1d();case 783415632:return!Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")||
this.n1d();case 709515373:return!Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyLinkContextMenu",!1)||this.n1d();case 869186573:return this.Vhg();case -1570751769:case 1986648902:return 131072!==(this.$.TT&131072);case 330035228:return!(this.w8a(!0)&&this.WMc);case -509039657:return!(this.w8a()&&this.WMc);case 1334518759:return!(this.w8a()&&this.WMc&&this.rJe())}return!1}n1d(){return this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||this.Vhg()}Vhg(){const qa=this.$.workbookContext.FullDocumentInfo,
Xa=Rd.a()&&this.$.ea.Qj.get(5);return!qa.FileSharingUrl&&!Xa}executeCommand(qa,Xa,wb){qa=this.$.workbookContext.FullDocumentInfo;var Rb=T.a.workflow,vc=Pa.TaskExtensions.Wl();const Nc=Xa.command;if(Nc===Rb||-266099===Nc)return this.Bqi(Xa,Rb,qa);switch(Nc){case 1986648902:this.Agg();break;case -1570751769:this.Oni(Xa);break;case 869186573:Xa=T.a.uYj;vc=z.AFrameworkApplication.da.na("ShareMenuIsEnabled");Rb=null;(Fa.EwaSettings.Fa(478)||vc)&&wb&&"CopyLink"===wb.SourceControlId?(Rb={},Rb[L.a.$ib]="copy",
Xa=T.a.q0d):vc&&wb&&"ManageAccess"===wb.SourceControlId?(Rb={},Rb[L.a.$ib]="manageAccess",Xa=T.a.wYj):wb&&"LinkToComment"===wb.SourceControlId?(Rb={},Rb[L.a.$ib]="copy",Rb[L.a.r0d]=wb.navId,Xa=T.a.q0d):Qc.a.Yuf()&&wb&&"SaveAsCopyLink"===wb.SourceControlId&&(Rb={},Rb[L.a.$ib]="copy",Xa=T.a.q0d);vc=this.Hkg(qa,Rb);D.c(Xa);break;case -1099009678:vc=this.iTb(12,qa);break;case 192430811:vc=this.iTb(13,qa);break;case 353606613:vc=this.iTb(14,qa);break;case -1592351768:vc=ba.a.Ua(!0);Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelNamedSheetView",
!1)&&(vc=this.iTb(16,qa));break;case 783415632:wb&&"LinkToThisSheet"===wb.SourceControlId&&x.ULS.sendTraceTag(509691100,0,50,"SocialSharingCommandHandler.ExecuteCommand: Share Sheet invoked from Collab Corner");vc=this.iTb(15,qa);break;case -59906385:case 1197060601:this.Ipi(Xa,qa);break;case 1305810481:this.ojf(!1,Xa);break;case 330035228:this.ojf(!0,Xa);break;case -509039657:wb=Object(fc.d)(Ua.a.resolve(xb.Mb,{Oa:0}));Pa.TaskExtensions.Aa(wb,id=>{this.deleteForm(id.result)},this.$.ma,3);break;case 1334518759:Xa.tGb=
!0;wb=Object(fc.d)(Ua.a.resolve(xb.Mb,{Oa:0}));Pa.TaskExtensions.Aa(wb,id=>{this.shareForm(id.result)},this.$.ma,3);break;case 710925581:La.a.Ji.jGc("710925581")&&(vc=Pa.TaskExtensions.Aa(this.tN.value,id=>{id.result.sendMessage(J.a.conversation,{})},this.ma,3));break;case 327119921:this.zni();break;default:vc=Bb.a(Nc)}return vc}Ue(qa,Xa){var wb;qa=!1;Xa=Xa.command;if(Xa===T.a.workflow)return!0;switch(Xa){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:qa=
!0;break;case 353606613:case -1099009678:case 192430811:qa=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&!this.$.ea.isNamedObjectViewMode;break;case -1592351768:Xa=this.$.ta.pa;qa=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelNamedSheetView",!1)&&!this.$.ea.isNamedObjectViewMode&&!(null===(wb=null===Xa||void 0===Xa?void 0:Xa.Ag)||void 0===wb?0:wb.fL);break;case 783415632:qa=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")&&
!this.$.ea.isNamedObjectViewMode;break;case 709515373:qa=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyLinkContextMenu",!1)&&!this.$.ea.isNamedObjectViewMode}return qa}mf(qa,Xa,wb){if("PopulateFormMenu"===Xa){Xa=this.WMc?this.rJe()?Zd.sSh:Zd.tSh:Zd.u1i;qa=this.Wa.Ze();for(let Rb=0;Rb<Xa.length;Rb++)qa.buttons.push(this.Wa.Ld(Xa[Rb]));Xa=this.Wa.Pr("Forms.Flyout");Xa.Le.push(qa);wb.MenuItems=Xa.yH();return!0}return!1}Bqi(qa,Xa,wb){return this.VXd&&qa.command===Xa?(this.TXd(qa,-266099),
Pa.TaskExtensions.Kea()):Pa.TaskExtensions.Aa(this.tN.value,Rb=>{lb.a(Rb.result,J.a.workflow,null,wb.WorkflowPostMessage)||Ia.HelperMethods.rh(wb.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ma,3)}rJe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Qj.get(26)}zni(){var qa=sb.a.create().toString();x.ULS.sendTraceTag(528581128,306,50,`Calling share to teams deeplink with ID: ${qa}`);var Xa=this.$.frame,wb=Xa.Sdb,Rb=this.$;const vc=new ad.QueryStringBuilder(z.AFrameworkApplication.da.Ra("TeamsMeetingShareEndpoint"));
vc.ul("deeplinkId",qa);vc.ul("lm","deeplink");qa=vc.ul;var Nc={};const id=new ad.QueryStringBuilder(z.AFrameworkApplication.da.Ra("TeamsAppSharingUrl"));id.ul("auth","2");id.ul("flight","officeunihost");id.ul("source","deepLink_online");var Id={};Id.fileType=n.a.A8(Rb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);Id.objectUrl=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8053799_EncodeUrlFixForDeeplink")?encodeURI(Rb.workbookContext.FullDocumentInfo.WorkbookPath):Rb.workbookContext.FullDocumentInfo.WorkbookPath;
Id.baseUrl=Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8053799_EncodeUrlFixForDeeplink")?encodeURI(Rb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl):Rb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{Rb=Rb.workbookContext.WorkbookFileVersionId;let me=decodeURIComponent(Rb);for(;Rb!=me;)Rb=me,me=decodeURIComponent(Rb);0>Rb.indexOf("{")||0>Rb.indexOf("}")?(x.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${Rb}`),Rb=""):Rb=Rb.substring(Rb.indexOf("{")+
1,Rb.indexOf("}")).toLowerCase()}Id.fileId=Rb;Id=Z.c(Z.c(Id));id.ul("subEntityId",Id.substring(1,Id.length-1));Nc.appSharingUrl=id.toString();Nc.appId=z.AFrameworkApplication.da.Ra("TeamsAppId");Nc.useMeetNow=!0;Nc=JSON.stringify(Nc);qa.call(vc,"appContext",Nc);wb.call(Xa,vc.toString(),!0)}Oni(qa){this.VXd?this.TXd(qa,1986648902):this.Agg()}ojf(qa,Xa){!qa&&this.$.xa.SurveyRedirectUrl?this.Vrj():(qa=new qd(this.$,qa,Xa),qa.initialize(),qa.Zi())}Ipi(qa,Xa){this.VXd&&1197060601===qa.command?this.TXd(qa,
-59906385):Pa.TaskExtensions.Aa(this.tN.value,wb=>{wb=wb.result;wb&&lb.a(wb,J.a.replyWithChanges,null,this.$.ea.Qj.get(8))||(wb=new Sys.StringBuilder(Xa.ReplyWithChangesUrl),Ma.a.Zp(wb,Cd.e,Cd.d),R.a.ntw(wb.toString(),this.$))},this.ma,3)}TXd(qa,Xa){const wb=vb.a(this.$).Pf.activityState,Rb=new pb.a(Xa,qa.method,qa.mode,qa.hh,qa.tabName);Nb.a(this.$).Ts(new Wa.a(se.a.Cx,5,()=>{wb[Ra.a.er]=se.a.Fag;wb[Gc.a.S2c]=Rb;this.$.Jn.bC("SocialSharingSaveBeforeCommand");this.$.Jn.aze(Rb.command)}))}Agg(){const qa=
this.$.xa.DocumentHostInfo;qa.HostEmbeddedViewUrl||this.fJe?this.wjg():this.$.Kg.get(53)&&Pa.TaskExtensions.Aa(this.tN.value,Xa=>{this.ihk(Xa.result)||R.a.ntw(qa.FileEmbedCommandUrl,this.$)},this.ma,3)}ihk(qa){return qa.isEnabled()&&(this.eJe||(this.eJe=qa.tm(J.a.dJe,this.G5i)))?qa.sendMessage(J.a.TTh,null):!1}wjg(){if(sa.a.Xr)R.a.ntw(this.$.xa.EmbedConfiguratorUrl,this.$);else{const qa=new $c(this.$);qa.initialize();qa.Zi()}}deleteForm(qa){const Xa=this.$;qa=new yc(Xa,1277,1278,1270,(wb,Rb,vc)=>
{var Nc=Xa.qa.ua.ze(),id=Xa.qa.ua;Nc=id.Pa(9,Nc);Nc.surveyId=null;return hb.g(id,"DeleteSurvey",Nc,wb,Rb,vc,null,0)},0,qa);qa.initialize();qa.Zi()}shareForm(qa){const Xa=this.$.workbookContext.FullDocumentInfo;this.$.ea.Qj.get(26)?(qa=new Sd(this.$,qa),qa.initialize(),qa.Zi()):Pa.TaskExtensions.Aa(this.tN.value,wb=>{lb.a(wb.result,J.a.shareForm,{[L.a.D$j]:this.$.workbookContext.SurveyTitle},this.$.ea.Qj.get(10))||R.a.ntw(Xa.ShareFormCommandUrl,this.$)},this.ma,3)}Vrj(){const qa=this.$;qa.xa.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]",
"gi"),"");const Xa=new Sys.StringBuilder(qa.xa.SurveyRedirectUrl);Ma.a.Zp(Xa,"startupDialog","FormEdit");const wb=vb.a(this.$),Rb=wb.Pf.activityState;Rb[uc.a.A6]=Xa.toString();Rb[uc.a.vP]=uc.a.sId;this.$.Jn.bC("SocialSharingEnvironmentChange");Nb.a(qa).Ts(new Wa.a(se.a.Cx,5,()=>{const vc=yb.a.Mf(3,2,1322,1323,1324,554412057,"FossEnvironmentUnsupported");wb.Pf.rt([vc]);Rb[Ra.a.er]=se.a.Ztg}))}w8a(qa){return(this.$.ea.isEditMode||(void 0===qa?!1:qa))&&this.$.ea.Qj.get(25)&&Rd.a()}yhi(qa){var Xa=void 0===
Xa?null:Xa;const wb=Vb.h(this.$).ga;let Rb=!1;const vc=this.$.ta.pa?Y.d(this.$.ta.pa):null;if(!vc)return x.ULS.sendTraceTag(537151649,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${tb[qa]}.`),null;switch(qa){case 14:Xa=this.Vgi(wb);break;case 12:Xa=wb.kma;Xa=cb.a.contains(Xa,"!",!0)?Xa.split("!")[1]:Xa;Vb.h(this.$).ga.ra.XK()&&(Rb=!0);break;case 13:var Nc=wb.ra.selectedRanges;Nc[0]&&(Nc=Nc[0],Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8116498_FShareTableContainingActiveCell")&&
(Nc=Vb.h(this.$).ga.ra.activeCell),Nc=Vb.h(this.$).Ud.Di(Nc),Nc.activate({scenario:"namedObject"}),Nc&&(Xa=Nc.Xl));break;case 16:Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelNamedSheetView",!1)&&(Xa=this.$.ta.pa,Xa=null===(Nc=null===Xa||void 0===Xa?void 0:Xa.Ag)||void 0===Nc?void 0:Nc.IS)}if(!Xa&&15!==qa)return x.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${tb[qa]}`),
null;Nc={};Nc[L.a.$ib]="copy";Nc[L.a.r0d]=this.J7h(qa,Xa,vc);Nc[L.a.xYj]="deepLinkShare";x.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${tb[qa]} and sectionNameOrId: ${Xa} and SheetId: ${vc} and isPartialTable: ${Rb}`);return Nc}Vgi(qa){if(qa.Ta.isFloatingObjectSelected&&(qa=qa.Ta.Fe.floatingObject)&&0===qa.type){const Xa=qa.id.split(".");if(1<Xa.length)return Xa[1];x.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${qa.id}`)}return null}J7h(qa,
Xa,wb){let Rb=qa+"_";Rb=btoa(15===qa?Rb+wb:Rb+(Xa+"_"+wb));Rb=Rb.replace(RegExp("\\+","g"),"-");Rb=Rb.replace(RegExp("\\/","g"),"_");return Rb=Rb.replace(RegExp("\\=+$","g"),"")}Hkg(qa,Xa,wb){wb=void 0===wb?!1:wb;return Pa.TaskExtensions.Aa(this.tN.value,Rb=>{lb.a(Rb.result,J.a.sharing,Xa,this.$.ea.Qj.get(5))?(x.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${Xa?Xa[L.a.$ib]:""}`),wb&&Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")&&
!this.Oma&&(this.Y7a=window.setInterval(()=>{this.bfk()},6E4),this.Oma=!0)):Ia.HelperMethods.rh(qa.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ma,3)}iTb(qa,Xa){if(15===qa&&!Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8096933_ShareExcelSheet")||15!==qa&&!Fa.EwaSettings.isChangeGateEnabled("OfficeVSO:8096934_ShareExcelSection")||this.$.isMobileMode)return null;const wb=this.yhi(qa);if(wb)return x.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${wb[L.a.r0d]}`),
this.Hkg(Xa,wb,!0);x.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${tb[qa]}`);return null}bfk(){this.Oma&&window.clearInterval(this.Y7a);this.$.rf(638984051,0,0,null);x.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered.")}}Zd.u1i=[103];Zd.sSh=[107,104,105,106];Zd.tSh=[104,105];Zd.Jfh=[new Be.a(se.a.FMe,554412057,0,0,1325),new Be.a(se.a.idle,554412057,
0,1)];Object(v.a)(Zd,"SocialSharingCommandHandler",ua.a,[169]);class Tb extends va.a{constructor(qa){super(qa)}yg(){const qa=new u.a(()=>xa.GetServiceTaskFactory.create(this.$.ia,137,this.ma,this.$a));Pa.TaskExtensions.Aa(xa.GetServiceTaskFactory.create(this.$.ia,102,this.ma,this.$a),Xa=>{this.vg([new Zd(this.$,Xa.result,qa)])},this.ma,3)}static la(qa){va.a.dh(114,new Tb(qa))}}Object(v.a)(Tb,"SocialSharingCommandHandlerFactory",va.a,[]);var Yc=a(180),Ob=a(385),kc=a(153),Kc=a(187);class Wc{static rY(){return kc.a.Gq(Wc.Rn,
Kc.a.za(444))}}Wc.Rn="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(v.a)(Wc,"NamedSheetViewTeachingDialogHtml",null,[]);var Nd=a(76),Ud=a(186),$d=a(55);class $b extends Ob.a{constructor(qa){super(qa);this.stopwatch=
this.xw=null;this.F0i=Xa=>{if(1===Xa)this.$.Ga.Sd(new pb.a(-2050946363,Nd.a.Td,2,8,null)).continueWith(wb=>{this.xw.setResult(!Ud.a(wb)&&wb.result)}),Xa="Yes";else{const wb=2===Xa;this.xw.setResult(wb);Xa=2===Xa?"No":"Close";wb&&this.mqj()}this.zUi(Xa);this.hide()}}get Pe(){return"ShowNamedSheetViewTeachingDialog"}Ni(){this.ke=4;this.stopwatch=this.$.pe.xf("UserAction",this.Pe);const qa=jc.a.instance.ha(1913);this.ti=Wc.rY();this.xw=new Yc.a;this.initializeAndShow(qa,this.F0i,{});return this.xw.task}LB(qa){super.LB(qa);
this.Ke(1,jc.a.instance.ha(1915));this.Ke(2,jc.a.instance.za(457))}mqj(){this.$.ea.nId=!1}zUi(qa){const Xa={};Xa.a=this.$.xa.UserSessionId;Xa.b="NamedSheetViewTeachingDialogClose";Xa.c=qa;Xa.e=!0;this.stopwatch&&(this.stopwatch.stop(),Xa.d=this.stopwatch.pf);$d.b().Ih(53,Xa,!0)}}Object(v.a)($b,"NamedSheetViewTeachingDialog",Ob.a,[]);var nc=a(162);let Oc=class{constructor(qa){this.$=qa}wXa(){return this.J0j()?(new $b(this.$)).Ni():nb.Task.Ua(!0)}J0j(){const qa=this.$.ta.pa;return this.$.ea.jTa&&this.$.ea.nId&&
!qa.Ag.yv&&this.$.ea.eN&&!Object(nc.f)(this.$)&&!this.$.ea.Je.allowViewCollab}};Oc=Object(Ka.a)([Object(Ua.d)(xb.cc),Object(Ka.b)(0,Object(xb.fb)())],Oc);Object(v.a)(Oc,"NamedSheetViewPublic",null,[267]);var Hd=a(2),re=a(198),fe=a(1252),oc=a(911),Xc=a(472);class ud{constructor(qa,Xa,wb,Rb,vc,Nc,id){this.title=qa;this.body=Xa;this.yqj=wb;this.primaryButtonAction=Rb;this.secondaryButtonAction=Nc;this.ccg=vc;this.targetObject=id}}Object(v.a)(ud,"NamedSheetViewTeachingCalloutContent",null,[]);class Vd{constructor(qa){this.bve=
0;this.Zog=qa}get Xog(){return this.bve}get gsj(){return this.Xog<this.Zog.count?this.Zog.ka(this.bve++):null}}Object(v.a)(Vd,"NamedSheetViewTeachingCalloutList",null,[]);var ge=a(1089),Je;let Ke=Je=class{constructor(qa){this.$=qa;this.stopwatch=this.F7b=this.eJc=this.J5d=null;this.Yog=0}wwi(qa){this.Yog=qa;const Xa=Object(Hd.a)(new re.a,{});Je.MFi(qa)?(Xa.add(new ud(jc.a.instance.za(446),jc.a.instance.za(447),jc.a.instance.ha(1943),()=>{this.R9(2,"Continue");this.Zda(!0)},jc.a.instance.ha(1944),
()=>{this.Zda();this.R9(1,"ExitGuide")},ge.a())),1===qa&&Xa.add(new ud(jc.a.instance.ha(1945),jc.a.instance.za(449),jc.a.instance.ha(1943),()=>{this.R9(2,"FirstEnterTempViewContinueSecond");this.Zda(!0)},jc.a.instance.ha(1944),()=>{this.Zda();this.R9(1,"FirstEnterTempViewExitGuideSecond")},ge.a())),Xa.add(new ud(jc.a.instance.za(450),jc.a.instance.za(451),jc.a.instance.ha(1943),()=>{this.R9(2,"FirstEnterExitCalloutContinue");this.Zda(!0)},jc.a.instance.ha(1944),()=>{this.Zda();this.R9(1,"FirstEnterExitCalloutGuide")},
Je.hci())),Xa.add(new ud(jc.a.instance.ha(1946),jc.a.instance.za(448),jc.a.instance.ha(1947),()=>{this.F3j();this.Zda();this.R9(1,"LearnMore")},jc.a.instance.ha(1948),()=>{this.Zda();this.R9(1,"Done")},Je.gci()))):2===qa&&Xa.add(new ud(jc.a.instance.ha(1945),jc.a.instance.za(449),jc.a.instance.ha(1942),()=>{this.Zda();this.R9(1,"EnterTempViewAfterPersistedView")},null,null,ge.a()));this.J5d=new Vd(Xa)}F3j(){const qa=new pb.a(-859308420,Nd.a.Td,this.$.Ie,9,null);this.$.Ga.Sd(qa,{[Nd.a.di]:"HelpID=SheetViews",
["InputMethod"]:Nd.a.Td,[Nd.a.qf]:Mc.a.AN,["ShouldCanvasTakeFocus"]:!0})}show(qa){this.wwi(qa);this.Cjb()}SUj(qa){this.F7b=qa}Cjb(){var qa=this.J5d.gsj;if(qa){var Xa=Object(Hd.a)(new fe.a,{label:qa.yqj,onExecute:qa.primaryButtonAction}),wb=null;qa.ccg&&(wb=Object(Hd.a)(new fe.a,{label:qa.ccg,onExecute:qa.secondaryButtonAction}));qa=Object(Hd.a)(new oc.a,{target:qa.targetObject,content:qa.body,title:qa.title,showCloseIcon:!0,primaryButtonProps:Xa,secondaryButtonProps:wb,useTeachingStyles:!0});qa=this.F7b.callout(qa);
Xa=Object(Hd.a)(new Xc.a,{onShow:()=>{this.R9(0)}});this.eJc=this.F7b.addNotification(qa,Xa)}}dismiss(){this.Zda();this.R9(1,"DismissedByOthers")}Zda(qa){qa=void 0===qa?!1:qa;this.eJc&&(this.F7b.removeNotification(this.eJc),this.eJc=null);qa&&this.Cjb()}R9(qa,Xa){const wb={};wb.a=this.$.xa.UserSessionId;wb.b=this.Yog;wb.c=this.J5d.Xog;wb.d=qa;wb.e=void 0===Xa?null:Xa;0===qa?this.stopwatch=this.$.pe.xf("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),wb.f=this.stopwatch.pf,
this.stopwatch=null),2===qa&&(this.stopwatch=this.$.pe.xf("UserAction","ShowNamedSheetViewTeachingCalloutNext")));$d.b().Ih(52,wb,!0)}static gci(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static hci(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static MFi(qa){return 0===qa||1===qa}};Ke=Je=Object(Ka.a)([Object(Ua.d)(xb.dc),Object(Ka.b)(0,Object(xb.fb)())],Ke);Object(v.a)(Ke,"NamedSheetViewTeachingCallout",null,[268]);let nf=class{constructor(qa){this.Hl=
qa}executeCommand(qa,Xa,wb){return 2!==this.Hl.Eg(T.a.tryOfficeThroughTellMe,2,wb)?nb.Task.Ua(!0):Bb.a(Xa.command)}Ue(qa,Xa){return 215809929===Xa.command}mf(){return!1}hf(){return!1}};nf=Object(Ka.a)([Object(Ua.d)(xb.td),Object(Ka.b)(0,Object(xb.c)())],nf);Object(v.a)(nf,"TryOfficeThroughTellMeCommandHandler",null,[169]);var uf=a(143),ef=a(383),Ve=a(109),bd=a(386);class be{constructor(qa,Xa){this.sheetName=null;this.value=!1;this.sheetName=qa;this.value=Xa}getSheetName(){return this.sheetName}Nza(){return this.value}}
Object(v.a)(be,"MacroRecorderSheetOptionToggledPayload",null,[129]);const jb=(qa,Xa,wb,Rb,vc,Nc,id,Id)=>{Id=qa.Pa(9,void 0===Id?null:Id);Id.sheetName=Xa;Id.show=wb;return hb.g(qa,"ShowGridlines",Id,Rb,vc,Nc,id,0)},lc=(qa,Xa,wb,Rb,vc,Nc,id,Id)=>{Id=qa.Pa(9,void 0===Id?null:Id);Id.sheetName=Xa;Id.show=wb;return hb.g(qa,"ShowHeadings",Id,Rb,vc,Nc,id,0)},Zc=(qa,Xa,wb,Rb,vc,Nc,id,Id)=>{Id=qa.Pa(9,void 0===Id?null:Id);Id.sheetName=Xa;Id.directionRtl=wb;return hb.g(qa,"ChangeSheetDirection",Id,Rb,vc,Nc,
id,0)};var dd;let Qd=dd=class{constructor(qa){this.$=qa}hf(){return!1}executeCommand(qa,Xa){const wb={};this.$.Am(wb);qa=Xa.command;const Rb=Object(uf.a)(Ve.a,this.$.ta.getItemByName(wb.SheetName));if(!Rb)return Bb.a(qa);let vc,Nc,id,Id,me;switch(qa){case 705559150:case -1411193626:vc=16;Nc=!Rb.hideGridLines;id=jb;me=183;Id=Rb.hideGridLines;break;case -2052321504:case 515737500:vc=4;Nc=!Rb.headersVisible;id=lc;me=184;Id=!Rb.headersVisible;break;case -1478455630:vc=2;Nc=!Rb.displayRtl;id=Zc;me=185;
Id=!Rb.displayRtl;Vb.h(this.$).ya.Pjk(Nc);break;default:return Bb.a(qa)}Rb.cwb(vc,Nc);const Wb=()=>new be(wb.SheetName,Id),Ec=this.$.qa.ua;return ef.a(this.$.userOperationManager,(hd,je,Ee)=>id(Ec,wb.SheetName,Id,Kb.b(hd,Ge=>{dd.cNb(Ge,Rb,vc,Nc)}),Kb.a(je,()=>{dd.oMb(Rb,vc,Nc)}),Ee,null),hd=>new Ba.a(me,0,hd,void 0,Wb),Xa)}Ue(qa,Xa){qa=!1;switch(Xa.command){case -1411193626:case 515737500:case -1478455630:qa=!0;break;case 705559150:case -2052321504:qa=bd.a(this.$)}return qa}mf(){return!1}static cNb(qa,
Xa,wb,Rb){yb.a.xs(qa.Errors)&&Xa.cwb(wb,!Rb)}static oMb(qa,Xa,wb){qa.cwb(Xa,!wb)}};Qd=dd=Object(Ka.a)([Object(Ua.d)(xb.cd),Object(Ka.b)(0,Object(xb.fb)())],Qd);Object(v.a)(Qd,"SheetOptionsToggleCommandHandler",null,[169]);Object(Ua.b)(xb.gc,{nr:"transient"})(qa=>Ko(function*(){yield Ua.a.resolve(xb.fc,qa);return new $a}));let ue=class{constructor(qa){this.$=qa;this.urb=!1;this.mCi=Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NsvEntryOptimizationApplyForEveryone",!1)}dispose(){this.$=
null}qnd(){return{isVisible:this.hqf(),isChecked:this.urb}}vdk(){this.urb=!this.urb;x.ULS.sendTraceTag(508180431,0,50,`SortFilterManager::toggleShouldApplySortFilterForEveryone: Apply for everyone value updated to ${this.urb}`)}oDa(qa,Xa,wb){x.ULS.sendTraceTag(508180430,0,50,`SortFilterManager::performAction: Performing sort filter action. Caller: ${wb}`);return this.sZj?(qa(),nb.Task.Ua(!0)):this.UHh(qa,Xa)}get sZj(){return this.hqf()?this.urb:!0}hqf(){const qa=this.$.ta.pa;return this.mCi&&this.$.ea.jTa&&
!(null===qa||void 0===qa?0:qa.Ag.yv)&&this.$.ea.eN&&!Object(nc.f)(this.$)}UHh(qa,Xa){Xa=this.$.Ga.Sd(new pb.a(-2050946363,Nd.a.Td,2,Xa,null));Xa.continueWith(wb=>{wb.isCompleted&&qa()});return Xa}};ue=Object(Ka.a)([Object(Ua.d)(xb.kd),Object(Ka.b)(0,Object(xb.fb)())],ue);Object(v.a)(ue,"SortFilterManager",null,[266,5]);Type.registerNamespace("Common.App.NewAndOpen.UX");oa.a.instance.$k(new $a);(()=>{X.a.Ia(qa=>{Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateCreateNewCommandHandler",
!1)||ya.la(qa)})})();ob.a.Pk(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{X.a.Ia(qa=>{Mb.la(qa)})})();(()=>{X.a.Ia(qa=>{Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateNewAndOpenUX",!1)||qa.ia.Va(165,new fb(qa))})})();(()=>{X.a.Ia(qa=>{Fa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MigrateOpenFromMruCommandHandler",
!1)||Za.la(qa)})})();X.a.Ia(Tb.la);String(h);String(f);String(e);String(k);String(l);String(b);String(c);String(r);window.___1692616129215_closurehack=h;window.___1692616129215_closurehack=f;window.___1692616129215_closurehack=e;window.___1692616129215_closurehack=k;window.___1692616129215_closurehack=l;window.___1692616129215_closurehack=b;window.___1692616129215_closurehack=c;window.___1692616129215_closurehack=r}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaTS.kmhv.js.map/a602869ee5146fae4bb9871d1f19ea8c/EwaTS.kmhv.js.map